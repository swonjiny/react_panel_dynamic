var C_=Object.defineProperty;var I_=(n,e,t)=>e in n?C_(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var Tr=(n,e,t)=>I_(n,typeof e!="symbol"?e+"":e,t);function OF(n,e){for(var t=0;t<e.length;t++){const i=e[t];if(typeof i!="string"&&!Array.isArray(i)){for(const a in i)if(a!=="default"&&!(a in n)){const o=Object.getOwnPropertyDescriptor(i,a);o&&Object.defineProperty(n,a,o.get?o:{enumerable:!0,get:()=>i[a]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}const h_=Object.freeze(Object.defineProperty({__proto__:null,get default(){return TZ}},Symbol.toStringTag,{value:"Module"})),f_=Object.freeze(Object.defineProperty({__proto__:null,get default(){return wL}},Symbol.toStringTag,{value:"Module"})),A_=Object.freeze(Object.defineProperty({__proto__:null,get default(){return RL}},Symbol.toStringTag,{value:"Module"}));(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&i(r)}).observe(document,{childList:!0,subtree:!0});function t(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(a){if(a.ep)return;a.ep=!0;const o=t(a);fetch(a.href,o)}})();function mI(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var s2={exports:{}},Im={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var EW;function m_(){if(EW)return Im;EW=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,a,o){var r=null;if(o!==void 0&&(r=""+o),a.key!==void 0&&(r=""+a.key),"key"in a){o={};for(var s in a)s!=="key"&&(o[s]=a[s])}else o=a;return a=o.ref,{$$typeof:n,type:i,key:r,ref:a!==void 0?a:null,props:o}}return Im.Fragment=e,Im.jsx=t,Im.jsxs=t,Im}var HW;function p_(){return HW||(HW=1,s2.exports=m_()),s2.exports}var Le=p_(),l2={exports:{}},ai={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var FW;function b_(){if(FW)return ai;FW=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),r=Symbol.for("react.context"),s=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),u=Symbol.for("react.lazy"),C=Symbol.iterator;function h(K){return K===null||typeof K!="object"?null:(K=C&&K[C]||K["@@iterator"],typeof K=="function"?K:null)}var m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},p=Object.assign,B={};function b(K,O,j){this.props=K,this.context=O,this.refs=B,this.updater=j||m}b.prototype.isReactComponent={},b.prototype.setState=function(K,O){if(typeof K!="object"&&typeof K!="function"&&K!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,K,O,"setState")},b.prototype.forceUpdate=function(K){this.updater.enqueueForceUpdate(this,K,"forceUpdate")};function y(){}y.prototype=b.prototype;function S(K,O,j){this.props=K,this.context=O,this.refs=B,this.updater=j||m}var R=S.prototype=new y;R.constructor=S,p(R,b.prototype),R.isPureReactComponent=!0;var Z=Array.isArray,x={H:null,A:null,T:null,S:null,V:null},M=Object.prototype.hasOwnProperty;function E(K,O,j,ne,k,ie){return j=ie.ref,{$$typeof:n,type:K,key:O,ref:j!==void 0?j:null,props:ie}}function F(K,O){return E(K.type,O,void 0,void 0,void 0,K.props)}function N(K){return typeof K=="object"&&K!==null&&K.$$typeof===n}function H(K){var O={"=":"=0",":":"=2"};return"$"+K.replace(/[=:]/g,function(j){return O[j]})}var z=/\/+/g;function _(K,O){return typeof K=="object"&&K!==null&&K.key!=null?H(""+K.key):O.toString(36)}function D(){}function P(K){switch(K.status){case"fulfilled":return K.value;case"rejected":throw K.reason;default:switch(typeof K.status=="string"?K.then(D,D):(K.status="pending",K.then(function(O){K.status==="pending"&&(K.status="fulfilled",K.value=O)},function(O){K.status==="pending"&&(K.status="rejected",K.reason=O)})),K.status){case"fulfilled":return K.value;case"rejected":throw K.reason}}throw K}function $(K,O,j,ne,k){var ie=typeof K;(ie==="undefined"||ie==="boolean")&&(K=null);var re=!1;if(K===null)re=!0;else switch(ie){case"bigint":case"string":case"number":re=!0;break;case"object":switch(K.$$typeof){case n:case e:re=!0;break;case u:return re=K._init,$(re(K._payload),O,j,ne,k)}}if(re)return k=k(K),re=ne===""?"."+_(K,0):ne,Z(k)?(j="",re!=null&&(j=re.replace(z,"$&/")+"/"),$(k,O,j,"",function(xe){return xe})):k!=null&&(N(k)&&(k=F(k,j+(k.key==null||K&&K.key===k.key?"":(""+k.key).replace(z,"$&/")+"/")+re)),O.push(k)),1;re=0;var ge=ne===""?".":ne+":";if(Z(K))for(var de=0;de<K.length;de++)ne=K[de],ie=ge+_(ne,de),re+=$(ne,O,j,ie,k);else if(de=h(K),typeof de=="function")for(K=de.call(K),de=0;!(ne=K.next()).done;)ne=ne.value,ie=ge+_(ne,de++),re+=$(ne,O,j,ie,k);else if(ie==="object"){if(typeof K.then=="function")return $(P(K),O,j,ne,k);throw O=String(K),Error("Objects are not valid as a React child (found: "+(O==="[object Object]"?"object with keys {"+Object.keys(K).join(", ")+"}":O)+"). If you meant to render a collection of children, use an array instead.")}return re}function X(K,O,j){if(K==null)return K;var ne=[],k=0;return $(K,ne,"","",function(ie){return O.call(j,ie,k++)}),ne}function L(K){if(K._status===-1){var O=K._result;O=O(),O.then(function(j){(K._status===0||K._status===-1)&&(K._status=1,K._result=j)},function(j){(K._status===0||K._status===-1)&&(K._status=2,K._result=j)}),K._status===-1&&(K._status=0,K._result=O)}if(K._status===1)return K._result.default;throw K._result}var U=typeof reportError=="function"?reportError:function(K){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var O=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof K=="object"&&K!==null&&typeof K.message=="string"?String(K.message):String(K),error:K});if(!window.dispatchEvent(O))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",K);return}console.error(K)};function q(){}return ai.Children={map:X,forEach:function(K,O,j){X(K,function(){O.apply(this,arguments)},j)},count:function(K){var O=0;return X(K,function(){O++}),O},toArray:function(K){return X(K,function(O){return O})||[]},only:function(K){if(!N(K))throw Error("React.Children.only expected to receive a single React element child.");return K}},ai.Component=b,ai.Fragment=t,ai.Profiler=a,ai.PureComponent=S,ai.StrictMode=i,ai.Suspense=l,ai.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=x,ai.__COMPILER_RUNTIME={__proto__:null,c:function(K){return x.H.useMemoCache(K)}},ai.cache=function(K){return function(){return K.apply(null,arguments)}},ai.cloneElement=function(K,O,j){if(K==null)throw Error("The argument must be a React element, but you passed "+K+".");var ne=p({},K.props),k=K.key,ie=void 0;if(O!=null)for(re in O.ref!==void 0&&(ie=void 0),O.key!==void 0&&(k=""+O.key),O)!M.call(O,re)||re==="key"||re==="__self"||re==="__source"||re==="ref"&&O.ref===void 0||(ne[re]=O[re]);var re=arguments.length-2;if(re===1)ne.children=j;else if(1<re){for(var ge=Array(re),de=0;de<re;de++)ge[de]=arguments[de+2];ne.children=ge}return E(K.type,k,void 0,void 0,ie,ne)},ai.createContext=function(K){return K={$$typeof:r,_currentValue:K,_currentValue2:K,_threadCount:0,Provider:null,Consumer:null},K.Provider=K,K.Consumer={$$typeof:o,_context:K},K},ai.createElement=function(K,O,j){var ne,k={},ie=null;if(O!=null)for(ne in O.key!==void 0&&(ie=""+O.key),O)M.call(O,ne)&&ne!=="key"&&ne!=="__self"&&ne!=="__source"&&(k[ne]=O[ne]);var re=arguments.length-2;if(re===1)k.children=j;else if(1<re){for(var ge=Array(re),de=0;de<re;de++)ge[de]=arguments[de+2];k.children=ge}if(K&&K.defaultProps)for(ne in re=K.defaultProps,re)k[ne]===void 0&&(k[ne]=re[ne]);return E(K,ie,void 0,void 0,null,k)},ai.createRef=function(){return{current:null}},ai.forwardRef=function(K){return{$$typeof:s,render:K}},ai.isValidElement=N,ai.lazy=function(K){return{$$typeof:u,_payload:{_status:-1,_result:K},_init:L}},ai.memo=function(K,O){return{$$typeof:c,type:K,compare:O===void 0?null:O}},ai.startTransition=function(K){var O=x.T,j={};x.T=j;try{var ne=K(),k=x.S;k!==null&&k(j,ne),typeof ne=="object"&&ne!==null&&typeof ne.then=="function"&&ne.then(q,U)}catch(ie){U(ie)}finally{x.T=O}},ai.unstable_useCacheRefresh=function(){return x.H.useCacheRefresh()},ai.use=function(K){return x.H.use(K)},ai.useActionState=function(K,O,j){return x.H.useActionState(K,O,j)},ai.useCallback=function(K,O){return x.H.useCallback(K,O)},ai.useContext=function(K){return x.H.useContext(K)},ai.useDebugValue=function(){},ai.useDeferredValue=function(K,O){return x.H.useDeferredValue(K,O)},ai.useEffect=function(K,O,j){var ne=x.H;if(typeof j=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return ne.useEffect(K,O)},ai.useId=function(){return x.H.useId()},ai.useImperativeHandle=function(K,O,j){return x.H.useImperativeHandle(K,O,j)},ai.useInsertionEffect=function(K,O){return x.H.useInsertionEffect(K,O)},ai.useLayoutEffect=function(K,O){return x.H.useLayoutEffect(K,O)},ai.useMemo=function(K,O){return x.H.useMemo(K,O)},ai.useOptimistic=function(K,O){return x.H.useOptimistic(K,O)},ai.useReducer=function(K,O,j){return x.H.useReducer(K,O,j)},ai.useRef=function(K){return x.H.useRef(K)},ai.useState=function(K){return x.H.useState(K)},ai.useSyncExternalStore=function(K,O,j){return x.H.useSyncExternalStore(K,O,j)},ai.useTransition=function(){return x.H.useTransition()},ai.version="19.1.0",ai}var XW;function Kf(){return XW||(XW=1,l2.exports=b_()),l2.exports}var v=Kf();const Ct=mI(v),tG=OF({__proto__:null,default:Ct},[v]);var c2={exports:{}},hm={},g2={exports:{}},u2={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var TW;function v_(){return TW||(TW=1,function(n){function e(X,L){var U=X.length;X.push(L);e:for(;0<U;){var q=U-1>>>1,K=X[q];if(0<a(K,L))X[q]=L,X[U]=K,U=q;else break e}}function t(X){return X.length===0?null:X[0]}function i(X){if(X.length===0)return null;var L=X[0],U=X.pop();if(U!==L){X[0]=U;e:for(var q=0,K=X.length,O=K>>>1;q<O;){var j=2*(q+1)-1,ne=X[j],k=j+1,ie=X[k];if(0>a(ne,U))k<K&&0>a(ie,ne)?(X[q]=ie,X[k]=U,q=k):(X[q]=ne,X[j]=U,q=j);else if(k<K&&0>a(ie,U))X[q]=ie,X[k]=U,q=k;else break e}}return L}function a(X,L){var U=X.sortIndex-L.sortIndex;return U!==0?U:X.id-L.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;n.unstable_now=function(){return o.now()}}else{var r=Date,s=r.now();n.unstable_now=function(){return r.now()-s}}var l=[],c=[],u=1,C=null,h=3,m=!1,p=!1,B=!1,b=!1,y=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,R=typeof setImmediate<"u"?setImmediate:null;function Z(X){for(var L=t(c);L!==null;){if(L.callback===null)i(c);else if(L.startTime<=X)i(c),L.sortIndex=L.expirationTime,e(l,L);else break;L=t(c)}}function x(X){if(B=!1,Z(X),!p)if(t(l)!==null)p=!0,M||(M=!0,_());else{var L=t(c);L!==null&&$(x,L.startTime-X)}}var M=!1,E=-1,F=5,N=-1;function H(){return b?!0:!(n.unstable_now()-N<F)}function z(){if(b=!1,M){var X=n.unstable_now();N=X;var L=!0;try{e:{p=!1,B&&(B=!1,S(E),E=-1),m=!0;var U=h;try{t:{for(Z(X),C=t(l);C!==null&&!(C.expirationTime>X&&H());){var q=C.callback;if(typeof q=="function"){C.callback=null,h=C.priorityLevel;var K=q(C.expirationTime<=X);if(X=n.unstable_now(),typeof K=="function"){C.callback=K,Z(X),L=!0;break t}C===t(l)&&i(l),Z(X)}else i(l);C=t(l)}if(C!==null)L=!0;else{var O=t(c);O!==null&&$(x,O.startTime-X),L=!1}}break e}finally{C=null,h=U,m=!1}L=void 0}}finally{L?_():M=!1}}}var _;if(typeof R=="function")_=function(){R(z)};else if(typeof MessageChannel<"u"){var D=new MessageChannel,P=D.port2;D.port1.onmessage=z,_=function(){P.postMessage(null)}}else _=function(){y(z,0)};function $(X,L){E=y(function(){X(n.unstable_now())},L)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(X){X.callback=null},n.unstable_forceFrameRate=function(X){0>X||125<X?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):F=0<X?Math.floor(1e3/X):5},n.unstable_getCurrentPriorityLevel=function(){return h},n.unstable_next=function(X){switch(h){case 1:case 2:case 3:var L=3;break;default:L=h}var U=h;h=L;try{return X()}finally{h=U}},n.unstable_requestPaint=function(){b=!0},n.unstable_runWithPriority=function(X,L){switch(X){case 1:case 2:case 3:case 4:case 5:break;default:X=3}var U=h;h=X;try{return L()}finally{h=U}},n.unstable_scheduleCallback=function(X,L,U){var q=n.unstable_now();switch(typeof U=="object"&&U!==null?(U=U.delay,U=typeof U=="number"&&0<U?q+U:q):U=q,X){case 1:var K=-1;break;case 2:K=250;break;case 5:K=1073741823;break;case 4:K=1e4;break;default:K=5e3}return K=U+K,X={id:u++,callback:L,priorityLevel:X,startTime:U,expirationTime:K,sortIndex:-1},U>q?(X.sortIndex=U,e(c,X),t(l)===null&&X===t(c)&&(B?(S(E),E=-1):B=!0,$(x,U-q))):(X.sortIndex=K,e(l,X),p||m||(p=!0,M||(M=!0,_()))),X},n.unstable_shouldYield=H,n.unstable_wrapCallback=function(X){var L=h;return function(){var U=h;h=L;try{return X.apply(this,arguments)}finally{h=U}}}}(u2)),u2}var YW;function y_(){return YW||(YW=1,g2.exports=v_()),g2.exports}var d2={exports:{}},lr={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zW;function B_(){if(zW)return lr;zW=1;var n=Kf();function e(l){var c="https://react.dev/errors/"+l;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)c+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+l+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},a=Symbol.for("react.portal");function o(l,c,u){var C=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:C==null?null:""+C,children:l,containerInfo:c,implementation:u}}var r=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function s(l,c){if(l==="font")return"";if(typeof c=="string")return c==="use-credentials"?c:""}return lr.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,lr.createPortal=function(l,c){var u=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11)throw Error(e(299));return o(l,c,null,u)},lr.flushSync=function(l){var c=r.T,u=i.p;try{if(r.T=null,i.p=2,l)return l()}finally{r.T=c,i.p=u,i.d.f()}},lr.preconnect=function(l,c){typeof l=="string"&&(c?(c=c.crossOrigin,c=typeof c=="string"?c==="use-credentials"?c:"":void 0):c=null,i.d.C(l,c))},lr.prefetchDNS=function(l){typeof l=="string"&&i.d.D(l)},lr.preinit=function(l,c){if(typeof l=="string"&&c&&typeof c.as=="string"){var u=c.as,C=s(u,c.crossOrigin),h=typeof c.integrity=="string"?c.integrity:void 0,m=typeof c.fetchPriority=="string"?c.fetchPriority:void 0;u==="style"?i.d.S(l,typeof c.precedence=="string"?c.precedence:void 0,{crossOrigin:C,integrity:h,fetchPriority:m}):u==="script"&&i.d.X(l,{crossOrigin:C,integrity:h,fetchPriority:m,nonce:typeof c.nonce=="string"?c.nonce:void 0})}},lr.preinitModule=function(l,c){if(typeof l=="string")if(typeof c=="object"&&c!==null){if(c.as==null||c.as==="script"){var u=s(c.as,c.crossOrigin);i.d.M(l,{crossOrigin:u,integrity:typeof c.integrity=="string"?c.integrity:void 0,nonce:typeof c.nonce=="string"?c.nonce:void 0})}}else c==null&&i.d.M(l)},lr.preload=function(l,c){if(typeof l=="string"&&typeof c=="object"&&c!==null&&typeof c.as=="string"){var u=c.as,C=s(u,c.crossOrigin);i.d.L(l,u,{crossOrigin:C,integrity:typeof c.integrity=="string"?c.integrity:void 0,nonce:typeof c.nonce=="string"?c.nonce:void 0,type:typeof c.type=="string"?c.type:void 0,fetchPriority:typeof c.fetchPriority=="string"?c.fetchPriority:void 0,referrerPolicy:typeof c.referrerPolicy=="string"?c.referrerPolicy:void 0,imageSrcSet:typeof c.imageSrcSet=="string"?c.imageSrcSet:void 0,imageSizes:typeof c.imageSizes=="string"?c.imageSizes:void 0,media:typeof c.media=="string"?c.media:void 0})}},lr.preloadModule=function(l,c){if(typeof l=="string")if(c){var u=s(c.as,c.crossOrigin);i.d.m(l,{as:typeof c.as=="string"&&c.as!=="script"?c.as:void 0,crossOrigin:u,integrity:typeof c.integrity=="string"?c.integrity:void 0})}else i.d.m(l)},lr.requestFormReset=function(l){i.d.r(l)},lr.unstable_batchedUpdates=function(l,c){return l(c)},lr.useFormState=function(l,c,u){return r.H.useFormState(l,c,u)},lr.useFormStatus=function(){return r.H.useHostTransitionStatus()},lr.version="19.1.0",lr}var KW;function UF(){if(KW)return d2.exports;KW=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),d2.exports=B_(),d2.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var LW;function G_(){if(LW)return hm;LW=1;var n=y_(),e=Kf(),t=UF();function i(g){var d="https://react.dev/errors/"+g;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var A=2;A<arguments.length;A++)d+="&args[]="+encodeURIComponent(arguments[A])}return"Minified React error #"+g+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(g){return!(!g||g.nodeType!==1&&g.nodeType!==9&&g.nodeType!==11)}function o(g){var d=g,A=g;if(g.alternate)for(;d.return;)d=d.return;else{g=d;do d=g,(d.flags&4098)!==0&&(A=d.return),g=d.return;while(g)}return d.tag===3?A:null}function r(g){if(g.tag===13){var d=g.memoizedState;if(d===null&&(g=g.alternate,g!==null&&(d=g.memoizedState)),d!==null)return d.dehydrated}return null}function s(g){if(o(g)!==g)throw Error(i(188))}function l(g){var d=g.alternate;if(!d){if(d=o(g),d===null)throw Error(i(188));return d!==g?null:g}for(var A=g,G=d;;){var W=A.return;if(W===null)break;var T=W.alternate;if(T===null){if(G=W.return,G!==null){A=G;continue}break}if(W.child===T.child){for(T=W.child;T;){if(T===A)return s(W),g;if(T===G)return s(W),d;T=T.sibling}throw Error(i(188))}if(A.return!==G.return)A=W,G=T;else{for(var oe=!1,fe=W.child;fe;){if(fe===A){oe=!0,A=W,G=T;break}if(fe===G){oe=!0,G=W,A=T;break}fe=fe.sibling}if(!oe){for(fe=T.child;fe;){if(fe===A){oe=!0,A=T,G=W;break}if(fe===G){oe=!0,G=T,A=W;break}fe=fe.sibling}if(!oe)throw Error(i(189))}}if(A.alternate!==G)throw Error(i(190))}if(A.tag!==3)throw Error(i(188));return A.stateNode.current===A?g:d}function c(g){var d=g.tag;if(d===5||d===26||d===27||d===6)return g;for(g=g.child;g!==null;){if(d=c(g),d!==null)return d;g=g.sibling}return null}var u=Object.assign,C=Symbol.for("react.element"),h=Symbol.for("react.transitional.element"),m=Symbol.for("react.portal"),p=Symbol.for("react.fragment"),B=Symbol.for("react.strict_mode"),b=Symbol.for("react.profiler"),y=Symbol.for("react.provider"),S=Symbol.for("react.consumer"),R=Symbol.for("react.context"),Z=Symbol.for("react.forward_ref"),x=Symbol.for("react.suspense"),M=Symbol.for("react.suspense_list"),E=Symbol.for("react.memo"),F=Symbol.for("react.lazy"),N=Symbol.for("react.activity"),H=Symbol.for("react.memo_cache_sentinel"),z=Symbol.iterator;function _(g){return g===null||typeof g!="object"?null:(g=z&&g[z]||g["@@iterator"],typeof g=="function"?g:null)}var D=Symbol.for("react.client.reference");function P(g){if(g==null)return null;if(typeof g=="function")return g.$$typeof===D?null:g.displayName||g.name||null;if(typeof g=="string")return g;switch(g){case p:return"Fragment";case b:return"Profiler";case B:return"StrictMode";case x:return"Suspense";case M:return"SuspenseList";case N:return"Activity"}if(typeof g=="object")switch(g.$$typeof){case m:return"Portal";case R:return(g.displayName||"Context")+".Provider";case S:return(g._context.displayName||"Context")+".Consumer";case Z:var d=g.render;return g=g.displayName,g||(g=d.displayName||d.name||"",g=g!==""?"ForwardRef("+g+")":"ForwardRef"),g;case E:return d=g.displayName||null,d!==null?d:P(g.type)||"Memo";case F:d=g._payload,g=g._init;try{return P(g(d))}catch{}}return null}var $=Array.isArray,X=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,L=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,U={pending:!1,data:null,method:null,action:null},q=[],K=-1;function O(g){return{current:g}}function j(g){0>K||(g.current=q[K],q[K]=null,K--)}function ne(g,d){K++,q[K]=g.current,g.current=d}var k=O(null),ie=O(null),re=O(null),ge=O(null);function de(g,d){switch(ne(re,d),ne(ie,g),ne(k,null),d.nodeType){case 9:case 11:g=(g=d.documentElement)&&(g=g.namespaceURI)?lW(g):0;break;default:if(g=d.tagName,d=d.namespaceURI)d=lW(d),g=cW(d,g);else switch(g){case"svg":g=1;break;case"math":g=2;break;default:g=0}}j(k),ne(k,g)}function xe(){j(k),j(ie),j(re)}function Ne(g){g.memoizedState!==null&&ne(ge,g);var d=k.current,A=cW(d,g.type);d!==A&&(ne(ie,g),ne(k,A))}function ye(g){ie.current===g&&(j(k),j(ie)),ge.current===g&&(j(ge),cm._currentValue=U)}var pe=Object.prototype.hasOwnProperty,Te=n.unstable_scheduleCallback,le=n.unstable_cancelCallback,Ye=n.unstable_shouldYield,he=n.unstable_requestPaint,Ge=n.unstable_now,be=n.unstable_getCurrentPriorityLevel,Ee=n.unstable_ImmediatePriority,Se=n.unstable_UserBlockingPriority,ee=n.unstable_NormalPriority,Q=n.unstable_LowPriority,ce=n.unstable_IdlePriority,me=n.log,Ze=n.unstable_setDisableYieldValue,Xe=null,De=null;function Oe(g){if(typeof me=="function"&&Ze(g),De&&typeof De.setStrictMode=="function")try{De.setStrictMode(Xe,g)}catch{}}var Je=Math.clz32?Math.clz32:lt,At=Math.log,qe=Math.LN2;function lt(g){return g>>>=0,g===0?32:31-(At(g)/qe|0)|0}var $e=256,je=4194304;function ke(g){var d=g&42;if(d!==0)return d;switch(g&-g){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return g&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return g&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return g}}function Ce(g,d,A){var G=g.pendingLanes;if(G===0)return 0;var W=0,T=g.suspendedLanes,oe=g.pingedLanes;g=g.warmLanes;var fe=G&134217727;return fe!==0?(G=fe&~T,G!==0?W=ke(G):(oe&=fe,oe!==0?W=ke(oe):A||(A=fe&~g,A!==0&&(W=ke(A))))):(fe=G&~T,fe!==0?W=ke(fe):oe!==0?W=ke(oe):A||(A=G&~g,A!==0&&(W=ke(A)))),W===0?0:d!==0&&d!==W&&(d&T)===0&&(T=W&-W,A=d&-d,T>=A||T===32&&(A&4194048)!==0)?d:W}function He(g,d){return(g.pendingLanes&~(g.suspendedLanes&~g.pingedLanes)&d)===0}function ht(g,d){switch(g){case 1:case 2:case 4:case 8:case 64:return d+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return d+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function we(){var g=$e;return $e<<=1,($e&4194048)===0&&($e=256),g}function ze(){var g=je;return je<<=1,(je&62914560)===0&&(je=4194304),g}function Qe(g){for(var d=[],A=0;31>A;A++)d.push(g);return d}function ut(g,d){g.pendingLanes|=d,d!==268435456&&(g.suspendedLanes=0,g.pingedLanes=0,g.warmLanes=0)}function Rt(g,d,A,G,W,T){var oe=g.pendingLanes;g.pendingLanes=A,g.suspendedLanes=0,g.pingedLanes=0,g.warmLanes=0,g.expiredLanes&=A,g.entangledLanes&=A,g.errorRecoveryDisabledLanes&=A,g.shellSuspendCounter=0;var fe=g.entanglements,_e=g.expirationTimes,bt=g.hiddenUpdates;for(A=oe&~A;0<A;){var Kt=31-Je(A),Ot=1<<Kt;fe[Kt]=0,_e[Kt]=-1;var Gt=bt[Kt];if(Gt!==null)for(bt[Kt]=null,Kt=0;Kt<Gt.length;Kt++){var St=Gt[Kt];St!==null&&(St.lane&=-536870913)}A&=~Ot}G!==0&&mt(g,G,0),T!==0&&W===0&&g.tag!==0&&(g.suspendedLanes|=T&~(oe&~d))}function mt(g,d,A){g.pendingLanes|=d,g.suspendedLanes&=~d;var G=31-Je(d);g.entangledLanes|=d,g.entanglements[G]=g.entanglements[G]|1073741824|A&4194090}function _t(g,d){var A=g.entangledLanes|=d;for(g=g.entanglements;A;){var G=31-Je(A),W=1<<G;W&d|g[G]&d&&(g[G]|=d),A&=~W}}function Lt(g){switch(g){case 2:g=1;break;case 8:g=4;break;case 32:g=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:g=128;break;case 268435456:g=134217728;break;default:g=0}return g}function Zt(g){return g&=-g,2<g?8<g?(g&134217727)!==0?32:268435456:8:2}function yt(){var g=L.p;return g!==0?g:(g=window.event,g===void 0?32:ZW(g.type))}function Ht(g,d){var A=L.p;try{return L.p=g,d()}finally{L.p=A}}var jt=Math.random().toString(36).slice(2),Ut="__reactFiber$"+jt,Nt="__reactProps$"+jt,Tt="__reactContainer$"+jt,Pt="__reactEvents$"+jt,qt="__reactListeners$"+jt,kt="__reactHandles$"+jt,Ft="__reactResources$"+jt,fn="__reactMarker$"+jt;function sn(g){delete g[Ut],delete g[Nt],delete g[Pt],delete g[qt],delete g[kt]}function ae(g){var d=g[Ut];if(d)return d;for(var A=g.parentNode;A;){if(d=A[Tt]||A[Ut]){if(A=d.alternate,d.child!==null||A!==null&&A.child!==null)for(g=CW(g);g!==null;){if(A=g[Ut])return A;g=CW(g)}return d}g=A,A=g.parentNode}return null}function ue(g){if(g=g[Ut]||g[Tt]){var d=g.tag;if(d===5||d===6||d===13||d===26||d===27||d===3)return g}return null}function Fe(g){var d=g.tag;if(d===5||d===26||d===27||d===6)return g.stateNode;throw Error(i(33))}function ot(g){var d=g[Ft];return d||(d=g[Ft]={hoistableStyles:new Map,hoistableScripts:new Map}),d}function at(g){g[fn]=!0}var It=new Set,Wt={};function xt(g,d){te(g,d),te(g+"Capture",d)}function te(g,d){for(Wt[g]=d,g=0;g<d.length;g++)It.add(d[g])}var Ie=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ae={},se={};function Re(g){return pe.call(se,g)?!0:pe.call(Ae,g)?!1:Ie.test(g)?se[g]=!0:(Ae[g]=!0,!1)}function Ue(g,d,A){if(Re(d))if(A===null)g.removeAttribute(d);else{switch(typeof A){case"undefined":case"function":case"symbol":g.removeAttribute(d);return;case"boolean":var G=d.toLowerCase().slice(0,5);if(G!=="data-"&&G!=="aria-"){g.removeAttribute(d);return}}g.setAttribute(d,""+A)}}function nt(g,d,A){if(A===null)g.removeAttribute(d);else{switch(typeof A){case"undefined":case"function":case"symbol":case"boolean":g.removeAttribute(d);return}g.setAttribute(d,""+A)}}function pt(g,d,A,G){if(G===null)g.removeAttribute(A);else{switch(typeof G){case"undefined":case"function":case"symbol":case"boolean":g.removeAttribute(A);return}g.setAttributeNS(d,A,""+G)}}var it,Bt;function Mt(g){if(it===void 0)try{throw Error()}catch(A){var d=A.stack.trim().match(/\n( *(at )?)/);it=d&&d[1]||"",Bt=-1<A.stack.indexOf(`
    at`)?" (<anonymous>)":-1<A.stack.indexOf("@")?"@unknown:0:0":""}return`
`+it+g+Bt}var Yt=!1;function ln(g,d){if(!g||Yt)return"";Yt=!0;var A=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var G={DetermineComponentFrameRoot:function(){try{if(d){var Ot=function(){throw Error()};if(Object.defineProperty(Ot.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ot,[])}catch(St){var Gt=St}Reflect.construct(g,[],Ot)}else{try{Ot.call()}catch(St){Gt=St}g.call(Ot.prototype)}}else{try{throw Error()}catch(St){Gt=St}(Ot=g())&&typeof Ot.catch=="function"&&Ot.catch(function(){})}}catch(St){if(St&&Gt&&typeof St.stack=="string")return[St.stack,Gt.stack]}return[null,null]}};G.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var W=Object.getOwnPropertyDescriptor(G.DetermineComponentFrameRoot,"name");W&&W.configurable&&Object.defineProperty(G.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var T=G.DetermineComponentFrameRoot(),oe=T[0],fe=T[1];if(oe&&fe){var _e=oe.split(`
`),bt=fe.split(`
`);for(W=G=0;G<_e.length&&!_e[G].includes("DetermineComponentFrameRoot");)G++;for(;W<bt.length&&!bt[W].includes("DetermineComponentFrameRoot");)W++;if(G===_e.length||W===bt.length)for(G=_e.length-1,W=bt.length-1;1<=G&&0<=W&&_e[G]!==bt[W];)W--;for(;1<=G&&0<=W;G--,W--)if(_e[G]!==bt[W]){if(G!==1||W!==1)do if(G--,W--,0>W||_e[G]!==bt[W]){var Kt=`
`+_e[G].replace(" at new "," at ");return g.displayName&&Kt.includes("<anonymous>")&&(Kt=Kt.replace("<anonymous>",g.displayName)),Kt}while(1<=G&&0<=W);break}}}finally{Yt=!1,Error.prepareStackTrace=A}return(A=g?g.displayName||g.name:"")?Mt(A):""}function on(g){switch(g.tag){case 26:case 27:case 5:return Mt(g.type);case 16:return Mt("Lazy");case 13:return Mt("Suspense");case 19:return Mt("SuspenseList");case 0:case 15:return ln(g.type,!1);case 11:return ln(g.type.render,!1);case 1:return ln(g.type,!0);case 31:return Mt("Activity");default:return""}}function vn(g){try{var d="";do d+=on(g),g=g.return;while(g);return d}catch(A){return`
Error generating stack: `+A.message+`
`+A.stack}}function nn(g){switch(typeof g){case"bigint":case"boolean":case"number":case"string":case"undefined":return g;case"object":return g;default:return""}}function mn(g){var d=g.type;return(g=g.nodeName)&&g.toLowerCase()==="input"&&(d==="checkbox"||d==="radio")}function gn(g){var d=mn(g)?"checked":"value",A=Object.getOwnPropertyDescriptor(g.constructor.prototype,d),G=""+g[d];if(!g.hasOwnProperty(d)&&typeof A<"u"&&typeof A.get=="function"&&typeof A.set=="function"){var W=A.get,T=A.set;return Object.defineProperty(g,d,{configurable:!0,get:function(){return W.call(this)},set:function(oe){G=""+oe,T.call(this,oe)}}),Object.defineProperty(g,d,{enumerable:A.enumerable}),{getValue:function(){return G},setValue:function(oe){G=""+oe},stopTracking:function(){g._valueTracker=null,delete g[d]}}}}function Xn(g){g._valueTracker||(g._valueTracker=gn(g))}function bn(g){if(!g)return!1;var d=g._valueTracker;if(!d)return!0;var A=d.getValue(),G="";return g&&(G=mn(g)?g.checked?"true":"false":g.value),g=G,g!==A?(d.setValue(g),!0):!1}function cn(g){if(g=g||(typeof document<"u"?document:void 0),typeof g>"u")return null;try{return g.activeElement||g.body}catch{return g.body}}var Jt=/[\n"\\]/g;function Et(g){return g.replace(Jt,function(d){return"\\"+d.charCodeAt(0).toString(16)+" "})}function rn(g,d,A,G,W,T,oe,fe){g.name="",oe!=null&&typeof oe!="function"&&typeof oe!="symbol"&&typeof oe!="boolean"?g.type=oe:g.removeAttribute("type"),d!=null?oe==="number"?(d===0&&g.value===""||g.value!=d)&&(g.value=""+nn(d)):g.value!==""+nn(d)&&(g.value=""+nn(d)):oe!=="submit"&&oe!=="reset"||g.removeAttribute("value"),d!=null?Gn(g,oe,nn(d)):A!=null?Gn(g,oe,nn(A)):G!=null&&g.removeAttribute("value"),W==null&&T!=null&&(g.defaultChecked=!!T),W!=null&&(g.checked=W&&typeof W!="function"&&typeof W!="symbol"),fe!=null&&typeof fe!="function"&&typeof fe!="symbol"&&typeof fe!="boolean"?g.name=""+nn(fe):g.removeAttribute("name")}function Cn(g,d,A,G,W,T,oe,fe){if(T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"&&(g.type=T),d!=null||A!=null){if(!(T!=="submit"&&T!=="reset"||d!=null))return;A=A!=null?""+nn(A):"",d=d!=null?""+nn(d):A,fe||d===g.value||(g.value=d),g.defaultValue=d}G=G??W,G=typeof G!="function"&&typeof G!="symbol"&&!!G,g.checked=fe?g.checked:!!G,g.defaultChecked=!!G,oe!=null&&typeof oe!="function"&&typeof oe!="symbol"&&typeof oe!="boolean"&&(g.name=oe)}function Gn(g,d,A){d==="number"&&cn(g.ownerDocument)===g||g.defaultValue===""+A||(g.defaultValue=""+A)}function pn(g,d,A,G){if(g=g.options,d){d={};for(var W=0;W<A.length;W++)d["$"+A[W]]=!0;for(A=0;A<g.length;A++)W=d.hasOwnProperty("$"+g[A].value),g[A].selected!==W&&(g[A].selected=W),W&&G&&(g[A].defaultSelected=!0)}else{for(A=""+nn(A),d=null,W=0;W<g.length;W++){if(g[W].value===A){g[W].selected=!0,G&&(g[W].defaultSelected=!0);return}d!==null||g[W].disabled||(d=g[W])}d!==null&&(d.selected=!0)}}function Kn(g,d,A){if(d!=null&&(d=""+nn(d),d!==g.value&&(g.value=d),A==null)){g.defaultValue!==d&&(g.defaultValue=d);return}g.defaultValue=A!=null?""+nn(A):""}function Qn(g,d,A,G){if(d==null){if(G!=null){if(A!=null)throw Error(i(92));if($(G)){if(1<G.length)throw Error(i(93));G=G[0]}A=G}A==null&&(A=""),d=A}A=nn(d),g.defaultValue=A,G=g.textContent,G===A&&G!==""&&G!==null&&(g.value=G)}function li(g,d){if(d){var A=g.firstChild;if(A&&A===g.lastChild&&A.nodeType===3){A.nodeValue=d;return}}g.textContent=d}var Zi=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function aa(g,d,A){var G=d.indexOf("--")===0;A==null||typeof A=="boolean"||A===""?G?g.setProperty(d,""):d==="float"?g.cssFloat="":g[d]="":G?g.setProperty(d,A):typeof A!="number"||A===0||Zi.has(d)?d==="float"?g.cssFloat=A:g[d]=(""+A).trim():g[d]=A+"px"}function pa(g,d,A){if(d!=null&&typeof d!="object")throw Error(i(62));if(g=g.style,A!=null){for(var G in A)!A.hasOwnProperty(G)||d!=null&&d.hasOwnProperty(G)||(G.indexOf("--")===0?g.setProperty(G,""):G==="float"?g.cssFloat="":g[G]="");for(var W in d)G=d[W],d.hasOwnProperty(W)&&A[W]!==G&&aa(g,W,G)}else for(var T in d)d.hasOwnProperty(T)&&aa(g,T,d[T])}function oa(g){if(g.indexOf("-")===-1)return!1;switch(g){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var mr=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),bc=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function pr(g){return bc.test(""+g)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":g}var Ki=null;function Ua(g){return g=g.target||g.srcElement||window,g.correspondingUseElement&&(g=g.correspondingUseElement),g.nodeType===3?g.parentNode:g}var ba=null,Ea=null;function po(g){var d=ue(g);if(d&&(g=d.stateNode)){var A=g[Nt]||null;e:switch(g=d.stateNode,d.type){case"input":if(rn(g,A.value,A.defaultValue,A.defaultValue,A.checked,A.defaultChecked,A.type,A.name),d=A.name,A.type==="radio"&&d!=null){for(A=g;A.parentNode;)A=A.parentNode;for(A=A.querySelectorAll('input[name="'+Et(""+d)+'"][type="radio"]'),d=0;d<A.length;d++){var G=A[d];if(G!==g&&G.form===g.form){var W=G[Nt]||null;if(!W)throw Error(i(90));rn(G,W.value,W.defaultValue,W.defaultValue,W.checked,W.defaultChecked,W.type,W.name)}}for(d=0;d<A.length;d++)G=A[d],G.form===g.form&&bn(G)}break e;case"textarea":Kn(g,A.value,A.defaultValue);break e;case"select":d=A.value,d!=null&&pn(g,!!A.multiple,d,!1)}}}var jo=!1;function Jr(g,d,A){if(jo)return g(d,A);jo=!0;try{var G=g(d);return G}finally{if(jo=!1,(ba!==null||Ea!==null)&&(gl(),ba&&(d=ba,g=Ea,Ea=ba=null,po(d),g)))for(d=0;d<g.length;d++)po(g[d])}}function br(g,d){var A=g.stateNode;if(A===null)return null;var G=A[Nt]||null;if(G===null)return null;A=G[d];e:switch(d){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(G=!G.disabled)||(g=g.type,G=!(g==="button"||g==="input"||g==="select"||g==="textarea")),g=!G;break e;default:g=!1}if(g)return null;if(A&&typeof A!="function")throw Error(i(231,d,typeof A));return A}var un=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),wn=!1;if(un)try{var hi={};Object.defineProperty(hi,"passive",{get:function(){wn=!0}}),window.addEventListener("test",hi,hi),window.removeEventListener("test",hi,hi)}catch{wn=!1}var Dn=null,Gi=null,jr=null;function Js(){if(jr)return jr;var g,d=Gi,A=d.length,G,W="value"in Dn?Dn.value:Dn.textContent,T=W.length;for(g=0;g<A&&d[g]===W[g];g++);var oe=A-g;for(G=1;G<=oe&&d[A-G]===W[T-G];G++);return jr=W.slice(g,1<G?1-G:void 0)}function Eo(g){var d=g.keyCode;return"charCode"in g?(g=g.charCode,g===0&&d===13&&(g=13)):g=d,g===10&&(g=13),32<=g||g===13?g:0}function Qo(){return!0}function vc(){return!1}function va(g){function d(A,G,W,T,oe){this._reactName=A,this._targetInst=W,this.type=G,this.nativeEvent=T,this.target=oe,this.currentTarget=null;for(var fe in g)g.hasOwnProperty(fe)&&(A=g[fe],this[fe]=A?A(T):T[fe]);return this.isDefaultPrevented=(T.defaultPrevented!=null?T.defaultPrevented:T.returnValue===!1)?Qo:vc,this.isPropagationStopped=vc,this}return u(d.prototype,{preventDefault:function(){this.defaultPrevented=!0;var A=this.nativeEvent;A&&(A.preventDefault?A.preventDefault():typeof A.returnValue!="unknown"&&(A.returnValue=!1),this.isDefaultPrevented=Qo)},stopPropagation:function(){var A=this.nativeEvent;A&&(A.stopPropagation?A.stopPropagation():typeof A.cancelBubble!="unknown"&&(A.cancelBubble=!0),this.isPropagationStopped=Qo)},persist:function(){},isPersistent:Qo}),d}var qo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(g){return g.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ho=va(qo),Zl=u({},qo,{view:0,detail:0}),fu=va(Zl),vr,Qr,xl,qr=u({},Zl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Vd,button:0,buttons:0,relatedTarget:function(g){return g.relatedTarget===void 0?g.fromElement===g.srcElement?g.toElement:g.fromElement:g.relatedTarget},movementX:function(g){return"movementX"in g?g.movementX:(g!==xl&&(xl&&g.type==="mousemove"?(vr=g.screenX-xl.screenX,Qr=g.screenY-xl.screenY):Qr=vr=0,xl=g),vr)},movementY:function(g){return"movementY"in g?g.movementY:Qr}}),vg=va(qr),bo=u({},qr,{dataTransfer:0}),rA=va(bo),ga=u({},Zl,{relatedTarget:0}),Ml=va(ga),Md=u({},qo,{animationName:0,elapsedTime:0,pseudoElement:0}),RI=va(Md),ao=u({},qo,{clipboardData:function(g){return"clipboardData"in g?g.clipboardData:window.clipboardData}}),$o=va(ao),xa=u({},qo,{data:0}),yr=va(xa),Wd={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Vb={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Nb={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function sA(g){var d=this.nativeEvent;return d.getModifierState?d.getModifierState(g):(g=Nb[g])?!!d[g]:!1}function Vd(){return sA}var Eb=u({},Zl,{key:function(g){if(g.key){var d=Wd[g.key]||g.key;if(d!=="Unidentified")return d}return g.type==="keypress"?(g=Eo(g),g===13?"Enter":String.fromCharCode(g)):g.type==="keydown"||g.type==="keyup"?Vb[g.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Vd,charCode:function(g){return g.type==="keypress"?Eo(g):0},keyCode:function(g){return g.type==="keydown"||g.type==="keyup"?g.keyCode:0},which:function(g){return g.type==="keypress"?Eo(g):g.type==="keydown"||g.type==="keyup"?g.keyCode:0}}),lA=va(Eb),cA=u({},qr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ZI=va(cA),Hb=u({},Zl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Vd}),gA=va(Hb),Fb=u({},qo,{propertyName:0,elapsedTime:0,pseudoElement:0}),Wl=va(Fb),uA=u({},qr,{deltaX:function(g){return"deltaX"in g?g.deltaX:"wheelDeltaX"in g?-g.wheelDeltaX:0},deltaY:function(g){return"deltaY"in g?g.deltaY:"wheelDeltaY"in g?-g.wheelDeltaY:"wheelDelta"in g?-g.wheelDelta:0},deltaZ:0,deltaMode:0}),wS=va(uA),Xb=u({},qo,{newState:0,oldState:0}),yc=va(Xb),Vl=[9,13,27,32],Nd=un&&"CompositionEvent"in window,yg=null;un&&"documentMode"in document&&(yg=document.documentMode);var Ed=un&&"TextEvent"in window&&!yg,Hd=un&&(!Nd||yg&&8<yg&&11>=yg),Bc=" ",oo=!1;function Fd(g,d){switch(g){case"keyup":return Vl.indexOf(d.keyCode)!==-1;case"keydown":return d.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function dA(g){return g=g.detail,typeof g=="object"&&"data"in g?g.data:null}var Gc=!1;function Xd(g,d){switch(g){case"compositionend":return dA(d);case"keypress":return d.which!==32?null:(oo=!0,Bc);case"textInput":return g=d.data,g===Bc&&oo?null:g;default:return null}}function CA(g,d){if(Gc)return g==="compositionend"||!Nd&&Fd(g,d)?(g=Js(),jr=Gi=Dn=null,Gc=!1,g):null;switch(g){case"paste":return null;case"keypress":if(!(d.ctrlKey||d.altKey||d.metaKey)||d.ctrlKey&&d.altKey){if(d.char&&1<d.char.length)return d.char;if(d.which)return String.fromCharCode(d.which)}return null;case"compositionend":return Hd&&d.locale!=="ko"?null:d.data;default:return null}}var xI={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function IA(g){var d=g&&g.nodeName&&g.nodeName.toLowerCase();return d==="input"?!!xI[g.type]:d==="textarea"}function er(g,d,A,G){ba?Ea?Ea.push(G):Ea=[G]:ba=G,d=F0(d,"onChange"),0<d.length&&(A=new Ho("onChange","change",null,A,G),g.push({event:A,listeners:d}))}var Au=null,Bg=null;function Tb(g){iW(g,0)}function Td(g){var d=Fe(g);if(bn(d))return g}function MI(g,d){if(g==="change")return d}var WI=!1;if(un){var VI;if(un){var mu="oninput"in document;if(!mu){var pu=document.createElement("div");pu.setAttribute("oninput","return;"),mu=typeof pu.oninput=="function"}VI=mu}else VI=!1;WI=VI&&(!document.documentMode||9<document.documentMode)}function ra(){Au&&(Au.detachEvent("onpropertychange",Yb),Bg=Au=null)}function Yb(g){if(g.propertyName==="value"&&Td(Bg)){var d=[];er(d,Bg,g,Ua(g)),Jr(Tb,d)}}function RS(g,d,A){g==="focusin"?(ra(),Au=d,Bg=A,Au.attachEvent("onpropertychange",Yb)):g==="focusout"&&ra()}function zb(g){if(g==="selectionchange"||g==="keyup"||g==="keydown")return Td(Bg)}function Yd(g,d){if(g==="click")return Td(d)}function Sc(g,d){if(g==="input"||g==="change")return Td(d)}function Kb(g,d){return g===d&&(g!==0||1/g===1/d)||g!==g&&d!==d}var tr=typeof Object.is=="function"?Object.is:Kb;function ws(g,d){if(tr(g,d))return!0;if(typeof g!="object"||g===null||typeof d!="object"||d===null)return!1;var A=Object.keys(g),G=Object.keys(d);if(A.length!==G.length)return!1;for(G=0;G<A.length;G++){var W=A[G];if(!pe.call(d,W)||!tr(g[W],d[W]))return!1}return!0}function nr(g){for(;g&&g.firstChild;)g=g.firstChild;return g}function hA(g,d){var A=nr(g);g=0;for(var G;A;){if(A.nodeType===3){if(G=g+A.textContent.length,g<=d&&G>=d)return{node:A,offset:d-g};g=G}e:{for(;A;){if(A.nextSibling){A=A.nextSibling;break e}A=A.parentNode}A=void 0}A=nr(A)}}function fA(g,d){return g&&d?g===d?!0:g&&g.nodeType===3?!1:d&&d.nodeType===3?fA(g,d.parentNode):"contains"in g?g.contains(d):g.compareDocumentPosition?!!(g.compareDocumentPosition(d)&16):!1:!1}function AA(g){g=g!=null&&g.ownerDocument!=null&&g.ownerDocument.defaultView!=null?g.ownerDocument.defaultView:window;for(var d=cn(g.document);d instanceof g.HTMLIFrameElement;){try{var A=typeof d.contentWindow.location.href=="string"}catch{A=!1}if(A)g=d.contentWindow;else break;d=cn(g.document)}return d}function zd(g){var d=g&&g.nodeName&&g.nodeName.toLowerCase();return d&&(d==="input"&&(g.type==="text"||g.type==="search"||g.type==="tel"||g.type==="url"||g.type==="password")||d==="textarea"||g.contentEditable==="true")}var mA=un&&"documentMode"in document&&11>=document.documentMode,Nl=null,NI=null,Kd=null,EI=!1;function pA(g,d,A){var G=A.window===A?A.document:A.nodeType===9?A:A.ownerDocument;EI||Nl==null||Nl!==cn(G)||(G=Nl,"selectionStart"in G&&zd(G)?G={start:G.selectionStart,end:G.selectionEnd}:(G=(G.ownerDocument&&G.ownerDocument.defaultView||window).getSelection(),G={anchorNode:G.anchorNode,anchorOffset:G.anchorOffset,focusNode:G.focusNode,focusOffset:G.focusOffset}),Kd&&ws(Kd,G)||(Kd=G,G=F0(NI,"onSelect"),0<G.length&&(d=new Ho("onSelect","select",null,d,A),g.push({event:d,listeners:G}),d.target=Nl)))}function ro(g,d){var A={};return A[g.toLowerCase()]=d.toLowerCase(),A["Webkit"+g]="webkit"+d,A["Moz"+g]="moz"+d,A}var wc={animationend:ro("Animation","AnimationEnd"),animationiteration:ro("Animation","AnimationIteration"),animationstart:ro("Animation","AnimationStart"),transitionrun:ro("Transition","TransitionRun"),transitionstart:ro("Transition","TransitionStart"),transitioncancel:ro("Transition","TransitionCancel"),transitionend:ro("Transition","TransitionEnd")},HI={},Lb={};un&&(Lb=document.createElement("div").style,"AnimationEvent"in window||(delete wc.animationend.animation,delete wc.animationiteration.animation,delete wc.animationstart.animation),"TransitionEvent"in window||delete wc.transitionend.transition);function El(g){if(HI[g])return HI[g];if(!wc[g])return g;var d=wc[g],A;for(A in d)if(d.hasOwnProperty(A)&&A in Lb)return HI[g]=d[A];return g}var Fo=El("animationend"),bA=El("animationiteration"),ir=El("animationstart"),_b=El("transitionrun"),Hl=El("transitionstart"),bu=El("transitioncancel"),Fl=El("transitionend"),FI=new Map,Ld="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Ld.push("scrollEnd");function ka(g,d){FI.set(g,d),xt(d,[g])}var vA=new WeakMap;function so(g,d){if(typeof g=="object"&&g!==null){var A=vA.get(g);return A!==void 0?A:(d={value:g,source:d,stack:vn(d)},vA.set(g,d),d)}return{value:g,source:d,stack:vn(d)}}var vo=[],$r=0,XI=0;function _d(){for(var g=$r,d=XI=$r=0;d<g;){var A=vo[d];vo[d++]=null;var G=vo[d];vo[d++]=null;var W=vo[d];vo[d++]=null;var T=vo[d];if(vo[d++]=null,G!==null&&W!==null){var oe=G.pending;oe===null?W.next=W:(W.next=oe.next,oe.next=W),G.pending=W}T!==0&&yA(A,W,T)}}function Rc(g,d,A,G){vo[$r++]=g,vo[$r++]=d,vo[$r++]=A,vo[$r++]=G,XI|=G,g.lanes|=G,g=g.alternate,g!==null&&(g.lanes|=G)}function TI(g,d,A,G){return Rc(g,d,A,G),vu(g)}function Xl(g,d){return Rc(g,null,null,d),vu(g)}function yA(g,d,A){g.lanes|=A;var G=g.alternate;G!==null&&(G.lanes|=A);for(var W=!1,T=g.return;T!==null;)T.childLanes|=A,G=T.alternate,G!==null&&(G.childLanes|=A),T.tag===22&&(g=T.stateNode,g===null||g._visibility&1||(W=!0)),g=T,T=T.return;return g.tag===3?(T=g.stateNode,W&&d!==null&&(W=31-Je(A),g=T.hiddenUpdates,G=g[W],G===null?g[W]=[d]:G.push(d),d.lane=A|536870912),T):null}function vu(g){if(50<cl)throw cl=0,Kg=null,Error(i(185));for(var d=g.return;d!==null;)g=d,d=g.return;return g.tag===3?g.stateNode:null}var Zc={};function BA(g,d,A,G){this.tag=g,this.key=A,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=d,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=G,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ar(g,d,A,G){return new BA(g,d,A,G)}function Dd(g){return g=g.prototype,!(!g||!g.isReactComponent)}function ya(g,d){var A=g.alternate;return A===null?(A=ar(g.tag,d,g.key,g.mode),A.elementType=g.elementType,A.type=g.type,A.stateNode=g.stateNode,A.alternate=g,g.alternate=A):(A.pendingProps=d,A.type=g.type,A.flags=0,A.subtreeFlags=0,A.deletions=null),A.flags=g.flags&65011712,A.childLanes=g.childLanes,A.lanes=g.lanes,A.child=g.child,A.memoizedProps=g.memoizedProps,A.memoizedState=g.memoizedState,A.updateQueue=g.updateQueue,d=g.dependencies,A.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext},A.sibling=g.sibling,A.index=g.index,A.ref=g.ref,A.refCleanup=g.refCleanup,A}function GA(g,d){g.flags&=65011714;var A=g.alternate;return A===null?(g.childLanes=0,g.lanes=d,g.child=null,g.subtreeFlags=0,g.memoizedProps=null,g.memoizedState=null,g.updateQueue=null,g.dependencies=null,g.stateNode=null):(g.childLanes=A.childLanes,g.lanes=A.lanes,g.child=A.child,g.subtreeFlags=0,g.deletions=null,g.memoizedProps=A.memoizedProps,g.memoizedState=A.memoizedState,g.updateQueue=A.updateQueue,g.type=A.type,d=A.dependencies,g.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext}),g}function Pa(g,d,A,G,W,T){var oe=0;if(G=g,typeof g=="function")Dd(g)&&(oe=1);else if(typeof g=="string")oe=e_(g,A,k.current)?26:g==="html"||g==="head"||g==="body"?27:5;else e:switch(g){case N:return g=ar(31,A,d,W),g.elementType=N,g.lanes=T,g;case p:return xc(A.children,W,T,d);case B:oe=8,W|=24;break;case b:return g=ar(12,A,d,W|2),g.elementType=b,g.lanes=T,g;case x:return g=ar(13,A,d,W),g.elementType=x,g.lanes=T,g;case M:return g=ar(19,A,d,W),g.elementType=M,g.lanes=T,g;default:if(typeof g=="object"&&g!==null)switch(g.$$typeof){case y:case R:oe=10;break e;case S:oe=9;break e;case Z:oe=11;break e;case E:oe=14;break e;case F:oe=16,G=null;break e}oe=29,A=Error(i(130,g===null?"null":typeof g,"")),G=null}return d=ar(oe,A,d,W),d.elementType=g,d.type=G,d.lanes=T,d}function xc(g,d,A,G){return g=ar(7,g,G,d),g.lanes=A,g}function Od(g,d,A){return g=ar(6,g,null,d),g.lanes=A,g}function YI(g,d,A){return d=ar(4,g.children!==null?g.children:[],g.key,d),d.lanes=A,d.stateNode={containerInfo:g.containerInfo,pendingChildren:null,implementation:g.implementation},d}var yu=[],or=0,Ud=null,Bu=0,lo=[],Br=0,Mc=null,js=1,Qs="";function Tl(g,d){yu[or++]=Bu,yu[or++]=Ud,Ud=g,Bu=d}function zI(g,d,A){lo[Br++]=js,lo[Br++]=Qs,lo[Br++]=Mc,Mc=g;var G=js;g=Qs;var W=32-Je(G)-1;G&=~(1<<W),A+=1;var T=32-Je(d)+W;if(30<T){var oe=W-W%5;T=(G&(1<<oe)-1).toString(32),G>>=oe,W-=oe,js=1<<32-Je(d)+W|A<<W|G,Qs=T+g}else js=1<<T|A<<W|G,Qs=g}function SA(g){g.return!==null&&(Tl(g,1),zI(g,1,0))}function wA(g){for(;g===Ud;)Ud=yu[--or],yu[or]=null,Bu=yu[--or],yu[or]=null;for(;g===Mc;)Mc=lo[--Br],lo[Br]=null,Qs=lo[--Br],lo[Br]=null,js=lo[--Br],lo[Br]=null}var Xo=null,sa=null,Si=!1,es=null,Gr=!1,KI=Error(i(519));function Wc(g){var d=Error(i(418,""));throw Gg(so(d,g)),KI}function Db(g){var d=g.stateNode,A=g.type,G=g.memoizedProps;switch(d[Ut]=g,d[Nt]=G,A){case"dialog":di("cancel",d),di("close",d);break;case"iframe":case"object":case"embed":di("load",d);break;case"video":case"audio":for(A=0;A<im.length;A++)di(im[A],d);break;case"source":di("error",d);break;case"img":case"image":case"link":di("error",d),di("load",d);break;case"details":di("toggle",d);break;case"input":di("invalid",d),Cn(d,G.value,G.defaultValue,G.checked,G.defaultChecked,G.type,G.name,!0),Xn(d);break;case"select":di("invalid",d);break;case"textarea":di("invalid",d),Qn(d,G.value,G.defaultValue,G.children),Xn(d)}A=G.children,typeof A!="string"&&typeof A!="number"&&typeof A!="bigint"||d.textContent===""+A||G.suppressHydrationWarning===!0||sW(d.textContent,A)?(G.popover!=null&&(di("beforetoggle",d),di("toggle",d)),G.onScroll!=null&&di("scroll",d),G.onScrollEnd!=null&&di("scrollend",d),G.onClick!=null&&(d.onclick=X0),d=!0):d=!1,d||Wc(g)}function RA(g){for(Xo=g.return;Xo;)switch(Xo.tag){case 5:case 13:Gr=!1;return;case 27:case 3:Gr=!0;return;default:Xo=Xo.return}}function Rs(g){if(g!==Xo)return!1;if(!Si)return RA(g),Si=!0,!1;var d=g.tag,A;if((A=d!==3&&d!==27)&&((A=d===5)&&(A=g.type,A=!(A!=="form"&&A!=="button")||kS(g.type,g.memoizedProps)),A=!A),A&&sa&&Wc(g),RA(g),d===13){if(g=g.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(i(317));e:{for(g=g.nextSibling,d=0;g;){if(g.nodeType===8)if(A=g.data,A==="/$"){if(d===0){sa=ql(g.nextSibling);break e}d--}else A!=="$"&&A!=="$!"&&A!=="$?"||d++;g=g.nextSibling}sa=null}}else d===27?(d=sa,Pu(g.type)?(g=QS,QS=null,sa=g):sa=d):sa=Xo?ql(g.stateNode.nextSibling):null;return!0}function Gu(){sa=Xo=null,Si=!1}function Wi(){var g=es;return g!==null&&(En===null?En=g:En.push.apply(En,g),es=null),g}function Gg(g){es===null?es=[g]:es.push(g)}var ZA=O(null),Vc=null,Yl=null;function Nc(g,d,A){ne(ZA,d._currentValue),d._currentValue=A}function zl(g){g._currentValue=ZA.current,j(ZA)}function xA(g,d,A){for(;g!==null;){var G=g.alternate;if((g.childLanes&d)!==d?(g.childLanes|=d,G!==null&&(G.childLanes|=d)):G!==null&&(G.childLanes&d)!==d&&(G.childLanes|=d),g===A)break;g=g.return}}function kd(g,d,A,G){var W=g.child;for(W!==null&&(W.return=g);W!==null;){var T=W.dependencies;if(T!==null){var oe=W.child;T=T.firstContext;e:for(;T!==null;){var fe=T;T=W;for(var _e=0;_e<d.length;_e++)if(fe.context===d[_e]){T.lanes|=A,fe=T.alternate,fe!==null&&(fe.lanes|=A),xA(T.return,A,g),G||(oe=null);break e}T=fe.next}}else if(W.tag===18){if(oe=W.return,oe===null)throw Error(i(341));oe.lanes|=A,T=oe.alternate,T!==null&&(T.lanes|=A),xA(oe,A,g),oe=null}else oe=W.child;if(oe!==null)oe.return=W;else for(oe=W;oe!==null;){if(oe===g){oe=null;break}if(W=oe.sibling,W!==null){W.return=oe.return,oe=W;break}oe=oe.return}W=oe}}function ts(g,d,A,G){g=null;for(var W=d,T=!1;W!==null;){if(!T){if((W.flags&524288)!==0)T=!0;else if((W.flags&262144)!==0)break}if(W.tag===10){var oe=W.alternate;if(oe===null)throw Error(i(387));if(oe=oe.memoizedProps,oe!==null){var fe=W.type;tr(W.pendingProps.value,oe.value)||(g!==null?g.push(fe):g=[fe])}}else if(W===ge.current){if(oe=W.alternate,oe===null)throw Error(i(387));oe.memoizedState.memoizedState!==W.memoizedState.memoizedState&&(g!==null?g.push(cm):g=[cm])}W=W.return}g!==null&&kd(d,g,A,G),d.flags|=262144}function Pd(g){for(g=g.firstContext;g!==null;){if(!tr(g.context._currentValue,g.memoizedValue))return!0;g=g.next}return!1}function qs(g){Vc=g,Yl=null,g=g.dependencies,g!==null&&(g.firstContext=null)}function ua(g){return LI(Vc,g)}function Jd(g,d){return Vc===null&&qs(g),LI(g,d)}function LI(g,d){var A=d._currentValue;if(d={context:d,memoizedValue:A,next:null},Yl===null){if(g===null)throw Error(i(308));Yl=d,g.dependencies={lanes:0,firstContext:d},g.flags|=524288}else Yl=Yl.next=d;return A}var MA=typeof AbortController<"u"?AbortController:function(){var g=[],d=this.signal={aborted:!1,addEventListener:function(A,G){g.push(G)}};this.abort=function(){d.aborted=!0,g.forEach(function(A){return A()})}},ZS=n.unstable_scheduleCallback,Ob=n.unstable_NormalPriority,Ma={$$typeof:R,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function _I(){return{controller:new MA,data:new Map,refCount:0}}function Su(g){g.refCount--,g.refCount===0&&ZS(Ob,function(){g.controller.abort()})}var wu=null,jd=0,kn=0,Ru=null;function Sr(g,d){if(wu===null){var A=wu=[];jd=0,kn=TS(),Ru={status:"pending",value:void 0,then:function(G){A.push(G)}}}return jd++,d.then(DI,DI),d}function DI(){if(--jd===0&&wu!==null){Ru!==null&&(Ru.status="fulfilled");var g=wu;wu=null,kn=0,Ru=null;for(var d=0;d<g.length;d++)(0,g[d])()}}function xS(g,d){var A=[],G={status:"pending",value:null,reason:null,then:function(W){A.push(W)}};return g.then(function(){G.status="fulfilled",G.value=d;for(var W=0;W<A.length;W++)(0,A[W])(d)},function(W){for(G.status="rejected",G.reason=W,W=0;W<A.length;W++)(0,A[W])(void 0)}),G}var Qd=X.S;X.S=function(g,d){typeof d=="object"&&d!==null&&typeof d.then=="function"&&Sr(g,d),Qd!==null&&Qd(g,d)};var ns=O(null);function Ec(){var g=ns.current;return g!==null?g:On.pooledCache}function qd(g,d){d===null?ne(ns,ns.current):ne(ns,d.pool)}function OI(){var g=Ec();return g===null?null:{parent:Ma._currentValue,pool:g}}var $d=Error(i(460)),WA=Error(i(474)),Zs=Error(i(542)),eC={then:function(){}};function UI(g){return g=g.status,g==="fulfilled"||g==="rejected"}function Zu(){}function kI(g,d,A){switch(A=g[A],A===void 0?g.push(d):A!==d&&(d.then(Zu,Zu),d=A),d.status){case"fulfilled":return d.value;case"rejected":throw g=d.reason,Ub(g),g;default:if(typeof d.status=="string")d.then(Zu,Zu);else{if(g=On,g!==null&&100<g.shellSuspendCounter)throw Error(i(482));g=d,g.status="pending",g.then(function(G){if(d.status==="pending"){var W=d;W.status="fulfilled",W.value=G}},function(G){if(d.status==="pending"){var W=d;W.status="rejected",W.reason=G}})}switch(d.status){case"fulfilled":return d.value;case"rejected":throw g=d.reason,Ub(g),g}throw is=d,$d}}var is=null;function VA(){if(is===null)throw Error(i(459));var g=is;return is=null,g}function Ub(g){if(g===$d||g===Zs)throw Error(i(483))}var Kl=!1;function NA(g){g.updateQueue={baseState:g.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Yn(g,d){g=g.updateQueue,d.updateQueue===g&&(d.updateQueue={baseState:g.baseState,firstBaseUpdate:g.firstBaseUpdate,lastBaseUpdate:g.lastBaseUpdate,shared:g.shared,callbacks:null})}function $s(g){return{lane:g,tag:0,payload:null,callback:null,next:null}}function Ll(g,d,A){var G=g.updateQueue;if(G===null)return null;if(G=G.shared,(Vi&2)!==0){var W=G.pending;return W===null?d.next=d:(d.next=W.next,W.next=d),G.pending=d,d=vu(g),yA(g,null,A),d}return Rc(g,G,d,A),vu(g)}function Sg(g,d,A){if(d=d.updateQueue,d!==null&&(d=d.shared,(A&4194048)!==0)){var G=d.lanes;G&=g.pendingLanes,A|=G,d.lanes=A,_t(g,A)}}function xu(g,d){var A=g.updateQueue,G=g.alternate;if(G!==null&&(G=G.updateQueue,A===G)){var W=null,T=null;if(A=A.firstBaseUpdate,A!==null){do{var oe={lane:A.lane,tag:A.tag,payload:A.payload,callback:null,next:null};T===null?W=T=oe:T=T.next=oe,A=A.next}while(A!==null);T===null?W=T=d:T=T.next=d}else W=T=d;A={baseState:G.baseState,firstBaseUpdate:W,lastBaseUpdate:T,shared:G.shared,callbacks:G.callbacks},g.updateQueue=A;return}g=A.lastBaseUpdate,g===null?A.firstBaseUpdate=d:g.next=d,A.lastBaseUpdate=d}var EA=!1;function tC(){if(EA){var g=Ru;if(g!==null)throw g}}function Mu(g,d,A,G){EA=!1;var W=g.updateQueue;Kl=!1;var T=W.firstBaseUpdate,oe=W.lastBaseUpdate,fe=W.shared.pending;if(fe!==null){W.shared.pending=null;var _e=fe,bt=_e.next;_e.next=null,oe===null?T=bt:oe.next=bt,oe=_e;var Kt=g.alternate;Kt!==null&&(Kt=Kt.updateQueue,fe=Kt.lastBaseUpdate,fe!==oe&&(fe===null?Kt.firstBaseUpdate=bt:fe.next=bt,Kt.lastBaseUpdate=_e))}if(T!==null){var Ot=W.baseState;oe=0,Kt=bt=_e=null,fe=T;do{var Gt=fe.lane&-536870913,St=Gt!==fe.lane;if(St?(Wn&Gt)===Gt:(G&Gt)===Gt){Gt!==0&&Gt===kn&&(EA=!0),Kt!==null&&(Kt=Kt.next={lane:0,tag:fe.tag,payload:fe.payload,callback:null,next:null});e:{var Ln=g,Fn=fe;Gt=d;var Qi=A;switch(Fn.tag){case 1:if(Ln=Fn.payload,typeof Ln=="function"){Ot=Ln.call(Qi,Ot,Gt);break e}Ot=Ln;break e;case 3:Ln.flags=Ln.flags&-65537|128;case 0:if(Ln=Fn.payload,Gt=typeof Ln=="function"?Ln.call(Qi,Ot,Gt):Ln,Gt==null)break e;Ot=u({},Ot,Gt);break e;case 2:Kl=!0}}Gt=fe.callback,Gt!==null&&(g.flags|=64,St&&(g.flags|=8192),St=W.callbacks,St===null?W.callbacks=[Gt]:St.push(Gt))}else St={lane:Gt,tag:fe.tag,payload:fe.payload,callback:fe.callback,next:null},Kt===null?(bt=Kt=St,_e=Ot):Kt=Kt.next=St,oe|=Gt;if(fe=fe.next,fe===null){if(fe=W.shared.pending,fe===null)break;St=fe,fe=St.next,St.next=null,W.lastBaseUpdate=St,W.shared.pending=null}}while(!0);Kt===null&&(_e=Ot),W.baseState=_e,W.firstBaseUpdate=bt,W.lastBaseUpdate=Kt,T===null&&(W.shared.lanes=0),Fs|=oe,g.lanes=oe,g.memoizedState=Ot}}function Wu(g,d){if(typeof g!="function")throw Error(i(191,g));g.call(d)}function kb(g,d){var A=g.callbacks;if(A!==null)for(g.callbacks=null,g=0;g<A.length;g++)Wu(A[g],d)}var Vu=O(null),PI=O(0);function Pb(g,d){g=cs,ne(PI,g),ne(Vu,d),cs=g|d.baseLanes}function HA(){ne(PI,cs),ne(Vu,Vu.current)}function nC(){cs=PI.current,j(Vu),j(PI)}var _l=0,Pn=null,Hi=null,Wa=null,JI=!1,Hc=!1,To=!1,Ha=0,as=0,co=null,Jb=0;function Ba(){throw Error(i(321))}function yo(g,d){if(d===null)return!1;for(var A=0;A<d.length&&A<g.length;A++)if(!tr(g[A],d[A]))return!1;return!0}function Dl(g,d,A,G,W,T){return _l=T,Pn=d,d.memoizedState=null,d.updateQueue=null,d.lanes=0,X.H=g===null||g.memoizedState===null?ah:QA,To=!1,T=A(G,W),To=!1,Hc&&(T=Qb(d,A,G,W)),jb(g),T}function jb(g){X.H=oC;var d=Hi!==null&&Hi.next!==null;if(_l=0,Wa=Hi=Pn=null,JI=!1,as=0,co=null,d)throw Error(i(300));g===null||Ja||(g=g.dependencies,g!==null&&Pd(g)&&(Ja=!0))}function Qb(g,d,A,G){Pn=g;var W=0;do{if(Hc&&(co=null),as=0,Hc=!1,25<=W)throw Error(i(301));if(W+=1,Wa=Hi=null,g.updateQueue!=null){var T=g.updateQueue;T.lastEffect=null,T.events=null,T.stores=null,T.memoCache!=null&&(T.memoCache.index=0)}X.H=B0,T=d(A,G)}while(Hc);return T}function MS(){var g=X.H,d=g.useState()[0];return d=typeof d.then=="function"?xs(d):d,g=g.useState()[0],(Hi!==null?Hi.memoizedState:null)!==g&&(Pn.flags|=1024),d}function FA(){var g=Ha!==0;return Ha=0,g}function jI(g,d,A){d.updateQueue=g.updateQueue,d.flags&=-2053,g.lanes&=~A}function XA(g){if(JI){for(g=g.memoizedState;g!==null;){var d=g.queue;d!==null&&(d.pending=null),g=g.next}JI=!1}_l=0,Wa=Hi=Pn=null,Hc=!1,as=Ha=0,co=null}function Yo(){var g={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Wa===null?Pn.memoizedState=Wa=g:Wa=Wa.next=g,Wa}function Va(){if(Hi===null){var g=Pn.alternate;g=g!==null?g.memoizedState:null}else g=Hi.next;var d=Wa===null?Pn.memoizedState:Wa.next;if(d!==null)Wa=d,Hi=g;else{if(g===null)throw Pn.alternate===null?Error(i(467)):Error(i(310));Hi=g,g={memoizedState:Hi.memoizedState,baseState:Hi.baseState,baseQueue:Hi.baseQueue,queue:Hi.queue,next:null},Wa===null?Pn.memoizedState=Wa=g:Wa=Wa.next=g}return Wa}function Fc(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function xs(g){var d=as;return as+=1,co===null&&(co=[]),g=kI(co,g,d),d=Pn,(Wa===null?d.memoizedState:Wa.next)===null&&(d=d.alternate,X.H=d===null||d.memoizedState===null?ah:QA),g}function QI(g){if(g!==null&&typeof g=="object"){if(typeof g.then=="function")return xs(g);if(g.$$typeof===R)return ua(g)}throw Error(i(438,String(g)))}function TA(g){var d=null,A=Pn.updateQueue;if(A!==null&&(d=A.memoCache),d==null){var G=Pn.alternate;G!==null&&(G=G.updateQueue,G!==null&&(G=G.memoCache,G!=null&&(d={data:G.data.map(function(W){return W.slice()}),index:0})))}if(d==null&&(d={data:[],index:0}),A===null&&(A=Fc(),Pn.updateQueue=A),A.memoCache=d,A=d.data[d.index],A===void 0)for(A=d.data[d.index]=Array(g),G=0;G<g;G++)A[G]=H;return d.index++,A}function Ol(g,d){return typeof d=="function"?d(g):d}function Xc(g){var d=Va();return YA(d,Hi,g)}function YA(g,d,A){var G=g.queue;if(G===null)throw Error(i(311));G.lastRenderedReducer=A;var W=g.baseQueue,T=G.pending;if(T!==null){if(W!==null){var oe=W.next;W.next=T.next,T.next=oe}d.baseQueue=W=T,G.pending=null}if(T=g.baseState,W===null)g.memoizedState=T;else{d=W.next;var fe=oe=null,_e=null,bt=d,Kt=!1;do{var Ot=bt.lane&-536870913;if(Ot!==bt.lane?(Wn&Ot)===Ot:(_l&Ot)===Ot){var Gt=bt.revertLane;if(Gt===0)_e!==null&&(_e=_e.next={lane:0,revertLane:0,action:bt.action,hasEagerState:bt.hasEagerState,eagerState:bt.eagerState,next:null}),Ot===kn&&(Kt=!0);else if((_l&Gt)===Gt){bt=bt.next,Gt===kn&&(Kt=!0);continue}else Ot={lane:0,revertLane:bt.revertLane,action:bt.action,hasEagerState:bt.hasEagerState,eagerState:bt.eagerState,next:null},_e===null?(fe=_e=Ot,oe=T):_e=_e.next=Ot,Pn.lanes|=Gt,Fs|=Gt;Ot=bt.action,To&&A(T,Ot),T=bt.hasEagerState?bt.eagerState:A(T,Ot)}else Gt={lane:Ot,revertLane:bt.revertLane,action:bt.action,hasEagerState:bt.hasEagerState,eagerState:bt.eagerState,next:null},_e===null?(fe=_e=Gt,oe=T):_e=_e.next=Gt,Pn.lanes|=Ot,Fs|=Ot;bt=bt.next}while(bt!==null&&bt!==d);if(_e===null?oe=T:_e.next=fe,!tr(T,g.memoizedState)&&(Ja=!0,Kt&&(A=Ru,A!==null)))throw A;g.memoizedState=T,g.baseState=oe,g.baseQueue=_e,G.lastRenderedState=T}return W===null&&(G.lanes=0),[g.memoizedState,G.dispatch]}function zA(g){var d=Va(),A=d.queue;if(A===null)throw Error(i(311));A.lastRenderedReducer=g;var G=A.dispatch,W=A.pending,T=d.memoizedState;if(W!==null){A.pending=null;var oe=W=W.next;do T=g(T,oe.action),oe=oe.next;while(oe!==W);tr(T,d.memoizedState)||(Ja=!0),d.memoizedState=T,d.baseQueue===null&&(d.baseState=T),A.lastRenderedState=T}return[T,G]}function qb(g,d,A){var G=Pn,W=Va(),T=Si;if(T){if(A===void 0)throw Error(i(407));A=A()}else A=d();var oe=!tr((Hi||W).memoizedState,A);oe&&(W.memoizedState=A,Ja=!0),W=W.queue;var fe=e0.bind(null,G,W,g);if(Hu(2048,8,fe,[g]),W.getSnapshot!==d||oe||Wa!==null&&Wa.memoizedState.tag&1){if(G.flags|=2048,Eu(9,iC(),$b.bind(null,G,W,A,d),null),On===null)throw Error(i(349));T||(_l&124)!==0||Nu(G,d,A)}return A}function Nu(g,d,A){g.flags|=16384,g={getSnapshot:d,value:A},d=Pn.updateQueue,d===null?(d=Fc(),Pn.updateQueue=d,d.stores=[g]):(A=d.stores,A===null?d.stores=[g]:A.push(g))}function $b(g,d,A,G){d.value=A,d.getSnapshot=G,t0(d)&&n0(g)}function e0(g,d,A){return A(function(){t0(d)&&n0(g)})}function t0(g){var d=g.getSnapshot;g=g.value;try{var A=d();return!tr(g,A)}catch{return!0}}function n0(g){var d=Xl(g,2);d!==null&&Lo(d,g,2)}function KA(g){var d=Yo();if(typeof g=="function"){var A=g;if(g=A(),To){Oe(!0);try{A()}finally{Oe(!1)}}}return d.memoizedState=d.baseState=g,d.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ol,lastRenderedState:g},d}function i0(g,d,A,G){return g.baseState=A,YA(g,Hi,typeof G=="function"?G:Ol)}function WS(g,d,A,G,W){if(ih(g))throw Error(i(485));if(g=d.action,g!==null){var T={payload:W,action:g,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(oe){T.listeners.push(oe)}};X.T!==null?A(!0):T.isTransition=!1,G(T),A=d.pending,A===null?(T.next=d.pending=T,a0(d,T)):(T.next=A.next,d.pending=A.next=T)}}function a0(g,d){var A=d.action,G=d.payload,W=g.state;if(d.isTransition){var T=X.T,oe={};X.T=oe;try{var fe=A(W,G),_e=X.S;_e!==null&&_e(oe,fe),o0(g,d,fe)}catch(bt){LA(g,d,bt)}finally{X.T=T}}else try{T=A(W,G),o0(g,d,T)}catch(bt){LA(g,d,bt)}}function o0(g,d,A){A!==null&&typeof A=="object"&&typeof A.then=="function"?A.then(function(G){r0(g,d,G)},function(G){return LA(g,d,G)}):r0(g,d,A)}function r0(g,d,A){d.status="fulfilled",d.value=A,s0(d),g.state=A,d=g.pending,d!==null&&(A=d.next,A===d?g.pending=null:(A=A.next,d.next=A,a0(g,A)))}function LA(g,d,A){var G=g.pending;if(g.pending=null,G!==null){G=G.next;do d.status="rejected",d.reason=A,s0(d),d=d.next;while(d!==G)}g.action=null}function s0(g){g=g.listeners;for(var d=0;d<g.length;d++)(0,g[d])()}function _A(g,d){return d}function l0(g,d){if(Si){var A=On.formState;if(A!==null){e:{var G=Pn;if(Si){if(sa){t:{for(var W=sa,T=Gr;W.nodeType!==8;){if(!T){W=null;break t}if(W=ql(W.nextSibling),W===null){W=null;break t}}T=W.data,W=T==="F!"||T==="F"?W:null}if(W){sa=ql(W.nextSibling),G=W.data==="F!";break e}}Wc(G)}G=!1}G&&(d=A[0])}}return A=Yo(),A.memoizedState=A.baseState=d,G={pending:null,lanes:0,dispatch:null,lastRenderedReducer:_A,lastRenderedState:d},A.queue=G,A=v0.bind(null,Pn,G),G.dispatch=A,G=KA(!1),T=nh.bind(null,Pn,!1,G.queue),G=Yo(),W={state:d,dispatch:null,action:g,pending:null},G.queue=W,A=WS.bind(null,Pn,W,T,A),W.dispatch=A,G.memoizedState=g,[d,A,!1]}function c0(g){var d=Va();return g0(d,Hi,g)}function g0(g,d,A){if(d=YA(g,d,_A)[0],g=Xc(Ol)[0],typeof d=="object"&&d!==null&&typeof d.then=="function")try{var G=xs(d)}catch(oe){throw oe===$d?Zs:oe}else G=d;d=Va();var W=d.queue,T=W.dispatch;return A!==d.memoizedState&&(Pn.flags|=2048,Eu(9,iC(),VS.bind(null,W,A),null)),[G,T,g]}function VS(g,d){g.action=d}function u0(g){var d=Va(),A=Hi;if(A!==null)return g0(d,A,g);Va(),d=d.memoizedState,A=Va();var G=A.queue.dispatch;return A.memoizedState=g,[d,G,!1]}function Eu(g,d,A,G){return g={tag:g,create:A,deps:G,inst:d,next:null},d=Pn.updateQueue,d===null&&(d=Fc(),Pn.updateQueue=d),A=d.lastEffect,A===null?d.lastEffect=g.next=g:(G=A.next,A.next=g,g.next=G,d.lastEffect=g),g}function iC(){return{destroy:void 0,resource:void 0}}function DA(){return Va().memoizedState}function qI(g,d,A,G){var W=Yo();G=G===void 0?null:G,Pn.flags|=g,W.memoizedState=Eu(1|d,iC(),A,G)}function Hu(g,d,A,G){var W=Va();G=G===void 0?null:G;var T=W.memoizedState.inst;Hi!==null&&G!==null&&yo(G,Hi.memoizedState.deps)?W.memoizedState=Eu(d,T,A,G):(Pn.flags|=g,W.memoizedState=Eu(1|d,T,A,G))}function OA(g,d){qI(8390656,8,g,d)}function UA(g,d){Hu(2048,8,g,d)}function $I(g,d){return Hu(4,2,g,d)}function eh(g,d){return Hu(4,4,g,d)}function d0(g,d){if(typeof d=="function"){g=g();var A=d(g);return function(){typeof A=="function"?A():d(null)}}if(d!=null)return g=g(),d.current=g,function(){d.current=null}}function C0(g,d,A){A=A!=null?A.concat([g]):null,Hu(4,4,d0.bind(null,d,g),A)}function kA(){}function I0(g,d){var A=Va();d=d===void 0?null:d;var G=A.memoizedState;return d!==null&&yo(d,G[1])?G[0]:(A.memoizedState=[g,d],g)}function PA(g,d){var A=Va();d=d===void 0?null:d;var G=A.memoizedState;if(d!==null&&yo(d,G[1]))return G[0];if(G=g(),To){Oe(!0);try{g()}finally{Oe(!1)}}return A.memoizedState=[G,d],G}function th(g,d,A){return A===void 0||(_l&1073741824)!==0?g.memoizedState=d:(g.memoizedState=A,g=hh(),Pn.lanes|=g,Fs|=g,A)}function h0(g,d,A,G){return tr(A,d)?A:Vu.current!==null?(g=th(g,A,G),tr(g,d)||(Ja=!0),g):(_l&42)===0?(Ja=!0,g.memoizedState=A):(g=hh(),Pn.lanes|=g,Fs|=g,d)}function f0(g,d,A,G,W){var T=L.p;L.p=T!==0&&8>T?T:8;var oe=X.T,fe={};X.T=fe,nh(g,!1,d,A);try{var _e=W(),bt=X.S;if(bt!==null&&bt(fe,_e),_e!==null&&typeof _e=="object"&&typeof _e.then=="function"){var Kt=xS(_e,G);aC(g,d,Kt,Ia(g))}else aC(g,d,G,Ia(g))}catch(Ot){aC(g,d,{then:function(){},status:"rejected",reason:Ot},Ia())}finally{L.p=T,X.T=oe}}function NS(){}function JA(g,d,A,G){if(g.tag!==5)throw Error(i(476));var W=A0(g).queue;f0(g,W,d,U,A===null?NS:function(){return m0(g),A(G)})}function A0(g){var d=g.memoizedState;if(d!==null)return d;d={memoizedState:U,baseState:U,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ol,lastRenderedState:U},next:null};var A={};return d.next={memoizedState:A,baseState:A,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ol,lastRenderedState:A},next:null},g.memoizedState=d,g=g.alternate,g!==null&&(g.memoizedState=d),d}function m0(g){var d=A0(g).next.queue;aC(g,d,{},Ia())}function jA(){return ua(cm)}function p0(){return Va().memoizedState}function b0(){return Va().memoizedState}function ES(g){for(var d=g.return;d!==null;){switch(d.tag){case 24:case 3:var A=Ia();g=$s(A);var G=Ll(d,g,A);G!==null&&(Lo(G,d,A),Sg(G,d,A)),d={cache:_I()},g.payload=d;return}d=d.return}}function HS(g,d,A){var G=Ia();A={lane:G,revertLane:0,action:A,hasEagerState:!1,eagerState:null,next:null},ih(g)?y0(d,A):(A=TI(g,d,A,G),A!==null&&(Lo(A,g,G),wr(A,d,G)))}function v0(g,d,A){var G=Ia();aC(g,d,A,G)}function aC(g,d,A,G){var W={lane:G,revertLane:0,action:A,hasEagerState:!1,eagerState:null,next:null};if(ih(g))y0(d,W);else{var T=g.alternate;if(g.lanes===0&&(T===null||T.lanes===0)&&(T=d.lastRenderedReducer,T!==null))try{var oe=d.lastRenderedState,fe=T(oe,A);if(W.hasEagerState=!0,W.eagerState=fe,tr(fe,oe))return Rc(g,d,W,0),On===null&&_d(),!1}catch{}finally{}if(A=TI(g,d,W,G),A!==null)return Lo(A,g,G),wr(A,d,G),!0}return!1}function nh(g,d,A,G){if(G={lane:2,revertLane:TS(),action:G,hasEagerState:!1,eagerState:null,next:null},ih(g)){if(d)throw Error(i(479))}else d=TI(g,A,G,2),d!==null&&Lo(d,g,2)}function ih(g){var d=g.alternate;return g===Pn||d!==null&&d===Pn}function y0(g,d){Hc=JI=!0;var A=g.pending;A===null?d.next=d:(d.next=A.next,A.next=d),g.pending=d}function wr(g,d,A){if((A&4194048)!==0){var G=d.lanes;G&=g.pendingLanes,A|=G,d.lanes=A,_t(g,A)}}var oC={readContext:ua,use:QI,useCallback:Ba,useContext:Ba,useEffect:Ba,useImperativeHandle:Ba,useLayoutEffect:Ba,useInsertionEffect:Ba,useMemo:Ba,useReducer:Ba,useRef:Ba,useState:Ba,useDebugValue:Ba,useDeferredValue:Ba,useTransition:Ba,useSyncExternalStore:Ba,useId:Ba,useHostTransitionStatus:Ba,useFormState:Ba,useActionState:Ba,useOptimistic:Ba,useMemoCache:Ba,useCacheRefresh:Ba},ah={readContext:ua,use:QI,useCallback:function(g,d){return Yo().memoizedState=[g,d===void 0?null:d],g},useContext:ua,useEffect:OA,useImperativeHandle:function(g,d,A){A=A!=null?A.concat([g]):null,qI(4194308,4,d0.bind(null,d,g),A)},useLayoutEffect:function(g,d){return qI(4194308,4,g,d)},useInsertionEffect:function(g,d){qI(4,2,g,d)},useMemo:function(g,d){var A=Yo();d=d===void 0?null:d;var G=g();if(To){Oe(!0);try{g()}finally{Oe(!1)}}return A.memoizedState=[G,d],G},useReducer:function(g,d,A){var G=Yo();if(A!==void 0){var W=A(d);if(To){Oe(!0);try{A(d)}finally{Oe(!1)}}}else W=d;return G.memoizedState=G.baseState=W,g={pending:null,lanes:0,dispatch:null,lastRenderedReducer:g,lastRenderedState:W},G.queue=g,g=g.dispatch=HS.bind(null,Pn,g),[G.memoizedState,g]},useRef:function(g){var d=Yo();return g={current:g},d.memoizedState=g},useState:function(g){g=KA(g);var d=g.queue,A=v0.bind(null,Pn,d);return d.dispatch=A,[g.memoizedState,A]},useDebugValue:kA,useDeferredValue:function(g,d){var A=Yo();return th(A,g,d)},useTransition:function(){var g=KA(!1);return g=f0.bind(null,Pn,g.queue,!0,!1),Yo().memoizedState=g,[!1,g]},useSyncExternalStore:function(g,d,A){var G=Pn,W=Yo();if(Si){if(A===void 0)throw Error(i(407));A=A()}else{if(A=d(),On===null)throw Error(i(349));(Wn&124)!==0||Nu(G,d,A)}W.memoizedState=A;var T={value:A,getSnapshot:d};return W.queue=T,OA(e0.bind(null,G,T,g),[g]),G.flags|=2048,Eu(9,iC(),$b.bind(null,G,T,A,d),null),A},useId:function(){var g=Yo(),d=On.identifierPrefix;if(Si){var A=Qs,G=js;A=(G&~(1<<32-Je(G)-1)).toString(32)+A,d=""+d+"R"+A,A=Ha++,0<A&&(d+="H"+A.toString(32)),d+=""}else A=Jb++,d=""+d+"r"+A.toString(32)+"";return g.memoizedState=d},useHostTransitionStatus:jA,useFormState:l0,useActionState:l0,useOptimistic:function(g){var d=Yo();d.memoizedState=d.baseState=g;var A={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return d.queue=A,d=nh.bind(null,Pn,!0,A),A.dispatch=d,[g,d]},useMemoCache:TA,useCacheRefresh:function(){return Yo().memoizedState=ES.bind(null,Pn)}},QA={readContext:ua,use:QI,useCallback:I0,useContext:ua,useEffect:UA,useImperativeHandle:C0,useInsertionEffect:$I,useLayoutEffect:eh,useMemo:PA,useReducer:Xc,useRef:DA,useState:function(){return Xc(Ol)},useDebugValue:kA,useDeferredValue:function(g,d){var A=Va();return h0(A,Hi.memoizedState,g,d)},useTransition:function(){var g=Xc(Ol)[0],d=Va().memoizedState;return[typeof g=="boolean"?g:xs(g),d]},useSyncExternalStore:qb,useId:p0,useHostTransitionStatus:jA,useFormState:c0,useActionState:c0,useOptimistic:function(g,d){var A=Va();return i0(A,Hi,g,d)},useMemoCache:TA,useCacheRefresh:b0},B0={readContext:ua,use:QI,useCallback:I0,useContext:ua,useEffect:UA,useImperativeHandle:C0,useInsertionEffect:$I,useLayoutEffect:eh,useMemo:PA,useReducer:zA,useRef:DA,useState:function(){return zA(Ol)},useDebugValue:kA,useDeferredValue:function(g,d){var A=Va();return Hi===null?th(A,g,d):h0(A,Hi.memoizedState,g,d)},useTransition:function(){var g=zA(Ol)[0],d=Va().memoizedState;return[typeof g=="boolean"?g:xs(g),d]},useSyncExternalStore:qb,useId:p0,useHostTransitionStatus:jA,useFormState:u0,useActionState:u0,useOptimistic:function(g,d){var A=Va();return Hi!==null?i0(A,Hi,g,d):(A.baseState=g,[g,A.queue.dispatch])},useMemoCache:TA,useCacheRefresh:b0},wg=null,rC=0;function sC(g){var d=rC;return rC+=1,wg===null&&(wg=[]),kI(wg,g,d)}function Fu(g,d){d=d.props.ref,g.ref=d!==void 0?d:null}function oh(g,d){throw d.$$typeof===C?Error(i(525)):(g=Object.prototype.toString.call(d),Error(i(31,g==="[object Object]"?"object with keys {"+Object.keys(d).join(", ")+"}":g)))}function G0(g){var d=g._init;return d(g._payload)}function S0(g){function d(ct,tt){if(g){var ft=ct.deletions;ft===null?(ct.deletions=[tt],ct.flags|=16):ft.push(tt)}}function A(ct,tt){if(!g)return null;for(;tt!==null;)d(ct,tt),tt=tt.sibling;return null}function G(ct){for(var tt=new Map;ct!==null;)ct.key!==null?tt.set(ct.key,ct):tt.set(ct.index,ct),ct=ct.sibling;return tt}function W(ct,tt){return ct=ya(ct,tt),ct.index=0,ct.sibling=null,ct}function T(ct,tt,ft){return ct.index=ft,g?(ft=ct.alternate,ft!==null?(ft=ft.index,ft<tt?(ct.flags|=67108866,tt):ft):(ct.flags|=67108866,tt)):(ct.flags|=1048576,tt)}function oe(ct){return g&&ct.alternate===null&&(ct.flags|=67108866),ct}function fe(ct,tt,ft,Dt){return tt===null||tt.tag!==6?(tt=Od(ft,ct.mode,Dt),tt.return=ct,tt):(tt=W(tt,ft),tt.return=ct,tt)}function _e(ct,tt,ft,Dt){var yn=ft.type;return yn===p?Kt(ct,tt,ft.props.children,Dt,ft.key):tt!==null&&(tt.elementType===yn||typeof yn=="object"&&yn!==null&&yn.$$typeof===F&&G0(yn)===tt.type)?(tt=W(tt,ft.props),Fu(tt,ft),tt.return=ct,tt):(tt=Pa(ft.type,ft.key,ft.props,null,ct.mode,Dt),Fu(tt,ft),tt.return=ct,tt)}function bt(ct,tt,ft,Dt){return tt===null||tt.tag!==4||tt.stateNode.containerInfo!==ft.containerInfo||tt.stateNode.implementation!==ft.implementation?(tt=YI(ft,ct.mode,Dt),tt.return=ct,tt):(tt=W(tt,ft.children||[]),tt.return=ct,tt)}function Kt(ct,tt,ft,Dt,yn){return tt===null||tt.tag!==7?(tt=xc(ft,ct.mode,Dt,yn),tt.return=ct,tt):(tt=W(tt,ft),tt.return=ct,tt)}function Ot(ct,tt,ft){if(typeof tt=="string"&&tt!==""||typeof tt=="number"||typeof tt=="bigint")return tt=Od(""+tt,ct.mode,ft),tt.return=ct,tt;if(typeof tt=="object"&&tt!==null){switch(tt.$$typeof){case h:return ft=Pa(tt.type,tt.key,tt.props,null,ct.mode,ft),Fu(ft,tt),ft.return=ct,ft;case m:return tt=YI(tt,ct.mode,ft),tt.return=ct,tt;case F:var Dt=tt._init;return tt=Dt(tt._payload),Ot(ct,tt,ft)}if($(tt)||_(tt))return tt=xc(tt,ct.mode,ft,null),tt.return=ct,tt;if(typeof tt.then=="function")return Ot(ct,sC(tt),ft);if(tt.$$typeof===R)return Ot(ct,Jd(ct,tt),ft);oh(ct,tt)}return null}function Gt(ct,tt,ft,Dt){var yn=tt!==null?tt.key:null;if(typeof ft=="string"&&ft!==""||typeof ft=="number"||typeof ft=="bigint")return yn!==null?null:fe(ct,tt,""+ft,Dt);if(typeof ft=="object"&&ft!==null){switch(ft.$$typeof){case h:return ft.key===yn?_e(ct,tt,ft,Dt):null;case m:return ft.key===yn?bt(ct,tt,ft,Dt):null;case F:return yn=ft._init,ft=yn(ft._payload),Gt(ct,tt,ft,Dt)}if($(ft)||_(ft))return yn!==null?null:Kt(ct,tt,ft,Dt,null);if(typeof ft.then=="function")return Gt(ct,tt,sC(ft),Dt);if(ft.$$typeof===R)return Gt(ct,tt,Jd(ct,ft),Dt);oh(ct,ft)}return null}function St(ct,tt,ft,Dt,yn){if(typeof Dt=="string"&&Dt!==""||typeof Dt=="number"||typeof Dt=="bigint")return ct=ct.get(ft)||null,fe(tt,ct,""+Dt,yn);if(typeof Dt=="object"&&Dt!==null){switch(Dt.$$typeof){case h:return ct=ct.get(Dt.key===null?ft:Dt.key)||null,_e(tt,ct,Dt,yn);case m:return ct=ct.get(Dt.key===null?ft:Dt.key)||null,bt(tt,ct,Dt,yn);case F:var gi=Dt._init;return Dt=gi(Dt._payload),St(ct,tt,ft,Dt,yn)}if($(Dt)||_(Dt))return ct=ct.get(ft)||null,Kt(tt,ct,Dt,yn,null);if(typeof Dt.then=="function")return St(ct,tt,ft,sC(Dt),yn);if(Dt.$$typeof===R)return St(ct,tt,ft,Jd(tt,Dt),yn);oh(tt,Dt)}return null}function Ln(ct,tt,ft,Dt){for(var yn=null,gi=null,Mn=tt,Tn=tt=0,So=null;Mn!==null&&Tn<ft.length;Tn++){Mn.index>Tn?(So=Mn,Mn=null):So=Mn.sibling;var Ei=Gt(ct,Mn,ft[Tn],Dt);if(Ei===null){Mn===null&&(Mn=So);break}g&&Mn&&Ei.alternate===null&&d(ct,Mn),tt=T(Ei,tt,Tn),gi===null?yn=Ei:gi.sibling=Ei,gi=Ei,Mn=So}if(Tn===ft.length)return A(ct,Mn),Si&&Tl(ct,Tn),yn;if(Mn===null){for(;Tn<ft.length;Tn++)Mn=Ot(ct,ft[Tn],Dt),Mn!==null&&(tt=T(Mn,tt,Tn),gi===null?yn=Mn:gi.sibling=Mn,gi=Mn);return Si&&Tl(ct,Tn),yn}for(Mn=G(Mn);Tn<ft.length;Tn++)So=St(Mn,ct,Tn,ft[Tn],Dt),So!==null&&(g&&So.alternate!==null&&Mn.delete(So.key===null?Tn:So.key),tt=T(So,tt,Tn),gi===null?yn=So:gi.sibling=So,gi=So);return g&&Mn.forEach(function($u){return d(ct,$u)}),Si&&Tl(ct,Tn),yn}function Fn(ct,tt,ft,Dt){if(ft==null)throw Error(i(151));for(var yn=null,gi=null,Mn=tt,Tn=tt=0,So=null,Ei=ft.next();Mn!==null&&!Ei.done;Tn++,Ei=ft.next()){Mn.index>Tn?(So=Mn,Mn=null):So=Mn.sibling;var $u=Gt(ct,Mn,Ei.value,Dt);if($u===null){Mn===null&&(Mn=So);break}g&&Mn&&$u.alternate===null&&d(ct,Mn),tt=T($u,tt,Tn),gi===null?yn=$u:gi.sibling=$u,gi=$u,Mn=So}if(Ei.done)return A(ct,Mn),Si&&Tl(ct,Tn),yn;if(Mn===null){for(;!Ei.done;Tn++,Ei=ft.next())Ei=Ot(ct,Ei.value,Dt),Ei!==null&&(tt=T(Ei,tt,Tn),gi===null?yn=Ei:gi.sibling=Ei,gi=Ei);return Si&&Tl(ct,Tn),yn}for(Mn=G(Mn);!Ei.done;Tn++,Ei=ft.next())Ei=St(Mn,ct,Tn,Ei.value,Dt),Ei!==null&&(g&&Ei.alternate!==null&&Mn.delete(Ei.key===null?Tn:Ei.key),tt=T(Ei,tt,Tn),gi===null?yn=Ei:gi.sibling=Ei,gi=Ei);return g&&Mn.forEach(function(d_){return d(ct,d_)}),Si&&Tl(ct,Tn),yn}function Qi(ct,tt,ft,Dt){if(typeof ft=="object"&&ft!==null&&ft.type===p&&ft.key===null&&(ft=ft.props.children),typeof ft=="object"&&ft!==null){switch(ft.$$typeof){case h:e:{for(var yn=ft.key;tt!==null;){if(tt.key===yn){if(yn=ft.type,yn===p){if(tt.tag===7){A(ct,tt.sibling),Dt=W(tt,ft.props.children),Dt.return=ct,ct=Dt;break e}}else if(tt.elementType===yn||typeof yn=="object"&&yn!==null&&yn.$$typeof===F&&G0(yn)===tt.type){A(ct,tt.sibling),Dt=W(tt,ft.props),Fu(Dt,ft),Dt.return=ct,ct=Dt;break e}A(ct,tt);break}else d(ct,tt);tt=tt.sibling}ft.type===p?(Dt=xc(ft.props.children,ct.mode,Dt,ft.key),Dt.return=ct,ct=Dt):(Dt=Pa(ft.type,ft.key,ft.props,null,ct.mode,Dt),Fu(Dt,ft),Dt.return=ct,ct=Dt)}return oe(ct);case m:e:{for(yn=ft.key;tt!==null;){if(tt.key===yn)if(tt.tag===4&&tt.stateNode.containerInfo===ft.containerInfo&&tt.stateNode.implementation===ft.implementation){A(ct,tt.sibling),Dt=W(tt,ft.children||[]),Dt.return=ct,ct=Dt;break e}else{A(ct,tt);break}else d(ct,tt);tt=tt.sibling}Dt=YI(ft,ct.mode,Dt),Dt.return=ct,ct=Dt}return oe(ct);case F:return yn=ft._init,ft=yn(ft._payload),Qi(ct,tt,ft,Dt)}if($(ft))return Ln(ct,tt,ft,Dt);if(_(ft)){if(yn=_(ft),typeof yn!="function")throw Error(i(150));return ft=yn.call(ft),Fn(ct,tt,ft,Dt)}if(typeof ft.then=="function")return Qi(ct,tt,sC(ft),Dt);if(ft.$$typeof===R)return Qi(ct,tt,Jd(ct,ft),Dt);oh(ct,ft)}return typeof ft=="string"&&ft!==""||typeof ft=="number"||typeof ft=="bigint"?(ft=""+ft,tt!==null&&tt.tag===6?(A(ct,tt.sibling),Dt=W(tt,ft),Dt.return=ct,ct=Dt):(A(ct,tt),Dt=Od(ft,ct.mode,Dt),Dt.return=ct,ct=Dt),oe(ct)):A(ct,tt)}return function(ct,tt,ft,Dt){try{rC=0;var yn=Qi(ct,tt,ft,Dt);return wg=null,yn}catch(Mn){if(Mn===$d||Mn===Zs)throw Mn;var gi=ar(29,Mn,null,ct.mode);return gi.lanes=Dt,gi.return=ct,gi}finally{}}}var Rg=S0(!0),w0=S0(!1),Li=O(null),Ms=null;function Tc(g){var d=g.alternate;ne(Ga,Ga.current&1),ne(Li,g),Ms===null&&(d===null||Vu.current!==null||d.memoizedState!==null)&&(Ms=g)}function R0(g){if(g.tag===22){if(ne(Ga,Ga.current),ne(Li,g),Ms===null){var d=g.alternate;d!==null&&d.memoizedState!==null&&(Ms=g)}}else Yc()}function Yc(){ne(Ga,Ga.current),ne(Li,Li.current)}function el(g){j(Li),Ms===g&&(Ms=null),j(Ga)}var Ga=O(0);function Ul(g){for(var d=g;d!==null;){if(d.tag===13){var A=d.memoizedState;if(A!==null&&(A=A.dehydrated,A===null||A.data==="$?"||jS(A)))return d}else if(d.tag===19&&d.memoizedProps.revealOrder!==void 0){if((d.flags&128)!==0)return d}else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===g)break;for(;d.sibling===null;){if(d.return===null||d.return===g)return null;d=d.return}d.sibling.return=d.return,d=d.sibling}return null}function zc(g,d,A,G){d=g.memoizedState,A=A(G,d),A=A==null?d:u({},d,A),g.memoizedState=A,g.lanes===0&&(g.updateQueue.baseState=A)}var zo={enqueueSetState:function(g,d,A){g=g._reactInternals;var G=Ia(),W=$s(G);W.payload=d,A!=null&&(W.callback=A),d=Ll(g,W,G),d!==null&&(Lo(d,g,G),Sg(d,g,G))},enqueueReplaceState:function(g,d,A){g=g._reactInternals;var G=Ia(),W=$s(G);W.tag=1,W.payload=d,A!=null&&(W.callback=A),d=Ll(g,W,G),d!==null&&(Lo(d,g,G),Sg(d,g,G))},enqueueForceUpdate:function(g,d){g=g._reactInternals;var A=Ia(),G=$s(A);G.tag=2,d!=null&&(G.callback=d),d=Ll(g,G,A),d!==null&&(Lo(d,g,A),Sg(d,g,A))}};function Z0(g,d,A,G,W,T,oe){return g=g.stateNode,typeof g.shouldComponentUpdate=="function"?g.shouldComponentUpdate(G,T,oe):d.prototype&&d.prototype.isPureReactComponent?!ws(A,G)||!ws(W,T):!0}function x0(g,d,A,G){g=d.state,typeof d.componentWillReceiveProps=="function"&&d.componentWillReceiveProps(A,G),typeof d.UNSAFE_componentWillReceiveProps=="function"&&d.UNSAFE_componentWillReceiveProps(A,G),d.state!==g&&zo.enqueueReplaceState(d,d.state,null)}function tl(g,d){var A=d;if("ref"in d){A={};for(var G in d)G!=="ref"&&(A[G]=d[G])}if(g=g.defaultProps){A===d&&(A=u({},A));for(var W in g)A[W]===void 0&&(A[W]=g[W])}return A}var Zg=typeof reportError=="function"?reportError:function(g){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var d=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof g=="object"&&g!==null&&typeof g.message=="string"?String(g.message):String(g),error:g});if(!window.dispatchEvent(d))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",g);return}console.error(g)};function lC(g){Zg(g)}function rh(g){console.error(g)}function M0(g){Zg(g)}function sh(g,d){try{var A=g.onUncaughtError;A(d.value,{componentStack:d.stack})}catch(G){setTimeout(function(){throw G})}}function os(g,d,A){try{var G=g.onCaughtError;G(A.value,{componentStack:A.stack,errorBoundary:d.tag===1?d.stateNode:null})}catch(W){setTimeout(function(){throw W})}}function lh(g,d,A){return A=$s(A),A.tag=3,A.payload={element:null},A.callback=function(){sh(g,d)},A}function W0(g){return g=$s(g),g.tag=3,g}function ch(g,d,A,G){var W=A.type.getDerivedStateFromError;if(typeof W=="function"){var T=G.value;g.payload=function(){return W(T)},g.callback=function(){os(d,A,G)}}var oe=A.stateNode;oe!==null&&typeof oe.componentDidCatch=="function"&&(g.callback=function(){os(d,A,G),typeof W!="function"&&(Er===null?Er=new Set([this]):Er.add(this));var fe=G.stack;this.componentDidCatch(G.value,{componentStack:fe!==null?fe:""})})}function FS(g,d,A,G,W){if(A.flags|=32768,G!==null&&typeof G=="object"&&typeof G.then=="function"){if(d=A.alternate,d!==null&&ts(d,A,W,!0),A=Li.current,A!==null){switch(A.tag){case 13:return Ms===null?I():A.alternate===null&&ta===0&&(ta=3),A.flags&=-257,A.flags|=65536,A.lanes=W,G===eC?A.flags|=16384:(d=A.updateQueue,d===null?A.updateQueue=new Set([G]):d.add(G),wt(g,G,W)),!1;case 22:return A.flags|=65536,G===eC?A.flags|=16384:(d=A.updateQueue,d===null?(d={transitions:null,markerInstances:null,retryQueue:new Set([G])},A.updateQueue=d):(A=d.retryQueue,A===null?d.retryQueue=new Set([G]):A.add(G)),wt(g,G,W)),!1}throw Error(i(435,A.tag))}return wt(g,G,W),I(),!1}if(Si)return d=Li.current,d!==null?((d.flags&65536)===0&&(d.flags|=256),d.flags|=65536,d.lanes=W,G!==KI&&(g=Error(i(422),{cause:G}),Gg(so(g,A)))):(G!==KI&&(d=Error(i(423),{cause:G}),Gg(so(d,A))),g=g.current.alternate,g.flags|=65536,W&=-W,g.lanes|=W,G=so(G,A),W=lh(g.stateNode,G,W),xu(g,W),ta!==4&&(ta=2)),!1;var T=Error(i(520),{cause:G});if(T=so(T,A),Ni===null?Ni=[T]:Ni.push(T),ta!==4&&(ta=2),d===null)return!0;G=so(G,A),A=d;do{switch(A.tag){case 3:return A.flags|=65536,g=W&-W,A.lanes|=g,g=lh(A.stateNode,G,g),xu(A,g),!1;case 1:if(d=A.type,T=A.stateNode,(A.flags&128)===0&&(typeof d.getDerivedStateFromError=="function"||T!==null&&typeof T.componentDidCatch=="function"&&(Er===null||!Er.has(T))))return A.flags|=65536,W&=-W,A.lanes|=W,W=W0(W),ch(W,g,A,G),xu(A,W),!1}A=A.return}while(A!==null);return!1}var V0=Error(i(461)),Ja=!1;function Sa(g,d,A,G){d.child=g===null?w0(d,null,A,G):Rg(d,g.child,A,G)}function rr(g,d,A,G,W){A=A.render;var T=d.ref;if("ref"in G){var oe={};for(var fe in G)fe!=="ref"&&(oe[fe]=G[fe])}else oe=G;return qs(d),G=Dl(g,d,A,oe,T,W),fe=FA(),g!==null&&!Ja?(jI(g,d,W),ja(g,d,W)):(Si&&fe&&SA(d),d.flags|=1,Sa(g,d,G,W),d.child)}function sr(g,d,A,G,W){if(g===null){var T=A.type;return typeof T=="function"&&!Dd(T)&&T.defaultProps===void 0&&A.compare===null?(d.tag=15,d.type=T,qA(g,d,T,G,W)):(g=Pa(A.type,null,G,d,d.mode,W),g.ref=d.ref,g.return=d,d.child=g)}if(T=g.child,!cC(g,W)){var oe=T.memoizedProps;if(A=A.compare,A=A!==null?A:ws,A(oe,G)&&g.ref===d.ref)return ja(g,d,W)}return d.flags|=1,g=ya(T,G),g.ref=d.ref,g.return=d,d.child=g}function qA(g,d,A,G,W){if(g!==null){var T=g.memoizedProps;if(ws(T,G)&&g.ref===d.ref)if(Ja=!1,d.pendingProps=G=T,cC(g,W))(g.flags&131072)!==0&&(Ja=!0);else return d.lanes=g.lanes,ja(g,d,W)}return Xu(g,d,A,G,W)}function xg(g,d,A){var G=d.pendingProps,W=G.children,T=g!==null?g.memoizedState:null;if(G.mode==="hidden"){if((d.flags&128)!==0){if(G=T!==null?T.baseLanes|A:A,g!==null){for(W=d.child=g.child,T=0;W!==null;)T=T|W.lanes|W.childLanes,W=W.sibling;d.childLanes=T&~G}else d.childLanes=0,d.child=null;return Mg(g,d,G,A)}if((A&536870912)!==0)d.memoizedState={baseLanes:0,cachePool:null},g!==null&&qd(d,T!==null?T.cachePool:null),T!==null?Pb(d,T):HA(),R0(d);else return d.lanes=d.childLanes=536870912,Mg(g,d,T!==null?T.baseLanes|A:A,A)}else T!==null?(qd(d,T.cachePool),Pb(d,T),Yc(),d.memoizedState=null):(g!==null&&qd(d,null),HA(),Yc());return Sa(g,d,W,A),d.child}function Mg(g,d,A,G){var W=Ec();return W=W===null?null:{parent:Ma._currentValue,pool:W},d.memoizedState={baseLanes:A,cachePool:W},g!==null&&qd(d,null),HA(),R0(d),g!==null&&ts(g,d,G,!0),null}function Wg(g,d){var A=d.ref;if(A===null)g!==null&&g.ref!==null&&(d.flags|=4194816);else{if(typeof A!="function"&&typeof A!="object")throw Error(i(284));(g===null||g.ref!==A)&&(d.flags|=4194816)}}function Xu(g,d,A,G,W){return qs(d),A=Dl(g,d,A,G,void 0,W),G=FA(),g!==null&&!Ja?(jI(g,d,W),ja(g,d,W)):(Si&&G&&SA(d),d.flags|=1,Sa(g,d,A,W),d.child)}function Rr(g,d,A,G,W,T){return qs(d),d.updateQueue=null,A=Qb(d,G,A,W),jb(g),G=FA(),g!==null&&!Ja?(jI(g,d,T),ja(g,d,T)):(Si&&G&&SA(d),d.flags|=1,Sa(g,d,A,T),d.child)}function Zr(g,d,A,G,W){if(qs(d),d.stateNode===null){var T=Zc,oe=A.contextType;typeof oe=="object"&&oe!==null&&(T=ua(oe)),T=new A(G,T),d.memoizedState=T.state!==null&&T.state!==void 0?T.state:null,T.updater=zo,d.stateNode=T,T._reactInternals=d,T=d.stateNode,T.props=G,T.state=d.memoizedState,T.refs={},NA(d),oe=A.contextType,T.context=typeof oe=="object"&&oe!==null?ua(oe):Zc,T.state=d.memoizedState,oe=A.getDerivedStateFromProps,typeof oe=="function"&&(zc(d,A,oe,G),T.state=d.memoizedState),typeof A.getDerivedStateFromProps=="function"||typeof T.getSnapshotBeforeUpdate=="function"||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(oe=T.state,typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount(),oe!==T.state&&zo.enqueueReplaceState(T,T.state,null),Mu(d,G,T,W),tC(),T.state=d.memoizedState),typeof T.componentDidMount=="function"&&(d.flags|=4194308),G=!0}else if(g===null){T=d.stateNode;var fe=d.memoizedProps,_e=tl(A,fe);T.props=_e;var bt=T.context,Kt=A.contextType;oe=Zc,typeof Kt=="object"&&Kt!==null&&(oe=ua(Kt));var Ot=A.getDerivedStateFromProps;Kt=typeof Ot=="function"||typeof T.getSnapshotBeforeUpdate=="function",fe=d.pendingProps!==fe,Kt||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||(fe||bt!==oe)&&x0(d,T,G,oe),Kl=!1;var Gt=d.memoizedState;T.state=Gt,Mu(d,G,T,W),tC(),bt=d.memoizedState,fe||Gt!==bt||Kl?(typeof Ot=="function"&&(zc(d,A,Ot,G),bt=d.memoizedState),(_e=Kl||Z0(d,A,_e,G,Gt,bt,oe))?(Kt||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount()),typeof T.componentDidMount=="function"&&(d.flags|=4194308)):(typeof T.componentDidMount=="function"&&(d.flags|=4194308),d.memoizedProps=G,d.memoizedState=bt),T.props=G,T.state=bt,T.context=oe,G=_e):(typeof T.componentDidMount=="function"&&(d.flags|=4194308),G=!1)}else{T=d.stateNode,Yn(g,d),oe=d.memoizedProps,Kt=tl(A,oe),T.props=Kt,Ot=d.pendingProps,Gt=T.context,bt=A.contextType,_e=Zc,typeof bt=="object"&&bt!==null&&(_e=ua(bt)),fe=A.getDerivedStateFromProps,(bt=typeof fe=="function"||typeof T.getSnapshotBeforeUpdate=="function")||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||(oe!==Ot||Gt!==_e)&&x0(d,T,G,_e),Kl=!1,Gt=d.memoizedState,T.state=Gt,Mu(d,G,T,W),tC();var St=d.memoizedState;oe!==Ot||Gt!==St||Kl||g!==null&&g.dependencies!==null&&Pd(g.dependencies)?(typeof fe=="function"&&(zc(d,A,fe,G),St=d.memoizedState),(Kt=Kl||Z0(d,A,Kt,G,Gt,St,_e)||g!==null&&g.dependencies!==null&&Pd(g.dependencies))?(bt||typeof T.UNSAFE_componentWillUpdate!="function"&&typeof T.componentWillUpdate!="function"||(typeof T.componentWillUpdate=="function"&&T.componentWillUpdate(G,St,_e),typeof T.UNSAFE_componentWillUpdate=="function"&&T.UNSAFE_componentWillUpdate(G,St,_e)),typeof T.componentDidUpdate=="function"&&(d.flags|=4),typeof T.getSnapshotBeforeUpdate=="function"&&(d.flags|=1024)):(typeof T.componentDidUpdate!="function"||oe===g.memoizedProps&&Gt===g.memoizedState||(d.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||oe===g.memoizedProps&&Gt===g.memoizedState||(d.flags|=1024),d.memoizedProps=G,d.memoizedState=St),T.props=G,T.state=St,T.context=_e,G=Kt):(typeof T.componentDidUpdate!="function"||oe===g.memoizedProps&&Gt===g.memoizedState||(d.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||oe===g.memoizedProps&&Gt===g.memoizedState||(d.flags|=1024),G=!1)}return T=G,Wg(g,d),G=(d.flags&128)!==0,T||G?(T=d.stateNode,A=G&&typeof A.getDerivedStateFromError!="function"?null:T.render(),d.flags|=1,g!==null&&G?(d.child=Rg(d,g.child,null,W),d.child=Rg(d,null,A,W)):Sa(g,d,A,W),d.memoizedState=T.state,g=d.child):g=ja(g,d,W),g}function Kc(g,d,A,G){return Gu(),d.flags|=256,Sa(g,d,A,G),d.child}var Ws={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Vs(g){return{baseLanes:g,cachePool:OI()}}function Fa(g,d,A){return g=g!==null?g.childLanes&~A:0,d&&(g|=gs),g}function Tu(g,d,A){var G=d.pendingProps,W=!1,T=(d.flags&128)!==0,oe;if((oe=T)||(oe=g!==null&&g.memoizedState===null?!1:(Ga.current&2)!==0),oe&&(W=!0,d.flags&=-129),oe=(d.flags&32)!==0,d.flags&=-33,g===null){if(Si){if(W?Tc(d):Yc(),Si){var fe=sa,_e;if(_e=fe){e:{for(_e=fe,fe=Gr;_e.nodeType!==8;){if(!fe){fe=null;break e}if(_e=ql(_e.nextSibling),_e===null){fe=null;break e}}fe=_e}fe!==null?(d.memoizedState={dehydrated:fe,treeContext:Mc!==null?{id:js,overflow:Qs}:null,retryLane:536870912,hydrationErrors:null},_e=ar(18,null,null,0),_e.stateNode=fe,_e.return=d,d.child=_e,Xo=d,sa=null,_e=!0):_e=!1}_e||Wc(d)}if(fe=d.memoizedState,fe!==null&&(fe=fe.dehydrated,fe!==null))return jS(fe)?d.lanes=32:d.lanes=536870912,null;el(d)}return fe=G.children,G=G.fallback,W?(Yc(),W=d.mode,fe=Vg({mode:"hidden",children:fe},W),G=xc(G,W,A,null),fe.return=d,G.return=d,fe.sibling=G,d.child=fe,W=d.child,W.memoizedState=Vs(A),W.childLanes=Fa(g,oe,A),d.memoizedState=Ws,G):(Tc(d),nl(d,fe))}if(_e=g.memoizedState,_e!==null&&(fe=_e.dehydrated,fe!==null)){if(T)d.flags&256?(Tc(d),d.flags&=-257,d=go(g,d,A)):d.memoizedState!==null?(Yc(),d.child=g.child,d.flags|=128,d=null):(Yc(),W=G.fallback,fe=d.mode,G=Vg({mode:"visible",children:G.children},fe),W=xc(W,fe,A,null),W.flags|=2,G.return=d,W.return=d,G.sibling=W,d.child=G,Rg(d,g.child,null,A),G=d.child,G.memoizedState=Vs(A),G.childLanes=Fa(g,oe,A),d.memoizedState=Ws,d=W);else if(Tc(d),jS(fe)){if(oe=fe.nextSibling&&fe.nextSibling.dataset,oe)var bt=oe.dgst;oe=bt,G=Error(i(419)),G.stack="",G.digest=oe,Gg({value:G,source:null,stack:null}),d=go(g,d,A)}else if(Ja||ts(g,d,A,!1),oe=(A&g.childLanes)!==0,Ja||oe){if(oe=On,oe!==null&&(G=A&-A,G=(G&42)!==0?1:Lt(G),G=(G&(oe.suspendedLanes|A))!==0?0:G,G!==0&&G!==_e.retryLane))throw _e.retryLane=G,Xl(g,G),Lo(oe,g,G),V0;fe.data==="$?"||I(),d=go(g,d,A)}else fe.data==="$?"?(d.flags|=192,d.child=g.child,d=null):(g=_e.treeContext,sa=ql(fe.nextSibling),Xo=d,Si=!0,es=null,Gr=!1,g!==null&&(lo[Br++]=js,lo[Br++]=Qs,lo[Br++]=Mc,js=g.id,Qs=g.overflow,Mc=d),d=nl(d,G.children),d.flags|=4096);return d}return W?(Yc(),W=G.fallback,fe=d.mode,_e=g.child,bt=_e.sibling,G=ya(_e,{mode:"hidden",children:G.children}),G.subtreeFlags=_e.subtreeFlags&65011712,bt!==null?W=ya(bt,W):(W=xc(W,fe,A,null),W.flags|=2),W.return=d,G.return=d,G.sibling=W,d.child=G,G=W,W=d.child,fe=g.child.memoizedState,fe===null?fe=Vs(A):(_e=fe.cachePool,_e!==null?(bt=Ma._currentValue,_e=_e.parent!==bt?{parent:bt,pool:bt}:_e):_e=OI(),fe={baseLanes:fe.baseLanes|A,cachePool:_e}),W.memoizedState=fe,W.childLanes=Fa(g,oe,A),d.memoizedState=Ws,G):(Tc(d),A=g.child,g=A.sibling,A=ya(A,{mode:"visible",children:G.children}),A.return=d,A.sibling=null,g!==null&&(oe=d.deletions,oe===null?(d.deletions=[g],d.flags|=16):oe.push(g)),d.child=A,d.memoizedState=null,A)}function nl(g,d){return d=Vg({mode:"visible",children:d},g.mode),d.return=g,g.child=d}function Vg(g,d){return g=ar(22,g,null,d),g.lanes=0,g.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},g}function go(g,d,A){return Rg(d,g.child,null,A),g=nl(d,d.pendingProps.children),g.flags|=2,d.memoizedState=null,g}function uo(g,d,A){g.lanes|=d;var G=g.alternate;G!==null&&(G.lanes|=d),xA(g.return,d,A)}function fi(g,d,A,G,W){var T=g.memoizedState;T===null?g.memoizedState={isBackwards:d,rendering:null,renderingStartTime:0,last:G,tail:A,tailMode:W}:(T.isBackwards=d,T.rendering=null,T.renderingStartTime=0,T.last=G,T.tail=A,T.tailMode=W)}function rs(g,d,A){var G=d.pendingProps,W=G.revealOrder,T=G.tail;if(Sa(g,d,G.children,A),G=Ga.current,(G&2)!==0)G=G&1|2,d.flags|=128;else{if(g!==null&&(g.flags&128)!==0)e:for(g=d.child;g!==null;){if(g.tag===13)g.memoizedState!==null&&uo(g,A,d);else if(g.tag===19)uo(g,A,d);else if(g.child!==null){g.child.return=g,g=g.child;continue}if(g===d)break e;for(;g.sibling===null;){if(g.return===null||g.return===d)break e;g=g.return}g.sibling.return=g.return,g=g.sibling}G&=1}switch(ne(Ga,G),W){case"forwards":for(A=d.child,W=null;A!==null;)g=A.alternate,g!==null&&Ul(g)===null&&(W=A),A=A.sibling;A=W,A===null?(W=d.child,d.child=null):(W=A.sibling,A.sibling=null),fi(d,!1,W,A,T);break;case"backwards":for(A=null,W=d.child,d.child=null;W!==null;){if(g=W.alternate,g!==null&&Ul(g)===null){d.child=W;break}g=W.sibling,W.sibling=A,A=W,W=g}fi(d,!0,A,null,T);break;case"together":fi(d,!1,null,null,void 0);break;default:d.memoizedState=null}return d.child}function ja(g,d,A){if(g!==null&&(d.dependencies=g.dependencies),Fs|=d.lanes,(A&d.childLanes)===0)if(g!==null){if(ts(g,d,A,!1),(A&d.childLanes)===0)return null}else return null;if(g!==null&&d.child!==g.child)throw Error(i(153));if(d.child!==null){for(g=d.child,A=ya(g,g.pendingProps),d.child=A,A.return=d;g.sibling!==null;)g=g.sibling,A=A.sibling=ya(g,g.pendingProps),A.return=d;A.sibling=null}return d.child}function cC(g,d){return(g.lanes&d)!==0?!0:(g=g.dependencies,!!(g!==null&&Pd(g)))}function ss(g,d,A){switch(d.tag){case 3:de(d,d.stateNode.containerInfo),Nc(d,Ma,g.memoizedState.cache),Gu();break;case 27:case 5:Ne(d);break;case 4:de(d,d.stateNode.containerInfo);break;case 10:Nc(d,d.type,d.memoizedProps.value);break;case 13:var G=d.memoizedState;if(G!==null)return G.dehydrated!==null?(Tc(d),d.flags|=128,null):(A&d.child.childLanes)!==0?Tu(g,d,A):(Tc(d),g=ja(g,d,A),g!==null?g.sibling:null);Tc(d);break;case 19:var W=(g.flags&128)!==0;if(G=(A&d.childLanes)!==0,G||(ts(g,d,A,!1),G=(A&d.childLanes)!==0),W){if(G)return rs(g,d,A);d.flags|=128}if(W=d.memoizedState,W!==null&&(W.rendering=null,W.tail=null,W.lastEffect=null),ne(Ga,Ga.current),G)break;return null;case 22:case 23:return d.lanes=0,xg(g,d,A);case 24:Nc(d,Ma,g.memoizedState.cache)}return ja(g,d,A)}function Ng(g,d,A){if(g!==null)if(g.memoizedProps!==d.pendingProps)Ja=!0;else{if(!cC(g,A)&&(d.flags&128)===0)return Ja=!1,ss(g,d,A);Ja=(g.flags&131072)!==0}else Ja=!1,Si&&(d.flags&1048576)!==0&&zI(d,Bu,d.index);switch(d.lanes=0,d.tag){case 16:e:{g=d.pendingProps;var G=d.elementType,W=G._init;if(G=W(G._payload),d.type=G,typeof G=="function")Dd(G)?(g=tl(G,g),d.tag=1,d=Zr(null,d,G,g,A)):(d.tag=0,d=Xu(null,d,G,g,A));else{if(G!=null){if(W=G.$$typeof,W===Z){d.tag=11,d=rr(null,d,G,g,A);break e}else if(W===E){d.tag=14,d=sr(null,d,G,g,A);break e}}throw d=P(G)||G,Error(i(306,d,""))}}return d;case 0:return Xu(g,d,d.type,d.pendingProps,A);case 1:return G=d.type,W=tl(G,d.pendingProps),Zr(g,d,G,W,A);case 3:e:{if(de(d,d.stateNode.containerInfo),g===null)throw Error(i(387));G=d.pendingProps;var T=d.memoizedState;W=T.element,Yn(g,d),Mu(d,G,null,A);var oe=d.memoizedState;if(G=oe.cache,Nc(d,Ma,G),G!==T.cache&&kd(d,[Ma],A,!0),tC(),G=oe.element,T.isDehydrated)if(T={element:G,isDehydrated:!1,cache:oe.cache},d.updateQueue.baseState=T,d.memoizedState=T,d.flags&256){d=Kc(g,d,G,A);break e}else if(G!==W){W=so(Error(i(424)),d),Gg(W),d=Kc(g,d,G,A);break e}else{switch(g=d.stateNode.containerInfo,g.nodeType){case 9:g=g.body;break;default:g=g.nodeName==="HTML"?g.ownerDocument.body:g}for(sa=ql(g.firstChild),Xo=d,Si=!0,es=null,Gr=!0,A=w0(d,null,G,A),d.child=A;A;)A.flags=A.flags&-3|4096,A=A.sibling}else{if(Gu(),G===W){d=ja(g,d,A);break e}Sa(g,d,G,A)}d=d.child}return d;case 26:return Wg(g,d),g===null?(A=AW(d.type,null,d.pendingProps,null))?d.memoizedState=A:Si||(A=d.type,g=d.pendingProps,G=T0(re.current).createElement(A),G[Ut]=d,G[Nt]=g,_o(G,A,g),at(G),d.stateNode=G):d.memoizedState=AW(d.type,g.memoizedProps,d.pendingProps,g.memoizedState),null;case 27:return Ne(d),g===null&&Si&&(G=d.stateNode=IW(d.type,d.pendingProps,re.current),Xo=d,Gr=!0,W=sa,Pu(d.type)?(QS=W,sa=ql(G.firstChild)):sa=W),Sa(g,d,d.pendingProps.children,A),Wg(g,d),g===null&&(d.flags|=4194304),d.child;case 5:return g===null&&Si&&((W=G=sa)&&(G=KL(G,d.type,d.pendingProps,Gr),G!==null?(d.stateNode=G,Xo=d,sa=ql(G.firstChild),Gr=!1,W=!0):W=!1),W||Wc(d)),Ne(d),W=d.type,T=d.pendingProps,oe=g!==null?g.memoizedProps:null,G=T.children,kS(W,T)?G=null:oe!==null&&kS(W,oe)&&(d.flags|=32),d.memoizedState!==null&&(W=Dl(g,d,MS,null,null,A),cm._currentValue=W),Wg(g,d),Sa(g,d,G,A),d.child;case 6:return g===null&&Si&&((g=A=sa)&&(A=LL(A,d.pendingProps,Gr),A!==null?(d.stateNode=A,Xo=d,sa=null,g=!0):g=!1),g||Wc(d)),null;case 13:return Tu(g,d,A);case 4:return de(d,d.stateNode.containerInfo),G=d.pendingProps,g===null?d.child=Rg(d,null,G,A):Sa(g,d,G,A),d.child;case 11:return rr(g,d,d.type,d.pendingProps,A);case 7:return Sa(g,d,d.pendingProps,A),d.child;case 8:return Sa(g,d,d.pendingProps.children,A),d.child;case 12:return Sa(g,d,d.pendingProps.children,A),d.child;case 10:return G=d.pendingProps,Nc(d,d.type,G.value),Sa(g,d,G.children,A),d.child;case 9:return W=d.type._context,G=d.pendingProps.children,qs(d),W=ua(W),G=G(W),d.flags|=1,Sa(g,d,G,A),d.child;case 14:return sr(g,d,d.type,d.pendingProps,A);case 15:return qA(g,d,d.type,d.pendingProps,A);case 19:return rs(g,d,A);case 31:return G=d.pendingProps,A=d.mode,G={mode:G.mode,children:G.children},g===null?(A=Vg(G,A),A.ref=d.ref,d.child=A,A.return=d,d=A):(A=ya(g.child,G),A.ref=d.ref,d.child=A,A.return=d,d=A),d;case 22:return xg(g,d,A);case 24:return qs(d),G=ua(Ma),g===null?(W=Ec(),W===null&&(W=On,T=_I(),W.pooledCache=T,T.refCount++,T!==null&&(W.pooledCacheLanes|=A),W=T),d.memoizedState={parent:G,cache:W},NA(d),Nc(d,Ma,W)):((g.lanes&A)!==0&&(Yn(g,d),Mu(d,null,null,A),tC()),W=g.memoizedState,T=d.memoizedState,W.parent!==G?(W={parent:G,cache:G},d.memoizedState=W,d.lanes===0&&(d.memoizedState=d.updateQueue.baseState=W),Nc(d,Ma,G)):(G=T.cache,Nc(d,Ma,G),G!==W.cache&&kd(d,[Ma],A,!0))),Sa(g,d,d.pendingProps.children,A),d.child;case 29:throw d.pendingProps}throw Error(i(156,d.tag))}function Ns(g){g.flags|=4}function gC(g,d){if(d.type!=="stylesheet"||(d.state.loading&4)!==0)g.flags&=-16777217;else if(g.flags|=16777216,!yW(d)){if(d=Li.current,d!==null&&((Wn&4194048)===Wn?Ms!==null:(Wn&62914560)!==Wn&&(Wn&536870912)===0||d!==Ms))throw is=eC,WA;g.flags|=8192}}function kl(g,d){d!==null&&(g.flags|=4),g.flags&16384&&(d=g.tag!==22?ze():536870912,g.lanes|=d,bi|=d)}function Eg(g,d){if(!Si)switch(g.tailMode){case"hidden":d=g.tail;for(var A=null;d!==null;)d.alternate!==null&&(A=d),d=d.sibling;A===null?g.tail=null:A.sibling=null;break;case"collapsed":A=g.tail;for(var G=null;A!==null;)A.alternate!==null&&(G=A),A=A.sibling;G===null?d||g.tail===null?g.tail=null:g.tail.sibling=null:G.sibling=null}}function ki(g){var d=g.alternate!==null&&g.alternate.child===g.child,A=0,G=0;if(d)for(var W=g.child;W!==null;)A|=W.lanes|W.childLanes,G|=W.subtreeFlags&65011712,G|=W.flags&65011712,W.return=g,W=W.sibling;else for(W=g.child;W!==null;)A|=W.lanes|W.childLanes,G|=W.subtreeFlags,G|=W.flags,W.return=g,W=W.sibling;return g.subtreeFlags|=G,g.childLanes=A,d}function $A(g,d,A){var G=d.pendingProps;switch(wA(d),d.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ki(d),null;case 1:return ki(d),null;case 3:return A=d.stateNode,G=null,g!==null&&(G=g.memoizedState.cache),d.memoizedState.cache!==G&&(d.flags|=2048),zl(Ma),xe(),A.pendingContext&&(A.context=A.pendingContext,A.pendingContext=null),(g===null||g.child===null)&&(Rs(d)?Ns(d):g===null||g.memoizedState.isDehydrated&&(d.flags&256)===0||(d.flags|=1024,Wi())),ki(d),null;case 26:return A=d.memoizedState,g===null?(Ns(d),A!==null?(ki(d),gC(d,A)):(ki(d),d.flags&=-16777217)):A?A!==g.memoizedState?(Ns(d),ki(d),gC(d,A)):(ki(d),d.flags&=-16777217):(g.memoizedProps!==G&&Ns(d),ki(d),d.flags&=-16777217),null;case 27:ye(d),A=re.current;var W=d.type;if(g!==null&&d.stateNode!=null)g.memoizedProps!==G&&Ns(d);else{if(!G){if(d.stateNode===null)throw Error(i(166));return ki(d),null}g=k.current,Rs(d)?Db(d):(g=IW(W,G,A),d.stateNode=g,Ns(d))}return ki(d),null;case 5:if(ye(d),A=d.type,g!==null&&d.stateNode!=null)g.memoizedProps!==G&&Ns(d);else{if(!G){if(d.stateNode===null)throw Error(i(166));return ki(d),null}if(g=k.current,Rs(d))Db(d);else{switch(W=T0(re.current),g){case 1:g=W.createElementNS("http://www.w3.org/2000/svg",A);break;case 2:g=W.createElementNS("http://www.w3.org/1998/Math/MathML",A);break;default:switch(A){case"svg":g=W.createElementNS("http://www.w3.org/2000/svg",A);break;case"math":g=W.createElementNS("http://www.w3.org/1998/Math/MathML",A);break;case"script":g=W.createElement("div"),g.innerHTML="<script><\/script>",g=g.removeChild(g.firstChild);break;case"select":g=typeof G.is=="string"?W.createElement("select",{is:G.is}):W.createElement("select"),G.multiple?g.multiple=!0:G.size&&(g.size=G.size);break;default:g=typeof G.is=="string"?W.createElement(A,{is:G.is}):W.createElement(A)}}g[Ut]=d,g[Nt]=G;e:for(W=d.child;W!==null;){if(W.tag===5||W.tag===6)g.appendChild(W.stateNode);else if(W.tag!==4&&W.tag!==27&&W.child!==null){W.child.return=W,W=W.child;continue}if(W===d)break e;for(;W.sibling===null;){if(W.return===null||W.return===d)break e;W=W.return}W.sibling.return=W.return,W=W.sibling}d.stateNode=g;e:switch(_o(g,A,G),A){case"button":case"input":case"select":case"textarea":g=!!G.autoFocus;break e;case"img":g=!0;break e;default:g=!1}g&&Ns(d)}}return ki(d),d.flags&=-16777217,null;case 6:if(g&&d.stateNode!=null)g.memoizedProps!==G&&Ns(d);else{if(typeof G!="string"&&d.stateNode===null)throw Error(i(166));if(g=re.current,Rs(d)){if(g=d.stateNode,A=d.memoizedProps,G=null,W=Xo,W!==null)switch(W.tag){case 27:case 5:G=W.memoizedProps}g[Ut]=d,g=!!(g.nodeValue===A||G!==null&&G.suppressHydrationWarning===!0||sW(g.nodeValue,A)),g||Wc(d)}else g=T0(g).createTextNode(G),g[Ut]=d,d.stateNode=g}return ki(d),null;case 13:if(G=d.memoizedState,g===null||g.memoizedState!==null&&g.memoizedState.dehydrated!==null){if(W=Rs(d),G!==null&&G.dehydrated!==null){if(g===null){if(!W)throw Error(i(318));if(W=d.memoizedState,W=W!==null?W.dehydrated:null,!W)throw Error(i(317));W[Ut]=d}else Gu(),(d.flags&128)===0&&(d.memoizedState=null),d.flags|=4;ki(d),W=!1}else W=Wi(),g!==null&&g.memoizedState!==null&&(g.memoizedState.hydrationErrors=W),W=!0;if(!W)return d.flags&256?(el(d),d):(el(d),null)}if(el(d),(d.flags&128)!==0)return d.lanes=A,d;if(A=G!==null,g=g!==null&&g.memoizedState!==null,A){G=d.child,W=null,G.alternate!==null&&G.alternate.memoizedState!==null&&G.alternate.memoizedState.cachePool!==null&&(W=G.alternate.memoizedState.cachePool.pool);var T=null;G.memoizedState!==null&&G.memoizedState.cachePool!==null&&(T=G.memoizedState.cachePool.pool),T!==W&&(G.flags|=2048)}return A!==g&&A&&(d.child.flags|=8192),kl(d,d.updateQueue),ki(d),null;case 4:return xe(),g===null&&LS(d.stateNode.containerInfo),ki(d),null;case 10:return zl(d.type),ki(d),null;case 19:if(j(Ga),W=d.memoizedState,W===null)return ki(d),null;if(G=(d.flags&128)!==0,T=W.rendering,T===null)if(G)Eg(W,!1);else{if(ta!==0||g!==null&&(g.flags&128)!==0)for(g=d.child;g!==null;){if(T=Ul(g),T!==null){for(d.flags|=128,Eg(W,!1),g=T.updateQueue,d.updateQueue=g,kl(d,g),d.subtreeFlags=0,g=A,A=d.child;A!==null;)GA(A,g),A=A.sibling;return ne(Ga,Ga.current&1|2),d.child}g=g.sibling}W.tail!==null&&Ge()>Bo&&(d.flags|=128,G=!0,Eg(W,!1),d.lanes=4194304)}else{if(!G)if(g=Ul(T),g!==null){if(d.flags|=128,G=!0,g=g.updateQueue,d.updateQueue=g,kl(d,g),Eg(W,!0),W.tail===null&&W.tailMode==="hidden"&&!T.alternate&&!Si)return ki(d),null}else 2*Ge()-W.renderingStartTime>Bo&&A!==536870912&&(d.flags|=128,G=!0,Eg(W,!1),d.lanes=4194304);W.isBackwards?(T.sibling=d.child,d.child=T):(g=W.last,g!==null?g.sibling=T:d.child=T,W.last=T)}return W.tail!==null?(d=W.tail,W.rendering=d,W.tail=d.sibling,W.renderingStartTime=Ge(),d.sibling=null,g=Ga.current,ne(Ga,G?g&1|2:g&1),d):(ki(d),null);case 22:case 23:return el(d),nC(),G=d.memoizedState!==null,g!==null?g.memoizedState!==null!==G&&(d.flags|=8192):G&&(d.flags|=8192),G?(A&536870912)!==0&&(d.flags&128)===0&&(ki(d),d.subtreeFlags&6&&(d.flags|=8192)):ki(d),A=d.updateQueue,A!==null&&kl(d,A.retryQueue),A=null,g!==null&&g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(A=g.memoizedState.cachePool.pool),G=null,d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(G=d.memoizedState.cachePool.pool),G!==A&&(d.flags|=2048),g!==null&&j(ns),null;case 24:return A=null,g!==null&&(A=g.memoizedState.cache),d.memoizedState.cache!==A&&(d.flags|=2048),zl(Ma),ki(d),null;case 25:return null;case 30:return null}throw Error(i(156,d.tag))}function Yu(g,d){switch(wA(d),d.tag){case 1:return g=d.flags,g&65536?(d.flags=g&-65537|128,d):null;case 3:return zl(Ma),xe(),g=d.flags,(g&65536)!==0&&(g&128)===0?(d.flags=g&-65537|128,d):null;case 26:case 27:case 5:return ye(d),null;case 13:if(el(d),g=d.memoizedState,g!==null&&g.dehydrated!==null){if(d.alternate===null)throw Error(i(340));Gu()}return g=d.flags,g&65536?(d.flags=g&-65537|128,d):null;case 19:return j(Ga),null;case 4:return xe(),null;case 10:return zl(d.type),null;case 22:case 23:return el(d),nC(),g!==null&&j(ns),g=d.flags,g&65536?(d.flags=g&-65537|128,d):null;case 24:return zl(Ma),null;case 25:return null;default:return null}}function zu(g,d){switch(wA(d),d.tag){case 3:zl(Ma),xe();break;case 26:case 27:case 5:ye(d);break;case 4:xe();break;case 13:el(d);break;case 19:j(Ga);break;case 10:zl(d.type);break;case 22:case 23:el(d),nC(),g!==null&&j(ns);break;case 24:zl(Ma)}}function Hg(g,d){try{var A=d.updateQueue,G=A!==null?A.lastEffect:null;if(G!==null){var W=G.next;A=W;do{if((A.tag&g)===g){G=void 0;var T=A.create,oe=A.inst;G=T(),oe.destroy=G}A=A.next}while(A!==W)}}catch(fe){et(d,d.return,fe)}}function xr(g,d,A){try{var G=d.updateQueue,W=G!==null?G.lastEffect:null;if(W!==null){var T=W.next;G=T;do{if((G.tag&g)===g){var oe=G.inst,fe=oe.destroy;if(fe!==void 0){oe.destroy=void 0,W=d;var _e=A,bt=fe;try{bt()}catch(Kt){et(W,_e,Kt)}}}G=G.next}while(G!==T)}}catch(Kt){et(d,d.return,Kt)}}function Fg(g){var d=g.updateQueue;if(d!==null){var A=g.stateNode;try{kb(d,A)}catch(G){et(g,g.return,G)}}}function Pl(g,d,A){A.props=tl(g.type,g.memoizedProps),A.state=g.memoizedState;try{A.componentWillUnmount()}catch(G){et(g,d,G)}}function Xg(g,d){try{var A=g.ref;if(A!==null){switch(g.tag){case 26:case 27:case 5:var G=g.stateNode;break;case 30:G=g.stateNode;break;default:G=g.stateNode}typeof A=="function"?g.refCleanup=A(G):A.current=G}}catch(W){et(g,d,W)}}function il(g,d){var A=g.ref,G=g.refCleanup;if(A!==null)if(typeof G=="function")try{G()}catch(W){et(g,d,W)}finally{g.refCleanup=null,g=g.alternate,g!=null&&(g.refCleanup=null)}else if(typeof A=="function")try{A(null)}catch(W){et(g,d,W)}else A.current=null}function Ku(g){var d=g.type,A=g.memoizedProps,G=g.stateNode;try{e:switch(d){case"button":case"input":case"select":case"textarea":A.autoFocus&&G.focus();break e;case"img":A.src?G.src=A.src:A.srcSet&&(G.srcset=A.srcSet)}}catch(W){et(g,g.return,W)}}function uC(g,d,A){try{var G=g.stateNode;FL(G,g.type,A,d),G[Nt]=d}catch(W){et(g,g.return,W)}}function dC(g){return g.tag===5||g.tag===3||g.tag===26||g.tag===27&&Pu(g.type)||g.tag===4}function Lc(g){e:for(;;){for(;g.sibling===null;){if(g.return===null||dC(g.return))return null;g=g.return}for(g.sibling.return=g.return,g=g.sibling;g.tag!==5&&g.tag!==6&&g.tag!==18;){if(g.tag===27&&Pu(g.type)||g.flags&2||g.child===null||g.tag===4)continue e;g.child.return=g,g=g.child}if(!(g.flags&2))return g.stateNode}}function _c(g,d,A){var G=g.tag;if(G===5||G===6)g=g.stateNode,d?(A.nodeType===9?A.body:A.nodeName==="HTML"?A.ownerDocument.body:A).insertBefore(g,d):(d=A.nodeType===9?A.body:A.nodeName==="HTML"?A.ownerDocument.body:A,d.appendChild(g),A=A._reactRootContainer,A!=null||d.onclick!==null||(d.onclick=X0));else if(G!==4&&(G===27&&Pu(g.type)&&(A=g.stateNode,d=null),g=g.child,g!==null))for(_c(g,d,A),g=g.sibling;g!==null;)_c(g,d,A),g=g.sibling}function Dc(g,d,A){var G=g.tag;if(G===5||G===6)g=g.stateNode,d?A.insertBefore(g,d):A.appendChild(g);else if(G!==4&&(G===27&&Pu(g.type)&&(A=g.stateNode),g=g.child,g!==null))for(Dc(g,d,A),g=g.sibling;g!==null;)Dc(g,d,A),g=g.sibling}function Oc(g){var d=g.stateNode,A=g.memoizedProps;try{for(var G=g.type,W=d.attributes;W.length;)d.removeAttributeNode(W[0]);_o(d,G,A),d[Ut]=g,d[Nt]=A}catch(T){et(g,g.return,T)}}var al=!1,Pi=!1,Lu=!1,Mr=typeof WeakSet=="function"?WeakSet:Set,_i=null;function Xa(g,d){if(g=g.containerInfo,OS=D0,g=AA(g),zd(g)){if("selectionStart"in g)var A={start:g.selectionStart,end:g.selectionEnd};else e:{A=(A=g.ownerDocument)&&A.defaultView||window;var G=A.getSelection&&A.getSelection();if(G&&G.rangeCount!==0){A=G.anchorNode;var W=G.anchorOffset,T=G.focusNode;G=G.focusOffset;try{A.nodeType,T.nodeType}catch{A=null;break e}var oe=0,fe=-1,_e=-1,bt=0,Kt=0,Ot=g,Gt=null;t:for(;;){for(var St;Ot!==A||W!==0&&Ot.nodeType!==3||(fe=oe+W),Ot!==T||G!==0&&Ot.nodeType!==3||(_e=oe+G),Ot.nodeType===3&&(oe+=Ot.nodeValue.length),(St=Ot.firstChild)!==null;)Gt=Ot,Ot=St;for(;;){if(Ot===g)break t;if(Gt===A&&++bt===W&&(fe=oe),Gt===T&&++Kt===G&&(_e=oe),(St=Ot.nextSibling)!==null)break;Ot=Gt,Gt=Ot.parentNode}Ot=St}A=fe===-1||_e===-1?null:{start:fe,end:_e}}else A=null}A=A||{start:0,end:0}}else A=null;for(US={focusedElem:g,selectionRange:A},D0=!1,_i=d;_i!==null;)if(d=_i,g=d.child,(d.subtreeFlags&1024)!==0&&g!==null)g.return=d,_i=g;else for(;_i!==null;){switch(d=_i,T=d.alternate,g=d.flags,d.tag){case 0:break;case 11:case 15:break;case 1:if((g&1024)!==0&&T!==null){g=void 0,A=d,W=T.memoizedProps,T=T.memoizedState,G=A.stateNode;try{var Ln=tl(A.type,W,A.elementType===A.type);g=G.getSnapshotBeforeUpdate(Ln,T),G.__reactInternalSnapshotBeforeUpdate=g}catch(Fn){et(A,A.return,Fn)}}break;case 3:if((g&1024)!==0){if(g=d.stateNode.containerInfo,A=g.nodeType,A===9)JS(g);else if(A===1)switch(g.nodeName){case"HEAD":case"HTML":case"BODY":JS(g);break;default:g.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((g&1024)!==0)throw Error(i(163))}if(g=d.sibling,g!==null){g.return=d.return,_i=g;break}_i=d.return}}function Jl(g,d,A){var G=A.flags;switch(A.tag){case 0:case 11:case 15:Ko(g,A),G&4&&Hg(5,A);break;case 1:if(Ko(g,A),G&4)if(g=A.stateNode,d===null)try{g.componentDidMount()}catch(oe){et(A,A.return,oe)}else{var W=tl(A.type,d.memoizedProps);d=d.memoizedState;try{g.componentDidUpdate(W,d,g.__reactInternalSnapshotBeforeUpdate)}catch(oe){et(A,A.return,oe)}}G&64&&Fg(A),G&512&&Xg(A,A.return);break;case 3:if(Ko(g,A),G&64&&(g=A.updateQueue,g!==null)){if(d=null,A.child!==null)switch(A.child.tag){case 27:case 5:d=A.child.stateNode;break;case 1:d=A.child.stateNode}try{kb(g,d)}catch(oe){et(A,A.return,oe)}}break;case 27:d===null&&G&4&&Oc(A);case 26:case 5:Ko(g,A),d===null&&G&4&&Ku(A),G&512&&Xg(A,A.return);break;case 12:Ko(g,A);break;case 13:Ko(g,A),G&4&&Uc(g,A),G&64&&(g=A.memoizedState,g!==null&&(g=g.dehydrated,g!==null&&(A=na.bind(null,A),_L(g,A))));break;case 22:if(G=A.memoizedState!==null||al,!G){d=d!==null&&d.memoizedState!==null||Pi,W=al;var T=Pi;al=G,(Pi=d)&&!T?ol(g,A,(A.subtreeFlags&8772)!==0):Ko(g,A),al=W,Pi=T}break;case 30:break;default:Ko(g,A)}}function ei(g){var d=g.alternate;d!==null&&(g.alternate=null,ei(d)),g.child=null,g.deletions=null,g.sibling=null,g.tag===5&&(d=g.stateNode,d!==null&&sn(d)),g.stateNode=null,g.return=null,g.dependencies=null,g.memoizedProps=null,g.memoizedState=null,g.pendingProps=null,g.stateNode=null,g.updateQueue=null}var Nn=null,pi=!1;function ls(g,d,A){for(A=A.child;A!==null;)Tg(g,d,A),A=A.sibling}function Tg(g,d,A){if(De&&typeof De.onCommitFiberUnmount=="function")try{De.onCommitFiberUnmount(Xe,A)}catch{}switch(A.tag){case 26:Pi||il(A,d),ls(g,d,A),A.memoizedState?A.memoizedState.count--:A.stateNode&&(A=A.stateNode,A.parentNode.removeChild(A));break;case 27:Pi||il(A,d);var G=Nn,W=pi;Pu(A.type)&&(Nn=A.stateNode,pi=!1),ls(g,d,A),om(A.stateNode),Nn=G,pi=W;break;case 5:Pi||il(A,d);case 6:if(G=Nn,W=pi,Nn=null,ls(g,d,A),Nn=G,pi=W,Nn!==null)if(pi)try{(Nn.nodeType===9?Nn.body:Nn.nodeName==="HTML"?Nn.ownerDocument.body:Nn).removeChild(A.stateNode)}catch(T){et(A,d,T)}else try{Nn.removeChild(A.stateNode)}catch(T){et(A,d,T)}break;case 18:Nn!==null&&(pi?(g=Nn,dW(g.nodeType===9?g.body:g.nodeName==="HTML"?g.ownerDocument.body:g,A.stateNode),Cm(g)):dW(Nn,A.stateNode));break;case 4:G=Nn,W=pi,Nn=A.stateNode.containerInfo,pi=!0,ls(g,d,A),Nn=G,pi=W;break;case 0:case 11:case 14:case 15:Pi||xr(2,A,d),Pi||xr(4,A,d),ls(g,d,A);break;case 1:Pi||(il(A,d),G=A.stateNode,typeof G.componentWillUnmount=="function"&&Pl(A,d,G)),ls(g,d,A);break;case 21:ls(g,d,A);break;case 22:Pi=(G=Pi)||A.memoizedState!==null,ls(g,d,A),Pi=G;break;default:ls(g,d,A)}}function Uc(g,d){if(d.memoizedState===null&&(g=d.alternate,g!==null&&(g=g.memoizedState,g!==null&&(g=g.dehydrated,g!==null))))try{Cm(g)}catch(A){et(d,d.return,A)}}function gh(g){switch(g.tag){case 13:case 19:var d=g.stateNode;return d===null&&(d=g.stateNode=new Mr),d;case 22:return g=g.stateNode,d=g._retryCache,d===null&&(d=g._retryCache=new Mr),d;default:throw Error(i(435,g.tag))}}function Yg(g,d){var A=gh(g);d.forEach(function(G){var W=zn.bind(null,g,G);A.has(G)||(A.add(G),G.then(W,W))})}function Qa(g,d){var A=d.deletions;if(A!==null)for(var G=0;G<A.length;G++){var W=A[G],T=g,oe=d,fe=oe;e:for(;fe!==null;){switch(fe.tag){case 27:if(Pu(fe.type)){Nn=fe.stateNode,pi=!1;break e}break;case 5:Nn=fe.stateNode,pi=!1;break e;case 3:case 4:Nn=fe.stateNode.containerInfo,pi=!0;break e}fe=fe.return}if(Nn===null)throw Error(i(160));Tg(T,oe,W),Nn=null,pi=!1,T=W.alternate,T!==null&&(T.return=null),W.return=null}if(d.subtreeFlags&13878)for(d=d.child;d!==null;)uh(d,g),d=d.sibling}var Es=null;function uh(g,d){var A=g.alternate,G=g.flags;switch(g.tag){case 0:case 11:case 14:case 15:Qa(d,g),da(g),G&4&&(xr(3,g,g.return),Hg(3,g),xr(5,g,g.return));break;case 1:Qa(d,g),da(g),G&512&&(Pi||A===null||il(A,A.return)),G&64&&al&&(g=g.updateQueue,g!==null&&(G=g.callbacks,G!==null&&(A=g.shared.hiddenCallbacks,g.shared.hiddenCallbacks=A===null?G:A.concat(G))));break;case 26:var W=Es;if(Qa(d,g),da(g),G&512&&(Pi||A===null||il(A,A.return)),G&4){var T=A!==null?A.memoizedState:null;if(G=g.memoizedState,A===null)if(G===null)if(g.stateNode===null){e:{G=g.type,A=g.memoizedProps,W=W.ownerDocument||W;t:switch(G){case"title":T=W.getElementsByTagName("title")[0],(!T||T[fn]||T[Ut]||T.namespaceURI==="http://www.w3.org/2000/svg"||T.hasAttribute("itemprop"))&&(T=W.createElement(G),W.head.insertBefore(T,W.querySelector("head > title"))),_o(T,G,A),T[Ut]=g,at(T),G=T;break e;case"link":var oe=bW("link","href",W).get(G+(A.href||""));if(oe){for(var fe=0;fe<oe.length;fe++)if(T=oe[fe],T.getAttribute("href")===(A.href==null||A.href===""?null:A.href)&&T.getAttribute("rel")===(A.rel==null?null:A.rel)&&T.getAttribute("title")===(A.title==null?null:A.title)&&T.getAttribute("crossorigin")===(A.crossOrigin==null?null:A.crossOrigin)){oe.splice(fe,1);break t}}T=W.createElement(G),_o(T,G,A),W.head.appendChild(T);break;case"meta":if(oe=bW("meta","content",W).get(G+(A.content||""))){for(fe=0;fe<oe.length;fe++)if(T=oe[fe],T.getAttribute("content")===(A.content==null?null:""+A.content)&&T.getAttribute("name")===(A.name==null?null:A.name)&&T.getAttribute("property")===(A.property==null?null:A.property)&&T.getAttribute("http-equiv")===(A.httpEquiv==null?null:A.httpEquiv)&&T.getAttribute("charset")===(A.charSet==null?null:A.charSet)){oe.splice(fe,1);break t}}T=W.createElement(G),_o(T,G,A),W.head.appendChild(T);break;default:throw Error(i(468,G))}T[Ut]=g,at(T),G=T}g.stateNode=G}else vW(W,g.type,g.stateNode);else g.stateNode=pW(W,G,g.memoizedProps);else T!==G?(T===null?A.stateNode!==null&&(A=A.stateNode,A.parentNode.removeChild(A)):T.count--,G===null?vW(W,g.type,g.stateNode):pW(W,G,g.memoizedProps)):G===null&&g.stateNode!==null&&uC(g,g.memoizedProps,A.memoizedProps)}break;case 27:Qa(d,g),da(g),G&512&&(Pi||A===null||il(A,A.return)),A!==null&&G&4&&uC(g,g.memoizedProps,A.memoizedProps);break;case 5:if(Qa(d,g),da(g),G&512&&(Pi||A===null||il(A,A.return)),g.flags&32){W=g.stateNode;try{li(W,"")}catch(St){et(g,g.return,St)}}G&4&&g.stateNode!=null&&(W=g.memoizedProps,uC(g,W,A!==null?A.memoizedProps:W)),G&1024&&(Lu=!0);break;case 6:if(Qa(d,g),da(g),G&4){if(g.stateNode===null)throw Error(i(162));G=g.memoizedProps,A=g.stateNode;try{A.nodeValue=G}catch(St){et(g,g.return,St)}}break;case 3:if(K0=null,W=Es,Es=Y0(d.containerInfo),Qa(d,g),Es=W,da(g),G&4&&A!==null&&A.memoizedState.isDehydrated)try{Cm(d.containerInfo)}catch(St){et(g,g.return,St)}Lu&&(Lu=!1,kc(g));break;case 4:G=Es,Es=Y0(g.stateNode.containerInfo),Qa(d,g),da(g),Es=G;break;case 12:Qa(d,g),da(g);break;case 13:Qa(d,g),da(g),g.child.flags&8192&&g.memoizedState!==null!=(A!==null&&A.memoizedState!==null)&&(Yi=Ge()),G&4&&(G=g.updateQueue,G!==null&&(g.updateQueue=null,Yg(g,G)));break;case 22:W=g.memoizedState!==null;var _e=A!==null&&A.memoizedState!==null,bt=al,Kt=Pi;if(al=bt||W,Pi=Kt||_e,Qa(d,g),Pi=Kt,al=bt,da(g),G&8192)e:for(d=g.stateNode,d._visibility=W?d._visibility&-2:d._visibility|1,W&&(A===null||_e||al||Pi||Wr(g)),A=null,d=g;;){if(d.tag===5||d.tag===26){if(A===null){_e=A=d;try{if(T=_e.stateNode,W)oe=T.style,typeof oe.setProperty=="function"?oe.setProperty("display","none","important"):oe.display="none";else{fe=_e.stateNode;var Ot=_e.memoizedProps.style,Gt=Ot!=null&&Ot.hasOwnProperty("display")?Ot.display:null;fe.style.display=Gt==null||typeof Gt=="boolean"?"":(""+Gt).trim()}}catch(St){et(_e,_e.return,St)}}}else if(d.tag===6){if(A===null){_e=d;try{_e.stateNode.nodeValue=W?"":_e.memoizedProps}catch(St){et(_e,_e.return,St)}}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===g)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===g)break e;for(;d.sibling===null;){if(d.return===null||d.return===g)break e;A===d&&(A=null),d=d.return}A===d&&(A=null),d.sibling.return=d.return,d=d.sibling}G&4&&(G=g.updateQueue,G!==null&&(A=G.retryQueue,A!==null&&(G.retryQueue=null,Yg(g,A))));break;case 19:Qa(d,g),da(g),G&4&&(G=g.updateQueue,G!==null&&(g.updateQueue=null,Yg(g,G)));break;case 30:break;case 21:break;default:Qa(d,g),da(g)}}function da(g){var d=g.flags;if(d&2){try{for(var A,G=g.return;G!==null;){if(dC(G)){A=G;break}G=G.return}if(A==null)throw Error(i(160));switch(A.tag){case 27:var W=A.stateNode,T=Lc(g);Dc(g,T,W);break;case 5:var oe=A.stateNode;A.flags&32&&(li(oe,""),A.flags&=-33);var fe=Lc(g);Dc(g,fe,oe);break;case 3:case 4:var _e=A.stateNode.containerInfo,bt=Lc(g);_c(g,bt,_e);break;default:throw Error(i(161))}}catch(Kt){et(g,g.return,Kt)}g.flags&=-3}d&4096&&(g.flags&=-4097)}function kc(g){if(g.subtreeFlags&1024)for(g=g.child;g!==null;){var d=g;kc(d),d.tag===5&&d.flags&1024&&d.stateNode.reset(),g=g.sibling}}function Ko(g,d){if(d.subtreeFlags&8772)for(d=d.child;d!==null;)Jl(g,d.alternate,d),d=d.sibling}function Wr(g){for(g=g.child;g!==null;){var d=g;switch(d.tag){case 0:case 11:case 14:case 15:xr(4,d,d.return),Wr(d);break;case 1:il(d,d.return);var A=d.stateNode;typeof A.componentWillUnmount=="function"&&Pl(d,d.return,A),Wr(d);break;case 27:om(d.stateNode);case 26:case 5:il(d,d.return),Wr(d);break;case 22:d.memoizedState===null&&Wr(d);break;case 30:Wr(d);break;default:Wr(d)}g=g.sibling}}function ol(g,d,A){for(A=A&&(d.subtreeFlags&8772)!==0,d=d.child;d!==null;){var G=d.alternate,W=g,T=d,oe=T.flags;switch(T.tag){case 0:case 11:case 15:ol(W,T,A),Hg(4,T);break;case 1:if(ol(W,T,A),G=T,W=G.stateNode,typeof W.componentDidMount=="function")try{W.componentDidMount()}catch(bt){et(G,G.return,bt)}if(G=T,W=G.updateQueue,W!==null){var fe=G.stateNode;try{var _e=W.shared.hiddenCallbacks;if(_e!==null)for(W.shared.hiddenCallbacks=null,W=0;W<_e.length;W++)Wu(_e[W],fe)}catch(bt){et(G,G.return,bt)}}A&&oe&64&&Fg(T),Xg(T,T.return);break;case 27:Oc(T);case 26:case 5:ol(W,T,A),A&&G===null&&oe&4&&Ku(T),Xg(T,T.return);break;case 12:ol(W,T,A);break;case 13:ol(W,T,A),A&&oe&4&&Uc(W,T);break;case 22:T.memoizedState===null&&ol(W,T,A),Xg(T,T.return);break;case 30:break;default:ol(W,T,A)}d=d.sibling}}function dh(g,d){var A=null;g!==null&&g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(A=g.memoizedState.cachePool.pool),g=null,d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(g=d.memoizedState.cachePool.pool),g!==A&&(g!=null&&g.refCount++,A!=null&&Su(A))}function Ch(g,d){g=null,d.alternate!==null&&(g=d.alternate.memoizedState.cache),d=d.memoizedState.cache,d!==g&&(d.refCount++,g!=null&&Su(g))}function Di(g,d,A,G){if(d.subtreeFlags&10256)for(d=d.child;d!==null;)Ih(g,d,A,G),d=d.sibling}function Ih(g,d,A,G){var W=d.flags;switch(d.tag){case 0:case 11:case 15:Di(g,d,A,G),W&2048&&Hg(9,d);break;case 1:Di(g,d,A,G);break;case 3:Di(g,d,A,G),W&2048&&(g=null,d.alternate!==null&&(g=d.alternate.memoizedState.cache),d=d.memoizedState.cache,d!==g&&(d.refCount++,g!=null&&Su(g)));break;case 12:if(W&2048){Di(g,d,A,G),g=d.stateNode;try{var T=d.memoizedProps,oe=T.id,fe=T.onPostCommit;typeof fe=="function"&&fe(oe,d.alternate===null?"mount":"update",g.passiveEffectDuration,-0)}catch(_e){et(d,d.return,_e)}}else Di(g,d,A,G);break;case 13:Di(g,d,A,G);break;case 23:break;case 22:T=d.stateNode,oe=d.alternate,d.memoizedState!==null?T._visibility&2?Di(g,d,A,G):Hs(g,d):T._visibility&2?Di(g,d,A,G):(T._visibility|=2,jl(g,d,A,G,(d.subtreeFlags&10256)!==0)),W&2048&&dh(oe,d);break;case 24:Di(g,d,A,G),W&2048&&Ch(d.alternate,d);break;default:Di(g,d,A,G)}}function jl(g,d,A,G,W){for(W=W&&(d.subtreeFlags&10256)!==0,d=d.child;d!==null;){var T=g,oe=d,fe=A,_e=G,bt=oe.flags;switch(oe.tag){case 0:case 11:case 15:jl(T,oe,fe,_e,W),Hg(8,oe);break;case 23:break;case 22:var Kt=oe.stateNode;oe.memoizedState!==null?Kt._visibility&2?jl(T,oe,fe,_e,W):Hs(T,oe):(Kt._visibility|=2,jl(T,oe,fe,_e,W)),W&&bt&2048&&dh(oe.alternate,oe);break;case 24:jl(T,oe,fe,_e,W),W&&bt&2048&&Ch(oe.alternate,oe);break;default:jl(T,oe,fe,_e,W)}d=d.sibling}}function Hs(g,d){if(d.subtreeFlags&10256)for(d=d.child;d!==null;){var A=g,G=d,W=G.flags;switch(G.tag){case 22:Hs(A,G),W&2048&&dh(G.alternate,G);break;case 24:Hs(A,G),W&2048&&Ch(G.alternate,G);break;default:Hs(A,G)}d=d.sibling}}var Vr=8192;function _u(g){if(g.subtreeFlags&Vr)for(g=g.child;g!==null;)N0(g),g=g.sibling}function N0(g){switch(g.tag){case 26:_u(g),g.flags&Vr&&g.memoizedState!==null&&n_(Es,g.memoizedState,g.memoizedProps);break;case 5:_u(g);break;case 3:case 4:var d=Es;Es=Y0(g.stateNode.containerInfo),_u(g),Es=d;break;case 22:g.memoizedState===null&&(d=g.alternate,d!==null&&d.memoizedState!==null?(d=Vr,Vr=16777216,_u(g),Vr=d):_u(g));break;default:_u(g)}}function E0(g){var d=g.alternate;if(d!==null&&(g=d.child,g!==null)){d.child=null;do d=g.sibling,g.sibling=null,g=d;while(g!==null)}}function Ji(g){var d=g.deletions;if((g.flags&16)!==0){if(d!==null)for(var A=0;A<d.length;A++){var G=d[A];_i=G,sl(G,g)}E0(g)}if(g.subtreeFlags&10256)for(g=g.child;g!==null;)em(g),g=g.sibling}function em(g){switch(g.tag){case 0:case 11:case 15:Ji(g),g.flags&2048&&xr(9,g,g.return);break;case 3:Ji(g);break;case 12:Ji(g);break;case 22:var d=g.stateNode;g.memoizedState!==null&&d._visibility&2&&(g.return===null||g.return.tag!==13)?(d._visibility&=-3,rl(g)):Ji(g);break;default:Ji(g)}}function rl(g){var d=g.deletions;if((g.flags&16)!==0){if(d!==null)for(var A=0;A<d.length;A++){var G=d[A];_i=G,sl(G,g)}E0(g)}for(g=g.child;g!==null;){switch(d=g,d.tag){case 0:case 11:case 15:xr(8,d,d.return),rl(d);break;case 22:A=d.stateNode,A._visibility&2&&(A._visibility&=-3,rl(d));break;default:rl(d)}g=g.sibling}}function sl(g,d){for(;_i!==null;){var A=_i;switch(A.tag){case 0:case 11:case 15:xr(8,A,d);break;case 23:case 22:if(A.memoizedState!==null&&A.memoizedState.cachePool!==null){var G=A.memoizedState.cachePool.pool;G!=null&&G.refCount++}break;case 24:Su(A.memoizedState.cache)}if(G=A.child,G!==null)G.return=A,_i=G;else e:for(A=g;_i!==null;){G=_i;var W=G.sibling,T=G.return;if(ei(G),G===A){_i=null;break e}if(W!==null){W.return=T,_i=W;break e}_i=T}}}var Ca={getCacheForType:function(g){var d=ua(Ma),A=d.data.get(g);return A===void 0&&(A=g(),d.data.set(g,A)),A}},tm=typeof WeakMap=="function"?WeakMap:Map,Vi=0,On=null,oi=null,Wn=0,qn=0,la=null,Nr=!1,Du=!1,Ou=!1,cs=0,ta=0,Fs=0,ll=0,zg=0,gs=0,bi=0,Ni=null,En=null,ci=!1,Yi=0,Bo=1/0,us=null,Er=null,Ta=0,Go=null,Oi=null,Hr=0,Ql=0,CC=null,Fr=null,cl=0,Kg=null;function Ia(){if((Vi&2)!==0&&Wn!==0)return Wn&-Wn;if(X.T!==null){var g=kn;return g!==0?g:TS()}return yt()}function hh(){gs===0&&(gs=(Wn&536870912)===0||Si?we():536870912);var g=Li.current;return g!==null&&(g.flags|=32),gs}function Lo(g,d,A){(g===On&&(qn===2||qn===9)||g.cancelPendingCommit!==null)&&(Jc(g,0),Xs(g,Wn,gs,!1)),ut(g,A),((Vi&2)===0||g!==On)&&(g===On&&((Vi&2)===0&&(ll|=A),ta===4&&Xs(g,Wn,gs,!1)),qc(g))}function Uu(g,d,A){if((Vi&6)!==0)throw Error(i(327));var G=!A&&(d&124)===0&&(d&g.expiredLanes)===0||He(g,d),W=G?V(g,d):f(g,d,!0),T=G;do{if(W===0){Du&&!G&&Xs(g,d,0,!1);break}else{if(A=g.current.alternate,T&&!Pc(A)){W=f(g,d,!1),T=!1;continue}if(W===2){if(T=d,g.errorRecoveryDisabledLanes&T)var oe=0;else oe=g.pendingLanes&-536870913,oe=oe!==0?oe:oe&536870912?536870912:0;if(oe!==0){d=oe;e:{var fe=g;W=Ni;var _e=fe.current.memoizedState.isDehydrated;if(_e&&(Jc(fe,oe).flags|=256),oe=f(fe,oe,!1),oe!==2){if(Ou&&!_e){fe.errorRecoveryDisabledLanes|=T,ll|=T,W=4;break e}T=En,En=W,T!==null&&(En===null?En=T:En.push.apply(En,T))}W=oe}if(T=!1,W!==2)continue}}if(W===1){Jc(g,0),Xs(g,d,0,!0);break}e:{switch(G=g,T=W,T){case 0:case 1:throw Error(i(345));case 4:if((d&4194048)!==d)break;case 6:Xs(G,d,gs,!Nr);break e;case 2:En=null;break;case 3:case 5:break;default:throw Error(i(329))}if((d&62914560)===d&&(W=Yi+300-Ge(),10<W)){if(Xs(G,d,gs,!Nr),Ce(G,0,!0)!==0)break e;G.timeoutHandle=gW(IC.bind(null,G,A,En,us,ci,d,gs,ll,bi,Nr,T,2,-0,0),W);break e}IC(G,A,En,us,ci,d,gs,ll,bi,Nr,T,0,-0,0)}}break}while(!0);qc(g)}function IC(g,d,A,G,W,T,oe,fe,_e,bt,Kt,Ot,Gt,St){if(g.timeoutHandle=-1,Ot=d.subtreeFlags,(Ot&8192||(Ot&16785408)===16785408)&&(lm={stylesheets:null,count:0,unsuspend:t_},N0(d),Ot=i_(),Ot!==null)){g.cancelPendingCommit=Ot(en.bind(null,g,d,T,A,G,W,oe,fe,_e,Kt,1,Gt,St)),Xs(g,T,oe,!bt);return}en(g,d,T,A,G,W,oe,fe,_e)}function Pc(g){for(var d=g;;){var A=d.tag;if((A===0||A===11||A===15)&&d.flags&16384&&(A=d.updateQueue,A!==null&&(A=A.stores,A!==null)))for(var G=0;G<A.length;G++){var W=A[G],T=W.getSnapshot;W=W.value;try{if(!tr(T(),W))return!1}catch{return!1}}if(A=d.child,d.subtreeFlags&16384&&A!==null)A.return=d,d=A;else{if(d===g)break;for(;d.sibling===null;){if(d.return===null||d.return===g)return!0;d=d.return}d.sibling.return=d.return,d=d.sibling}}return!0}function Xs(g,d,A,G){d&=~zg,d&=~ll,g.suspendedLanes|=d,g.pingedLanes&=~d,G&&(g.warmLanes|=d),G=g.expirationTimes;for(var W=d;0<W;){var T=31-Je(W),oe=1<<T;G[T]=-1,W&=~oe}A!==0&&mt(g,A,d)}function gl(){return(Vi&6)===0?(nm(0),!1):!0}function Lg(){if(oi!==null){if(qn===0)var g=oi.return;else g=oi,Yl=Vc=null,XA(g),wg=null,rC=0,g=oi;for(;g!==null;)zu(g.alternate,g),g=g.return;oi=null}}function Jc(g,d){var A=g.timeoutHandle;A!==-1&&(g.timeoutHandle=-1,TL(A)),A=g.cancelPendingCommit,A!==null&&(g.cancelPendingCommit=null,A()),Lg(),On=g,oi=A=ya(g.current,null),Wn=d,qn=0,la=null,Nr=!1,Du=He(g,d),Ou=!1,bi=gs=zg=ll=Fs=ta=0,En=Ni=null,ci=!1,(d&8)!==0&&(d|=d&32);var G=g.entangledLanes;if(G!==0)for(g=g.entanglements,G&=d;0<G;){var W=31-Je(G),T=1<<W;d|=g[W],G&=~T}return cs=d,_d(),A}function fh(g,d){Pn=null,X.H=oC,d===$d||d===Zs?(d=VA(),qn=3):d===WA?(d=VA(),qn=4):qn=d===V0?8:d!==null&&typeof d=="object"&&typeof d.then=="function"?6:1,la=d,oi===null&&(ta=1,sh(g,so(d,g.current)))}function ku(){var g=X.H;return X.H=oC,g===null?oC:g}function Ah(){var g=X.A;return X.A=Ca,g}function I(){ta=4,Nr||(Wn&4194048)!==Wn&&Li.current!==null||(Du=!0),(Fs&134217727)===0&&(ll&134217727)===0||On===null||Xs(On,Wn,gs,!1)}function f(g,d,A){var G=Vi;Vi|=2;var W=ku(),T=Ah();(On!==g||Wn!==d)&&(us=null,Jc(g,d)),d=!1;var oe=ta;e:do try{if(qn!==0&&oi!==null){var fe=oi,_e=la;switch(qn){case 8:Lg(),oe=6;break e;case 3:case 2:case 9:case 6:Li.current===null&&(d=!0);var bt=qn;if(qn=0,la=null,Pe(g,fe,_e,bt),A&&Du){oe=0;break e}break;default:bt=qn,qn=0,la=null,Pe(g,fe,_e,bt)}}w(),oe=ta;break}catch(Kt){fh(g,Kt)}while(!0);return d&&g.shellSuspendCounter++,Yl=Vc=null,Vi=G,X.H=W,X.A=T,oi===null&&(On=null,Wn=0,_d()),oe}function w(){for(;oi!==null;)J(oi)}function V(g,d){var A=Vi;Vi|=2;var G=ku(),W=Ah();On!==g||Wn!==d?(us=null,Bo=Ge()+500,Jc(g,d)):Du=He(g,d);e:do try{if(qn!==0&&oi!==null){d=oi;var T=la;t:switch(qn){case 1:qn=0,la=null,Pe(g,d,T,1);break;case 2:case 9:if(UI(T)){qn=0,la=null,ve(d);break}d=function(){qn!==2&&qn!==9||On!==g||(qn=7),qc(g)},T.then(d,d);break e;case 3:qn=7;break e;case 4:qn=5;break e;case 7:UI(T)?(qn=0,la=null,ve(d)):(qn=0,la=null,Pe(g,d,T,7));break;case 5:var oe=null;switch(oi.tag){case 26:oe=oi.memoizedState;case 5:case 27:var fe=oi;if(!oe||yW(oe)){qn=0,la=null;var _e=fe.sibling;if(_e!==null)oi=_e;else{var bt=fe.return;bt!==null?(oi=bt,dt(bt)):oi=null}break t}}qn=0,la=null,Pe(g,d,T,5);break;case 6:qn=0,la=null,Pe(g,d,T,6);break;case 8:Lg(),ta=6;break e;default:throw Error(i(462))}}Y();break}catch(Kt){fh(g,Kt)}while(!0);return Yl=Vc=null,X.H=G,X.A=W,Vi=A,oi!==null?0:(On=null,Wn=0,_d(),ta)}function Y(){for(;oi!==null&&!Ye();)J(oi)}function J(g){var d=Ng(g.alternate,g,cs);g.memoizedProps=g.pendingProps,d===null?dt(g):oi=d}function ve(g){var d=g,A=d.alternate;switch(d.tag){case 15:case 0:d=Rr(A,d,d.pendingProps,d.type,void 0,Wn);break;case 11:d=Rr(A,d,d.pendingProps,d.type.render,d.ref,Wn);break;case 5:XA(d);default:zu(A,d),d=oi=GA(d,cs),d=Ng(A,d,cs)}g.memoizedProps=g.pendingProps,d===null?dt(g):oi=d}function Pe(g,d,A,G){Yl=Vc=null,XA(d),wg=null,rC=0;var W=d.return;try{if(FS(g,W,d,A,Wn)){ta=1,sh(g,so(A,g.current)),oi=null;return}}catch(T){if(W!==null)throw oi=W,T;ta=1,sh(g,so(A,g.current)),oi=null;return}d.flags&32768?(Si||G===1?g=!0:Du||(Wn&536870912)!==0?g=!1:(Nr=g=!0,(G===2||G===9||G===3||G===6)&&(G=Li.current,G!==null&&G.tag===13&&(G.flags|=16384))),zt(d,g)):dt(d)}function dt(g){var d=g;do{if((d.flags&32768)!==0){zt(d,Nr);return}g=d.return;var A=$A(d.alternate,d,cs);if(A!==null){oi=A;return}if(d=d.sibling,d!==null){oi=d;return}oi=d=g}while(d!==null);ta===0&&(ta=5)}function zt(g,d){do{var A=Yu(g.alternate,g);if(A!==null){A.flags&=32767,oi=A;return}if(A=g.return,A!==null&&(A.flags|=32768,A.subtreeFlags=0,A.deletions=null),!d&&(g=g.sibling,g!==null)){oi=g;return}oi=g=A}while(g!==null);ta=6,oi=null}function en(g,d,A,G,W,T,oe,fe,_e){g.cancelPendingCommit=null;do jc();while(Ta!==0);if((Vi&6)!==0)throw Error(i(327));if(d!==null){if(d===g.current)throw Error(i(177));if(T=d.lanes|d.childLanes,T|=XI,Rt(g,A,T,oe,fe,_e),g===On&&(oi=On=null,Wn=0),Oi=d,Go=g,Hr=A,Ql=T,CC=W,Fr=G,(d.subtreeFlags&10256)!==0||(d.flags&10256)!==0?(g.callbackNode=null,g.callbackPriority=0,wi(ee,function(){return Qc(),null})):(g.callbackNode=null,g.callbackPriority=0),G=(d.flags&13878)!==0,(d.subtreeFlags&13878)!==0||G){G=X.T,X.T=null,W=L.p,L.p=2,oe=Vi,Vi|=4;try{Xa(g,d,A)}finally{Vi=oe,L.p=W,X.T=G}}Ta=1,In(),An(),Un()}}function In(){if(Ta===1){Ta=0;var g=Go,d=Oi,A=(d.flags&13878)!==0;if((d.subtreeFlags&13878)!==0||A){A=X.T,X.T=null;var G=L.p;L.p=2;var W=Vi;Vi|=4;try{uh(d,g);var T=US,oe=AA(g.containerInfo),fe=T.focusedElem,_e=T.selectionRange;if(oe!==fe&&fe&&fe.ownerDocument&&fA(fe.ownerDocument.documentElement,fe)){if(_e!==null&&zd(fe)){var bt=_e.start,Kt=_e.end;if(Kt===void 0&&(Kt=bt),"selectionStart"in fe)fe.selectionStart=bt,fe.selectionEnd=Math.min(Kt,fe.value.length);else{var Ot=fe.ownerDocument||document,Gt=Ot&&Ot.defaultView||window;if(Gt.getSelection){var St=Gt.getSelection(),Ln=fe.textContent.length,Fn=Math.min(_e.start,Ln),Qi=_e.end===void 0?Fn:Math.min(_e.end,Ln);!St.extend&&Fn>Qi&&(oe=Qi,Qi=Fn,Fn=oe);var ct=hA(fe,Fn),tt=hA(fe,Qi);if(ct&&tt&&(St.rangeCount!==1||St.anchorNode!==ct.node||St.anchorOffset!==ct.offset||St.focusNode!==tt.node||St.focusOffset!==tt.offset)){var ft=Ot.createRange();ft.setStart(ct.node,ct.offset),St.removeAllRanges(),Fn>Qi?(St.addRange(ft),St.extend(tt.node,tt.offset)):(ft.setEnd(tt.node,tt.offset),St.addRange(ft))}}}}for(Ot=[],St=fe;St=St.parentNode;)St.nodeType===1&&Ot.push({element:St,left:St.scrollLeft,top:St.scrollTop});for(typeof fe.focus=="function"&&fe.focus(),fe=0;fe<Ot.length;fe++){var Dt=Ot[fe];Dt.element.scrollLeft=Dt.left,Dt.element.scrollTop=Dt.top}}D0=!!OS,US=OS=null}finally{Vi=W,L.p=G,X.T=A}}g.current=d,Ta=2}}function An(){if(Ta===2){Ta=0;var g=Go,d=Oi,A=(d.flags&8772)!==0;if((d.subtreeFlags&8772)!==0||A){A=X.T,X.T=null;var G=L.p;L.p=2;var W=Vi;Vi|=4;try{Jl(g,d.alternate,d)}finally{Vi=W,L.p=G,X.T=A}}Ta=3}}function Un(){if(Ta===4||Ta===3){Ta=0,he();var g=Go,d=Oi,A=Hr,G=Fr;(d.subtreeFlags&10256)!==0||(d.flags&10256)!==0?Ta=5:(Ta=0,Oi=Go=null,Xr(g,g.pendingLanes));var W=g.pendingLanes;if(W===0&&(Er=null),Zt(A),d=d.stateNode,De&&typeof De.onCommitFiberRoot=="function")try{De.onCommitFiberRoot(Xe,d,void 0,(d.current.flags&128)===128)}catch{}if(G!==null){d=X.T,W=L.p,L.p=2,X.T=null;try{for(var T=g.onRecoverableError,oe=0;oe<G.length;oe++){var fe=G[oe];T(fe.value,{componentStack:fe.stack})}}finally{X.T=d,L.p=W}}(Hr&3)!==0&&jc(),qc(g),W=g.pendingLanes,(A&4194090)!==0&&(W&42)!==0?g===Kg?cl++:(cl=0,Kg=g):cl=0,nm(0)}}function Xr(g,d){(g.pooledCacheLanes&=d)===0&&(d=g.pooledCache,d!=null&&(g.pooledCache=null,Su(d)))}function jc(g){return In(),An(),Un(),Qc()}function Qc(){if(Ta!==5)return!1;var g=Go,d=Ql;Ql=0;var A=Zt(Hr),G=X.T,W=L.p;try{L.p=32>A?32:A,X.T=null,A=CC,CC=null;var T=Go,oe=Hr;if(Ta=0,Oi=Go=null,Hr=0,(Vi&6)!==0)throw Error(i(331));var fe=Vi;if(Vi|=4,em(T.current),Ih(T,T.current,oe,A),Vi=fe,nm(0,!1),De&&typeof De.onPostCommitFiberRoot=="function")try{De.onPostCommitFiberRoot(Xe,T)}catch{}return!0}finally{L.p=W,X.T=G,Xr(g,d)}}function vt(g,d,A){d=so(A,d),d=lh(g.stateNode,d,2),g=Ll(g,d,2),g!==null&&(ut(g,2),qc(g))}function et(g,d,A){if(g.tag===3)vt(g,g,A);else for(;d!==null;){if(d.tag===3){vt(d,g,A);break}else if(d.tag===1){var G=d.stateNode;if(typeof d.type.getDerivedStateFromError=="function"||typeof G.componentDidCatch=="function"&&(Er===null||!Er.has(G))){g=so(A,g),A=W0(2),G=Ll(d,A,2),G!==null&&(ch(A,G,d,g),ut(G,2),qc(G));break}}d=d.return}}function wt(g,d,A){var G=g.pingCache;if(G===null){G=g.pingCache=new tm;var W=new Set;G.set(d,W)}else W=G.get(d),W===void 0&&(W=new Set,G.set(d,W));W.has(A)||(Ou=!0,W.add(A),g=Qt.bind(null,g,d,A),d.then(g,g))}function Qt(g,d,A){var G=g.pingCache;G!==null&&G.delete(d),g.pingedLanes|=g.suspendedLanes&A,g.warmLanes&=~A,On===g&&(Wn&A)===A&&(ta===4||ta===3&&(Wn&62914560)===Wn&&300>Ge()-Yi?(Vi&2)===0&&Jc(g,0):zg|=A,bi===Wn&&(bi=0)),qc(g)}function Rn(g,d){d===0&&(d=ze()),g=Xl(g,d),g!==null&&(ut(g,d),qc(g))}function na(g){var d=g.memoizedState,A=0;d!==null&&(A=d.retryLane),Rn(g,A)}function zn(g,d){var A=0;switch(g.tag){case 13:var G=g.stateNode,W=g.memoizedState;W!==null&&(A=W.retryLane);break;case 19:G=g.stateNode;break;case 22:G=g.stateNode._retryCache;break;default:throw Error(i(314))}G!==null&&G.delete(d),Rn(g,A)}function wi(g,d){return Te(g,d)}var wa=null,ri=null,ul=!1,mh=!1,XS=!1,hC=0;function qc(g){g!==ri&&g.next===null&&(ri===null?wa=ri=g:ri=ri.next=g),mh=!0,ul||(ul=!0,xL())}function nm(g,d){if(!XS&&mh){XS=!0;do for(var A=!1,G=wa;G!==null;){if(g!==0){var W=G.pendingLanes;if(W===0)var T=0;else{var oe=G.suspendedLanes,fe=G.pingedLanes;T=(1<<31-Je(42|g)+1)-1,T&=W&~(oe&~fe),T=T&201326741?T&201326741|1:T?T|2:0}T!==0&&(A=!0,eW(G,T))}else T=Wn,T=Ce(G,G===On?T:0,G.cancelPendingCommit!==null||G.timeoutHandle!==-1),(T&3)===0||He(G,T)||(A=!0,eW(G,T));G=G.next}while(A);XS=!1}}function ZL(){QM()}function QM(){mh=ul=!1;var g=0;hC!==0&&(XL()&&(g=hC),hC=0);for(var d=Ge(),A=null,G=wa;G!==null;){var W=G.next,T=qM(G,d);T===0?(G.next=null,A===null?wa=W:A.next=W,W===null&&(ri=A)):(A=G,(g!==0||(T&3)!==0)&&(mh=!0)),G=W}nm(g)}function qM(g,d){for(var A=g.suspendedLanes,G=g.pingedLanes,W=g.expirationTimes,T=g.pendingLanes&-62914561;0<T;){var oe=31-Je(T),fe=1<<oe,_e=W[oe];_e===-1?((fe&A)===0||(fe&G)!==0)&&(W[oe]=ht(fe,d)):_e<=d&&(g.expiredLanes|=fe),T&=~fe}if(d=On,A=Wn,A=Ce(g,g===d?A:0,g.cancelPendingCommit!==null||g.timeoutHandle!==-1),G=g.callbackNode,A===0||g===d&&(qn===2||qn===9)||g.cancelPendingCommit!==null)return G!==null&&G!==null&&le(G),g.callbackNode=null,g.callbackPriority=0;if((A&3)===0||He(g,A)){if(d=A&-A,d===g.callbackPriority)return d;switch(G!==null&&le(G),Zt(A)){case 2:case 8:A=Se;break;case 32:A=ee;break;case 268435456:A=ce;break;default:A=ee}return G=$M.bind(null,g),A=Te(A,G),g.callbackPriority=d,g.callbackNode=A,d}return G!==null&&G!==null&&le(G),g.callbackPriority=2,g.callbackNode=null,2}function $M(g,d){if(Ta!==0&&Ta!==5)return g.callbackNode=null,g.callbackPriority=0,null;var A=g.callbackNode;if(jc()&&g.callbackNode!==A)return null;var G=Wn;return G=Ce(g,g===On?G:0,g.cancelPendingCommit!==null||g.timeoutHandle!==-1),G===0?null:(Uu(g,G,d),qM(g,Ge()),g.callbackNode!=null&&g.callbackNode===A?$M.bind(null,g):null)}function eW(g,d){if(jc())return null;Uu(g,d,!0)}function xL(){YL(function(){(Vi&6)!==0?Te(Ee,ZL):QM()})}function TS(){return hC===0&&(hC=we()),hC}function tW(g){return g==null||typeof g=="symbol"||typeof g=="boolean"?null:typeof g=="function"?g:pr(""+g)}function nW(g,d){var A=d.ownerDocument.createElement("input");return A.name=d.name,A.value=d.value,g.id&&A.setAttribute("form",g.id),d.parentNode.insertBefore(A,d),g=new FormData(g),A.parentNode.removeChild(A),g}function ML(g,d,A,G,W){if(d==="submit"&&A&&A.stateNode===W){var T=tW((W[Nt]||null).action),oe=G.submitter;oe&&(d=(d=oe[Nt]||null)?tW(d.formAction):oe.getAttribute("formAction"),d!==null&&(T=d,oe=null));var fe=new Ho("action","action",null,G,W);g.push({event:fe,listeners:[{instance:null,listener:function(){if(G.defaultPrevented){if(hC!==0){var _e=oe?nW(W,oe):new FormData(W);JA(A,{pending:!0,data:_e,method:W.method,action:T},null,_e)}}else typeof T=="function"&&(fe.preventDefault(),_e=oe?nW(W,oe):new FormData(W),JA(A,{pending:!0,data:_e,method:W.method,action:T},T,_e))},currentTarget:W}]})}}for(var YS=0;YS<Ld.length;YS++){var zS=Ld[YS],WL=zS.toLowerCase(),VL=zS[0].toUpperCase()+zS.slice(1);ka(WL,"on"+VL)}ka(Fo,"onAnimationEnd"),ka(bA,"onAnimationIteration"),ka(ir,"onAnimationStart"),ka("dblclick","onDoubleClick"),ka("focusin","onFocus"),ka("focusout","onBlur"),ka(_b,"onTransitionRun"),ka(Hl,"onTransitionStart"),ka(bu,"onTransitionCancel"),ka(Fl,"onTransitionEnd"),te("onMouseEnter",["mouseout","mouseover"]),te("onMouseLeave",["mouseout","mouseover"]),te("onPointerEnter",["pointerout","pointerover"]),te("onPointerLeave",["pointerout","pointerover"]),xt("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),xt("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),xt("onBeforeInput",["compositionend","keypress","textInput","paste"]),xt("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),xt("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),xt("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var im="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),NL=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(im));function iW(g,d){d=(d&4)!==0;for(var A=0;A<g.length;A++){var G=g[A],W=G.event;G=G.listeners;e:{var T=void 0;if(d)for(var oe=G.length-1;0<=oe;oe--){var fe=G[oe],_e=fe.instance,bt=fe.currentTarget;if(fe=fe.listener,_e!==T&&W.isPropagationStopped())break e;T=fe,W.currentTarget=bt;try{T(W)}catch(Kt){Zg(Kt)}W.currentTarget=null,T=_e}else for(oe=0;oe<G.length;oe++){if(fe=G[oe],_e=fe.instance,bt=fe.currentTarget,fe=fe.listener,_e!==T&&W.isPropagationStopped())break e;T=fe,W.currentTarget=bt;try{T(W)}catch(Kt){Zg(Kt)}W.currentTarget=null,T=_e}}}}function di(g,d){var A=d[Pt];A===void 0&&(A=d[Pt]=new Set);var G=g+"__bubble";A.has(G)||(aW(d,g,2,!1),A.add(G))}function KS(g,d,A){var G=0;d&&(G|=4),aW(A,g,G,d)}var H0="_reactListening"+Math.random().toString(36).slice(2);function LS(g){if(!g[H0]){g[H0]=!0,It.forEach(function(A){A!=="selectionchange"&&(NL.has(A)||KS(A,!1,g),KS(A,!0,g))});var d=g.nodeType===9?g:g.ownerDocument;d===null||d[H0]||(d[H0]=!0,KS("selectionchange",!1,d))}}function aW(g,d,A,G){switch(ZW(d)){case 2:var W=r_;break;case 8:W=s_;break;default:W=n2}A=W.bind(null,d,A,g),W=void 0,!wn||d!=="touchstart"&&d!=="touchmove"&&d!=="wheel"||(W=!0),G?W!==void 0?g.addEventListener(d,A,{capture:!0,passive:W}):g.addEventListener(d,A,!0):W!==void 0?g.addEventListener(d,A,{passive:W}):g.addEventListener(d,A,!1)}function _S(g,d,A,G,W){var T=G;if((d&1)===0&&(d&2)===0&&G!==null)e:for(;;){if(G===null)return;var oe=G.tag;if(oe===3||oe===4){var fe=G.stateNode.containerInfo;if(fe===W)break;if(oe===4)for(oe=G.return;oe!==null;){var _e=oe.tag;if((_e===3||_e===4)&&oe.stateNode.containerInfo===W)return;oe=oe.return}for(;fe!==null;){if(oe=ae(fe),oe===null)return;if(_e=oe.tag,_e===5||_e===6||_e===26||_e===27){G=T=oe;continue e}fe=fe.parentNode}}G=G.return}Jr(function(){var bt=T,Kt=Ua(A),Ot=[];e:{var Gt=FI.get(g);if(Gt!==void 0){var St=Ho,Ln=g;switch(g){case"keypress":if(Eo(A)===0)break e;case"keydown":case"keyup":St=lA;break;case"focusin":Ln="focus",St=Ml;break;case"focusout":Ln="blur",St=Ml;break;case"beforeblur":case"afterblur":St=Ml;break;case"click":if(A.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":St=vg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":St=rA;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":St=gA;break;case Fo:case bA:case ir:St=RI;break;case Fl:St=Wl;break;case"scroll":case"scrollend":St=fu;break;case"wheel":St=wS;break;case"copy":case"cut":case"paste":St=$o;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":St=ZI;break;case"toggle":case"beforetoggle":St=yc}var Fn=(d&4)!==0,Qi=!Fn&&(g==="scroll"||g==="scrollend"),ct=Fn?Gt!==null?Gt+"Capture":null:Gt;Fn=[];for(var tt=bt,ft;tt!==null;){var Dt=tt;if(ft=Dt.stateNode,Dt=Dt.tag,Dt!==5&&Dt!==26&&Dt!==27||ft===null||ct===null||(Dt=br(tt,ct),Dt!=null&&Fn.push(am(tt,Dt,ft))),Qi)break;tt=tt.return}0<Fn.length&&(Gt=new St(Gt,Ln,null,A,Kt),Ot.push({event:Gt,listeners:Fn}))}}if((d&7)===0){e:{if(Gt=g==="mouseover"||g==="pointerover",St=g==="mouseout"||g==="pointerout",Gt&&A!==Ki&&(Ln=A.relatedTarget||A.fromElement)&&(ae(Ln)||Ln[Tt]))break e;if((St||Gt)&&(Gt=Kt.window===Kt?Kt:(Gt=Kt.ownerDocument)?Gt.defaultView||Gt.parentWindow:window,St?(Ln=A.relatedTarget||A.toElement,St=bt,Ln=Ln?ae(Ln):null,Ln!==null&&(Qi=o(Ln),Fn=Ln.tag,Ln!==Qi||Fn!==5&&Fn!==27&&Fn!==6)&&(Ln=null)):(St=null,Ln=bt),St!==Ln)){if(Fn=vg,Dt="onMouseLeave",ct="onMouseEnter",tt="mouse",(g==="pointerout"||g==="pointerover")&&(Fn=ZI,Dt="onPointerLeave",ct="onPointerEnter",tt="pointer"),Qi=St==null?Gt:Fe(St),ft=Ln==null?Gt:Fe(Ln),Gt=new Fn(Dt,tt+"leave",St,A,Kt),Gt.target=Qi,Gt.relatedTarget=ft,Dt=null,ae(Kt)===bt&&(Fn=new Fn(ct,tt+"enter",Ln,A,Kt),Fn.target=ft,Fn.relatedTarget=Qi,Dt=Fn),Qi=Dt,St&&Ln)t:{for(Fn=St,ct=Ln,tt=0,ft=Fn;ft;ft=ph(ft))tt++;for(ft=0,Dt=ct;Dt;Dt=ph(Dt))ft++;for(;0<tt-ft;)Fn=ph(Fn),tt--;for(;0<ft-tt;)ct=ph(ct),ft--;for(;tt--;){if(Fn===ct||ct!==null&&Fn===ct.alternate)break t;Fn=ph(Fn),ct=ph(ct)}Fn=null}else Fn=null;St!==null&&oW(Ot,Gt,St,Fn,!1),Ln!==null&&Qi!==null&&oW(Ot,Qi,Ln,Fn,!0)}}e:{if(Gt=bt?Fe(bt):window,St=Gt.nodeName&&Gt.nodeName.toLowerCase(),St==="select"||St==="input"&&Gt.type==="file")var yn=MI;else if(IA(Gt))if(WI)yn=Sc;else{yn=zb;var gi=RS}else St=Gt.nodeName,!St||St.toLowerCase()!=="input"||Gt.type!=="checkbox"&&Gt.type!=="radio"?bt&&oa(bt.elementType)&&(yn=MI):yn=Yd;if(yn&&(yn=yn(g,bt))){er(Ot,yn,A,Kt);break e}gi&&gi(g,Gt,bt),g==="focusout"&&bt&&Gt.type==="number"&&bt.memoizedProps.value!=null&&Gn(Gt,"number",Gt.value)}switch(gi=bt?Fe(bt):window,g){case"focusin":(IA(gi)||gi.contentEditable==="true")&&(Nl=gi,NI=bt,Kd=null);break;case"focusout":Kd=NI=Nl=null;break;case"mousedown":EI=!0;break;case"contextmenu":case"mouseup":case"dragend":EI=!1,pA(Ot,A,Kt);break;case"selectionchange":if(mA)break;case"keydown":case"keyup":pA(Ot,A,Kt)}var Mn;if(Nd)e:{switch(g){case"compositionstart":var Tn="onCompositionStart";break e;case"compositionend":Tn="onCompositionEnd";break e;case"compositionupdate":Tn="onCompositionUpdate";break e}Tn=void 0}else Gc?Fd(g,A)&&(Tn="onCompositionEnd"):g==="keydown"&&A.keyCode===229&&(Tn="onCompositionStart");Tn&&(Hd&&A.locale!=="ko"&&(Gc||Tn!=="onCompositionStart"?Tn==="onCompositionEnd"&&Gc&&(Mn=Js()):(Dn=Kt,Gi="value"in Dn?Dn.value:Dn.textContent,Gc=!0)),gi=F0(bt,Tn),0<gi.length&&(Tn=new yr(Tn,g,null,A,Kt),Ot.push({event:Tn,listeners:gi}),Mn?Tn.data=Mn:(Mn=dA(A),Mn!==null&&(Tn.data=Mn)))),(Mn=Ed?Xd(g,A):CA(g,A))&&(Tn=F0(bt,"onBeforeInput"),0<Tn.length&&(gi=new yr("onBeforeInput","beforeinput",null,A,Kt),Ot.push({event:gi,listeners:Tn}),gi.data=Mn)),ML(Ot,g,bt,A,Kt)}iW(Ot,d)})}function am(g,d,A){return{instance:g,listener:d,currentTarget:A}}function F0(g,d){for(var A=d+"Capture",G=[];g!==null;){var W=g,T=W.stateNode;if(W=W.tag,W!==5&&W!==26&&W!==27||T===null||(W=br(g,A),W!=null&&G.unshift(am(g,W,T)),W=br(g,d),W!=null&&G.push(am(g,W,T))),g.tag===3)return G;g=g.return}return[]}function ph(g){if(g===null)return null;do g=g.return;while(g&&g.tag!==5&&g.tag!==27);return g||null}function oW(g,d,A,G,W){for(var T=d._reactName,oe=[];A!==null&&A!==G;){var fe=A,_e=fe.alternate,bt=fe.stateNode;if(fe=fe.tag,_e!==null&&_e===G)break;fe!==5&&fe!==26&&fe!==27||bt===null||(_e=bt,W?(bt=br(A,T),bt!=null&&oe.unshift(am(A,bt,_e))):W||(bt=br(A,T),bt!=null&&oe.push(am(A,bt,_e)))),A=A.return}oe.length!==0&&g.push({event:d,listeners:oe})}var EL=/\r\n?/g,HL=/\u0000|\uFFFD/g;function rW(g){return(typeof g=="string"?g:""+g).replace(EL,`
`).replace(HL,"")}function sW(g,d){return d=rW(d),rW(g)===d}function X0(){}function ji(g,d,A,G,W,T){switch(A){case"children":typeof G=="string"?d==="body"||d==="textarea"&&G===""||li(g,G):(typeof G=="number"||typeof G=="bigint")&&d!=="body"&&li(g,""+G);break;case"className":nt(g,"class",G);break;case"tabIndex":nt(g,"tabindex",G);break;case"dir":case"role":case"viewBox":case"width":case"height":nt(g,A,G);break;case"style":pa(g,G,T);break;case"data":if(d!=="object"){nt(g,"data",G);break}case"src":case"href":if(G===""&&(d!=="a"||A!=="href")){g.removeAttribute(A);break}if(G==null||typeof G=="function"||typeof G=="symbol"||typeof G=="boolean"){g.removeAttribute(A);break}G=pr(""+G),g.setAttribute(A,G);break;case"action":case"formAction":if(typeof G=="function"){g.setAttribute(A,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof T=="function"&&(A==="formAction"?(d!=="input"&&ji(g,d,"name",W.name,W,null),ji(g,d,"formEncType",W.formEncType,W,null),ji(g,d,"formMethod",W.formMethod,W,null),ji(g,d,"formTarget",W.formTarget,W,null)):(ji(g,d,"encType",W.encType,W,null),ji(g,d,"method",W.method,W,null),ji(g,d,"target",W.target,W,null)));if(G==null||typeof G=="symbol"||typeof G=="boolean"){g.removeAttribute(A);break}G=pr(""+G),g.setAttribute(A,G);break;case"onClick":G!=null&&(g.onclick=X0);break;case"onScroll":G!=null&&di("scroll",g);break;case"onScrollEnd":G!=null&&di("scrollend",g);break;case"dangerouslySetInnerHTML":if(G!=null){if(typeof G!="object"||!("__html"in G))throw Error(i(61));if(A=G.__html,A!=null){if(W.children!=null)throw Error(i(60));g.innerHTML=A}}break;case"multiple":g.multiple=G&&typeof G!="function"&&typeof G!="symbol";break;case"muted":g.muted=G&&typeof G!="function"&&typeof G!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(G==null||typeof G=="function"||typeof G=="boolean"||typeof G=="symbol"){g.removeAttribute("xlink:href");break}A=pr(""+G),g.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",A);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":G!=null&&typeof G!="function"&&typeof G!="symbol"?g.setAttribute(A,""+G):g.removeAttribute(A);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":G&&typeof G!="function"&&typeof G!="symbol"?g.setAttribute(A,""):g.removeAttribute(A);break;case"capture":case"download":G===!0?g.setAttribute(A,""):G!==!1&&G!=null&&typeof G!="function"&&typeof G!="symbol"?g.setAttribute(A,G):g.removeAttribute(A);break;case"cols":case"rows":case"size":case"span":G!=null&&typeof G!="function"&&typeof G!="symbol"&&!isNaN(G)&&1<=G?g.setAttribute(A,G):g.removeAttribute(A);break;case"rowSpan":case"start":G==null||typeof G=="function"||typeof G=="symbol"||isNaN(G)?g.removeAttribute(A):g.setAttribute(A,G);break;case"popover":di("beforetoggle",g),di("toggle",g),Ue(g,"popover",G);break;case"xlinkActuate":pt(g,"http://www.w3.org/1999/xlink","xlink:actuate",G);break;case"xlinkArcrole":pt(g,"http://www.w3.org/1999/xlink","xlink:arcrole",G);break;case"xlinkRole":pt(g,"http://www.w3.org/1999/xlink","xlink:role",G);break;case"xlinkShow":pt(g,"http://www.w3.org/1999/xlink","xlink:show",G);break;case"xlinkTitle":pt(g,"http://www.w3.org/1999/xlink","xlink:title",G);break;case"xlinkType":pt(g,"http://www.w3.org/1999/xlink","xlink:type",G);break;case"xmlBase":pt(g,"http://www.w3.org/XML/1998/namespace","xml:base",G);break;case"xmlLang":pt(g,"http://www.w3.org/XML/1998/namespace","xml:lang",G);break;case"xmlSpace":pt(g,"http://www.w3.org/XML/1998/namespace","xml:space",G);break;case"is":Ue(g,"is",G);break;case"innerText":case"textContent":break;default:(!(2<A.length)||A[0]!=="o"&&A[0]!=="O"||A[1]!=="n"&&A[1]!=="N")&&(A=mr.get(A)||A,Ue(g,A,G))}}function DS(g,d,A,G,W,T){switch(A){case"style":pa(g,G,T);break;case"dangerouslySetInnerHTML":if(G!=null){if(typeof G!="object"||!("__html"in G))throw Error(i(61));if(A=G.__html,A!=null){if(W.children!=null)throw Error(i(60));g.innerHTML=A}}break;case"children":typeof G=="string"?li(g,G):(typeof G=="number"||typeof G=="bigint")&&li(g,""+G);break;case"onScroll":G!=null&&di("scroll",g);break;case"onScrollEnd":G!=null&&di("scrollend",g);break;case"onClick":G!=null&&(g.onclick=X0);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Wt.hasOwnProperty(A))e:{if(A[0]==="o"&&A[1]==="n"&&(W=A.endsWith("Capture"),d=A.slice(2,W?A.length-7:void 0),T=g[Nt]||null,T=T!=null?T[A]:null,typeof T=="function"&&g.removeEventListener(d,T,W),typeof G=="function")){typeof T!="function"&&T!==null&&(A in g?g[A]=null:g.hasAttribute(A)&&g.removeAttribute(A)),g.addEventListener(d,G,W);break e}A in g?g[A]=G:G===!0?g.setAttribute(A,""):Ue(g,A,G)}}}function _o(g,d,A){switch(d){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":di("error",g),di("load",g);var G=!1,W=!1,T;for(T in A)if(A.hasOwnProperty(T)){var oe=A[T];if(oe!=null)switch(T){case"src":G=!0;break;case"srcSet":W=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,d));default:ji(g,d,T,oe,A,null)}}W&&ji(g,d,"srcSet",A.srcSet,A,null),G&&ji(g,d,"src",A.src,A,null);return;case"input":di("invalid",g);var fe=T=oe=W=null,_e=null,bt=null;for(G in A)if(A.hasOwnProperty(G)){var Kt=A[G];if(Kt!=null)switch(G){case"name":W=Kt;break;case"type":oe=Kt;break;case"checked":_e=Kt;break;case"defaultChecked":bt=Kt;break;case"value":T=Kt;break;case"defaultValue":fe=Kt;break;case"children":case"dangerouslySetInnerHTML":if(Kt!=null)throw Error(i(137,d));break;default:ji(g,d,G,Kt,A,null)}}Cn(g,T,fe,_e,bt,oe,W,!1),Xn(g);return;case"select":di("invalid",g),G=oe=T=null;for(W in A)if(A.hasOwnProperty(W)&&(fe=A[W],fe!=null))switch(W){case"value":T=fe;break;case"defaultValue":oe=fe;break;case"multiple":G=fe;default:ji(g,d,W,fe,A,null)}d=T,A=oe,g.multiple=!!G,d!=null?pn(g,!!G,d,!1):A!=null&&pn(g,!!G,A,!0);return;case"textarea":di("invalid",g),T=W=G=null;for(oe in A)if(A.hasOwnProperty(oe)&&(fe=A[oe],fe!=null))switch(oe){case"value":G=fe;break;case"defaultValue":W=fe;break;case"children":T=fe;break;case"dangerouslySetInnerHTML":if(fe!=null)throw Error(i(91));break;default:ji(g,d,oe,fe,A,null)}Qn(g,G,W,T),Xn(g);return;case"option":for(_e in A)if(A.hasOwnProperty(_e)&&(G=A[_e],G!=null))switch(_e){case"selected":g.selected=G&&typeof G!="function"&&typeof G!="symbol";break;default:ji(g,d,_e,G,A,null)}return;case"dialog":di("beforetoggle",g),di("toggle",g),di("cancel",g),di("close",g);break;case"iframe":case"object":di("load",g);break;case"video":case"audio":for(G=0;G<im.length;G++)di(im[G],g);break;case"image":di("error",g),di("load",g);break;case"details":di("toggle",g);break;case"embed":case"source":case"link":di("error",g),di("load",g);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(bt in A)if(A.hasOwnProperty(bt)&&(G=A[bt],G!=null))switch(bt){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,d));default:ji(g,d,bt,G,A,null)}return;default:if(oa(d)){for(Kt in A)A.hasOwnProperty(Kt)&&(G=A[Kt],G!==void 0&&DS(g,d,Kt,G,A,void 0));return}}for(fe in A)A.hasOwnProperty(fe)&&(G=A[fe],G!=null&&ji(g,d,fe,G,A,null))}function FL(g,d,A,G){switch(d){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var W=null,T=null,oe=null,fe=null,_e=null,bt=null,Kt=null;for(St in A){var Ot=A[St];if(A.hasOwnProperty(St)&&Ot!=null)switch(St){case"checked":break;case"value":break;case"defaultValue":_e=Ot;default:G.hasOwnProperty(St)||ji(g,d,St,null,G,Ot)}}for(var Gt in G){var St=G[Gt];if(Ot=A[Gt],G.hasOwnProperty(Gt)&&(St!=null||Ot!=null))switch(Gt){case"type":T=St;break;case"name":W=St;break;case"checked":bt=St;break;case"defaultChecked":Kt=St;break;case"value":oe=St;break;case"defaultValue":fe=St;break;case"children":case"dangerouslySetInnerHTML":if(St!=null)throw Error(i(137,d));break;default:St!==Ot&&ji(g,d,Gt,St,G,Ot)}}rn(g,oe,fe,_e,bt,Kt,T,W);return;case"select":St=oe=fe=Gt=null;for(T in A)if(_e=A[T],A.hasOwnProperty(T)&&_e!=null)switch(T){case"value":break;case"multiple":St=_e;default:G.hasOwnProperty(T)||ji(g,d,T,null,G,_e)}for(W in G)if(T=G[W],_e=A[W],G.hasOwnProperty(W)&&(T!=null||_e!=null))switch(W){case"value":Gt=T;break;case"defaultValue":fe=T;break;case"multiple":oe=T;default:T!==_e&&ji(g,d,W,T,G,_e)}d=fe,A=oe,G=St,Gt!=null?pn(g,!!A,Gt,!1):!!G!=!!A&&(d!=null?pn(g,!!A,d,!0):pn(g,!!A,A?[]:"",!1));return;case"textarea":St=Gt=null;for(fe in A)if(W=A[fe],A.hasOwnProperty(fe)&&W!=null&&!G.hasOwnProperty(fe))switch(fe){case"value":break;case"children":break;default:ji(g,d,fe,null,G,W)}for(oe in G)if(W=G[oe],T=A[oe],G.hasOwnProperty(oe)&&(W!=null||T!=null))switch(oe){case"value":Gt=W;break;case"defaultValue":St=W;break;case"children":break;case"dangerouslySetInnerHTML":if(W!=null)throw Error(i(91));break;default:W!==T&&ji(g,d,oe,W,G,T)}Kn(g,Gt,St);return;case"option":for(var Ln in A)if(Gt=A[Ln],A.hasOwnProperty(Ln)&&Gt!=null&&!G.hasOwnProperty(Ln))switch(Ln){case"selected":g.selected=!1;break;default:ji(g,d,Ln,null,G,Gt)}for(_e in G)if(Gt=G[_e],St=A[_e],G.hasOwnProperty(_e)&&Gt!==St&&(Gt!=null||St!=null))switch(_e){case"selected":g.selected=Gt&&typeof Gt!="function"&&typeof Gt!="symbol";break;default:ji(g,d,_e,Gt,G,St)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Fn in A)Gt=A[Fn],A.hasOwnProperty(Fn)&&Gt!=null&&!G.hasOwnProperty(Fn)&&ji(g,d,Fn,null,G,Gt);for(bt in G)if(Gt=G[bt],St=A[bt],G.hasOwnProperty(bt)&&Gt!==St&&(Gt!=null||St!=null))switch(bt){case"children":case"dangerouslySetInnerHTML":if(Gt!=null)throw Error(i(137,d));break;default:ji(g,d,bt,Gt,G,St)}return;default:if(oa(d)){for(var Qi in A)Gt=A[Qi],A.hasOwnProperty(Qi)&&Gt!==void 0&&!G.hasOwnProperty(Qi)&&DS(g,d,Qi,void 0,G,Gt);for(Kt in G)Gt=G[Kt],St=A[Kt],!G.hasOwnProperty(Kt)||Gt===St||Gt===void 0&&St===void 0||DS(g,d,Kt,Gt,G,St);return}}for(var ct in A)Gt=A[ct],A.hasOwnProperty(ct)&&Gt!=null&&!G.hasOwnProperty(ct)&&ji(g,d,ct,null,G,Gt);for(Ot in G)Gt=G[Ot],St=A[Ot],!G.hasOwnProperty(Ot)||Gt===St||Gt==null&&St==null||ji(g,d,Ot,Gt,G,St)}var OS=null,US=null;function T0(g){return g.nodeType===9?g:g.ownerDocument}function lW(g){switch(g){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function cW(g,d){if(g===0)switch(d){case"svg":return 1;case"math":return 2;default:return 0}return g===1&&d==="foreignObject"?0:g}function kS(g,d){return g==="textarea"||g==="noscript"||typeof d.children=="string"||typeof d.children=="number"||typeof d.children=="bigint"||typeof d.dangerouslySetInnerHTML=="object"&&d.dangerouslySetInnerHTML!==null&&d.dangerouslySetInnerHTML.__html!=null}var PS=null;function XL(){var g=window.event;return g&&g.type==="popstate"?g===PS?!1:(PS=g,!0):(PS=null,!1)}var gW=typeof setTimeout=="function"?setTimeout:void 0,TL=typeof clearTimeout=="function"?clearTimeout:void 0,uW=typeof Promise=="function"?Promise:void 0,YL=typeof queueMicrotask=="function"?queueMicrotask:typeof uW<"u"?function(g){return uW.resolve(null).then(g).catch(zL)}:gW;function zL(g){setTimeout(function(){throw g})}function Pu(g){return g==="head"}function dW(g,d){var A=d,G=0,W=0;do{var T=A.nextSibling;if(g.removeChild(A),T&&T.nodeType===8)if(A=T.data,A==="/$"){if(0<G&&8>G){A=G;var oe=g.ownerDocument;if(A&1&&om(oe.documentElement),A&2&&om(oe.body),A&4)for(A=oe.head,om(A),oe=A.firstChild;oe;){var fe=oe.nextSibling,_e=oe.nodeName;oe[fn]||_e==="SCRIPT"||_e==="STYLE"||_e==="LINK"&&oe.rel.toLowerCase()==="stylesheet"||A.removeChild(oe),oe=fe}}if(W===0){g.removeChild(T),Cm(d);return}W--}else A==="$"||A==="$?"||A==="$!"?W++:G=A.charCodeAt(0)-48;else G=0;A=T}while(A);Cm(d)}function JS(g){var d=g.firstChild;for(d&&d.nodeType===10&&(d=d.nextSibling);d;){var A=d;switch(d=d.nextSibling,A.nodeName){case"HTML":case"HEAD":case"BODY":JS(A),sn(A);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(A.rel.toLowerCase()==="stylesheet")continue}g.removeChild(A)}}function KL(g,d,A,G){for(;g.nodeType===1;){var W=A;if(g.nodeName.toLowerCase()!==d.toLowerCase()){if(!G&&(g.nodeName!=="INPUT"||g.type!=="hidden"))break}else if(G){if(!g[fn])switch(d){case"meta":if(!g.hasAttribute("itemprop"))break;return g;case"link":if(T=g.getAttribute("rel"),T==="stylesheet"&&g.hasAttribute("data-precedence"))break;if(T!==W.rel||g.getAttribute("href")!==(W.href==null||W.href===""?null:W.href)||g.getAttribute("crossorigin")!==(W.crossOrigin==null?null:W.crossOrigin)||g.getAttribute("title")!==(W.title==null?null:W.title))break;return g;case"style":if(g.hasAttribute("data-precedence"))break;return g;case"script":if(T=g.getAttribute("src"),(T!==(W.src==null?null:W.src)||g.getAttribute("type")!==(W.type==null?null:W.type)||g.getAttribute("crossorigin")!==(W.crossOrigin==null?null:W.crossOrigin))&&T&&g.hasAttribute("async")&&!g.hasAttribute("itemprop"))break;return g;default:return g}}else if(d==="input"&&g.type==="hidden"){var T=W.name==null?null:""+W.name;if(W.type==="hidden"&&g.getAttribute("name")===T)return g}else return g;if(g=ql(g.nextSibling),g===null)break}return null}function LL(g,d,A){if(d==="")return null;for(;g.nodeType!==3;)if((g.nodeType!==1||g.nodeName!=="INPUT"||g.type!=="hidden")&&!A||(g=ql(g.nextSibling),g===null))return null;return g}function jS(g){return g.data==="$!"||g.data==="$?"&&g.ownerDocument.readyState==="complete"}function _L(g,d){var A=g.ownerDocument;if(g.data!=="$?"||A.readyState==="complete")d();else{var G=function(){d(),A.removeEventListener("DOMContentLoaded",G)};A.addEventListener("DOMContentLoaded",G),g._reactRetry=G}}function ql(g){for(;g!=null;g=g.nextSibling){var d=g.nodeType;if(d===1||d===3)break;if(d===8){if(d=g.data,d==="$"||d==="$!"||d==="$?"||d==="F!"||d==="F")break;if(d==="/$")return null}}return g}var QS=null;function CW(g){g=g.previousSibling;for(var d=0;g;){if(g.nodeType===8){var A=g.data;if(A==="$"||A==="$!"||A==="$?"){if(d===0)return g;d--}else A==="/$"&&d++}g=g.previousSibling}return null}function IW(g,d,A){switch(d=T0(A),g){case"html":if(g=d.documentElement,!g)throw Error(i(452));return g;case"head":if(g=d.head,!g)throw Error(i(453));return g;case"body":if(g=d.body,!g)throw Error(i(454));return g;default:throw Error(i(451))}}function om(g){for(var d=g.attributes;d.length;)g.removeAttributeNode(d[0]);sn(g)}var dl=new Map,hW=new Set;function Y0(g){return typeof g.getRootNode=="function"?g.getRootNode():g.nodeType===9?g:g.ownerDocument}var _g=L.d;L.d={f:DL,r:OL,D:UL,C:kL,L:PL,m:JL,X:QL,S:jL,M:qL};function DL(){var g=_g.f(),d=gl();return g||d}function OL(g){var d=ue(g);d!==null&&d.tag===5&&d.type==="form"?m0(d):_g.r(g)}var bh=typeof document>"u"?null:document;function fW(g,d,A){var G=bh;if(G&&typeof d=="string"&&d){var W=Et(d);W='link[rel="'+g+'"][href="'+W+'"]',typeof A=="string"&&(W+='[crossorigin="'+A+'"]'),hW.has(W)||(hW.add(W),g={rel:g,crossOrigin:A,href:d},G.querySelector(W)===null&&(d=G.createElement("link"),_o(d,"link",g),at(d),G.head.appendChild(d)))}}function UL(g){_g.D(g),fW("dns-prefetch",g,null)}function kL(g,d){_g.C(g,d),fW("preconnect",g,d)}function PL(g,d,A){_g.L(g,d,A);var G=bh;if(G&&g&&d){var W='link[rel="preload"][as="'+Et(d)+'"]';d==="image"&&A&&A.imageSrcSet?(W+='[imagesrcset="'+Et(A.imageSrcSet)+'"]',typeof A.imageSizes=="string"&&(W+='[imagesizes="'+Et(A.imageSizes)+'"]')):W+='[href="'+Et(g)+'"]';var T=W;switch(d){case"style":T=vh(g);break;case"script":T=yh(g)}dl.has(T)||(g=u({rel:"preload",href:d==="image"&&A&&A.imageSrcSet?void 0:g,as:d},A),dl.set(T,g),G.querySelector(W)!==null||d==="style"&&G.querySelector(rm(T))||d==="script"&&G.querySelector(sm(T))||(d=G.createElement("link"),_o(d,"link",g),at(d),G.head.appendChild(d)))}}function JL(g,d){_g.m(g,d);var A=bh;if(A&&g){var G=d&&typeof d.as=="string"?d.as:"script",W='link[rel="modulepreload"][as="'+Et(G)+'"][href="'+Et(g)+'"]',T=W;switch(G){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":T=yh(g)}if(!dl.has(T)&&(g=u({rel:"modulepreload",href:g},d),dl.set(T,g),A.querySelector(W)===null)){switch(G){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(A.querySelector(sm(T)))return}G=A.createElement("link"),_o(G,"link",g),at(G),A.head.appendChild(G)}}}function jL(g,d,A){_g.S(g,d,A);var G=bh;if(G&&g){var W=ot(G).hoistableStyles,T=vh(g);d=d||"default";var oe=W.get(T);if(!oe){var fe={loading:0,preload:null};if(oe=G.querySelector(rm(T)))fe.loading=5;else{g=u({rel:"stylesheet",href:g,"data-precedence":d},A),(A=dl.get(T))&&qS(g,A);var _e=oe=G.createElement("link");at(_e),_o(_e,"link",g),_e._p=new Promise(function(bt,Kt){_e.onload=bt,_e.onerror=Kt}),_e.addEventListener("load",function(){fe.loading|=1}),_e.addEventListener("error",function(){fe.loading|=2}),fe.loading|=4,z0(oe,d,G)}oe={type:"stylesheet",instance:oe,count:1,state:fe},W.set(T,oe)}}}function QL(g,d){_g.X(g,d);var A=bh;if(A&&g){var G=ot(A).hoistableScripts,W=yh(g),T=G.get(W);T||(T=A.querySelector(sm(W)),T||(g=u({src:g,async:!0},d),(d=dl.get(W))&&$S(g,d),T=A.createElement("script"),at(T),_o(T,"link",g),A.head.appendChild(T)),T={type:"script",instance:T,count:1,state:null},G.set(W,T))}}function qL(g,d){_g.M(g,d);var A=bh;if(A&&g){var G=ot(A).hoistableScripts,W=yh(g),T=G.get(W);T||(T=A.querySelector(sm(W)),T||(g=u({src:g,async:!0,type:"module"},d),(d=dl.get(W))&&$S(g,d),T=A.createElement("script"),at(T),_o(T,"link",g),A.head.appendChild(T)),T={type:"script",instance:T,count:1,state:null},G.set(W,T))}}function AW(g,d,A,G){var W=(W=re.current)?Y0(W):null;if(!W)throw Error(i(446));switch(g){case"meta":case"title":return null;case"style":return typeof A.precedence=="string"&&typeof A.href=="string"?(d=vh(A.href),A=ot(W).hoistableStyles,G=A.get(d),G||(G={type:"style",instance:null,count:0,state:null},A.set(d,G)),G):{type:"void",instance:null,count:0,state:null};case"link":if(A.rel==="stylesheet"&&typeof A.href=="string"&&typeof A.precedence=="string"){g=vh(A.href);var T=ot(W).hoistableStyles,oe=T.get(g);if(oe||(W=W.ownerDocument||W,oe={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},T.set(g,oe),(T=W.querySelector(rm(g)))&&!T._p&&(oe.instance=T,oe.state.loading=5),dl.has(g)||(A={rel:"preload",as:"style",href:A.href,crossOrigin:A.crossOrigin,integrity:A.integrity,media:A.media,hrefLang:A.hrefLang,referrerPolicy:A.referrerPolicy},dl.set(g,A),T||$L(W,g,A,oe.state))),d&&G===null)throw Error(i(528,""));return oe}if(d&&G!==null)throw Error(i(529,""));return null;case"script":return d=A.async,A=A.src,typeof A=="string"&&d&&typeof d!="function"&&typeof d!="symbol"?(d=yh(A),A=ot(W).hoistableScripts,G=A.get(d),G||(G={type:"script",instance:null,count:0,state:null},A.set(d,G)),G):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,g))}}function vh(g){return'href="'+Et(g)+'"'}function rm(g){return'link[rel="stylesheet"]['+g+"]"}function mW(g){return u({},g,{"data-precedence":g.precedence,precedence:null})}function $L(g,d,A,G){g.querySelector('link[rel="preload"][as="style"]['+d+"]")?G.loading=1:(d=g.createElement("link"),G.preload=d,d.addEventListener("load",function(){return G.loading|=1}),d.addEventListener("error",function(){return G.loading|=2}),_o(d,"link",A),at(d),g.head.appendChild(d))}function yh(g){return'[src="'+Et(g)+'"]'}function sm(g){return"script[async]"+g}function pW(g,d,A){if(d.count++,d.instance===null)switch(d.type){case"style":var G=g.querySelector('style[data-href~="'+Et(A.href)+'"]');if(G)return d.instance=G,at(G),G;var W=u({},A,{"data-href":A.href,"data-precedence":A.precedence,href:null,precedence:null});return G=(g.ownerDocument||g).createElement("style"),at(G),_o(G,"style",W),z0(G,A.precedence,g),d.instance=G;case"stylesheet":W=vh(A.href);var T=g.querySelector(rm(W));if(T)return d.state.loading|=4,d.instance=T,at(T),T;G=mW(A),(W=dl.get(W))&&qS(G,W),T=(g.ownerDocument||g).createElement("link"),at(T);var oe=T;return oe._p=new Promise(function(fe,_e){oe.onload=fe,oe.onerror=_e}),_o(T,"link",G),d.state.loading|=4,z0(T,A.precedence,g),d.instance=T;case"script":return T=yh(A.src),(W=g.querySelector(sm(T)))?(d.instance=W,at(W),W):(G=A,(W=dl.get(T))&&(G=u({},A),$S(G,W)),g=g.ownerDocument||g,W=g.createElement("script"),at(W),_o(W,"link",G),g.head.appendChild(W),d.instance=W);case"void":return null;default:throw Error(i(443,d.type))}else d.type==="stylesheet"&&(d.state.loading&4)===0&&(G=d.instance,d.state.loading|=4,z0(G,A.precedence,g));return d.instance}function z0(g,d,A){for(var G=A.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),W=G.length?G[G.length-1]:null,T=W,oe=0;oe<G.length;oe++){var fe=G[oe];if(fe.dataset.precedence===d)T=fe;else if(T!==W)break}T?T.parentNode.insertBefore(g,T.nextSibling):(d=A.nodeType===9?A.head:A,d.insertBefore(g,d.firstChild))}function qS(g,d){g.crossOrigin==null&&(g.crossOrigin=d.crossOrigin),g.referrerPolicy==null&&(g.referrerPolicy=d.referrerPolicy),g.title==null&&(g.title=d.title)}function $S(g,d){g.crossOrigin==null&&(g.crossOrigin=d.crossOrigin),g.referrerPolicy==null&&(g.referrerPolicy=d.referrerPolicy),g.integrity==null&&(g.integrity=d.integrity)}var K0=null;function bW(g,d,A){if(K0===null){var G=new Map,W=K0=new Map;W.set(A,G)}else W=K0,G=W.get(A),G||(G=new Map,W.set(A,G));if(G.has(g))return G;for(G.set(g,null),A=A.getElementsByTagName(g),W=0;W<A.length;W++){var T=A[W];if(!(T[fn]||T[Ut]||g==="link"&&T.getAttribute("rel")==="stylesheet")&&T.namespaceURI!=="http://www.w3.org/2000/svg"){var oe=T.getAttribute(d)||"";oe=g+oe;var fe=G.get(oe);fe?fe.push(T):G.set(oe,[T])}}return G}function vW(g,d,A){g=g.ownerDocument||g,g.head.insertBefore(A,d==="title"?g.querySelector("head > title"):null)}function e_(g,d,A){if(A===1||d.itemProp!=null)return!1;switch(g){case"meta":case"title":return!0;case"style":if(typeof d.precedence!="string"||typeof d.href!="string"||d.href==="")break;return!0;case"link":if(typeof d.rel!="string"||typeof d.href!="string"||d.href===""||d.onLoad||d.onError)break;switch(d.rel){case"stylesheet":return g=d.disabled,typeof d.precedence=="string"&&g==null;default:return!0}case"script":if(d.async&&typeof d.async!="function"&&typeof d.async!="symbol"&&!d.onLoad&&!d.onError&&d.src&&typeof d.src=="string")return!0}return!1}function yW(g){return!(g.type==="stylesheet"&&(g.state.loading&3)===0)}var lm=null;function t_(){}function n_(g,d,A){if(lm===null)throw Error(i(475));var G=lm;if(d.type==="stylesheet"&&(typeof A.media!="string"||matchMedia(A.media).matches!==!1)&&(d.state.loading&4)===0){if(d.instance===null){var W=vh(A.href),T=g.querySelector(rm(W));if(T){g=T._p,g!==null&&typeof g=="object"&&typeof g.then=="function"&&(G.count++,G=L0.bind(G),g.then(G,G)),d.state.loading|=4,d.instance=T,at(T);return}T=g.ownerDocument||g,A=mW(A),(W=dl.get(W))&&qS(A,W),T=T.createElement("link"),at(T);var oe=T;oe._p=new Promise(function(fe,_e){oe.onload=fe,oe.onerror=_e}),_o(T,"link",A),d.instance=T}G.stylesheets===null&&(G.stylesheets=new Map),G.stylesheets.set(d,g),(g=d.state.preload)&&(d.state.loading&3)===0&&(G.count++,d=L0.bind(G),g.addEventListener("load",d),g.addEventListener("error",d))}}function i_(){if(lm===null)throw Error(i(475));var g=lm;return g.stylesheets&&g.count===0&&e2(g,g.stylesheets),0<g.count?function(d){var A=setTimeout(function(){if(g.stylesheets&&e2(g,g.stylesheets),g.unsuspend){var G=g.unsuspend;g.unsuspend=null,G()}},6e4);return g.unsuspend=d,function(){g.unsuspend=null,clearTimeout(A)}}:null}function L0(){if(this.count--,this.count===0){if(this.stylesheets)e2(this,this.stylesheets);else if(this.unsuspend){var g=this.unsuspend;this.unsuspend=null,g()}}}var _0=null;function e2(g,d){g.stylesheets=null,g.unsuspend!==null&&(g.count++,_0=new Map,d.forEach(a_,g),_0=null,L0.call(g))}function a_(g,d){if(!(d.state.loading&4)){var A=_0.get(g);if(A)var G=A.get(null);else{A=new Map,_0.set(g,A);for(var W=g.querySelectorAll("link[data-precedence],style[data-precedence]"),T=0;T<W.length;T++){var oe=W[T];(oe.nodeName==="LINK"||oe.getAttribute("media")!=="not all")&&(A.set(oe.dataset.precedence,oe),G=oe)}G&&A.set(null,G)}W=d.instance,oe=W.getAttribute("data-precedence"),T=A.get(oe)||G,T===G&&A.set(null,W),A.set(oe,W),this.count++,G=L0.bind(this),W.addEventListener("load",G),W.addEventListener("error",G),T?T.parentNode.insertBefore(W,T.nextSibling):(g=g.nodeType===9?g.head:g,g.insertBefore(W,g.firstChild)),d.state.loading|=4}}var cm={$$typeof:R,Provider:null,Consumer:null,_currentValue:U,_currentValue2:U,_threadCount:0};function o_(g,d,A,G,W,T,oe,fe){this.tag=1,this.containerInfo=g,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Qe(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Qe(0),this.hiddenUpdates=Qe(null),this.identifierPrefix=G,this.onUncaughtError=W,this.onCaughtError=T,this.onRecoverableError=oe,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=fe,this.incompleteTransitions=new Map}function BW(g,d,A,G,W,T,oe,fe,_e,bt,Kt,Ot){return g=new o_(g,d,A,oe,fe,_e,bt,Ot),d=1,T===!0&&(d|=24),T=ar(3,null,null,d),g.current=T,T.stateNode=g,d=_I(),d.refCount++,g.pooledCache=d,d.refCount++,T.memoizedState={element:G,isDehydrated:A,cache:d},NA(T),g}function GW(g){return g?(g=Zc,g):Zc}function SW(g,d,A,G,W,T){W=GW(W),G.context===null?G.context=W:G.pendingContext=W,G=$s(d),G.payload={element:A},T=T===void 0?null:T,T!==null&&(G.callback=T),A=Ll(g,G,d),A!==null&&(Lo(A,g,d),Sg(A,g,d))}function wW(g,d){if(g=g.memoizedState,g!==null&&g.dehydrated!==null){var A=g.retryLane;g.retryLane=A!==0&&A<d?A:d}}function t2(g,d){wW(g,d),(g=g.alternate)&&wW(g,d)}function RW(g){if(g.tag===13){var d=Xl(g,67108864);d!==null&&Lo(d,g,67108864),t2(g,67108864)}}var D0=!0;function r_(g,d,A,G){var W=X.T;X.T=null;var T=L.p;try{L.p=2,n2(g,d,A,G)}finally{L.p=T,X.T=W}}function s_(g,d,A,G){var W=X.T;X.T=null;var T=L.p;try{L.p=8,n2(g,d,A,G)}finally{L.p=T,X.T=W}}function n2(g,d,A,G){if(D0){var W=i2(G);if(W===null)_S(g,d,G,O0,A),xW(g,G);else if(c_(W,g,d,A,G))G.stopPropagation();else if(xW(g,G),d&4&&-1<l_.indexOf(g)){for(;W!==null;){var T=ue(W);if(T!==null)switch(T.tag){case 3:if(T=T.stateNode,T.current.memoizedState.isDehydrated){var oe=ke(T.pendingLanes);if(oe!==0){var fe=T;for(fe.pendingLanes|=2,fe.entangledLanes|=2;oe;){var _e=1<<31-Je(oe);fe.entanglements[1]|=_e,oe&=~_e}qc(T),(Vi&6)===0&&(Bo=Ge()+500,nm(0))}}break;case 13:fe=Xl(T,2),fe!==null&&Lo(fe,T,2),gl(),t2(T,2)}if(T=i2(G),T===null&&_S(g,d,G,O0,A),T===W)break;W=T}W!==null&&G.stopPropagation()}else _S(g,d,G,null,A)}}function i2(g){return g=Ua(g),a2(g)}var O0=null;function a2(g){if(O0=null,g=ae(g),g!==null){var d=o(g);if(d===null)g=null;else{var A=d.tag;if(A===13){if(g=r(d),g!==null)return g;g=null}else if(A===3){if(d.stateNode.current.memoizedState.isDehydrated)return d.tag===3?d.stateNode.containerInfo:null;g=null}else d!==g&&(g=null)}}return O0=g,null}function ZW(g){switch(g){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(be()){case Ee:return 2;case Se:return 8;case ee:case Q:return 32;case ce:return 268435456;default:return 32}default:return 32}}var o2=!1,Ju=null,ju=null,Qu=null,gm=new Map,um=new Map,qu=[],l_="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function xW(g,d){switch(g){case"focusin":case"focusout":Ju=null;break;case"dragenter":case"dragleave":ju=null;break;case"mouseover":case"mouseout":Qu=null;break;case"pointerover":case"pointerout":gm.delete(d.pointerId);break;case"gotpointercapture":case"lostpointercapture":um.delete(d.pointerId)}}function dm(g,d,A,G,W,T){return g===null||g.nativeEvent!==T?(g={blockedOn:d,domEventName:A,eventSystemFlags:G,nativeEvent:T,targetContainers:[W]},d!==null&&(d=ue(d),d!==null&&RW(d)),g):(g.eventSystemFlags|=G,d=g.targetContainers,W!==null&&d.indexOf(W)===-1&&d.push(W),g)}function c_(g,d,A,G,W){switch(d){case"focusin":return Ju=dm(Ju,g,d,A,G,W),!0;case"dragenter":return ju=dm(ju,g,d,A,G,W),!0;case"mouseover":return Qu=dm(Qu,g,d,A,G,W),!0;case"pointerover":var T=W.pointerId;return gm.set(T,dm(gm.get(T)||null,g,d,A,G,W)),!0;case"gotpointercapture":return T=W.pointerId,um.set(T,dm(um.get(T)||null,g,d,A,G,W)),!0}return!1}function MW(g){var d=ae(g.target);if(d!==null){var A=o(d);if(A!==null){if(d=A.tag,d===13){if(d=r(A),d!==null){g.blockedOn=d,Ht(g.priority,function(){if(A.tag===13){var G=Ia();G=Lt(G);var W=Xl(A,G);W!==null&&Lo(W,A,G),t2(A,G)}});return}}else if(d===3&&A.stateNode.current.memoizedState.isDehydrated){g.blockedOn=A.tag===3?A.stateNode.containerInfo:null;return}}}g.blockedOn=null}function U0(g){if(g.blockedOn!==null)return!1;for(var d=g.targetContainers;0<d.length;){var A=i2(g.nativeEvent);if(A===null){A=g.nativeEvent;var G=new A.constructor(A.type,A);Ki=G,A.target.dispatchEvent(G),Ki=null}else return d=ue(A),d!==null&&RW(d),g.blockedOn=A,!1;d.shift()}return!0}function WW(g,d,A){U0(g)&&A.delete(d)}function g_(){o2=!1,Ju!==null&&U0(Ju)&&(Ju=null),ju!==null&&U0(ju)&&(ju=null),Qu!==null&&U0(Qu)&&(Qu=null),gm.forEach(WW),um.forEach(WW)}function k0(g,d){g.blockedOn===d&&(g.blockedOn=null,o2||(o2=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,g_)))}var P0=null;function VW(g){P0!==g&&(P0=g,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){P0===g&&(P0=null);for(var d=0;d<g.length;d+=3){var A=g[d],G=g[d+1],W=g[d+2];if(typeof G!="function"){if(a2(G||A)===null)continue;break}var T=ue(A);T!==null&&(g.splice(d,3),d-=3,JA(T,{pending:!0,data:W,method:A.method,action:G},G,W))}}))}function Cm(g){function d(_e){return k0(_e,g)}Ju!==null&&k0(Ju,g),ju!==null&&k0(ju,g),Qu!==null&&k0(Qu,g),gm.forEach(d),um.forEach(d);for(var A=0;A<qu.length;A++){var G=qu[A];G.blockedOn===g&&(G.blockedOn=null)}for(;0<qu.length&&(A=qu[0],A.blockedOn===null);)MW(A),A.blockedOn===null&&qu.shift();if(A=(g.ownerDocument||g).$$reactFormReplay,A!=null)for(G=0;G<A.length;G+=3){var W=A[G],T=A[G+1],oe=W[Nt]||null;if(typeof T=="function")oe||VW(A);else if(oe){var fe=null;if(T&&T.hasAttribute("formAction")){if(W=T,oe=T[Nt]||null)fe=oe.formAction;else if(a2(W)!==null)continue}else fe=oe.action;typeof fe=="function"?A[G+1]=fe:(A.splice(G,3),G-=3),VW(A)}}}function r2(g){this._internalRoot=g}J0.prototype.render=r2.prototype.render=function(g){var d=this._internalRoot;if(d===null)throw Error(i(409));var A=d.current,G=Ia();SW(A,G,g,d,null,null)},J0.prototype.unmount=r2.prototype.unmount=function(){var g=this._internalRoot;if(g!==null){this._internalRoot=null;var d=g.containerInfo;SW(g.current,2,null,g,null,null),gl(),d[Tt]=null}};function J0(g){this._internalRoot=g}J0.prototype.unstable_scheduleHydration=function(g){if(g){var d=yt();g={blockedOn:null,target:g,priority:d};for(var A=0;A<qu.length&&d!==0&&d<qu[A].priority;A++);qu.splice(A,0,g),A===0&&MW(g)}};var NW=e.version;if(NW!=="19.1.0")throw Error(i(527,NW,"19.1.0"));L.findDOMNode=function(g){var d=g._reactInternals;if(d===void 0)throw typeof g.render=="function"?Error(i(188)):(g=Object.keys(g).join(","),Error(i(268,g)));return g=l(d),g=g!==null?c(g):null,g=g===null?null:g.stateNode,g};var u_={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:X,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var j0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!j0.isDisabled&&j0.supportsFiber)try{Xe=j0.inject(u_),De=j0}catch{}}return hm.createRoot=function(g,d){if(!a(g))throw Error(i(299));var A=!1,G="",W=lC,T=rh,oe=M0,fe=null;return d!=null&&(d.unstable_strictMode===!0&&(A=!0),d.identifierPrefix!==void 0&&(G=d.identifierPrefix),d.onUncaughtError!==void 0&&(W=d.onUncaughtError),d.onCaughtError!==void 0&&(T=d.onCaughtError),d.onRecoverableError!==void 0&&(oe=d.onRecoverableError),d.unstable_transitionCallbacks!==void 0&&(fe=d.unstable_transitionCallbacks)),d=BW(g,1,!1,null,null,A,G,W,T,oe,fe,null),g[Tt]=d.current,LS(g),new r2(d)},hm.hydrateRoot=function(g,d,A){if(!a(g))throw Error(i(299));var G=!1,W="",T=lC,oe=rh,fe=M0,_e=null,bt=null;return A!=null&&(A.unstable_strictMode===!0&&(G=!0),A.identifierPrefix!==void 0&&(W=A.identifierPrefix),A.onUncaughtError!==void 0&&(T=A.onUncaughtError),A.onCaughtError!==void 0&&(oe=A.onCaughtError),A.onRecoverableError!==void 0&&(fe=A.onRecoverableError),A.unstable_transitionCallbacks!==void 0&&(_e=A.unstable_transitionCallbacks),A.formState!==void 0&&(bt=A.formState)),d=BW(g,1,!0,d,A??null,G,W,T,oe,fe,_e,bt),d.context=GW(null),A=d.current,G=Ia(),G=Lt(G),W=$s(G),W.callback=null,Ll(A,W,G),A=G,d.current.lanes=A,ut(d,A),qc(d),g[Tt]=d.current,LS(g),new J0(d)},hm.version="19.1.0",hm}var _W;function S_(){if(_W)return c2.exports;_W=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),c2.exports=G_(),c2.exports}var kF=S_(),fm={},DW;function w_(){if(DW)return fm;DW=1,Object.defineProperty(fm,"__esModule",{value:!0}),fm.parse=r,fm.serialize=c;const n=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,e=/^[\u0021-\u003A\u003C-\u007E]*$/,t=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,i=/^[\u0020-\u003A\u003D-\u007E]*$/,a=Object.prototype.toString,o=(()=>{const h=function(){};return h.prototype=Object.create(null),h})();function r(h,m){const p=new o,B=h.length;if(B<2)return p;const b=(m==null?void 0:m.decode)||u;let y=0;do{const S=h.indexOf("=",y);if(S===-1)break;const R=h.indexOf(";",y),Z=R===-1?B:R;if(S>Z){y=h.lastIndexOf(";",S-1)+1;continue}const x=s(h,y,S),M=l(h,S,x),E=h.slice(x,M);if(p[E]===void 0){let F=s(h,S+1,Z),N=l(h,Z,F);const H=b(h.slice(F,N));p[E]=H}y=Z+1}while(y<B);return p}function s(h,m,p){do{const B=h.charCodeAt(m);if(B!==32&&B!==9)return m}while(++m<p);return p}function l(h,m,p){for(;m>p;){const B=h.charCodeAt(--m);if(B!==32&&B!==9)return m+1}return p}function c(h,m,p){const B=(p==null?void 0:p.encode)||encodeURIComponent;if(!n.test(h))throw new TypeError(`argument name is invalid: ${h}`);const b=B(m);if(!e.test(b))throw new TypeError(`argument val is invalid: ${m}`);let y=h+"="+b;if(!p)return y;if(p.maxAge!==void 0){if(!Number.isInteger(p.maxAge))throw new TypeError(`option maxAge is invalid: ${p.maxAge}`);y+="; Max-Age="+p.maxAge}if(p.domain){if(!t.test(p.domain))throw new TypeError(`option domain is invalid: ${p.domain}`);y+="; Domain="+p.domain}if(p.path){if(!i.test(p.path))throw new TypeError(`option path is invalid: ${p.path}`);y+="; Path="+p.path}if(p.expires){if(!C(p.expires)||!Number.isFinite(p.expires.valueOf()))throw new TypeError(`option expires is invalid: ${p.expires}`);y+="; Expires="+p.expires.toUTCString()}if(p.httpOnly&&(y+="; HttpOnly"),p.secure&&(y+="; Secure"),p.partitioned&&(y+="; Partitioned"),p.priority)switch(typeof p.priority=="string"?p.priority.toLowerCase():void 0){case"low":y+="; Priority=Low";break;case"medium":y+="; Priority=Medium";break;case"high":y+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${p.priority}`)}if(p.sameSite)switch(typeof p.sameSite=="string"?p.sameSite.toLowerCase():p.sameSite){case!0:case"strict":y+="; SameSite=Strict";break;case"lax":y+="; SameSite=Lax";break;case"none":y+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${p.sameSite}`)}return y}function u(h){if(h.indexOf("%")===-1)return h;try{return decodeURIComponent(h)}catch{return h}}function C(h){return a.call(h)==="[object Date]"}return fm}w_();/**
 * react-router v7.5.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var OW="popstate";function R_(n={}){function e(i,a){let{pathname:o,search:r,hash:s}=i.location;return M1("",{pathname:o,search:r,hash:s},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function t(i,a){return typeof a=="string"?a:vp(a)}return x_(e,t,null,n)}function Io(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function ug(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Z_(){return Math.random().toString(36).substring(2,10)}function UW(n,e){return{usr:n.state,key:n.key,idx:e}}function M1(n,e,t=null,i){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?Jp(e):e,state:t,key:e&&e.key||i||Z_()}}function vp({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function Jp(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let i=n.indexOf("?");i>=0&&(e.search=n.substring(i),n=n.substring(0,i)),n&&(e.pathname=n)}return e}function x_(n,e,t,i={}){let{window:a=document.defaultView,v5Compat:o=!1}=i,r=a.history,s="POP",l=null,c=u();c==null&&(c=0,r.replaceState({...r.state,idx:c},""));function u(){return(r.state||{idx:null}).idx}function C(){s="POP";let b=u(),y=b==null?null:b-c;c=b,l&&l({action:s,location:B.location,delta:y})}function h(b,y){s="PUSH";let S=M1(B.location,b,y);c=u()+1;let R=UW(S,c),Z=B.createHref(S);try{r.pushState(R,"",Z)}catch(x){if(x instanceof DOMException&&x.name==="DataCloneError")throw x;a.location.assign(Z)}o&&l&&l({action:s,location:B.location,delta:1})}function m(b,y){s="REPLACE";let S=M1(B.location,b,y);c=u();let R=UW(S,c),Z=B.createHref(S);r.replaceState(R,"",Z),o&&l&&l({action:s,location:B.location,delta:0})}function p(b){let y=a.location.origin!=="null"?a.location.origin:a.location.href,S=typeof b=="string"?b:vp(b);return S=S.replace(/ $/,"%20"),Io(y,`No window.location.(origin|href) available to create URL for href: ${S}`),new URL(S,y)}let B={get action(){return s},get location(){return n(a,r)},listen(b){if(l)throw new Error("A history only accepts one active listener");return a.addEventListener(OW,C),l=b,()=>{a.removeEventListener(OW,C),l=null}},createHref(b){return e(a,b)},createURL:p,encodeLocation(b){let y=p(b);return{pathname:y.pathname,search:y.search,hash:y.hash}},push:h,replace:m,go(b){return r.go(b)}};return B}function PF(n,e,t="/"){return M_(n,e,t,!1)}function M_(n,e,t,i){let a=typeof e=="string"?Jp(e):e,o=cu(a.pathname||"/",t);if(o==null)return null;let r=JF(n);W_(r);let s=null;for(let l=0;s==null&&l<r.length;++l){let c=L_(o);s=z_(r[l],c,i)}return s}function JF(n,e=[],t=[],i=""){let a=(o,r,s)=>{let l={relativePath:s===void 0?o.path||"":s,caseSensitive:o.caseSensitive===!0,childrenIndex:r,route:o};l.relativePath.startsWith("/")&&(Io(l.relativePath.startsWith(i),`Absolute route path "${l.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),l.relativePath=l.relativePath.slice(i.length));let c=ou([i,l.relativePath]),u=t.concat(l);o.children&&o.children.length>0&&(Io(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${c}".`),JF(o.children,e,u,c)),!(o.path==null&&!o.index)&&e.push({path:c,score:T_(c,o.index),routesMeta:u})};return n.forEach((o,r)=>{var s;if(o.path===""||!((s=o.path)!=null&&s.includes("?")))a(o,r);else for(let l of jF(o.path))a(o,r,l)}),e}function jF(n){let e=n.split("/");if(e.length===0)return[];let[t,...i]=e,a=t.endsWith("?"),o=t.replace(/\?$/,"");if(i.length===0)return a?[o,""]:[o];let r=jF(i.join("/")),s=[];return s.push(...r.map(l=>l===""?o:[o,l].join("/"))),a&&s.push(...r),s.map(l=>n.startsWith("/")&&l===""?"/":l)}function W_(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:Y_(e.routesMeta.map(i=>i.childrenIndex),t.routesMeta.map(i=>i.childrenIndex)))}var V_=/^:[\w-]+$/,N_=3,E_=2,H_=1,F_=10,X_=-2,kW=n=>n==="*";function T_(n,e){let t=n.split("/"),i=t.length;return t.some(kW)&&(i+=X_),e&&(i+=E_),t.filter(a=>!kW(a)).reduce((a,o)=>a+(V_.test(o)?N_:o===""?H_:F_),i)}function Y_(n,e){return n.length===e.length&&n.slice(0,-1).every((i,a)=>i===e[a])?n[n.length-1]-e[e.length-1]:0}function z_(n,e,t=!1){let{routesMeta:i}=n,a={},o="/",r=[];for(let s=0;s<i.length;++s){let l=i[s],c=s===i.length-1,u=o==="/"?e:e.slice(o.length)||"/",C=_y({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u),h=l.route;if(!C&&c&&t&&!i[i.length-1].route.index&&(C=_y({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},u)),!C)return null;Object.assign(a,C.params),r.push({params:a,pathname:ou([o,C.pathname]),pathnameBase:U_(ou([o,C.pathnameBase])),route:h}),C.pathnameBase!=="/"&&(o=ou([o,C.pathnameBase]))}return r}function _y(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,i]=K_(n.path,n.caseSensitive,n.end),a=e.match(t);if(!a)return null;let o=a[0],r=o.replace(/(.)\/+$/,"$1"),s=a.slice(1);return{params:i.reduce((c,{paramName:u,isOptional:C},h)=>{if(u==="*"){let p=s[h]||"";r=o.slice(0,o.length-p.length).replace(/(.)\/+$/,"$1")}const m=s[h];return C&&!m?c[u]=void 0:c[u]=(m||"").replace(/%2F/g,"/"),c},{}),pathname:o,pathnameBase:r,pattern:n}}function K_(n,e=!1,t=!0){ug(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let i=[],a="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(r,s,l)=>(i.push({paramName:s,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(i.push({paramName:"*"}),a+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?a+="\\/*$":n!==""&&n!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),i]}function L_(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return ug(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function cu(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,i=n.charAt(t);return i&&i!=="/"?null:n.slice(t)||"/"}function __(n,e="/"){let{pathname:t,search:i="",hash:a=""}=typeof n=="string"?Jp(n):n;return{pathname:t?t.startsWith("/")?t:D_(t,e):e,search:k_(i),hash:P_(a)}}function D_(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(a=>{a===".."?t.length>1&&t.pop():a!=="."&&t.push(a)}),t.length>1?t.join("/"):"/"}function C2(n,e,t,i){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function O_(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function QF(n){let e=O_(n);return e.map((t,i)=>i===e.length-1?t.pathname:t.pathnameBase)}function qF(n,e,t,i=!1){let a;typeof n=="string"?a=Jp(n):(a={...n},Io(!a.pathname||!a.pathname.includes("?"),C2("?","pathname","search",a)),Io(!a.pathname||!a.pathname.includes("#"),C2("#","pathname","hash",a)),Io(!a.search||!a.search.includes("#"),C2("#","search","hash",a)));let o=n===""||a.pathname==="",r=o?"/":a.pathname,s;if(r==null)s=t;else{let C=e.length-1;if(!i&&r.startsWith("..")){let h=r.split("/");for(;h[0]==="..";)h.shift(),C-=1;a.pathname=h.join("/")}s=C>=0?e[C]:"/"}let l=__(a,s),c=r&&r!=="/"&&r.endsWith("/"),u=(o||r===".")&&t.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}var ou=n=>n.join("/").replace(/\/\/+/g,"/"),U_=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),k_=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,P_=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function J_(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}var $F=["POST","PUT","PATCH","DELETE"];new Set($F);var j_=["GET",...$F];new Set(j_);var Lf=v.createContext(null);Lf.displayName="DataRouter";var nG=v.createContext(null);nG.displayName="DataRouterState";var e5=v.createContext({isTransitioning:!1});e5.displayName="ViewTransition";var Q_=v.createContext(new Map);Q_.displayName="Fetchers";var q_=v.createContext(null);q_.displayName="Await";var mg=v.createContext(null);mg.displayName="Navigation";var iG=v.createContext(null);iG.displayName="Location";var Cu=v.createContext({outlet:null,matches:[],isDataRoute:!1});Cu.displayName="Route";var YZ=v.createContext(null);YZ.displayName="RouteError";function $_(n,{relative:e}={}){Io(jp(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:i}=v.useContext(mg),{hash:a,pathname:o,search:r}=Qp(n,{relative:e}),s=o;return t!=="/"&&(s=o==="/"?t:ou([t,o])),i.createHref({pathname:s,search:r,hash:a})}function jp(){return v.useContext(iG)!=null}function Gd(){return Io(jp(),"useLocation() may be used only in the context of a <Router> component."),v.useContext(iG).location}var t5="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function n5(n){v.useContext(mg).static||v.useLayoutEffect(n)}function eD(){let{isDataRoute:n}=v.useContext(Cu);return n?CD():tD()}function tD(){Io(jp(),"useNavigate() may be used only in the context of a <Router> component.");let n=v.useContext(Lf),{basename:e,navigator:t}=v.useContext(mg),{matches:i}=v.useContext(Cu),{pathname:a}=Gd(),o=JSON.stringify(QF(i)),r=v.useRef(!1);return n5(()=>{r.current=!0}),v.useCallback((l,c={})=>{if(ug(r.current,t5),!r.current)return;if(typeof l=="number"){t.go(l);return}let u=qF(l,JSON.parse(o),a,c.relative==="path");n==null&&e!=="/"&&(u.pathname=u.pathname==="/"?e:ou([e,u.pathname])),(c.replace?t.replace:t.push)(u,c.state,c)},[e,t,o,a,n])}v.createContext(null);function Qp(n,{relative:e}={}){let{matches:t}=v.useContext(Cu),{pathname:i}=Gd(),a=JSON.stringify(QF(t));return v.useMemo(()=>qF(n,JSON.parse(a),i,e==="path"),[n,a,i,e])}function nD(n,e,t,i){Io(jp(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a,static:o}=v.useContext(mg),{matches:r}=v.useContext(Cu),s=r[r.length-1],l=s?s.params:{},c=s?s.pathname:"/",u=s?s.pathnameBase:"/",C=s&&s.route;{let S=C&&C.path||"";i5(c,!C||S.endsWith("*")||S.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${c}" (under <Route path="${S}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${S}"> to <Route path="${S==="/"?"*":`${S}/*`}">.`)}let h=Gd(),m;m=h;let p=m.pathname||"/",B=p;if(u!=="/"){let S=u.replace(/^\//,"").split("/");B="/"+p.replace(/^\//,"").split("/").slice(S.length).join("/")}let b=!o&&t&&t.matches&&t.matches.length>0?t.matches:PF(n,{pathname:B});return ug(C||b!=null,`No routes matched location "${m.pathname}${m.search}${m.hash}" `),ug(b==null||b[b.length-1].route.element!==void 0||b[b.length-1].route.Component!==void 0||b[b.length-1].route.lazy!==void 0,`Matched leaf route at location "${m.pathname}${m.search}${m.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`),sD(b&&b.map(S=>Object.assign({},S,{params:Object.assign({},l,S.params),pathname:ou([u,a.encodeLocation?a.encodeLocation(S.pathname).pathname:S.pathname]),pathnameBase:S.pathnameBase==="/"?u:ou([u,a.encodeLocation?a.encodeLocation(S.pathnameBase).pathname:S.pathnameBase])})),r,t,i)}function iD(){let n=dD(),e=J_(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,i="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:i},o={padding:"2px 4px",backgroundColor:i},r=null;return console.error("Error handled by React Router default ErrorBoundary:",n),r=v.createElement(v.Fragment,null,v.createElement("p",null," Hey developer "),v.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",v.createElement("code",{style:o},"ErrorBoundary")," or"," ",v.createElement("code",{style:o},"errorElement")," prop on your route.")),v.createElement(v.Fragment,null,v.createElement("h2",null,"Unexpected Application Error!"),v.createElement("h3",{style:{fontStyle:"italic"}},e),t?v.createElement("pre",{style:a},t):null,r)}var aD=v.createElement(iD,null),oD=class extends v.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){console.error("React Router caught the following error during render",n,e)}render(){return this.state.error!==void 0?v.createElement(Cu.Provider,{value:this.props.routeContext},v.createElement(YZ.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function rD({routeContext:n,match:e,children:t}){let i=v.useContext(Lf);return i&&i.static&&i.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=e.route.id),v.createElement(Cu.Provider,{value:n},t)}function sD(n,e=[],t=null,i=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let a=n,o=t==null?void 0:t.errors;if(o!=null){let l=a.findIndex(c=>c.route.id&&(o==null?void 0:o[c.route.id])!==void 0);Io(l>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),a=a.slice(0,Math.min(a.length,l+1))}let r=!1,s=-1;if(t)for(let l=0;l<a.length;l++){let c=a[l];if((c.route.HydrateFallback||c.route.hydrateFallbackElement)&&(s=l),c.route.id){let{loaderData:u,errors:C}=t,h=c.route.loader&&!u.hasOwnProperty(c.route.id)&&(!C||C[c.route.id]===void 0);if(c.route.lazy||h){r=!0,s>=0?a=a.slice(0,s+1):a=[a[0]];break}}}return a.reduceRight((l,c,u)=>{let C,h=!1,m=null,p=null;t&&(C=o&&c.route.id?o[c.route.id]:void 0,m=c.route.errorElement||aD,r&&(s<0&&u===0?(i5("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),h=!0,p=null):s===u&&(h=!0,p=c.route.hydrateFallbackElement||null)));let B=e.concat(a.slice(0,u+1)),b=()=>{let y;return C?y=m:h?y=p:c.route.Component?y=v.createElement(c.route.Component,null):c.route.element?y=c.route.element:y=l,v.createElement(rD,{match:c,routeContext:{outlet:l,matches:B,isDataRoute:t!=null},children:y})};return t&&(c.route.ErrorBoundary||c.route.errorElement||u===0)?v.createElement(oD,{location:t.location,revalidation:t.revalidation,component:m,error:C,children:b(),routeContext:{outlet:null,matches:B,isDataRoute:!0}}):b()},null)}function zZ(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function lD(n){let e=v.useContext(Lf);return Io(e,zZ(n)),e}function cD(n){let e=v.useContext(nG);return Io(e,zZ(n)),e}function gD(n){let e=v.useContext(Cu);return Io(e,zZ(n)),e}function KZ(n){let e=gD(n),t=e.matches[e.matches.length-1];return Io(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function uD(){return KZ("useRouteId")}function dD(){var i;let n=v.useContext(YZ),e=cD("useRouteError"),t=KZ("useRouteError");return n!==void 0?n:(i=e.errors)==null?void 0:i[t]}function CD(){let{router:n}=lD("useNavigate"),e=KZ("useNavigate"),t=v.useRef(!1);return n5(()=>{t.current=!0}),v.useCallback(async(a,o={})=>{ug(t.current,t5),t.current&&(typeof a=="number"?n.navigate(a):await n.navigate(a,{fromRouteId:e,...o}))},[n,e])}var PW={};function i5(n,e,t){!e&&!PW[n]&&(PW[n]=!0,ug(!1,t))}v.memo(ID);function ID({routes:n,future:e,state:t}){return nD(n,void 0,t,e)}function hD({basename:n="/",children:e=null,location:t,navigationType:i="POP",navigator:a,static:o=!1}){Io(!jp(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let r=n.replace(/^\/*/,"/"),s=v.useMemo(()=>({basename:r,navigator:a,static:o,future:{}}),[r,a,o]);typeof t=="string"&&(t=Jp(t));let{pathname:l="/",search:c="",hash:u="",state:C=null,key:h="default"}=t,m=v.useMemo(()=>{let p=cu(l,r);return p==null?null:{location:{pathname:p,search:c,hash:u,state:C,key:h},navigationType:i}},[r,l,c,u,C,h,i]);return ug(m!=null,`<Router basename="${r}"> is not able to match the URL "${l}${c}${u}" because it does not start with the basename, so the <Router> won't render anything.`),m==null?null:v.createElement(mg.Provider,{value:s},v.createElement(iG.Provider,{children:e,value:m}))}var fy="get",Ay="application/x-www-form-urlencoded";function aG(n){return n!=null&&typeof n.tagName=="string"}function fD(n){return aG(n)&&n.tagName.toLowerCase()==="button"}function AD(n){return aG(n)&&n.tagName.toLowerCase()==="form"}function mD(n){return aG(n)&&n.tagName.toLowerCase()==="input"}function pD(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function bD(n,e){return n.button===0&&(!e||e==="_self")&&!pD(n)}var Q0=null;function vD(){if(Q0===null)try{new FormData(document.createElement("form"),0),Q0=!1}catch{Q0=!0}return Q0}var yD=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function I2(n){return n!=null&&!yD.has(n)?(ug(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Ay}"`),null):n}function BD(n,e){let t,i,a,o,r;if(AD(n)){let s=n.getAttribute("action");i=s?cu(s,e):null,t=n.getAttribute("method")||fy,a=I2(n.getAttribute("enctype"))||Ay,o=new FormData(n)}else if(fD(n)||mD(n)&&(n.type==="submit"||n.type==="image")){let s=n.form;if(s==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let l=n.getAttribute("formaction")||s.getAttribute("action");if(i=l?cu(l,e):null,t=n.getAttribute("formmethod")||s.getAttribute("method")||fy,a=I2(n.getAttribute("formenctype"))||I2(s.getAttribute("enctype"))||Ay,o=new FormData(s,n),!vD()){let{name:c,type:u,value:C}=n;if(u==="image"){let h=c?`${c}.`:"";o.append(`${h}x`,"0"),o.append(`${h}y`,"0")}else c&&o.append(c,C)}}else{if(aG(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=fy,i=null,a=Ay,r=n}return o&&a==="text/plain"&&(r=o,o=void 0),{action:i,method:t.toLowerCase(),encType:a,formData:o,body:r}}function LZ(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}async function GD(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function SD(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function wD(n,e,t){let i=await Promise.all(n.map(async a=>{let o=e.routes[a.route.id];if(o){let r=await GD(o,t);return r.links?r.links():[]}return[]}));return MD(i.flat(1).filter(SD).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function JW(n,e,t,i,a,o){let r=(l,c)=>t[c]?l.route.id!==t[c].route.id:!0,s=(l,c)=>{var u;return t[c].pathname!==l.pathname||((u=t[c].route.path)==null?void 0:u.endsWith("*"))&&t[c].params["*"]!==l.params["*"]};return o==="assets"?e.filter((l,c)=>r(l,c)||s(l,c)):o==="data"?e.filter((l,c)=>{var C;let u=i.routes[l.route.id];if(!u||!u.hasLoader)return!1;if(r(l,c)||s(l,c))return!0;if(l.route.shouldRevalidate){let h=l.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:((C=t[0])==null?void 0:C.params)||{},nextUrl:new URL(n,window.origin),nextParams:l.params,defaultShouldRevalidate:!0});if(typeof h=="boolean")return h}return!0}):[]}function RD(n,e,{includeHydrateFallback:t}={}){return ZD(n.map(i=>{let a=e.routes[i.route.id];if(!a)return[];let o=[a.module];return a.clientActionModule&&(o=o.concat(a.clientActionModule)),a.clientLoaderModule&&(o=o.concat(a.clientLoaderModule)),t&&a.hydrateFallbackModule&&(o=o.concat(a.hydrateFallbackModule)),a.imports&&(o=o.concat(a.imports)),o}).flat(1))}function ZD(n){return[...new Set(n)]}function xD(n){let e={},t=Object.keys(n).sort();for(let i of t)e[i]=n[i];return e}function MD(n,e){let t=new Set;return new Set(e),n.reduce((i,a)=>{let o=JSON.stringify(xD(a));return t.has(o)||(t.add(o),i.push({key:o,link:a})),i},[])}function WD(n,e){let t=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return t.pathname==="/"?t.pathname="_root.data":e&&cu(t.pathname,e)==="/"?t.pathname=`${e.replace(/\/$/,"")}/_root.data`:t.pathname=`${t.pathname.replace(/\/$/,"")}.data`,t}function a5(){let n=v.useContext(Lf);return LZ(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function VD(){let n=v.useContext(nG);return LZ(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var _Z=v.createContext(void 0);_Z.displayName="FrameworkContext";function o5(){let n=v.useContext(_Z);return LZ(n,"You must render this element inside a <HydratedRouter> element"),n}function ND(n,e){let t=v.useContext(_Z),[i,a]=v.useState(!1),[o,r]=v.useState(!1),{onFocus:s,onBlur:l,onMouseEnter:c,onMouseLeave:u,onTouchStart:C}=e,h=v.useRef(null);v.useEffect(()=>{if(n==="render"&&r(!0),n==="viewport"){let B=y=>{y.forEach(S=>{r(S.isIntersecting)})},b=new IntersectionObserver(B,{threshold:.5});return h.current&&b.observe(h.current),()=>{b.disconnect()}}},[n]),v.useEffect(()=>{if(i){let B=setTimeout(()=>{r(!0)},100);return()=>{clearTimeout(B)}}},[i]);let m=()=>{a(!0)},p=()=>{a(!1),r(!1)};return t?n!=="intent"?[o,h,{}]:[o,h,{onFocus:Am(s,m),onBlur:Am(l,p),onMouseEnter:Am(c,m),onMouseLeave:Am(u,p),onTouchStart:Am(C,m)}]:[!1,h,{}]}function Am(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function ED({page:n,...e}){let{router:t}=a5(),i=v.useMemo(()=>PF(t.routes,n,t.basename),[t.routes,n,t.basename]);return i?v.createElement(FD,{page:n,matches:i,...e}):null}function HD(n){let{manifest:e,routeModules:t}=o5(),[i,a]=v.useState([]);return v.useEffect(()=>{let o=!1;return wD(n,e,t).then(r=>{o||a(r)}),()=>{o=!0}},[n,e,t]),i}function FD({page:n,matches:e,...t}){let i=Gd(),{manifest:a,routeModules:o}=o5(),{basename:r}=a5(),{loaderData:s,matches:l}=VD(),c=v.useMemo(()=>JW(n,e,l,a,i,"data"),[n,e,l,a,i]),u=v.useMemo(()=>JW(n,e,l,a,i,"assets"),[n,e,l,a,i]),C=v.useMemo(()=>{if(n===i.pathname+i.search+i.hash)return[];let p=new Set,B=!1;if(e.forEach(y=>{var R;let S=a.routes[y.route.id];!S||!S.hasLoader||(!c.some(Z=>Z.route.id===y.route.id)&&y.route.id in s&&((R=o[y.route.id])!=null&&R.shouldRevalidate)||S.hasClientLoader?B=!0:p.add(y.route.id))}),p.size===0)return[];let b=WD(n,r);return B&&p.size>0&&b.searchParams.set("_routes",e.filter(y=>p.has(y.route.id)).map(y=>y.route.id).join(",")),[b.pathname+b.search]},[r,s,i,a,c,e,n,o]),h=v.useMemo(()=>RD(u,a),[u,a]),m=HD(u);return v.createElement(v.Fragment,null,C.map(p=>v.createElement("link",{key:p,rel:"prefetch",as:"fetch",href:p,...t})),h.map(p=>v.createElement("link",{key:p,rel:"modulepreload",href:p,...t})),m.map(({key:p,link:B})=>v.createElement("link",{key:p,...B})))}function XD(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var r5=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{r5&&(window.__reactRouterVersion="7.5.0")}catch{}function TD({basename:n,children:e,window:t}){let i=v.useRef();i.current==null&&(i.current=R_({window:t,v5Compat:!0}));let a=i.current,[o,r]=v.useState({action:a.action,location:a.location}),s=v.useCallback(l=>{v.startTransition(()=>r(l))},[r]);return v.useLayoutEffect(()=>a.listen(s),[a,s]),v.createElement(hD,{basename:n,children:e,location:o.location,navigationType:o.action,navigator:a})}var s5=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,tf=v.forwardRef(function({onClick:e,discover:t="render",prefetch:i="none",relative:a,reloadDocument:o,replace:r,state:s,target:l,to:c,preventScrollReset:u,viewTransition:C,...h},m){let{basename:p}=v.useContext(mg),B=typeof c=="string"&&s5.test(c),b,y=!1;if(typeof c=="string"&&B&&(b=c,r5))try{let N=new URL(window.location.href),H=c.startsWith("//")?new URL(N.protocol+c):new URL(c),z=cu(H.pathname,p);H.origin===N.origin&&z!=null?c=z+H.search+H.hash:y=!0}catch{ug(!1,`<Link to="${c}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let S=$_(c,{relative:a}),[R,Z,x]=ND(i,h),M=LD(c,{replace:r,state:s,target:l,preventScrollReset:u,relative:a,viewTransition:C});function E(N){e&&e(N),N.defaultPrevented||M(N)}let F=v.createElement("a",{...h,...x,href:b||S,onClick:y||o?e:E,ref:XD(m,Z),target:l,"data-discover":!B&&t==="render"?"true":void 0});return R&&!B?v.createElement(v.Fragment,null,F,v.createElement(ED,{page:S})):F});tf.displayName="Link";var YD=v.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:i="",end:a=!1,style:o,to:r,viewTransition:s,children:l,...c},u){let C=Qp(r,{relative:c.relative}),h=Gd(),m=v.useContext(nG),{navigator:p,basename:B}=v.useContext(mg),b=m!=null&&kD(C)&&s===!0,y=p.encodeLocation?p.encodeLocation(C).pathname:C.pathname,S=h.pathname,R=m&&m.navigation&&m.navigation.location?m.navigation.location.pathname:null;t||(S=S.toLowerCase(),R=R?R.toLowerCase():null,y=y.toLowerCase()),R&&B&&(R=cu(R,B)||R);const Z=y!=="/"&&y.endsWith("/")?y.length-1:y.length;let x=S===y||!a&&S.startsWith(y)&&S.charAt(Z)==="/",M=R!=null&&(R===y||!a&&R.startsWith(y)&&R.charAt(y.length)==="/"),E={isActive:x,isPending:M,isTransitioning:b},F=x?e:void 0,N;typeof i=="function"?N=i(E):N=[i,x?"active":null,M?"pending":null,b?"transitioning":null].filter(Boolean).join(" ");let H=typeof o=="function"?o(E):o;return v.createElement(tf,{...c,"aria-current":F,className:N,ref:u,style:H,to:r,viewTransition:s},typeof l=="function"?l(E):l)});YD.displayName="NavLink";var zD=v.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:i,replace:a,state:o,method:r=fy,action:s,onSubmit:l,relative:c,preventScrollReset:u,viewTransition:C,...h},m)=>{let p=OD(),B=UD(s,{relative:c}),b=r.toLowerCase()==="get"?"get":"post",y=typeof s=="string"&&s5.test(s),S=R=>{if(l&&l(R),R.defaultPrevented)return;R.preventDefault();let Z=R.nativeEvent.submitter,x=(Z==null?void 0:Z.getAttribute("formmethod"))||r;p(Z||R.currentTarget,{fetcherKey:e,method:x,navigate:t,replace:a,state:o,relative:c,preventScrollReset:u,viewTransition:C})};return v.createElement("form",{ref:m,method:b,action:B,onSubmit:i?l:S,...h,"data-discover":!y&&n==="render"?"true":void 0})});zD.displayName="Form";function KD(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function l5(n){let e=v.useContext(Lf);return Io(e,KD(n)),e}function LD(n,{target:e,replace:t,state:i,preventScrollReset:a,relative:o,viewTransition:r}={}){let s=eD(),l=Gd(),c=Qp(n,{relative:o});return v.useCallback(u=>{if(bD(u,e)){u.preventDefault();let C=t!==void 0?t:vp(l)===vp(c);s(n,{replace:C,state:i,preventScrollReset:a,relative:o,viewTransition:r})}},[l,s,c,t,i,e,n,a,o,r])}var _D=0,DD=()=>`__${String(++_D)}__`;function OD(){let{router:n}=l5("useSubmit"),{basename:e}=v.useContext(mg),t=uD();return v.useCallback(async(i,a={})=>{let{action:o,method:r,encType:s,formData:l,body:c}=BD(i,e);if(a.navigate===!1){let u=a.fetcherKey||DD();await n.fetch(u,t,a.action||o,{preventScrollReset:a.preventScrollReset,formData:l,body:c,formMethod:a.method||r,formEncType:a.encType||s,flushSync:a.flushSync})}else await n.navigate(a.action||o,{preventScrollReset:a.preventScrollReset,formData:l,body:c,formMethod:a.method||r,formEncType:a.encType||s,replace:a.replace,state:a.state,fromRouteId:t,flushSync:a.flushSync,viewTransition:a.viewTransition})},[n,e,t])}function UD(n,{relative:e}={}){let{basename:t}=v.useContext(mg),i=v.useContext(Cu);Io(i,"useFormAction must be used inside a RouteContext");let[a]=i.matches.slice(-1),o={...Qp(n||".",{relative:e})},r=Gd();if(n==null){o.search=r.search;let s=new URLSearchParams(o.search),l=s.getAll("index");if(l.some(u=>u==="")){s.delete("index"),l.filter(C=>C).forEach(C=>s.append("index",C));let u=s.toString();o.search=u?`?${u}`:""}}return(!n||n===".")&&a.route.index&&(o.search=o.search?o.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(o.pathname=o.pathname==="/"?t:ou([t,o.pathname])),vp(o)}function kD(n,e={}){let t=v.useContext(e5);Io(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=l5("useViewTransitionState"),a=Qp(n,{relative:e.relative});if(!t.isTransitioning)return!1;let o=cu(t.currentLocation.pathname,i)||t.currentLocation.pathname,r=cu(t.nextLocation.pathname,i)||t.nextLocation.pathname;return _y(a.pathname,r)!=null||_y(a.pathname,o)!=null}new TextEncoder;var md=UF();const W1=mI(md),PD=OF({__proto__:null,default:W1},[md]);function c5(){return Le.jsxs("header",{className:"header",children:[Le.jsx("div",{className:"logo",children:""}),Le.jsx("nav",{className:"main-nav",children:Le.jsxs("ul",{className:"horizontal-menu",children:[Le.jsx("li",{children:Le.jsx(tf,{to:"/react_panel_dynamic/",children:""})}),Le.jsx("li",{children:Le.jsx(tf,{to:"/react_panel_dynamic/about",children:""})}),Le.jsx("li",{children:Le.jsx(tf,{to:"/react_panel_dynamic/service",children:""})}),Le.jsx("li",{children:Le.jsx(tf,{to:"/react_panel_dynamic/etc",children:"etc"})})]})})]})}const JD=Object.freeze(Object.defineProperty({__proto__:null,default:c5},Symbol.toStringTag,{value:"Module"}));function g5(){return Le.jsx("footer",{className:"footer",children:Le.jsx("div",{className:"footer-content",children:Le.jsx("p",{children:" 2024 . All rights reserved."})})})}const jD=Object.freeze(Object.defineProperty({__proto__:null,default:g5},Symbol.toStringTag,{value:"Module"}));function u5(n,e){return function(){return n.apply(e,arguments)}}const{toString:QD}=Object.prototype,{getPrototypeOf:DZ}=Object,oG=(n=>e=>{const t=QD.call(e);return n[t]||(n[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),fc=n=>(n=n.toLowerCase(),e=>oG(e)===n),rG=n=>e=>typeof e===n,{isArray:_f}=Array,yp=rG("undefined");function qD(n){return n!==null&&!yp(n)&&n.constructor!==null&&!yp(n.constructor)&&Ds(n.constructor.isBuffer)&&n.constructor.isBuffer(n)}const d5=fc("ArrayBuffer");function $D(n){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(n):e=n&&n.buffer&&d5(n.buffer),e}const eO=rG("string"),Ds=rG("function"),C5=rG("number"),sG=n=>n!==null&&typeof n=="object",tO=n=>n===!0||n===!1,my=n=>{if(oG(n)!=="object")return!1;const e=DZ(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)},nO=fc("Date"),iO=fc("File"),aO=fc("Blob"),oO=fc("FileList"),rO=n=>sG(n)&&Ds(n.pipe),sO=n=>{let e;return n&&(typeof FormData=="function"&&n instanceof FormData||Ds(n.append)&&((e=oG(n))==="formdata"||e==="object"&&Ds(n.toString)&&n.toString()==="[object FormData]"))},lO=fc("URLSearchParams"),[cO,gO,uO,dO]=["ReadableStream","Request","Response","Headers"].map(fc),CO=n=>n.trim?n.trim():n.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function qp(n,e,{allOwnKeys:t=!1}={}){if(n===null||typeof n>"u")return;let i,a;if(typeof n!="object"&&(n=[n]),_f(n))for(i=0,a=n.length;i<a;i++)e.call(null,n[i],i,n);else{const o=t?Object.getOwnPropertyNames(n):Object.keys(n),r=o.length;let s;for(i=0;i<r;i++)s=o[i],e.call(null,n[s],s,n)}}function I5(n,e){e=e.toLowerCase();const t=Object.keys(n);let i=t.length,a;for(;i-- >0;)if(a=t[i],e===a.toLowerCase())return a;return null}const DC=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,h5=n=>!yp(n)&&n!==DC;function V1(){const{caseless:n}=h5(this)&&this||{},e={},t=(i,a)=>{const o=n&&I5(e,a)||a;my(e[o])&&my(i)?e[o]=V1(e[o],i):my(i)?e[o]=V1({},i):_f(i)?e[o]=i.slice():e[o]=i};for(let i=0,a=arguments.length;i<a;i++)arguments[i]&&qp(arguments[i],t);return e}const IO=(n,e,t,{allOwnKeys:i}={})=>(qp(e,(a,o)=>{t&&Ds(a)?n[o]=u5(a,t):n[o]=a},{allOwnKeys:i}),n),hO=n=>(n.charCodeAt(0)===65279&&(n=n.slice(1)),n),fO=(n,e,t,i)=>{n.prototype=Object.create(e.prototype,i),n.prototype.constructor=n,Object.defineProperty(n,"super",{value:e.prototype}),t&&Object.assign(n.prototype,t)},AO=(n,e,t,i)=>{let a,o,r;const s={};if(e=e||{},n==null)return e;do{for(a=Object.getOwnPropertyNames(n),o=a.length;o-- >0;)r=a[o],(!i||i(r,n,e))&&!s[r]&&(e[r]=n[r],s[r]=!0);n=t!==!1&&DZ(n)}while(n&&(!t||t(n,e))&&n!==Object.prototype);return e},mO=(n,e,t)=>{n=String(n),(t===void 0||t>n.length)&&(t=n.length),t-=e.length;const i=n.indexOf(e,t);return i!==-1&&i===t},pO=n=>{if(!n)return null;if(_f(n))return n;let e=n.length;if(!C5(e))return null;const t=new Array(e);for(;e-- >0;)t[e]=n[e];return t},bO=(n=>e=>n&&e instanceof n)(typeof Uint8Array<"u"&&DZ(Uint8Array)),vO=(n,e)=>{const i=(n&&n[Symbol.iterator]).call(n);let a;for(;(a=i.next())&&!a.done;){const o=a.value;e.call(n,o[0],o[1])}},yO=(n,e)=>{let t;const i=[];for(;(t=n.exec(e))!==null;)i.push(t);return i},BO=fc("HTMLFormElement"),GO=n=>n.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,i,a){return i.toUpperCase()+a}),jW=(({hasOwnProperty:n})=>(e,t)=>n.call(e,t))(Object.prototype),SO=fc("RegExp"),f5=(n,e)=>{const t=Object.getOwnPropertyDescriptors(n),i={};qp(t,(a,o)=>{let r;(r=e(a,o,n))!==!1&&(i[o]=r||a)}),Object.defineProperties(n,i)},wO=n=>{f5(n,(e,t)=>{if(Ds(n)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const i=n[t];if(Ds(i)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},RO=(n,e)=>{const t={},i=a=>{a.forEach(o=>{t[o]=!0})};return _f(n)?i(n):i(String(n).split(e)),t},ZO=()=>{},xO=(n,e)=>n!=null&&Number.isFinite(n=+n)?n:e;function MO(n){return!!(n&&Ds(n.append)&&n[Symbol.toStringTag]==="FormData"&&n[Symbol.iterator])}const WO=n=>{const e=new Array(10),t=(i,a)=>{if(sG(i)){if(e.indexOf(i)>=0)return;if(!("toJSON"in i)){e[a]=i;const o=_f(i)?[]:{};return qp(i,(r,s)=>{const l=t(r,a+1);!yp(l)&&(o[s]=l)}),e[a]=void 0,o}}return i};return t(n,0)},VO=fc("AsyncFunction"),NO=n=>n&&(sG(n)||Ds(n))&&Ds(n.then)&&Ds(n.catch),A5=((n,e)=>n?setImmediate:e?((t,i)=>(DC.addEventListener("message",({source:a,data:o})=>{a===DC&&o===t&&i.length&&i.shift()()},!1),a=>{i.push(a),DC.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",Ds(DC.postMessage)),EO=typeof queueMicrotask<"u"?queueMicrotask.bind(DC):typeof process<"u"&&process.nextTick||A5,Vt={isArray:_f,isArrayBuffer:d5,isBuffer:qD,isFormData:sO,isArrayBufferView:$D,isString:eO,isNumber:C5,isBoolean:tO,isObject:sG,isPlainObject:my,isReadableStream:cO,isRequest:gO,isResponse:uO,isHeaders:dO,isUndefined:yp,isDate:nO,isFile:iO,isBlob:aO,isRegExp:SO,isFunction:Ds,isStream:rO,isURLSearchParams:lO,isTypedArray:bO,isFileList:oO,forEach:qp,merge:V1,extend:IO,trim:CO,stripBOM:hO,inherits:fO,toFlatObject:AO,kindOf:oG,kindOfTest:fc,endsWith:mO,toArray:pO,forEachEntry:vO,matchAll:yO,isHTMLForm:BO,hasOwnProperty:jW,hasOwnProp:jW,reduceDescriptors:f5,freezeMethods:wO,toObjectSet:RO,toCamelCase:GO,noop:ZO,toFiniteNumber:xO,findKey:I5,global:DC,isContextDefined:h5,isSpecCompliantForm:MO,toJSONObject:WO,isAsyncFn:VO,isThenable:NO,setImmediate:A5,asap:EO};function ii(n,e,t,i,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=n,this.name="AxiosError",e&&(this.code=e),t&&(this.config=t),i&&(this.request=i),a&&(this.response=a,this.status=a.status?a.status:null)}Vt.inherits(ii,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Vt.toJSONObject(this.config),code:this.code,status:this.status}}});const m5=ii.prototype,p5={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(n=>{p5[n]={value:n}});Object.defineProperties(ii,p5);Object.defineProperty(m5,"isAxiosError",{value:!0});ii.from=(n,e,t,i,a,o)=>{const r=Object.create(m5);return Vt.toFlatObject(n,r,function(l){return l!==Error.prototype},s=>s!=="isAxiosError"),ii.call(r,n.message,e,t,i,a),r.cause=n,r.name=n.name,o&&Object.assign(r,o),r};const HO=null;function N1(n){return Vt.isPlainObject(n)||Vt.isArray(n)}function b5(n){return Vt.endsWith(n,"[]")?n.slice(0,-2):n}function QW(n,e,t){return n?n.concat(e).map(function(a,o){return a=b5(a),!t&&o?"["+a+"]":a}).join(t?".":""):e}function FO(n){return Vt.isArray(n)&&!n.some(N1)}const XO=Vt.toFlatObject(Vt,{},null,function(e){return/^is[A-Z]/.test(e)});function lG(n,e,t){if(!Vt.isObject(n))throw new TypeError("target must be an object");e=e||new FormData,t=Vt.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(B,b){return!Vt.isUndefined(b[B])});const i=t.metaTokens,a=t.visitor||u,o=t.dots,r=t.indexes,l=(t.Blob||typeof Blob<"u"&&Blob)&&Vt.isSpecCompliantForm(e);if(!Vt.isFunction(a))throw new TypeError("visitor must be a function");function c(p){if(p===null)return"";if(Vt.isDate(p))return p.toISOString();if(!l&&Vt.isBlob(p))throw new ii("Blob is not supported. Use a Buffer instead.");return Vt.isArrayBuffer(p)||Vt.isTypedArray(p)?l&&typeof Blob=="function"?new Blob([p]):Buffer.from(p):p}function u(p,B,b){let y=p;if(p&&!b&&typeof p=="object"){if(Vt.endsWith(B,"{}"))B=i?B:B.slice(0,-2),p=JSON.stringify(p);else if(Vt.isArray(p)&&FO(p)||(Vt.isFileList(p)||Vt.endsWith(B,"[]"))&&(y=Vt.toArray(p)))return B=b5(B),y.forEach(function(R,Z){!(Vt.isUndefined(R)||R===null)&&e.append(r===!0?QW([B],Z,o):r===null?B:B+"[]",c(R))}),!1}return N1(p)?!0:(e.append(QW(b,B,o),c(p)),!1)}const C=[],h=Object.assign(XO,{defaultVisitor:u,convertValue:c,isVisitable:N1});function m(p,B){if(!Vt.isUndefined(p)){if(C.indexOf(p)!==-1)throw Error("Circular reference detected in "+B.join("."));C.push(p),Vt.forEach(p,function(y,S){(!(Vt.isUndefined(y)||y===null)&&a.call(e,y,Vt.isString(S)?S.trim():S,B,h))===!0&&m(y,B?B.concat(S):[S])}),C.pop()}}if(!Vt.isObject(n))throw new TypeError("data must be an object");return m(n),e}function qW(n){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(n).replace(/[!'()~]|%20|%00/g,function(i){return e[i]})}function OZ(n,e){this._pairs=[],n&&lG(n,this,e)}const v5=OZ.prototype;v5.append=function(e,t){this._pairs.push([e,t])};v5.toString=function(e){const t=e?function(i){return e.call(this,i,qW)}:qW;return this._pairs.map(function(a){return t(a[0])+"="+t(a[1])},"").join("&")};function TO(n){return encodeURIComponent(n).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function y5(n,e,t){if(!e)return n;const i=t&&t.encode||TO;Vt.isFunction(t)&&(t={serialize:t});const a=t&&t.serialize;let o;if(a?o=a(e,t):o=Vt.isURLSearchParams(e)?e.toString():new OZ(e,t).toString(i),o){const r=n.indexOf("#");r!==-1&&(n=n.slice(0,r)),n+=(n.indexOf("?")===-1?"?":"&")+o}return n}class $W{constructor(){this.handlers=[]}use(e,t,i){return this.handlers.push({fulfilled:e,rejected:t,synchronous:i?i.synchronous:!1,runWhen:i?i.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){Vt.forEach(this.handlers,function(i){i!==null&&e(i)})}}const B5={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},YO=typeof URLSearchParams<"u"?URLSearchParams:OZ,zO=typeof FormData<"u"?FormData:null,KO=typeof Blob<"u"?Blob:null,LO={isBrowser:!0,classes:{URLSearchParams:YO,FormData:zO,Blob:KO},protocols:["http","https","file","blob","url","data"]},UZ=typeof window<"u"&&typeof document<"u",E1=typeof navigator=="object"&&navigator||void 0,_O=UZ&&(!E1||["ReactNative","NativeScript","NS"].indexOf(E1.product)<0),DO=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",OO=UZ&&window.location.href||"http://localhost",UO=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:UZ,hasStandardBrowserEnv:_O,hasStandardBrowserWebWorkerEnv:DO,navigator:E1,origin:OO},Symbol.toStringTag,{value:"Module"})),hr={...UO,...LO};function kO(n,e){return lG(n,new hr.classes.URLSearchParams,Object.assign({visitor:function(t,i,a,o){return hr.isNode&&Vt.isBuffer(t)?(this.append(i,t.toString("base64")),!1):o.defaultVisitor.apply(this,arguments)}},e))}function PO(n){return Vt.matchAll(/\w+|\[(\w*)]/g,n).map(e=>e[0]==="[]"?"":e[1]||e[0])}function JO(n){const e={},t=Object.keys(n);let i;const a=t.length;let o;for(i=0;i<a;i++)o=t[i],e[o]=n[o];return e}function G5(n){function e(t,i,a,o){let r=t[o++];if(r==="__proto__")return!0;const s=Number.isFinite(+r),l=o>=t.length;return r=!r&&Vt.isArray(a)?a.length:r,l?(Vt.hasOwnProp(a,r)?a[r]=[a[r],i]:a[r]=i,!s):((!a[r]||!Vt.isObject(a[r]))&&(a[r]=[]),e(t,i,a[r],o)&&Vt.isArray(a[r])&&(a[r]=JO(a[r])),!s)}if(Vt.isFormData(n)&&Vt.isFunction(n.entries)){const t={};return Vt.forEachEntry(n,(i,a)=>{e(PO(i),a,t,0)}),t}return null}function jO(n,e,t){if(Vt.isString(n))try{return(e||JSON.parse)(n),Vt.trim(n)}catch(i){if(i.name!=="SyntaxError")throw i}return(t||JSON.stringify)(n)}const $p={transitional:B5,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const i=t.getContentType()||"",a=i.indexOf("application/json")>-1,o=Vt.isObject(e);if(o&&Vt.isHTMLForm(e)&&(e=new FormData(e)),Vt.isFormData(e))return a?JSON.stringify(G5(e)):e;if(Vt.isArrayBuffer(e)||Vt.isBuffer(e)||Vt.isStream(e)||Vt.isFile(e)||Vt.isBlob(e)||Vt.isReadableStream(e))return e;if(Vt.isArrayBufferView(e))return e.buffer;if(Vt.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let s;if(o){if(i.indexOf("application/x-www-form-urlencoded")>-1)return kO(e,this.formSerializer).toString();if((s=Vt.isFileList(e))||i.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return lG(s?{"files[]":e}:e,l&&new l,this.formSerializer)}}return o||a?(t.setContentType("application/json",!1),jO(e)):e}],transformResponse:[function(e){const t=this.transitional||$p.transitional,i=t&&t.forcedJSONParsing,a=this.responseType==="json";if(Vt.isResponse(e)||Vt.isReadableStream(e))return e;if(e&&Vt.isString(e)&&(i&&!this.responseType||a)){const r=!(t&&t.silentJSONParsing)&&a;try{return JSON.parse(e)}catch(s){if(r)throw s.name==="SyntaxError"?ii.from(s,ii.ERR_BAD_RESPONSE,this,null,this.response):s}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:hr.classes.FormData,Blob:hr.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Vt.forEach(["delete","get","head","post","put","patch"],n=>{$p.headers[n]={}});const QO=Vt.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),qO=n=>{const e={};let t,i,a;return n&&n.split(`
`).forEach(function(r){a=r.indexOf(":"),t=r.substring(0,a).trim().toLowerCase(),i=r.substring(a+1).trim(),!(!t||e[t]&&QO[t])&&(t==="set-cookie"?e[t]?e[t].push(i):e[t]=[i]:e[t]=e[t]?e[t]+", "+i:i)}),e},eV=Symbol("internals");function mm(n){return n&&String(n).trim().toLowerCase()}function py(n){return n===!1||n==null?n:Vt.isArray(n)?n.map(py):String(n)}function $O(n){const e=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let i;for(;i=t.exec(n);)e[i[1]]=i[2];return e}const eU=n=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(n.trim());function h2(n,e,t,i,a){if(Vt.isFunction(i))return i.call(this,e,t);if(a&&(e=t),!!Vt.isString(e)){if(Vt.isString(i))return e.indexOf(i)!==-1;if(Vt.isRegExp(i))return i.test(e)}}function tU(n){return n.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,i)=>t.toUpperCase()+i)}function nU(n,e){const t=Vt.toCamelCase(" "+e);["get","set","has"].forEach(i=>{Object.defineProperty(n,i+t,{value:function(a,o,r){return this[i].call(this,e,a,o,r)},configurable:!0})})}let bs=class{constructor(e){e&&this.set(e)}set(e,t,i){const a=this;function o(s,l,c){const u=mm(l);if(!u)throw new Error("header name must be a non-empty string");const C=Vt.findKey(a,u);(!C||a[C]===void 0||c===!0||c===void 0&&a[C]!==!1)&&(a[C||l]=py(s))}const r=(s,l)=>Vt.forEach(s,(c,u)=>o(c,u,l));if(Vt.isPlainObject(e)||e instanceof this.constructor)r(e,t);else if(Vt.isString(e)&&(e=e.trim())&&!eU(e))r(qO(e),t);else if(Vt.isHeaders(e))for(const[s,l]of e.entries())o(l,s,i);else e!=null&&o(t,e,i);return this}get(e,t){if(e=mm(e),e){const i=Vt.findKey(this,e);if(i){const a=this[i];if(!t)return a;if(t===!0)return $O(a);if(Vt.isFunction(t))return t.call(this,a,i);if(Vt.isRegExp(t))return t.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=mm(e),e){const i=Vt.findKey(this,e);return!!(i&&this[i]!==void 0&&(!t||h2(this,this[i],i,t)))}return!1}delete(e,t){const i=this;let a=!1;function o(r){if(r=mm(r),r){const s=Vt.findKey(i,r);s&&(!t||h2(i,i[s],s,t))&&(delete i[s],a=!0)}}return Vt.isArray(e)?e.forEach(o):o(e),a}clear(e){const t=Object.keys(this);let i=t.length,a=!1;for(;i--;){const o=t[i];(!e||h2(this,this[o],o,e,!0))&&(delete this[o],a=!0)}return a}normalize(e){const t=this,i={};return Vt.forEach(this,(a,o)=>{const r=Vt.findKey(i,o);if(r){t[r]=py(a),delete t[o];return}const s=e?tU(o):String(o).trim();s!==o&&delete t[o],t[s]=py(a),i[s]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return Vt.forEach(this,(i,a)=>{i!=null&&i!==!1&&(t[a]=e&&Vt.isArray(i)?i.join(", "):i)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const i=new this(e);return t.forEach(a=>i.set(a)),i}static accessor(e){const i=(this[eV]=this[eV]={accessors:{}}).accessors,a=this.prototype;function o(r){const s=mm(r);i[s]||(nU(a,r),i[s]=!0)}return Vt.isArray(e)?e.forEach(o):o(e),this}};bs.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Vt.reduceDescriptors(bs.prototype,({value:n},e)=>{let t=e[0].toUpperCase()+e.slice(1);return{get:()=>n,set(i){this[t]=i}}});Vt.freezeMethods(bs);function f2(n,e){const t=this||$p,i=e||t,a=bs.from(i.headers);let o=i.data;return Vt.forEach(n,function(s){o=s.call(t,o,a.normalize(),e?e.status:void 0)}),a.normalize(),o}function S5(n){return!!(n&&n.__CANCEL__)}function Df(n,e,t){ii.call(this,n??"canceled",ii.ERR_CANCELED,e,t),this.name="CanceledError"}Vt.inherits(Df,ii,{__CANCEL__:!0});function w5(n,e,t){const i=t.config.validateStatus;!t.status||!i||i(t.status)?n(t):e(new ii("Request failed with status code "+t.status,[ii.ERR_BAD_REQUEST,ii.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function iU(n){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(n);return e&&e[1]||""}function aU(n,e){n=n||10;const t=new Array(n),i=new Array(n);let a=0,o=0,r;return e=e!==void 0?e:1e3,function(l){const c=Date.now(),u=i[o];r||(r=c),t[a]=l,i[a]=c;let C=o,h=0;for(;C!==a;)h+=t[C++],C=C%n;if(a=(a+1)%n,a===o&&(o=(o+1)%n),c-r<e)return;const m=u&&c-u;return m?Math.round(h*1e3/m):void 0}}function oU(n,e){let t=0,i=1e3/e,a,o;const r=(c,u=Date.now())=>{t=u,a=null,o&&(clearTimeout(o),o=null),n.apply(null,c)};return[(...c)=>{const u=Date.now(),C=u-t;C>=i?r(c,u):(a=c,o||(o=setTimeout(()=>{o=null,r(a)},i-C)))},()=>a&&r(a)]}const Dy=(n,e,t=3)=>{let i=0;const a=aU(50,250);return oU(o=>{const r=o.loaded,s=o.lengthComputable?o.total:void 0,l=r-i,c=a(l),u=r<=s;i=r;const C={loaded:r,total:s,progress:s?r/s:void 0,bytes:l,rate:c||void 0,estimated:c&&s&&u?(s-r)/c:void 0,event:o,lengthComputable:s!=null,[e?"download":"upload"]:!0};n(C)},t)},tV=(n,e)=>{const t=n!=null;return[i=>e[0]({lengthComputable:t,total:n,loaded:i}),e[1]]},nV=n=>(...e)=>Vt.asap(()=>n(...e)),rU=hr.hasStandardBrowserEnv?((n,e)=>t=>(t=new URL(t,hr.origin),n.protocol===t.protocol&&n.host===t.host&&(e||n.port===t.port)))(new URL(hr.origin),hr.navigator&&/(msie|trident)/i.test(hr.navigator.userAgent)):()=>!0,sU=hr.hasStandardBrowserEnv?{write(n,e,t,i,a,o){const r=[n+"="+encodeURIComponent(e)];Vt.isNumber(t)&&r.push("expires="+new Date(t).toGMTString()),Vt.isString(i)&&r.push("path="+i),Vt.isString(a)&&r.push("domain="+a),o===!0&&r.push("secure"),document.cookie=r.join("; ")},read(n){const e=document.cookie.match(new RegExp("(^|;\\s*)("+n+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(n){this.write(n,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function lU(n){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(n)}function cU(n,e){return e?n.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):n}function R5(n,e,t){let i=!lU(e);return n&&(i||t==!1)?cU(n,e):e}const iV=n=>n instanceof bs?{...n}:n;function rI(n,e){e=e||{};const t={};function i(c,u,C,h){return Vt.isPlainObject(c)&&Vt.isPlainObject(u)?Vt.merge.call({caseless:h},c,u):Vt.isPlainObject(u)?Vt.merge({},u):Vt.isArray(u)?u.slice():u}function a(c,u,C,h){if(Vt.isUndefined(u)){if(!Vt.isUndefined(c))return i(void 0,c,C,h)}else return i(c,u,C,h)}function o(c,u){if(!Vt.isUndefined(u))return i(void 0,u)}function r(c,u){if(Vt.isUndefined(u)){if(!Vt.isUndefined(c))return i(void 0,c)}else return i(void 0,u)}function s(c,u,C){if(C in e)return i(c,u);if(C in n)return i(void 0,c)}const l={url:o,method:o,data:o,baseURL:r,transformRequest:r,transformResponse:r,paramsSerializer:r,timeout:r,timeoutMessage:r,withCredentials:r,withXSRFToken:r,adapter:r,responseType:r,xsrfCookieName:r,xsrfHeaderName:r,onUploadProgress:r,onDownloadProgress:r,decompress:r,maxContentLength:r,maxBodyLength:r,beforeRedirect:r,transport:r,httpAgent:r,httpsAgent:r,cancelToken:r,socketPath:r,responseEncoding:r,validateStatus:s,headers:(c,u,C)=>a(iV(c),iV(u),C,!0)};return Vt.forEach(Object.keys(Object.assign({},n,e)),function(u){const C=l[u]||a,h=C(n[u],e[u],u);Vt.isUndefined(h)&&C!==s||(t[u]=h)}),t}const Z5=n=>{const e=rI({},n);let{data:t,withXSRFToken:i,xsrfHeaderName:a,xsrfCookieName:o,headers:r,auth:s}=e;e.headers=r=bs.from(r),e.url=y5(R5(e.baseURL,e.url,e.allowAbsoluteUrls),n.params,n.paramsSerializer),s&&r.set("Authorization","Basic "+btoa((s.username||"")+":"+(s.password?unescape(encodeURIComponent(s.password)):"")));let l;if(Vt.isFormData(t)){if(hr.hasStandardBrowserEnv||hr.hasStandardBrowserWebWorkerEnv)r.setContentType(void 0);else if((l=r.getContentType())!==!1){const[c,...u]=l?l.split(";").map(C=>C.trim()).filter(Boolean):[];r.setContentType([c||"multipart/form-data",...u].join("; "))}}if(hr.hasStandardBrowserEnv&&(i&&Vt.isFunction(i)&&(i=i(e)),i||i!==!1&&rU(e.url))){const c=a&&o&&sU.read(o);c&&r.set(a,c)}return e},gU=typeof XMLHttpRequest<"u",uU=gU&&function(n){return new Promise(function(t,i){const a=Z5(n);let o=a.data;const r=bs.from(a.headers).normalize();let{responseType:s,onUploadProgress:l,onDownloadProgress:c}=a,u,C,h,m,p;function B(){m&&m(),p&&p(),a.cancelToken&&a.cancelToken.unsubscribe(u),a.signal&&a.signal.removeEventListener("abort",u)}let b=new XMLHttpRequest;b.open(a.method.toUpperCase(),a.url,!0),b.timeout=a.timeout;function y(){if(!b)return;const R=bs.from("getAllResponseHeaders"in b&&b.getAllResponseHeaders()),x={data:!s||s==="text"||s==="json"?b.responseText:b.response,status:b.status,statusText:b.statusText,headers:R,config:n,request:b};w5(function(E){t(E),B()},function(E){i(E),B()},x),b=null}"onloadend"in b?b.onloadend=y:b.onreadystatechange=function(){!b||b.readyState!==4||b.status===0&&!(b.responseURL&&b.responseURL.indexOf("file:")===0)||setTimeout(y)},b.onabort=function(){b&&(i(new ii("Request aborted",ii.ECONNABORTED,n,b)),b=null)},b.onerror=function(){i(new ii("Network Error",ii.ERR_NETWORK,n,b)),b=null},b.ontimeout=function(){let Z=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const x=a.transitional||B5;a.timeoutErrorMessage&&(Z=a.timeoutErrorMessage),i(new ii(Z,x.clarifyTimeoutError?ii.ETIMEDOUT:ii.ECONNABORTED,n,b)),b=null},o===void 0&&r.setContentType(null),"setRequestHeader"in b&&Vt.forEach(r.toJSON(),function(Z,x){b.setRequestHeader(x,Z)}),Vt.isUndefined(a.withCredentials)||(b.withCredentials=!!a.withCredentials),s&&s!=="json"&&(b.responseType=a.responseType),c&&([h,p]=Dy(c,!0),b.addEventListener("progress",h)),l&&b.upload&&([C,m]=Dy(l),b.upload.addEventListener("progress",C),b.upload.addEventListener("loadend",m)),(a.cancelToken||a.signal)&&(u=R=>{b&&(i(!R||R.type?new Df(null,n,b):R),b.abort(),b=null)},a.cancelToken&&a.cancelToken.subscribe(u),a.signal&&(a.signal.aborted?u():a.signal.addEventListener("abort",u)));const S=iU(a.url);if(S&&hr.protocols.indexOf(S)===-1){i(new ii("Unsupported protocol "+S+":",ii.ERR_BAD_REQUEST,n));return}b.send(o||null)})},dU=(n,e)=>{const{length:t}=n=n?n.filter(Boolean):[];if(e||t){let i=new AbortController,a;const o=function(c){if(!a){a=!0,s();const u=c instanceof Error?c:this.reason;i.abort(u instanceof ii?u:new Df(u instanceof Error?u.message:u))}};let r=e&&setTimeout(()=>{r=null,o(new ii(`timeout ${e} of ms exceeded`,ii.ETIMEDOUT))},e);const s=()=>{n&&(r&&clearTimeout(r),r=null,n.forEach(c=>{c.unsubscribe?c.unsubscribe(o):c.removeEventListener("abort",o)}),n=null)};n.forEach(c=>c.addEventListener("abort",o));const{signal:l}=i;return l.unsubscribe=()=>Vt.asap(s),l}},CU=function*(n,e){let t=n.byteLength;if(t<e){yield n;return}let i=0,a;for(;i<t;)a=i+e,yield n.slice(i,a),i=a},IU=async function*(n,e){for await(const t of hU(n))yield*CU(t,e)},hU=async function*(n){if(n[Symbol.asyncIterator]){yield*n;return}const e=n.getReader();try{for(;;){const{done:t,value:i}=await e.read();if(t)break;yield i}}finally{await e.cancel()}},aV=(n,e,t,i)=>{const a=IU(n,e);let o=0,r,s=l=>{r||(r=!0,i&&i(l))};return new ReadableStream({async pull(l){try{const{done:c,value:u}=await a.next();if(c){s(),l.close();return}let C=u.byteLength;if(t){let h=o+=C;t(h)}l.enqueue(new Uint8Array(u))}catch(c){throw s(c),c}},cancel(l){return s(l),a.return()}},{highWaterMark:2})},cG=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",x5=cG&&typeof ReadableStream=="function",fU=cG&&(typeof TextEncoder=="function"?(n=>e=>n.encode(e))(new TextEncoder):async n=>new Uint8Array(await new Response(n).arrayBuffer())),M5=(n,...e)=>{try{return!!n(...e)}catch{return!1}},AU=x5&&M5(()=>{let n=!1;const e=new Request(hr.origin,{body:new ReadableStream,method:"POST",get duplex(){return n=!0,"half"}}).headers.has("Content-Type");return n&&!e}),oV=64*1024,H1=x5&&M5(()=>Vt.isReadableStream(new Response("").body)),Oy={stream:H1&&(n=>n.body)};cG&&(n=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!Oy[e]&&(Oy[e]=Vt.isFunction(n[e])?t=>t[e]():(t,i)=>{throw new ii(`Response type '${e}' is not supported`,ii.ERR_NOT_SUPPORT,i)})})})(new Response);const mU=async n=>{if(n==null)return 0;if(Vt.isBlob(n))return n.size;if(Vt.isSpecCompliantForm(n))return(await new Request(hr.origin,{method:"POST",body:n}).arrayBuffer()).byteLength;if(Vt.isArrayBufferView(n)||Vt.isArrayBuffer(n))return n.byteLength;if(Vt.isURLSearchParams(n)&&(n=n+""),Vt.isString(n))return(await fU(n)).byteLength},pU=async(n,e)=>{const t=Vt.toFiniteNumber(n.getContentLength());return t??mU(e)},bU=cG&&(async n=>{let{url:e,method:t,data:i,signal:a,cancelToken:o,timeout:r,onDownloadProgress:s,onUploadProgress:l,responseType:c,headers:u,withCredentials:C="same-origin",fetchOptions:h}=Z5(n);c=c?(c+"").toLowerCase():"text";let m=dU([a,o&&o.toAbortSignal()],r),p;const B=m&&m.unsubscribe&&(()=>{m.unsubscribe()});let b;try{if(l&&AU&&t!=="get"&&t!=="head"&&(b=await pU(u,i))!==0){let x=new Request(e,{method:"POST",body:i,duplex:"half"}),M;if(Vt.isFormData(i)&&(M=x.headers.get("content-type"))&&u.setContentType(M),x.body){const[E,F]=tV(b,Dy(nV(l)));i=aV(x.body,oV,E,F)}}Vt.isString(C)||(C=C?"include":"omit");const y="credentials"in Request.prototype;p=new Request(e,{...h,signal:m,method:t.toUpperCase(),headers:u.normalize().toJSON(),body:i,duplex:"half",credentials:y?C:void 0});let S=await fetch(p);const R=H1&&(c==="stream"||c==="response");if(H1&&(s||R&&B)){const x={};["status","statusText","headers"].forEach(N=>{x[N]=S[N]});const M=Vt.toFiniteNumber(S.headers.get("content-length")),[E,F]=s&&tV(M,Dy(nV(s),!0))||[];S=new Response(aV(S.body,oV,E,()=>{F&&F(),B&&B()}),x)}c=c||"text";let Z=await Oy[Vt.findKey(Oy,c)||"text"](S,n);return!R&&B&&B(),await new Promise((x,M)=>{w5(x,M,{data:Z,headers:bs.from(S.headers),status:S.status,statusText:S.statusText,config:n,request:p})})}catch(y){throw B&&B(),y&&y.name==="TypeError"&&/fetch/i.test(y.message)?Object.assign(new ii("Network Error",ii.ERR_NETWORK,n,p),{cause:y.cause||y}):ii.from(y,y&&y.code,n,p)}}),F1={http:HO,xhr:uU,fetch:bU};Vt.forEach(F1,(n,e)=>{if(n){try{Object.defineProperty(n,"name",{value:e})}catch{}Object.defineProperty(n,"adapterName",{value:e})}});const rV=n=>`- ${n}`,vU=n=>Vt.isFunction(n)||n===null||n===!1,W5={getAdapter:n=>{n=Vt.isArray(n)?n:[n];const{length:e}=n;let t,i;const a={};for(let o=0;o<e;o++){t=n[o];let r;if(i=t,!vU(t)&&(i=F1[(r=String(t)).toLowerCase()],i===void 0))throw new ii(`Unknown adapter '${r}'`);if(i)break;a[r||"#"+o]=i}if(!i){const o=Object.entries(a).map(([s,l])=>`adapter ${s} `+(l===!1?"is not supported by the environment":"is not available in the build"));let r=e?o.length>1?`since :
`+o.map(rV).join(`
`):" "+rV(o[0]):"as no adapter specified";throw new ii("There is no suitable adapter to dispatch the request "+r,"ERR_NOT_SUPPORT")}return i},adapters:F1};function A2(n){if(n.cancelToken&&n.cancelToken.throwIfRequested(),n.signal&&n.signal.aborted)throw new Df(null,n)}function sV(n){return A2(n),n.headers=bs.from(n.headers),n.data=f2.call(n,n.transformRequest),["post","put","patch"].indexOf(n.method)!==-1&&n.headers.setContentType("application/x-www-form-urlencoded",!1),W5.getAdapter(n.adapter||$p.adapter)(n).then(function(i){return A2(n),i.data=f2.call(n,n.transformResponse,i),i.headers=bs.from(i.headers),i},function(i){return S5(i)||(A2(n),i&&i.response&&(i.response.data=f2.call(n,n.transformResponse,i.response),i.response.headers=bs.from(i.response.headers))),Promise.reject(i)})}const V5="1.8.4",gG={};["object","boolean","number","function","string","symbol"].forEach((n,e)=>{gG[n]=function(i){return typeof i===n||"a"+(e<1?"n ":" ")+n}});const lV={};gG.transitional=function(e,t,i){function a(o,r){return"[Axios v"+V5+"] Transitional option '"+o+"'"+r+(i?". "+i:"")}return(o,r,s)=>{if(e===!1)throw new ii(a(r," has been removed"+(t?" in "+t:"")),ii.ERR_DEPRECATED);return t&&!lV[r]&&(lV[r]=!0,console.warn(a(r," has been deprecated since v"+t+" and will be removed in the near future"))),e?e(o,r,s):!0}};gG.spelling=function(e){return(t,i)=>(console.warn(`${i} is likely a misspelling of ${e}`),!0)};function yU(n,e,t){if(typeof n!="object")throw new ii("options must be an object",ii.ERR_BAD_OPTION_VALUE);const i=Object.keys(n);let a=i.length;for(;a-- >0;){const o=i[a],r=e[o];if(r){const s=n[o],l=s===void 0||r(s,o,n);if(l!==!0)throw new ii("option "+o+" must be "+l,ii.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new ii("Unknown option "+o,ii.ERR_BAD_OPTION)}}const by={assertOptions:yU,validators:gG},$c=by.validators;let $C=class{constructor(e){this.defaults=e,this.interceptors={request:new $W,response:new $W}}async request(e,t){try{return await this._request(e,t)}catch(i){if(i instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const o=a.stack?a.stack.replace(/^.+\n/,""):"";try{i.stack?o&&!String(i.stack).endsWith(o.replace(/^.+\n.+\n/,""))&&(i.stack+=`
`+o):i.stack=o}catch{}}throw i}}_request(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=rI(this.defaults,t);const{transitional:i,paramsSerializer:a,headers:o}=t;i!==void 0&&by.assertOptions(i,{silentJSONParsing:$c.transitional($c.boolean),forcedJSONParsing:$c.transitional($c.boolean),clarifyTimeoutError:$c.transitional($c.boolean)},!1),a!=null&&(Vt.isFunction(a)?t.paramsSerializer={serialize:a}:by.assertOptions(a,{encode:$c.function,serialize:$c.function},!0)),t.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),by.assertOptions(t,{baseUrl:$c.spelling("baseURL"),withXsrfToken:$c.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let r=o&&Vt.merge(o.common,o[t.method]);o&&Vt.forEach(["delete","get","head","post","put","patch","common"],p=>{delete o[p]}),t.headers=bs.concat(r,o);const s=[];let l=!0;this.interceptors.request.forEach(function(B){typeof B.runWhen=="function"&&B.runWhen(t)===!1||(l=l&&B.synchronous,s.unshift(B.fulfilled,B.rejected))});const c=[];this.interceptors.response.forEach(function(B){c.push(B.fulfilled,B.rejected)});let u,C=0,h;if(!l){const p=[sV.bind(this),void 0];for(p.unshift.apply(p,s),p.push.apply(p,c),h=p.length,u=Promise.resolve(t);C<h;)u=u.then(p[C++],p[C++]);return u}h=s.length;let m=t;for(C=0;C<h;){const p=s[C++],B=s[C++];try{m=p(m)}catch(b){B.call(this,b);break}}try{u=sV.call(this,m)}catch(p){return Promise.reject(p)}for(C=0,h=c.length;C<h;)u=u.then(c[C++],c[C++]);return u}getUri(e){e=rI(this.defaults,e);const t=R5(e.baseURL,e.url,e.allowAbsoluteUrls);return y5(t,e.params,e.paramsSerializer)}};Vt.forEach(["delete","get","head","options"],function(e){$C.prototype[e]=function(t,i){return this.request(rI(i||{},{method:e,url:t,data:(i||{}).data}))}});Vt.forEach(["post","put","patch"],function(e){function t(i){return function(o,r,s){return this.request(rI(s||{},{method:e,headers:i?{"Content-Type":"multipart/form-data"}:{},url:o,data:r}))}}$C.prototype[e]=t(),$C.prototype[e+"Form"]=t(!0)});let BU=class N5{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(o){t=o});const i=this;this.promise.then(a=>{if(!i._listeners)return;let o=i._listeners.length;for(;o-- >0;)i._listeners[o](a);i._listeners=null}),this.promise.then=a=>{let o;const r=new Promise(s=>{i.subscribe(s),o=s}).then(a);return r.cancel=function(){i.unsubscribe(o)},r},e(function(o,r,s){i.reason||(i.reason=new Df(o,r,s),t(i.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);t!==-1&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=i=>{e.abort(i)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;return{token:new N5(function(a){e=a}),cancel:e}}};function GU(n){return function(t){return n.apply(null,t)}}function SU(n){return Vt.isObject(n)&&n.isAxiosError===!0}const X1={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(X1).forEach(([n,e])=>{X1[e]=n});function E5(n){const e=new $C(n),t=u5($C.prototype.request,e);return Vt.extend(t,$C.prototype,e,{allOwnKeys:!0}),Vt.extend(t,e,null,{allOwnKeys:!0}),t.create=function(a){return E5(rI(n,a))},t}const Da=E5($p);Da.Axios=$C;Da.CanceledError=Df;Da.CancelToken=BU;Da.isCancel=S5;Da.VERSION=V5;Da.toFormData=lG;Da.AxiosError=ii;Da.Cancel=Da.CanceledError;Da.all=function(e){return Promise.all(e)};Da.spread=GU;Da.isAxiosError=SU;Da.mergeConfig=rI;Da.AxiosHeaders=bs;Da.formToJSON=n=>G5(Vt.isHTMLForm(n)?new FormData(n):n);Da.getAdapter=W5.getAdapter;Da.HttpStatusCode=X1;Da.default=Da;const{Axios:mpe,AxiosError:ppe,CanceledError:bpe,isCancel:vpe,CancelToken:ype,VERSION:Bpe,all:Gpe,Cancel:Spe,isAxiosError:wpe,spread:Rpe,toFormData:Zpe,AxiosHeaders:xpe,HttpStatusCode:Mpe,formToJSON:Wpe,getAdapter:Vpe,mergeConfig:Npe}=Da;var H5={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},cV=Ct.createContext&&Ct.createContext(H5),wU=["attr","size","title"];function RU(n,e){if(n==null)return{};var t=ZU(n,e),i,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(n);for(a=0;a<o.length;a++)i=o[a],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(n,i)&&(t[i]=n[i])}return t}function ZU(n,e){if(n==null)return{};var t={};for(var i in n)if(Object.prototype.hasOwnProperty.call(n,i)){if(e.indexOf(i)>=0)continue;t[i]=n[i]}return t}function Uy(){return Uy=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},Uy.apply(this,arguments)}function gV(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,i)}return t}function ky(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?gV(Object(t),!0).forEach(function(i){xU(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):gV(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}function xU(n,e,t){return e=MU(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function MU(n){var e=WU(n,"string");return typeof e=="symbol"?e:e+""}function WU(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function F5(n){return n&&n.map((e,t)=>Ct.createElement(e.tag,ky({key:t},e.attr),F5(e.child)))}function kZ(n){return e=>Ct.createElement(VU,Uy({attr:ky({},n.attr)},e),F5(n.child))}function VU(n){var e=t=>{var{attr:i,size:a,title:o}=n,r=RU(n,wU),s=a||t.size||"1em",l;return t.className&&(l=t.className),n.className&&(l=(l?l+" ":"")+n.className),Ct.createElement("svg",Uy({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,i,r,{className:l,style:ky(ky({color:n.color||t.color},t.style),n.style),height:s,width:s,xmlns:"http://www.w3.org/2000/svg"}),o&&Ct.createElement("title",null,o),n.children)};return cV!==void 0?Ct.createElement(cV.Consumer,null,t=>e(t)):e(H5)}function X5(n){return kZ({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"m112 184 144 144 144-144"},child:[]}]})(n)}function T5(n){return kZ({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"m112 328 144-144 144 144"},child:[]}]})(n)}function Y5(n){return kZ({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"m289.94 256 95-95A24 24 0 0 0 351 127l-95 95-95-95a24 24 0 0 0-34 34l95 95-95 95a24 24 0 1 0 34 34l95-95 95 95a24 24 0 0 0 34-34z"},child:[]}]})(n)}function T1({position:n,isVisible:e,onClose:t,onToggle:i,children:a,title:o,isCollapsed:r}){return e?Le.jsxs("div",{className:`floating-panel left-panel ${n} ${r?"collapsed":""}`,children:[Le.jsxs("div",{className:"panel-header",children:[Le.jsx("h3",{children:o||`  - ${n}`}),Le.jsxs("div",{className:"panel-controls",children:[Le.jsx("button",{className:"control-button toggle-button",onClick:i,children:r?Le.jsx(X5,{}):Le.jsx(T5,{})}),Le.jsx("button",{className:"control-button close-button",onClick:t,children:Le.jsx(Y5,{})})]})]}),Le.jsx("div",{className:`panel-content ${r?"hidden":""}`,children:a})]}):null}const NU=Object.freeze(Object.defineProperty({__proto__:null,default:T1},Symbol.toStringTag,{value:"Module"})),EU=(n,e,t)=>{const i=n[e];return i?typeof i=="function"?i():Promise.resolve(i):new Promise((a,o)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(o.bind(null,new Error("Unknown variable dynamic import: "+e+(e.split("/").length!==t?". Note that variables only represent file names one level deep.":""))))})};function HU({position:n,config:e}){if(!e)return null;const t=v.lazy(()=>EU(Object.assign({}),`../forms/${e.componentName}.jsx`,3));return Le.jsx("div",{className:`floating-panel ${n}`,children:Le.jsx(v.Suspense,{fallback:Le.jsx("div",{children:"Loading..."}),children:Le.jsx(t,{...e.props})})})}const FU=Object.freeze(Object.defineProperty({__proto__:null,default:HU},Symbol.toStringTag,{value:"Module"}));function Y1({position:n,isVisible:e,onClose:t,onToggle:i,children:a,title:o,isCollapsed:r}){return e?Le.jsxs("div",{className:`floating-panel right-panel ${n} ${r?"collapsed":""}`,children:[Le.jsxs("div",{className:"panel-header",children:[Le.jsxs("h3",{children:[o,"   - ",n]}),Le.jsxs("div",{className:"panel-controls",children:[Le.jsx("button",{className:"control-button toggle-button",onClick:i,children:r?Le.jsx(X5,{}):Le.jsx(T5,{})}),Le.jsx("button",{className:"control-button close-button",onClick:t,children:Le.jsx(Y5,{})})]})]}),Le.jsx("div",{className:`panel-content ${r?"hidden":""}`,children:a})]}):null}const XU=Object.freeze(Object.defineProperty({__proto__:null,default:Y1},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const eb="175",EC={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},HC={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},z5=0,z1=1,K5=2,TU=3,L5=0,uG=1,np=2,oc=3,dg=0,fr=1,ms=2,sg=0,eI=1,K1=2,L1=3,_1=4,_5=5,ud=100,D5=101,O5=102,U5=103,k5=104,P5=200,J5=201,j5=202,Q5=203,Py=204,Jy=205,q5=206,$5=207,e9=208,t9=209,n9=210,i9=211,a9=212,o9=213,r9=214,jy=0,Qy=1,qy=2,sI=3,$y=4,eB=5,tB=6,nB=7,tb=0,s9=1,l9=2,lg=0,c9=1,g9=2,u9=3,PZ=4,d9=5,C9=6,I9=7,D1="attached",h9="detached",pd=300,Cg=301,bd=302,Af=303,Bp=304,Of=306,gu=1e3,Ka=1001,mf=1002,Mo=1003,dG=1004,YU=1004,OC=1005,zU=1005,Bi=1006,cf=1007,KU=1007,pl=1008,O1=1008,vs=1009,CG=1010,IG=1011,pf=1012,nb=1013,Ig=1014,ma=1015,Co=1016,hG=1017,fG=1018,bf=1020,JZ=35902,jZ=1021,QZ=1022,La=1023,qZ=1024,$Z=1025,vf=1026,yf=1027,ib=1028,ab=1029,ex=1030,AG=1031,LU=1032,mG=1033,ip=33776,ap=33777,op=33778,rp=33779,iB=35840,aB=35841,oB=35842,rB=35843,sB=36196,lB=37492,cB=37496,gB=37808,uB=37809,dB=37810,CB=37811,IB=37812,hB=37813,fB=37814,AB=37815,mB=37816,pB=37817,bB=37818,vB=37819,yB=37820,BB=37821,sp=36492,GB=36494,SB=36495,tx=36283,wB=36284,RB=36285,ZB=36286,f9=2200,A9=2201,m9=2202,Bf=2300,Gf=2301,vy=2302,UC=2400,kC=2401,Gp=2402,pG=2500,nx=2501,p9=0,ix=1,xB=2,b9=3200,ax=3201,_U=3202,DU=3203,Sd=0,v9=1,$g="",Uo="srgb",Cc="srgb-linear",Sp="linear",Ui="srgb",OU=0,FC=7680,UU=7681,kU=7682,PU=7683,JU=34055,jU=34056,QU=5386,qU=512,$U=513,ek=514,tk=515,nk=516,ik=517,ak=518,U1=519,y9=512,B9=513,G9=514,ox=515,S9=516,w9=517,R9=518,Z9=519,wp=35044,x9=35048,ok=35040,rk=35045,sk=35049,lk=35041,ck=35046,gk=35050,uk=35042,dk="100",k1="300 es",cc=2e3,Rp=2001,Ck={COMPUTE:"compute",RENDER:"render"};let pg=class{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(t)===-1&&i[e].push(t)}hasEventListener(e,t){const i=this._listeners;return i===void 0?!1:i[e]!==void 0&&i[e].indexOf(t)!==-1}removeEventListener(e,t){const i=this._listeners;if(i===void 0)return;const a=i[e];if(a!==void 0){const o=a.indexOf(t);o!==-1&&a.splice(o,1)}}dispatchEvent(e){const t=this._listeners;if(t===void 0)return;const i=t[e.type];if(i!==void 0){e.target=this;const a=i.slice(0);for(let o=0,r=a.length;o<r;o++)a[o].call(this,e);e.target=null}}};const cr=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let uV=1234567;const tI=Math.PI/180,Sf=180/Math.PI;function Os(){const n=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(cr[n&255]+cr[n>>8&255]+cr[n>>16&255]+cr[n>>24&255]+"-"+cr[e&255]+cr[e>>8&255]+"-"+cr[e>>16&15|64]+cr[e>>24&255]+"-"+cr[t&63|128]+cr[t>>8&255]+"-"+cr[t>>16&255]+cr[t>>24&255]+cr[i&255]+cr[i>>8&255]+cr[i>>16&255]+cr[i>>24&255]).toLowerCase()}function jn(n,e,t){return Math.max(e,Math.min(t,n))}function rx(n,e){return(n%e+e)%e}function Ik(n,e,t,i,a){return i+(n-e)*(a-i)/(t-e)}function hk(n,e,t){return n!==e?(t-n)/(e-n):0}function lp(n,e,t){return(1-t)*n+t*e}function fk(n,e,t,i){return lp(n,e,1-Math.exp(-t*i))}function Ak(n,e=1){return e-Math.abs(rx(n,e*2)-e)}function mk(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*(3-2*n))}function pk(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*n*(n*(n*6-15)+10))}function bk(n,e){return n+Math.floor(Math.random()*(e-n+1))}function vk(n,e){return n+Math.random()*(e-n)}function yk(n){return n*(.5-Math.random())}function Bk(n){n!==void 0&&(uV=n);let e=uV+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function Gk(n){return n*tI}function Sk(n){return n*Sf}function wk(n){return(n&n-1)===0&&n!==0}function Rk(n){return Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function Zk(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}function xk(n,e,t,i,a){const o=Math.cos,r=Math.sin,s=o(t/2),l=r(t/2),c=o((e+i)/2),u=r((e+i)/2),C=o((e-i)/2),h=r((e-i)/2),m=o((i-e)/2),p=r((i-e)/2);switch(a){case"XYX":n.set(s*u,l*C,l*h,s*c);break;case"YZY":n.set(l*h,s*u,l*C,s*c);break;case"ZXZ":n.set(l*C,l*h,s*u,s*c);break;case"XZX":n.set(s*u,l*p,l*m,s*c);break;case"YXY":n.set(l*m,s*u,l*p,s*c);break;case"ZYZ":n.set(l*p,l*m,s*u,s*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+a)}}function Dr(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return n/4294967295;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int32Array:return Math.max(n/2147483647,-1);case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function ni(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return Math.round(n*4294967295);case Uint16Array:return Math.round(n*65535);case Uint8Array:return Math.round(n*255);case Int32Array:return Math.round(n*2147483647);case Int16Array:return Math.round(n*32767);case Int8Array:return Math.round(n*127);default:throw new Error("Invalid component type.")}}const M9={DEG2RAD:tI,RAD2DEG:Sf,generateUUID:Os,clamp:jn,euclideanModulo:rx,mapLinear:Ik,inverseLerp:hk,lerp:lp,damp:fk,pingpong:Ak,smoothstep:mk,smootherstep:pk,randInt:bk,randFloat:vk,randFloatSpread:yk,seededRandom:Bk,degToRad:Gk,radToDeg:Sk,isPowerOfTwo:wk,ceilPowerOfTwo:Rk,floorPowerOfTwo:Zk,setQuaternionFromProperEuler:xk,normalize:ni,denormalize:Dr};class Xt{constructor(e=0,t=0){Xt.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,i=this.y,a=e.elements;return this.x=a[0]*t+a[3]*i+a[6],this.y=a[1]*t+a[4]*i+a[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=jn(this.x,e.x,t.x),this.y=jn(this.y,e.y,t.y),this}clampScalar(e,t){return this.x=jn(this.x,e,t),this.y=jn(this.y,e,t),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(jn(i,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(jn(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const i=Math.cos(t),a=Math.sin(t),o=this.x-e.x,r=this.y-e.y;return this.x=o*i-r*a+e.x,this.y=o*a+r*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Jn{constructor(e,t,i,a,o,r,s,l,c){Jn.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,i,a,o,r,s,l,c)}set(e,t,i,a,o,r,s,l,c){const u=this.elements;return u[0]=e,u[1]=a,u[2]=s,u[3]=t,u[4]=o,u[5]=l,u[6]=i,u[7]=r,u[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,a=t.elements,o=this.elements,r=i[0],s=i[3],l=i[6],c=i[1],u=i[4],C=i[7],h=i[2],m=i[5],p=i[8],B=a[0],b=a[3],y=a[6],S=a[1],R=a[4],Z=a[7],x=a[2],M=a[5],E=a[8];return o[0]=r*B+s*S+l*x,o[3]=r*b+s*R+l*M,o[6]=r*y+s*Z+l*E,o[1]=c*B+u*S+C*x,o[4]=c*b+u*R+C*M,o[7]=c*y+u*Z+C*E,o[2]=h*B+m*S+p*x,o[5]=h*b+m*R+p*M,o[8]=h*y+m*Z+p*E,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[1],a=e[2],o=e[3],r=e[4],s=e[5],l=e[6],c=e[7],u=e[8];return t*r*u-t*s*c-i*o*u+i*s*l+a*o*c-a*r*l}invert(){const e=this.elements,t=e[0],i=e[1],a=e[2],o=e[3],r=e[4],s=e[5],l=e[6],c=e[7],u=e[8],C=u*r-s*c,h=s*l-u*o,m=c*o-r*l,p=t*C+i*h+a*m;if(p===0)return this.set(0,0,0,0,0,0,0,0,0);const B=1/p;return e[0]=C*B,e[1]=(a*c-u*i)*B,e[2]=(s*i-a*r)*B,e[3]=h*B,e[4]=(u*t-a*l)*B,e[5]=(a*o-s*t)*B,e[6]=m*B,e[7]=(i*l-c*t)*B,e[8]=(r*t-i*o)*B,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,a,o,r,s){const l=Math.cos(o),c=Math.sin(o);return this.set(i*l,i*c,-i*(l*r+c*s)+r+e,-a*c,a*l,-a*(-c*r+l*s)+s+t,0,0,1),this}scale(e,t){return this.premultiply(m2.makeScale(e,t)),this}rotate(e){return this.premultiply(m2.makeRotation(-e)),this}translate(e,t){return this.premultiply(m2.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,i,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,i=e.elements;for(let a=0;a<9;a++)if(t[a]!==i[a])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const m2=new Jn;function W9(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}const Mk={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function nf(n,e){return new Mk[n](e)}function Zp(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function V9(){const n=Zp("canvas");return n.style.display="block",n}const dV={};function yy(n){n in dV||(dV[n]=!0,console.warn(n))}function Wk(n,e,t){return new Promise(function(i,a){function o(){switch(n.clientWaitSync(e,n.SYNC_FLUSH_COMMANDS_BIT,0)){case n.WAIT_FAILED:a();break;case n.TIMEOUT_EXPIRED:setTimeout(o,t);break;default:i()}}setTimeout(o,t)})}function Vk(n){const e=n.elements;e[2]=.5*e[2]+.5*e[3],e[6]=.5*e[6]+.5*e[7],e[10]=.5*e[10]+.5*e[11],e[14]=.5*e[14]+.5*e[15]}function Nk(n){const e=n.elements;e[11]===-1?(e[10]=-e[10]-1,e[14]=-e[14]):(e[10]=-e[10],e[14]=-e[14]+1)}const CV=new Jn().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),IV=new Jn().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function Ek(){const n={enabled:!0,workingColorSpace:Cc,spaces:{},convert:function(a,o,r){return this.enabled===!1||o===r||!o||!r||(this.spaces[o].transfer===Ui&&(a.r=ru(a.r),a.g=ru(a.g),a.b=ru(a.b)),this.spaces[o].primaries!==this.spaces[r].primaries&&(a.applyMatrix3(this.spaces[o].toXYZ),a.applyMatrix3(this.spaces[r].fromXYZ)),this.spaces[r].transfer===Ui&&(a.r=gf(a.r),a.g=gf(a.g),a.b=gf(a.b))),a},fromWorkingColorSpace:function(a,o){return this.convert(a,this.workingColorSpace,o)},toWorkingColorSpace:function(a,o){return this.convert(a,o,this.workingColorSpace)},getPrimaries:function(a){return this.spaces[a].primaries},getTransfer:function(a){return a===$g?Sp:this.spaces[a].transfer},getLuminanceCoefficients:function(a,o=this.workingColorSpace){return a.fromArray(this.spaces[o].luminanceCoefficients)},define:function(a){Object.assign(this.spaces,a)},_getMatrix:function(a,o,r){return a.copy(this.spaces[o].toXYZ).multiply(this.spaces[r].fromXYZ)},_getDrawingBufferColorSpace:function(a){return this.spaces[a].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(a=this.workingColorSpace){return this.spaces[a].workingColorSpaceConfig.unpackColorSpace}},e=[.64,.33,.3,.6,.15,.06],t=[.2126,.7152,.0722],i=[.3127,.329];return n.define({[Cc]:{primaries:e,whitePoint:i,transfer:Sp,toXYZ:CV,fromXYZ:IV,luminanceCoefficients:t,workingColorSpaceConfig:{unpackColorSpace:Uo},outputColorSpaceConfig:{drawingBufferColorSpace:Uo}},[Uo]:{primaries:e,whitePoint:i,transfer:Ui,toXYZ:CV,fromXYZ:IV,luminanceCoefficients:t,outputColorSpaceConfig:{drawingBufferColorSpace:Uo}}}),n}const vi=Ek();function ru(n){return n<.04045?n*.0773993808:Math.pow(n*.9478672986+.0521327014,2.4)}function gf(n){return n<.0031308?n*12.92:1.055*Math.pow(n,.41666)-.055}let Bh;class N9{static getDataURL(e,t="image/png"){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let i;if(e instanceof HTMLCanvasElement)i=e;else{Bh===void 0&&(Bh=Zp("canvas")),Bh.width=e.width,Bh.height=e.height;const a=Bh.getContext("2d");e instanceof ImageData?a.putImageData(e,0,0):a.drawImage(e,0,0,e.width,e.height),i=Bh}return i.toDataURL(t)}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=Zp("canvas");t.width=e.width,t.height=e.height;const i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const a=i.getImageData(0,0,e.width,e.height),o=a.data;for(let r=0;r<o.length;r++)o[r]=ru(o[r]/255)*255;return i.putImageData(a,0,0),t}else if(e.data){const t=e.data.slice(0);for(let i=0;i<t.length;i++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[i]=Math.floor(ru(t[i]/255)*255):t[i]=ru(t[i]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let Hk=0;class dd{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:Hk++}),this.uuid=Os(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const i={uuid:this.uuid,url:""},a=this.data;if(a!==null){let o;if(Array.isArray(a)){o=[];for(let r=0,s=a.length;r<s;r++)a[r].isDataTexture?o.push(p2(a[r].image)):o.push(p2(a[r]))}else o=p2(a);i.url=o}return t||(e.images[this.uuid]=i),i}}function p2(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?N9.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let Fk=0;class Fi extends pg{constructor(e=Fi.DEFAULT_IMAGE,t=Fi.DEFAULT_MAPPING,i=Ka,a=Ka,o=Bi,r=pl,s=La,l=vs,c=Fi.DEFAULT_ANISOTROPY,u=$g){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Fk++}),this.uuid=Os(),this.name="",this.source=new dd(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=i,this.wrapT=a,this.magFilter=o,this.minFilter=r,this.anisotropy=c,this.format=s,this.internalFormat=null,this.type=l,this.offset=new Xt(0,0),this.repeat=new Xt(1,1),this.center=new Xt(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Jn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=u,this.userData={},this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const i={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(i.userData=this.userData),t||(e.textures[this.uuid]=i),i}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==pd)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case gu:e.x=e.x-Math.floor(e.x);break;case Ka:e.x=e.x<0?0:1;break;case mf:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case gu:e.y=e.y-Math.floor(e.y);break;case Ka:e.y=e.y<0?0:1;break;case mf:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}}Fi.DEFAULT_IMAGE=null;Fi.DEFAULT_MAPPING=pd;Fi.DEFAULT_ANISOTROPY=1;class yi{constructor(e=0,t=0,i=0,a=1){yi.prototype.isVector4=!0,this.x=e,this.y=t,this.z=i,this.w=a}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,a){return this.x=e,this.y=t,this.z=i,this.w=a,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,i=this.y,a=this.z,o=this.w,r=e.elements;return this.x=r[0]*t+r[4]*i+r[8]*a+r[12]*o,this.y=r[1]*t+r[5]*i+r[9]*a+r[13]*o,this.z=r[2]*t+r[6]*i+r[10]*a+r[14]*o,this.w=r[3]*t+r[7]*i+r[11]*a+r[15]*o,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,a,o;const l=e.elements,c=l[0],u=l[4],C=l[8],h=l[1],m=l[5],p=l[9],B=l[2],b=l[6],y=l[10];if(Math.abs(u-h)<.01&&Math.abs(C-B)<.01&&Math.abs(p-b)<.01){if(Math.abs(u+h)<.1&&Math.abs(C+B)<.1&&Math.abs(p+b)<.1&&Math.abs(c+m+y-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const R=(c+1)/2,Z=(m+1)/2,x=(y+1)/2,M=(u+h)/4,E=(C+B)/4,F=(p+b)/4;return R>Z&&R>x?R<.01?(i=0,a=.707106781,o=.707106781):(i=Math.sqrt(R),a=M/i,o=E/i):Z>x?Z<.01?(i=.707106781,a=0,o=.707106781):(a=Math.sqrt(Z),i=M/a,o=F/a):x<.01?(i=.707106781,a=.707106781,o=0):(o=Math.sqrt(x),i=E/o,a=F/o),this.set(i,a,o,t),this}let S=Math.sqrt((b-p)*(b-p)+(C-B)*(C-B)+(h-u)*(h-u));return Math.abs(S)<.001&&(S=1),this.x=(b-p)/S,this.y=(C-B)/S,this.z=(h-u)/S,this.w=Math.acos((c+m+y-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=jn(this.x,e.x,t.x),this.y=jn(this.y,e.y,t.y),this.z=jn(this.z,e.z,t.z),this.w=jn(this.w,e.w,t.w),this}clampScalar(e,t){return this.x=jn(this.x,e,t),this.y=jn(this.y,e,t),this.z=jn(this.z,e,t),this.w=jn(this.w,e,t),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(jn(i,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class bG extends pg{constructor(e=1,t=1,i={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new yi(0,0,e,t),this.scissorTest=!1,this.viewport=new yi(0,0,e,t);const a={width:e,height:t,depth:1};i=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:Bi,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1},i);const o=new Fi(a,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace);o.flipY=!1,o.generateMipmaps=i.generateMipmaps,o.internalFormat=i.internalFormat,this.textures=[];const r=i.count;for(let s=0;s<r;s++)this.textures[s]=o.clone(),this.textures[s].isRenderTargetTexture=!0,this.textures[s].renderTarget=this;this.depthBuffer=i.depthBuffer,this.stencilBuffer=i.stencilBuffer,this.resolveDepthBuffer=i.resolveDepthBuffer,this.resolveStencilBuffer=i.resolveStencilBuffer,this._depthTexture=i.depthTexture,this.samples=i.samples}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){this._depthTexture!==null&&(this._depthTexture.renderTarget=null),e!==null&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,t,i=1){if(this.width!==e||this.height!==t||this.depth!==i){this.width=e,this.height=t,this.depth=i;for(let a=0,o=this.textures.length;a<o;a++)this.textures[a].image.width=e,this.textures[a].image.height=t,this.textures[a].image.depth=i;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let t=0,i=e.textures.length;t<i;t++){this.textures[t]=e.textures[t].clone(),this.textures[t].isRenderTargetTexture=!0,this.textures[t].renderTarget=this;const a=Object.assign({},e.textures[t].image);this.textures[t].source=new dd(a)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Us extends bG{constructor(e=1,t=1,i={}){super(e,t,i),this.isWebGLRenderTarget=!0}}class ob extends Fi{constructor(e=null,t=1,i=1,a=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:i,depth:a},this.magFilter=Mo,this.minFilter=Mo,this.wrapR=Ka,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class Xk extends Us{constructor(e=1,t=1,i=1,a={}){super(e,t,a),this.isWebGLArrayRenderTarget=!0,this.depth=i,this.texture=new ob(null,e,t,i),this.texture.isRenderTargetTexture=!0}}class vG extends Fi{constructor(e=null,t=1,i=1,a=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:i,depth:a},this.magFilter=Mo,this.minFilter=Mo,this.wrapR=Ka,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Tk extends Us{constructor(e=1,t=1,i=1,a={}){super(e,t,a),this.isWebGL3DRenderTarget=!0,this.depth=i,this.texture=new vG(null,e,t,i),this.texture.isRenderTargetTexture=!0}}let eo=class{constructor(e=0,t=0,i=0,a=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=i,this._w=a}static slerpFlat(e,t,i,a,o,r,s){let l=i[a+0],c=i[a+1],u=i[a+2],C=i[a+3];const h=o[r+0],m=o[r+1],p=o[r+2],B=o[r+3];if(s===0){e[t+0]=l,e[t+1]=c,e[t+2]=u,e[t+3]=C;return}if(s===1){e[t+0]=h,e[t+1]=m,e[t+2]=p,e[t+3]=B;return}if(C!==B||l!==h||c!==m||u!==p){let b=1-s;const y=l*h+c*m+u*p+C*B,S=y>=0?1:-1,R=1-y*y;if(R>Number.EPSILON){const x=Math.sqrt(R),M=Math.atan2(x,y*S);b=Math.sin(b*M)/x,s=Math.sin(s*M)/x}const Z=s*S;if(l=l*b+h*Z,c=c*b+m*Z,u=u*b+p*Z,C=C*b+B*Z,b===1-s){const x=1/Math.sqrt(l*l+c*c+u*u+C*C);l*=x,c*=x,u*=x,C*=x}}e[t]=l,e[t+1]=c,e[t+2]=u,e[t+3]=C}static multiplyQuaternionsFlat(e,t,i,a,o,r){const s=i[a],l=i[a+1],c=i[a+2],u=i[a+3],C=o[r],h=o[r+1],m=o[r+2],p=o[r+3];return e[t]=s*p+u*C+l*m-c*h,e[t+1]=l*p+u*h+c*C-s*m,e[t+2]=c*p+u*m+s*h-l*C,e[t+3]=u*p-s*C-l*h-c*m,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,a){return this._x=e,this._y=t,this._z=i,this._w=a,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const i=e._x,a=e._y,o=e._z,r=e._order,s=Math.cos,l=Math.sin,c=s(i/2),u=s(a/2),C=s(o/2),h=l(i/2),m=l(a/2),p=l(o/2);switch(r){case"XYZ":this._x=h*u*C+c*m*p,this._y=c*m*C-h*u*p,this._z=c*u*p+h*m*C,this._w=c*u*C-h*m*p;break;case"YXZ":this._x=h*u*C+c*m*p,this._y=c*m*C-h*u*p,this._z=c*u*p-h*m*C,this._w=c*u*C+h*m*p;break;case"ZXY":this._x=h*u*C-c*m*p,this._y=c*m*C+h*u*p,this._z=c*u*p+h*m*C,this._w=c*u*C-h*m*p;break;case"ZYX":this._x=h*u*C-c*m*p,this._y=c*m*C+h*u*p,this._z=c*u*p-h*m*C,this._w=c*u*C+h*m*p;break;case"YZX":this._x=h*u*C+c*m*p,this._y=c*m*C+h*u*p,this._z=c*u*p-h*m*C,this._w=c*u*C-h*m*p;break;case"XZY":this._x=h*u*C-c*m*p,this._y=c*m*C-h*u*p,this._z=c*u*p+h*m*C,this._w=c*u*C+h*m*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+r)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const i=t/2,a=Math.sin(i);return this._x=e.x*a,this._y=e.y*a,this._z=e.z*a,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,i=t[0],a=t[4],o=t[8],r=t[1],s=t[5],l=t[9],c=t[2],u=t[6],C=t[10],h=i+s+C;if(h>0){const m=.5/Math.sqrt(h+1);this._w=.25/m,this._x=(u-l)*m,this._y=(o-c)*m,this._z=(r-a)*m}else if(i>s&&i>C){const m=2*Math.sqrt(1+i-s-C);this._w=(u-l)/m,this._x=.25*m,this._y=(a+r)/m,this._z=(o+c)/m}else if(s>C){const m=2*Math.sqrt(1+s-i-C);this._w=(o-c)/m,this._x=(a+r)/m,this._y=.25*m,this._z=(l+u)/m}else{const m=2*Math.sqrt(1+C-i-s);this._w=(r-a)/m,this._x=(o+c)/m,this._y=(l+u)/m,this._z=.25*m}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(jn(this.dot(e),-1,1)))}rotateTowards(e,t){const i=this.angleTo(e);if(i===0)return this;const a=Math.min(1,t/i);return this.slerp(e,a),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const i=e._x,a=e._y,o=e._z,r=e._w,s=t._x,l=t._y,c=t._z,u=t._w;return this._x=i*u+r*s+a*c-o*l,this._y=a*u+r*l+o*s-i*c,this._z=o*u+r*c+i*l-a*s,this._w=r*u-i*s-a*l-o*c,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const i=this._x,a=this._y,o=this._z,r=this._w;let s=r*e._w+i*e._x+a*e._y+o*e._z;if(s<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,s=-s):this.copy(e),s>=1)return this._w=r,this._x=i,this._y=a,this._z=o,this;const l=1-s*s;if(l<=Number.EPSILON){const m=1-t;return this._w=m*r+t*this._w,this._x=m*i+t*this._x,this._y=m*a+t*this._y,this._z=m*o+t*this._z,this.normalize(),this}const c=Math.sqrt(l),u=Math.atan2(c,s),C=Math.sin((1-t)*u)/c,h=Math.sin(t*u)/c;return this._w=r*C+this._w*h,this._x=i*C+this._x*h,this._y=a*C+this._y*h,this._z=o*C+this._z*h,this._onChangeCallback(),this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),i=Math.random(),a=Math.sqrt(1-i),o=Math.sqrt(i);return this.set(a*Math.sin(e),a*Math.cos(e),o*Math.sin(t),o*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}};class Be{constructor(e=0,t=0,i=0){Be.prototype.isVector3=!0,this.x=e,this.y=t,this.z=i}set(e,t,i){return i===void 0&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(hV.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(hV.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,i=this.y,a=this.z,o=e.elements;return this.x=o[0]*t+o[3]*i+o[6]*a,this.y=o[1]*t+o[4]*i+o[7]*a,this.z=o[2]*t+o[5]*i+o[8]*a,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,i=this.y,a=this.z,o=e.elements,r=1/(o[3]*t+o[7]*i+o[11]*a+o[15]);return this.x=(o[0]*t+o[4]*i+o[8]*a+o[12])*r,this.y=(o[1]*t+o[5]*i+o[9]*a+o[13])*r,this.z=(o[2]*t+o[6]*i+o[10]*a+o[14])*r,this}applyQuaternion(e){const t=this.x,i=this.y,a=this.z,o=e.x,r=e.y,s=e.z,l=e.w,c=2*(r*a-s*i),u=2*(s*t-o*a),C=2*(o*i-r*t);return this.x=t+l*c+r*C-s*u,this.y=i+l*u+s*c-o*C,this.z=a+l*C+o*u-r*c,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,i=this.y,a=this.z,o=e.elements;return this.x=o[0]*t+o[4]*i+o[8]*a,this.y=o[1]*t+o[5]*i+o[9]*a,this.z=o[2]*t+o[6]*i+o[10]*a,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=jn(this.x,e.x,t.x),this.y=jn(this.y,e.y,t.y),this.z=jn(this.z,e.z,t.z),this}clampScalar(e,t){return this.x=jn(this.x,e,t),this.y=jn(this.y,e,t),this.z=jn(this.z,e,t),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(jn(i,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const i=e.x,a=e.y,o=e.z,r=t.x,s=t.y,l=t.z;return this.x=a*l-o*s,this.y=o*r-i*l,this.z=i*s-a*r,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return b2.copy(this).projectOnVector(e),this.sub(b2)}reflect(e){return this.sub(b2.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(jn(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y,a=this.z-e.z;return t*t+i*i+a*a}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){const a=Math.sin(t)*e;return this.x=a*Math.sin(i),this.y=Math.cos(t)*e,this.z=a*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),a=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=a,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=Math.random()*2-1,i=Math.sqrt(1-t*t);return this.x=i*Math.cos(e),this.y=t,this.z=i*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const b2=new Be,hV=new eo;class Wo{constructor(e=new Be(1/0,1/0,1/0),t=new Be(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t+=3)this.expandByPoint($l.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,i=e.count;t<i;t++)this.expandByPoint($l.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=$l.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const i=e.geometry;if(i!==void 0){const o=i.getAttribute("position");if(t===!0&&o!==void 0&&e.isInstancedMesh!==!0)for(let r=0,s=o.count;r<s;r++)e.isMesh===!0?e.getVertexPosition(r,$l):$l.fromBufferAttribute(o,r),$l.applyMatrix4(e.matrixWorld),this.expandByPoint($l);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),q0.copy(e.boundingBox)):(i.boundingBox===null&&i.computeBoundingBox(),q0.copy(i.boundingBox)),q0.applyMatrix4(e.matrixWorld),this.union(q0)}const a=e.children;for(let o=0,r=a.length;o<r;o++)this.expandByObject(a[o],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,$l),$l.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(pm),$0.subVectors(this.max,pm),Gh.subVectors(e.a,pm),Sh.subVectors(e.b,pm),wh.subVectors(e.c,pm),ed.subVectors(Sh,Gh),td.subVectors(wh,Sh),fC.subVectors(Gh,wh);let t=[0,-ed.z,ed.y,0,-td.z,td.y,0,-fC.z,fC.y,ed.z,0,-ed.x,td.z,0,-td.x,fC.z,0,-fC.x,-ed.y,ed.x,0,-td.y,td.x,0,-fC.y,fC.x,0];return!v2(t,Gh,Sh,wh,$0)||(t=[1,0,0,0,1,0,0,0,1],!v2(t,Gh,Sh,wh,$0))?!1:(ev.crossVectors(ed,td),t=[ev.x,ev.y,ev.z],v2(t,Gh,Sh,wh,$0))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,$l).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize($l).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Dg[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Dg[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Dg[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Dg[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Dg[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Dg[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Dg[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Dg[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Dg),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const Dg=[new Be,new Be,new Be,new Be,new Be,new Be,new Be,new Be],$l=new Be,q0=new Wo,Gh=new Be,Sh=new Be,wh=new Be,ed=new Be,td=new Be,fC=new Be,pm=new Be,$0=new Be,ev=new Be,AC=new Be;function v2(n,e,t,i,a){for(let o=0,r=n.length-3;o<=r;o+=3){AC.fromArray(n,o);const s=a.x*Math.abs(AC.x)+a.y*Math.abs(AC.y)+a.z*Math.abs(AC.z),l=e.dot(AC),c=t.dot(AC),u=i.dot(AC);if(Math.max(-Math.max(l,c,u),Math.min(l,c,u))>s)return!1}return!0}const Yk=new Wo,bm=new Be,y2=new Be;class Vo{constructor(e=new Be,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const i=this.center;t!==void 0?i.copy(t):Yk.setFromPoints(e).getCenter(i);let a=0;for(let o=0,r=e.length;o<r;o++)a=Math.max(a,i.distanceToSquared(e[o]));return this.radius=Math.sqrt(a),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const i=this.center.distanceToSquared(e);return t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;bm.subVectors(e,this.center);const t=bm.lengthSq();if(t>this.radius*this.radius){const i=Math.sqrt(t),a=(i-this.radius)*.5;this.center.addScaledVector(bm,a/i),this.radius+=a}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(y2.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(bm.copy(e.center).add(y2)),this.expandByPoint(bm.copy(e.center).sub(y2))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const Og=new Be,B2=new Be,tv=new Be,nd=new Be,G2=new Be,nv=new Be,S2=new Be;let pI=class{constructor(e=new Be,t=new Be(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Og)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Og.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Og.copy(this.origin).addScaledVector(this.direction,t),Og.distanceToSquared(e))}distanceSqToSegment(e,t,i,a){B2.copy(e).add(t).multiplyScalar(.5),tv.copy(t).sub(e).normalize(),nd.copy(this.origin).sub(B2);const o=e.distanceTo(t)*.5,r=-this.direction.dot(tv),s=nd.dot(this.direction),l=-nd.dot(tv),c=nd.lengthSq(),u=Math.abs(1-r*r);let C,h,m,p;if(u>0)if(C=r*l-s,h=r*s-l,p=o*u,C>=0)if(h>=-p)if(h<=p){const B=1/u;C*=B,h*=B,m=C*(C+r*h+2*s)+h*(r*C+h+2*l)+c}else h=o,C=Math.max(0,-(r*h+s)),m=-C*C+h*(h+2*l)+c;else h=-o,C=Math.max(0,-(r*h+s)),m=-C*C+h*(h+2*l)+c;else h<=-p?(C=Math.max(0,-(-r*o+s)),h=C>0?-o:Math.min(Math.max(-o,-l),o),m=-C*C+h*(h+2*l)+c):h<=p?(C=0,h=Math.min(Math.max(-o,-l),o),m=h*(h+2*l)+c):(C=Math.max(0,-(r*o+s)),h=C>0?o:Math.min(Math.max(-o,-l),o),m=-C*C+h*(h+2*l)+c);else h=r>0?-o:o,C=Math.max(0,-(r*h+s)),m=-C*C+h*(h+2*l)+c;return i&&i.copy(this.origin).addScaledVector(this.direction,C),a&&a.copy(B2).addScaledVector(tv,h),m}intersectSphere(e,t){Og.subVectors(e.center,this.origin);const i=Og.dot(this.direction),a=Og.dot(Og)-i*i,o=e.radius*e.radius;if(a>o)return null;const r=Math.sqrt(o-a),s=i-r,l=i+r;return l<0?null:s<0?this.at(l,t):this.at(s,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){const i=this.distanceToPlane(e);return i===null?null:this.at(i,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,a,o,r,s,l;const c=1/this.direction.x,u=1/this.direction.y,C=1/this.direction.z,h=this.origin;return c>=0?(i=(e.min.x-h.x)*c,a=(e.max.x-h.x)*c):(i=(e.max.x-h.x)*c,a=(e.min.x-h.x)*c),u>=0?(o=(e.min.y-h.y)*u,r=(e.max.y-h.y)*u):(o=(e.max.y-h.y)*u,r=(e.min.y-h.y)*u),i>r||o>a||((o>i||isNaN(i))&&(i=o),(r<a||isNaN(a))&&(a=r),C>=0?(s=(e.min.z-h.z)*C,l=(e.max.z-h.z)*C):(s=(e.max.z-h.z)*C,l=(e.min.z-h.z)*C),i>l||s>a)||((s>i||i!==i)&&(i=s),(l<a||a!==a)&&(a=l),a<0)?null:this.at(i>=0?i:a,t)}intersectsBox(e){return this.intersectBox(e,Og)!==null}intersectTriangle(e,t,i,a,o){G2.subVectors(t,e),nv.subVectors(i,e),S2.crossVectors(G2,nv);let r=this.direction.dot(S2),s;if(r>0){if(a)return null;s=1}else if(r<0)s=-1,r=-r;else return null;nd.subVectors(this.origin,e);const l=s*this.direction.dot(nv.crossVectors(nd,nv));if(l<0)return null;const c=s*this.direction.dot(G2.cross(nd));if(c<0||l+c>r)return null;const u=-s*nd.dot(S2);return u<0?null:this.at(u/r,o)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}};class Vn{constructor(e,t,i,a,o,r,s,l,c,u,C,h,m,p,B,b){Vn.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,i,a,o,r,s,l,c,u,C,h,m,p,B,b)}set(e,t,i,a,o,r,s,l,c,u,C,h,m,p,B,b){const y=this.elements;return y[0]=e,y[4]=t,y[8]=i,y[12]=a,y[1]=o,y[5]=r,y[9]=s,y[13]=l,y[2]=c,y[6]=u,y[10]=C,y[14]=h,y[3]=m,y[7]=p,y[11]=B,y[15]=b,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Vn().fromArray(this.elements)}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){const t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,i=e.elements,a=1/Rh.setFromMatrixColumn(e,0).length(),o=1/Rh.setFromMatrixColumn(e,1).length(),r=1/Rh.setFromMatrixColumn(e,2).length();return t[0]=i[0]*a,t[1]=i[1]*a,t[2]=i[2]*a,t[3]=0,t[4]=i[4]*o,t[5]=i[5]*o,t[6]=i[6]*o,t[7]=0,t[8]=i[8]*r,t[9]=i[9]*r,t[10]=i[10]*r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,i=e.x,a=e.y,o=e.z,r=Math.cos(i),s=Math.sin(i),l=Math.cos(a),c=Math.sin(a),u=Math.cos(o),C=Math.sin(o);if(e.order==="XYZ"){const h=r*u,m=r*C,p=s*u,B=s*C;t[0]=l*u,t[4]=-l*C,t[8]=c,t[1]=m+p*c,t[5]=h-B*c,t[9]=-s*l,t[2]=B-h*c,t[6]=p+m*c,t[10]=r*l}else if(e.order==="YXZ"){const h=l*u,m=l*C,p=c*u,B=c*C;t[0]=h+B*s,t[4]=p*s-m,t[8]=r*c,t[1]=r*C,t[5]=r*u,t[9]=-s,t[2]=m*s-p,t[6]=B+h*s,t[10]=r*l}else if(e.order==="ZXY"){const h=l*u,m=l*C,p=c*u,B=c*C;t[0]=h-B*s,t[4]=-r*C,t[8]=p+m*s,t[1]=m+p*s,t[5]=r*u,t[9]=B-h*s,t[2]=-r*c,t[6]=s,t[10]=r*l}else if(e.order==="ZYX"){const h=r*u,m=r*C,p=s*u,B=s*C;t[0]=l*u,t[4]=p*c-m,t[8]=h*c+B,t[1]=l*C,t[5]=B*c+h,t[9]=m*c-p,t[2]=-c,t[6]=s*l,t[10]=r*l}else if(e.order==="YZX"){const h=r*l,m=r*c,p=s*l,B=s*c;t[0]=l*u,t[4]=B-h*C,t[8]=p*C+m,t[1]=C,t[5]=r*u,t[9]=-s*u,t[2]=-c*u,t[6]=m*C+p,t[10]=h-B*C}else if(e.order==="XZY"){const h=r*l,m=r*c,p=s*l,B=s*c;t[0]=l*u,t[4]=-C,t[8]=c*u,t[1]=h*C+B,t[5]=r*u,t[9]=m*C-p,t[2]=p*C-m,t[6]=s*u,t[10]=B*C+h}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(zk,e,Kk)}lookAt(e,t,i){const a=this.elements;return Ts.subVectors(e,t),Ts.lengthSq()===0&&(Ts.z=1),Ts.normalize(),id.crossVectors(i,Ts),id.lengthSq()===0&&(Math.abs(i.z)===1?Ts.x+=1e-4:Ts.z+=1e-4,Ts.normalize(),id.crossVectors(i,Ts)),id.normalize(),iv.crossVectors(Ts,id),a[0]=id.x,a[4]=iv.x,a[8]=Ts.x,a[1]=id.y,a[5]=iv.y,a[9]=Ts.y,a[2]=id.z,a[6]=iv.z,a[10]=Ts.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,a=t.elements,o=this.elements,r=i[0],s=i[4],l=i[8],c=i[12],u=i[1],C=i[5],h=i[9],m=i[13],p=i[2],B=i[6],b=i[10],y=i[14],S=i[3],R=i[7],Z=i[11],x=i[15],M=a[0],E=a[4],F=a[8],N=a[12],H=a[1],z=a[5],_=a[9],D=a[13],P=a[2],$=a[6],X=a[10],L=a[14],U=a[3],q=a[7],K=a[11],O=a[15];return o[0]=r*M+s*H+l*P+c*U,o[4]=r*E+s*z+l*$+c*q,o[8]=r*F+s*_+l*X+c*K,o[12]=r*N+s*D+l*L+c*O,o[1]=u*M+C*H+h*P+m*U,o[5]=u*E+C*z+h*$+m*q,o[9]=u*F+C*_+h*X+m*K,o[13]=u*N+C*D+h*L+m*O,o[2]=p*M+B*H+b*P+y*U,o[6]=p*E+B*z+b*$+y*q,o[10]=p*F+B*_+b*X+y*K,o[14]=p*N+B*D+b*L+y*O,o[3]=S*M+R*H+Z*P+x*U,o[7]=S*E+R*z+Z*$+x*q,o[11]=S*F+R*_+Z*X+x*K,o[15]=S*N+R*D+Z*L+x*O,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[4],a=e[8],o=e[12],r=e[1],s=e[5],l=e[9],c=e[13],u=e[2],C=e[6],h=e[10],m=e[14],p=e[3],B=e[7],b=e[11],y=e[15];return p*(+o*l*C-a*c*C-o*s*h+i*c*h+a*s*m-i*l*m)+B*(+t*l*m-t*c*h+o*r*h-a*r*m+a*c*u-o*l*u)+b*(+t*c*C-t*s*m-o*r*C+i*r*m+o*s*u-i*c*u)+y*(-a*s*u-t*l*C+t*s*h+a*r*C-i*r*h+i*l*u)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,i){const a=this.elements;return e.isVector3?(a[12]=e.x,a[13]=e.y,a[14]=e.z):(a[12]=e,a[13]=t,a[14]=i),this}invert(){const e=this.elements,t=e[0],i=e[1],a=e[2],o=e[3],r=e[4],s=e[5],l=e[6],c=e[7],u=e[8],C=e[9],h=e[10],m=e[11],p=e[12],B=e[13],b=e[14],y=e[15],S=C*b*c-B*h*c+B*l*m-s*b*m-C*l*y+s*h*y,R=p*h*c-u*b*c-p*l*m+r*b*m+u*l*y-r*h*y,Z=u*B*c-p*C*c+p*s*m-r*B*m-u*s*y+r*C*y,x=p*C*l-u*B*l-p*s*h+r*B*h+u*s*b-r*C*b,M=t*S+i*R+a*Z+o*x;if(M===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const E=1/M;return e[0]=S*E,e[1]=(B*h*o-C*b*o-B*a*m+i*b*m+C*a*y-i*h*y)*E,e[2]=(s*b*o-B*l*o+B*a*c-i*b*c-s*a*y+i*l*y)*E,e[3]=(C*l*o-s*h*o-C*a*c+i*h*c+s*a*m-i*l*m)*E,e[4]=R*E,e[5]=(u*b*o-p*h*o+p*a*m-t*b*m-u*a*y+t*h*y)*E,e[6]=(p*l*o-r*b*o-p*a*c+t*b*c+r*a*y-t*l*y)*E,e[7]=(r*h*o-u*l*o+u*a*c-t*h*c-r*a*m+t*l*m)*E,e[8]=Z*E,e[9]=(p*C*o-u*B*o-p*i*m+t*B*m+u*i*y-t*C*y)*E,e[10]=(r*B*o-p*s*o+p*i*c-t*B*c-r*i*y+t*s*y)*E,e[11]=(u*s*o-r*C*o-u*i*c+t*C*c+r*i*m-t*s*m)*E,e[12]=x*E,e[13]=(u*B*a-p*C*a+p*i*h-t*B*h-u*i*b+t*C*b)*E,e[14]=(p*s*a-r*B*a-p*i*l+t*B*l+r*i*b-t*s*b)*E,e[15]=(r*C*a-u*s*a+u*i*l-t*C*l-r*i*h+t*s*h)*E,this}scale(e){const t=this.elements,i=e.x,a=e.y,o=e.z;return t[0]*=i,t[4]*=a,t[8]*=o,t[1]*=i,t[5]*=a,t[9]*=o,t[2]*=i,t[6]*=a,t[10]*=o,t[3]*=i,t[7]*=a,t[11]*=o,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],a=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,i,a))}makeTranslation(e,t,i){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const i=Math.cos(t),a=Math.sin(t),o=1-i,r=e.x,s=e.y,l=e.z,c=o*r,u=o*s;return this.set(c*r+i,c*s-a*l,c*l+a*s,0,c*s+a*l,u*s+i,u*l-a*r,0,c*l-a*s,u*l+a*r,o*l*l+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,a,o,r){return this.set(1,i,o,0,e,1,r,0,t,a,1,0,0,0,0,1),this}compose(e,t,i){const a=this.elements,o=t._x,r=t._y,s=t._z,l=t._w,c=o+o,u=r+r,C=s+s,h=o*c,m=o*u,p=o*C,B=r*u,b=r*C,y=s*C,S=l*c,R=l*u,Z=l*C,x=i.x,M=i.y,E=i.z;return a[0]=(1-(B+y))*x,a[1]=(m+Z)*x,a[2]=(p-R)*x,a[3]=0,a[4]=(m-Z)*M,a[5]=(1-(h+y))*M,a[6]=(b+S)*M,a[7]=0,a[8]=(p+R)*E,a[9]=(b-S)*E,a[10]=(1-(h+B))*E,a[11]=0,a[12]=e.x,a[13]=e.y,a[14]=e.z,a[15]=1,this}decompose(e,t,i){const a=this.elements;let o=Rh.set(a[0],a[1],a[2]).length();const r=Rh.set(a[4],a[5],a[6]).length(),s=Rh.set(a[8],a[9],a[10]).length();this.determinant()<0&&(o=-o),e.x=a[12],e.y=a[13],e.z=a[14],ec.copy(this);const c=1/o,u=1/r,C=1/s;return ec.elements[0]*=c,ec.elements[1]*=c,ec.elements[2]*=c,ec.elements[4]*=u,ec.elements[5]*=u,ec.elements[6]*=u,ec.elements[8]*=C,ec.elements[9]*=C,ec.elements[10]*=C,t.setFromRotationMatrix(ec),i.x=o,i.y=r,i.z=s,this}makePerspective(e,t,i,a,o,r,s=cc){const l=this.elements,c=2*o/(t-e),u=2*o/(i-a),C=(t+e)/(t-e),h=(i+a)/(i-a);let m,p;if(s===cc)m=-(r+o)/(r-o),p=-2*r*o/(r-o);else if(s===Rp)m=-r/(r-o),p=-r*o/(r-o);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+s);return l[0]=c,l[4]=0,l[8]=C,l[12]=0,l[1]=0,l[5]=u,l[9]=h,l[13]=0,l[2]=0,l[6]=0,l[10]=m,l[14]=p,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,t,i,a,o,r,s=cc){const l=this.elements,c=1/(t-e),u=1/(i-a),C=1/(r-o),h=(t+e)*c,m=(i+a)*u;let p,B;if(s===cc)p=(r+o)*C,B=-2*C;else if(s===Rp)p=o*C,B=-1*C;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+s);return l[0]=2*c,l[4]=0,l[8]=0,l[12]=-h,l[1]=0,l[5]=2*u,l[9]=0,l[13]=-m,l[2]=0,l[6]=0,l[10]=B,l[14]=-p,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){const t=this.elements,i=e.elements;for(let a=0;a<16;a++)if(t[a]!==i[a])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}}const Rh=new Be,ec=new Vn,zk=new Be(0,0,0),Kk=new Be(1,1,1),id=new Be,iv=new Be,Ts=new Be,fV=new Vn,AV=new eo;class ys{constructor(e=0,t=0,i=0,a=ys.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=i,this._order=a}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,i,a=this._order){return this._x=e,this._y=t,this._z=i,this._order=a,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,i=!0){const a=e.elements,o=a[0],r=a[4],s=a[8],l=a[1],c=a[5],u=a[9],C=a[2],h=a[6],m=a[10];switch(t){case"XYZ":this._y=Math.asin(jn(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-u,m),this._z=Math.atan2(-r,o)):(this._x=Math.atan2(h,c),this._z=0);break;case"YXZ":this._x=Math.asin(-jn(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(s,m),this._z=Math.atan2(l,c)):(this._y=Math.atan2(-C,o),this._z=0);break;case"ZXY":this._x=Math.asin(jn(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-C,m),this._z=Math.atan2(-r,c)):(this._y=0,this._z=Math.atan2(l,o));break;case"ZYX":this._y=Math.asin(-jn(C,-1,1)),Math.abs(C)<.9999999?(this._x=Math.atan2(h,m),this._z=Math.atan2(l,o)):(this._x=0,this._z=Math.atan2(-r,c));break;case"YZX":this._z=Math.asin(jn(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-u,c),this._y=Math.atan2(-C,o)):(this._x=0,this._y=Math.atan2(s,m));break;case"XZY":this._z=Math.asin(-jn(r,-1,1)),Math.abs(r)<.9999999?(this._x=Math.atan2(h,c),this._y=Math.atan2(s,o)):(this._x=Math.atan2(-u,m),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,i===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,i){return fV.makeRotationFromQuaternion(e),this.setFromRotationMatrix(fV,t,i)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return AV.setFromEuler(this),this.setFromQuaternion(AV,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}ys.DEFAULT_ORDER="XYZ";class wf{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let Lk=0;const mV=new Be,Zh=new eo,Ug=new Vn,av=new Be,vm=new Be,_k=new Be,Dk=new eo,pV=new Be(1,0,0),bV=new Be(0,1,0),vV=new Be(0,0,1),yV={type:"added"},Ok={type:"removed"},xh={type:"childadded",child:null},w2={type:"childremoved",child:null};class Ii extends pg{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:Lk++}),this.uuid=Os(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Ii.DEFAULT_UP.clone();const e=new Be,t=new ys,i=new eo,a=new Be(1,1,1);function o(){i.setFromEuler(t,!1)}function r(){t.setFromQuaternion(i,void 0,!1)}t._onChange(o),i._onChange(r),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:a},modelViewMatrix:{value:new Vn},normalMatrix:{value:new Jn}}),this.matrix=new Vn,this.matrixWorld=new Vn,this.matrixAutoUpdate=Ii.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Ii.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new wf,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return Zh.setFromAxisAngle(e,t),this.quaternion.multiply(Zh),this}rotateOnWorldAxis(e,t){return Zh.setFromAxisAngle(e,t),this.quaternion.premultiply(Zh),this}rotateX(e){return this.rotateOnAxis(pV,e)}rotateY(e){return this.rotateOnAxis(bV,e)}rotateZ(e){return this.rotateOnAxis(vV,e)}translateOnAxis(e,t){return mV.copy(e).applyQuaternion(this.quaternion),this.position.add(mV.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(pV,e)}translateY(e){return this.translateOnAxis(bV,e)}translateZ(e){return this.translateOnAxis(vV,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(Ug.copy(this.matrixWorld).invert())}lookAt(e,t,i){e.isVector3?av.copy(e):av.set(e,t,i);const a=this.parent;this.updateWorldMatrix(!0,!1),vm.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Ug.lookAt(vm,av,this.up):Ug.lookAt(av,vm,this.up),this.quaternion.setFromRotationMatrix(Ug),a&&(Ug.extractRotation(a.matrixWorld),Zh.setFromRotationMatrix(Ug),this.quaternion.premultiply(Zh.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(yV),xh.child=e,this.dispatchEvent(xh),xh.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(Ok),w2.child=e,this.dispatchEvent(w2),w2.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),Ug.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),Ug.multiply(e.parent.matrixWorld)),e.applyMatrix4(Ug),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(yV),xh.child=e,this.dispatchEvent(xh),xh.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let i=0,a=this.children.length;i<a;i++){const r=this.children[i].getObjectByProperty(e,t);if(r!==void 0)return r}}getObjectsByProperty(e,t,i=[]){this[e]===t&&i.push(this);const a=this.children;for(let o=0,r=a.length;o<r;o++)a[o].getObjectsByProperty(e,t,i);return i}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(vm,e,_k),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(vm,Dk,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let i=0,a=t.length;i<a;i++)t[i].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let i=0,a=t.length;i<a;i++)t[i].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let i=0,a=t.length;i<a;i++)t[i].updateMatrixWorld(e)}updateWorldMatrix(e,t){const i=this.parent;if(e===!0&&i!==null&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),t===!0){const a=this.children;for(let o=0,r=a.length;o<r;o++)a[o].updateWorldMatrix(!1,!0)}}toJSON(e){const t=e===void 0||typeof e=="string",i={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const a={};a.uuid=this.uuid,a.type=this.type,this.name!==""&&(a.name=this.name),this.castShadow===!0&&(a.castShadow=!0),this.receiveShadow===!0&&(a.receiveShadow=!0),this.visible===!1&&(a.visible=!1),this.frustumCulled===!1&&(a.frustumCulled=!1),this.renderOrder!==0&&(a.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(a.userData=this.userData),a.layers=this.layers.mask,a.matrix=this.matrix.toArray(),a.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(a.matrixAutoUpdate=!1),this.isInstancedMesh&&(a.type="InstancedMesh",a.count=this.count,a.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(a.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(a.type="BatchedMesh",a.perObjectFrustumCulled=this.perObjectFrustumCulled,a.sortObjects=this.sortObjects,a.drawRanges=this._drawRanges,a.reservedRanges=this._reservedRanges,a.visibility=this._visibility,a.active=this._active,a.bounds=this._bounds.map(s=>({boxInitialized:s.boxInitialized,boxMin:s.box.min.toArray(),boxMax:s.box.max.toArray(),sphereInitialized:s.sphereInitialized,sphereRadius:s.sphere.radius,sphereCenter:s.sphere.center.toArray()})),a.maxInstanceCount=this._maxInstanceCount,a.maxVertexCount=this._maxVertexCount,a.maxIndexCount=this._maxIndexCount,a.geometryInitialized=this._geometryInitialized,a.geometryCount=this._geometryCount,a.matricesTexture=this._matricesTexture.toJSON(e),this._colorsTexture!==null&&(a.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(a.boundingSphere={center:a.boundingSphere.center.toArray(),radius:a.boundingSphere.radius}),this.boundingBox!==null&&(a.boundingBox={min:a.boundingBox.min.toArray(),max:a.boundingBox.max.toArray()}));function o(s,l){return s[l.uuid]===void 0&&(s[l.uuid]=l.toJSON(e)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?a.background=this.background.toJSON():this.background.isTexture&&(a.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(a.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){a.geometry=o(e.geometries,this.geometry);const s=this.geometry.parameters;if(s!==void 0&&s.shapes!==void 0){const l=s.shapes;if(Array.isArray(l))for(let c=0,u=l.length;c<u;c++){const C=l[c];o(e.shapes,C)}else o(e.shapes,l)}}if(this.isSkinnedMesh&&(a.bindMode=this.bindMode,a.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(o(e.skeletons,this.skeleton),a.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const s=[];for(let l=0,c=this.material.length;l<c;l++)s.push(o(e.materials,this.material[l]));a.material=s}else a.material=o(e.materials,this.material);if(this.children.length>0){a.children=[];for(let s=0;s<this.children.length;s++)a.children.push(this.children[s].toJSON(e).object)}if(this.animations.length>0){a.animations=[];for(let s=0;s<this.animations.length;s++){const l=this.animations[s];a.animations.push(o(e.animations,l))}}if(t){const s=r(e.geometries),l=r(e.materials),c=r(e.textures),u=r(e.images),C=r(e.shapes),h=r(e.skeletons),m=r(e.animations),p=r(e.nodes);s.length>0&&(i.geometries=s),l.length>0&&(i.materials=l),c.length>0&&(i.textures=c),u.length>0&&(i.images=u),C.length>0&&(i.shapes=C),h.length>0&&(i.skeletons=h),m.length>0&&(i.animations=m),p.length>0&&(i.nodes=p)}return i.object=a,i;function r(s){const l=[];for(const c in s){const u=s[c];delete u.metadata,l.push(u)}return l}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let i=0;i<e.children.length;i++){const a=e.children[i];this.add(a.clone())}return this}}Ii.DEFAULT_UP=new Be(0,1,0);Ii.DEFAULT_MATRIX_AUTO_UPDATE=!0;Ii.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const tc=new Be,kg=new Be,R2=new Be,Pg=new Be,Mh=new Be,Wh=new Be,BV=new Be,Z2=new Be,x2=new Be,M2=new Be,W2=new yi,V2=new yi,N2=new yi;class ps{constructor(e=new Be,t=new Be,i=new Be){this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,a){a.subVectors(i,t),tc.subVectors(e,t),a.cross(tc);const o=a.lengthSq();return o>0?a.multiplyScalar(1/Math.sqrt(o)):a.set(0,0,0)}static getBarycoord(e,t,i,a,o){tc.subVectors(a,t),kg.subVectors(i,t),R2.subVectors(e,t);const r=tc.dot(tc),s=tc.dot(kg),l=tc.dot(R2),c=kg.dot(kg),u=kg.dot(R2),C=r*c-s*s;if(C===0)return o.set(0,0,0),null;const h=1/C,m=(c*l-s*u)*h,p=(r*u-s*l)*h;return o.set(1-m-p,p,m)}static containsPoint(e,t,i,a){return this.getBarycoord(e,t,i,a,Pg)===null?!1:Pg.x>=0&&Pg.y>=0&&Pg.x+Pg.y<=1}static getInterpolation(e,t,i,a,o,r,s,l){return this.getBarycoord(e,t,i,a,Pg)===null?(l.x=0,l.y=0,"z"in l&&(l.z=0),"w"in l&&(l.w=0),null):(l.setScalar(0),l.addScaledVector(o,Pg.x),l.addScaledVector(r,Pg.y),l.addScaledVector(s,Pg.z),l)}static getInterpolatedAttribute(e,t,i,a,o,r){return W2.setScalar(0),V2.setScalar(0),N2.setScalar(0),W2.fromBufferAttribute(e,t),V2.fromBufferAttribute(e,i),N2.fromBufferAttribute(e,a),r.setScalar(0),r.addScaledVector(W2,o.x),r.addScaledVector(V2,o.y),r.addScaledVector(N2,o.z),r}static isFrontFacing(e,t,i,a){return tc.subVectors(i,t),kg.subVectors(e,t),tc.cross(kg).dot(a)<0}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,a){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[a]),this}setFromAttributeAndIndices(e,t,i,a){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,a),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return tc.subVectors(this.c,this.b),kg.subVectors(this.a,this.b),tc.cross(kg).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return ps.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return ps.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,i,a,o){return ps.getInterpolation(e,this.a,this.b,this.c,t,i,a,o)}containsPoint(e){return ps.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return ps.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const i=this.a,a=this.b,o=this.c;let r,s;Mh.subVectors(a,i),Wh.subVectors(o,i),Z2.subVectors(e,i);const l=Mh.dot(Z2),c=Wh.dot(Z2);if(l<=0&&c<=0)return t.copy(i);x2.subVectors(e,a);const u=Mh.dot(x2),C=Wh.dot(x2);if(u>=0&&C<=u)return t.copy(a);const h=l*C-u*c;if(h<=0&&l>=0&&u<=0)return r=l/(l-u),t.copy(i).addScaledVector(Mh,r);M2.subVectors(e,o);const m=Mh.dot(M2),p=Wh.dot(M2);if(p>=0&&m<=p)return t.copy(o);const B=m*c-l*p;if(B<=0&&c>=0&&p<=0)return s=c/(c-p),t.copy(i).addScaledVector(Wh,s);const b=u*p-m*C;if(b<=0&&C-u>=0&&m-p>=0)return BV.subVectors(o,a),s=(C-u)/(C-u+(m-p)),t.copy(a).addScaledVector(BV,s);const y=1/(b+B+h);return r=B*y,s=h*y,t.copy(i).addScaledVector(Mh,r).addScaledVector(Wh,s)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const E9={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},ad={h:0,s:0,l:0},ov={h:0,s:0,l:0};function E2(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*6*(2/3-t):n}let dn=class{constructor(e,t,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,i)}set(e,t,i){if(t===void 0&&i===void 0){const a=e;a&&a.isColor?this.copy(a):typeof a=="number"?this.setHex(a):typeof a=="string"&&this.setStyle(a)}else this.setRGB(e,t,i);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Uo){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,vi.toWorkingColorSpace(this,t),this}setRGB(e,t,i,a=vi.workingColorSpace){return this.r=e,this.g=t,this.b=i,vi.toWorkingColorSpace(this,a),this}setHSL(e,t,i,a=vi.workingColorSpace){if(e=rx(e,1),t=jn(t,0,1),i=jn(i,0,1),t===0)this.r=this.g=this.b=i;else{const o=i<=.5?i*(1+t):i+t-i*t,r=2*i-o;this.r=E2(r,o,e+1/3),this.g=E2(r,o,e),this.b=E2(r,o,e-1/3)}return vi.toWorkingColorSpace(this,a),this}setStyle(e,t=Uo){function i(o){o!==void 0&&parseFloat(o)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let a;if(a=/^(\w+)\(([^\)]*)\)/.exec(e)){let o;const r=a[1],s=a[2];switch(r){case"rgb":case"rgba":if(o=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return i(o[4]),this.setRGB(Math.min(255,parseInt(o[1],10))/255,Math.min(255,parseInt(o[2],10))/255,Math.min(255,parseInt(o[3],10))/255,t);if(o=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return i(o[4]),this.setRGB(Math.min(100,parseInt(o[1],10))/100,Math.min(100,parseInt(o[2],10))/100,Math.min(100,parseInt(o[3],10))/100,t);break;case"hsl":case"hsla":if(o=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return i(o[4]),this.setHSL(parseFloat(o[1])/360,parseFloat(o[2])/100,parseFloat(o[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(a=/^\#([A-Fa-f\d]+)$/.exec(e)){const o=a[1],r=o.length;if(r===3)return this.setRGB(parseInt(o.charAt(0),16)/15,parseInt(o.charAt(1),16)/15,parseInt(o.charAt(2),16)/15,t);if(r===6)return this.setHex(parseInt(o,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=Uo){const i=E9[e.toLowerCase()];return i!==void 0?this.setHex(i,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=ru(e.r),this.g=ru(e.g),this.b=ru(e.b),this}copyLinearToSRGB(e){return this.r=gf(e.r),this.g=gf(e.g),this.b=gf(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Uo){return vi.fromWorkingColorSpace(gr.copy(this),e),Math.round(jn(gr.r*255,0,255))*65536+Math.round(jn(gr.g*255,0,255))*256+Math.round(jn(gr.b*255,0,255))}getHexString(e=Uo){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=vi.workingColorSpace){vi.fromWorkingColorSpace(gr.copy(this),t);const i=gr.r,a=gr.g,o=gr.b,r=Math.max(i,a,o),s=Math.min(i,a,o);let l,c;const u=(s+r)/2;if(s===r)l=0,c=0;else{const C=r-s;switch(c=u<=.5?C/(r+s):C/(2-r-s),r){case i:l=(a-o)/C+(a<o?6:0);break;case a:l=(o-i)/C+2;break;case o:l=(i-a)/C+4;break}l/=6}return e.h=l,e.s=c,e.l=u,e}getRGB(e,t=vi.workingColorSpace){return vi.fromWorkingColorSpace(gr.copy(this),t),e.r=gr.r,e.g=gr.g,e.b=gr.b,e}getStyle(e=Uo){vi.fromWorkingColorSpace(gr.copy(this),e);const t=gr.r,i=gr.g,a=gr.b;return e!==Uo?`color(${e} ${t.toFixed(3)} ${i.toFixed(3)} ${a.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(i*255)},${Math.round(a*255)})`}offsetHSL(e,t,i){return this.getHSL(ad),this.setHSL(ad.h+e,ad.s+t,ad.l+i)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,i){return this.r=e.r+(t.r-e.r)*i,this.g=e.g+(t.g-e.g)*i,this.b=e.b+(t.b-e.b)*i,this}lerpHSL(e,t){this.getHSL(ad),e.getHSL(ov);const i=lp(ad.h,ov.h,t),a=lp(ad.s,ov.s,t),o=lp(ad.l,ov.l,t);return this.setHSL(i,a,o),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,i=this.g,a=this.b,o=e.elements;return this.r=o[0]*t+o[3]*i+o[6]*a,this.g=o[1]*t+o[4]*i+o[7]*a,this.b=o[2]*t+o[5]*i+o[8]*a,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};const gr=new dn;dn.NAMES=E9;let Uk=0;class ho extends pg{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:Uk++}),this.uuid=Os(),this.name="",this.type="Material",this.blending=eI,this.side=dg,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=Py,this.blendDst=Jy,this.blendEquation=ud,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new dn(0,0,0),this.blendAlpha=0,this.depthFunc=sI,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=U1,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=FC,this.stencilZFail=FC,this.stencilZPass=FC,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const i=e[t];if(i===void 0){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const a=this[t];if(a===void 0){console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`);continue}a&&a.isColor?a.set(i):a&&a.isVector3&&i&&i.isVector3?a.copy(i):this[t]=i}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const i={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),this.roughness!==void 0&&(i.roughness=this.roughness),this.metalness!==void 0&&(i.metalness=this.metalness),this.sheen!==void 0&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(i.shininess=this.shininess),this.clearcoat!==void 0&&(i.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(i.dispersion=this.dispersion),this.iridescence!==void 0&&(i.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(i.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(i.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(i.combine=this.combine)),this.envMapRotation!==void 0&&(i.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(i.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(i.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(i.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(i.size=this.size),this.shadowSide!==null&&(i.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==eI&&(i.blending=this.blending),this.side!==dg&&(i.side=this.side),this.vertexColors===!0&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=!0),this.blendSrc!==Py&&(i.blendSrc=this.blendSrc),this.blendDst!==Jy&&(i.blendDst=this.blendDst),this.blendEquation!==ud&&(i.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(i.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(i.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(i.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(i.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(i.blendAlpha=this.blendAlpha),this.depthFunc!==sI&&(i.depthFunc=this.depthFunc),this.depthTest===!1&&(i.depthTest=this.depthTest),this.depthWrite===!1&&(i.depthWrite=this.depthWrite),this.colorWrite===!1&&(i.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(i.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==U1&&(i.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(i.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(i.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==FC&&(i.stencilFail=this.stencilFail),this.stencilZFail!==FC&&(i.stencilZFail=this.stencilZFail),this.stencilZPass!==FC&&(i.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(i.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(i.rotation=this.rotation),this.polygonOffset===!0&&(i.polygonOffset=!0),this.polygonOffsetFactor!==0&&(i.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(i.linewidth=this.linewidth),this.dashSize!==void 0&&(i.dashSize=this.dashSize),this.gapSize!==void 0&&(i.gapSize=this.gapSize),this.scale!==void 0&&(i.scale=this.scale),this.dithering===!0&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.alphaHash===!0&&(i.alphaHash=!0),this.alphaToCoverage===!0&&(i.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=!0),this.forceSinglePass===!0&&(i.forceSinglePass=!0),this.wireframe===!0&&(i.wireframe=!0),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(i.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(i.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(i.flatShading=!0),this.visible===!1&&(i.visible=!1),this.toneMapped===!1&&(i.toneMapped=!1),this.fog===!1&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData);function a(o){const r=[];for(const s in o){const l=o[s];delete l.metadata,r.push(l)}return r}if(t){const o=a(e.textures),r=a(e.images);o.length>0&&(i.textures=o),r.length>0&&(i.images=r)}return i}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let i=null;if(t!==null){const a=t.length;i=new Array(a);for(let o=0;o!==a;++o)i[o]=t[o].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}onBuild(){console.warn("Material: onBuild() has been removed.")}}class Or extends ho{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new dn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ys,this.combine=tb,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const eu=kk();function kk(){const n=new ArrayBuffer(4),e=new Float32Array(n),t=new Uint32Array(n),i=new Uint32Array(512),a=new Uint32Array(512);for(let l=0;l<256;++l){const c=l-127;c<-27?(i[l]=0,i[l|256]=32768,a[l]=24,a[l|256]=24):c<-14?(i[l]=1024>>-c-14,i[l|256]=1024>>-c-14|32768,a[l]=-c-1,a[l|256]=-c-1):c<=15?(i[l]=c+15<<10,i[l|256]=c+15<<10|32768,a[l]=13,a[l|256]=13):c<128?(i[l]=31744,i[l|256]=64512,a[l]=24,a[l|256]=24):(i[l]=31744,i[l|256]=64512,a[l]=13,a[l|256]=13)}const o=new Uint32Array(2048),r=new Uint32Array(64),s=new Uint32Array(64);for(let l=1;l<1024;++l){let c=l<<13,u=0;for(;(c&8388608)===0;)c<<=1,u-=8388608;c&=-8388609,u+=947912704,o[l]=c|u}for(let l=1024;l<2048;++l)o[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)r[l]=l<<23;r[31]=1199570944,r[32]=2147483648;for(let l=33;l<63;++l)r[l]=2147483648+(l-32<<23);r[63]=3347054592;for(let l=1;l<64;++l)l!==32&&(s[l]=1024);return{floatView:e,uint32View:t,baseTable:i,shiftTable:a,mantissaTable:o,exponentTable:r,offsetTable:s}}function hs(n){Math.abs(n)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),n=jn(n,-65504,65504),eu.floatView[0]=n;const e=eu.uint32View[0],t=e>>23&511;return eu.baseTable[t]+((e&8388607)>>eu.shiftTable[t])}function Pm(n){const e=n>>10;return eu.uint32View[0]=eu.mantissaTable[eu.offsetTable[e]+(n&1023)]+eu.exponentTable[e],eu.floatView[0]}class PC{static toHalfFloat(e){return hs(e)}static fromHalfFloat(e){return Pm(e)}}const qa=new Be,rv=new Xt;let Pk=0;class Mi{constructor(e,t,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:Pk++}),this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=i,this.usage=wp,this.updateRanges=[],this.gpuType=ma,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,i){e*=this.itemSize,i*=t.itemSize;for(let a=0,o=this.itemSize;a<o;a++)this.array[e+a]=t.array[i+a];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,i=this.count;t<i;t++)rv.fromBufferAttribute(this,t),rv.applyMatrix3(e),this.setXY(t,rv.x,rv.y);else if(this.itemSize===3)for(let t=0,i=this.count;t<i;t++)qa.fromBufferAttribute(this,t),qa.applyMatrix3(e),this.setXYZ(t,qa.x,qa.y,qa.z);return this}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)qa.fromBufferAttribute(this,t),qa.applyMatrix4(e),this.setXYZ(t,qa.x,qa.y,qa.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)qa.fromBufferAttribute(this,t),qa.applyNormalMatrix(e),this.setXYZ(t,qa.x,qa.y,qa.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)qa.fromBufferAttribute(this,t),qa.transformDirection(e),this.setXYZ(t,qa.x,qa.y,qa.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let i=this.array[e*this.itemSize+t];return this.normalized&&(i=Dr(i,this.array)),i}setComponent(e,t,i){return this.normalized&&(i=ni(i,this.array)),this.array[e*this.itemSize+t]=i,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Dr(t,this.array)),t}setX(e,t){return this.normalized&&(t=ni(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Dr(t,this.array)),t}setY(e,t){return this.normalized&&(t=ni(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Dr(t,this.array)),t}setZ(e,t){return this.normalized&&(t=ni(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Dr(t,this.array)),t}setW(e,t){return this.normalized&&(t=ni(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=ni(t,this.array),i=ni(i,this.array)),this.array[e+0]=t,this.array[e+1]=i,this}setXYZ(e,t,i,a){return e*=this.itemSize,this.normalized&&(t=ni(t,this.array),i=ni(i,this.array),a=ni(a,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=a,this}setXYZW(e,t,i,a,o){return e*=this.itemSize,this.normalized&&(t=ni(t,this.array),i=ni(i,this.array),a=ni(a,this.array),o=ni(o,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=a,this.array[e+3]=o,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==wp&&(e.usage=this.usage),e}}class Jk extends Mi{constructor(e,t,i){super(new Int8Array(e),t,i)}}class jk extends Mi{constructor(e,t,i){super(new Uint8Array(e),t,i)}}class Qk extends Mi{constructor(e,t,i){super(new Uint8ClampedArray(e),t,i)}}class qk extends Mi{constructor(e,t,i){super(new Int16Array(e),t,i)}}class sx extends Mi{constructor(e,t,i){super(new Uint16Array(e),t,i)}}class $k extends Mi{constructor(e,t,i){super(new Int32Array(e),t,i)}}class lx extends Mi{constructor(e,t,i){super(new Uint32Array(e),t,i)}}class eP extends Mi{constructor(e,t,i){super(new Uint16Array(e),t,i),this.isFloat16BufferAttribute=!0}getX(e){let t=Pm(this.array[e*this.itemSize]);return this.normalized&&(t=Dr(t,this.array)),t}setX(e,t){return this.normalized&&(t=ni(t,this.array)),this.array[e*this.itemSize]=hs(t),this}getY(e){let t=Pm(this.array[e*this.itemSize+1]);return this.normalized&&(t=Dr(t,this.array)),t}setY(e,t){return this.normalized&&(t=ni(t,this.array)),this.array[e*this.itemSize+1]=hs(t),this}getZ(e){let t=Pm(this.array[e*this.itemSize+2]);return this.normalized&&(t=Dr(t,this.array)),t}setZ(e,t){return this.normalized&&(t=ni(t,this.array)),this.array[e*this.itemSize+2]=hs(t),this}getW(e){let t=Pm(this.array[e*this.itemSize+3]);return this.normalized&&(t=Dr(t,this.array)),t}setW(e,t){return this.normalized&&(t=ni(t,this.array)),this.array[e*this.itemSize+3]=hs(t),this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=ni(t,this.array),i=ni(i,this.array)),this.array[e+0]=hs(t),this.array[e+1]=hs(i),this}setXYZ(e,t,i,a){return e*=this.itemSize,this.normalized&&(t=ni(t,this.array),i=ni(i,this.array),a=ni(a,this.array)),this.array[e+0]=hs(t),this.array[e+1]=hs(i),this.array[e+2]=hs(a),this}setXYZW(e,t,i,a,o){return e*=this.itemSize,this.normalized&&(t=ni(t,this.array),i=ni(i,this.array),a=ni(a,this.array),o=ni(o,this.array)),this.array[e+0]=hs(t),this.array[e+1]=hs(i),this.array[e+2]=hs(a),this.array[e+3]=hs(o),this}}class Sn extends Mi{constructor(e,t,i){super(new Float32Array(e),t,i)}}let tP=0;const Cl=new Vn,H2=new Ii,Vh=new Be,Ys=new Wo,ym=new Wo,wo=new Be;class $n extends pg{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:tP++}),this.uuid=Os(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(W9(e)?lx:sx)(e,1):this.index=e,this}setIndirect(e){return this.indirect=e,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,i=0){this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const i=this.attributes.normal;if(i!==void 0){const o=new Jn().getNormalMatrix(e);i.applyNormalMatrix(o),i.needsUpdate=!0}const a=this.attributes.tangent;return a!==void 0&&(a.transformDirection(e),a.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return Cl.makeRotationFromQuaternion(e),this.applyMatrix4(Cl),this}rotateX(e){return Cl.makeRotationX(e),this.applyMatrix4(Cl),this}rotateY(e){return Cl.makeRotationY(e),this.applyMatrix4(Cl),this}rotateZ(e){return Cl.makeRotationZ(e),this.applyMatrix4(Cl),this}translate(e,t,i){return Cl.makeTranslation(e,t,i),this.applyMatrix4(Cl),this}scale(e,t,i){return Cl.makeScale(e,t,i),this.applyMatrix4(Cl),this}lookAt(e){return H2.lookAt(e),H2.updateMatrix(),this.applyMatrix4(H2.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Vh).negate(),this.translate(Vh.x,Vh.y,Vh.z),this}setFromPoints(e){const t=this.getAttribute("position");if(t===void 0){const i=[];for(let a=0,o=e.length;a<o;a++){const r=e[a];i.push(r.x,r.y,r.z||0)}this.setAttribute("position",new Sn(i,3))}else{const i=Math.min(e.length,t.count);for(let a=0;a<i;a++){const o=e[a];t.setXYZ(a,o.x,o.y,o.z||0)}e.length>t.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),t.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Wo);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new Be(-1/0,-1/0,-1/0),new Be(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let i=0,a=t.length;i<a;i++){const o=t[i];Ys.setFromBufferAttribute(o),this.morphTargetsRelative?(wo.addVectors(this.boundingBox.min,Ys.min),this.boundingBox.expandByPoint(wo),wo.addVectors(this.boundingBox.max,Ys.max),this.boundingBox.expandByPoint(wo)):(this.boundingBox.expandByPoint(Ys.min),this.boundingBox.expandByPoint(Ys.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Vo);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new Be,1/0);return}if(e){const i=this.boundingSphere.center;if(Ys.setFromBufferAttribute(e),t)for(let o=0,r=t.length;o<r;o++){const s=t[o];ym.setFromBufferAttribute(s),this.morphTargetsRelative?(wo.addVectors(Ys.min,ym.min),Ys.expandByPoint(wo),wo.addVectors(Ys.max,ym.max),Ys.expandByPoint(wo)):(Ys.expandByPoint(ym.min),Ys.expandByPoint(ym.max))}Ys.getCenter(i);let a=0;for(let o=0,r=e.count;o<r;o++)wo.fromBufferAttribute(e,o),a=Math.max(a,i.distanceToSquared(wo));if(t)for(let o=0,r=t.length;o<r;o++){const s=t[o],l=this.morphTargetsRelative;for(let c=0,u=s.count;c<u;c++)wo.fromBufferAttribute(s,c),l&&(Vh.fromBufferAttribute(e,c),wo.add(Vh)),a=Math.max(a,i.distanceToSquared(wo))}this.boundingSphere.radius=Math.sqrt(a),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const i=t.position,a=t.normal,o=t.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Mi(new Float32Array(4*i.count),4));const r=this.getAttribute("tangent"),s=[],l=[];for(let F=0;F<i.count;F++)s[F]=new Be,l[F]=new Be;const c=new Be,u=new Be,C=new Be,h=new Xt,m=new Xt,p=new Xt,B=new Be,b=new Be;function y(F,N,H){c.fromBufferAttribute(i,F),u.fromBufferAttribute(i,N),C.fromBufferAttribute(i,H),h.fromBufferAttribute(o,F),m.fromBufferAttribute(o,N),p.fromBufferAttribute(o,H),u.sub(c),C.sub(c),m.sub(h),p.sub(h);const z=1/(m.x*p.y-p.x*m.y);isFinite(z)&&(B.copy(u).multiplyScalar(p.y).addScaledVector(C,-m.y).multiplyScalar(z),b.copy(C).multiplyScalar(m.x).addScaledVector(u,-p.x).multiplyScalar(z),s[F].add(B),s[N].add(B),s[H].add(B),l[F].add(b),l[N].add(b),l[H].add(b))}let S=this.groups;S.length===0&&(S=[{start:0,count:e.count}]);for(let F=0,N=S.length;F<N;++F){const H=S[F],z=H.start,_=H.count;for(let D=z,P=z+_;D<P;D+=3)y(e.getX(D+0),e.getX(D+1),e.getX(D+2))}const R=new Be,Z=new Be,x=new Be,M=new Be;function E(F){x.fromBufferAttribute(a,F),M.copy(x);const N=s[F];R.copy(N),R.sub(x.multiplyScalar(x.dot(N))).normalize(),Z.crossVectors(M,N);const z=Z.dot(l[F])<0?-1:1;r.setXYZW(F,R.x,R.y,R.z,z)}for(let F=0,N=S.length;F<N;++F){const H=S[F],z=H.start,_=H.count;for(let D=z,P=z+_;D<P;D+=3)E(e.getX(D+0)),E(e.getX(D+1)),E(e.getX(D+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new Mi(new Float32Array(t.count*3),3),this.setAttribute("normal",i);else for(let h=0,m=i.count;h<m;h++)i.setXYZ(h,0,0,0);const a=new Be,o=new Be,r=new Be,s=new Be,l=new Be,c=new Be,u=new Be,C=new Be;if(e)for(let h=0,m=e.count;h<m;h+=3){const p=e.getX(h+0),B=e.getX(h+1),b=e.getX(h+2);a.fromBufferAttribute(t,p),o.fromBufferAttribute(t,B),r.fromBufferAttribute(t,b),u.subVectors(r,o),C.subVectors(a,o),u.cross(C),s.fromBufferAttribute(i,p),l.fromBufferAttribute(i,B),c.fromBufferAttribute(i,b),s.add(u),l.add(u),c.add(u),i.setXYZ(p,s.x,s.y,s.z),i.setXYZ(B,l.x,l.y,l.z),i.setXYZ(b,c.x,c.y,c.z)}else for(let h=0,m=t.count;h<m;h+=3)a.fromBufferAttribute(t,h+0),o.fromBufferAttribute(t,h+1),r.fromBufferAttribute(t,h+2),u.subVectors(r,o),C.subVectors(a,o),u.cross(C),i.setXYZ(h+0,u.x,u.y,u.z),i.setXYZ(h+1,u.x,u.y,u.z),i.setXYZ(h+2,u.x,u.y,u.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,i=e.count;t<i;t++)wo.fromBufferAttribute(e,t),wo.normalize(),e.setXYZ(t,wo.x,wo.y,wo.z)}toNonIndexed(){function e(s,l){const c=s.array,u=s.itemSize,C=s.normalized,h=new c.constructor(l.length*u);let m=0,p=0;for(let B=0,b=l.length;B<b;B++){s.isInterleavedBufferAttribute?m=l[B]*s.data.stride+s.offset:m=l[B]*u;for(let y=0;y<u;y++)h[p++]=c[m++]}return new Mi(h,u,C)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new $n,i=this.index.array,a=this.attributes;for(const s in a){const l=a[s],c=e(l,i);t.setAttribute(s,c)}const o=this.morphAttributes;for(const s in o){const l=[],c=o[s];for(let u=0,C=c.length;u<C;u++){const h=c[u],m=e(h,i);l.push(m)}t.morphAttributes[s]=l}t.morphTargetsRelative=this.morphTargetsRelative;const r=this.groups;for(let s=0,l=r.length;s<l;s++){const c=r[s];t.addGroup(c.start,c.count,c.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const l=this.parameters;for(const c in l)l[c]!==void 0&&(e[c]=l[c]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const i=this.attributes;for(const l in i){const c=i[l];e.data.attributes[l]=c.toJSON(e.data)}const a={};let o=!1;for(const l in this.morphAttributes){const c=this.morphAttributes[l],u=[];for(let C=0,h=c.length;C<h;C++){const m=c[C];u.push(m.toJSON(e.data))}u.length>0&&(a[l]=u,o=!0)}o&&(e.data.morphAttributes=a,e.data.morphTargetsRelative=this.morphTargetsRelative);const r=this.groups;r.length>0&&(e.data.groups=JSON.parse(JSON.stringify(r)));const s=this.boundingSphere;return s!==null&&(e.data.boundingSphere={center:s.center.toArray(),radius:s.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const i=e.index;i!==null&&this.setIndex(i.clone());const a=e.attributes;for(const c in a){const u=a[c];this.setAttribute(c,u.clone(t))}const o=e.morphAttributes;for(const c in o){const u=[],C=o[c];for(let h=0,m=C.length;h<m;h++)u.push(C[h].clone(t));this.morphAttributes[c]=u}this.morphTargetsRelative=e.morphTargetsRelative;const r=e.groups;for(let c=0,u=r.length;c<u;c++){const C=r[c];this.addGroup(C.start,C.count,C.materialIndex)}const s=e.boundingBox;s!==null&&(this.boundingBox=s.clone());const l=e.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const GV=new Vn,mC=new pI,sv=new Vo,SV=new Be,lv=new Be,cv=new Be,gv=new Be,F2=new Be,uv=new Be,wV=new Be,dv=new Be;class $i extends Ii{constructor(e=new $n,t=new Or){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const a=t[i[0]];if(a!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,r=a.length;o<r;o++){const s=a[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[s]=o}}}}getVertexPosition(e,t){const i=this.geometry,a=i.attributes.position,o=i.morphAttributes.position,r=i.morphTargetsRelative;t.fromBufferAttribute(a,e);const s=this.morphTargetInfluences;if(o&&s){uv.set(0,0,0);for(let l=0,c=o.length;l<c;l++){const u=s[l],C=o[l];u!==0&&(F2.fromBufferAttribute(C,e),r?uv.addScaledVector(F2,u):uv.addScaledVector(F2.sub(t),u))}t.add(uv)}return t}raycast(e,t){const i=this.geometry,a=this.material,o=this.matrixWorld;a!==void 0&&(i.boundingSphere===null&&i.computeBoundingSphere(),sv.copy(i.boundingSphere),sv.applyMatrix4(o),mC.copy(e.ray).recast(e.near),!(sv.containsPoint(mC.origin)===!1&&(mC.intersectSphere(sv,SV)===null||mC.origin.distanceToSquared(SV)>(e.far-e.near)**2))&&(GV.copy(o).invert(),mC.copy(e.ray).applyMatrix4(GV),!(i.boundingBox!==null&&mC.intersectsBox(i.boundingBox)===!1)&&this._computeIntersections(e,t,mC)))}_computeIntersections(e,t,i){let a;const o=this.geometry,r=this.material,s=o.index,l=o.attributes.position,c=o.attributes.uv,u=o.attributes.uv1,C=o.attributes.normal,h=o.groups,m=o.drawRange;if(s!==null)if(Array.isArray(r))for(let p=0,B=h.length;p<B;p++){const b=h[p],y=r[b.materialIndex],S=Math.max(b.start,m.start),R=Math.min(s.count,Math.min(b.start+b.count,m.start+m.count));for(let Z=S,x=R;Z<x;Z+=3){const M=s.getX(Z),E=s.getX(Z+1),F=s.getX(Z+2);a=Cv(this,y,e,i,c,u,C,M,E,F),a&&(a.faceIndex=Math.floor(Z/3),a.face.materialIndex=b.materialIndex,t.push(a))}}else{const p=Math.max(0,m.start),B=Math.min(s.count,m.start+m.count);for(let b=p,y=B;b<y;b+=3){const S=s.getX(b),R=s.getX(b+1),Z=s.getX(b+2);a=Cv(this,r,e,i,c,u,C,S,R,Z),a&&(a.faceIndex=Math.floor(b/3),t.push(a))}}else if(l!==void 0)if(Array.isArray(r))for(let p=0,B=h.length;p<B;p++){const b=h[p],y=r[b.materialIndex],S=Math.max(b.start,m.start),R=Math.min(l.count,Math.min(b.start+b.count,m.start+m.count));for(let Z=S,x=R;Z<x;Z+=3){const M=Z,E=Z+1,F=Z+2;a=Cv(this,y,e,i,c,u,C,M,E,F),a&&(a.faceIndex=Math.floor(Z/3),a.face.materialIndex=b.materialIndex,t.push(a))}}else{const p=Math.max(0,m.start),B=Math.min(l.count,m.start+m.count);for(let b=p,y=B;b<y;b+=3){const S=b,R=b+1,Z=b+2;a=Cv(this,r,e,i,c,u,C,S,R,Z),a&&(a.faceIndex=Math.floor(b/3),t.push(a))}}}}function nP(n,e,t,i,a,o,r,s){let l;if(e.side===fr?l=i.intersectTriangle(r,o,a,!0,s):l=i.intersectTriangle(a,o,r,e.side===dg,s),l===null)return null;dv.copy(s),dv.applyMatrix4(n.matrixWorld);const c=t.ray.origin.distanceTo(dv);return c<t.near||c>t.far?null:{distance:c,point:dv.clone(),object:n}}function Cv(n,e,t,i,a,o,r,s,l,c){n.getVertexPosition(s,lv),n.getVertexPosition(l,cv),n.getVertexPosition(c,gv);const u=nP(n,e,t,i,lv,cv,gv,wV);if(u){const C=new Be;ps.getBarycoord(wV,lv,cv,gv,C),a&&(u.uv=ps.getInterpolatedAttribute(a,s,l,c,C,new Xt)),o&&(u.uv1=ps.getInterpolatedAttribute(o,s,l,c,C,new Xt)),r&&(u.normal=ps.getInterpolatedAttribute(r,s,l,c,C,new Be),u.normal.dot(i.direction)>0&&u.normal.multiplyScalar(-1));const h={a:s,b:l,c,normal:new Be,materialIndex:0};ps.getNormal(lv,cv,gv,h.normal),u.face=h,u.barycoord=C}return u}class wd extends $n{constructor(e=1,t=1,i=1,a=1,o=1,r=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:a,heightSegments:o,depthSegments:r};const s=this;a=Math.floor(a),o=Math.floor(o),r=Math.floor(r);const l=[],c=[],u=[],C=[];let h=0,m=0;p("z","y","x",-1,-1,i,t,e,r,o,0),p("z","y","x",1,-1,i,t,-e,r,o,1),p("x","z","y",1,1,e,i,t,a,r,2),p("x","z","y",1,-1,e,i,-t,a,r,3),p("x","y","z",1,-1,e,t,i,a,o,4),p("x","y","z",-1,-1,e,t,-i,a,o,5),this.setIndex(l),this.setAttribute("position",new Sn(c,3)),this.setAttribute("normal",new Sn(u,3)),this.setAttribute("uv",new Sn(C,2));function p(B,b,y,S,R,Z,x,M,E,F,N){const H=Z/E,z=x/F,_=Z/2,D=x/2,P=M/2,$=E+1,X=F+1;let L=0,U=0;const q=new Be;for(let K=0;K<X;K++){const O=K*z-D;for(let j=0;j<$;j++){const ne=j*H-_;q[B]=ne*S,q[b]=O*R,q[y]=P,c.push(q.x,q.y,q.z),q[B]=0,q[b]=0,q[y]=M>0?1:-1,u.push(q.x,q.y,q.z),C.push(j/E),C.push(1-K/F),L+=1}}for(let K=0;K<F;K++)for(let O=0;O<E;O++){const j=h+O+$*K,ne=h+O+$*(K+1),k=h+(O+1)+$*(K+1),ie=h+(O+1)+$*K;l.push(j,ne,ie),l.push(ne,k,ie),U+=6}s.addGroup(m,U,N),m+=U,h+=L}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new wd(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Rf(n){const e={};for(const t in n){e[t]={};for(const i in n[t]){const a=n[t][i];a&&(a.isColor||a.isMatrix3||a.isMatrix4||a.isVector2||a.isVector3||a.isVector4||a.isTexture||a.isQuaternion)?a.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][i]=null):e[t][i]=a.clone():Array.isArray(a)?e[t][i]=a.slice():e[t][i]=a}}return e}function zr(n){const e={};for(let t=0;t<n.length;t++){const i=Rf(n[t]);for(const a in i)e[a]=i[a]}return e}function iP(n){const e=[];for(let t=0;t<n.length;t++)e.push(n[t].clone());return e}function H9(n){const e=n.getRenderTarget();return e===null?n.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:vi.workingColorSpace}const yG={clone:Rf,merge:zr};var aP=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,oP=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class Ur extends ho{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=aP,this.fragmentShader=oP,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Rf(e.uniforms),this.uniformsGroups=iP(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const a in this.uniforms){const r=this.uniforms[a].value;r&&r.isTexture?t.uniforms[a]={type:"t",value:r.toJSON(e).uuid}:r&&r.isColor?t.uniforms[a]={type:"c",value:r.getHex()}:r&&r.isVector2?t.uniforms[a]={type:"v2",value:r.toArray()}:r&&r.isVector3?t.uniforms[a]={type:"v3",value:r.toArray()}:r&&r.isVector4?t.uniforms[a]={type:"v4",value:r.toArray()}:r&&r.isMatrix3?t.uniforms[a]={type:"m3",value:r.toArray()}:r&&r.isMatrix4?t.uniforms[a]={type:"m4",value:r.toArray()}:t.uniforms[a]={value:r}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const i={};for(const a in this.extensions)this.extensions[a]===!0&&(i[a]=!0);return Object.keys(i).length>0&&(t.extensions=i),t}}class BG extends Ii{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Vn,this.projectionMatrix=new Vn,this.projectionMatrixInverse=new Vn,this.coordinateSystem=cc}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const od=new Be,RV=new Xt,ZV=new Xt;let fa=class extends BG{constructor(e=50,t=1,i=.1,a=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=a,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=Sf*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(tI*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return Sf*2*Math.atan(Math.tan(tI*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,i){od.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(od.x,od.y).multiplyScalar(-e/od.z),od.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),i.set(od.x,od.y).multiplyScalar(-e/od.z)}getViewSize(e,t){return this.getViewBounds(e,RV,ZV),t.subVectors(ZV,RV)}setViewOffset(e,t,i,a,o,r){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=a,this.view.width=o,this.view.height=r,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(tI*.5*this.fov)/this.zoom,i=2*t,a=this.aspect*i,o=-.5*a;const r=this.view;if(this.view!==null&&this.view.enabled){const l=r.fullWidth,c=r.fullHeight;o+=r.offsetX*a/l,t-=r.offsetY*i/c,a*=r.width/l,i*=r.height/c}const s=this.filmOffset;s!==0&&(o+=e*s/this.getFilmWidth()),this.projectionMatrix.makePerspective(o,o+a,t,t-i,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}};const Nh=-90,Eh=1;class F9 extends Ii{constructor(e,t,i){super(),this.type="CubeCamera",this.renderTarget=i,this.coordinateSystem=null,this.activeMipmapLevel=0;const a=new fa(Nh,Eh,e,t);a.layers=this.layers,this.add(a);const o=new fa(Nh,Eh,e,t);o.layers=this.layers,this.add(o);const r=new fa(Nh,Eh,e,t);r.layers=this.layers,this.add(r);const s=new fa(Nh,Eh,e,t);s.layers=this.layers,this.add(s);const l=new fa(Nh,Eh,e,t);l.layers=this.layers,this.add(l);const c=new fa(Nh,Eh,e,t);c.layers=this.layers,this.add(c)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[i,a,o,r,s,l]=t;for(const c of t)this.remove(c);if(e===cc)i.up.set(0,1,0),i.lookAt(1,0,0),a.up.set(0,1,0),a.lookAt(-1,0,0),o.up.set(0,0,-1),o.lookAt(0,1,0),r.up.set(0,0,1),r.lookAt(0,-1,0),s.up.set(0,1,0),s.lookAt(0,0,1),l.up.set(0,1,0),l.lookAt(0,0,-1);else if(e===Rp)i.up.set(0,-1,0),i.lookAt(-1,0,0),a.up.set(0,-1,0),a.lookAt(1,0,0),o.up.set(0,0,1),o.lookAt(0,1,0),r.up.set(0,0,-1),r.lookAt(0,-1,0),s.up.set(0,-1,0),s.lookAt(0,0,1),l.up.set(0,-1,0),l.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const c of t)this.add(c),c.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();const{renderTarget:i,activeMipmapLevel:a}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[o,r,s,l,c,u]=this.children,C=e.getRenderTarget(),h=e.getActiveCubeFace(),m=e.getActiveMipmapLevel(),p=e.xr.enabled;e.xr.enabled=!1;const B=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0,a),e.render(t,o),e.setRenderTarget(i,1,a),e.render(t,r),e.setRenderTarget(i,2,a),e.render(t,s),e.setRenderTarget(i,3,a),e.render(t,l),e.setRenderTarget(i,4,a),e.render(t,c),i.texture.generateMipmaps=B,e.setRenderTarget(i,5,a),e.render(t,u),e.setRenderTarget(C,h,m),e.xr.enabled=p,i.texture.needsPMREMUpdate=!0}}class rb extends Fi{constructor(e=[],t=Cg,i,a,o,r,s,l,c,u){super(e,t,i,a,o,r,s,l,c,u),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class cx extends Us{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const i={width:e,height:e,depth:1},a=[i,i,i,i,i,i];this.texture=new rb(a,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:Bi}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const i={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},a=new wd(5,5,5),o=new Ur({name:"CubemapFromEquirect",uniforms:Rf(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:fr,blending:sg});o.uniforms.tEquirect.value=t;const r=new $i(a,o),s=t.minFilter;return t.minFilter===pl&&(t.minFilter=Bi),new F9(1,10,this).update(e,r),t.minFilter=s,r.geometry.dispose(),r.material.dispose(),this}clear(e,t=!0,i=!0,a=!0){const o=e.getRenderTarget();for(let r=0;r<6;r++)e.setRenderTarget(this,r),e.clear(t,i,a);e.setRenderTarget(o)}}let tu=class extends Ii{constructor(){super(),this.isGroup=!0,this.type="Group"}};const rP={type:"move"};class By{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new tu,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new tu,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Be,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Be),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new tu,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Be,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Be),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const i of e.hand.values())this._getHandJoint(t,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,i){let a=null,o=null,r=null;const s=this._targetRay,l=this._grip,c=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(c&&e.hand){r=!0;for(const B of e.hand.values()){const b=t.getJointPose(B,i),y=this._getHandJoint(c,B);b!==null&&(y.matrix.fromArray(b.transform.matrix),y.matrix.decompose(y.position,y.rotation,y.scale),y.matrixWorldNeedsUpdate=!0,y.jointRadius=b.radius),y.visible=b!==null}const u=c.joints["index-finger-tip"],C=c.joints["thumb-tip"],h=u.position.distanceTo(C.position),m=.02,p=.005;c.inputState.pinching&&h>m+p?(c.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!c.inputState.pinching&&h<=m-p&&(c.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else l!==null&&e.gripSpace&&(o=t.getPose(e.gripSpace,i),o!==null&&(l.matrix.fromArray(o.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,o.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(o.linearVelocity)):l.hasLinearVelocity=!1,o.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(o.angularVelocity)):l.hasAngularVelocity=!1));s!==null&&(a=t.getPose(e.targetRaySpace,i),a===null&&o!==null&&(a=o),a!==null&&(s.matrix.fromArray(a.transform.matrix),s.matrix.decompose(s.position,s.rotation,s.scale),s.matrixWorldNeedsUpdate=!0,a.linearVelocity?(s.hasLinearVelocity=!0,s.linearVelocity.copy(a.linearVelocity)):s.hasLinearVelocity=!1,a.angularVelocity?(s.hasAngularVelocity=!0,s.angularVelocity.copy(a.angularVelocity)):s.hasAngularVelocity=!1,this.dispatchEvent(rP)))}return s!==null&&(s.visible=a!==null),l!==null&&(l.visible=o!==null),c!==null&&(c.visible=r!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const i=new tu;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[t.jointName]=i,e.add(i)}return e.joints[t.jointName]}}class GG{constructor(e,t=25e-5){this.isFogExp2=!0,this.name="",this.color=new dn(e),this.density=t}clone(){return new GG(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class SG{constructor(e,t=1,i=1e3){this.isFog=!0,this.name="",this.color=new dn(e),this.near=t,this.far=i}clone(){return new SG(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class sb extends Ii{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new ys,this.environmentIntensity=1,this.environmentRotation=new ys,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}}class lb{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=wp,this.updateRanges=[],this.version=0,this.uuid=Os()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,i){e*=this.stride,i*=t.stride;for(let a=0,o=this.stride;a<o;a++)this.array[e+a]=t.array[i+a];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Os()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(t,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Os()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Yr=new Be;class vd{constructor(e,t,i,a=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=i,this.normalized=a}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,i=this.data.count;t<i;t++)Yr.fromBufferAttribute(this,t),Yr.applyMatrix4(e),this.setXYZ(t,Yr.x,Yr.y,Yr.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)Yr.fromBufferAttribute(this,t),Yr.applyNormalMatrix(e),this.setXYZ(t,Yr.x,Yr.y,Yr.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)Yr.fromBufferAttribute(this,t),Yr.transformDirection(e),this.setXYZ(t,Yr.x,Yr.y,Yr.z);return this}getComponent(e,t){let i=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(i=Dr(i,this.array)),i}setComponent(e,t,i){return this.normalized&&(i=ni(i,this.array)),this.data.array[e*this.data.stride+this.offset+t]=i,this}setX(e,t){return this.normalized&&(t=ni(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=ni(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=ni(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=ni(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=Dr(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=Dr(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=Dr(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=Dr(t,this.array)),t}setXY(e,t,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=ni(t,this.array),i=ni(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this}setXYZ(e,t,i,a){return e=e*this.data.stride+this.offset,this.normalized&&(t=ni(t,this.array),i=ni(i,this.array),a=ni(a,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=a,this}setXYZW(e,t,i,a,o){return e=e*this.data.stride+this.offset,this.normalized&&(t=ni(t,this.array),i=ni(i,this.array),a=ni(a,this.array),o=ni(o,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=a,this.data.array[e+3]=o,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const a=i*this.data.stride+this.offset;for(let o=0;o<this.itemSize;o++)t.push(this.data.array[a+o])}return new Mi(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new vd(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const a=i*this.data.stride+this.offset;for(let o=0;o<this.itemSize;o++)t.push(this.data.array[a+o])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class gx extends ho{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new dn(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let Hh;const Bm=new Be,Fh=new Be,Xh=new Be,Th=new Xt,Gm=new Xt,X9=new Vn,Iv=new Be,Sm=new Be,hv=new Be,xV=new Xt,X2=new Xt,MV=new Xt;class T9 extends Ii{constructor(e=new gx){if(super(),this.isSprite=!0,this.type="Sprite",Hh===void 0){Hh=new $n;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),i=new lb(t,5);Hh.setIndex([0,1,2,0,2,3]),Hh.setAttribute("position",new vd(i,3,0,!1)),Hh.setAttribute("uv",new vd(i,2,3,!1))}this.geometry=Hh,this.material=e,this.center=new Xt(.5,.5)}raycast(e,t){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Fh.setFromMatrixScale(this.matrixWorld),X9.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Xh.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Fh.multiplyScalar(-Xh.z);const i=this.material.rotation;let a,o;i!==0&&(o=Math.cos(i),a=Math.sin(i));const r=this.center;fv(Iv.set(-.5,-.5,0),Xh,r,Fh,a,o),fv(Sm.set(.5,-.5,0),Xh,r,Fh,a,o),fv(hv.set(.5,.5,0),Xh,r,Fh,a,o),xV.set(0,0),X2.set(1,0),MV.set(1,1);let s=e.ray.intersectTriangle(Iv,Sm,hv,!1,Bm);if(s===null&&(fv(Sm.set(-.5,.5,0),Xh,r,Fh,a,o),X2.set(0,1),s=e.ray.intersectTriangle(Iv,hv,Sm,!1,Bm),s===null))return;const l=e.ray.origin.distanceTo(Bm);l<e.near||l>e.far||t.push({distance:l,point:Bm.clone(),uv:ps.getInterpolation(Bm,Iv,Sm,hv,xV,X2,MV,new Xt),face:null,object:this})}copy(e,t){return super.copy(e,t),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function fv(n,e,t,i,a,o){Th.subVectors(n,t).addScalar(.5).multiply(i),a!==void 0?(Gm.x=o*Th.x-a*Th.y,Gm.y=a*Th.x+o*Th.y):Gm.copy(Th),n.copy(e),n.x+=Gm.x,n.y+=Gm.y,n.applyMatrix4(X9)}const Av=new Be,WV=new Be;class Y9 extends Ii{constructor(){super(),this.isLOD=!0,this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let i=0,a=t.length;i<a;i++){const o=t[i];this.addLevel(o.object.clone(),o.distance,o.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0,i=0){t=Math.abs(t);const a=this.levels;let o;for(o=0;o<a.length&&!(t<a[o].distance);o++);return a.splice(o,0,{distance:t,hysteresis:i,object:e}),this.add(e),this}removeLevel(e){const t=this.levels;for(let i=0;i<t.length;i++)if(t[i].distance===e){const a=t.splice(i,1);return this.remove(a[0].object),!0}return!1}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let i,a;for(i=1,a=t.length;i<a;i++){let o=t[i].distance;if(t[i].object.visible&&(o-=o*t[i].hysteresis),e<o)break}return t[i-1].object}return null}raycast(e,t){if(this.levels.length>0){Av.setFromMatrixPosition(this.matrixWorld);const a=e.ray.origin.distanceTo(Av);this.getObjectForDistance(a).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){Av.setFromMatrixPosition(e.matrixWorld),WV.setFromMatrixPosition(this.matrixWorld);const i=Av.distanceTo(WV)/e.zoom;t[0].object.visible=!0;let a,o;for(a=1,o=t.length;a<o;a++){let r=t[a].distance;if(t[a].object.visible&&(r-=r*t[a].hysteresis),i>=r)t[a-1].object.visible=!1,t[a].object.visible=!0;else break}for(this._currentLevel=a-1;a<o;a++)t[a].object.visible=!1}}toJSON(e){const t=super.toJSON(e);this.autoUpdate===!1&&(t.object.autoUpdate=!1),t.object.levels=[];const i=this.levels;for(let a=0,o=i.length;a<o;a++){const r=i[a];t.object.levels.push({object:r.object.uuid,distance:r.distance,hysteresis:r.hysteresis})}return t}}const VV=new Be,NV=new yi,EV=new yi,sP=new Be,HV=new Vn,mv=new Be,T2=new Vo,FV=new Vn,Y2=new pI;class ux extends $i{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=D1,this.bindMatrix=new Vn,this.bindMatrixInverse=new Vn,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new Wo),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let i=0;i<t.count;i++)this.getVertexPosition(i,mv),this.boundingBox.expandByPoint(mv)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new Vo),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let i=0;i<t.count;i++)this.getVertexPosition(i,mv),this.boundingSphere.expandByPoint(mv)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const i=this.material,a=this.matrixWorld;i!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),T2.copy(this.boundingSphere),T2.applyMatrix4(a),e.ray.intersectsSphere(T2)!==!1&&(FV.copy(a).invert(),Y2.copy(e.ray).applyMatrix4(FV),!(this.boundingBox!==null&&Y2.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,t,Y2)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new yi,t=this.geometry.attributes.skinWeight;for(let i=0,a=t.count;i<a;i++){e.fromBufferAttribute(t,i);const o=1/e.manhattanLength();o!==1/0?e.multiplyScalar(o):e.set(1,0,0,0),t.setXYZW(i,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===D1?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===h9?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const i=this.skeleton,a=this.geometry;NV.fromBufferAttribute(a.attributes.skinIndex,e),EV.fromBufferAttribute(a.attributes.skinWeight,e),VV.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let o=0;o<4;o++){const r=EV.getComponent(o);if(r!==0){const s=NV.getComponent(o);HV.multiplyMatrices(i.bones[s].matrixWorld,i.boneInverses[s]),t.addScaledVector(sP.copy(VV).applyMatrix4(HV),r)}}return t.applyMatrix4(this.bindMatrixInverse)}}class wG extends Ii{constructor(){super(),this.isBone=!0,this.type="Bone"}}class gc extends Fi{constructor(e=null,t=1,i=1,a,o,r,s,l,c=Mo,u=Mo,C,h){super(null,r,s,l,c,u,a,o,C,h),this.isDataTexture=!0,this.image={data:e,width:t,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const XV=new Vn,lP=new Vn;let dx=class z9{constructor(e=[],t=[]){this.uuid=Os(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let i=0,a=this.bones.length;i<a;i++)this.boneInverses.push(new Vn)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const i=new Vn;this.bones[e]&&i.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&i.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){const e=this.bones,t=this.boneInverses,i=this.boneMatrices,a=this.boneTexture;for(let o=0,r=e.length;o<r;o++){const s=e[o]?e[o].matrixWorld:lP;XV.multiplyMatrices(s,t[o]),XV.toArray(i,o*16)}a!==null&&(a.needsUpdate=!0)}clone(){return new z9(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const i=new gc(t,e,e,La,ma);return i.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=i,this}getBoneByName(e){for(let t=0,i=this.bones.length;t<i;t++){const a=this.bones[t];if(a.name===e)return a}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let i=0,a=e.bones.length;i<a;i++){const o=e.bones[i];let r=t[o];r===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",o),r=new wG),this.bones.push(r),this.boneInverses.push(new Vn().fromArray(e.boneInverses[i]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,i=this.boneInverses;for(let a=0,o=t.length;a<o;a++){const r=t[a];e.bones.push(r.uuid);const s=i[a];e.boneInverses.push(s.toArray())}return e}};class yd extends Mi{constructor(e,t,i,a=1){super(e,t,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=a}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const Yh=new Vn,TV=new Vn,pv=[],YV=new Wo,cP=new Vn,wm=new $i,Rm=new Vo;class nI extends $i{constructor(e,t,i){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new yd(new Float32Array(i*16),16),this.instanceColor=null,this.morphTexture=null,this.count=i,this.boundingBox=null,this.boundingSphere=null;for(let a=0;a<i;a++)this.setMatrixAt(a,cP)}computeBoundingBox(){const e=this.geometry,t=this.count;this.boundingBox===null&&(this.boundingBox=new Wo),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let i=0;i<t;i++)this.getMatrixAt(i,Yh),YV.copy(e.boundingBox).applyMatrix4(Yh),this.boundingBox.union(YV)}computeBoundingSphere(){const e=this.geometry,t=this.count;this.boundingSphere===null&&(this.boundingSphere=new Vo),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let i=0;i<t;i++)this.getMatrixAt(i,Yh),Rm.copy(e.boundingSphere).applyMatrix4(Yh),this.boundingSphere.union(Rm)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.morphTexture!==null&&(this.morphTexture=e.morphTexture.clone()),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}getMorphAt(e,t){const i=t.morphTargetInfluences,a=this.morphTexture.source.data.data,o=i.length+1,r=e*o+1;for(let s=0;s<i.length;s++)i[s]=a[r+s]}raycast(e,t){const i=this.matrixWorld,a=this.count;if(wm.geometry=this.geometry,wm.material=this.material,wm.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),Rm.copy(this.boundingSphere),Rm.applyMatrix4(i),e.ray.intersectsSphere(Rm)!==!1))for(let o=0;o<a;o++){this.getMatrixAt(o,Yh),TV.multiplyMatrices(i,Yh),wm.matrixWorld=TV,wm.raycast(e,pv);for(let r=0,s=pv.length;r<s;r++){const l=pv[r];l.instanceId=o,l.object=this,t.push(l)}pv.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new yd(new Float32Array(this.instanceMatrix.count*3).fill(1),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}setMorphAt(e,t){const i=t.morphTargetInfluences,a=i.length+1;this.morphTexture===null&&(this.morphTexture=new gc(new Float32Array(a*this.count),a,this.count,ib,ma));const o=this.morphTexture.source.data.data;let r=0;for(let c=0;c<i.length;c++)r+=i[c];const s=this.geometry.morphTargetsRelative?1:1-r,l=a*e;o[l]=s,o.set(i,l+1)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"}),this.morphTexture!==null&&(this.morphTexture.dispose(),this.morphTexture=null)}}const z2=new Be,gP=new Be,uP=new Jn;class qg{constructor(e=new Be(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,a){return this.normal.set(e,t,i),this.constant=a,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){const a=z2.subVectors(i,t).cross(gP.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(a,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const i=e.delta(z2),a=this.normal.dot(i);if(a===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const o=-(e.start.dot(this.normal)+this.constant)/a;return o<0||o>1?null:t.copy(e.start).addScaledVector(i,o)}intersectsLine(e){const t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const i=t||uP.getNormalMatrix(e),a=this.coplanarPoint(z2).applyMatrix4(e),o=this.normal.applyMatrix3(i).normalize();return this.constant=-a.dot(o),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const pC=new Vo,bv=new Be;class cb{constructor(e=new qg,t=new qg,i=new qg,a=new qg,o=new qg,r=new qg){this.planes=[e,t,i,a,o,r]}set(e,t,i,a,o,r){const s=this.planes;return s[0].copy(e),s[1].copy(t),s[2].copy(i),s[3].copy(a),s[4].copy(o),s[5].copy(r),this}copy(e){const t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e,t=cc){const i=this.planes,a=e.elements,o=a[0],r=a[1],s=a[2],l=a[3],c=a[4],u=a[5],C=a[6],h=a[7],m=a[8],p=a[9],B=a[10],b=a[11],y=a[12],S=a[13],R=a[14],Z=a[15];if(i[0].setComponents(l-o,h-c,b-m,Z-y).normalize(),i[1].setComponents(l+o,h+c,b+m,Z+y).normalize(),i[2].setComponents(l+r,h+u,b+p,Z+S).normalize(),i[3].setComponents(l-r,h-u,b-p,Z-S).normalize(),i[4].setComponents(l-s,h-C,b-B,Z-R).normalize(),t===cc)i[5].setComponents(l+s,h+C,b+B,Z+R).normalize();else if(t===Rp)i[5].setComponents(s,C,B,R).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),pC.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),pC.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(pC)}intersectsSprite(e){return pC.center.set(0,0,0),pC.radius=.7071067811865476,pC.applyMatrix4(e.matrixWorld),this.intersectsSphere(pC)}intersectsSphere(e){const t=this.planes,i=e.center,a=-e.radius;for(let o=0;o<6;o++)if(t[o].distanceToPoint(i)<a)return!1;return!0}intersectsBox(e){const t=this.planes;for(let i=0;i<6;i++){const a=t[i];if(bv.x=a.normal.x>0?e.max.x:e.min.x,bv.y=a.normal.y>0?e.max.y:e.min.y,bv.z=a.normal.z>0?e.max.z:e.min.z,a.distanceToPoint(bv)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function K2(n,e){return n-e}function dP(n,e){return n.z-e.z}function CP(n,e){return e.z-n.z}class IP{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,t,i,a){const o=this.pool,r=this.list;this.index>=o.length&&o.push({start:-1,count:-1,z:-1,index:-1});const s=o[this.index];r.push(s),this.index++,s.start=e,s.count=t,s.z=i,s.index=a}reset(){this.list.length=0,this.index=0}}const ds=new Vn,hP=new dn(1,1,1),L2=new cb,vv=new Wo,bC=new Vo,Zm=new Be,zV=new Be,fP=new Be,_2=new IP,ur=new $i,yv=[];function AP(n,e,t=0){const i=e.itemSize;if(n.isInterleavedBufferAttribute||n.array.constructor!==e.array.constructor){const a=n.count;for(let o=0;o<a;o++)for(let r=0;r<i;r++)e.setComponent(o+t,r,n.getComponent(o,r))}else e.array.set(n.array,t*i);e.needsUpdate=!0}function vC(n,e){if(n.constructor!==e.constructor){const t=Math.min(n.length,e.length);for(let i=0;i<t;i++)e[i]=n[i]}else{const t=Math.min(n.length,e.length);e.set(new n.constructor(n.buffer,0,t))}}class K9 extends $i{constructor(e,t,i=t*2,a){super(new $n,a),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._instanceInfo=[],this._geometryInfo=[],this._availableInstanceIds=[],this._availableGeometryIds=[],this._nextIndexStart=0,this._nextVertexStart=0,this._geometryCount=0,this._visibilityChanged=!0,this._geometryInitialized=!1,this._maxInstanceCount=e,this._maxVertexCount=t,this._maxIndexCount=i,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._multiDrawInstances=null,this._matricesTexture=null,this._indirectTexture=null,this._colorsTexture=null,this._initMatricesTexture(),this._initIndirectTexture()}get maxInstanceCount(){return this._maxInstanceCount}get instanceCount(){return this._instanceInfo.length-this._availableInstanceIds.length}get unusedVertexCount(){return this._maxVertexCount-this._nextVertexStart}get unusedIndexCount(){return this._maxIndexCount-this._nextIndexStart}_initMatricesTexture(){let e=Math.sqrt(this._maxInstanceCount*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4),i=new gc(t,e,e,La,ma);this._matricesTexture=i}_initIndirectTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Uint32Array(e*e),i=new gc(t,e,e,ab,Ig);this._indirectTexture=i}_initColorsTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Float32Array(e*e*4).fill(1),i=new gc(t,e,e,La,ma);i.colorSpace=vi.workingColorSpace,this._colorsTexture=i}_initializeGeometry(e){const t=this.geometry,i=this._maxVertexCount,a=this._maxIndexCount;if(this._geometryInitialized===!1){for(const o in e.attributes){const r=e.getAttribute(o),{array:s,itemSize:l,normalized:c}=r,u=new s.constructor(i*l),C=new Mi(u,l,c);t.setAttribute(o,C)}if(e.getIndex()!==null){const o=i>65535?new Uint32Array(a):new Uint16Array(a);t.setIndex(new Mi(o,1))}this._geometryInitialized=!0}}_validateGeometry(e){const t=this.geometry;if(!!e.getIndex()!=!!t.getIndex())throw new Error('THREE.BatchedMesh: All geometries must consistently have "index".');for(const i in t.attributes){if(!e.hasAttribute(i))throw new Error(`THREE.BatchedMesh: Added geometry missing "${i}". All geometries must have consistent attributes.`);const a=e.getAttribute(i),o=t.getAttribute(i);if(a.itemSize!==o.itemSize||a.normalized!==o.normalized)throw new Error("THREE.BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}validateInstanceId(e){const t=this._instanceInfo;if(e<0||e>=t.length||t[e].active===!1)throw new Error(`THREE.BatchedMesh: Invalid instanceId ${e}. Instance is either out of range or has been deleted.`)}validateGeometryId(e){const t=this._geometryInfo;if(e<0||e>=t.length||t[e].active===!1)throw new Error(`THREE.BatchedMesh: Invalid geometryId ${e}. Geometry is either out of range or has been deleted.`)}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Wo);const e=this.boundingBox,t=this._instanceInfo;e.makeEmpty();for(let i=0,a=t.length;i<a;i++){if(t[i].active===!1)continue;const o=t[i].geometryIndex;this.getMatrixAt(i,ds),this.getBoundingBoxAt(o,vv).applyMatrix4(ds),e.union(vv)}}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Vo);const e=this.boundingSphere,t=this._instanceInfo;e.makeEmpty();for(let i=0,a=t.length;i<a;i++){if(t[i].active===!1)continue;const o=t[i].geometryIndex;this.getMatrixAt(i,ds),this.getBoundingSphereAt(o,bC).applyMatrix4(ds),e.union(bC)}}addInstance(e){if(this._instanceInfo.length>=this.maxInstanceCount&&this._availableInstanceIds.length===0)throw new Error("THREE.BatchedMesh: Maximum item count reached.");const i={visible:!0,active:!0,geometryIndex:e};let a=null;this._availableInstanceIds.length>0?(this._availableInstanceIds.sort(K2),a=this._availableInstanceIds.shift(),this._instanceInfo[a]=i):(a=this._instanceInfo.length,this._instanceInfo.push(i));const o=this._matricesTexture;ds.identity().toArray(o.image.data,a*16),o.needsUpdate=!0;const r=this._colorsTexture;return r&&(hP.toArray(r.image.data,a*4),r.needsUpdate=!0),this._visibilityChanged=!0,a}addGeometry(e,t=-1,i=-1){this._initializeGeometry(e),this._validateGeometry(e);const a={vertexStart:-1,vertexCount:-1,reservedVertexCount:-1,indexStart:-1,indexCount:-1,reservedIndexCount:-1,start:-1,count:-1,boundingBox:null,boundingSphere:null,active:!0},o=this._geometryInfo;a.vertexStart=this._nextVertexStart,a.reservedVertexCount=t===-1?e.getAttribute("position").count:t;const r=e.getIndex();if(r!==null&&(a.indexStart=this._nextIndexStart,a.reservedIndexCount=i===-1?r.count:i),a.indexStart!==-1&&a.indexStart+a.reservedIndexCount>this._maxIndexCount||a.vertexStart+a.reservedVertexCount>this._maxVertexCount)throw new Error("THREE.BatchedMesh: Reserved space request exceeds the maximum buffer size.");let l;return this._availableGeometryIds.length>0?(this._availableGeometryIds.sort(K2),l=this._availableGeometryIds.shift(),o[l]=a):(l=this._geometryCount,this._geometryCount++,o.push(a)),this.setGeometryAt(l,e),this._nextIndexStart=a.indexStart+a.reservedIndexCount,this._nextVertexStart=a.vertexStart+a.reservedVertexCount,l}setGeometryAt(e,t){if(e>=this._geometryCount)throw new Error("THREE.BatchedMesh: Maximum geometry count reached.");this._validateGeometry(t);const i=this.geometry,a=i.getIndex()!==null,o=i.getIndex(),r=t.getIndex(),s=this._geometryInfo[e];if(a&&r.count>s.reservedIndexCount||t.attributes.position.count>s.reservedVertexCount)throw new Error("THREE.BatchedMesh: Reserved space not large enough for provided geometry.");const l=s.vertexStart,c=s.reservedVertexCount;s.vertexCount=t.getAttribute("position").count;for(const u in i.attributes){const C=t.getAttribute(u),h=i.getAttribute(u);AP(C,h,l);const m=C.itemSize;for(let p=C.count,B=c;p<B;p++){const b=l+p;for(let y=0;y<m;y++)h.setComponent(b,y,0)}h.needsUpdate=!0,h.addUpdateRange(l*m,c*m)}if(a){const u=s.indexStart,C=s.reservedIndexCount;s.indexCount=t.getIndex().count;for(let h=0;h<r.count;h++)o.setX(u+h,l+r.getX(h));for(let h=r.count,m=C;h<m;h++)o.setX(u+h,l);o.needsUpdate=!0,o.addUpdateRange(u,s.reservedIndexCount)}return s.start=a?s.indexStart:s.vertexStart,s.count=a?s.indexCount:s.vertexCount,s.boundingBox=null,t.boundingBox!==null&&(s.boundingBox=t.boundingBox.clone()),s.boundingSphere=null,t.boundingSphere!==null&&(s.boundingSphere=t.boundingSphere.clone()),this._visibilityChanged=!0,e}deleteGeometry(e){const t=this._geometryInfo;if(e>=t.length||t[e].active===!1)return this;const i=this._instanceInfo;for(let a=0,o=i.length;a<o;a++)i[a].active&&i[a].geometryIndex===e&&this.deleteInstance(a);return t[e].active=!1,this._availableGeometryIds.push(e),this._visibilityChanged=!0,this}deleteInstance(e){return this.validateInstanceId(e),this._instanceInfo[e].active=!1,this._availableInstanceIds.push(e),this._visibilityChanged=!0,this}optimize(){let e=0,t=0;const i=this._geometryInfo,a=i.map((r,s)=>s).sort((r,s)=>i[r].vertexStart-i[s].vertexStart),o=this.geometry;for(let r=0,s=i.length;r<s;r++){const l=a[r],c=i[l];if(c.active!==!1){if(o.index!==null){if(c.indexStart!==t){const{indexStart:u,vertexStart:C,reservedIndexCount:h}=c,m=o.index,p=m.array,B=e-C;for(let b=u;b<u+h;b++)p[b]=p[b]+B;m.array.copyWithin(t,u,u+h),m.addUpdateRange(t,h),c.indexStart=t}t+=c.reservedIndexCount}if(c.vertexStart!==e){const{vertexStart:u,reservedVertexCount:C}=c,h=o.attributes;for(const m in h){const p=h[m],{array:B,itemSize:b}=p;B.copyWithin(e*b,u*b,(u+C)*b),p.addUpdateRange(e*b,C*b)}c.vertexStart=e}e+=c.reservedVertexCount,c.start=o.index?c.indexStart:c.vertexStart,this._nextIndexStart=o.index?c.indexStart+c.reservedIndexCount:0,this._nextVertexStart=c.vertexStart+c.reservedVertexCount}}return this}getBoundingBoxAt(e,t){if(e>=this._geometryCount)return null;const i=this.geometry,a=this._geometryInfo[e];if(a.boundingBox===null){const o=new Wo,r=i.index,s=i.attributes.position;for(let l=a.start,c=a.start+a.count;l<c;l++){let u=l;r&&(u=r.getX(u)),o.expandByPoint(Zm.fromBufferAttribute(s,u))}a.boundingBox=o}return t.copy(a.boundingBox),t}getBoundingSphereAt(e,t){if(e>=this._geometryCount)return null;const i=this.geometry,a=this._geometryInfo[e];if(a.boundingSphere===null){const o=new Vo;this.getBoundingBoxAt(e,vv),vv.getCenter(o.center);const r=i.index,s=i.attributes.position;let l=0;for(let c=a.start,u=a.start+a.count;c<u;c++){let C=c;r&&(C=r.getX(C)),Zm.fromBufferAttribute(s,C),l=Math.max(l,o.center.distanceToSquared(Zm))}o.radius=Math.sqrt(l),a.boundingSphere=o}return t.copy(a.boundingSphere),t}setMatrixAt(e,t){this.validateInstanceId(e);const i=this._matricesTexture,a=this._matricesTexture.image.data;return t.toArray(a,e*16),i.needsUpdate=!0,this}getMatrixAt(e,t){return this.validateInstanceId(e),t.fromArray(this._matricesTexture.image.data,e*16)}setColorAt(e,t){return this.validateInstanceId(e),this._colorsTexture===null&&this._initColorsTexture(),t.toArray(this._colorsTexture.image.data,e*4),this._colorsTexture.needsUpdate=!0,this}getColorAt(e,t){return this.validateInstanceId(e),t.fromArray(this._colorsTexture.image.data,e*4)}setVisibleAt(e,t){return this.validateInstanceId(e),this._instanceInfo[e].visible===t?this:(this._instanceInfo[e].visible=t,this._visibilityChanged=!0,this)}getVisibleAt(e){return this.validateInstanceId(e),this._instanceInfo[e].visible}setGeometryIdAt(e,t){return this.validateInstanceId(e),this.validateGeometryId(t),this._instanceInfo[e].geometryIndex=t,this}getGeometryIdAt(e){return this.validateInstanceId(e),this._instanceInfo[e].geometryIndex}getGeometryRangeAt(e,t={}){this.validateGeometryId(e);const i=this._geometryInfo[e];return t.vertexStart=i.vertexStart,t.vertexCount=i.vertexCount,t.reservedVertexCount=i.reservedVertexCount,t.indexStart=i.indexStart,t.indexCount=i.indexCount,t.reservedIndexCount=i.reservedIndexCount,t.start=i.start,t.count=i.count,t}setInstanceCount(e){const t=this._availableInstanceIds,i=this._instanceInfo;for(t.sort(K2);t[t.length-1]===i.length;)i.pop(),t.pop();if(e<i.length)throw new Error(`BatchedMesh: Instance ids outside the range ${e} are being used. Cannot shrink instance count.`);const a=new Int32Array(e),o=new Int32Array(e);vC(this._multiDrawCounts,a),vC(this._multiDrawStarts,o),this._multiDrawCounts=a,this._multiDrawStarts=o,this._maxInstanceCount=e;const r=this._indirectTexture,s=this._matricesTexture,l=this._colorsTexture;r.dispose(),this._initIndirectTexture(),vC(r.image.data,this._indirectTexture.image.data),s.dispose(),this._initMatricesTexture(),vC(s.image.data,this._matricesTexture.image.data),l&&(l.dispose(),this._initColorsTexture(),vC(l.image.data,this._colorsTexture.image.data))}setGeometrySize(e,t){const i=[...this._geometryInfo].filter(s=>s.active);if(Math.max(...i.map(s=>s.vertexStart+s.reservedVertexCount))>e)throw new Error(`BatchedMesh: Geometry vertex values are being used outside the range ${t}. Cannot shrink further.`);if(this.geometry.index&&Math.max(...i.map(l=>l.indexStart+l.reservedIndexCount))>t)throw new Error(`BatchedMesh: Geometry index values are being used outside the range ${t}. Cannot shrink further.`);const o=this.geometry;o.dispose(),this._maxVertexCount=e,this._maxIndexCount=t,this._geometryInitialized&&(this._geometryInitialized=!1,this.geometry=new $n,this._initializeGeometry(o));const r=this.geometry;o.index&&vC(o.index.array,r.index.array);for(const s in o.attributes)vC(o.attributes[s].array,r.attributes[s].array)}raycast(e,t){const i=this._instanceInfo,a=this._geometryInfo,o=this.matrixWorld,r=this.geometry;ur.material=this.material,ur.geometry.index=r.index,ur.geometry.attributes=r.attributes,ur.geometry.boundingBox===null&&(ur.geometry.boundingBox=new Wo),ur.geometry.boundingSphere===null&&(ur.geometry.boundingSphere=new Vo);for(let s=0,l=i.length;s<l;s++){if(!i[s].visible||!i[s].active)continue;const c=i[s].geometryIndex,u=a[c];ur.geometry.setDrawRange(u.start,u.count),this.getMatrixAt(s,ur.matrixWorld).premultiply(o),this.getBoundingBoxAt(c,ur.geometry.boundingBox),this.getBoundingSphereAt(c,ur.geometry.boundingSphere),ur.raycast(e,yv);for(let C=0,h=yv.length;C<h;C++){const m=yv[C];m.object=this,m.batchId=s,t.push(m)}yv.length=0}ur.material=null,ur.geometry.index=null,ur.geometry.attributes={},ur.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=e.boundingBox!==null?e.boundingBox.clone():null,this.boundingSphere=e.boundingSphere!==null?e.boundingSphere.clone():null,this._geometryInfo=e._geometryInfo.map(t=>({...t,boundingBox:t.boundingBox!==null?t.boundingBox.clone():null,boundingSphere:t.boundingSphere!==null?t.boundingSphere.clone():null})),this._instanceInfo=e._instanceInfo.map(t=>({...t})),this._maxInstanceCount=e._maxInstanceCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._geometryCount=e._geometryCount,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.data.slice(),this._colorsTexture!==null&&(this._colorsTexture=e._colorsTexture.clone(),this._colorsTexture.image.data=this._colorsTexture.image.data.slice()),this}dispose(){this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this._indirectTexture.dispose(),this._indirectTexture=null,this._colorsTexture!==null&&(this._colorsTexture.dispose(),this._colorsTexture=null)}onBeforeRender(e,t,i,a,o){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const r=a.getIndex(),s=r===null?1:r.array.BYTES_PER_ELEMENT,l=this._instanceInfo,c=this._multiDrawStarts,u=this._multiDrawCounts,C=this._geometryInfo,h=this.perObjectFrustumCulled,m=this._indirectTexture,p=m.image.data;h&&(ds.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse).multiply(this.matrixWorld),L2.setFromProjectionMatrix(ds,e.coordinateSystem));let B=0;if(this.sortObjects){ds.copy(this.matrixWorld).invert(),Zm.setFromMatrixPosition(i.matrixWorld).applyMatrix4(ds),zV.set(0,0,-1).transformDirection(i.matrixWorld).transformDirection(ds);for(let S=0,R=l.length;S<R;S++)if(l[S].visible&&l[S].active){const Z=l[S].geometryIndex;this.getMatrixAt(S,ds),this.getBoundingSphereAt(Z,bC).applyMatrix4(ds);let x=!1;if(h&&(x=!L2.intersectsSphere(bC)),!x){const M=C[Z],E=fP.subVectors(bC.center,Zm).dot(zV);_2.push(M.start,M.count,E,S)}}const b=_2.list,y=this.customSort;y===null?b.sort(o.transparent?CP:dP):y.call(this,b,i);for(let S=0,R=b.length;S<R;S++){const Z=b[S];c[B]=Z.start*s,u[B]=Z.count,p[B]=Z.index,B++}_2.reset()}else for(let b=0,y=l.length;b<y;b++)if(l[b].visible&&l[b].active){const S=l[b].geometryIndex;let R=!1;if(h&&(this.getMatrixAt(b,ds),this.getBoundingSphereAt(S,bC).applyMatrix4(ds),R=!L2.intersectsSphere(bC)),!R){const Z=C[S];c[B]=Z.start*s,u[B]=Z.count,p[B]=b,B++}}m.needsUpdate=!0,this._multiDrawCount=B,this._visibilityChanged=!1}onBeforeShadow(e,t,i,a,o,r){this.onBeforeRender(e,null,a,o,r)}}class Ar extends ho{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new dn(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const MB=new Be,WB=new Be,KV=new Vn,xm=new pI,Bv=new Vo,D2=new Be,LV=new Be;class uu extends Ii{constructor(e=new $n,t=new Ar){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,i=[0];for(let a=1,o=t.count;a<o;a++)MB.fromBufferAttribute(t,a-1),WB.fromBufferAttribute(t,a),i[a]=i[a-1],i[a]+=MB.distanceTo(WB);e.setAttribute("lineDistance",new Sn(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const i=this.geometry,a=this.matrixWorld,o=e.params.Line.threshold,r=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),Bv.copy(i.boundingSphere),Bv.applyMatrix4(a),Bv.radius+=o,e.ray.intersectsSphere(Bv)===!1)return;KV.copy(a).invert(),xm.copy(e.ray).applyMatrix4(KV);const s=o/((this.scale.x+this.scale.y+this.scale.z)/3),l=s*s,c=this.isLineSegments?2:1,u=i.index,h=i.attributes.position;if(u!==null){const m=Math.max(0,r.start),p=Math.min(u.count,r.start+r.count);for(let B=m,b=p-1;B<b;B+=c){const y=u.getX(B),S=u.getX(B+1),R=Gv(this,e,xm,l,y,S,B);R&&t.push(R)}if(this.isLineLoop){const B=u.getX(p-1),b=u.getX(m),y=Gv(this,e,xm,l,B,b,p-1);y&&t.push(y)}}else{const m=Math.max(0,r.start),p=Math.min(h.count,r.start+r.count);for(let B=m,b=p-1;B<b;B+=c){const y=Gv(this,e,xm,l,B,B+1,B);y&&t.push(y)}if(this.isLineLoop){const B=Gv(this,e,xm,l,p-1,m,p-1);B&&t.push(B)}}}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const a=t[i[0]];if(a!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,r=a.length;o<r;o++){const s=a[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[s]=o}}}}}function Gv(n,e,t,i,a,o,r){const s=n.geometry.attributes.position;if(MB.fromBufferAttribute(s,a),WB.fromBufferAttribute(s,o),t.distanceSqToSegment(MB,WB,D2,LV)>i)return;D2.applyMatrix4(n.matrixWorld);const c=e.ray.origin.distanceTo(D2);if(!(c<e.near||c>e.far))return{distance:c,point:LV.clone().applyMatrix4(n.matrixWorld),index:r,face:null,faceIndex:null,barycoord:null,object:n}}const _V=new Be,DV=new Be;class Ac extends uu{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,i=[];for(let a=0,o=t.count;a<o;a+=2)_V.fromBufferAttribute(t,a),DV.fromBufferAttribute(t,a+1),i[a]=a===0?0:i[a-1],i[a+1]=i[a]+_V.distanceTo(DV);e.setAttribute("lineDistance",new Sn(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class Cx extends uu{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class RG extends ho{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new dn(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const OV=new Vn,P1=new pI,Sv=new Vo,wv=new Be;class Ix extends Ii{constructor(e=new $n,t=new RG){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const i=this.geometry,a=this.matrixWorld,o=e.params.Points.threshold,r=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),Sv.copy(i.boundingSphere),Sv.applyMatrix4(a),Sv.radius+=o,e.ray.intersectsSphere(Sv)===!1)return;OV.copy(a).invert(),P1.copy(e.ray).applyMatrix4(OV);const s=o/((this.scale.x+this.scale.y+this.scale.z)/3),l=s*s,c=i.index,C=i.attributes.position;if(c!==null){const h=Math.max(0,r.start),m=Math.min(c.count,r.start+r.count);for(let p=h,B=m;p<B;p++){const b=c.getX(p);wv.fromBufferAttribute(C,b),UV(wv,b,l,a,e,t,this)}}else{const h=Math.max(0,r.start),m=Math.min(C.count,r.start+r.count);for(let p=h,B=m;p<B;p++)wv.fromBufferAttribute(C,p),UV(wv,p,l,a,e,t,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const a=t[i[0]];if(a!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,r=a.length;o<r;o++){const s=a[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[s]=o}}}}}function UV(n,e,t,i,a,o,r){const s=P1.distanceSqToPoint(n);if(s<t){const l=new Be;P1.closestPointToPoint(n,l),l.applyMatrix4(i);const c=a.ray.origin.distanceTo(l);if(c<a.near||c>a.far)return;o.push({distance:c,distanceToRay:Math.sqrt(s),point:l,index:e,face:null,faceIndex:null,barycoord:null,object:r})}}class L9 extends Fi{constructor(e,t,i,a,o=Bi,r=Bi,s,l,c){super(e,t,i,a,o,r,s,l,c),this.isVideoTexture=!0,this.generateMipmaps=!1;const u=this;function C(){u.needsUpdate=!0,e.requestVideoFrameCallback(C)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(C)}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class mP extends L9{constructor(e,t,i,a,o,r,s,l){super({},e,t,i,a,o,r,s,l),this.isVideoFrameTexture=!0}update(){}clone(){return new this.constructor().copy(this)}setFrame(e){this.image=e,this.needsUpdate=!0}}class pP extends Fi{constructor(e,t){super({width:e,height:t}),this.isFramebufferTexture=!0,this.magFilter=Mo,this.minFilter=Mo,this.generateMipmaps=!1,this.needsUpdate=!0}}class ZG extends Fi{constructor(e,t,i,a,o,r,s,l,c,u,C,h){super(null,r,s,l,c,u,a,o,C,h),this.isCompressedTexture=!0,this.image={width:t,height:i},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class bP extends ZG{constructor(e,t,i,a,o,r){super(e,t,i,o,r),this.isCompressedArrayTexture=!0,this.image.depth=a,this.wrapR=Ka,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class vP extends ZG{constructor(e,t,i){super(void 0,e[0].width,e[0].height,t,i,Cg),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class _9 extends Fi{constructor(e,t,i,a,o,r,s,l,c){super(e,t,i,a,o,r,s,l,c),this.isCanvasTexture=!0,this.needsUpdate=!0}}class xG extends Fi{constructor(e,t,i=Ig,a,o,r,s=Mo,l=Mo,c,u=vf){if(u!==vf&&u!==yf)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");super(null,a,o,r,s,l,u,i,c),this.isDepthTexture=!0,this.image={width:e,height:t},this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.source=new dd(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}}class mc{constructor(){this.type="Curve",this.arcLengthDivisions=200,this.needsUpdate=!1,this.cacheArcLengths=null}getPoint(){console.warn("THREE.Curve: .getPoint() not implemented.")}getPointAt(e,t){const i=this.getUtoTmapping(e);return this.getPoint(i,t)}getPoints(e=5){const t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return t}getSpacedPoints(e=5){const t=[];for(let i=0;i<=e;i++)t.push(this.getPointAt(i/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let i,a=this.getPoint(0),o=0;t.push(0);for(let r=1;r<=e;r++)i=this.getPoint(r/e),o+=i.distanceTo(a),t.push(o),a=i;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t=null){const i=this.getLengths();let a=0;const o=i.length;let r;t?r=t:r=e*i[o-1];let s=0,l=o-1,c;for(;s<=l;)if(a=Math.floor(s+(l-s)/2),c=i[a]-r,c<0)s=a+1;else if(c>0)l=a-1;else{l=a;break}if(a=l,i[a]===r)return a/(o-1);const u=i[a],h=i[a+1]-u,m=(r-u)/h;return(a+m)/(o-1)}getTangent(e,t){let a=e-1e-4,o=e+1e-4;a<0&&(a=0),o>1&&(o=1);const r=this.getPoint(a),s=this.getPoint(o),l=t||(r.isVector2?new Xt:new Be);return l.copy(s).sub(r).normalize(),l}getTangentAt(e,t){const i=this.getUtoTmapping(e);return this.getTangent(i,t)}computeFrenetFrames(e,t=!1){const i=new Be,a=[],o=[],r=[],s=new Be,l=new Vn;for(let m=0;m<=e;m++){const p=m/e;a[m]=this.getTangentAt(p,new Be)}o[0]=new Be,r[0]=new Be;let c=Number.MAX_VALUE;const u=Math.abs(a[0].x),C=Math.abs(a[0].y),h=Math.abs(a[0].z);u<=c&&(c=u,i.set(1,0,0)),C<=c&&(c=C,i.set(0,1,0)),h<=c&&i.set(0,0,1),s.crossVectors(a[0],i).normalize(),o[0].crossVectors(a[0],s),r[0].crossVectors(a[0],o[0]);for(let m=1;m<=e;m++){if(o[m]=o[m-1].clone(),r[m]=r[m-1].clone(),s.crossVectors(a[m-1],a[m]),s.length()>Number.EPSILON){s.normalize();const p=Math.acos(jn(a[m-1].dot(a[m]),-1,1));o[m].applyMatrix4(l.makeRotationAxis(s,p))}r[m].crossVectors(a[m],o[m])}if(t===!0){let m=Math.acos(jn(o[0].dot(o[e]),-1,1));m/=e,a[0].dot(s.crossVectors(o[0],o[e]))>0&&(m=-m);for(let p=1;p<=e;p++)o[p].applyMatrix4(l.makeRotationAxis(a[p],m*p)),r[p].crossVectors(a[p],o[p])}return{tangents:a,normals:o,binormals:r}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class MG extends mc{constructor(e=0,t=0,i=1,a=1,o=0,r=Math.PI*2,s=!1,l=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=i,this.yRadius=a,this.aStartAngle=o,this.aEndAngle=r,this.aClockwise=s,this.aRotation=l}getPoint(e,t=new Xt){const i=t,a=Math.PI*2;let o=this.aEndAngle-this.aStartAngle;const r=Math.abs(o)<Number.EPSILON;for(;o<0;)o+=a;for(;o>a;)o-=a;o<Number.EPSILON&&(r?o=0:o=a),this.aClockwise===!0&&!r&&(o===a?o=-a:o=o-a);const s=this.aStartAngle+e*o;let l=this.aX+this.xRadius*Math.cos(s),c=this.aY+this.yRadius*Math.sin(s);if(this.aRotation!==0){const u=Math.cos(this.aRotation),C=Math.sin(this.aRotation),h=l-this.aX,m=c-this.aY;l=h*u-m*C+this.aX,c=h*C+m*u+this.aY}return i.set(l,c)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class D9 extends MG{constructor(e,t,i,a,o,r){super(e,t,i,i,a,o,r),this.isArcCurve=!0,this.type="ArcCurve"}}function hx(){let n=0,e=0,t=0,i=0;function a(o,r,s,l){n=o,e=s,t=-3*o+3*r-2*s-l,i=2*o-2*r+s+l}return{initCatmullRom:function(o,r,s,l,c){a(r,s,c*(s-o),c*(l-r))},initNonuniformCatmullRom:function(o,r,s,l,c,u,C){let h=(r-o)/c-(s-o)/(c+u)+(s-r)/u,m=(s-r)/u-(l-r)/(u+C)+(l-s)/C;h*=u,m*=u,a(r,s,h,m)},calc:function(o){const r=o*o,s=r*o;return n+e*o+t*r+i*s}}}const Rv=new Be,O2=new hx,U2=new hx,k2=new hx;class O9 extends mc{constructor(e=[],t=!1,i="centripetal",a=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=i,this.tension=a}getPoint(e,t=new Be){const i=t,a=this.points,o=a.length,r=(o-(this.closed?0:1))*e;let s=Math.floor(r),l=r-s;this.closed?s+=s>0?0:(Math.floor(Math.abs(s)/o)+1)*o:l===0&&s===o-1&&(s=o-2,l=1);let c,u;this.closed||s>0?c=a[(s-1)%o]:(Rv.subVectors(a[0],a[1]).add(a[0]),c=Rv);const C=a[s%o],h=a[(s+1)%o];if(this.closed||s+2<o?u=a[(s+2)%o]:(Rv.subVectors(a[o-1],a[o-2]).add(a[o-1]),u=Rv),this.curveType==="centripetal"||this.curveType==="chordal"){const m=this.curveType==="chordal"?.5:.25;let p=Math.pow(c.distanceToSquared(C),m),B=Math.pow(C.distanceToSquared(h),m),b=Math.pow(h.distanceToSquared(u),m);B<1e-4&&(B=1),p<1e-4&&(p=B),b<1e-4&&(b=B),O2.initNonuniformCatmullRom(c.x,C.x,h.x,u.x,p,B,b),U2.initNonuniformCatmullRom(c.y,C.y,h.y,u.y,p,B,b),k2.initNonuniformCatmullRom(c.z,C.z,h.z,u.z,p,B,b)}else this.curveType==="catmullrom"&&(O2.initCatmullRom(c.x,C.x,h.x,u.x,this.tension),U2.initCatmullRom(c.y,C.y,h.y,u.y,this.tension),k2.initCatmullRom(c.z,C.z,h.z,u.z,this.tension));return i.set(O2.calc(l),U2.calc(l),k2.calc(l)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const a=e.points[t];this.points.push(a.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++){const a=this.points[t];e.points.push(a.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const a=e.points[t];this.points.push(new Be().fromArray(a))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function kV(n,e,t,i,a){const o=(i-e)*.5,r=(a-t)*.5,s=n*n,l=n*s;return(2*t-2*i+o+r)*l+(-3*t+3*i-2*o-r)*s+o*n+t}function yP(n,e){const t=1-n;return t*t*e}function BP(n,e){return 2*(1-n)*n*e}function GP(n,e){return n*n*e}function cp(n,e,t,i){return yP(n,e)+BP(n,t)+GP(n,i)}function SP(n,e){const t=1-n;return t*t*t*e}function wP(n,e){const t=1-n;return 3*t*t*n*e}function RP(n,e){return 3*(1-n)*n*n*e}function ZP(n,e){return n*n*n*e}function gp(n,e,t,i,a){return SP(n,e)+wP(n,t)+RP(n,i)+ZP(n,a)}class fx extends mc{constructor(e=new Xt,t=new Xt,i=new Xt,a=new Xt){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=i,this.v3=a}getPoint(e,t=new Xt){const i=t,a=this.v0,o=this.v1,r=this.v2,s=this.v3;return i.set(gp(e,a.x,o.x,r.x,s.x),gp(e,a.y,o.y,r.y,s.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class U9 extends mc{constructor(e=new Be,t=new Be,i=new Be,a=new Be){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=i,this.v3=a}getPoint(e,t=new Be){const i=t,a=this.v0,o=this.v1,r=this.v2,s=this.v3;return i.set(gp(e,a.x,o.x,r.x,s.x),gp(e,a.y,o.y,r.y,s.y),gp(e,a.z,o.z,r.z,s.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class Ax extends mc{constructor(e=new Xt,t=new Xt){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new Xt){const i=t;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new Xt){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class k9 extends mc{constructor(e=new Be,t=new Be){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new Be){const i=t;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new Be){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class mx extends mc{constructor(e=new Xt,t=new Xt,i=new Xt){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new Xt){const i=t,a=this.v0,o=this.v1,r=this.v2;return i.set(cp(e,a.x,o.x,r.x),cp(e,a.y,o.y,r.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class px extends mc{constructor(e=new Be,t=new Be,i=new Be){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new Be){const i=t,a=this.v0,o=this.v1,r=this.v2;return i.set(cp(e,a.x,o.x,r.x),cp(e,a.y,o.y,r.y),cp(e,a.z,o.z,r.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class bx extends mc{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new Xt){const i=t,a=this.points,o=(a.length-1)*e,r=Math.floor(o),s=o-r,l=a[r===0?r:r-1],c=a[r],u=a[r>a.length-2?a.length-1:r+1],C=a[r>a.length-3?a.length-1:r+2];return i.set(kV(s,l.x,c.x,u.x,C.x),kV(s,l.y,c.y,u.y,C.y)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const a=e.points[t];this.points.push(a.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++){const a=this.points[t];e.points.push(a.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const a=e.points[t];this.points.push(new Xt().fromArray(a))}return this}}var VB=Object.freeze({__proto__:null,ArcCurve:D9,CatmullRomCurve3:O9,CubicBezierCurve:fx,CubicBezierCurve3:U9,EllipseCurve:MG,LineCurve:Ax,LineCurve3:k9,QuadraticBezierCurve:mx,QuadraticBezierCurve3:px,SplineCurve:bx});class P9 extends mc{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){const i=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new VB[i](t,e))}return this}getPoint(e,t){const i=e*this.getLength(),a=this.getCurveLengths();let o=0;for(;o<a.length;){if(a[o]>=i){const r=a[o]-i,s=this.curves[o],l=s.getLength(),c=l===0?0:1-r/l;return s.getPointAt(c,t)}o++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let i=0,a=this.curves.length;i<a;i++)t+=this.curves[i].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let i;for(let a=0,o=this.curves;a<o.length;a++){const r=o[a],s=r.isEllipseCurve?e*2:r.isLineCurve||r.isLineCurve3?1:r.isSplineCurve?e*r.points.length:e,l=r.getPoints(s);for(let c=0;c<l.length;c++){const u=l[c];i&&i.equals(u)||(t.push(u),i=u)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,i=e.curves.length;t<i;t++){const a=e.curves[t];this.curves.push(a.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,i=this.curves.length;t<i;t++){const a=this.curves[t];e.curves.push(a.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,i=e.curves.length;t<i;t++){const a=e.curves[t];this.curves.push(new VB[a.type]().fromJSON(a))}return this}}class xp extends P9{constructor(e){super(),this.type="Path",this.currentPoint=new Xt,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,i=e.length;t<i;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const i=new Ax(this.currentPoint.clone(),new Xt(e,t));return this.curves.push(i),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,i,a){const o=new mx(this.currentPoint.clone(),new Xt(e,t),new Xt(i,a));return this.curves.push(o),this.currentPoint.set(i,a),this}bezierCurveTo(e,t,i,a,o,r){const s=new fx(this.currentPoint.clone(),new Xt(e,t),new Xt(i,a),new Xt(o,r));return this.curves.push(s),this.currentPoint.set(o,r),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),i=new bx(t);return this.curves.push(i),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,i,a,o,r){const s=this.currentPoint.x,l=this.currentPoint.y;return this.absarc(e+s,t+l,i,a,o,r),this}absarc(e,t,i,a,o,r){return this.absellipse(e,t,i,i,a,o,r),this}ellipse(e,t,i,a,o,r,s,l){const c=this.currentPoint.x,u=this.currentPoint.y;return this.absellipse(e+c,t+u,i,a,o,r,s,l),this}absellipse(e,t,i,a,o,r,s,l){const c=new MG(e,t,i,a,o,r,s,l);if(this.curves.length>0){const C=c.getPoint(0);C.equals(this.currentPoint)||this.lineTo(C.x,C.y)}this.curves.push(c);const u=c.getPoint(1);return this.currentPoint.copy(u),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class gb extends $n{constructor(e=[new Xt(0,-.5),new Xt(.5,0),new Xt(0,.5)],t=12,i=0,a=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:i,phiLength:a},t=Math.floor(t),a=jn(a,0,Math.PI*2);const o=[],r=[],s=[],l=[],c=[],u=1/t,C=new Be,h=new Xt,m=new Be,p=new Be,B=new Be;let b=0,y=0;for(let S=0;S<=e.length-1;S++)switch(S){case 0:b=e[S+1].x-e[S].x,y=e[S+1].y-e[S].y,m.x=y*1,m.y=-b,m.z=y*0,B.copy(m),m.normalize(),l.push(m.x,m.y,m.z);break;case e.length-1:l.push(B.x,B.y,B.z);break;default:b=e[S+1].x-e[S].x,y=e[S+1].y-e[S].y,m.x=y*1,m.y=-b,m.z=y*0,p.copy(m),m.x+=B.x,m.y+=B.y,m.z+=B.z,m.normalize(),l.push(m.x,m.y,m.z),B.copy(p)}for(let S=0;S<=t;S++){const R=i+S*u*a,Z=Math.sin(R),x=Math.cos(R);for(let M=0;M<=e.length-1;M++){C.x=e[M].x*Z,C.y=e[M].y,C.z=e[M].x*x,r.push(C.x,C.y,C.z),h.x=S/t,h.y=M/(e.length-1),s.push(h.x,h.y);const E=l[3*M+0]*Z,F=l[3*M+1],N=l[3*M+0]*x;c.push(E,F,N)}}for(let S=0;S<t;S++)for(let R=0;R<e.length-1;R++){const Z=R+S*e.length,x=Z,M=Z+e.length,E=Z+e.length+1,F=Z+1;o.push(x,M,F),o.push(E,F,M)}this.setIndex(o),this.setAttribute("position",new Sn(r,3)),this.setAttribute("uv",new Sn(s,2)),this.setAttribute("normal",new Sn(c,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new gb(e.points,e.segments,e.phiStart,e.phiLength)}}class WG extends gb{constructor(e=1,t=1,i=4,a=8){const o=new xp;o.absarc(0,-t/2,e,Math.PI*1.5,0),o.absarc(0,t/2,e,0,Math.PI*.5),super(o.getPoints(i),a),this.type="CapsuleGeometry",this.parameters={radius:e,length:t,capSegments:i,radialSegments:a}}static fromJSON(e){return new WG(e.radius,e.length,e.capSegments,e.radialSegments)}}class VG extends $n{constructor(e=1,t=32,i=0,a=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:i,thetaLength:a},t=Math.max(3,t);const o=[],r=[],s=[],l=[],c=new Be,u=new Xt;r.push(0,0,0),s.push(0,0,1),l.push(.5,.5);for(let C=0,h=3;C<=t;C++,h+=3){const m=i+C/t*a;c.x=e*Math.cos(m),c.y=e*Math.sin(m),r.push(c.x,c.y,c.z),s.push(0,0,1),u.x=(r[h]/e+1)/2,u.y=(r[h+1]/e+1)/2,l.push(u.x,u.y)}for(let C=1;C<=t;C++)o.push(C,C+1,0);this.setIndex(o),this.setAttribute("position",new Sn(r,3)),this.setAttribute("normal",new Sn(s,3)),this.setAttribute("uv",new Sn(l,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new VG(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class Uf extends $n{constructor(e=1,t=1,i=1,a=32,o=1,r=!1,s=0,l=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:i,radialSegments:a,heightSegments:o,openEnded:r,thetaStart:s,thetaLength:l};const c=this;a=Math.floor(a),o=Math.floor(o);const u=[],C=[],h=[],m=[];let p=0;const B=[],b=i/2;let y=0;S(),r===!1&&(e>0&&R(!0),t>0&&R(!1)),this.setIndex(u),this.setAttribute("position",new Sn(C,3)),this.setAttribute("normal",new Sn(h,3)),this.setAttribute("uv",new Sn(m,2));function S(){const Z=new Be,x=new Be;let M=0;const E=(t-e)/i;for(let F=0;F<=o;F++){const N=[],H=F/o,z=H*(t-e)+e;for(let _=0;_<=a;_++){const D=_/a,P=D*l+s,$=Math.sin(P),X=Math.cos(P);x.x=z*$,x.y=-H*i+b,x.z=z*X,C.push(x.x,x.y,x.z),Z.set($,E,X).normalize(),h.push(Z.x,Z.y,Z.z),m.push(D,1-H),N.push(p++)}B.push(N)}for(let F=0;F<a;F++)for(let N=0;N<o;N++){const H=B[N][F],z=B[N+1][F],_=B[N+1][F+1],D=B[N][F+1];(e>0||N!==0)&&(u.push(H,z,D),M+=3),(t>0||N!==o-1)&&(u.push(z,_,D),M+=3)}c.addGroup(y,M,0),y+=M}function R(Z){const x=p,M=new Xt,E=new Be;let F=0;const N=Z===!0?e:t,H=Z===!0?1:-1;for(let _=1;_<=a;_++)C.push(0,b*H,0),h.push(0,H,0),m.push(.5,.5),p++;const z=p;for(let _=0;_<=a;_++){const P=_/a*l+s,$=Math.cos(P),X=Math.sin(P);E.x=N*X,E.y=b*H,E.z=N*$,C.push(E.x,E.y,E.z),h.push(0,H,0),M.x=$*.5+.5,M.y=X*.5*H+.5,m.push(M.x,M.y),p++}for(let _=0;_<a;_++){const D=x+_,P=z+_;Z===!0?u.push(P,P+1,D):u.push(P+1,P,D),F+=3}c.addGroup(y,F,Z===!0?1:2),y+=F}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Uf(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class NG extends Uf{constructor(e=1,t=1,i=32,a=1,o=!1,r=0,s=Math.PI*2){super(0,e,t,i,a,o,r,s),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:i,heightSegments:a,openEnded:o,thetaStart:r,thetaLength:s}}static fromJSON(e){return new NG(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Rd extends $n{constructor(e=[],t=[],i=1,a=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:i,detail:a};const o=[],r=[];s(a),c(i),u(),this.setAttribute("position",new Sn(o,3)),this.setAttribute("normal",new Sn(o.slice(),3)),this.setAttribute("uv",new Sn(r,2)),a===0?this.computeVertexNormals():this.normalizeNormals();function s(S){const R=new Be,Z=new Be,x=new Be;for(let M=0;M<t.length;M+=3)m(t[M+0],R),m(t[M+1],Z),m(t[M+2],x),l(R,Z,x,S)}function l(S,R,Z,x){const M=x+1,E=[];for(let F=0;F<=M;F++){E[F]=[];const N=S.clone().lerp(Z,F/M),H=R.clone().lerp(Z,F/M),z=M-F;for(let _=0;_<=z;_++)_===0&&F===M?E[F][_]=N:E[F][_]=N.clone().lerp(H,_/z)}for(let F=0;F<M;F++)for(let N=0;N<2*(M-F)-1;N++){const H=Math.floor(N/2);N%2===0?(h(E[F][H+1]),h(E[F+1][H]),h(E[F][H])):(h(E[F][H+1]),h(E[F+1][H+1]),h(E[F+1][H]))}}function c(S){const R=new Be;for(let Z=0;Z<o.length;Z+=3)R.x=o[Z+0],R.y=o[Z+1],R.z=o[Z+2],R.normalize().multiplyScalar(S),o[Z+0]=R.x,o[Z+1]=R.y,o[Z+2]=R.z}function u(){const S=new Be;for(let R=0;R<o.length;R+=3){S.x=o[R+0],S.y=o[R+1],S.z=o[R+2];const Z=b(S)/2/Math.PI+.5,x=y(S)/Math.PI+.5;r.push(Z,1-x)}p(),C()}function C(){for(let S=0;S<r.length;S+=6){const R=r[S+0],Z=r[S+2],x=r[S+4],M=Math.max(R,Z,x),E=Math.min(R,Z,x);M>.9&&E<.1&&(R<.2&&(r[S+0]+=1),Z<.2&&(r[S+2]+=1),x<.2&&(r[S+4]+=1))}}function h(S){o.push(S.x,S.y,S.z)}function m(S,R){const Z=S*3;R.x=e[Z+0],R.y=e[Z+1],R.z=e[Z+2]}function p(){const S=new Be,R=new Be,Z=new Be,x=new Be,M=new Xt,E=new Xt,F=new Xt;for(let N=0,H=0;N<o.length;N+=9,H+=6){S.set(o[N+0],o[N+1],o[N+2]),R.set(o[N+3],o[N+4],o[N+5]),Z.set(o[N+6],o[N+7],o[N+8]),M.set(r[H+0],r[H+1]),E.set(r[H+2],r[H+3]),F.set(r[H+4],r[H+5]),x.copy(S).add(R).add(Z).divideScalar(3);const z=b(x);B(M,H+0,S,z),B(E,H+2,R,z),B(F,H+4,Z,z)}}function B(S,R,Z,x){x<0&&S.x===1&&(r[R]=S.x-1),Z.x===0&&Z.z===0&&(r[R]=x/2/Math.PI+.5)}function b(S){return Math.atan2(S.z,-S.x)}function y(S){return Math.atan2(-S.y,Math.sqrt(S.x*S.x+S.z*S.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Rd(e.vertices,e.indices,e.radius,e.details)}}class EG extends Rd{constructor(e=1,t=0){const i=(1+Math.sqrt(5))/2,a=1/i,o=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-a,-i,0,-a,i,0,a,-i,0,a,i,-a,-i,0,-a,i,0,a,-i,0,a,i,0,-i,0,-a,i,0,-a,-i,0,a,i,0,a],r=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(o,r,e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new EG(e.radius,e.detail)}}const Zv=new Be,xv=new Be,P2=new Be,Mv=new ps;class J9 extends $n{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},e!==null){const a=Math.pow(10,4),o=Math.cos(tI*t),r=e.getIndex(),s=e.getAttribute("position"),l=r?r.count:s.count,c=[0,0,0],u=["a","b","c"],C=new Array(3),h={},m=[];for(let p=0;p<l;p+=3){r?(c[0]=r.getX(p),c[1]=r.getX(p+1),c[2]=r.getX(p+2)):(c[0]=p,c[1]=p+1,c[2]=p+2);const{a:B,b,c:y}=Mv;if(B.fromBufferAttribute(s,c[0]),b.fromBufferAttribute(s,c[1]),y.fromBufferAttribute(s,c[2]),Mv.getNormal(P2),C[0]=`${Math.round(B.x*a)},${Math.round(B.y*a)},${Math.round(B.z*a)}`,C[1]=`${Math.round(b.x*a)},${Math.round(b.y*a)},${Math.round(b.z*a)}`,C[2]=`${Math.round(y.x*a)},${Math.round(y.y*a)},${Math.round(y.z*a)}`,!(C[0]===C[1]||C[1]===C[2]||C[2]===C[0]))for(let S=0;S<3;S++){const R=(S+1)%3,Z=C[S],x=C[R],M=Mv[u[S]],E=Mv[u[R]],F=`${Z}_${x}`,N=`${x}_${Z}`;N in h&&h[N]?(P2.dot(h[N].normal)<=o&&(m.push(M.x,M.y,M.z),m.push(E.x,E.y,E.z)),h[N]=null):F in h||(h[F]={index0:c[S],index1:c[R],normal:P2.clone()})}}for(const p in h)if(h[p]){const{index0:B,index1:b}=h[p];Zv.fromBufferAttribute(s,B),xv.fromBufferAttribute(s,b),m.push(Zv.x,Zv.y,Zv.z),m.push(xv.x,xv.y,xv.z)}this.setAttribute("position",new Sn(m,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}let iI=class extends xp{constructor(e){super(e),this.uuid=Os(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let i=0,a=this.holes.length;i<a;i++)t[i]=this.holes[i].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,i=e.holes.length;t<i;t++){const a=e.holes[t];this.holes.push(a.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,i=this.holes.length;t<i;t++){const a=this.holes[t];e.holes.push(a.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,i=e.holes.length;t<i;t++){const a=e.holes[t];this.holes.push(new xp().fromJSON(a))}return this}};function xP(n,e,t=2){const i=e&&e.length,a=i?e[0]*t:n.length;let o=j9(n,0,a,t,!0);const r=[];if(!o||o.next===o.prev)return r;let s,l,c;if(i&&(o=EP(n,e,o,t)),n.length>80*t){s=1/0,l=1/0;let u=-1/0,C=-1/0;for(let h=t;h<a;h+=t){const m=n[h],p=n[h+1];m<s&&(s=m),p<l&&(l=p),m>u&&(u=m),p>C&&(C=p)}c=Math.max(u-s,C-l),c=c!==0?32767/c:0}return Mp(o,r,t,s,l,c,0),r}function j9(n,e,t,i,a){let o;if(a===OP(n,e,t,i)>0)for(let r=e;r<t;r+=i)o=PV(r/i|0,n[r],n[r+1],o);else for(let r=t-i;r>=e;r-=i)o=PV(r/i|0,n[r],n[r+1],o);return o&&Zf(o,o.next)&&(Vp(o),o=o.next),o}function lI(n,e){if(!n)return n;e||(e=n);let t=n,i;do if(i=!1,!t.steiner&&(Zf(t,t.next)||Za(t.prev,t,t.next)===0)){if(Vp(t),t=e=t.prev,t===t.next)break;i=!0}else t=t.next;while(i||t!==e);return e}function Mp(n,e,t,i,a,o,r){if(!n)return;!r&&o&&YP(n,i,a,o);let s=n;for(;n.prev!==n.next;){const l=n.prev,c=n.next;if(o?WP(n,i,a,o):MP(n)){e.push(l.i,n.i,c.i),Vp(n),n=c.next,s=c.next;continue}if(n=c,n===s){r?r===1?(n=VP(lI(n),e),Mp(n,e,t,i,a,o,2)):r===2&&NP(n,e,t,i,a,o):Mp(lI(n),e,t,i,a,o,1);break}}}function MP(n){const e=n.prev,t=n,i=n.next;if(Za(e,t,i)>=0)return!1;const a=e.x,o=t.x,r=i.x,s=e.y,l=t.y,c=i.y,u=Math.min(a,o,r),C=Math.min(s,l,c),h=Math.max(a,o,r),m=Math.max(s,l,c);let p=i.next;for(;p!==e;){if(p.x>=u&&p.x<=h&&p.y>=C&&p.y<=m&&Jm(a,s,o,l,r,c,p.x,p.y)&&Za(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function WP(n,e,t,i){const a=n.prev,o=n,r=n.next;if(Za(a,o,r)>=0)return!1;const s=a.x,l=o.x,c=r.x,u=a.y,C=o.y,h=r.y,m=Math.min(s,l,c),p=Math.min(u,C,h),B=Math.max(s,l,c),b=Math.max(u,C,h),y=J1(m,p,e,t,i),S=J1(B,b,e,t,i);let R=n.prevZ,Z=n.nextZ;for(;R&&R.z>=y&&Z&&Z.z<=S;){if(R.x>=m&&R.x<=B&&R.y>=p&&R.y<=b&&R!==a&&R!==r&&Jm(s,u,l,C,c,h,R.x,R.y)&&Za(R.prev,R,R.next)>=0||(R=R.prevZ,Z.x>=m&&Z.x<=B&&Z.y>=p&&Z.y<=b&&Z!==a&&Z!==r&&Jm(s,u,l,C,c,h,Z.x,Z.y)&&Za(Z.prev,Z,Z.next)>=0))return!1;Z=Z.nextZ}for(;R&&R.z>=y;){if(R.x>=m&&R.x<=B&&R.y>=p&&R.y<=b&&R!==a&&R!==r&&Jm(s,u,l,C,c,h,R.x,R.y)&&Za(R.prev,R,R.next)>=0)return!1;R=R.prevZ}for(;Z&&Z.z<=S;){if(Z.x>=m&&Z.x<=B&&Z.y>=p&&Z.y<=b&&Z!==a&&Z!==r&&Jm(s,u,l,C,c,h,Z.x,Z.y)&&Za(Z.prev,Z,Z.next)>=0)return!1;Z=Z.nextZ}return!0}function VP(n,e){let t=n;do{const i=t.prev,a=t.next.next;!Zf(i,a)&&q9(i,t,t.next,a)&&Wp(i,a)&&Wp(a,i)&&(e.push(i.i,t.i,a.i),Vp(t),Vp(t.next),t=n=a),t=t.next}while(t!==n);return lI(t)}function NP(n,e,t,i,a,o){let r=n;do{let s=r.next.next;for(;s!==r.prev;){if(r.i!==s.i&&LP(r,s)){let l=$9(r,s);r=lI(r,r.next),l=lI(l,l.next),Mp(r,e,t,i,a,o,0),Mp(l,e,t,i,a,o,0);return}s=s.next}r=r.next}while(r!==n)}function EP(n,e,t,i){const a=[];for(let o=0,r=e.length;o<r;o++){const s=e[o]*i,l=o<r-1?e[o+1]*i:n.length,c=j9(n,s,l,i,!1);c===c.next&&(c.steiner=!0),a.push(KP(c))}a.sort(HP);for(let o=0;o<a.length;o++)t=FP(a[o],t);return t}function HP(n,e){let t=n.x-e.x;if(t===0&&(t=n.y-e.y,t===0)){const i=(n.next.y-n.y)/(n.next.x-n.x),a=(e.next.y-e.y)/(e.next.x-e.x);t=i-a}return t}function FP(n,e){const t=XP(n,e);if(!t)return e;const i=$9(t,n);return lI(i,i.next),lI(t,t.next)}function XP(n,e){let t=e;const i=n.x,a=n.y;let o=-1/0,r;if(Zf(n,t))return t;do{if(Zf(n,t.next))return t.next;if(a<=t.y&&a>=t.next.y&&t.next.y!==t.y){const C=t.x+(a-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(C<=i&&C>o&&(o=C,r=t.x<t.next.x?t:t.next,C===i))return r}t=t.next}while(t!==e);if(!r)return null;const s=r,l=r.x,c=r.y;let u=1/0;t=r;do{if(i>=t.x&&t.x>=l&&i!==t.x&&Q9(a<c?i:o,a,l,c,a<c?o:i,a,t.x,t.y)){const C=Math.abs(a-t.y)/(i-t.x);Wp(t,n)&&(C<u||C===u&&(t.x>r.x||t.x===r.x&&TP(r,t)))&&(r=t,u=C)}t=t.next}while(t!==s);return r}function TP(n,e){return Za(n.prev,n,e.prev)<0&&Za(e.next,n,n.next)<0}function YP(n,e,t,i){let a=n;do a.z===0&&(a.z=J1(a.x,a.y,e,t,i)),a.prevZ=a.prev,a.nextZ=a.next,a=a.next;while(a!==n);a.prevZ.nextZ=null,a.prevZ=null,zP(a)}function zP(n){let e,t=1;do{let i=n,a;n=null;let o=null;for(e=0;i;){e++;let r=i,s=0;for(let c=0;c<t&&(s++,r=r.nextZ,!!r);c++);let l=t;for(;s>0||l>0&&r;)s!==0&&(l===0||!r||i.z<=r.z)?(a=i,i=i.nextZ,s--):(a=r,r=r.nextZ,l--),o?o.nextZ=a:n=a,a.prevZ=o,o=a;i=r}o.nextZ=null,t*=2}while(e>1);return n}function J1(n,e,t,i,a){return n=(n-t)*a|0,e=(e-i)*a|0,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,n|e<<1}function KP(n){let e=n,t=n;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==n);return t}function Q9(n,e,t,i,a,o,r,s){return(a-r)*(e-s)>=(n-r)*(o-s)&&(n-r)*(i-s)>=(t-r)*(e-s)&&(t-r)*(o-s)>=(a-r)*(i-s)}function Jm(n,e,t,i,a,o,r,s){return!(n===r&&e===s)&&Q9(n,e,t,i,a,o,r,s)}function LP(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!_P(n,e)&&(Wp(n,e)&&Wp(e,n)&&DP(n,e)&&(Za(n.prev,n,e.prev)||Za(n,e.prev,e))||Zf(n,e)&&Za(n.prev,n,n.next)>0&&Za(e.prev,e,e.next)>0)}function Za(n,e,t){return(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y)}function Zf(n,e){return n.x===e.x&&n.y===e.y}function q9(n,e,t,i){const a=Vv(Za(n,e,t)),o=Vv(Za(n,e,i)),r=Vv(Za(t,i,n)),s=Vv(Za(t,i,e));return!!(a!==o&&r!==s||a===0&&Wv(n,t,e)||o===0&&Wv(n,i,e)||r===0&&Wv(t,n,i)||s===0&&Wv(t,e,i))}function Wv(n,e,t){return e.x<=Math.max(n.x,t.x)&&e.x>=Math.min(n.x,t.x)&&e.y<=Math.max(n.y,t.y)&&e.y>=Math.min(n.y,t.y)}function Vv(n){return n>0?1:n<0?-1:0}function _P(n,e){let t=n;do{if(t.i!==n.i&&t.next.i!==n.i&&t.i!==e.i&&t.next.i!==e.i&&q9(t,t.next,n,e))return!0;t=t.next}while(t!==n);return!1}function Wp(n,e){return Za(n.prev,n,n.next)<0?Za(n,e,n.next)>=0&&Za(n,n.prev,e)>=0:Za(n,e,n.prev)<0||Za(n,n.next,e)<0}function DP(n,e){let t=n,i=!1;const a=(n.x+e.x)/2,o=(n.y+e.y)/2;do t.y>o!=t.next.y>o&&t.next.y!==t.y&&a<(t.next.x-t.x)*(o-t.y)/(t.next.y-t.y)+t.x&&(i=!i),t=t.next;while(t!==n);return i}function $9(n,e){const t=j1(n.i,n.x,n.y),i=j1(e.i,e.x,e.y),a=n.next,o=e.prev;return n.next=e,e.prev=n,t.next=a,a.prev=t,i.next=t,t.prev=i,o.next=i,i.prev=o,i}function PV(n,e,t,i){const a=j1(n,e,t);return i?(a.next=i.next,a.prev=i,i.next.prev=a,i.next=a):(a.prev=a,a.next=a),a}function Vp(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function j1(n,e,t){return{i:n,x:e,y:t,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function OP(n,e,t,i){let a=0;for(let o=e,r=t-i;o<t;o+=i)a+=(n[r]-n[o])*(n[o+1]+n[r+1]),r=o;return a}class UP{static triangulate(e,t,i=2){return xP(e,t,i)}}class cg{static area(e){const t=e.length;let i=0;for(let a=t-1,o=0;o<t;a=o++)i+=e[a].x*e[o].y-e[o].x*e[a].y;return i*.5}static isClockWise(e){return cg.area(e)<0}static triangulateShape(e,t){const i=[],a=[],o=[];JV(e),jV(i,e);let r=e.length;t.forEach(JV);for(let l=0;l<t.length;l++)a.push(r),r+=t[l].length,jV(i,t[l]);const s=UP.triangulate(i,a);for(let l=0;l<s.length;l+=3)o.push(s.slice(l,l+3));return o}}function JV(n){const e=n.length;e>2&&n[e-1].equals(n[0])&&n.pop()}function jV(n,e){for(let t=0;t<e.length;t++)n.push(e[t].x),n.push(e[t].y)}class HG extends $n{constructor(e=new iI([new Xt(.5,.5),new Xt(-.5,.5),new Xt(-.5,-.5),new Xt(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const i=this,a=[],o=[];for(let s=0,l=e.length;s<l;s++){const c=e[s];r(c)}this.setAttribute("position",new Sn(a,3)),this.setAttribute("uv",new Sn(o,2)),this.computeVertexNormals();function r(s){const l=[],c=t.curveSegments!==void 0?t.curveSegments:12,u=t.steps!==void 0?t.steps:1,C=t.depth!==void 0?t.depth:1;let h=t.bevelEnabled!==void 0?t.bevelEnabled:!0,m=t.bevelThickness!==void 0?t.bevelThickness:.2,p=t.bevelSize!==void 0?t.bevelSize:m-.1,B=t.bevelOffset!==void 0?t.bevelOffset:0,b=t.bevelSegments!==void 0?t.bevelSegments:3;const y=t.extrudePath,S=t.UVGenerator!==void 0?t.UVGenerator:kP;let R,Z=!1,x,M,E,F;y&&(R=y.getSpacedPoints(u),Z=!0,h=!1,x=y.computeFrenetFrames(u,!1),M=new Be,E=new Be,F=new Be),h||(b=0,m=0,p=0,B=0);const N=s.extractPoints(c);let H=N.shape;const z=N.holes;if(!cg.isClockWise(H)){H=H.reverse();for(let he=0,Ge=z.length;he<Ge;he++){const be=z[he];cg.isClockWise(be)&&(z[he]=be.reverse())}}function D(he){const be=10000000000000001e-36;let Ee=he[0];for(let Se=1;Se<=he.length;Se++){const ee=Se%he.length,Q=he[ee],ce=Q.x-Ee.x,me=Q.y-Ee.y,Ze=ce*ce+me*me,Xe=Math.max(Math.abs(Q.x),Math.abs(Q.y),Math.abs(Ee.x),Math.abs(Ee.y)),De=be*Xe*Xe;if(Ze<=De){he.splice(ee,1),Se--;continue}Ee=Q}}D(H),z.forEach(D);const P=z.length,$=H;for(let he=0;he<P;he++){const Ge=z[he];H=H.concat(Ge)}function X(he,Ge,be){return Ge||console.error("THREE.ExtrudeGeometry: vec does not exist"),he.clone().addScaledVector(Ge,be)}const L=H.length;function U(he,Ge,be){let Ee,Se,ee;const Q=he.x-Ge.x,ce=he.y-Ge.y,me=be.x-he.x,Ze=be.y-he.y,Xe=Q*Q+ce*ce,De=Q*Ze-ce*me;if(Math.abs(De)>Number.EPSILON){const Oe=Math.sqrt(Xe),Je=Math.sqrt(me*me+Ze*Ze),At=Ge.x-ce/Oe,qe=Ge.y+Q/Oe,lt=be.x-Ze/Je,$e=be.y+me/Je,je=((lt-At)*Ze-($e-qe)*me)/(Q*Ze-ce*me);Ee=At+Q*je-he.x,Se=qe+ce*je-he.y;const ke=Ee*Ee+Se*Se;if(ke<=2)return new Xt(Ee,Se);ee=Math.sqrt(ke/2)}else{let Oe=!1;Q>Number.EPSILON?me>Number.EPSILON&&(Oe=!0):Q<-Number.EPSILON?me<-Number.EPSILON&&(Oe=!0):Math.sign(ce)===Math.sign(Ze)&&(Oe=!0),Oe?(Ee=-ce,Se=Q,ee=Math.sqrt(Xe)):(Ee=Q,Se=ce,ee=Math.sqrt(Xe/2))}return new Xt(Ee/ee,Se/ee)}const q=[];for(let he=0,Ge=$.length,be=Ge-1,Ee=he+1;he<Ge;he++,be++,Ee++)be===Ge&&(be=0),Ee===Ge&&(Ee=0),q[he]=U($[he],$[be],$[Ee]);const K=[];let O,j=q.concat();for(let he=0,Ge=P;he<Ge;he++){const be=z[he];O=[];for(let Ee=0,Se=be.length,ee=Se-1,Q=Ee+1;Ee<Se;Ee++,ee++,Q++)ee===Se&&(ee=0),Q===Se&&(Q=0),O[Ee]=U(be[Ee],be[ee],be[Q]);K.push(O),j=j.concat(O)}const ne=[],k=[];for(let he=0;he<b;he++){const Ge=he/b,be=m*Math.cos(Ge*Math.PI/2),Ee=p*Math.sin(Ge*Math.PI/2)+B;for(let Se=0,ee=$.length;Se<ee;Se++){const Q=X($[Se],q[Se],Ee);ye(Q.x,Q.y,-be),Ge==0&&ne.push(Q)}for(let Se=0,ee=P;Se<ee;Se++){const Q=z[Se];O=K[Se];const ce=[];for(let me=0,Ze=Q.length;me<Ze;me++){const Xe=X(Q[me],O[me],Ee);ye(Xe.x,Xe.y,-be),Ge==0&&ce.push(Xe)}Ge==0&&k.push(ce)}}const ie=cg.triangulateShape(ne,k),re=ie.length,ge=p+B;for(let he=0;he<L;he++){const Ge=h?X(H[he],j[he],ge):H[he];Z?(E.copy(x.normals[0]).multiplyScalar(Ge.x),M.copy(x.binormals[0]).multiplyScalar(Ge.y),F.copy(R[0]).add(E).add(M),ye(F.x,F.y,F.z)):ye(Ge.x,Ge.y,0)}for(let he=1;he<=u;he++)for(let Ge=0;Ge<L;Ge++){const be=h?X(H[Ge],j[Ge],ge):H[Ge];Z?(E.copy(x.normals[he]).multiplyScalar(be.x),M.copy(x.binormals[he]).multiplyScalar(be.y),F.copy(R[he]).add(E).add(M),ye(F.x,F.y,F.z)):ye(be.x,be.y,C/u*he)}for(let he=b-1;he>=0;he--){const Ge=he/b,be=m*Math.cos(Ge*Math.PI/2),Ee=p*Math.sin(Ge*Math.PI/2)+B;for(let Se=0,ee=$.length;Se<ee;Se++){const Q=X($[Se],q[Se],Ee);ye(Q.x,Q.y,C+be)}for(let Se=0,ee=z.length;Se<ee;Se++){const Q=z[Se];O=K[Se];for(let ce=0,me=Q.length;ce<me;ce++){const Ze=X(Q[ce],O[ce],Ee);Z?ye(Ze.x,Ze.y+R[u-1].y,R[u-1].x+be):ye(Ze.x,Ze.y,C+be)}}}de(),xe();function de(){const he=a.length/3;if(h){let Ge=0,be=L*Ge;for(let Ee=0;Ee<re;Ee++){const Se=ie[Ee];pe(Se[2]+be,Se[1]+be,Se[0]+be)}Ge=u+b*2,be=L*Ge;for(let Ee=0;Ee<re;Ee++){const Se=ie[Ee];pe(Se[0]+be,Se[1]+be,Se[2]+be)}}else{for(let Ge=0;Ge<re;Ge++){const be=ie[Ge];pe(be[2],be[1],be[0])}for(let Ge=0;Ge<re;Ge++){const be=ie[Ge];pe(be[0]+L*u,be[1]+L*u,be[2]+L*u)}}i.addGroup(he,a.length/3-he,0)}function xe(){const he=a.length/3;let Ge=0;Ne($,Ge),Ge+=$.length;for(let be=0,Ee=z.length;be<Ee;be++){const Se=z[be];Ne(Se,Ge),Ge+=Se.length}i.addGroup(he,a.length/3-he,1)}function Ne(he,Ge){let be=he.length;for(;--be>=0;){const Ee=be;let Se=be-1;Se<0&&(Se=he.length-1);for(let ee=0,Q=u+b*2;ee<Q;ee++){const ce=L*ee,me=L*(ee+1),Ze=Ge+Ee+ce,Xe=Ge+Se+ce,De=Ge+Se+me,Oe=Ge+Ee+me;Te(Ze,Xe,De,Oe)}}}function ye(he,Ge,be){l.push(he),l.push(Ge),l.push(be)}function pe(he,Ge,be){le(he),le(Ge),le(be);const Ee=a.length/3,Se=S.generateTopUV(i,a,Ee-3,Ee-2,Ee-1);Ye(Se[0]),Ye(Se[1]),Ye(Se[2])}function Te(he,Ge,be,Ee){le(he),le(Ge),le(Ee),le(Ge),le(be),le(Ee);const Se=a.length/3,ee=S.generateSideWallUV(i,a,Se-6,Se-3,Se-2,Se-1);Ye(ee[0]),Ye(ee[1]),Ye(ee[3]),Ye(ee[1]),Ye(ee[2]),Ye(ee[3])}function le(he){a.push(l[he*3+0]),a.push(l[he*3+1]),a.push(l[he*3+2])}function Ye(he){o.push(he.x),o.push(he.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes,i=this.parameters.options;return PP(t,i,e)}static fromJSON(e,t){const i=[];for(let o=0,r=e.shapes.length;o<r;o++){const s=t[e.shapes[o]];i.push(s)}const a=e.options.extrudePath;return a!==void 0&&(e.options.extrudePath=new VB[a.type]().fromJSON(a)),new HG(i,e.options)}}const kP={generateTopUV:function(n,e,t,i,a){const o=e[t*3],r=e[t*3+1],s=e[i*3],l=e[i*3+1],c=e[a*3],u=e[a*3+1];return[new Xt(o,r),new Xt(s,l),new Xt(c,u)]},generateSideWallUV:function(n,e,t,i,a,o){const r=e[t*3],s=e[t*3+1],l=e[t*3+2],c=e[i*3],u=e[i*3+1],C=e[i*3+2],h=e[a*3],m=e[a*3+1],p=e[a*3+2],B=e[o*3],b=e[o*3+1],y=e[o*3+2];return Math.abs(s-u)<Math.abs(r-c)?[new Xt(r,1-l),new Xt(c,1-C),new Xt(h,1-p),new Xt(B,1-y)]:[new Xt(s,1-l),new Xt(u,1-C),new Xt(m,1-p),new Xt(b,1-y)]}};function PP(n,e,t){if(t.shapes=[],Array.isArray(n))for(let i=0,a=n.length;i<a;i++){const o=n[i];t.shapes.push(o.uuid)}else t.shapes.push(n.uuid);return t.options=Object.assign({},e),e.extrudePath!==void 0&&(t.options.extrudePath=e.extrudePath.toJSON()),t}class ub extends Rd{constructor(e=1,t=0){const i=(1+Math.sqrt(5))/2,a=[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],o=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(a,o,e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new ub(e.radius,e.detail)}}class db extends Rd{constructor(e=1,t=0){const i=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],a=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(i,a,e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new db(e.radius,e.detail)}}class pc extends $n{constructor(e=1,t=1,i=1,a=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:a};const o=e/2,r=t/2,s=Math.floor(i),l=Math.floor(a),c=s+1,u=l+1,C=e/s,h=t/l,m=[],p=[],B=[],b=[];for(let y=0;y<u;y++){const S=y*h-r;for(let R=0;R<c;R++){const Z=R*C-o;p.push(Z,-S,0),B.push(0,0,1),b.push(R/s),b.push(1-y/l)}}for(let y=0;y<l;y++)for(let S=0;S<s;S++){const R=S+c*y,Z=S+c*(y+1),x=S+1+c*(y+1),M=S+1+c*y;m.push(R,Z,M),m.push(Z,x,M)}this.setIndex(m),this.setAttribute("position",new Sn(p,3)),this.setAttribute("normal",new Sn(B,3)),this.setAttribute("uv",new Sn(b,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new pc(e.width,e.height,e.widthSegments,e.heightSegments)}}class FG extends $n{constructor(e=.5,t=1,i=32,a=1,o=0,r=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:i,phiSegments:a,thetaStart:o,thetaLength:r},i=Math.max(3,i),a=Math.max(1,a);const s=[],l=[],c=[],u=[];let C=e;const h=(t-e)/a,m=new Be,p=new Xt;for(let B=0;B<=a;B++){for(let b=0;b<=i;b++){const y=o+b/i*r;m.x=C*Math.cos(y),m.y=C*Math.sin(y),l.push(m.x,m.y,m.z),c.push(0,0,1),p.x=(m.x/t+1)/2,p.y=(m.y/t+1)/2,u.push(p.x,p.y)}C+=h}for(let B=0;B<a;B++){const b=B*(i+1);for(let y=0;y<i;y++){const S=y+b,R=S,Z=S+i+1,x=S+i+2,M=S+1;s.push(R,Z,M),s.push(Z,x,M)}}this.setIndex(s),this.setAttribute("position",new Sn(l,3)),this.setAttribute("normal",new Sn(c,3)),this.setAttribute("uv",new Sn(u,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new FG(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class XG extends $n{constructor(e=new iI([new Xt(0,.5),new Xt(-.5,-.5),new Xt(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const i=[],a=[],o=[],r=[];let s=0,l=0;if(Array.isArray(e)===!1)c(e);else for(let u=0;u<e.length;u++)c(e[u]),this.addGroup(s,l,u),s+=l,l=0;this.setIndex(i),this.setAttribute("position",new Sn(a,3)),this.setAttribute("normal",new Sn(o,3)),this.setAttribute("uv",new Sn(r,2));function c(u){const C=a.length/3,h=u.extractPoints(t);let m=h.shape;const p=h.holes;cg.isClockWise(m)===!1&&(m=m.reverse());for(let b=0,y=p.length;b<y;b++){const S=p[b];cg.isClockWise(S)===!0&&(p[b]=S.reverse())}const B=cg.triangulateShape(m,p);for(let b=0,y=p.length;b<y;b++){const S=p[b];m=m.concat(S)}for(let b=0,y=m.length;b<y;b++){const S=m[b];a.push(S.x,S.y,0),o.push(0,0,1),r.push(S.x,S.y)}for(let b=0,y=B.length;b<y;b++){const S=B[b],R=S[0]+C,Z=S[1]+C,x=S[2]+C;i.push(R,Z,x),l+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes;return JP(t,e)}static fromJSON(e,t){const i=[];for(let a=0,o=e.shapes.length;a<o;a++){const r=t[e.shapes[a]];i.push(r)}return new XG(i,e.curveSegments)}}function JP(n,e){if(e.shapes=[],Array.isArray(n))for(let t=0,i=n.length;t<i;t++){const a=n[t];e.shapes.push(a.uuid)}else e.shapes.push(n.uuid);return e}class Cb extends $n{constructor(e=1,t=32,i=16,a=0,o=Math.PI*2,r=0,s=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:i,phiStart:a,phiLength:o,thetaStart:r,thetaLength:s},t=Math.max(3,Math.floor(t)),i=Math.max(2,Math.floor(i));const l=Math.min(r+s,Math.PI);let c=0;const u=[],C=new Be,h=new Be,m=[],p=[],B=[],b=[];for(let y=0;y<=i;y++){const S=[],R=y/i;let Z=0;y===0&&r===0?Z=.5/t:y===i&&l===Math.PI&&(Z=-.5/t);for(let x=0;x<=t;x++){const M=x/t;C.x=-e*Math.cos(a+M*o)*Math.sin(r+R*s),C.y=e*Math.cos(r+R*s),C.z=e*Math.sin(a+M*o)*Math.sin(r+R*s),p.push(C.x,C.y,C.z),h.copy(C).normalize(),B.push(h.x,h.y,h.z),b.push(M+Z,1-R),S.push(c++)}u.push(S)}for(let y=0;y<i;y++)for(let S=0;S<t;S++){const R=u[y][S+1],Z=u[y][S],x=u[y+1][S],M=u[y+1][S+1];(y!==0||r>0)&&m.push(R,Z,M),(y!==i-1||l<Math.PI)&&m.push(Z,x,M)}this.setIndex(m),this.setAttribute("position",new Sn(p,3)),this.setAttribute("normal",new Sn(B,3)),this.setAttribute("uv",new Sn(b,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Cb(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class TG extends Rd{constructor(e=1,t=0){const i=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],a=[2,1,0,0,3,2,1,3,0,2,3,1];super(i,a,e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new TG(e.radius,e.detail)}}class YG extends $n{constructor(e=1,t=.4,i=12,a=48,o=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:i,tubularSegments:a,arc:o},i=Math.floor(i),a=Math.floor(a);const r=[],s=[],l=[],c=[],u=new Be,C=new Be,h=new Be;for(let m=0;m<=i;m++)for(let p=0;p<=a;p++){const B=p/a*o,b=m/i*Math.PI*2;C.x=(e+t*Math.cos(b))*Math.cos(B),C.y=(e+t*Math.cos(b))*Math.sin(B),C.z=t*Math.sin(b),s.push(C.x,C.y,C.z),u.x=e*Math.cos(B),u.y=e*Math.sin(B),h.subVectors(C,u).normalize(),l.push(h.x,h.y,h.z),c.push(p/a),c.push(m/i)}for(let m=1;m<=i;m++)for(let p=1;p<=a;p++){const B=(a+1)*m+p-1,b=(a+1)*(m-1)+p-1,y=(a+1)*(m-1)+p,S=(a+1)*m+p;r.push(B,b,S),r.push(b,y,S)}this.setIndex(r),this.setAttribute("position",new Sn(s,3)),this.setAttribute("normal",new Sn(l,3)),this.setAttribute("uv",new Sn(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new YG(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class zG extends $n{constructor(e=1,t=.4,i=64,a=8,o=2,r=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:i,radialSegments:a,p:o,q:r},i=Math.floor(i),a=Math.floor(a);const s=[],l=[],c=[],u=[],C=new Be,h=new Be,m=new Be,p=new Be,B=new Be,b=new Be,y=new Be;for(let R=0;R<=i;++R){const Z=R/i*o*Math.PI*2;S(Z,o,r,e,m),S(Z+.01,o,r,e,p),b.subVectors(p,m),y.addVectors(p,m),B.crossVectors(b,y),y.crossVectors(B,b),B.normalize(),y.normalize();for(let x=0;x<=a;++x){const M=x/a*Math.PI*2,E=-t*Math.cos(M),F=t*Math.sin(M);C.x=m.x+(E*y.x+F*B.x),C.y=m.y+(E*y.y+F*B.y),C.z=m.z+(E*y.z+F*B.z),l.push(C.x,C.y,C.z),h.subVectors(C,m).normalize(),c.push(h.x,h.y,h.z),u.push(R/i),u.push(x/a)}}for(let R=1;R<=i;R++)for(let Z=1;Z<=a;Z++){const x=(a+1)*(R-1)+(Z-1),M=(a+1)*R+(Z-1),E=(a+1)*R+Z,F=(a+1)*(R-1)+Z;s.push(x,M,F),s.push(M,E,F)}this.setIndex(s),this.setAttribute("position",new Sn(l,3)),this.setAttribute("normal",new Sn(c,3)),this.setAttribute("uv",new Sn(u,2));function S(R,Z,x,M,E){const F=Math.cos(R),N=Math.sin(R),H=x/Z*R,z=Math.cos(H);E.x=M*(2+z)*.5*F,E.y=M*(2+z)*N*.5,E.z=M*Math.sin(H)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new zG(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class KG extends $n{constructor(e=new px(new Be(-1,-1,0),new Be(-1,1,0),new Be(1,1,0)),t=64,i=1,a=8,o=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:i,radialSegments:a,closed:o};const r=e.computeFrenetFrames(t,o);this.tangents=r.tangents,this.normals=r.normals,this.binormals=r.binormals;const s=new Be,l=new Be,c=new Xt;let u=new Be;const C=[],h=[],m=[],p=[];B(),this.setIndex(p),this.setAttribute("position",new Sn(C,3)),this.setAttribute("normal",new Sn(h,3)),this.setAttribute("uv",new Sn(m,2));function B(){for(let R=0;R<t;R++)b(R);b(o===!1?t:0),S(),y()}function b(R){u=e.getPointAt(R/t,u);const Z=r.normals[R],x=r.binormals[R];for(let M=0;M<=a;M++){const E=M/a*Math.PI*2,F=Math.sin(E),N=-Math.cos(E);l.x=N*Z.x+F*x.x,l.y=N*Z.y+F*x.y,l.z=N*Z.z+F*x.z,l.normalize(),h.push(l.x,l.y,l.z),s.x=u.x+i*l.x,s.y=u.y+i*l.y,s.z=u.z+i*l.z,C.push(s.x,s.y,s.z)}}function y(){for(let R=1;R<=t;R++)for(let Z=1;Z<=a;Z++){const x=(a+1)*(R-1)+(Z-1),M=(a+1)*R+(Z-1),E=(a+1)*R+Z,F=(a+1)*(R-1)+Z;p.push(x,M,F),p.push(M,E,F)}}function S(){for(let R=0;R<=t;R++)for(let Z=0;Z<=a;Z++)c.x=R/t,c.y=Z/a,m.push(c.x,c.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new KG(new VB[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class eX extends $n{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const t=[],i=new Set,a=new Be,o=new Be;if(e.index!==null){const r=e.attributes.position,s=e.index;let l=e.groups;l.length===0&&(l=[{start:0,count:s.count,materialIndex:0}]);for(let c=0,u=l.length;c<u;++c){const C=l[c],h=C.start,m=C.count;for(let p=h,B=h+m;p<B;p+=3)for(let b=0;b<3;b++){const y=s.getX(p+b),S=s.getX(p+(b+1)%3);a.fromBufferAttribute(r,y),o.fromBufferAttribute(r,S),QV(a,o,i)===!0&&(t.push(a.x,a.y,a.z),t.push(o.x,o.y,o.z))}}}else{const r=e.attributes.position;for(let s=0,l=r.count/3;s<l;s++)for(let c=0;c<3;c++){const u=3*s+c,C=3*s+(c+1)%3;a.fromBufferAttribute(r,u),o.fromBufferAttribute(r,C),QV(a,o,i)===!0&&(t.push(a.x,a.y,a.z),t.push(o.x,o.y,o.z))}}this.setAttribute("position",new Sn(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function QV(n,e,t){const i=`${n.x},${n.y},${n.z}-${e.x},${e.y},${e.z}`,a=`${e.x},${e.y},${e.z}-${n.x},${n.y},${n.z}`;return t.has(i)===!0||t.has(a)===!0?!1:(t.add(i),t.add(a),!0)}var qV=Object.freeze({__proto__:null,BoxGeometry:wd,CapsuleGeometry:WG,CircleGeometry:VG,ConeGeometry:NG,CylinderGeometry:Uf,DodecahedronGeometry:EG,EdgesGeometry:J9,ExtrudeGeometry:HG,IcosahedronGeometry:ub,LatheGeometry:gb,OctahedronGeometry:db,PlaneGeometry:pc,PolyhedronGeometry:Rd,RingGeometry:FG,ShapeGeometry:XG,SphereGeometry:Cb,TetrahedronGeometry:TG,TorusGeometry:YG,TorusKnotGeometry:zG,TubeGeometry:KG,WireframeGeometry:eX});class tX extends ho{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new dn(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class nX extends Ur{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class Ib extends ho{constructor(e){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new dn(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new dn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Sd,this.normalScale=new Xt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ys,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Bl extends Ib{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Xt(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return jn(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new dn(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new dn(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new dn(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class iX extends ho{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new dn(16777215),this.specular=new dn(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new dn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Sd,this.normalScale=new Xt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ys,this.combine=tb,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class aX extends ho{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new dn(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new dn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Sd,this.normalScale=new Xt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class oX extends ho{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Sd,this.normalScale=new Xt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class rX extends ho{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new dn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new dn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Sd,this.normalScale=new Xt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ys,this.combine=tb,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class LG extends ho{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=b9,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class _G extends ho{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}class sX extends ho{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new dn(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Sd,this.normalScale=new Xt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class lX extends Ar{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function JC(n,e){return!n||n.constructor===e?n:typeof e.BYTES_PER_ELEMENT=="number"?new e(n):Array.prototype.slice.call(n)}function cX(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function gX(n){function e(a,o){return n[a]-n[o]}const t=n.length,i=new Array(t);for(let a=0;a!==t;++a)i[a]=a;return i.sort(e),i}function Q1(n,e,t){const i=n.length,a=new n.constructor(i);for(let o=0,r=0;r!==i;++o){const s=t[o]*e;for(let l=0;l!==e;++l)a[r++]=n[s+l]}return a}function vx(n,e,t,i){let a=1,o=n[0];for(;o!==void 0&&o[i]===void 0;)o=n[a++];if(o===void 0)return;let r=o[i];if(r!==void 0)if(Array.isArray(r))do r=o[i],r!==void 0&&(e.push(o.time),t.push(...r)),o=n[a++];while(o!==void 0);else if(r.toArray!==void 0)do r=o[i],r!==void 0&&(e.push(o.time),r.toArray(t,t.length)),o=n[a++];while(o!==void 0);else do r=o[i],r!==void 0&&(e.push(o.time),t.push(r)),o=n[a++];while(o!==void 0)}function jP(n,e,t,i,a=30){const o=n.clone();o.name=e;const r=[];for(let l=0;l<o.tracks.length;++l){const c=o.tracks[l],u=c.getValueSize(),C=[],h=[];for(let m=0;m<c.times.length;++m){const p=c.times[m]*a;if(!(p<t||p>=i)){C.push(c.times[m]);for(let B=0;B<u;++B)h.push(c.values[m*u+B])}}C.length!==0&&(c.times=JC(C,c.times.constructor),c.values=JC(h,c.values.constructor),r.push(c))}o.tracks=r;let s=1/0;for(let l=0;l<o.tracks.length;++l)s>o.tracks[l].times[0]&&(s=o.tracks[l].times[0]);for(let l=0;l<o.tracks.length;++l)o.tracks[l].shift(-1*s);return o.resetDuration(),o}function QP(n,e=0,t=n,i=30){i<=0&&(i=30);const a=t.tracks.length,o=e/i;for(let r=0;r<a;++r){const s=t.tracks[r],l=s.ValueTypeName;if(l==="bool"||l==="string")continue;const c=n.tracks.find(function(y){return y.name===s.name&&y.ValueTypeName===l});if(c===void 0)continue;let u=0;const C=s.getValueSize();s.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(u=C/3);let h=0;const m=c.getValueSize();c.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(h=m/3);const p=s.times.length-1;let B;if(o<=s.times[0]){const y=u,S=C-u;B=s.values.slice(y,S)}else if(o>=s.times[p]){const y=p*C+u,S=y+C-u;B=s.values.slice(y,S)}else{const y=s.createInterpolant(),S=u,R=C-u;y.evaluate(o),B=y.resultBuffer.slice(S,R)}l==="quaternion"&&new eo().fromArray(B).normalize().conjugate().toArray(B);const b=c.times.length;for(let y=0;y<b;++y){const S=y*m+h;if(l==="quaternion")eo.multiplyQuaternionsFlat(c.values,S,B,0,c.values,S);else{const R=m-h*2;for(let Z=0;Z<R;++Z)c.values[S+Z]-=B[Z]}}}return n.blendMode=nx,n}class qP{static convertArray(e,t){return JC(e,t)}static isTypedArray(e){return cX(e)}static getKeyframeOrder(e){return gX(e)}static sortedArray(e,t,i){return Q1(e,t,i)}static flattenJSON(e,t,i,a){vx(e,t,i,a)}static subclip(e,t,i,a,o=30){return jP(e,t,i,a,o)}static makeClipAdditive(e,t=0,i=e,a=30){return QP(e,t,i,a)}}class kf{constructor(e,t,i,a){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=a!==void 0?a:new t.constructor(i),this.sampleValues=t,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let i=this._cachedIndex,a=t[i],o=t[i-1];e:{t:{let r;n:{i:if(!(e<a)){for(let s=i+2;;){if(a===void 0){if(e<o)break i;return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===s)break;if(o=a,a=t[++i],e<a)break t}r=t.length;break n}if(!(e>=o)){const s=t[1];e<s&&(i=2,o=s);for(let l=i-2;;){if(o===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===l)break;if(a=o,o=t[--i-1],e>=o)break t}r=i,i=0;break n}break e}for(;i<r;){const s=i+r>>>1;e<t[s]?r=s:i=s+1}if(a=t[i],o=t[i-1],o===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(a===void 0)return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,o,a)}return this.interpolate_(i,o,e,a)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,a=this.valueSize,o=e*a;for(let r=0;r!==a;++r)t[r]=i[o+r];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class uX extends kf{constructor(e,t,i,a){super(e,t,i,a),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:UC,endingEnd:UC}}intervalChanged_(e,t,i){const a=this.parameterPositions;let o=e-2,r=e+1,s=a[o],l=a[r];if(s===void 0)switch(this.getSettings_().endingStart){case kC:o=e,s=2*t-i;break;case Gp:o=a.length-2,s=t+a[o]-a[o+1];break;default:o=e,s=i}if(l===void 0)switch(this.getSettings_().endingEnd){case kC:r=e,l=2*i-t;break;case Gp:r=1,l=i+a[1]-a[0];break;default:r=e-1,l=t}const c=(i-t)*.5,u=this.valueSize;this._weightPrev=c/(t-s),this._weightNext=c/(l-i),this._offsetPrev=o*u,this._offsetNext=r*u}interpolate_(e,t,i,a){const o=this.resultBuffer,r=this.sampleValues,s=this.valueSize,l=e*s,c=l-s,u=this._offsetPrev,C=this._offsetNext,h=this._weightPrev,m=this._weightNext,p=(i-t)/(a-t),B=p*p,b=B*p,y=-h*b+2*h*B-h*p,S=(1+h)*b+(-1.5-2*h)*B+(-.5+h)*p+1,R=(-1-m)*b+(1.5+m)*B+.5*p,Z=m*b-m*B;for(let x=0;x!==s;++x)o[x]=y*r[u+x]+S*r[c+x]+R*r[l+x]+Z*r[C+x];return o}}class yx extends kf{constructor(e,t,i,a){super(e,t,i,a)}interpolate_(e,t,i,a){const o=this.resultBuffer,r=this.sampleValues,s=this.valueSize,l=e*s,c=l-s,u=(i-t)/(a-t),C=1-u;for(let h=0;h!==s;++h)o[h]=r[c+h]*C+r[l+h]*u;return o}}class dX extends kf{constructor(e,t,i,a){super(e,t,i,a)}interpolate_(e){return this.copySampleValue_(e-1)}}class Gl{constructor(e,t,i,a){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=JC(t,this.TimeBufferType),this.values=JC(i,this.ValueBufferType),this.setInterpolation(a||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let i;if(t.toJSON!==this.toJSON)i=t.toJSON(e);else{i={name:e.name,times:JC(e.times,Array),values:JC(e.values,Array)};const a=e.getInterpolation();a!==e.DefaultInterpolation&&(i.interpolation=a)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new dX(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new yx(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new uX(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case Bf:t=this.InterpolantFactoryMethodDiscrete;break;case Gf:t=this.InterpolantFactoryMethodLinear;break;case vy:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){const i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(i);return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Bf;case this.InterpolantFactoryMethodLinear:return Gf;case this.InterpolantFactoryMethodSmooth:return vy}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let i=0,a=t.length;i!==a;++i)t[i]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let i=0,a=t.length;i!==a;++i)t[i]*=e}return this}trim(e,t){const i=this.times,a=i.length;let o=0,r=a-1;for(;o!==a&&i[o]<e;)++o;for(;r!==-1&&i[r]>t;)--r;if(++r,o!==0||r!==a){o>=r&&(r=Math.max(r,1),o=r-1);const s=this.getValueSize();this.times=i.slice(o,r),this.values=this.values.slice(o*s,r*s)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const i=this.times,a=this.values,o=i.length;o===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let r=null;for(let s=0;s!==o;s++){const l=i[s];if(typeof l=="number"&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,s,l),e=!1;break}if(r!==null&&r>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,s,l,r),e=!1;break}r=l}if(a!==void 0&&cX(a))for(let s=0,l=a.length;s!==l;++s){const c=a[s];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,s,c),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),i=this.getValueSize(),a=this.getInterpolation()===vy,o=e.length-1;let r=1;for(let s=1;s<o;++s){let l=!1;const c=e[s],u=e[s+1];if(c!==u&&(s!==1||c!==e[0]))if(a)l=!0;else{const C=s*i,h=C-i,m=C+i;for(let p=0;p!==i;++p){const B=t[C+p];if(B!==t[h+p]||B!==t[m+p]){l=!0;break}}}if(l){if(s!==r){e[r]=e[s];const C=s*i,h=r*i;for(let m=0;m!==i;++m)t[h+m]=t[C+m]}++r}}if(o>0){e[r]=e[o];for(let s=o*i,l=r*i,c=0;c!==i;++c)t[l+c]=t[s+c];++r}return r!==e.length?(this.times=e.slice(0,r),this.values=t.slice(0,r*i)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),i=this.constructor,a=new i(this.name,e,t);return a.createInterpolant=this.createInterpolant,a}}Gl.prototype.ValueTypeName="";Gl.prototype.TimeBufferType=Float32Array;Gl.prototype.ValueBufferType=Float32Array;Gl.prototype.DefaultInterpolation=Gf;class bI extends Gl{constructor(e,t,i){super(e,t,i)}}bI.prototype.ValueTypeName="bool";bI.prototype.ValueBufferType=Array;bI.prototype.DefaultInterpolation=Bf;bI.prototype.InterpolantFactoryMethodLinear=void 0;bI.prototype.InterpolantFactoryMethodSmooth=void 0;class Bx extends Gl{constructor(e,t,i,a){super(e,t,i,a)}}Bx.prototype.ValueTypeName="color";class cI extends Gl{constructor(e,t,i,a){super(e,t,i,a)}}cI.prototype.ValueTypeName="number";class CX extends kf{constructor(e,t,i,a){super(e,t,i,a)}interpolate_(e,t,i,a){const o=this.resultBuffer,r=this.sampleValues,s=this.valueSize,l=(i-t)/(a-t);let c=e*s;for(let u=c+s;c!==u;c+=4)eo.slerpFlat(o,0,r,c-s,r,c,l);return o}}class gI extends Gl{constructor(e,t,i,a){super(e,t,i,a)}InterpolantFactoryMethodLinear(e){return new CX(this.times,this.values,this.getValueSize(),e)}}gI.prototype.ValueTypeName="quaternion";gI.prototype.InterpolantFactoryMethodSmooth=void 0;class vI extends Gl{constructor(e,t,i){super(e,t,i)}}vI.prototype.ValueTypeName="string";vI.prototype.ValueBufferType=Array;vI.prototype.DefaultInterpolation=Bf;vI.prototype.InterpolantFactoryMethodLinear=void 0;vI.prototype.InterpolantFactoryMethodSmooth=void 0;class uI extends Gl{constructor(e,t,i,a){super(e,t,i,a)}}uI.prototype.ValueTypeName="vector";class xf{constructor(e="",t=-1,i=[],a=pG){this.name=e,this.tracks=i,this.duration=t,this.blendMode=a,this.uuid=Os(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],i=e.tracks,a=1/(e.fps||1);for(let r=0,s=i.length;r!==s;++r)t.push(eJ(i[r]).scale(a));const o=new this(e.name,e.duration,t,e.blendMode);return o.uuid=e.uuid,o}static toJSON(e){const t=[],i=e.tracks,a={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let o=0,r=i.length;o!==r;++o)t.push(Gl.toJSON(i[o]));return a}static CreateFromMorphTargetSequence(e,t,i,a){const o=t.length,r=[];for(let s=0;s<o;s++){let l=[],c=[];l.push((s+o-1)%o,s,(s+1)%o),c.push(0,1,0);const u=gX(l);l=Q1(l,1,u),c=Q1(c,1,u),!a&&l[0]===0&&(l.push(o),c.push(c[0])),r.push(new cI(".morphTargetInfluences["+t[s].name+"]",l,c).scale(1/i))}return new this(e,-1,r)}static findByName(e,t){let i=e;if(!Array.isArray(e)){const a=e;i=a.geometry&&a.geometry.animations||a.animations}for(let a=0;a<i.length;a++)if(i[a].name===t)return i[a];return null}static CreateClipsFromMorphTargetSequences(e,t,i){const a={},o=/^([\w-]*?)([\d]+)$/;for(let s=0,l=e.length;s<l;s++){const c=e[s],u=c.name.match(o);if(u&&u.length>1){const C=u[1];let h=a[C];h||(a[C]=h=[]),h.push(c)}}const r=[];for(const s in a)r.push(this.CreateFromMorphTargetSequence(s,a[s],t,i));return r}static parseAnimation(e,t){if(console.warn("THREE.AnimationClip: parseAnimation() is deprecated and will be removed with r185"),!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const i=function(C,h,m,p,B){if(m.length!==0){const b=[],y=[];vx(m,b,y,p),b.length!==0&&B.push(new C(h,b,y))}},a=[],o=e.name||"default",r=e.fps||30,s=e.blendMode;let l=e.length||-1;const c=e.hierarchy||[];for(let C=0;C<c.length;C++){const h=c[C].keys;if(!(!h||h.length===0))if(h[0].morphTargets){const m={};let p;for(p=0;p<h.length;p++)if(h[p].morphTargets)for(let B=0;B<h[p].morphTargets.length;B++)m[h[p].morphTargets[B]]=-1;for(const B in m){const b=[],y=[];for(let S=0;S!==h[p].morphTargets.length;++S){const R=h[p];b.push(R.time),y.push(R.morphTarget===B?1:0)}a.push(new cI(".morphTargetInfluence["+B+"]",b,y))}l=m.length*r}else{const m=".bones["+t[C].name+"]";i(uI,m+".position",h,"pos",a),i(gI,m+".quaternion",h,"rot",a),i(uI,m+".scale",h,"scl",a)}}return a.length===0?null:new this(o,l,a,s)}resetDuration(){const e=this.tracks;let t=0;for(let i=0,a=e.length;i!==a;++i){const o=this.tracks[i];t=Math.max(t,o.times[o.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function $P(n){switch(n.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return cI;case"vector":case"vector2":case"vector3":case"vector4":return uI;case"color":return Bx;case"quaternion":return gI;case"bool":case"boolean":return bI;case"string":return vI}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+n)}function eJ(n){if(n.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=$P(n.type);if(n.times===void 0){const t=[],i=[];vx(n.keys,t,i,"value"),n.times=t,n.values=i}return e.parse!==void 0?e.parse(n):new e(n.name,n.times,n.values,n.interpolation)}const nu={enabled:!1,files:{},add:function(n,e){this.enabled!==!1&&(this.files[n]=e)},get:function(n){if(this.enabled!==!1)return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}};class DG{constructor(e,t,i){const a=this;let o=!1,r=0,s=0,l;const c=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=i,this.itemStart=function(u){s++,o===!1&&a.onStart!==void 0&&a.onStart(u,r,s),o=!0},this.itemEnd=function(u){r++,a.onProgress!==void 0&&a.onProgress(u,r,s),r===s&&(o=!1,a.onLoad!==void 0&&a.onLoad())},this.itemError=function(u){a.onError!==void 0&&a.onError(u)},this.resolveURL=function(u){return l?l(u):u},this.setURLModifier=function(u){return l=u,this},this.addHandler=function(u,C){return c.push(u,C),this},this.removeHandler=function(u){const C=c.indexOf(u);return C!==-1&&c.splice(C,2),this},this.getHandler=function(u){for(let C=0,h=c.length;C<h;C+=2){const m=c[C],p=c[C+1];if(m.global&&(m.lastIndex=0),m.test(u))return p}return null}}}const IX=new DG;let Jo=class{constructor(e){this.manager=e!==void 0?e:IX,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const i=this;return new Promise(function(a,o){i.load(e,a,t,o)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}};Jo.DEFAULT_MATERIAL_NAME="__DEFAULT";const Jg={};class tJ extends Error{constructor(e,t){super(e),this.response=t}}class ko extends Jo{constructor(e){super(e),this.mimeType="",this.responseType=""}load(e,t,i,a){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const o=nu.get(e);if(o!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(o),this.manager.itemEnd(e)},0),o;if(Jg[e]!==void 0){Jg[e].push({onLoad:t,onProgress:i,onError:a});return}Jg[e]=[],Jg[e].push({onLoad:t,onProgress:i,onError:a});const r=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),s=this.mimeType,l=this.responseType;fetch(r).then(c=>{if(c.status===200||c.status===0){if(c.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||c.body===void 0||c.body.getReader===void 0)return c;const u=Jg[e],C=c.body.getReader(),h=c.headers.get("X-File-Size")||c.headers.get("Content-Length"),m=h?parseInt(h):0,p=m!==0;let B=0;const b=new ReadableStream({start(y){S();function S(){C.read().then(({done:R,value:Z})=>{if(R)y.close();else{B+=Z.byteLength;const x=new ProgressEvent("progress",{lengthComputable:p,loaded:B,total:m});for(let M=0,E=u.length;M<E;M++){const F=u[M];F.onProgress&&F.onProgress(x)}y.enqueue(Z),S()}},R=>{y.error(R)})}}});return new Response(b)}else throw new tJ(`fetch for "${c.url}" responded with ${c.status}: ${c.statusText}`,c)}).then(c=>{switch(l){case"arraybuffer":return c.arrayBuffer();case"blob":return c.blob();case"document":return c.text().then(u=>new DOMParser().parseFromString(u,s));case"json":return c.json();default:if(s==="")return c.text();{const C=/charset="?([^;"\s]*)"?/i.exec(s),h=C&&C[1]?C[1].toLowerCase():void 0,m=new TextDecoder(h);return c.arrayBuffer().then(p=>m.decode(p))}}}).then(c=>{nu.add(e,c);const u=Jg[e];delete Jg[e];for(let C=0,h=u.length;C<h;C++){const m=u[C];m.onLoad&&m.onLoad(c)}}).catch(c=>{const u=Jg[e];if(u===void 0)throw this.manager.itemError(e),c;delete Jg[e];for(let C=0,h=u.length;C<h;C++){const m=u[C];m.onError&&m.onError(c)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class nJ extends Jo{constructor(e){super(e)}load(e,t,i,a){const o=this,r=new ko(this.manager);r.setPath(this.path),r.setRequestHeader(this.requestHeader),r.setWithCredentials(this.withCredentials),r.load(e,function(s){try{t(o.parse(JSON.parse(s)))}catch(l){a?a(l):console.error(l),o.manager.itemError(e)}},i,a)}parse(e){const t=[];for(let i=0;i<e.length;i++){const a=xf.parse(e[i]);t.push(a)}return t}}class iJ extends Jo{constructor(e){super(e)}load(e,t,i,a){const o=this,r=[],s=new ZG,l=new ko(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(o.withCredentials);let c=0;function u(C){l.load(e[C],function(h){const m=o.parse(h,!0);r[C]={width:m.width,height:m.height,format:m.format,mipmaps:m.mipmaps},c+=1,c===6&&(m.mipmapCount===1&&(s.minFilter=Bi),s.image=r,s.format=m.format,s.needsUpdate=!0,t&&t(s))},i,a)}if(Array.isArray(e))for(let C=0,h=e.length;C<h;++C)u(C);else l.load(e,function(C){const h=o.parse(C,!0);if(h.isCubemap){const m=h.mipmaps.length/h.mipmapCount;for(let p=0;p<m;p++){r[p]={mipmaps:[]};for(let B=0;B<h.mipmapCount;B++)r[p].mipmaps.push(h.mipmaps[p*h.mipmapCount+B]),r[p].format=h.format,r[p].width=h.width,r[p].height=h.height}s.image=r}else s.image.width=h.width,s.image.height=h.height,s.mipmaps=h.mipmaps;h.mipmapCount===1&&(s.minFilter=Bi),s.format=h.format,s.needsUpdate=!0,t&&t(s)},i,a);return s}}class Np extends Jo{constructor(e){super(e)}load(e,t,i,a){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const o=this,r=nu.get(e);if(r!==void 0)return o.manager.itemStart(e),setTimeout(function(){t&&t(r),o.manager.itemEnd(e)},0),r;const s=Zp("img");function l(){u(),nu.add(e,this),t&&t(this),o.manager.itemEnd(e)}function c(C){u(),a&&a(C),o.manager.itemError(e),o.manager.itemEnd(e)}function u(){s.removeEventListener("load",l,!1),s.removeEventListener("error",c,!1)}return s.addEventListener("load",l,!1),s.addEventListener("error",c,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(s.crossOrigin=this.crossOrigin),o.manager.itemStart(e),s.src=e,s}}class hX extends Jo{constructor(e){super(e)}load(e,t,i,a){const o=new rb;o.colorSpace=Uo;const r=new Np(this.manager);r.setCrossOrigin(this.crossOrigin),r.setPath(this.path);let s=0;function l(c){r.load(e[c],function(u){o.images[c]=u,s++,s===6&&(o.needsUpdate=!0,t&&t(o))},void 0,a)}for(let c=0;c<e.length;++c)l(c);return o}}class Gx extends Jo{constructor(e){super(e)}load(e,t,i,a){const o=this,r=new gc,s=new ko(this.manager);return s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setPath(this.path),s.setWithCredentials(o.withCredentials),s.load(e,function(l){let c;try{c=o.parse(l)}catch(u){if(a!==void 0)a(u);else{console.error(u);return}}c.image!==void 0?r.image=c.image:c.data!==void 0&&(r.image.width=c.width,r.image.height=c.height,r.image.data=c.data),r.wrapS=c.wrapS!==void 0?c.wrapS:Ka,r.wrapT=c.wrapT!==void 0?c.wrapT:Ka,r.magFilter=c.magFilter!==void 0?c.magFilter:Bi,r.minFilter=c.minFilter!==void 0?c.minFilter:Bi,r.anisotropy=c.anisotropy!==void 0?c.anisotropy:1,c.colorSpace!==void 0&&(r.colorSpace=c.colorSpace),c.flipY!==void 0&&(r.flipY=c.flipY),c.format!==void 0&&(r.format=c.format),c.type!==void 0&&(r.type=c.type),c.mipmaps!==void 0&&(r.mipmaps=c.mipmaps,r.minFilter=pl),c.mipmapCount===1&&(r.minFilter=Bi),c.generateMipmaps!==void 0&&(r.generateMipmaps=c.generateMipmaps),r.needsUpdate=!0,t&&t(r,c)},i,a),r}}class fX extends Jo{constructor(e){super(e)}load(e,t,i,a){const o=new Fi,r=new Np(this.manager);return r.setCrossOrigin(this.crossOrigin),r.setPath(this.path),r.load(e,function(s){o.image=s,o.needsUpdate=!0,t!==void 0&&t(o)},i,a),o}}class Zd extends Ii{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new dn(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),this.target!==void 0&&(t.object.target=this.target.uuid),t}}class AX extends Zd{constructor(e,t,i){super(e,i),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Ii.DEFAULT_UP),this.updateMatrix(),this.groundColor=new dn(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const J2=new Vn,$V=new Be,eN=new Be;class Sx{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Xt(512,512),this.map=null,this.mapPass=null,this.matrix=new Vn,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new cb,this._frameExtents=new Xt(1,1),this._viewportCount=1,this._viewports=[new yi(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,i=this.matrix;$V.setFromMatrixPosition(e.matrixWorld),t.position.copy($V),eN.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(eN),t.updateMatrixWorld(),J2.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(J2),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(J2)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class aJ extends Sx{constructor(){super(new fa(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,i=Sf*2*e.angle*this.focus,a=this.mapSize.width/this.mapSize.height,o=e.distance||t.far;(i!==t.fov||a!==t.aspect||o!==t.far)&&(t.fov=i,t.aspect=a,t.far=o,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class wx extends Zd{constructor(e,t,i=0,a=Math.PI/3,o=0,r=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Ii.DEFAULT_UP),this.updateMatrix(),this.target=new Ii,this.distance=i,this.angle=a,this.penumbra=o,this.decay=r,this.map=null,this.shadow=new aJ}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const tN=new Vn,Mm=new Be,j2=new Be;class oJ extends Sx{constructor(){super(new fa(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Xt(4,2),this._viewportCount=6,this._viewports=[new yi(2,1,1,1),new yi(0,1,1,1),new yi(3,1,1,1),new yi(1,1,1,1),new yi(3,0,1,1),new yi(1,0,1,1)],this._cubeDirections=[new Be(1,0,0),new Be(-1,0,0),new Be(0,0,1),new Be(0,0,-1),new Be(0,1,0),new Be(0,-1,0)],this._cubeUps=[new Be(0,1,0),new Be(0,1,0),new Be(0,1,0),new Be(0,1,0),new Be(0,0,1),new Be(0,0,-1)]}updateMatrices(e,t=0){const i=this.camera,a=this.matrix,o=e.distance||i.far;o!==i.far&&(i.far=o,i.updateProjectionMatrix()),Mm.setFromMatrixPosition(e.matrixWorld),i.position.copy(Mm),j2.copy(i.position),j2.add(this._cubeDirections[t]),i.up.copy(this._cubeUps[t]),i.lookAt(j2),i.updateMatrixWorld(),a.makeTranslation(-Mm.x,-Mm.y,-Mm.z),tN.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(tN)}}class Rx extends Zd{constructor(e,t,i=0,a=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=a,this.shadow=new oJ}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class bl extends BG{constructor(e=-1,t=1,i=1,a=-1,o=.1,r=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=a,this.near=o,this.far=r,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,i,a,o,r){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=a,this.view.width=o,this.view.height=r,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,a=(this.top+this.bottom)/2;let o=i-e,r=i+e,s=a+t,l=a-t;if(this.view!==null&&this.view.enabled){const c=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;o+=c*this.view.offsetX,r=o+c*this.view.width,s-=u*this.view.offsetY,l=s-u*this.view.height}this.projectionMatrix.makeOrthographic(o,r,s,l,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}class rJ extends Sx{constructor(){super(new bl(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class Zx extends Zd{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Ii.DEFAULT_UP),this.updateMatrix(),this.target=new Ii,this.shadow=new rJ}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class mX extends Zd{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class pX extends Zd{constructor(e,t,i=10,a=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=i,this.height=a}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class bX{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new Be)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const i=e.x,a=e.y,o=e.z,r=this.coefficients;return t.copy(r[0]).multiplyScalar(.282095),t.addScaledVector(r[1],.488603*a),t.addScaledVector(r[2],.488603*o),t.addScaledVector(r[3],.488603*i),t.addScaledVector(r[4],1.092548*(i*a)),t.addScaledVector(r[5],1.092548*(a*o)),t.addScaledVector(r[6],.315392*(3*o*o-1)),t.addScaledVector(r[7],1.092548*(i*o)),t.addScaledVector(r[8],.546274*(i*i-a*a)),t}getIrradianceAt(e,t){const i=e.x,a=e.y,o=e.z,r=this.coefficients;return t.copy(r[0]).multiplyScalar(.886227),t.addScaledVector(r[1],2*.511664*a),t.addScaledVector(r[2],2*.511664*o),t.addScaledVector(r[3],2*.511664*i),t.addScaledVector(r[4],2*.429043*i*a),t.addScaledVector(r[5],2*.429043*a*o),t.addScaledVector(r[6],.743125*o*o-.247708),t.addScaledVector(r[7],2*.429043*i*o),t.addScaledVector(r[8],.429043*(i*i-a*a)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let i=0;i<9;i++)this.coefficients[i].addScaledVector(e.coefficients[i],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let i=0;i<9;i++)this.coefficients[i].lerp(e.coefficients[i],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){const i=this.coefficients;for(let a=0;a<9;a++)i[a].fromArray(e,t+a*3);return this}toArray(e=[],t=0){const i=this.coefficients;for(let a=0;a<9;a++)i[a].toArray(e,t+a*3);return e}static getBasisAt(e,t){const i=e.x,a=e.y,o=e.z;t[0]=.282095,t[1]=.488603*a,t[2]=.488603*o,t[3]=.488603*i,t[4]=1.092548*i*a,t[5]=1.092548*a*o,t[6]=.315392*(3*o*o-1),t[7]=1.092548*i*o,t[8]=.546274*(i*i-a*a)}}class vX extends Zd{constructor(e=new bX,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class OG extends Jo{constructor(e){super(e),this.textures={}}load(e,t,i,a){const o=this,r=new ko(o.manager);r.setPath(o.path),r.setRequestHeader(o.requestHeader),r.setWithCredentials(o.withCredentials),r.load(e,function(s){try{t(o.parse(JSON.parse(s)))}catch(l){a?a(l):console.error(l),o.manager.itemError(e)}},i,a)}parse(e){const t=this.textures;function i(o){return t[o]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",o),t[o]}const a=this.createMaterialFromType(e.type);if(e.uuid!==void 0&&(a.uuid=e.uuid),e.name!==void 0&&(a.name=e.name),e.color!==void 0&&a.color!==void 0&&a.color.setHex(e.color),e.roughness!==void 0&&(a.roughness=e.roughness),e.metalness!==void 0&&(a.metalness=e.metalness),e.sheen!==void 0&&(a.sheen=e.sheen),e.sheenColor!==void 0&&(a.sheenColor=new dn().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(a.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&a.emissive!==void 0&&a.emissive.setHex(e.emissive),e.specular!==void 0&&a.specular!==void 0&&a.specular.setHex(e.specular),e.specularIntensity!==void 0&&(a.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&a.specularColor!==void 0&&a.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(a.shininess=e.shininess),e.clearcoat!==void 0&&(a.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(a.clearcoatRoughness=e.clearcoatRoughness),e.dispersion!==void 0&&(a.dispersion=e.dispersion),e.iridescence!==void 0&&(a.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(a.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(a.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(a.transmission=e.transmission),e.thickness!==void 0&&(a.thickness=e.thickness),e.attenuationDistance!==void 0&&(a.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&a.attenuationColor!==void 0&&a.attenuationColor.setHex(e.attenuationColor),e.anisotropy!==void 0&&(a.anisotropy=e.anisotropy),e.anisotropyRotation!==void 0&&(a.anisotropyRotation=e.anisotropyRotation),e.fog!==void 0&&(a.fog=e.fog),e.flatShading!==void 0&&(a.flatShading=e.flatShading),e.blending!==void 0&&(a.blending=e.blending),e.combine!==void 0&&(a.combine=e.combine),e.side!==void 0&&(a.side=e.side),e.shadowSide!==void 0&&(a.shadowSide=e.shadowSide),e.opacity!==void 0&&(a.opacity=e.opacity),e.transparent!==void 0&&(a.transparent=e.transparent),e.alphaTest!==void 0&&(a.alphaTest=e.alphaTest),e.alphaHash!==void 0&&(a.alphaHash=e.alphaHash),e.depthFunc!==void 0&&(a.depthFunc=e.depthFunc),e.depthTest!==void 0&&(a.depthTest=e.depthTest),e.depthWrite!==void 0&&(a.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(a.colorWrite=e.colorWrite),e.blendSrc!==void 0&&(a.blendSrc=e.blendSrc),e.blendDst!==void 0&&(a.blendDst=e.blendDst),e.blendEquation!==void 0&&(a.blendEquation=e.blendEquation),e.blendSrcAlpha!==void 0&&(a.blendSrcAlpha=e.blendSrcAlpha),e.blendDstAlpha!==void 0&&(a.blendDstAlpha=e.blendDstAlpha),e.blendEquationAlpha!==void 0&&(a.blendEquationAlpha=e.blendEquationAlpha),e.blendColor!==void 0&&a.blendColor!==void 0&&a.blendColor.setHex(e.blendColor),e.blendAlpha!==void 0&&(a.blendAlpha=e.blendAlpha),e.stencilWriteMask!==void 0&&(a.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(a.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(a.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(a.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(a.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(a.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(a.stencilZPass=e.stencilZPass),e.stencilWrite!==void 0&&(a.stencilWrite=e.stencilWrite),e.wireframe!==void 0&&(a.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(a.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(a.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(a.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(a.rotation=e.rotation),e.linewidth!==void 0&&(a.linewidth=e.linewidth),e.dashSize!==void 0&&(a.dashSize=e.dashSize),e.gapSize!==void 0&&(a.gapSize=e.gapSize),e.scale!==void 0&&(a.scale=e.scale),e.polygonOffset!==void 0&&(a.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(a.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(a.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(a.dithering=e.dithering),e.alphaToCoverage!==void 0&&(a.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(a.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(a.forceSinglePass=e.forceSinglePass),e.visible!==void 0&&(a.visible=e.visible),e.toneMapped!==void 0&&(a.toneMapped=e.toneMapped),e.userData!==void 0&&(a.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?a.vertexColors=e.vertexColors>0:a.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const o in e.uniforms){const r=e.uniforms[o];switch(a.uniforms[o]={},r.type){case"t":a.uniforms[o].value=i(r.value);break;case"c":a.uniforms[o].value=new dn().setHex(r.value);break;case"v2":a.uniforms[o].value=new Xt().fromArray(r.value);break;case"v3":a.uniforms[o].value=new Be().fromArray(r.value);break;case"v4":a.uniforms[o].value=new yi().fromArray(r.value);break;case"m3":a.uniforms[o].value=new Jn().fromArray(r.value);break;case"m4":a.uniforms[o].value=new Vn().fromArray(r.value);break;default:a.uniforms[o].value=r.value}}if(e.defines!==void 0&&(a.defines=e.defines),e.vertexShader!==void 0&&(a.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(a.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(a.glslVersion=e.glslVersion),e.extensions!==void 0)for(const o in e.extensions)a.extensions[o]=e.extensions[o];if(e.lights!==void 0&&(a.lights=e.lights),e.clipping!==void 0&&(a.clipping=e.clipping),e.size!==void 0&&(a.size=e.size),e.sizeAttenuation!==void 0&&(a.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(a.map=i(e.map)),e.matcap!==void 0&&(a.matcap=i(e.matcap)),e.alphaMap!==void 0&&(a.alphaMap=i(e.alphaMap)),e.bumpMap!==void 0&&(a.bumpMap=i(e.bumpMap)),e.bumpScale!==void 0&&(a.bumpScale=e.bumpScale),e.normalMap!==void 0&&(a.normalMap=i(e.normalMap)),e.normalMapType!==void 0&&(a.normalMapType=e.normalMapType),e.normalScale!==void 0){let o=e.normalScale;Array.isArray(o)===!1&&(o=[o,o]),a.normalScale=new Xt().fromArray(o)}return e.displacementMap!==void 0&&(a.displacementMap=i(e.displacementMap)),e.displacementScale!==void 0&&(a.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(a.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(a.roughnessMap=i(e.roughnessMap)),e.metalnessMap!==void 0&&(a.metalnessMap=i(e.metalnessMap)),e.emissiveMap!==void 0&&(a.emissiveMap=i(e.emissiveMap)),e.emissiveIntensity!==void 0&&(a.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(a.specularMap=i(e.specularMap)),e.specularIntensityMap!==void 0&&(a.specularIntensityMap=i(e.specularIntensityMap)),e.specularColorMap!==void 0&&(a.specularColorMap=i(e.specularColorMap)),e.envMap!==void 0&&(a.envMap=i(e.envMap)),e.envMapRotation!==void 0&&a.envMapRotation.fromArray(e.envMapRotation),e.envMapIntensity!==void 0&&(a.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(a.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(a.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(a.lightMap=i(e.lightMap)),e.lightMapIntensity!==void 0&&(a.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(a.aoMap=i(e.aoMap)),e.aoMapIntensity!==void 0&&(a.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(a.gradientMap=i(e.gradientMap)),e.clearcoatMap!==void 0&&(a.clearcoatMap=i(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(a.clearcoatRoughnessMap=i(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(a.clearcoatNormalMap=i(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(a.clearcoatNormalScale=new Xt().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(a.iridescenceMap=i(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(a.iridescenceThicknessMap=i(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(a.transmissionMap=i(e.transmissionMap)),e.thicknessMap!==void 0&&(a.thicknessMap=i(e.thicknessMap)),e.anisotropyMap!==void 0&&(a.anisotropyMap=i(e.anisotropyMap)),e.sheenColorMap!==void 0&&(a.sheenColorMap=i(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(a.sheenRoughnessMap=i(e.sheenRoughnessMap)),a}setTextures(e){return this.textures=e,this}createMaterialFromType(e){return OG.createMaterialFromType(e)}static createMaterialFromType(e){const t={ShadowMaterial:tX,SpriteMaterial:gx,RawShaderMaterial:nX,ShaderMaterial:Ur,PointsMaterial:RG,MeshPhysicalMaterial:Bl,MeshStandardMaterial:Ib,MeshPhongMaterial:iX,MeshToonMaterial:aX,MeshNormalMaterial:oX,MeshLambertMaterial:rX,MeshDepthMaterial:LG,MeshDistanceMaterial:_G,MeshBasicMaterial:Or,MeshMatcapMaterial:sX,LineDashedMaterial:lX,LineBasicMaterial:Ar,Material:ho};return new t[e]}}class Ad{static extractUrlBase(e){const t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class xx extends $n{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class yX extends Jo{constructor(e){super(e)}load(e,t,i,a){const o=this,r=new ko(o.manager);r.setPath(o.path),r.setRequestHeader(o.requestHeader),r.setWithCredentials(o.withCredentials),r.load(e,function(s){try{t(o.parse(JSON.parse(s)))}catch(l){a?a(l):console.error(l),o.manager.itemError(e)}},i,a)}parse(e){const t={},i={};function a(m,p){if(t[p]!==void 0)return t[p];const b=m.interleavedBuffers[p],y=o(m,b.buffer),S=nf(b.type,y),R=new lb(S,b.stride);return R.uuid=b.uuid,t[p]=R,R}function o(m,p){if(i[p]!==void 0)return i[p];const b=m.arrayBuffers[p],y=new Uint32Array(b).buffer;return i[p]=y,y}const r=e.isInstancedBufferGeometry?new xx:new $n,s=e.data.index;if(s!==void 0){const m=nf(s.type,s.array);r.setIndex(new Mi(m,1))}const l=e.data.attributes;for(const m in l){const p=l[m];let B;if(p.isInterleavedBufferAttribute){const b=a(e.data,p.data);B=new vd(b,p.itemSize,p.offset,p.normalized)}else{const b=nf(p.type,p.array),y=p.isInstancedBufferAttribute?yd:Mi;B=new y(b,p.itemSize,p.normalized)}p.name!==void 0&&(B.name=p.name),p.usage!==void 0&&B.setUsage(p.usage),r.setAttribute(m,B)}const c=e.data.morphAttributes;if(c)for(const m in c){const p=c[m],B=[];for(let b=0,y=p.length;b<y;b++){const S=p[b];let R;if(S.isInterleavedBufferAttribute){const Z=a(e.data,S.data);R=new vd(Z,S.itemSize,S.offset,S.normalized)}else{const Z=nf(S.type,S.array);R=new Mi(Z,S.itemSize,S.normalized)}S.name!==void 0&&(R.name=S.name),B.push(R)}r.morphAttributes[m]=B}e.data.morphTargetsRelative&&(r.morphTargetsRelative=!0);const C=e.data.groups||e.data.drawcalls||e.data.offsets;if(C!==void 0)for(let m=0,p=C.length;m!==p;++m){const B=C[m];r.addGroup(B.start,B.count,B.materialIndex)}const h=e.data.boundingSphere;if(h!==void 0){const m=new Be;h.center!==void 0&&m.fromArray(h.center),r.boundingSphere=new Vo(m,h.radius)}return e.name&&(r.name=e.name),e.userData&&(r.userData=e.userData),r}}class sJ extends Jo{constructor(e){super(e)}load(e,t,i,a){const o=this,r=this.path===""?Ad.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||r;const s=new ko(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,function(l){let c=null;try{c=JSON.parse(l)}catch(C){a!==void 0&&a(C),console.error("THREE:ObjectLoader: Can't parse "+e+".",C.message);return}const u=c.metadata;if(u===void 0||u.type===void 0||u.type.toLowerCase()==="geometry"){a!==void 0&&a(new Error("THREE.ObjectLoader: Can't load "+e)),console.error("THREE.ObjectLoader: Can't load "+e);return}o.parse(c,t)},i,a)}async loadAsync(e,t){const i=this,a=this.path===""?Ad.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||a;const o=new ko(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials);const r=await o.loadAsync(e,t),s=JSON.parse(r),l=s.metadata;if(l===void 0||l.type===void 0||l.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await i.parseAsync(s)}parse(e,t){const i=this.parseAnimations(e.animations),a=this.parseShapes(e.shapes),o=this.parseGeometries(e.geometries,a),r=this.parseImages(e.images,function(){t!==void 0&&t(c)}),s=this.parseTextures(e.textures,r),l=this.parseMaterials(e.materials,s),c=this.parseObject(e.object,o,l,s,i),u=this.parseSkeletons(e.skeletons,c);if(this.bindSkeletons(c,u),this.bindLightTargets(c),t!==void 0){let C=!1;for(const h in r)if(r[h].data instanceof HTMLImageElement){C=!0;break}C===!1&&t(c)}return c}async parseAsync(e){const t=this.parseAnimations(e.animations),i=this.parseShapes(e.shapes),a=this.parseGeometries(e.geometries,i),o=await this.parseImagesAsync(e.images),r=this.parseTextures(e.textures,o),s=this.parseMaterials(e.materials,r),l=this.parseObject(e.object,a,s,r,t),c=this.parseSkeletons(e.skeletons,l);return this.bindSkeletons(l,c),this.bindLightTargets(l),l}parseShapes(e){const t={};if(e!==void 0)for(let i=0,a=e.length;i<a;i++){const o=new iI().fromJSON(e[i]);t[o.uuid]=o}return t}parseSkeletons(e,t){const i={},a={};if(t.traverse(function(o){o.isBone&&(a[o.uuid]=o)}),e!==void 0)for(let o=0,r=e.length;o<r;o++){const s=new dx().fromJSON(e[o],a);i[s.uuid]=s}return i}parseGeometries(e,t){const i={};if(e!==void 0){const a=new yX;for(let o=0,r=e.length;o<r;o++){let s;const l=e[o];switch(l.type){case"BufferGeometry":case"InstancedBufferGeometry":s=a.parse(l);break;default:l.type in qV?s=qV[l.type].fromJSON(l,t):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${l.type}"`)}s.uuid=l.uuid,l.name!==void 0&&(s.name=l.name),l.userData!==void 0&&(s.userData=l.userData),i[l.uuid]=s}}return i}parseMaterials(e,t){const i={},a={};if(e!==void 0){const o=new OG;o.setTextures(t);for(let r=0,s=e.length;r<s;r++){const l=e[r];i[l.uuid]===void 0&&(i[l.uuid]=o.parse(l)),a[l.uuid]=i[l.uuid]}}return a}parseAnimations(e){const t={};if(e!==void 0)for(let i=0;i<e.length;i++){const a=e[i],o=xf.parse(a);t[o.uuid]=o}return t}parseImages(e,t){const i=this,a={};let o;function r(l){return i.manager.itemStart(l),o.load(l,function(){i.manager.itemEnd(l)},void 0,function(){i.manager.itemError(l),i.manager.itemEnd(l)})}function s(l){if(typeof l=="string"){const c=l,u=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c)?c:i.resourcePath+c;return r(u)}else return l.data?{data:nf(l.type,l.data),width:l.width,height:l.height}:null}if(e!==void 0&&e.length>0){const l=new DG(t);o=new Np(l),o.setCrossOrigin(this.crossOrigin);for(let c=0,u=e.length;c<u;c++){const C=e[c],h=C.url;if(Array.isArray(h)){const m=[];for(let p=0,B=h.length;p<B;p++){const b=h[p],y=s(b);y!==null&&(y instanceof HTMLImageElement?m.push(y):m.push(new gc(y.data,y.width,y.height)))}a[C.uuid]=new dd(m)}else{const m=s(C.url);a[C.uuid]=new dd(m)}}}return a}async parseImagesAsync(e){const t=this,i={};let a;async function o(r){if(typeof r=="string"){const s=r,l=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(s)?s:t.resourcePath+s;return await a.loadAsync(l)}else return r.data?{data:nf(r.type,r.data),width:r.width,height:r.height}:null}if(e!==void 0&&e.length>0){a=new Np(this.manager),a.setCrossOrigin(this.crossOrigin);for(let r=0,s=e.length;r<s;r++){const l=e[r],c=l.url;if(Array.isArray(c)){const u=[];for(let C=0,h=c.length;C<h;C++){const m=c[C],p=await o(m);p!==null&&(p instanceof HTMLImageElement?u.push(p):u.push(new gc(p.data,p.width,p.height)))}i[l.uuid]=new dd(u)}else{const u=await o(l.url);i[l.uuid]=new dd(u)}}}return i}parseTextures(e,t){function i(o,r){return typeof o=="number"?o:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",o),r[o])}const a={};if(e!==void 0)for(let o=0,r=e.length;o<r;o++){const s=e[o];s.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',s.uuid),t[s.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",s.image);const l=t[s.image],c=l.data;let u;Array.isArray(c)?(u=new rb,c.length===6&&(u.needsUpdate=!0)):(c&&c.data?u=new gc:u=new Fi,c&&(u.needsUpdate=!0)),u.source=l,u.uuid=s.uuid,s.name!==void 0&&(u.name=s.name),s.mapping!==void 0&&(u.mapping=i(s.mapping,lJ)),s.channel!==void 0&&(u.channel=s.channel),s.offset!==void 0&&u.offset.fromArray(s.offset),s.repeat!==void 0&&u.repeat.fromArray(s.repeat),s.center!==void 0&&u.center.fromArray(s.center),s.rotation!==void 0&&(u.rotation=s.rotation),s.wrap!==void 0&&(u.wrapS=i(s.wrap[0],nN),u.wrapT=i(s.wrap[1],nN)),s.format!==void 0&&(u.format=s.format),s.internalFormat!==void 0&&(u.internalFormat=s.internalFormat),s.type!==void 0&&(u.type=s.type),s.colorSpace!==void 0&&(u.colorSpace=s.colorSpace),s.minFilter!==void 0&&(u.minFilter=i(s.minFilter,iN)),s.magFilter!==void 0&&(u.magFilter=i(s.magFilter,iN)),s.anisotropy!==void 0&&(u.anisotropy=s.anisotropy),s.flipY!==void 0&&(u.flipY=s.flipY),s.generateMipmaps!==void 0&&(u.generateMipmaps=s.generateMipmaps),s.premultiplyAlpha!==void 0&&(u.premultiplyAlpha=s.premultiplyAlpha),s.unpackAlignment!==void 0&&(u.unpackAlignment=s.unpackAlignment),s.compareFunction!==void 0&&(u.compareFunction=s.compareFunction),s.userData!==void 0&&(u.userData=s.userData),a[s.uuid]=u}return a}parseObject(e,t,i,a,o){let r;function s(h){return t[h]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",h),t[h]}function l(h){if(h!==void 0){if(Array.isArray(h)){const m=[];for(let p=0,B=h.length;p<B;p++){const b=h[p];i[b]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",b),m.push(i[b])}return m}return i[h]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",h),i[h]}}function c(h){return a[h]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",h),a[h]}let u,C;switch(e.type){case"Scene":r=new sb,e.background!==void 0&&(Number.isInteger(e.background)?r.background=new dn(e.background):r.background=c(e.background)),e.environment!==void 0&&(r.environment=c(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?r.fog=new SG(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(r.fog=new GG(e.fog.color,e.fog.density)),e.fog.name!==""&&(r.fog.name=e.fog.name)),e.backgroundBlurriness!==void 0&&(r.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(r.backgroundIntensity=e.backgroundIntensity),e.backgroundRotation!==void 0&&r.backgroundRotation.fromArray(e.backgroundRotation),e.environmentIntensity!==void 0&&(r.environmentIntensity=e.environmentIntensity),e.environmentRotation!==void 0&&r.environmentRotation.fromArray(e.environmentRotation);break;case"PerspectiveCamera":r=new fa(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(r.focus=e.focus),e.zoom!==void 0&&(r.zoom=e.zoom),e.filmGauge!==void 0&&(r.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(r.filmOffset=e.filmOffset),e.view!==void 0&&(r.view=Object.assign({},e.view));break;case"OrthographicCamera":r=new bl(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(r.zoom=e.zoom),e.view!==void 0&&(r.view=Object.assign({},e.view));break;case"AmbientLight":r=new mX(e.color,e.intensity);break;case"DirectionalLight":r=new Zx(e.color,e.intensity),r.target=e.target||"";break;case"PointLight":r=new Rx(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":r=new pX(e.color,e.intensity,e.width,e.height);break;case"SpotLight":r=new wx(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay),r.target=e.target||"";break;case"HemisphereLight":r=new AX(e.color,e.groundColor,e.intensity);break;case"LightProbe":r=new vX().fromJSON(e);break;case"SkinnedMesh":u=s(e.geometry),C=l(e.material),r=new ux(u,C),e.bindMode!==void 0&&(r.bindMode=e.bindMode),e.bindMatrix!==void 0&&r.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(r.skeleton=e.skeleton);break;case"Mesh":u=s(e.geometry),C=l(e.material),r=new $i(u,C);break;case"InstancedMesh":u=s(e.geometry),C=l(e.material);const h=e.count,m=e.instanceMatrix,p=e.instanceColor;r=new nI(u,C,h),r.instanceMatrix=new yd(new Float32Array(m.array),16),p!==void 0&&(r.instanceColor=new yd(new Float32Array(p.array),p.itemSize));break;case"BatchedMesh":u=s(e.geometry),C=l(e.material),r=new K9(e.maxInstanceCount,e.maxVertexCount,e.maxIndexCount,C),r.geometry=u,r.perObjectFrustumCulled=e.perObjectFrustumCulled,r.sortObjects=e.sortObjects,r._drawRanges=e.drawRanges,r._reservedRanges=e.reservedRanges,r._visibility=e.visibility,r._active=e.active,r._bounds=e.bounds.map(B=>{const b=new Wo;b.min.fromArray(B.boxMin),b.max.fromArray(B.boxMax);const y=new Vo;return y.radius=B.sphereRadius,y.center.fromArray(B.sphereCenter),{boxInitialized:B.boxInitialized,box:b,sphereInitialized:B.sphereInitialized,sphere:y}}),r._maxInstanceCount=e.maxInstanceCount,r._maxVertexCount=e.maxVertexCount,r._maxIndexCount=e.maxIndexCount,r._geometryInitialized=e.geometryInitialized,r._geometryCount=e.geometryCount,r._matricesTexture=c(e.matricesTexture.uuid),e.colorsTexture!==void 0&&(r._colorsTexture=c(e.colorsTexture.uuid));break;case"LOD":r=new Y9;break;case"Line":r=new uu(s(e.geometry),l(e.material));break;case"LineLoop":r=new Cx(s(e.geometry),l(e.material));break;case"LineSegments":r=new Ac(s(e.geometry),l(e.material));break;case"PointCloud":case"Points":r=new Ix(s(e.geometry),l(e.material));break;case"Sprite":r=new T9(l(e.material));break;case"Group":r=new tu;break;case"Bone":r=new wG;break;default:r=new Ii}if(r.uuid=e.uuid,e.name!==void 0&&(r.name=e.name),e.matrix!==void 0?(r.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(r.matrixAutoUpdate=e.matrixAutoUpdate),r.matrixAutoUpdate&&r.matrix.decompose(r.position,r.quaternion,r.scale)):(e.position!==void 0&&r.position.fromArray(e.position),e.rotation!==void 0&&r.rotation.fromArray(e.rotation),e.quaternion!==void 0&&r.quaternion.fromArray(e.quaternion),e.scale!==void 0&&r.scale.fromArray(e.scale)),e.up!==void 0&&r.up.fromArray(e.up),e.castShadow!==void 0&&(r.castShadow=e.castShadow),e.receiveShadow!==void 0&&(r.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.intensity!==void 0&&(r.shadow.intensity=e.shadow.intensity),e.shadow.bias!==void 0&&(r.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(r.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(r.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&r.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(r.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(r.visible=e.visible),e.frustumCulled!==void 0&&(r.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(r.renderOrder=e.renderOrder),e.userData!==void 0&&(r.userData=e.userData),e.layers!==void 0&&(r.layers.mask=e.layers),e.children!==void 0){const h=e.children;for(let m=0;m<h.length;m++)r.add(this.parseObject(h[m],t,i,a,o))}if(e.animations!==void 0){const h=e.animations;for(let m=0;m<h.length;m++){const p=h[m];r.animations.push(o[p])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(r.autoUpdate=e.autoUpdate);const h=e.levels;for(let m=0;m<h.length;m++){const p=h[m],B=r.getObjectByProperty("uuid",p.object);B!==void 0&&r.addLevel(B,p.distance,p.hysteresis)}}return r}bindSkeletons(e,t){Object.keys(t).length!==0&&e.traverse(function(i){if(i.isSkinnedMesh===!0&&i.skeleton!==void 0){const a=t[i.skeleton];a===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",i.skeleton):i.bind(a,i.bindMatrix)}})}bindLightTargets(e){e.traverse(function(t){if(t.isDirectionalLight||t.isSpotLight){const i=t.target,a=e.getObjectByProperty("uuid",i);a!==void 0?t.target=a:t.target=new Ii}})}}const lJ={UVMapping:pd,CubeReflectionMapping:Cg,CubeRefractionMapping:bd,EquirectangularReflectionMapping:Af,EquirectangularRefractionMapping:Bp,CubeUVReflectionMapping:Of},nN={RepeatWrapping:gu,ClampToEdgeWrapping:Ka,MirroredRepeatWrapping:mf},iN={NearestFilter:Mo,NearestMipmapNearestFilter:dG,NearestMipmapLinearFilter:OC,LinearFilter:Bi,LinearMipmapNearestFilter:cf,LinearMipmapLinearFilter:pl};class BX extends Jo{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,i,a){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const o=this,r=nu.get(e);if(r!==void 0){if(o.manager.itemStart(e),r.then){r.then(c=>{t&&t(c),o.manager.itemEnd(e)}).catch(c=>{a&&a(c)});return}return setTimeout(function(){t&&t(r),o.manager.itemEnd(e)},0),r}const s={};s.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",s.headers=this.requestHeader;const l=fetch(e,s).then(function(c){return c.blob()}).then(function(c){return createImageBitmap(c,Object.assign(o.options,{colorSpaceConversion:"none"}))}).then(function(c){return nu.add(e,c),t&&t(c),o.manager.itemEnd(e),c}).catch(function(c){a&&a(c),nu.remove(e),o.manager.itemError(e),o.manager.itemEnd(e)});nu.add(e,l),o.manager.itemStart(e)}}let Nv;class Mx{static getContext(){return Nv===void 0&&(Nv=new(window.AudioContext||window.webkitAudioContext)),Nv}static setContext(e){Nv=e}}class cJ extends Jo{constructor(e){super(e)}load(e,t,i,a){const o=this,r=new ko(this.manager);r.setResponseType("arraybuffer"),r.setPath(this.path),r.setRequestHeader(this.requestHeader),r.setWithCredentials(this.withCredentials),r.load(e,function(l){try{const c=l.slice(0);Mx.getContext().decodeAudioData(c,function(C){t(C)}).catch(s)}catch(c){s(c)}},i,a);function s(l){a?a(l):console.error(l),o.manager.itemError(e)}}}const aN=new Vn,oN=new Vn,yC=new Vn;class gJ{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new fa,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new fa,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,yC.copy(e.projectionMatrix);const a=t.eyeSep/2,o=a*t.near/t.focus,r=t.near*Math.tan(tI*t.fov*.5)/t.zoom;let s,l;oN.elements[12]=-a,aN.elements[12]=a,s=-r*t.aspect+o,l=r*t.aspect+o,yC.elements[0]=2*t.near/(l-s),yC.elements[8]=(l+s)/(l-s),this.cameraL.projectionMatrix.copy(yC),s=-r*t.aspect-o,l=r*t.aspect-o,yC.elements[0]=2*t.near/(l-s),yC.elements[8]=(l+s)/(l-s),this.cameraR.projectionMatrix.copy(yC)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(oN),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(aN)}}class GX extends fa{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e,this.index=0}}class Wx{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=rN(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=rN();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function rN(){return performance.now()}const BC=new Be,sN=new eo,uJ=new Be,GC=new Be;class dJ extends Ii{constructor(){super(),this.type="AudioListener",this.context=Mx.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new Wx}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener,i=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(BC,sN,uJ),GC.set(0,0,-1).applyQuaternion(sN),t.positionX){const a=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(BC.x,a),t.positionY.linearRampToValueAtTime(BC.y,a),t.positionZ.linearRampToValueAtTime(BC.z,a),t.forwardX.linearRampToValueAtTime(GC.x,a),t.forwardY.linearRampToValueAtTime(GC.y,a),t.forwardZ.linearRampToValueAtTime(GC.z,a),t.upX.linearRampToValueAtTime(i.x,a),t.upY.linearRampToValueAtTime(i.y,a),t.upZ.linearRampToValueAtTime(i.z,a)}else t.setPosition(BC.x,BC.y,BC.z),t.setOrientation(GC.x,GC.y,GC.z,i.x,i.y,i.z)}}class SX extends Ii{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(e=0){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(this.context.currentTime+e),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){return this.detune=e,this.isPlaying===!0&&this.source.detune!==void 0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1,this._progress=0}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}copy(e,t){return super.copy(e,t),e.sourceType!=="buffer"?(console.warn("THREE.Audio: Audio source type cannot be copied."),this):(this.autoplay=e.autoplay,this.buffer=e.buffer,this.detune=e.detune,this.loop=e.loop,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this.offset=e.offset,this.duration=e.duration,this.playbackRate=e.playbackRate,this.hasPlaybackControl=e.hasPlaybackControl,this.sourceType=e.sourceType,this.filters=e.filters.slice(),this)}clone(e){return new this.constructor(this.listener).copy(this,e)}}const SC=new Be,lN=new eo,CJ=new Be,wC=new Be;class IJ extends SX{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){return super.connect(),this.panner.connect(this.gain),this}disconnect(){return super.disconnect(),this.panner.disconnect(this.gain),this}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,i){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=i,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(SC,lN,CJ),wC.set(0,0,1).applyQuaternion(lN);const t=this.panner;if(t.positionX){const i=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(SC.x,i),t.positionY.linearRampToValueAtTime(SC.y,i),t.positionZ.linearRampToValueAtTime(SC.z,i),t.orientationX.linearRampToValueAtTime(wC.x,i),t.orientationY.linearRampToValueAtTime(wC.y,i),t.orientationZ.linearRampToValueAtTime(wC.z,i)}else t.setPosition(SC.x,SC.y,SC.z),t.setOrientation(wC.x,wC.y,wC.z)}}class hJ{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let i=0;i<t.length;i++)e+=t[i];return e/t.length}}class wX{constructor(e,t,i){this.binding=e,this.valueSize=i;let a,o,r;switch(t){case"quaternion":a=this._slerp,o=this._slerpAdditive,r=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(i*6),this._workIndex=5;break;case"string":case"bool":a=this._select,o=this._select,r=this._setAdditiveIdentityOther,this.buffer=new Array(i*5);break;default:a=this._lerp,o=this._lerpAdditive,r=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(i*5)}this._mixBufferRegion=a,this._mixBufferRegionAdditive=o,this._setIdentity=r,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const i=this.buffer,a=this.valueSize,o=e*a+a;let r=this.cumulativeWeight;if(r===0){for(let s=0;s!==a;++s)i[o+s]=i[s];r=t}else{r+=t;const s=t/r;this._mixBufferRegion(i,o,0,s,a)}this.cumulativeWeight=r}accumulateAdditive(e){const t=this.buffer,i=this.valueSize,a=i*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,a,0,e,i),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,i=this.buffer,a=e*t+t,o=this.cumulativeWeight,r=this.cumulativeWeightAdditive,s=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,o<1){const l=t*this._origIndex;this._mixBufferRegion(i,a,l,1-o,t)}r>0&&this._mixBufferRegionAdditive(i,a,this._addIndex*t,1,t);for(let l=t,c=t+t;l!==c;++l)if(i[l]!==i[l+t]){s.setValue(i,a);break}}saveOriginalState(){const e=this.binding,t=this.buffer,i=this.valueSize,a=i*this._origIndex;e.getValue(t,a);for(let o=i,r=a;o!==r;++o)t[o]=t[a+o%i];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let i=e;i<t;i++)this.buffer[i]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let i=0;i<this.valueSize;i++)this.buffer[t+i]=this.buffer[e+i]}_select(e,t,i,a,o){if(a>=.5)for(let r=0;r!==o;++r)e[t+r]=e[i+r]}_slerp(e,t,i,a){eo.slerpFlat(e,t,e,t,e,i,a)}_slerpAdditive(e,t,i,a,o){const r=this._workIndex*o;eo.multiplyQuaternionsFlat(e,r,e,t,e,i),eo.slerpFlat(e,t,e,t,e,r,a)}_lerp(e,t,i,a,o){const r=1-a;for(let s=0;s!==o;++s){const l=t+s;e[l]=e[l]*r+e[i+s]*a}}_lerpAdditive(e,t,i,a,o){for(let r=0;r!==o;++r){const s=t+r;e[s]=e[s]+e[i+r]*a}}}const Vx="\\[\\]\\.:\\/",fJ=new RegExp("["+Vx+"]","g"),Nx="[^"+Vx+"]",AJ="[^"+Vx.replace("\\.","")+"]",mJ=/((?:WC+[\/:])*)/.source.replace("WC",Nx),pJ=/(WCOD+)?/.source.replace("WCOD",AJ),bJ=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Nx),vJ=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Nx),yJ=new RegExp("^"+mJ+pJ+bJ+vJ+"$"),BJ=["material","materials","bones","map"];class GJ{constructor(e,t,i){const a=i||Ri.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,a)}getValue(e,t){this.bind();const i=this._targetGroup.nCachedObjects_,a=this._bindings[i];a!==void 0&&a.getValue(e,t)}setValue(e,t){const i=this._bindings;for(let a=this._targetGroup.nCachedObjects_,o=i.length;a!==o;++a)i[a].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].unbind()}}class Ri{constructor(e,t,i){this.path=t,this.parsedPath=i||Ri.parseTrackName(t),this.node=Ri.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,i){return e&&e.isAnimationObjectGroup?new Ri.Composite(e,t,i):new Ri(e,t,i)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(fJ,"")}static parseTrackName(e){const t=yJ.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const i={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},a=i.nodeName&&i.nodeName.lastIndexOf(".");if(a!==void 0&&a!==-1){const o=i.nodeName.substring(a+1);BJ.indexOf(o)!==-1&&(i.nodeName=i.nodeName.substring(0,a),i.objectName=o)}if(i.propertyName===null||i.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return i}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){const i=e.skeleton.getBoneByName(t);if(i!==void 0)return i}if(e.children){const i=function(o){for(let r=0;r<o.length;r++){const s=o[r];if(s.name===t||s.uuid===t)return s;const l=i(s.children);if(l)return l}return null},a=i(e.children);if(a)return a}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const i=this.resolvedProperty;for(let a=0,o=i.length;a!==o;++a)e[t++]=i[a]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const i=this.resolvedProperty;for(let a=0,o=i.length;a!==o;++a)i[a]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const i=this.resolvedProperty;for(let a=0,o=i.length;a!==o;++a)i[a]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const i=this.resolvedProperty;for(let a=0,o=i.length;a!==o;++a)i[a]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,i=t.objectName,a=t.propertyName;let o=t.propertyIndex;if(e||(e=Ri.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(i){let c=t.objectIndex;switch(i){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let u=0;u<e.length;u++)if(e[u].name===c){c=u;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[i]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[i]}if(c!==void 0){if(e[c]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[c]}}const r=e[a];if(r===void 0){const c=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+c+"."+a+" but it wasn't found.",e);return}let s=this.Versioning.None;this.targetObject=e,e.isMaterial===!0?s=this.Versioning.NeedsUpdate:e.isObject3D===!0&&(s=this.Versioning.MatrixWorldNeedsUpdate);let l=this.BindingType.Direct;if(o!==void 0){if(a==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[o]!==void 0&&(o=e.morphTargetDictionary[o])}l=this.BindingType.ArrayElement,this.resolvedProperty=r,this.propertyIndex=o}else r.fromArray!==void 0&&r.toArray!==void 0?(l=this.BindingType.HasFromToArray,this.resolvedProperty=r):Array.isArray(r)?(l=this.BindingType.EntireArray,this.resolvedProperty=r):this.propertyName=a;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][s]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Ri.Composite=GJ;Ri.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};Ri.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};Ri.prototype.GetterByBindingType=[Ri.prototype._getValue_direct,Ri.prototype._getValue_array,Ri.prototype._getValue_arrayElement,Ri.prototype._getValue_toArray];Ri.prototype.SetterByBindingTypeAndVersioning=[[Ri.prototype._setValue_direct,Ri.prototype._setValue_direct_setNeedsUpdate,Ri.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Ri.prototype._setValue_array,Ri.prototype._setValue_array_setNeedsUpdate,Ri.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Ri.prototype._setValue_arrayElement,Ri.prototype._setValue_arrayElement_setNeedsUpdate,Ri.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Ri.prototype._setValue_fromArray,Ri.prototype._setValue_fromArray_setNeedsUpdate,Ri.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class SJ{constructor(){this.isAnimationObjectGroup=!0,this.uuid=Os(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let i=0,a=arguments.length;i!==a;++i)e[arguments[i].uuid]=i;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,i=this._paths,a=this._parsedPaths,o=this._bindings,r=o.length;let s,l=e.length,c=this.nCachedObjects_;for(let u=0,C=arguments.length;u!==C;++u){const h=arguments[u],m=h.uuid;let p=t[m];if(p===void 0){p=l++,t[m]=p,e.push(h);for(let B=0,b=r;B!==b;++B)o[B].push(new Ri(h,i[B],a[B]))}else if(p<c){s=e[p];const B=--c,b=e[B];t[b.uuid]=p,e[p]=b,t[m]=B,e[B]=h;for(let y=0,S=r;y!==S;++y){const R=o[y],Z=R[B];let x=R[p];R[p]=Z,x===void 0&&(x=new Ri(h,i[y],a[y])),R[B]=x}}else e[p]!==s&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=c}remove(){const e=this._objects,t=this._indicesByUUID,i=this._bindings,a=i.length;let o=this.nCachedObjects_;for(let r=0,s=arguments.length;r!==s;++r){const l=arguments[r],c=l.uuid,u=t[c];if(u!==void 0&&u>=o){const C=o++,h=e[C];t[h.uuid]=u,e[u]=h,t[c]=C,e[C]=l;for(let m=0,p=a;m!==p;++m){const B=i[m],b=B[C],y=B[u];B[u]=b,B[C]=y}}}this.nCachedObjects_=o}uncache(){const e=this._objects,t=this._indicesByUUID,i=this._bindings,a=i.length;let o=this.nCachedObjects_,r=e.length;for(let s=0,l=arguments.length;s!==l;++s){const c=arguments[s],u=c.uuid,C=t[u];if(C!==void 0)if(delete t[u],C<o){const h=--o,m=e[h],p=--r,B=e[p];t[m.uuid]=C,e[C]=m,t[B.uuid]=h,e[h]=B,e.pop();for(let b=0,y=a;b!==y;++b){const S=i[b],R=S[h],Z=S[p];S[C]=R,S[h]=Z,S.pop()}}else{const h=--r,m=e[h];h>0&&(t[m.uuid]=C),e[C]=m,e.pop();for(let p=0,B=a;p!==B;++p){const b=i[p];b[C]=b[h],b.pop()}}}this.nCachedObjects_=o}subscribe_(e,t){const i=this._bindingsIndicesByPath;let a=i[e];const o=this._bindings;if(a!==void 0)return o[a];const r=this._paths,s=this._parsedPaths,l=this._objects,c=l.length,u=this.nCachedObjects_,C=new Array(c);a=o.length,i[e]=a,r.push(e),s.push(t),o.push(C);for(let h=u,m=l.length;h!==m;++h){const p=l[h];C[h]=new Ri(p,e,t)}return C}unsubscribe_(e){const t=this._bindingsIndicesByPath,i=t[e];if(i!==void 0){const a=this._paths,o=this._parsedPaths,r=this._bindings,s=r.length-1,l=r[s],c=e[s];t[c]=i,r[i]=l,r.pop(),o[i]=o[s],o.pop(),a[i]=a[s],a.pop()}}}class RX{constructor(e,t,i=null,a=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=i,this.blendMode=a;const o=t.tracks,r=o.length,s=new Array(r),l={endingStart:UC,endingEnd:UC};for(let c=0;c!==r;++c){const u=o[c].createInterpolant(null);s[c]=u,u.settings=l}this._interpolantSettings=l,this._interpolants=s,this._propertyBindings=new Array(r),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=A9,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,i=!1){if(e.fadeOut(t),this.fadeIn(t),i===!0){const a=this._clip.duration,o=e._clip.duration,r=o/a,s=a/o;e.warp(1,r,t),this.warp(s,1,t)}return this}crossFadeTo(e,t,i=!1){return e.crossFadeFrom(this,t,i)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,i){const a=this._mixer,o=a.time,r=this.timeScale;let s=this._timeScaleInterpolant;s===null&&(s=a._lendControlInterpolant(),this._timeScaleInterpolant=s);const l=s.parameterPositions,c=s.sampleValues;return l[0]=o,l[1]=o+i,c[0]=e/r,c[1]=t/r,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,i,a){if(!this.enabled){this._updateWeight(e);return}const o=this._startTime;if(o!==null){const l=(e-o)*i;l<0||i===0?t=0:(this._startTime=null,t=i*l)}t*=this._updateTimeScale(e);const r=this._updateTime(t),s=this._updateWeight(e);if(s>0){const l=this._interpolants,c=this._propertyBindings;switch(this.blendMode){case nx:for(let u=0,C=l.length;u!==C;++u)l[u].evaluate(r),c[u].accumulateAdditive(s);break;case pG:default:for(let u=0,C=l.length;u!==C;++u)l[u].evaluate(r),c[u].accumulate(a,s)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const i=this._weightInterpolant;if(i!==null){const a=i.evaluate(e)[0];t*=a,e>i.parameterPositions[1]&&(this.stopFading(),a===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const i=this._timeScaleInterpolant;if(i!==null){const a=i.evaluate(e)[0];t*=a,e>i.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,i=this.loop;let a=this.time+e,o=this._loopCount;const r=i===m9;if(e===0)return o===-1?a:r&&(o&1)===1?t-a:a;if(i===f9){o===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(a>=t)a=t;else if(a<0)a=0;else{this.time=a;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=a,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(o===-1&&(e>=0?(o=0,this._setEndings(!0,this.repetitions===0,r)):this._setEndings(this.repetitions===0,!0,r)),a>=t||a<0){const s=Math.floor(a/t);a-=t*s,o+=Math.abs(s);const l=this.repetitions-o;if(l<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,a=e>0?t:0,this.time=a,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(l===1){const c=e<0;this._setEndings(c,!c,r)}else this._setEndings(!1,!1,r);this._loopCount=o,this.time=a,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:s})}}else this.time=a;if(r&&(o&1)===1)return t-a}return a}_setEndings(e,t,i){const a=this._interpolantSettings;i?(a.endingStart=kC,a.endingEnd=kC):(e?a.endingStart=this.zeroSlopeAtStart?kC:UC:a.endingStart=Gp,t?a.endingEnd=this.zeroSlopeAtEnd?kC:UC:a.endingEnd=Gp)}_scheduleFading(e,t,i){const a=this._mixer,o=a.time;let r=this._weightInterpolant;r===null&&(r=a._lendControlInterpolant(),this._weightInterpolant=r);const s=r.parameterPositions,l=r.sampleValues;return s[0]=o,l[0]=t,s[1]=o+e,l[1]=i,this}}const wJ=new Float32Array(1);class RJ extends pg{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const i=e._localRoot||this._root,a=e._clip.tracks,o=a.length,r=e._propertyBindings,s=e._interpolants,l=i.uuid,c=this._bindingsByRootAndName;let u=c[l];u===void 0&&(u={},c[l]=u);for(let C=0;C!==o;++C){const h=a[C],m=h.name;let p=u[m];if(p!==void 0)++p.referenceCount,r[C]=p;else{if(p=r[C],p!==void 0){p._cacheIndex===null&&(++p.referenceCount,this._addInactiveBinding(p,l,m));continue}const B=t&&t._propertyBindings[C].binding.parsedPath;p=new wX(Ri.create(i,m,B),h.ValueTypeName,h.getValueSize()),++p.referenceCount,this._addInactiveBinding(p,l,m),r[C]=p}s[C].resultBuffer=p.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const i=(e._localRoot||this._root).uuid,a=e._clip.uuid,o=this._actionsByClip[a];this._bindAction(e,o&&o.knownActions[0]),this._addInactiveAction(e,a,i)}const t=e._propertyBindings;for(let i=0,a=t.length;i!==a;++i){const o=t[i];o.useCount++===0&&(this._lendBinding(o),o.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let i=0,a=t.length;i!==a;++i){const o=t[i];--o.useCount===0&&(o.restoreOriginalState(),this._takeBackBinding(o))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,i){const a=this._actions,o=this._actionsByClip;let r=o[t];if(r===void 0)r={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,o[t]=r;else{const s=r.knownActions;e._byClipCacheIndex=s.length,s.push(e)}e._cacheIndex=a.length,a.push(e),r.actionByRoot[i]=e}_removeInactiveAction(e){const t=this._actions,i=t[t.length-1],a=e._cacheIndex;i._cacheIndex=a,t[a]=i,t.pop(),e._cacheIndex=null;const o=e._clip.uuid,r=this._actionsByClip,s=r[o],l=s.knownActions,c=l[l.length-1],u=e._byClipCacheIndex;c._byClipCacheIndex=u,l[u]=c,l.pop(),e._byClipCacheIndex=null;const C=s.actionByRoot,h=(e._localRoot||this._root).uuid;delete C[h],l.length===0&&delete r[o],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let i=0,a=t.length;i!==a;++i){const o=t[i];--o.referenceCount===0&&this._removeInactiveBinding(o)}}_lendAction(e){const t=this._actions,i=e._cacheIndex,a=this._nActiveActions++,o=t[a];e._cacheIndex=a,t[a]=e,o._cacheIndex=i,t[i]=o}_takeBackAction(e){const t=this._actions,i=e._cacheIndex,a=--this._nActiveActions,o=t[a];e._cacheIndex=a,t[a]=e,o._cacheIndex=i,t[i]=o}_addInactiveBinding(e,t,i){const a=this._bindingsByRootAndName,o=this._bindings;let r=a[t];r===void 0&&(r={},a[t]=r),r[i]=e,e._cacheIndex=o.length,o.push(e)}_removeInactiveBinding(e){const t=this._bindings,i=e.binding,a=i.rootNode.uuid,o=i.path,r=this._bindingsByRootAndName,s=r[a],l=t[t.length-1],c=e._cacheIndex;l._cacheIndex=c,t[c]=l,t.pop(),delete s[o],Object.keys(s).length===0&&delete r[a]}_lendBinding(e){const t=this._bindings,i=e._cacheIndex,a=this._nActiveBindings++,o=t[a];e._cacheIndex=a,t[a]=e,o._cacheIndex=i,t[i]=o}_takeBackBinding(e){const t=this._bindings,i=e._cacheIndex,a=--this._nActiveBindings,o=t[a];e._cacheIndex=a,t[a]=e,o._cacheIndex=i,t[i]=o}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let i=e[t];return i===void 0&&(i=new yx(new Float32Array(2),new Float32Array(2),1,wJ),i.__cacheIndex=t,e[t]=i),i}_takeBackControlInterpolant(e){const t=this._controlInterpolants,i=e.__cacheIndex,a=--this._nActiveControlInterpolants,o=t[a];e.__cacheIndex=a,t[a]=e,o.__cacheIndex=i,t[i]=o}clipAction(e,t,i){const a=t||this._root,o=a.uuid;let r=typeof e=="string"?xf.findByName(a,e):e;const s=r!==null?r.uuid:e,l=this._actionsByClip[s];let c=null;if(i===void 0&&(r!==null?i=r.blendMode:i=pG),l!==void 0){const C=l.actionByRoot[o];if(C!==void 0&&C.blendMode===i)return C;c=l.knownActions[0],r===null&&(r=c._clip)}if(r===null)return null;const u=new RX(this,r,t,i);return this._bindAction(u,c),this._addInactiveAction(u,s,o),u}existingAction(e,t){const i=t||this._root,a=i.uuid,o=typeof e=="string"?xf.findByName(i,e):e,r=o?o.uuid:e,s=this._actionsByClip[r];return s!==void 0&&s.actionByRoot[a]||null}stopAllAction(){const e=this._actions,t=this._nActiveActions;for(let i=t-1;i>=0;--i)e[i].stop();return this}update(e){e*=this.timeScale;const t=this._actions,i=this._nActiveActions,a=this.time+=e,o=Math.sign(e),r=this._accuIndex^=1;for(let c=0;c!==i;++c)t[c]._update(a,e,o,r);const s=this._bindings,l=this._nActiveBindings;for(let c=0;c!==l;++c)s[c].apply(r);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,i=e.uuid,a=this._actionsByClip,o=a[i];if(o!==void 0){const r=o.knownActions;for(let s=0,l=r.length;s!==l;++s){const c=r[s];this._deactivateAction(c);const u=c._cacheIndex,C=t[t.length-1];c._cacheIndex=null,c._byClipCacheIndex=null,C._cacheIndex=u,t[u]=C,t.pop(),this._removeInactiveBindingsForAction(c)}delete a[i]}}uncacheRoot(e){const t=e.uuid,i=this._actionsByClip;for(const r in i){const s=i[r].actionByRoot,l=s[t];l!==void 0&&(this._deactivateAction(l),this._removeInactiveAction(l))}const a=this._bindingsByRootAndName,o=a[t];if(o!==void 0)for(const r in o){const s=o[r];s.restoreOriginalState(),this._removeInactiveBinding(s)}}uncacheAction(e,t){const i=this.existingAction(e,t);i!==null&&(this._deactivateAction(i),this._removeInactiveAction(i))}}class ZJ extends bG{constructor(e=1,t=1,i=1,a={}){super(e,t,a),this.isRenderTarget3D=!0,this.depth=i,this.texture=new vG(null,e,t,i),this.texture.isRenderTargetTexture=!0}}class xJ extends bG{constructor(e=1,t=1,i=1,a={}){super(e,t,a),this.isRenderTargetArray=!0,this.depth=i,this.texture=new ob(null,e,t,i),this.texture.isRenderTargetTexture=!0}}class Ex{constructor(e){this.value=e}clone(){return new Ex(this.value.clone===void 0?this.value:this.value.clone())}}let MJ=0;class WJ extends pg{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:MJ++}),this.name="",this.usage=wp,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const t=this.uniforms.indexOf(e);return t!==-1&&this.uniforms.splice(t,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){this.dispatchEvent({type:"dispose"})}copy(e){this.name=e.name,this.usage=e.usage;const t=e.uniforms;this.uniforms.length=0;for(let i=0,a=t.length;i<a;i++){const o=Array.isArray(t[i])?t[i]:[t[i]];for(let r=0;r<o.length;r++)this.uniforms.push(o[r].clone())}return this}clone(){return new this.constructor().copy(this)}}class VJ extends lb{constructor(e,t,i=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class NJ{constructor(e,t,i,a,o){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=t,this.itemSize=i,this.elementSize=a,this.count=o,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}const cN=new Vn;class Hx{constructor(e,t,i=0,a=1/0){this.ray=new pI(e,t),this.near=i,this.far=a,this.camera=null,this.layers=new wf,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return cN.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(cN),this}intersectObject(e,t=!0,i=[]){return q1(e,this,i,t),i.sort(gN),i}intersectObjects(e,t=!0,i=[]){for(let a=0,o=e.length;a<o;a++)q1(e[a],this,i,t);return i.sort(gN),i}}function gN(n,e){return n.distance-e.distance}function q1(n,e,t,i){let a=!0;if(n.layers.test(e.layers)&&n.raycast(e,t)===!1&&(a=!1),a===!0&&i===!0){const o=n.children;for(let r=0,s=o.length;r<s;r++)q1(o[r],e,t,!0)}}class $1{constructor(e=1,t=0,i=0){this.radius=e,this.phi=t,this.theta=i}set(e,t,i){return this.radius=e,this.phi=t,this.theta=i,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=jn(this.phi,1e-6,Math.PI-1e-6),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,i){return this.radius=Math.sqrt(e*e+t*t+i*i),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(jn(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class EJ{constructor(e=1,t=0,i=0){this.radius=e,this.theta=t,this.y=i}set(e,t,i){return this.radius=e,this.theta=t,this.y=i,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,i){return this.radius=Math.sqrt(e*e+i*i),this.theta=Math.atan2(e,i),this.y=t,this}clone(){return new this.constructor().copy(this)}}class Fx{constructor(e,t,i,a){Fx.prototype.isMatrix2=!0,this.elements=[1,0,0,1],e!==void 0&&this.set(e,t,i,a)}identity(){return this.set(1,0,0,1),this}fromArray(e,t=0){for(let i=0;i<4;i++)this.elements[i]=e[i+t];return this}set(e,t,i,a){const o=this.elements;return o[0]=e,o[2]=t,o[1]=i,o[3]=a,this}}const uN=new Xt;class HJ{constructor(e=new Xt(1/0,1/0),t=new Xt(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=uN.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,uN).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const dN=new Be,Ev=new Be;class FJ{constructor(e=new Be,t=new Be){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){dN.subVectors(e,this.start),Ev.subVectors(this.end,this.start);const i=Ev.dot(Ev);let o=Ev.dot(dN)/i;return t&&(o=jn(o,0,1)),o}closestPointToPoint(e,t,i){const a=this.closestPointToPointParameter(e,t);return this.delta(i).multiplyScalar(a).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const CN=new Be;class XJ extends Ii{constructor(e,t){super(),this.light=e,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";const i=new $n,a=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let r=0,s=1,l=32;r<l;r++,s++){const c=r/l*Math.PI*2,u=s/l*Math.PI*2;a.push(Math.cos(c),Math.sin(c),1,Math.cos(u),Math.sin(u),1)}i.setAttribute("position",new Sn(a,3));const o=new Ar({fog:!1,toneMapped:!1});this.cone=new Ac(i,o),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),CN.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(CN),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const rd=new Be,Hv=new Vn,Q2=new Vn;class TJ extends Ac{constructor(e){const t=ZX(e),i=new $n,a=[],o=[],r=new dn(0,0,1),s=new dn(0,1,0);for(let c=0;c<t.length;c++){const u=t[c];u.parent&&u.parent.isBone&&(a.push(0,0,0),a.push(0,0,0),o.push(r.r,r.g,r.b),o.push(s.r,s.g,s.b))}i.setAttribute("position",new Sn(a,3)),i.setAttribute("color",new Sn(o,3));const l=new Ar({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(i,l),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const t=this.bones,i=this.geometry,a=i.getAttribute("position");Q2.copy(this.root.matrixWorld).invert();for(let o=0,r=0;o<t.length;o++){const s=t[o];s.parent&&s.parent.isBone&&(Hv.multiplyMatrices(Q2,s.matrixWorld),rd.setFromMatrixPosition(Hv),a.setXYZ(r,rd.x,rd.y,rd.z),Hv.multiplyMatrices(Q2,s.parent.matrixWorld),rd.setFromMatrixPosition(Hv),a.setXYZ(r+1,rd.x,rd.y,rd.z),r+=2)}i.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}}function ZX(n){const e=[];n.isBone===!0&&e.push(n);for(let t=0;t<n.children.length;t++)e.push(...ZX(n.children[t]));return e}class YJ extends $i{constructor(e,t,i){const a=new Cb(t,4,2),o=new Or({wireframe:!0,fog:!1,toneMapped:!1});super(a,o),this.light=e,this.color=i,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const zJ=new Be,IN=new dn,hN=new dn;class KJ extends Ii{constructor(e,t,i){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,this.type="HemisphereLightHelper";const a=new db(t);a.rotateY(Math.PI*.5),this.material=new Or({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const o=a.getAttribute("position"),r=new Float32Array(o.count*3);a.setAttribute("color",new Mi(r,3)),this.add(new $i(a,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");IN.copy(this.light.color),hN.copy(this.light.groundColor);for(let i=0,a=t.count;i<a;i++){const o=i<a/2?IN:hN;t.setXYZ(i,o.r,o.g,o.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(zJ.setFromMatrixPosition(this.light.matrixWorld).negate())}}class LJ extends Ac{constructor(e=10,t=10,i=4473924,a=8947848){i=new dn(i),a=new dn(a);const o=t/2,r=e/t,s=e/2,l=[],c=[];for(let h=0,m=0,p=-s;h<=t;h++,p+=r){l.push(-s,0,p,s,0,p),l.push(p,0,-s,p,0,s);const B=h===o?i:a;B.toArray(c,m),m+=3,B.toArray(c,m),m+=3,B.toArray(c,m),m+=3,B.toArray(c,m),m+=3}const u=new $n;u.setAttribute("position",new Sn(l,3)),u.setAttribute("color",new Sn(c,3));const C=new Ar({vertexColors:!0,toneMapped:!1});super(u,C),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class _J extends Ac{constructor(e=10,t=16,i=8,a=64,o=4473924,r=8947848){o=new dn(o),r=new dn(r);const s=[],l=[];if(t>1)for(let C=0;C<t;C++){const h=C/t*(Math.PI*2),m=Math.sin(h)*e,p=Math.cos(h)*e;s.push(0,0,0),s.push(m,0,p);const B=C&1?o:r;l.push(B.r,B.g,B.b),l.push(B.r,B.g,B.b)}for(let C=0;C<i;C++){const h=C&1?o:r,m=e-e/i*C;for(let p=0;p<a;p++){let B=p/a*(Math.PI*2),b=Math.sin(B)*m,y=Math.cos(B)*m;s.push(b,0,y),l.push(h.r,h.g,h.b),B=(p+1)/a*(Math.PI*2),b=Math.sin(B)*m,y=Math.cos(B)*m,s.push(b,0,y),l.push(h.r,h.g,h.b)}}const c=new $n;c.setAttribute("position",new Sn(s,3)),c.setAttribute("color",new Sn(l,3));const u=new Ar({vertexColors:!0,toneMapped:!1});super(c,u),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const fN=new Be,Fv=new Be,AN=new Be;class DJ extends Ii{constructor(e,t,i){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,this.type="DirectionalLightHelper",t===void 0&&(t=1);let a=new $n;a.setAttribute("position",new Sn([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const o=new Ar({fog:!1,toneMapped:!1});this.lightPlane=new uu(a,o),this.add(this.lightPlane),a=new $n,a.setAttribute("position",new Sn([0,0,0,0,0,1],3)),this.targetLine=new uu(a,o),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),fN.setFromMatrixPosition(this.light.matrixWorld),Fv.setFromMatrixPosition(this.light.target.matrixWorld),AN.subVectors(Fv,fN),this.lightPlane.lookAt(Fv),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Fv),this.targetLine.scale.z=AN.length()}}const Xv=new Be,Na=new BG;class OJ extends Ac{constructor(e){const t=new $n,i=new Ar({color:16777215,vertexColors:!0,toneMapped:!1}),a=[],o=[],r={};s("n1","n2"),s("n2","n4"),s("n4","n3"),s("n3","n1"),s("f1","f2"),s("f2","f4"),s("f4","f3"),s("f3","f1"),s("n1","f1"),s("n2","f2"),s("n3","f3"),s("n4","f4"),s("p","n1"),s("p","n2"),s("p","n3"),s("p","n4"),s("u1","u2"),s("u2","u3"),s("u3","u1"),s("c","t"),s("p","c"),s("cn1","cn2"),s("cn3","cn4"),s("cf1","cf2"),s("cf3","cf4");function s(p,B){l(p),l(B)}function l(p){a.push(0,0,0),o.push(0,0,0),r[p]===void 0&&(r[p]=[]),r[p].push(a.length/3-1)}t.setAttribute("position",new Sn(a,3)),t.setAttribute("color",new Sn(o,3)),super(t,i),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=r,this.update();const c=new dn(16755200),u=new dn(16711680),C=new dn(43775),h=new dn(16777215),m=new dn(3355443);this.setColors(c,u,C,h,m)}setColors(e,t,i,a,o){const s=this.geometry.getAttribute("color");s.setXYZ(0,e.r,e.g,e.b),s.setXYZ(1,e.r,e.g,e.b),s.setXYZ(2,e.r,e.g,e.b),s.setXYZ(3,e.r,e.g,e.b),s.setXYZ(4,e.r,e.g,e.b),s.setXYZ(5,e.r,e.g,e.b),s.setXYZ(6,e.r,e.g,e.b),s.setXYZ(7,e.r,e.g,e.b),s.setXYZ(8,e.r,e.g,e.b),s.setXYZ(9,e.r,e.g,e.b),s.setXYZ(10,e.r,e.g,e.b),s.setXYZ(11,e.r,e.g,e.b),s.setXYZ(12,e.r,e.g,e.b),s.setXYZ(13,e.r,e.g,e.b),s.setXYZ(14,e.r,e.g,e.b),s.setXYZ(15,e.r,e.g,e.b),s.setXYZ(16,e.r,e.g,e.b),s.setXYZ(17,e.r,e.g,e.b),s.setXYZ(18,e.r,e.g,e.b),s.setXYZ(19,e.r,e.g,e.b),s.setXYZ(20,e.r,e.g,e.b),s.setXYZ(21,e.r,e.g,e.b),s.setXYZ(22,e.r,e.g,e.b),s.setXYZ(23,e.r,e.g,e.b),s.setXYZ(24,t.r,t.g,t.b),s.setXYZ(25,t.r,t.g,t.b),s.setXYZ(26,t.r,t.g,t.b),s.setXYZ(27,t.r,t.g,t.b),s.setXYZ(28,t.r,t.g,t.b),s.setXYZ(29,t.r,t.g,t.b),s.setXYZ(30,t.r,t.g,t.b),s.setXYZ(31,t.r,t.g,t.b),s.setXYZ(32,i.r,i.g,i.b),s.setXYZ(33,i.r,i.g,i.b),s.setXYZ(34,i.r,i.g,i.b),s.setXYZ(35,i.r,i.g,i.b),s.setXYZ(36,i.r,i.g,i.b),s.setXYZ(37,i.r,i.g,i.b),s.setXYZ(38,a.r,a.g,a.b),s.setXYZ(39,a.r,a.g,a.b),s.setXYZ(40,o.r,o.g,o.b),s.setXYZ(41,o.r,o.g,o.b),s.setXYZ(42,o.r,o.g,o.b),s.setXYZ(43,o.r,o.g,o.b),s.setXYZ(44,o.r,o.g,o.b),s.setXYZ(45,o.r,o.g,o.b),s.setXYZ(46,o.r,o.g,o.b),s.setXYZ(47,o.r,o.g,o.b),s.setXYZ(48,o.r,o.g,o.b),s.setXYZ(49,o.r,o.g,o.b),s.needsUpdate=!0}update(){const e=this.geometry,t=this.pointMap,i=1,a=1;Na.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse);const o=this.camera.coordinateSystem===cc?-1:0;Ya("c",t,e,Na,0,0,o),Ya("t",t,e,Na,0,0,1),Ya("n1",t,e,Na,-1,-1,o),Ya("n2",t,e,Na,i,-1,o),Ya("n3",t,e,Na,-1,a,o),Ya("n4",t,e,Na,i,a,o),Ya("f1",t,e,Na,-1,-1,1),Ya("f2",t,e,Na,i,-1,1),Ya("f3",t,e,Na,-1,a,1),Ya("f4",t,e,Na,i,a,1),Ya("u1",t,e,Na,i*.7,a*1.1,o),Ya("u2",t,e,Na,-1*.7,a*1.1,o),Ya("u3",t,e,Na,0,a*2,o),Ya("cf1",t,e,Na,-1,0,1),Ya("cf2",t,e,Na,i,0,1),Ya("cf3",t,e,Na,0,-1,1),Ya("cf4",t,e,Na,0,a,1),Ya("cn1",t,e,Na,-1,0,o),Ya("cn2",t,e,Na,i,0,o),Ya("cn3",t,e,Na,0,-1,o),Ya("cn4",t,e,Na,0,a,o),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function Ya(n,e,t,i,a,o,r){Xv.set(a,o,r).unproject(i);const s=e[n];if(s!==void 0){const l=t.getAttribute("position");for(let c=0,u=s.length;c<u;c++)l.setXYZ(s[c],Xv.x,Xv.y,Xv.z)}}const Tv=new Wo;class UJ extends Ac{constructor(e,t=16776960){const i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),a=new Float32Array(8*3),o=new $n;o.setIndex(new Mi(i,1)),o.setAttribute("position",new Mi(a,3)),super(o,new Ar({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(){if(this.object!==void 0&&Tv.setFromObject(this.object),Tv.isEmpty())return;const e=Tv.min,t=Tv.max,i=this.geometry.attributes.position,a=i.array;a[0]=t.x,a[1]=t.y,a[2]=t.z,a[3]=e.x,a[4]=t.y,a[5]=t.z,a[6]=e.x,a[7]=e.y,a[8]=t.z,a[9]=t.x,a[10]=e.y,a[11]=t.z,a[12]=t.x,a[13]=t.y,a[14]=e.z,a[15]=e.x,a[16]=t.y,a[17]=e.z,a[18]=e.x,a[19]=e.y,a[20]=e.z,a[21]=t.x,a[22]=e.y,a[23]=e.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class kJ extends Ac{constructor(e,t=16776960){const i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),a=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],o=new $n;o.setIndex(new Mi(i,1)),o.setAttribute("position",new Sn(a,3)),super(o,new Ar({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class PJ extends uu{constructor(e,t=1,i=16776960){const a=i,o=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],r=new $n;r.setAttribute("position",new Sn(o,3)),r.computeBoundingSphere(),super(r,new Ar({color:a,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const s=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],l=new $n;l.setAttribute("position",new Sn(s,3)),l.computeBoundingSphere(),this.add(new $i(l,new Or({color:a,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const mN=new Be;let Yv,q2;class JJ extends Ii{constructor(e=new Be(0,0,1),t=new Be(0,0,0),i=1,a=16776960,o=i*.2,r=o*.2){super(),this.type="ArrowHelper",Yv===void 0&&(Yv=new $n,Yv.setAttribute("position",new Sn([0,0,0,0,1,0],3)),q2=new Uf(0,.5,1,5,1),q2.translate(0,-.5,0)),this.position.copy(t),this.line=new uu(Yv,new Ar({color:a,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new $i(q2,new Or({color:a,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(i,o,r)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{mN.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(mN,t)}}setLength(e,t=e*.2,i=t*.2){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(i,t,i),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class jJ extends Ac{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],i=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],a=new $n;a.setAttribute("position",new Sn(t,3)),a.setAttribute("color",new Sn(i,3));const o=new Ar({vertexColors:!0,toneMapped:!1});super(a,o),this.type="AxesHelper"}setColors(e,t,i){const a=new dn,o=this.geometry.attributes.color.array;return a.set(e),a.toArray(o,0),a.toArray(o,3),a.set(t),a.toArray(o,6),a.toArray(o,9),a.set(i),a.toArray(o,12),a.toArray(o,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class QJ{constructor(){this.type="ShapePath",this.color=new dn,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new xp,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,i,a){return this.currentPath.quadraticCurveTo(e,t,i,a),this}bezierCurveTo(e,t,i,a,o,r){return this.currentPath.bezierCurveTo(e,t,i,a,o,r),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function t(y){const S=[];for(let R=0,Z=y.length;R<Z;R++){const x=y[R],M=new iI;M.curves=x.curves,S.push(M)}return S}function i(y,S){const R=S.length;let Z=!1;for(let x=R-1,M=0;M<R;x=M++){let E=S[x],F=S[M],N=F.x-E.x,H=F.y-E.y;if(Math.abs(H)>Number.EPSILON){if(H<0&&(E=S[M],N=-N,F=S[x],H=-H),y.y<E.y||y.y>F.y)continue;if(y.y===E.y){if(y.x===E.x)return!0}else{const z=H*(y.x-E.x)-N*(y.y-E.y);if(z===0)return!0;if(z<0)continue;Z=!Z}}else{if(y.y!==E.y)continue;if(F.x<=y.x&&y.x<=E.x||E.x<=y.x&&y.x<=F.x)return!0}}return Z}const a=cg.isClockWise,o=this.subPaths;if(o.length===0)return[];let r,s,l;const c=[];if(o.length===1)return s=o[0],l=new iI,l.curves=s.curves,c.push(l),c;let u=!a(o[0].getPoints());u=e?!u:u;const C=[],h=[];let m=[],p=0,B;h[p]=void 0,m[p]=[];for(let y=0,S=o.length;y<S;y++)s=o[y],B=s.getPoints(),r=a(B),r=e?!r:r,r?(!u&&h[p]&&p++,h[p]={s:new iI,p:B},h[p].s.curves=s.curves,u&&p++,m[p]=[]):m[p].push({h:s,p:B[0]});if(!h[0])return t(o);if(h.length>1){let y=!1,S=0;for(let R=0,Z=h.length;R<Z;R++)C[R]=[];for(let R=0,Z=h.length;R<Z;R++){const x=m[R];for(let M=0;M<x.length;M++){const E=x[M];let F=!0;for(let N=0;N<h.length;N++)i(E.p,h[N].p)&&(R!==N&&S++,F?(F=!1,C[N].push(E)):y=!0);F&&C[R].push(E)}}S>0&&y===!1&&(m=C)}let b;for(let y=0,S=h.length;y<S;y++){l=h[y].s,c.push(l),b=m[y];for(let R=0,Z=b.length;R<Z;R++)l.holes.push(b[R].h)}return c}}class qJ extends pg{constructor(e,t=null){super(),this.object=e,this.domElement=t,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(e){if(e===void 0){console.warn("THREE.Controls: connect() now requires an element.");return}this.domElement!==null&&this.disconnect(),this.domElement=e}disconnect(){}dispose(){}update(){}}function $J(n,e){const t=n.image&&n.image.width?n.image.width/n.image.height:1;return t>e?(n.repeat.x=1,n.repeat.y=t/e,n.offset.x=0,n.offset.y=(1-n.repeat.y)/2):(n.repeat.x=e/t,n.repeat.y=1,n.offset.x=(1-n.repeat.x)/2,n.offset.y=0),n}function e4(n,e){const t=n.image&&n.image.width?n.image.width/n.image.height:1;return t>e?(n.repeat.x=e/t,n.repeat.y=1,n.offset.x=(1-n.repeat.x)/2,n.offset.y=0):(n.repeat.x=1,n.repeat.y=t/e,n.offset.x=0,n.offset.y=(1-n.repeat.y)/2),n}function t4(n){return n.repeat.x=1,n.repeat.y=1,n.offset.x=0,n.offset.y=0,n}function eR(n,e,t,i){const a=n4(i);switch(t){case jZ:return n*e;case qZ:return n*e;case $Z:return n*e*2;case ib:return n*e/a.components*a.byteLength;case ab:return n*e/a.components*a.byteLength;case ex:return n*e*2/a.components*a.byteLength;case AG:return n*e*2/a.components*a.byteLength;case QZ:return n*e*3/a.components*a.byteLength;case La:return n*e*4/a.components*a.byteLength;case mG:return n*e*4/a.components*a.byteLength;case ip:case ap:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*8;case op:case rp:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*16;case aB:case rB:return Math.max(n,16)*Math.max(e,8)/4;case iB:case oB:return Math.max(n,8)*Math.max(e,8)/2;case sB:case lB:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*8;case cB:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*16;case gB:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*16;case uB:return Math.floor((n+4)/5)*Math.floor((e+3)/4)*16;case dB:return Math.floor((n+4)/5)*Math.floor((e+4)/5)*16;case CB:return Math.floor((n+5)/6)*Math.floor((e+4)/5)*16;case IB:return Math.floor((n+5)/6)*Math.floor((e+5)/6)*16;case hB:return Math.floor((n+7)/8)*Math.floor((e+4)/5)*16;case fB:return Math.floor((n+7)/8)*Math.floor((e+5)/6)*16;case AB:return Math.floor((n+7)/8)*Math.floor((e+7)/8)*16;case mB:return Math.floor((n+9)/10)*Math.floor((e+4)/5)*16;case pB:return Math.floor((n+9)/10)*Math.floor((e+5)/6)*16;case bB:return Math.floor((n+9)/10)*Math.floor((e+7)/8)*16;case vB:return Math.floor((n+9)/10)*Math.floor((e+9)/10)*16;case yB:return Math.floor((n+11)/12)*Math.floor((e+9)/10)*16;case BB:return Math.floor((n+11)/12)*Math.floor((e+11)/12)*16;case sp:case GB:case SB:return Math.ceil(n/4)*Math.ceil(e/4)*16;case tx:case wB:return Math.ceil(n/4)*Math.ceil(e/4)*8;case RB:case ZB:return Math.ceil(n/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${t} format.`)}function n4(n){switch(n){case vs:case CG:return{byteLength:1,components:1};case pf:case IG:case Co:return{byteLength:2,components:1};case hG:case fG:return{byteLength:2,components:4};case Ig:case nb:case ma:return{byteLength:4,components:1};case JZ:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${n}.`)}class i4{static contain(e,t){return $J(e,t)}static cover(e,t){return e4(e,t)}static fill(e){return t4(e)}static getByteLength(e,t,i,a){return eR(e,t,i,a)}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:eb}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=eb);/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */function xX(){let n=null,e=!1,t=null,i=null;function a(o,r){t(o,r),i=n.requestAnimationFrame(a)}return{start:function(){e!==!0&&t!==null&&(i=n.requestAnimationFrame(a),e=!0)},stop:function(){n.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(o){t=o},setContext:function(o){n=o}}}function a4(n){const e=new WeakMap;function t(s,l){const c=s.array,u=s.usage,C=c.byteLength,h=n.createBuffer();n.bindBuffer(l,h),n.bufferData(l,c,u),s.onUploadCallback();let m;if(c instanceof Float32Array)m=n.FLOAT;else if(c instanceof Uint16Array)s.isFloat16BufferAttribute?m=n.HALF_FLOAT:m=n.UNSIGNED_SHORT;else if(c instanceof Int16Array)m=n.SHORT;else if(c instanceof Uint32Array)m=n.UNSIGNED_INT;else if(c instanceof Int32Array)m=n.INT;else if(c instanceof Int8Array)m=n.BYTE;else if(c instanceof Uint8Array)m=n.UNSIGNED_BYTE;else if(c instanceof Uint8ClampedArray)m=n.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+c);return{buffer:h,type:m,bytesPerElement:c.BYTES_PER_ELEMENT,version:s.version,size:C}}function i(s,l,c){const u=l.array,C=l.updateRanges;if(n.bindBuffer(c,s),C.length===0)n.bufferSubData(c,0,u);else{C.sort((m,p)=>m.start-p.start);let h=0;for(let m=1;m<C.length;m++){const p=C[h],B=C[m];B.start<=p.start+p.count+1?p.count=Math.max(p.count,B.start+B.count-p.start):(++h,C[h]=B)}C.length=h+1;for(let m=0,p=C.length;m<p;m++){const B=C[m];n.bufferSubData(c,B.start*u.BYTES_PER_ELEMENT,u,B.start,B.count)}l.clearUpdateRanges()}l.onUploadCallback()}function a(s){return s.isInterleavedBufferAttribute&&(s=s.data),e.get(s)}function o(s){s.isInterleavedBufferAttribute&&(s=s.data);const l=e.get(s);l&&(n.deleteBuffer(l.buffer),e.delete(s))}function r(s,l){if(s.isInterleavedBufferAttribute&&(s=s.data),s.isGLBufferAttribute){const u=e.get(s);(!u||u.version<s.version)&&e.set(s,{buffer:s.buffer,type:s.type,bytesPerElement:s.elementSize,version:s.version});return}const c=e.get(s);if(c===void 0)e.set(s,t(s,l));else if(c.version<s.version){if(c.size!==s.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");i(c.buffer,s,l),c.version=s.version}}return{get:a,remove:o,update:r}}var o4=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,r4=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,s4=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,l4=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,c4=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,g4=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,u4=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,d4=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,C4=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,I4=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,h4=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,f4=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,A4=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,m4=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,p4=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,b4=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,v4=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,y4=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,B4=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,G4=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,S4=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,w4=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,R4=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,Z4=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,x4=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,M4=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,W4=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,V4=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,N4=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,E4=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,H4="gl_FragColor = linearToOutputTexel( gl_FragColor );",F4=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,X4=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,T4=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,Y4=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,z4=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,K4=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,L4=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,_4=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,D4=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,O4=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,U4=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,k4=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,P4=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,J4=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,j4=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,Q4=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,q4=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,$4=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,ej=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,tj=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,nj=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,ij=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,aj=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,oj=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,rj=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,sj=`#if defined( USE_LOGDEPTHBUF )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,lj=`#if defined( USE_LOGDEPTHBUF )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,cj=`#ifdef USE_LOGDEPTHBUF
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,gj=`#ifdef USE_LOGDEPTHBUF
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,uj=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,dj=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,Cj=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,Ij=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,hj=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,fj=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,Aj=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,mj=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,pj=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,bj=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,vj=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,yj=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,Bj=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,Gj=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,Sj=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,wj=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,Rj=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,Zj=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,xj=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,Mj=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,Wj=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,Vj=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,Nj=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,Ej=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,Hj=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,Fj=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,Xj=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,Tj=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,Yj=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,zj=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
#endif`,Kj=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,Lj=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,_j=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,Dj=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,Oj=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,Uj=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,kj=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,Pj=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,Jj=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,jj=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,Qj=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,qj=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,$j=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		#else
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,eQ=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,tQ=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,nQ=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,iQ=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const aQ=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,oQ=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,rQ=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,sQ=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,lQ=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,cQ=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,gQ=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,uQ=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,dQ=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,CQ=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,IQ=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,hQ=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,fQ=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,AQ=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,mQ=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,pQ=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,bQ=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,vQ=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,yQ=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,BQ=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,GQ=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,SQ=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,wQ=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,RQ=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,ZQ=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,xQ=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,MQ=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,WQ=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,VQ=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,NQ=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,EQ=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,HQ=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,FQ=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,XQ=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,ti={alphahash_fragment:o4,alphahash_pars_fragment:r4,alphamap_fragment:s4,alphamap_pars_fragment:l4,alphatest_fragment:c4,alphatest_pars_fragment:g4,aomap_fragment:u4,aomap_pars_fragment:d4,batching_pars_vertex:C4,batching_vertex:I4,begin_vertex:h4,beginnormal_vertex:f4,bsdfs:A4,iridescence_fragment:m4,bumpmap_pars_fragment:p4,clipping_planes_fragment:b4,clipping_planes_pars_fragment:v4,clipping_planes_pars_vertex:y4,clipping_planes_vertex:B4,color_fragment:G4,color_pars_fragment:S4,color_pars_vertex:w4,color_vertex:R4,common:Z4,cube_uv_reflection_fragment:x4,defaultnormal_vertex:M4,displacementmap_pars_vertex:W4,displacementmap_vertex:V4,emissivemap_fragment:N4,emissivemap_pars_fragment:E4,colorspace_fragment:H4,colorspace_pars_fragment:F4,envmap_fragment:X4,envmap_common_pars_fragment:T4,envmap_pars_fragment:Y4,envmap_pars_vertex:z4,envmap_physical_pars_fragment:Q4,envmap_vertex:K4,fog_vertex:L4,fog_pars_vertex:_4,fog_fragment:D4,fog_pars_fragment:O4,gradientmap_pars_fragment:U4,lightmap_pars_fragment:k4,lights_lambert_fragment:P4,lights_lambert_pars_fragment:J4,lights_pars_begin:j4,lights_toon_fragment:q4,lights_toon_pars_fragment:$4,lights_phong_fragment:ej,lights_phong_pars_fragment:tj,lights_physical_fragment:nj,lights_physical_pars_fragment:ij,lights_fragment_begin:aj,lights_fragment_maps:oj,lights_fragment_end:rj,logdepthbuf_fragment:sj,logdepthbuf_pars_fragment:lj,logdepthbuf_pars_vertex:cj,logdepthbuf_vertex:gj,map_fragment:uj,map_pars_fragment:dj,map_particle_fragment:Cj,map_particle_pars_fragment:Ij,metalnessmap_fragment:hj,metalnessmap_pars_fragment:fj,morphinstance_vertex:Aj,morphcolor_vertex:mj,morphnormal_vertex:pj,morphtarget_pars_vertex:bj,morphtarget_vertex:vj,normal_fragment_begin:yj,normal_fragment_maps:Bj,normal_pars_fragment:Gj,normal_pars_vertex:Sj,normal_vertex:wj,normalmap_pars_fragment:Rj,clearcoat_normal_fragment_begin:Zj,clearcoat_normal_fragment_maps:xj,clearcoat_pars_fragment:Mj,iridescence_pars_fragment:Wj,opaque_fragment:Vj,packing:Nj,premultiplied_alpha_fragment:Ej,project_vertex:Hj,dithering_fragment:Fj,dithering_pars_fragment:Xj,roughnessmap_fragment:Tj,roughnessmap_pars_fragment:Yj,shadowmap_pars_fragment:zj,shadowmap_pars_vertex:Kj,shadowmap_vertex:Lj,shadowmask_pars_fragment:_j,skinbase_vertex:Dj,skinning_pars_vertex:Oj,skinning_vertex:Uj,skinnormal_vertex:kj,specularmap_fragment:Pj,specularmap_pars_fragment:Jj,tonemapping_fragment:jj,tonemapping_pars_fragment:Qj,transmission_fragment:qj,transmission_pars_fragment:$j,uv_pars_fragment:eQ,uv_pars_vertex:tQ,uv_vertex:nQ,worldpos_vertex:iQ,background_vert:aQ,background_frag:oQ,backgroundCube_vert:rQ,backgroundCube_frag:sQ,cube_vert:lQ,cube_frag:cQ,depth_vert:gQ,depth_frag:uQ,distanceRGBA_vert:dQ,distanceRGBA_frag:CQ,equirect_vert:IQ,equirect_frag:hQ,linedashed_vert:fQ,linedashed_frag:AQ,meshbasic_vert:mQ,meshbasic_frag:pQ,meshlambert_vert:bQ,meshlambert_frag:vQ,meshmatcap_vert:yQ,meshmatcap_frag:BQ,meshnormal_vert:GQ,meshnormal_frag:SQ,meshphong_vert:wQ,meshphong_frag:RQ,meshphysical_vert:ZQ,meshphysical_frag:xQ,meshtoon_vert:MQ,meshtoon_frag:WQ,points_vert:VQ,points_frag:NQ,shadow_vert:EQ,shadow_frag:HQ,sprite_vert:FQ,sprite_frag:XQ},hn={common:{diffuse:{value:new dn(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Jn},alphaMap:{value:null},alphaMapTransform:{value:new Jn},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Jn}},envmap:{envMap:{value:null},envMapRotation:{value:new Jn},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Jn}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Jn}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Jn},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Jn},normalScale:{value:new Xt(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Jn},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Jn}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Jn}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Jn}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new dn(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new dn(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Jn},alphaTest:{value:0},uvTransform:{value:new Jn}},sprite:{diffuse:{value:new dn(16777215)},opacity:{value:1},center:{value:new Xt(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Jn},alphaMap:{value:null},alphaMapTransform:{value:new Jn},alphaTest:{value:0}}},lc={basic:{uniforms:zr([hn.common,hn.specularmap,hn.envmap,hn.aomap,hn.lightmap,hn.fog]),vertexShader:ti.meshbasic_vert,fragmentShader:ti.meshbasic_frag},lambert:{uniforms:zr([hn.common,hn.specularmap,hn.envmap,hn.aomap,hn.lightmap,hn.emissivemap,hn.bumpmap,hn.normalmap,hn.displacementmap,hn.fog,hn.lights,{emissive:{value:new dn(0)}}]),vertexShader:ti.meshlambert_vert,fragmentShader:ti.meshlambert_frag},phong:{uniforms:zr([hn.common,hn.specularmap,hn.envmap,hn.aomap,hn.lightmap,hn.emissivemap,hn.bumpmap,hn.normalmap,hn.displacementmap,hn.fog,hn.lights,{emissive:{value:new dn(0)},specular:{value:new dn(1118481)},shininess:{value:30}}]),vertexShader:ti.meshphong_vert,fragmentShader:ti.meshphong_frag},standard:{uniforms:zr([hn.common,hn.envmap,hn.aomap,hn.lightmap,hn.emissivemap,hn.bumpmap,hn.normalmap,hn.displacementmap,hn.roughnessmap,hn.metalnessmap,hn.fog,hn.lights,{emissive:{value:new dn(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:ti.meshphysical_vert,fragmentShader:ti.meshphysical_frag},toon:{uniforms:zr([hn.common,hn.aomap,hn.lightmap,hn.emissivemap,hn.bumpmap,hn.normalmap,hn.displacementmap,hn.gradientmap,hn.fog,hn.lights,{emissive:{value:new dn(0)}}]),vertexShader:ti.meshtoon_vert,fragmentShader:ti.meshtoon_frag},matcap:{uniforms:zr([hn.common,hn.bumpmap,hn.normalmap,hn.displacementmap,hn.fog,{matcap:{value:null}}]),vertexShader:ti.meshmatcap_vert,fragmentShader:ti.meshmatcap_frag},points:{uniforms:zr([hn.points,hn.fog]),vertexShader:ti.points_vert,fragmentShader:ti.points_frag},dashed:{uniforms:zr([hn.common,hn.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:ti.linedashed_vert,fragmentShader:ti.linedashed_frag},depth:{uniforms:zr([hn.common,hn.displacementmap]),vertexShader:ti.depth_vert,fragmentShader:ti.depth_frag},normal:{uniforms:zr([hn.common,hn.bumpmap,hn.normalmap,hn.displacementmap,{opacity:{value:1}}]),vertexShader:ti.meshnormal_vert,fragmentShader:ti.meshnormal_frag},sprite:{uniforms:zr([hn.sprite,hn.fog]),vertexShader:ti.sprite_vert,fragmentShader:ti.sprite_frag},background:{uniforms:{uvTransform:{value:new Jn},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:ti.background_vert,fragmentShader:ti.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new Jn}},vertexShader:ti.backgroundCube_vert,fragmentShader:ti.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:ti.cube_vert,fragmentShader:ti.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:ti.equirect_vert,fragmentShader:ti.equirect_frag},distanceRGBA:{uniforms:zr([hn.common,hn.displacementmap,{referencePosition:{value:new Be},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:ti.distanceRGBA_vert,fragmentShader:ti.distanceRGBA_frag},shadow:{uniforms:zr([hn.lights,hn.fog,{color:{value:new dn(0)},opacity:{value:1}}]),vertexShader:ti.shadow_vert,fragmentShader:ti.shadow_frag}};lc.physical={uniforms:zr([lc.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Jn},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Jn},clearcoatNormalScale:{value:new Xt(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Jn},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Jn},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Jn},sheen:{value:0},sheenColor:{value:new dn(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Jn},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Jn},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Jn},transmissionSamplerSize:{value:new Xt},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Jn},attenuationDistance:{value:0},attenuationColor:{value:new dn(0)},specularColor:{value:new dn(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Jn},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Jn},anisotropyVector:{value:new Xt},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Jn}}]),vertexShader:ti.meshphysical_vert,fragmentShader:ti.meshphysical_frag};const zv={r:0,b:0,g:0},RC=new ys,TQ=new Vn;function YQ(n,e,t,i,a,o,r){const s=new dn(0);let l=o===!0?0:1,c,u,C=null,h=0,m=null;function p(R){let Z=R.isScene===!0?R.background:null;return Z&&Z.isTexture&&(Z=(R.backgroundBlurriness>0?t:e).get(Z)),Z}function B(R){let Z=!1;const x=p(R);x===null?y(s,l):x&&x.isColor&&(y(x,1),Z=!0);const M=n.xr.getEnvironmentBlendMode();M==="additive"?i.buffers.color.setClear(0,0,0,1,r):M==="alpha-blend"&&i.buffers.color.setClear(0,0,0,0,r),(n.autoClear||Z)&&(i.buffers.depth.setTest(!0),i.buffers.depth.setMask(!0),i.buffers.color.setMask(!0),n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil))}function b(R,Z){const x=p(Z);x&&(x.isCubeTexture||x.mapping===Of)?(u===void 0&&(u=new $i(new wd(1,1,1),new Ur({name:"BackgroundCubeMaterial",uniforms:Rf(lc.backgroundCube.uniforms),vertexShader:lc.backgroundCube.vertexShader,fragmentShader:lc.backgroundCube.fragmentShader,side:fr,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),u.geometry.deleteAttribute("normal"),u.geometry.deleteAttribute("uv"),u.onBeforeRender=function(M,E,F){this.matrixWorld.copyPosition(F.matrixWorld)},Object.defineProperty(u.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),a.update(u)),RC.copy(Z.backgroundRotation),RC.x*=-1,RC.y*=-1,RC.z*=-1,x.isCubeTexture&&x.isRenderTargetTexture===!1&&(RC.y*=-1,RC.z*=-1),u.material.uniforms.envMap.value=x,u.material.uniforms.flipEnvMap.value=x.isCubeTexture&&x.isRenderTargetTexture===!1?-1:1,u.material.uniforms.backgroundBlurriness.value=Z.backgroundBlurriness,u.material.uniforms.backgroundIntensity.value=Z.backgroundIntensity,u.material.uniforms.backgroundRotation.value.setFromMatrix4(TQ.makeRotationFromEuler(RC)),u.material.toneMapped=vi.getTransfer(x.colorSpace)!==Ui,(C!==x||h!==x.version||m!==n.toneMapping)&&(u.material.needsUpdate=!0,C=x,h=x.version,m=n.toneMapping),u.layers.enableAll(),R.unshift(u,u.geometry,u.material,0,0,null)):x&&x.isTexture&&(c===void 0&&(c=new $i(new pc(2,2),new Ur({name:"BackgroundMaterial",uniforms:Rf(lc.background.uniforms),vertexShader:lc.background.vertexShader,fragmentShader:lc.background.fragmentShader,side:dg,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),a.update(c)),c.material.uniforms.t2D.value=x,c.material.uniforms.backgroundIntensity.value=Z.backgroundIntensity,c.material.toneMapped=vi.getTransfer(x.colorSpace)!==Ui,x.matrixAutoUpdate===!0&&x.updateMatrix(),c.material.uniforms.uvTransform.value.copy(x.matrix),(C!==x||h!==x.version||m!==n.toneMapping)&&(c.material.needsUpdate=!0,C=x,h=x.version,m=n.toneMapping),c.layers.enableAll(),R.unshift(c,c.geometry,c.material,0,0,null))}function y(R,Z){R.getRGB(zv,H9(n)),i.buffers.color.setClear(zv.r,zv.g,zv.b,Z,r)}function S(){u!==void 0&&(u.geometry.dispose(),u.material.dispose(),u=void 0),c!==void 0&&(c.geometry.dispose(),c.material.dispose(),c=void 0)}return{getClearColor:function(){return s},setClearColor:function(R,Z=1){s.set(R),l=Z,y(s,l)},getClearAlpha:function(){return l},setClearAlpha:function(R){l=R,y(s,l)},render:B,addToRenderList:b,dispose:S}}function zQ(n,e){const t=n.getParameter(n.MAX_VERTEX_ATTRIBS),i={},a=h(null);let o=a,r=!1;function s(H,z,_,D,P){let $=!1;const X=C(D,_,z);o!==X&&(o=X,c(o.object)),$=m(H,D,_,P),$&&p(H,D,_,P),P!==null&&e.update(P,n.ELEMENT_ARRAY_BUFFER),($||r)&&(r=!1,Z(H,z,_,D),P!==null&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,e.get(P).buffer))}function l(){return n.createVertexArray()}function c(H){return n.bindVertexArray(H)}function u(H){return n.deleteVertexArray(H)}function C(H,z,_){const D=_.wireframe===!0;let P=i[H.id];P===void 0&&(P={},i[H.id]=P);let $=P[z.id];$===void 0&&($={},P[z.id]=$);let X=$[D];return X===void 0&&(X=h(l()),$[D]=X),X}function h(H){const z=[],_=[],D=[];for(let P=0;P<t;P++)z[P]=0,_[P]=0,D[P]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:z,enabledAttributes:_,attributeDivisors:D,object:H,attributes:{},index:null}}function m(H,z,_,D){const P=o.attributes,$=z.attributes;let X=0;const L=_.getAttributes();for(const U in L)if(L[U].location>=0){const K=P[U];let O=$[U];if(O===void 0&&(U==="instanceMatrix"&&H.instanceMatrix&&(O=H.instanceMatrix),U==="instanceColor"&&H.instanceColor&&(O=H.instanceColor)),K===void 0||K.attribute!==O||O&&K.data!==O.data)return!0;X++}return o.attributesNum!==X||o.index!==D}function p(H,z,_,D){const P={},$=z.attributes;let X=0;const L=_.getAttributes();for(const U in L)if(L[U].location>=0){let K=$[U];K===void 0&&(U==="instanceMatrix"&&H.instanceMatrix&&(K=H.instanceMatrix),U==="instanceColor"&&H.instanceColor&&(K=H.instanceColor));const O={};O.attribute=K,K&&K.data&&(O.data=K.data),P[U]=O,X++}o.attributes=P,o.attributesNum=X,o.index=D}function B(){const H=o.newAttributes;for(let z=0,_=H.length;z<_;z++)H[z]=0}function b(H){y(H,0)}function y(H,z){const _=o.newAttributes,D=o.enabledAttributes,P=o.attributeDivisors;_[H]=1,D[H]===0&&(n.enableVertexAttribArray(H),D[H]=1),P[H]!==z&&(n.vertexAttribDivisor(H,z),P[H]=z)}function S(){const H=o.newAttributes,z=o.enabledAttributes;for(let _=0,D=z.length;_<D;_++)z[_]!==H[_]&&(n.disableVertexAttribArray(_),z[_]=0)}function R(H,z,_,D,P,$,X){X===!0?n.vertexAttribIPointer(H,z,_,P,$):n.vertexAttribPointer(H,z,_,D,P,$)}function Z(H,z,_,D){B();const P=D.attributes,$=_.getAttributes(),X=z.defaultAttributeValues;for(const L in $){const U=$[L];if(U.location>=0){let q=P[L];if(q===void 0&&(L==="instanceMatrix"&&H.instanceMatrix&&(q=H.instanceMatrix),L==="instanceColor"&&H.instanceColor&&(q=H.instanceColor)),q!==void 0){const K=q.normalized,O=q.itemSize,j=e.get(q);if(j===void 0)continue;const ne=j.buffer,k=j.type,ie=j.bytesPerElement,re=k===n.INT||k===n.UNSIGNED_INT||q.gpuType===nb;if(q.isInterleavedBufferAttribute){const ge=q.data,de=ge.stride,xe=q.offset;if(ge.isInstancedInterleavedBuffer){for(let Ne=0;Ne<U.locationSize;Ne++)y(U.location+Ne,ge.meshPerAttribute);H.isInstancedMesh!==!0&&D._maxInstanceCount===void 0&&(D._maxInstanceCount=ge.meshPerAttribute*ge.count)}else for(let Ne=0;Ne<U.locationSize;Ne++)b(U.location+Ne);n.bindBuffer(n.ARRAY_BUFFER,ne);for(let Ne=0;Ne<U.locationSize;Ne++)R(U.location+Ne,O/U.locationSize,k,K,de*ie,(xe+O/U.locationSize*Ne)*ie,re)}else{if(q.isInstancedBufferAttribute){for(let ge=0;ge<U.locationSize;ge++)y(U.location+ge,q.meshPerAttribute);H.isInstancedMesh!==!0&&D._maxInstanceCount===void 0&&(D._maxInstanceCount=q.meshPerAttribute*q.count)}else for(let ge=0;ge<U.locationSize;ge++)b(U.location+ge);n.bindBuffer(n.ARRAY_BUFFER,ne);for(let ge=0;ge<U.locationSize;ge++)R(U.location+ge,O/U.locationSize,k,K,O*ie,O/U.locationSize*ge*ie,re)}}else if(X!==void 0){const K=X[L];if(K!==void 0)switch(K.length){case 2:n.vertexAttrib2fv(U.location,K);break;case 3:n.vertexAttrib3fv(U.location,K);break;case 4:n.vertexAttrib4fv(U.location,K);break;default:n.vertexAttrib1fv(U.location,K)}}}}S()}function x(){F();for(const H in i){const z=i[H];for(const _ in z){const D=z[_];for(const P in D)u(D[P].object),delete D[P];delete z[_]}delete i[H]}}function M(H){if(i[H.id]===void 0)return;const z=i[H.id];for(const _ in z){const D=z[_];for(const P in D)u(D[P].object),delete D[P];delete z[_]}delete i[H.id]}function E(H){for(const z in i){const _=i[z];if(_[H.id]===void 0)continue;const D=_[H.id];for(const P in D)u(D[P].object),delete D[P];delete _[H.id]}}function F(){N(),r=!0,o!==a&&(o=a,c(o.object))}function N(){a.geometry=null,a.program=null,a.wireframe=!1}return{setup:s,reset:F,resetDefaultState:N,dispose:x,releaseStatesOfGeometry:M,releaseStatesOfProgram:E,initAttributes:B,enableAttribute:b,disableUnusedAttributes:S}}function KQ(n,e,t){let i;function a(c){i=c}function o(c,u){n.drawArrays(i,c,u),t.update(u,i,1)}function r(c,u,C){C!==0&&(n.drawArraysInstanced(i,c,u,C),t.update(u,i,C))}function s(c,u,C){if(C===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(i,c,0,u,0,C);let m=0;for(let p=0;p<C;p++)m+=u[p];t.update(m,i,1)}function l(c,u,C,h){if(C===0)return;const m=e.get("WEBGL_multi_draw");if(m===null)for(let p=0;p<c.length;p++)r(c[p],u[p],h[p]);else{m.multiDrawArraysInstancedWEBGL(i,c,0,u,0,h,0,C);let p=0;for(let B=0;B<C;B++)p+=u[B]*h[B];t.update(p,i,1)}}this.setMode=a,this.render=o,this.renderInstances=r,this.renderMultiDraw=s,this.renderMultiDrawInstances=l}function LQ(n,e,t,i){let a;function o(){if(a!==void 0)return a;if(e.has("EXT_texture_filter_anisotropic")===!0){const E=e.get("EXT_texture_filter_anisotropic");a=n.getParameter(E.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else a=0;return a}function r(E){return!(E!==La&&i.convert(E)!==n.getParameter(n.IMPLEMENTATION_COLOR_READ_FORMAT))}function s(E){const F=E===Co&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(E!==vs&&i.convert(E)!==n.getParameter(n.IMPLEMENTATION_COLOR_READ_TYPE)&&E!==ma&&!F)}function l(E){if(E==="highp"){if(n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision>0)return"highp";E="mediump"}return E==="mediump"&&n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let c=t.precision!==void 0?t.precision:"highp";const u=l(c);u!==c&&(console.warn("THREE.WebGLRenderer:",c,"not supported, using",u,"instead."),c=u);const C=t.logarithmicDepthBuffer===!0,h=t.reverseDepthBuffer===!0&&e.has("EXT_clip_control"),m=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS),p=n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS),B=n.getParameter(n.MAX_TEXTURE_SIZE),b=n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE),y=n.getParameter(n.MAX_VERTEX_ATTRIBS),S=n.getParameter(n.MAX_VERTEX_UNIFORM_VECTORS),R=n.getParameter(n.MAX_VARYING_VECTORS),Z=n.getParameter(n.MAX_FRAGMENT_UNIFORM_VECTORS),x=p>0,M=n.getParameter(n.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:o,getMaxPrecision:l,textureFormatReadable:r,textureTypeReadable:s,precision:c,logarithmicDepthBuffer:C,reverseDepthBuffer:h,maxTextures:m,maxVertexTextures:p,maxTextureSize:B,maxCubemapSize:b,maxAttributes:y,maxVertexUniforms:S,maxVaryings:R,maxFragmentUniforms:Z,vertexTextures:x,maxSamples:M}}function _Q(n){const e=this;let t=null,i=0,a=!1,o=!1;const r=new qg,s=new Jn,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(C,h){const m=C.length!==0||h||i!==0||a;return a=h,i=C.length,m},this.beginShadows=function(){o=!0,u(null)},this.endShadows=function(){o=!1},this.setGlobalState=function(C,h){t=u(C,h,0)},this.setState=function(C,h,m){const p=C.clippingPlanes,B=C.clipIntersection,b=C.clipShadows,y=n.get(C);if(!a||p===null||p.length===0||o&&!b)o?u(null):c();else{const S=o?0:i,R=S*4;let Z=y.clippingState||null;l.value=Z,Z=u(p,h,R,m);for(let x=0;x!==R;++x)Z[x]=t[x];y.clippingState=Z,this.numIntersection=B?this.numPlanes:0,this.numPlanes+=S}};function c(){l.value!==t&&(l.value=t,l.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}function u(C,h,m,p){const B=C!==null?C.length:0;let b=null;if(B!==0){if(b=l.value,p!==!0||b===null){const y=m+B*4,S=h.matrixWorldInverse;s.getNormalMatrix(S),(b===null||b.length<y)&&(b=new Float32Array(y));for(let R=0,Z=m;R!==B;++R,Z+=4)r.copy(C[R]).applyMatrix4(S,s),r.normal.toArray(b,Z),b[Z+3]=r.constant}l.value=b,l.needsUpdate=!0}return e.numPlanes=B,e.numIntersection=0,b}}function DQ(n){let e=new WeakMap;function t(r,s){return s===Af?r.mapping=Cg:s===Bp&&(r.mapping=bd),r}function i(r){if(r&&r.isTexture){const s=r.mapping;if(s===Af||s===Bp)if(e.has(r)){const l=e.get(r).texture;return t(l,r.mapping)}else{const l=r.image;if(l&&l.height>0){const c=new cx(l.height);return c.fromEquirectangularTexture(n,r),e.set(r,c),r.addEventListener("dispose",a),t(c.texture,r.mapping)}else return null}}return r}function a(r){const s=r.target;s.removeEventListener("dispose",a);const l=e.get(s);l!==void 0&&(e.delete(s),l.dispose())}function o(){e=new WeakMap}return{get:i,dispose:o}}const af=4,pN=[.125,.215,.35,.446,.526,.582],TC=20,$2=new bl,bN=new dn;let ew=null,tw=0,nw=0,iw=!1;const XC=(1+Math.sqrt(5))/2,zh=1/XC,vN=[new Be(-XC,zh,0),new Be(XC,zh,0),new Be(-zh,0,XC),new Be(zh,0,XC),new Be(0,XC,-zh),new Be(0,XC,zh),new Be(-1,1,-1),new Be(1,1,-1),new Be(-1,1,1),new Be(1,1,1)],OQ=new Be;class tR{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,i=.1,a=100,o={}){const{size:r=256,position:s=OQ}=o;ew=this._renderer.getRenderTarget(),tw=this._renderer.getActiveCubeFace(),nw=this._renderer.getActiveMipmapLevel(),iw=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(r);const l=this._allocateTargets();return l.depthBuffer=!0,this._sceneToCubeUV(e,i,a,l,s),t>0&&this._blur(l,0,0,t),this._applyPMREM(l),this._cleanup(l),l}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=GN(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=BN(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(ew,tw,nw),this._renderer.xr.enabled=iw,e.scissorTest=!1,Kv(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===Cg||e.mapping===bd?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),ew=this._renderer.getRenderTarget(),tw=this._renderer.getActiveCubeFace(),nw=this._renderer.getActiveMipmapLevel(),iw=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,i={magFilter:Bi,minFilter:Bi,generateMipmaps:!1,type:Co,format:La,colorSpace:Cc,depthBuffer:!1},a=yN(e,t,i);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=yN(e,t,i);const{_lodMax:o}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=UQ(o)),this._blurMaterial=kQ(o,e,t)}return a}_compileMaterial(e){const t=new $i(this._lodPlanes[0],e);this._renderer.compile(t,$2)}_sceneToCubeUV(e,t,i,a,o){const l=new fa(90,1,t,i),c=[1,-1,1,1,1,1],u=[1,1,1,-1,-1,-1],C=this._renderer,h=C.autoClear,m=C.toneMapping;C.getClearColor(bN),C.toneMapping=lg,C.autoClear=!1;const p=new Or({name:"PMREM.Background",side:fr,depthWrite:!1,depthTest:!1}),B=new $i(new wd,p);let b=!1;const y=e.background;y?y.isColor&&(p.color.copy(y),e.background=null,b=!0):(p.color.copy(bN),b=!0);for(let S=0;S<6;S++){const R=S%3;R===0?(l.up.set(0,c[S],0),l.position.set(o.x,o.y,o.z),l.lookAt(o.x+u[S],o.y,o.z)):R===1?(l.up.set(0,0,c[S]),l.position.set(o.x,o.y,o.z),l.lookAt(o.x,o.y+u[S],o.z)):(l.up.set(0,c[S],0),l.position.set(o.x,o.y,o.z),l.lookAt(o.x,o.y,o.z+u[S]));const Z=this._cubeSize;Kv(a,R*Z,S>2?Z:0,Z,Z),C.setRenderTarget(a),b&&C.render(B,l),C.render(e,l)}B.geometry.dispose(),B.material.dispose(),C.toneMapping=m,C.autoClear=h,e.background=y}_textureToCubeUV(e,t){const i=this._renderer,a=e.mapping===Cg||e.mapping===bd;a?(this._cubemapMaterial===null&&(this._cubemapMaterial=GN()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=BN());const o=a?this._cubemapMaterial:this._equirectMaterial,r=new $i(this._lodPlanes[0],o),s=o.uniforms;s.envMap.value=e;const l=this._cubeSize;Kv(t,0,0,3*l,2*l),i.setRenderTarget(t),i.render(r,$2)}_applyPMREM(e){const t=this._renderer,i=t.autoClear;t.autoClear=!1;const a=this._lodPlanes.length;for(let o=1;o<a;o++){const r=Math.sqrt(this._sigmas[o]*this._sigmas[o]-this._sigmas[o-1]*this._sigmas[o-1]),s=vN[(a-o-1)%vN.length];this._blur(e,o-1,o,r,s)}t.autoClear=i}_blur(e,t,i,a,o){const r=this._pingPongRenderTarget;this._halfBlur(e,r,t,i,a,"latitudinal",o),this._halfBlur(r,e,i,i,a,"longitudinal",o)}_halfBlur(e,t,i,a,o,r,s){const l=this._renderer,c=this._blurMaterial;r!=="latitudinal"&&r!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const u=3,C=new $i(this._lodPlanes[a],c),h=c.uniforms,m=this._sizeLods[i]-1,p=isFinite(o)?Math.PI/(2*m):2*Math.PI/(2*TC-1),B=o/p,b=isFinite(o)?1+Math.floor(u*B):TC;b>TC&&console.warn(`sigmaRadians, ${o}, is too large and will clip, as it requested ${b} samples when the maximum is set to ${TC}`);const y=[];let S=0;for(let E=0;E<TC;++E){const F=E/B,N=Math.exp(-F*F/2);y.push(N),E===0?S+=N:E<b&&(S+=2*N)}for(let E=0;E<y.length;E++)y[E]=y[E]/S;h.envMap.value=e.texture,h.samples.value=b,h.weights.value=y,h.latitudinal.value=r==="latitudinal",s&&(h.poleAxis.value=s);const{_lodMax:R}=this;h.dTheta.value=p,h.mipInt.value=R-i;const Z=this._sizeLods[a],x=3*Z*(a>R-af?a-R+af:0),M=4*(this._cubeSize-Z);Kv(t,x,M,3*Z,2*Z),l.setRenderTarget(t),l.render(C,$2)}}function UQ(n){const e=[],t=[],i=[];let a=n;const o=n-af+1+pN.length;for(let r=0;r<o;r++){const s=Math.pow(2,a);t.push(s);let l=1/s;r>n-af?l=pN[r-n+af-1]:r===0&&(l=0),i.push(l);const c=1/(s-2),u=-c,C=1+c,h=[u,u,C,u,C,C,u,u,C,C,u,C],m=6,p=6,B=3,b=2,y=1,S=new Float32Array(B*p*m),R=new Float32Array(b*p*m),Z=new Float32Array(y*p*m);for(let M=0;M<m;M++){const E=M%3*2/3-1,F=M>2?0:-1,N=[E,F,0,E+2/3,F,0,E+2/3,F+1,0,E,F,0,E+2/3,F+1,0,E,F+1,0];S.set(N,B*p*M),R.set(h,b*p*M);const H=[M,M,M,M,M,M];Z.set(H,y*p*M)}const x=new $n;x.setAttribute("position",new Mi(S,B)),x.setAttribute("uv",new Mi(R,b)),x.setAttribute("faceIndex",new Mi(Z,y)),e.push(x),a>af&&a--}return{lodPlanes:e,sizeLods:t,sigmas:i}}function yN(n,e,t){const i=new Us(n,e,t);return i.texture.mapping=Of,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function Kv(n,e,t,i,a){n.viewport.set(e,t,i,a),n.scissor.set(e,t,i,a)}function kQ(n,e,t){const i=new Float32Array(TC),a=new Be(0,1,0);return new Ur({name:"SphericalGaussianBlur",defines:{n:TC,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:a}},vertexShader:Xx(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:sg,depthTest:!1,depthWrite:!1})}function BN(){return new Ur({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:Xx(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:sg,depthTest:!1,depthWrite:!1})}function GN(){return new Ur({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:Xx(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:sg,depthTest:!1,depthWrite:!1})}function Xx(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function PQ(n){let e=new WeakMap,t=null;function i(s){if(s&&s.isTexture){const l=s.mapping,c=l===Af||l===Bp,u=l===Cg||l===bd;if(c||u){let C=e.get(s);const h=C!==void 0?C.texture.pmremVersion:0;if(s.isRenderTargetTexture&&s.pmremVersion!==h)return t===null&&(t=new tR(n)),C=c?t.fromEquirectangular(s,C):t.fromCubemap(s,C),C.texture.pmremVersion=s.pmremVersion,e.set(s,C),C.texture;if(C!==void 0)return C.texture;{const m=s.image;return c&&m&&m.height>0||u&&m&&a(m)?(t===null&&(t=new tR(n)),C=c?t.fromEquirectangular(s):t.fromCubemap(s),C.texture.pmremVersion=s.pmremVersion,e.set(s,C),s.addEventListener("dispose",o),C.texture):null}}}return s}function a(s){let l=0;const c=6;for(let u=0;u<c;u++)s[u]!==void 0&&l++;return l===c}function o(s){const l=s.target;l.removeEventListener("dispose",o);const c=e.get(l);c!==void 0&&(e.delete(l),c.dispose())}function r(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:i,dispose:r}}function JQ(n){const e={};function t(i){if(e[i]!==void 0)return e[i];let a;switch(i){case"WEBGL_depth_texture":a=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":a=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":a=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":a=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:a=n.getExtension(i)}return e[i]=a,a}return{has:function(i){return t(i)!==null},init:function(){t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance"),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture"),t("WEBGL_render_shared_exponent")},get:function(i){const a=t(i);return a===null&&yy("THREE.WebGLRenderer: "+i+" extension not supported."),a}}}function jQ(n,e,t,i){const a={},o=new WeakMap;function r(C){const h=C.target;h.index!==null&&e.remove(h.index);for(const p in h.attributes)e.remove(h.attributes[p]);h.removeEventListener("dispose",r),delete a[h.id];const m=o.get(h);m&&(e.remove(m),o.delete(h)),i.releaseStatesOfGeometry(h),h.isInstancedBufferGeometry===!0&&delete h._maxInstanceCount,t.memory.geometries--}function s(C,h){return a[h.id]===!0||(h.addEventListener("dispose",r),a[h.id]=!0,t.memory.geometries++),h}function l(C){const h=C.attributes;for(const m in h)e.update(h[m],n.ARRAY_BUFFER)}function c(C){const h=[],m=C.index,p=C.attributes.position;let B=0;if(m!==null){const S=m.array;B=m.version;for(let R=0,Z=S.length;R<Z;R+=3){const x=S[R+0],M=S[R+1],E=S[R+2];h.push(x,M,M,E,E,x)}}else if(p!==void 0){const S=p.array;B=p.version;for(let R=0,Z=S.length/3-1;R<Z;R+=3){const x=R+0,M=R+1,E=R+2;h.push(x,M,M,E,E,x)}}else return;const b=new(W9(h)?lx:sx)(h,1);b.version=B;const y=o.get(C);y&&e.remove(y),o.set(C,b)}function u(C){const h=o.get(C);if(h){const m=C.index;m!==null&&h.version<m.version&&c(C)}else c(C);return o.get(C)}return{get:s,update:l,getWireframeAttribute:u}}function QQ(n,e,t){let i;function a(h){i=h}let o,r;function s(h){o=h.type,r=h.bytesPerElement}function l(h,m){n.drawElements(i,m,o,h*r),t.update(m,i,1)}function c(h,m,p){p!==0&&(n.drawElementsInstanced(i,m,o,h*r,p),t.update(m,i,p))}function u(h,m,p){if(p===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(i,m,0,o,h,0,p);let b=0;for(let y=0;y<p;y++)b+=m[y];t.update(b,i,1)}function C(h,m,p,B){if(p===0)return;const b=e.get("WEBGL_multi_draw");if(b===null)for(let y=0;y<h.length;y++)c(h[y]/r,m[y],B[y]);else{b.multiDrawElementsInstancedWEBGL(i,m,0,o,h,0,B,0,p);let y=0;for(let S=0;S<p;S++)y+=m[S]*B[S];t.update(y,i,1)}}this.setMode=a,this.setIndex=s,this.render=l,this.renderInstances=c,this.renderMultiDraw=u,this.renderMultiDrawInstances=C}function qQ(n){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function i(o,r,s){switch(t.calls++,r){case n.TRIANGLES:t.triangles+=s*(o/3);break;case n.LINES:t.lines+=s*(o/2);break;case n.LINE_STRIP:t.lines+=s*(o-1);break;case n.LINE_LOOP:t.lines+=s*o;break;case n.POINTS:t.points+=s*o;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",r);break}}function a(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:a,update:i}}function $Q(n,e,t){const i=new WeakMap,a=new yi;function o(r,s,l){const c=r.morphTargetInfluences,u=s.morphAttributes.position||s.morphAttributes.normal||s.morphAttributes.color,C=u!==void 0?u.length:0;let h=i.get(s);if(h===void 0||h.count!==C){let H=function(){F.dispose(),i.delete(s),s.removeEventListener("dispose",H)};var m=H;h!==void 0&&h.texture.dispose();const p=s.morphAttributes.position!==void 0,B=s.morphAttributes.normal!==void 0,b=s.morphAttributes.color!==void 0,y=s.morphAttributes.position||[],S=s.morphAttributes.normal||[],R=s.morphAttributes.color||[];let Z=0;p===!0&&(Z=1),B===!0&&(Z=2),b===!0&&(Z=3);let x=s.attributes.position.count*Z,M=1;x>e.maxTextureSize&&(M=Math.ceil(x/e.maxTextureSize),x=e.maxTextureSize);const E=new Float32Array(x*M*4*C),F=new ob(E,x,M,C);F.type=ma,F.needsUpdate=!0;const N=Z*4;for(let z=0;z<C;z++){const _=y[z],D=S[z],P=R[z],$=x*M*4*z;for(let X=0;X<_.count;X++){const L=X*N;p===!0&&(a.fromBufferAttribute(_,X),E[$+L+0]=a.x,E[$+L+1]=a.y,E[$+L+2]=a.z,E[$+L+3]=0),B===!0&&(a.fromBufferAttribute(D,X),E[$+L+4]=a.x,E[$+L+5]=a.y,E[$+L+6]=a.z,E[$+L+7]=0),b===!0&&(a.fromBufferAttribute(P,X),E[$+L+8]=a.x,E[$+L+9]=a.y,E[$+L+10]=a.z,E[$+L+11]=P.itemSize===4?a.w:1)}}h={count:C,texture:F,size:new Xt(x,M)},i.set(s,h),s.addEventListener("dispose",H)}if(r.isInstancedMesh===!0&&r.morphTexture!==null)l.getUniforms().setValue(n,"morphTexture",r.morphTexture,t);else{let p=0;for(let b=0;b<c.length;b++)p+=c[b];const B=s.morphTargetsRelative?1:1-p;l.getUniforms().setValue(n,"morphTargetBaseInfluence",B),l.getUniforms().setValue(n,"morphTargetInfluences",c)}l.getUniforms().setValue(n,"morphTargetsTexture",h.texture,t),l.getUniforms().setValue(n,"morphTargetsTextureSize",h.size)}return{update:o}}function e7(n,e,t,i){let a=new WeakMap;function o(l){const c=i.render.frame,u=l.geometry,C=e.get(l,u);if(a.get(C)!==c&&(e.update(C),a.set(C,c)),l.isInstancedMesh&&(l.hasEventListener("dispose",s)===!1&&l.addEventListener("dispose",s),a.get(l)!==c&&(t.update(l.instanceMatrix,n.ARRAY_BUFFER),l.instanceColor!==null&&t.update(l.instanceColor,n.ARRAY_BUFFER),a.set(l,c))),l.isSkinnedMesh){const h=l.skeleton;a.get(h)!==c&&(h.update(),a.set(h,c))}return C}function r(){a=new WeakMap}function s(l){const c=l.target;c.removeEventListener("dispose",s),t.remove(c.instanceMatrix),c.instanceColor!==null&&t.remove(c.instanceColor)}return{update:o,dispose:r}}const MX=new Fi,SN=new xG(1,1),WX=new ob,VX=new vG,NX=new rb,wN=[],RN=[],ZN=new Float32Array(16),xN=new Float32Array(9),MN=new Float32Array(4);function Pf(n,e,t){const i=n[0];if(i<=0||i>0)return n;const a=e*t;let o=wN[a];if(o===void 0&&(o=new Float32Array(a),wN[a]=o),e!==0){i.toArray(o,0);for(let r=1,s=0;r!==e;++r)s+=t,n[r].toArray(o,s)}return o}function fo(n,e){if(n.length!==e.length)return!1;for(let t=0,i=n.length;t<i;t++)if(n[t]!==e[t])return!1;return!0}function Ao(n,e){for(let t=0,i=e.length;t<i;t++)n[t]=e[t]}function UG(n,e){let t=RN[e];t===void 0&&(t=new Int32Array(e),RN[e]=t);for(let i=0;i!==e;++i)t[i]=n.allocateTextureUnit();return t}function t7(n,e){const t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function n7(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(fo(t,e))return;n.uniform2fv(this.addr,e),Ao(t,e)}}function i7(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(fo(t,e))return;n.uniform3fv(this.addr,e),Ao(t,e)}}function a7(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(fo(t,e))return;n.uniform4fv(this.addr,e),Ao(t,e)}}function o7(n,e){const t=this.cache,i=e.elements;if(i===void 0){if(fo(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),Ao(t,e)}else{if(fo(t,i))return;MN.set(i),n.uniformMatrix2fv(this.addr,!1,MN),Ao(t,i)}}function r7(n,e){const t=this.cache,i=e.elements;if(i===void 0){if(fo(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),Ao(t,e)}else{if(fo(t,i))return;xN.set(i),n.uniformMatrix3fv(this.addr,!1,xN),Ao(t,i)}}function s7(n,e){const t=this.cache,i=e.elements;if(i===void 0){if(fo(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),Ao(t,e)}else{if(fo(t,i))return;ZN.set(i),n.uniformMatrix4fv(this.addr,!1,ZN),Ao(t,i)}}function l7(n,e){const t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function c7(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(fo(t,e))return;n.uniform2iv(this.addr,e),Ao(t,e)}}function g7(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(fo(t,e))return;n.uniform3iv(this.addr,e),Ao(t,e)}}function u7(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(fo(t,e))return;n.uniform4iv(this.addr,e),Ao(t,e)}}function d7(n,e){const t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function C7(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(fo(t,e))return;n.uniform2uiv(this.addr,e),Ao(t,e)}}function I7(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(fo(t,e))return;n.uniform3uiv(this.addr,e),Ao(t,e)}}function h7(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(fo(t,e))return;n.uniform4uiv(this.addr,e),Ao(t,e)}}function f7(n,e,t){const i=this.cache,a=t.allocateTextureUnit();i[0]!==a&&(n.uniform1i(this.addr,a),i[0]=a);let o;this.type===n.SAMPLER_2D_SHADOW?(SN.compareFunction=ox,o=SN):o=MX,t.setTexture2D(e||o,a)}function A7(n,e,t){const i=this.cache,a=t.allocateTextureUnit();i[0]!==a&&(n.uniform1i(this.addr,a),i[0]=a),t.setTexture3D(e||VX,a)}function m7(n,e,t){const i=this.cache,a=t.allocateTextureUnit();i[0]!==a&&(n.uniform1i(this.addr,a),i[0]=a),t.setTextureCube(e||NX,a)}function p7(n,e,t){const i=this.cache,a=t.allocateTextureUnit();i[0]!==a&&(n.uniform1i(this.addr,a),i[0]=a),t.setTexture2DArray(e||WX,a)}function b7(n){switch(n){case 5126:return t7;case 35664:return n7;case 35665:return i7;case 35666:return a7;case 35674:return o7;case 35675:return r7;case 35676:return s7;case 5124:case 35670:return l7;case 35667:case 35671:return c7;case 35668:case 35672:return g7;case 35669:case 35673:return u7;case 5125:return d7;case 36294:return C7;case 36295:return I7;case 36296:return h7;case 35678:case 36198:case 36298:case 36306:case 35682:return f7;case 35679:case 36299:case 36307:return A7;case 35680:case 36300:case 36308:case 36293:return m7;case 36289:case 36303:case 36311:case 36292:return p7}}function v7(n,e){n.uniform1fv(this.addr,e)}function y7(n,e){const t=Pf(e,this.size,2);n.uniform2fv(this.addr,t)}function B7(n,e){const t=Pf(e,this.size,3);n.uniform3fv(this.addr,t)}function G7(n,e){const t=Pf(e,this.size,4);n.uniform4fv(this.addr,t)}function S7(n,e){const t=Pf(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function w7(n,e){const t=Pf(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function R7(n,e){const t=Pf(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function Z7(n,e){n.uniform1iv(this.addr,e)}function x7(n,e){n.uniform2iv(this.addr,e)}function M7(n,e){n.uniform3iv(this.addr,e)}function W7(n,e){n.uniform4iv(this.addr,e)}function V7(n,e){n.uniform1uiv(this.addr,e)}function N7(n,e){n.uniform2uiv(this.addr,e)}function E7(n,e){n.uniform3uiv(this.addr,e)}function H7(n,e){n.uniform4uiv(this.addr,e)}function F7(n,e,t){const i=this.cache,a=e.length,o=UG(t,a);fo(i,o)||(n.uniform1iv(this.addr,o),Ao(i,o));for(let r=0;r!==a;++r)t.setTexture2D(e[r]||MX,o[r])}function X7(n,e,t){const i=this.cache,a=e.length,o=UG(t,a);fo(i,o)||(n.uniform1iv(this.addr,o),Ao(i,o));for(let r=0;r!==a;++r)t.setTexture3D(e[r]||VX,o[r])}function T7(n,e,t){const i=this.cache,a=e.length,o=UG(t,a);fo(i,o)||(n.uniform1iv(this.addr,o),Ao(i,o));for(let r=0;r!==a;++r)t.setTextureCube(e[r]||NX,o[r])}function Y7(n,e,t){const i=this.cache,a=e.length,o=UG(t,a);fo(i,o)||(n.uniform1iv(this.addr,o),Ao(i,o));for(let r=0;r!==a;++r)t.setTexture2DArray(e[r]||WX,o[r])}function z7(n){switch(n){case 5126:return v7;case 35664:return y7;case 35665:return B7;case 35666:return G7;case 35674:return S7;case 35675:return w7;case 35676:return R7;case 5124:case 35670:return Z7;case 35667:case 35671:return x7;case 35668:case 35672:return M7;case 35669:case 35673:return W7;case 5125:return V7;case 36294:return N7;case 36295:return E7;case 36296:return H7;case 35678:case 36198:case 36298:case 36306:case 35682:return F7;case 35679:case 36299:case 36307:return X7;case 35680:case 36300:case 36308:case 36293:return T7;case 36289:case 36303:case 36311:case 36292:return Y7}}class K7{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.type=t.type,this.setValue=b7(t.type)}}class L7{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=z7(t.type)}}class _7{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,i){const a=this.seq;for(let o=0,r=a.length;o!==r;++o){const s=a[o];s.setValue(e,t[s.id],i)}}}const aw=/(\w+)(\])?(\[|\.)?/g;function WN(n,e){n.seq.push(e),n.map[e.id]=e}function D7(n,e,t){const i=n.name,a=i.length;for(aw.lastIndex=0;;){const o=aw.exec(i),r=aw.lastIndex;let s=o[1];const l=o[2]==="]",c=o[3];if(l&&(s=s|0),c===void 0||c==="["&&r+2===a){WN(t,c===void 0?new K7(s,n,e):new L7(s,n,e));break}else{let C=t.map[s];C===void 0&&(C=new _7(s),WN(t,C)),t=C}}}class Gy{constructor(e,t){this.seq=[],this.map={};const i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let a=0;a<i;++a){const o=e.getActiveUniform(t,a),r=e.getUniformLocation(t,o.name);D7(o,r,this)}}setValue(e,t,i,a){const o=this.map[t];o!==void 0&&o.setValue(e,i,a)}setOptional(e,t,i){const a=t[i];a!==void 0&&this.setValue(e,i,a)}static upload(e,t,i,a){for(let o=0,r=t.length;o!==r;++o){const s=t[o],l=i[s.id];l.needsUpdate!==!1&&s.setValue(e,l.value,a)}}static seqWithValue(e,t){const i=[];for(let a=0,o=e.length;a!==o;++a){const r=e[a];r.id in t&&i.push(r)}return i}}function VN(n,e,t){const i=n.createShader(e);return n.shaderSource(i,t),n.compileShader(i),i}const O7=37297;let U7=0;function k7(n,e){const t=n.split(`
`),i=[],a=Math.max(e-6,0),o=Math.min(e+6,t.length);for(let r=a;r<o;r++){const s=r+1;i.push(`${s===e?">":" "} ${s}: ${t[r]}`)}return i.join(`
`)}const NN=new Jn;function P7(n){vi._getMatrix(NN,vi.workingColorSpace,n);const e=`mat3( ${NN.elements.map(t=>t.toFixed(4))} )`;switch(vi.getTransfer(n)){case Sp:return[e,"LinearTransferOETF"];case Ui:return[e,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space: ",n),[e,"LinearTransferOETF"]}}function EN(n,e,t){const i=n.getShaderParameter(e,n.COMPILE_STATUS),a=n.getShaderInfoLog(e).trim();if(i&&a==="")return"";const o=/ERROR: 0:(\d+)/.exec(a);if(o){const r=parseInt(o[1]);return t.toUpperCase()+`

`+a+`

`+k7(n.getShaderSource(e),r)}else return a}function J7(n,e){const t=P7(e);return[`vec4 ${n}( vec4 value ) {`,`	return ${t[1]}( vec4( value.rgb * ${t[0]}, value.a ) );`,"}"].join(`
`)}function j7(n,e){let t;switch(e){case c9:t="Linear";break;case g9:t="Reinhard";break;case u9:t="Cineon";break;case PZ:t="ACESFilmic";break;case C9:t="AgX";break;case I9:t="Neutral";break;case d9:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}const Lv=new Be;function Q7(){vi.getLuminanceCoefficients(Lv);const n=Lv.x.toFixed(4),e=Lv.y.toFixed(4),t=Lv.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${n}, ${e}, ${t} );`,"	return dot( weights, rgb );","}"].join(`
`)}function q7(n){return[n.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",n.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(jm).join(`
`)}function $7(n){const e=[];for(const t in n){const i=n[t];i!==!1&&e.push("#define "+t+" "+i)}return e.join(`
`)}function e8(n,e){const t={},i=n.getProgramParameter(e,n.ACTIVE_ATTRIBUTES);for(let a=0;a<i;a++){const o=n.getActiveAttrib(e,a),r=o.name;let s=1;o.type===n.FLOAT_MAT2&&(s=2),o.type===n.FLOAT_MAT3&&(s=3),o.type===n.FLOAT_MAT4&&(s=4),t[r]={type:o.type,location:n.getAttribLocation(e,r),locationSize:s}}return t}function jm(n){return n!==""}function HN(n,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function FN(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const t8=/^[ \t]*#include +<([\w\d./]+)>/gm;function nR(n){return n.replace(t8,i8)}const n8=new Map;function i8(n,e){let t=ti[e];if(t===void 0){const i=n8.get(e);if(i!==void 0)t=ti[i],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,i);else throw new Error("Can not resolve #include <"+e+">")}return nR(t)}const a8=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function XN(n){return n.replace(a8,o8)}function o8(n,e,t,i){let a="";for(let o=parseInt(e);o<parseInt(t);o++)a+=i.replace(/\[\s*i\s*\]/g,"[ "+o+" ]").replace(/UNROLLED_LOOP_INDEX/g,o);return a}function TN(n){let e=`precision ${n.precision} float;
	precision ${n.precision} int;
	precision ${n.precision} sampler2D;
	precision ${n.precision} samplerCube;
	precision ${n.precision} sampler3D;
	precision ${n.precision} sampler2DArray;
	precision ${n.precision} sampler2DShadow;
	precision ${n.precision} samplerCubeShadow;
	precision ${n.precision} sampler2DArrayShadow;
	precision ${n.precision} isampler2D;
	precision ${n.precision} isampler3D;
	precision ${n.precision} isamplerCube;
	precision ${n.precision} isampler2DArray;
	precision ${n.precision} usampler2D;
	precision ${n.precision} usampler3D;
	precision ${n.precision} usamplerCube;
	precision ${n.precision} usampler2DArray;
	`;return n.precision==="highp"?e+=`
#define HIGH_PRECISION`:n.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:n.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function r8(n){let e="SHADOWMAP_TYPE_BASIC";return n.shadowMapType===uG?e="SHADOWMAP_TYPE_PCF":n.shadowMapType===np?e="SHADOWMAP_TYPE_PCF_SOFT":n.shadowMapType===oc&&(e="SHADOWMAP_TYPE_VSM"),e}function s8(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case Cg:case bd:e="ENVMAP_TYPE_CUBE";break;case Of:e="ENVMAP_TYPE_CUBE_UV";break}return e}function l8(n){let e="ENVMAP_MODE_REFLECTION";if(n.envMap)switch(n.envMapMode){case bd:e="ENVMAP_MODE_REFRACTION";break}return e}function c8(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case tb:e="ENVMAP_BLENDING_MULTIPLY";break;case s9:e="ENVMAP_BLENDING_MIX";break;case l9:e="ENVMAP_BLENDING_ADD";break}return e}function g8(n){const e=n.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),7*16)),texelHeight:i,maxMip:t}}function u8(n,e,t,i){const a=n.getContext(),o=t.defines;let r=t.vertexShader,s=t.fragmentShader;const l=r8(t),c=s8(t),u=l8(t),C=c8(t),h=g8(t),m=q7(t),p=$7(o),B=a.createProgram();let b,y,S=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(b=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p].filter(jm).join(`
`),b.length>0&&(b+=`
`),y=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p].filter(jm).join(`
`),y.length>0&&(y+=`
`)):(b=[TN(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.batchingColor?"#define USE_BATCHING_COLOR":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.instancingMorph?"#define USE_INSTANCING_MORPH":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+u:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(jm).join(`
`),y=[TN(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+c:"",t.envMap?"#define "+u:"",t.envMap?"#define "+C:"",h?"#define CUBEUV_TEXEL_WIDTH "+h.texelWidth:"",h?"#define CUBEUV_TEXEL_HEIGHT "+h.texelHeight:"",h?"#define CUBEUV_MAX_MIP "+h.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.dispersion?"#define USE_DISPERSION":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor||t.batchingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==lg?"#define TONE_MAPPING":"",t.toneMapping!==lg?ti.tonemapping_pars_fragment:"",t.toneMapping!==lg?j7("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",ti.colorspace_pars_fragment,J7("linearToOutputTexel",t.outputColorSpace),Q7(),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(jm).join(`
`)),r=nR(r),r=HN(r,t),r=FN(r,t),s=nR(s),s=HN(s,t),s=FN(s,t),r=XN(r),s=XN(s),t.isRawShaderMaterial!==!0&&(S=`#version 300 es
`,b=[m,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+b,y=["#define varying in",t.glslVersion===k1?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===k1?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+y);const R=S+b+r,Z=S+y+s,x=VN(a,a.VERTEX_SHADER,R),M=VN(a,a.FRAGMENT_SHADER,Z);a.attachShader(B,x),a.attachShader(B,M),t.index0AttributeName!==void 0?a.bindAttribLocation(B,0,t.index0AttributeName):t.morphTargets===!0&&a.bindAttribLocation(B,0,"position"),a.linkProgram(B);function E(z){if(n.debug.checkShaderErrors){const _=a.getProgramInfoLog(B).trim(),D=a.getShaderInfoLog(x).trim(),P=a.getShaderInfoLog(M).trim();let $=!0,X=!0;if(a.getProgramParameter(B,a.LINK_STATUS)===!1)if($=!1,typeof n.debug.onShaderError=="function")n.debug.onShaderError(a,B,x,M);else{const L=EN(a,x,"vertex"),U=EN(a,M,"fragment");console.error("THREE.WebGLProgram: Shader Error "+a.getError()+" - VALIDATE_STATUS "+a.getProgramParameter(B,a.VALIDATE_STATUS)+`

Material Name: `+z.name+`
Material Type: `+z.type+`

Program Info Log: `+_+`
`+L+`
`+U)}else _!==""?console.warn("THREE.WebGLProgram: Program Info Log:",_):(D===""||P==="")&&(X=!1);X&&(z.diagnostics={runnable:$,programLog:_,vertexShader:{log:D,prefix:b},fragmentShader:{log:P,prefix:y}})}a.deleteShader(x),a.deleteShader(M),F=new Gy(a,B),N=e8(a,B)}let F;this.getUniforms=function(){return F===void 0&&E(this),F};let N;this.getAttributes=function(){return N===void 0&&E(this),N};let H=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return H===!1&&(H=a.getProgramParameter(B,O7)),H},this.destroy=function(){i.releaseStatesOfProgram(this),a.deleteProgram(B),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=U7++,this.cacheKey=e,this.usedTimes=1,this.program=B,this.vertexShader=x,this.fragmentShader=M,this}let d8=0;class C8{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,i=e.fragmentShader,a=this._getShaderStage(t),o=this._getShaderStage(i),r=this._getShaderCacheForMaterial(e);return r.has(a)===!1&&(r.add(a),a.usedTimes++),r.has(o)===!1&&(r.add(o),o.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const i of t)i.usedTimes--,i.usedTimes===0&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let i=t.get(e);return i===void 0&&(i=new Set,t.set(e,i)),i}_getShaderStage(e){const t=this.shaderCache;let i=t.get(e);return i===void 0&&(i=new I8(e),t.set(e,i)),i}}class I8{constructor(e){this.id=d8++,this.code=e,this.usedTimes=0}}function h8(n,e,t,i,a,o,r){const s=new wf,l=new C8,c=new Set,u=[],C=a.logarithmicDepthBuffer,h=a.vertexTextures;let m=a.precision;const p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function B(N){return c.add(N),N===0?"uv":`uv${N}`}function b(N,H,z,_,D){const P=_.fog,$=D.geometry,X=N.isMeshStandardMaterial?_.environment:null,L=(N.isMeshStandardMaterial?t:e).get(N.envMap||X),U=L&&L.mapping===Of?L.image.height:null,q=p[N.type];N.precision!==null&&(m=a.getMaxPrecision(N.precision),m!==N.precision&&console.warn("THREE.WebGLProgram.getParameters:",N.precision,"not supported, using",m,"instead."));const K=$.morphAttributes.position||$.morphAttributes.normal||$.morphAttributes.color,O=K!==void 0?K.length:0;let j=0;$.morphAttributes.position!==void 0&&(j=1),$.morphAttributes.normal!==void 0&&(j=2),$.morphAttributes.color!==void 0&&(j=3);let ne,k,ie,re;if(q){const yt=lc[q];ne=yt.vertexShader,k=yt.fragmentShader}else ne=N.vertexShader,k=N.fragmentShader,l.update(N),ie=l.getVertexShaderID(N),re=l.getFragmentShaderID(N);const ge=n.getRenderTarget(),de=n.state.buffers.depth.getReversed(),xe=D.isInstancedMesh===!0,Ne=D.isBatchedMesh===!0,ye=!!N.map,pe=!!N.matcap,Te=!!L,le=!!N.aoMap,Ye=!!N.lightMap,he=!!N.bumpMap,Ge=!!N.normalMap,be=!!N.displacementMap,Ee=!!N.emissiveMap,Se=!!N.metalnessMap,ee=!!N.roughnessMap,Q=N.anisotropy>0,ce=N.clearcoat>0,me=N.dispersion>0,Ze=N.iridescence>0,Xe=N.sheen>0,De=N.transmission>0,Oe=Q&&!!N.anisotropyMap,Je=ce&&!!N.clearcoatMap,At=ce&&!!N.clearcoatNormalMap,qe=ce&&!!N.clearcoatRoughnessMap,lt=Ze&&!!N.iridescenceMap,$e=Ze&&!!N.iridescenceThicknessMap,je=Xe&&!!N.sheenColorMap,ke=Xe&&!!N.sheenRoughnessMap,Ce=!!N.specularMap,He=!!N.specularColorMap,ht=!!N.specularIntensityMap,we=De&&!!N.transmissionMap,ze=De&&!!N.thicknessMap,Qe=!!N.gradientMap,ut=!!N.alphaMap,Rt=N.alphaTest>0,mt=!!N.alphaHash,_t=!!N.extensions;let Lt=lg;N.toneMapped&&(ge===null||ge.isXRRenderTarget===!0)&&(Lt=n.toneMapping);const Zt={shaderID:q,shaderType:N.type,shaderName:N.name,vertexShader:ne,fragmentShader:k,defines:N.defines,customVertexShaderID:ie,customFragmentShaderID:re,isRawShaderMaterial:N.isRawShaderMaterial===!0,glslVersion:N.glslVersion,precision:m,batching:Ne,batchingColor:Ne&&D._colorsTexture!==null,instancing:xe,instancingColor:xe&&D.instanceColor!==null,instancingMorph:xe&&D.morphTexture!==null,supportsVertexTextures:h,outputColorSpace:ge===null?n.outputColorSpace:ge.isXRRenderTarget===!0?ge.texture.colorSpace:Cc,alphaToCoverage:!!N.alphaToCoverage,map:ye,matcap:pe,envMap:Te,envMapMode:Te&&L.mapping,envMapCubeUVHeight:U,aoMap:le,lightMap:Ye,bumpMap:he,normalMap:Ge,displacementMap:h&&be,emissiveMap:Ee,normalMapObjectSpace:Ge&&N.normalMapType===v9,normalMapTangentSpace:Ge&&N.normalMapType===Sd,metalnessMap:Se,roughnessMap:ee,anisotropy:Q,anisotropyMap:Oe,clearcoat:ce,clearcoatMap:Je,clearcoatNormalMap:At,clearcoatRoughnessMap:qe,dispersion:me,iridescence:Ze,iridescenceMap:lt,iridescenceThicknessMap:$e,sheen:Xe,sheenColorMap:je,sheenRoughnessMap:ke,specularMap:Ce,specularColorMap:He,specularIntensityMap:ht,transmission:De,transmissionMap:we,thicknessMap:ze,gradientMap:Qe,opaque:N.transparent===!1&&N.blending===eI&&N.alphaToCoverage===!1,alphaMap:ut,alphaTest:Rt,alphaHash:mt,combine:N.combine,mapUv:ye&&B(N.map.channel),aoMapUv:le&&B(N.aoMap.channel),lightMapUv:Ye&&B(N.lightMap.channel),bumpMapUv:he&&B(N.bumpMap.channel),normalMapUv:Ge&&B(N.normalMap.channel),displacementMapUv:be&&B(N.displacementMap.channel),emissiveMapUv:Ee&&B(N.emissiveMap.channel),metalnessMapUv:Se&&B(N.metalnessMap.channel),roughnessMapUv:ee&&B(N.roughnessMap.channel),anisotropyMapUv:Oe&&B(N.anisotropyMap.channel),clearcoatMapUv:Je&&B(N.clearcoatMap.channel),clearcoatNormalMapUv:At&&B(N.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:qe&&B(N.clearcoatRoughnessMap.channel),iridescenceMapUv:lt&&B(N.iridescenceMap.channel),iridescenceThicknessMapUv:$e&&B(N.iridescenceThicknessMap.channel),sheenColorMapUv:je&&B(N.sheenColorMap.channel),sheenRoughnessMapUv:ke&&B(N.sheenRoughnessMap.channel),specularMapUv:Ce&&B(N.specularMap.channel),specularColorMapUv:He&&B(N.specularColorMap.channel),specularIntensityMapUv:ht&&B(N.specularIntensityMap.channel),transmissionMapUv:we&&B(N.transmissionMap.channel),thicknessMapUv:ze&&B(N.thicknessMap.channel),alphaMapUv:ut&&B(N.alphaMap.channel),vertexTangents:!!$.attributes.tangent&&(Ge||Q),vertexColors:N.vertexColors,vertexAlphas:N.vertexColors===!0&&!!$.attributes.color&&$.attributes.color.itemSize===4,pointsUvs:D.isPoints===!0&&!!$.attributes.uv&&(ye||ut),fog:!!P,useFog:N.fog===!0,fogExp2:!!P&&P.isFogExp2,flatShading:N.flatShading===!0,sizeAttenuation:N.sizeAttenuation===!0,logarithmicDepthBuffer:C,reverseDepthBuffer:de,skinning:D.isSkinnedMesh===!0,morphTargets:$.morphAttributes.position!==void 0,morphNormals:$.morphAttributes.normal!==void 0,morphColors:$.morphAttributes.color!==void 0,morphTargetsCount:O,morphTextureStride:j,numDirLights:H.directional.length,numPointLights:H.point.length,numSpotLights:H.spot.length,numSpotLightMaps:H.spotLightMap.length,numRectAreaLights:H.rectArea.length,numHemiLights:H.hemi.length,numDirLightShadows:H.directionalShadowMap.length,numPointLightShadows:H.pointShadowMap.length,numSpotLightShadows:H.spotShadowMap.length,numSpotLightShadowsWithMaps:H.numSpotLightShadowsWithMaps,numLightProbes:H.numLightProbes,numClippingPlanes:r.numPlanes,numClipIntersection:r.numIntersection,dithering:N.dithering,shadowMapEnabled:n.shadowMap.enabled&&z.length>0,shadowMapType:n.shadowMap.type,toneMapping:Lt,decodeVideoTexture:ye&&N.map.isVideoTexture===!0&&vi.getTransfer(N.map.colorSpace)===Ui,decodeVideoTextureEmissive:Ee&&N.emissiveMap.isVideoTexture===!0&&vi.getTransfer(N.emissiveMap.colorSpace)===Ui,premultipliedAlpha:N.premultipliedAlpha,doubleSided:N.side===ms,flipSided:N.side===fr,useDepthPacking:N.depthPacking>=0,depthPacking:N.depthPacking||0,index0AttributeName:N.index0AttributeName,extensionClipCullDistance:_t&&N.extensions.clipCullDistance===!0&&i.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(_t&&N.extensions.multiDraw===!0||Ne)&&i.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:i.has("KHR_parallel_shader_compile"),customProgramCacheKey:N.customProgramCacheKey()};return Zt.vertexUv1s=c.has(1),Zt.vertexUv2s=c.has(2),Zt.vertexUv3s=c.has(3),c.clear(),Zt}function y(N){const H=[];if(N.shaderID?H.push(N.shaderID):(H.push(N.customVertexShaderID),H.push(N.customFragmentShaderID)),N.defines!==void 0)for(const z in N.defines)H.push(z),H.push(N.defines[z]);return N.isRawShaderMaterial===!1&&(S(H,N),R(H,N),H.push(n.outputColorSpace)),H.push(N.customProgramCacheKey),H.join()}function S(N,H){N.push(H.precision),N.push(H.outputColorSpace),N.push(H.envMapMode),N.push(H.envMapCubeUVHeight),N.push(H.mapUv),N.push(H.alphaMapUv),N.push(H.lightMapUv),N.push(H.aoMapUv),N.push(H.bumpMapUv),N.push(H.normalMapUv),N.push(H.displacementMapUv),N.push(H.emissiveMapUv),N.push(H.metalnessMapUv),N.push(H.roughnessMapUv),N.push(H.anisotropyMapUv),N.push(H.clearcoatMapUv),N.push(H.clearcoatNormalMapUv),N.push(H.clearcoatRoughnessMapUv),N.push(H.iridescenceMapUv),N.push(H.iridescenceThicknessMapUv),N.push(H.sheenColorMapUv),N.push(H.sheenRoughnessMapUv),N.push(H.specularMapUv),N.push(H.specularColorMapUv),N.push(H.specularIntensityMapUv),N.push(H.transmissionMapUv),N.push(H.thicknessMapUv),N.push(H.combine),N.push(H.fogExp2),N.push(H.sizeAttenuation),N.push(H.morphTargetsCount),N.push(H.morphAttributeCount),N.push(H.numDirLights),N.push(H.numPointLights),N.push(H.numSpotLights),N.push(H.numSpotLightMaps),N.push(H.numHemiLights),N.push(H.numRectAreaLights),N.push(H.numDirLightShadows),N.push(H.numPointLightShadows),N.push(H.numSpotLightShadows),N.push(H.numSpotLightShadowsWithMaps),N.push(H.numLightProbes),N.push(H.shadowMapType),N.push(H.toneMapping),N.push(H.numClippingPlanes),N.push(H.numClipIntersection),N.push(H.depthPacking)}function R(N,H){s.disableAll(),H.supportsVertexTextures&&s.enable(0),H.instancing&&s.enable(1),H.instancingColor&&s.enable(2),H.instancingMorph&&s.enable(3),H.matcap&&s.enable(4),H.envMap&&s.enable(5),H.normalMapObjectSpace&&s.enable(6),H.normalMapTangentSpace&&s.enable(7),H.clearcoat&&s.enable(8),H.iridescence&&s.enable(9),H.alphaTest&&s.enable(10),H.vertexColors&&s.enable(11),H.vertexAlphas&&s.enable(12),H.vertexUv1s&&s.enable(13),H.vertexUv2s&&s.enable(14),H.vertexUv3s&&s.enable(15),H.vertexTangents&&s.enable(16),H.anisotropy&&s.enable(17),H.alphaHash&&s.enable(18),H.batching&&s.enable(19),H.dispersion&&s.enable(20),H.batchingColor&&s.enable(21),N.push(s.mask),s.disableAll(),H.fog&&s.enable(0),H.useFog&&s.enable(1),H.flatShading&&s.enable(2),H.logarithmicDepthBuffer&&s.enable(3),H.reverseDepthBuffer&&s.enable(4),H.skinning&&s.enable(5),H.morphTargets&&s.enable(6),H.morphNormals&&s.enable(7),H.morphColors&&s.enable(8),H.premultipliedAlpha&&s.enable(9),H.shadowMapEnabled&&s.enable(10),H.doubleSided&&s.enable(11),H.flipSided&&s.enable(12),H.useDepthPacking&&s.enable(13),H.dithering&&s.enable(14),H.transmission&&s.enable(15),H.sheen&&s.enable(16),H.opaque&&s.enable(17),H.pointsUvs&&s.enable(18),H.decodeVideoTexture&&s.enable(19),H.decodeVideoTextureEmissive&&s.enable(20),H.alphaToCoverage&&s.enable(21),N.push(s.mask)}function Z(N){const H=p[N.type];let z;if(H){const _=lc[H];z=yG.clone(_.uniforms)}else z=N.uniforms;return z}function x(N,H){let z;for(let _=0,D=u.length;_<D;_++){const P=u[_];if(P.cacheKey===H){z=P,++z.usedTimes;break}}return z===void 0&&(z=new u8(n,H,N,o),u.push(z)),z}function M(N){if(--N.usedTimes===0){const H=u.indexOf(N);u[H]=u[u.length-1],u.pop(),N.destroy()}}function E(N){l.remove(N)}function F(){l.dispose()}return{getParameters:b,getProgramCacheKey:y,getUniforms:Z,acquireProgram:x,releaseProgram:M,releaseShaderCache:E,programs:u,dispose:F}}function f8(){let n=new WeakMap;function e(r){return n.has(r)}function t(r){let s=n.get(r);return s===void 0&&(s={},n.set(r,s)),s}function i(r){n.delete(r)}function a(r,s,l){n.get(r)[s]=l}function o(){n=new WeakMap}return{has:e,get:t,remove:i,update:a,dispose:o}}function A8(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function YN(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function zN(){const n=[];let e=0;const t=[],i=[],a=[];function o(){e=0,t.length=0,i.length=0,a.length=0}function r(C,h,m,p,B,b){let y=n[e];return y===void 0?(y={id:C.id,object:C,geometry:h,material:m,groupOrder:p,renderOrder:C.renderOrder,z:B,group:b},n[e]=y):(y.id=C.id,y.object=C,y.geometry=h,y.material=m,y.groupOrder=p,y.renderOrder=C.renderOrder,y.z=B,y.group=b),e++,y}function s(C,h,m,p,B,b){const y=r(C,h,m,p,B,b);m.transmission>0?i.push(y):m.transparent===!0?a.push(y):t.push(y)}function l(C,h,m,p,B,b){const y=r(C,h,m,p,B,b);m.transmission>0?i.unshift(y):m.transparent===!0?a.unshift(y):t.unshift(y)}function c(C,h){t.length>1&&t.sort(C||A8),i.length>1&&i.sort(h||YN),a.length>1&&a.sort(h||YN)}function u(){for(let C=e,h=n.length;C<h;C++){const m=n[C];if(m.id===null)break;m.id=null,m.object=null,m.geometry=null,m.material=null,m.group=null}}return{opaque:t,transmissive:i,transparent:a,init:o,push:s,unshift:l,finish:u,sort:c}}function m8(){let n=new WeakMap;function e(i,a){const o=n.get(i);let r;return o===void 0?(r=new zN,n.set(i,[r])):a>=o.length?(r=new zN,o.push(r)):r=o[a],r}function t(){n=new WeakMap}return{get:e,dispose:t}}function p8(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new Be,color:new dn};break;case"SpotLight":t={position:new Be,direction:new Be,color:new dn,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new Be,color:new dn,distance:0,decay:0};break;case"HemisphereLight":t={direction:new Be,skyColor:new dn,groundColor:new dn};break;case"RectAreaLight":t={color:new dn,position:new Be,halfWidth:new Be,halfHeight:new Be};break}return n[e.id]=t,t}}}function b8(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Xt};break;case"SpotLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Xt};break;case"PointLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Xt,shadowCameraNear:1,shadowCameraFar:1e3};break}return n[e.id]=t,t}}}let v8=0;function y8(n,e){return(e.castShadow?2:0)-(n.castShadow?2:0)+(e.map?1:0)-(n.map?1:0)}function B8(n){const e=new p8,t=b8(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let c=0;c<9;c++)i.probe.push(new Be);const a=new Be,o=new Vn,r=new Vn;function s(c){let u=0,C=0,h=0;for(let N=0;N<9;N++)i.probe[N].set(0,0,0);let m=0,p=0,B=0,b=0,y=0,S=0,R=0,Z=0,x=0,M=0,E=0;c.sort(y8);for(let N=0,H=c.length;N<H;N++){const z=c[N],_=z.color,D=z.intensity,P=z.distance,$=z.shadow&&z.shadow.map?z.shadow.map.texture:null;if(z.isAmbientLight)u+=_.r*D,C+=_.g*D,h+=_.b*D;else if(z.isLightProbe){for(let X=0;X<9;X++)i.probe[X].addScaledVector(z.sh.coefficients[X],D);E++}else if(z.isDirectionalLight){const X=e.get(z);if(X.color.copy(z.color).multiplyScalar(z.intensity),z.castShadow){const L=z.shadow,U=t.get(z);U.shadowIntensity=L.intensity,U.shadowBias=L.bias,U.shadowNormalBias=L.normalBias,U.shadowRadius=L.radius,U.shadowMapSize=L.mapSize,i.directionalShadow[m]=U,i.directionalShadowMap[m]=$,i.directionalShadowMatrix[m]=z.shadow.matrix,S++}i.directional[m]=X,m++}else if(z.isSpotLight){const X=e.get(z);X.position.setFromMatrixPosition(z.matrixWorld),X.color.copy(_).multiplyScalar(D),X.distance=P,X.coneCos=Math.cos(z.angle),X.penumbraCos=Math.cos(z.angle*(1-z.penumbra)),X.decay=z.decay,i.spot[B]=X;const L=z.shadow;if(z.map&&(i.spotLightMap[x]=z.map,x++,L.updateMatrices(z),z.castShadow&&M++),i.spotLightMatrix[B]=L.matrix,z.castShadow){const U=t.get(z);U.shadowIntensity=L.intensity,U.shadowBias=L.bias,U.shadowNormalBias=L.normalBias,U.shadowRadius=L.radius,U.shadowMapSize=L.mapSize,i.spotShadow[B]=U,i.spotShadowMap[B]=$,Z++}B++}else if(z.isRectAreaLight){const X=e.get(z);X.color.copy(_).multiplyScalar(D),X.halfWidth.set(z.width*.5,0,0),X.halfHeight.set(0,z.height*.5,0),i.rectArea[b]=X,b++}else if(z.isPointLight){const X=e.get(z);if(X.color.copy(z.color).multiplyScalar(z.intensity),X.distance=z.distance,X.decay=z.decay,z.castShadow){const L=z.shadow,U=t.get(z);U.shadowIntensity=L.intensity,U.shadowBias=L.bias,U.shadowNormalBias=L.normalBias,U.shadowRadius=L.radius,U.shadowMapSize=L.mapSize,U.shadowCameraNear=L.camera.near,U.shadowCameraFar=L.camera.far,i.pointShadow[p]=U,i.pointShadowMap[p]=$,i.pointShadowMatrix[p]=z.shadow.matrix,R++}i.point[p]=X,p++}else if(z.isHemisphereLight){const X=e.get(z);X.skyColor.copy(z.color).multiplyScalar(D),X.groundColor.copy(z.groundColor).multiplyScalar(D),i.hemi[y]=X,y++}}b>0&&(n.has("OES_texture_float_linear")===!0?(i.rectAreaLTC1=hn.LTC_FLOAT_1,i.rectAreaLTC2=hn.LTC_FLOAT_2):(i.rectAreaLTC1=hn.LTC_HALF_1,i.rectAreaLTC2=hn.LTC_HALF_2)),i.ambient[0]=u,i.ambient[1]=C,i.ambient[2]=h;const F=i.hash;(F.directionalLength!==m||F.pointLength!==p||F.spotLength!==B||F.rectAreaLength!==b||F.hemiLength!==y||F.numDirectionalShadows!==S||F.numPointShadows!==R||F.numSpotShadows!==Z||F.numSpotMaps!==x||F.numLightProbes!==E)&&(i.directional.length=m,i.spot.length=B,i.rectArea.length=b,i.point.length=p,i.hemi.length=y,i.directionalShadow.length=S,i.directionalShadowMap.length=S,i.pointShadow.length=R,i.pointShadowMap.length=R,i.spotShadow.length=Z,i.spotShadowMap.length=Z,i.directionalShadowMatrix.length=S,i.pointShadowMatrix.length=R,i.spotLightMatrix.length=Z+x-M,i.spotLightMap.length=x,i.numSpotLightShadowsWithMaps=M,i.numLightProbes=E,F.directionalLength=m,F.pointLength=p,F.spotLength=B,F.rectAreaLength=b,F.hemiLength=y,F.numDirectionalShadows=S,F.numPointShadows=R,F.numSpotShadows=Z,F.numSpotMaps=x,F.numLightProbes=E,i.version=v8++)}function l(c,u){let C=0,h=0,m=0,p=0,B=0;const b=u.matrixWorldInverse;for(let y=0,S=c.length;y<S;y++){const R=c[y];if(R.isDirectionalLight){const Z=i.directional[C];Z.direction.setFromMatrixPosition(R.matrixWorld),a.setFromMatrixPosition(R.target.matrixWorld),Z.direction.sub(a),Z.direction.transformDirection(b),C++}else if(R.isSpotLight){const Z=i.spot[m];Z.position.setFromMatrixPosition(R.matrixWorld),Z.position.applyMatrix4(b),Z.direction.setFromMatrixPosition(R.matrixWorld),a.setFromMatrixPosition(R.target.matrixWorld),Z.direction.sub(a),Z.direction.transformDirection(b),m++}else if(R.isRectAreaLight){const Z=i.rectArea[p];Z.position.setFromMatrixPosition(R.matrixWorld),Z.position.applyMatrix4(b),r.identity(),o.copy(R.matrixWorld),o.premultiply(b),r.extractRotation(o),Z.halfWidth.set(R.width*.5,0,0),Z.halfHeight.set(0,R.height*.5,0),Z.halfWidth.applyMatrix4(r),Z.halfHeight.applyMatrix4(r),p++}else if(R.isPointLight){const Z=i.point[h];Z.position.setFromMatrixPosition(R.matrixWorld),Z.position.applyMatrix4(b),h++}else if(R.isHemisphereLight){const Z=i.hemi[B];Z.direction.setFromMatrixPosition(R.matrixWorld),Z.direction.transformDirection(b),B++}}}return{setup:s,setupView:l,state:i}}function KN(n){const e=new B8(n),t=[],i=[];function a(u){c.camera=u,t.length=0,i.length=0}function o(u){t.push(u)}function r(u){i.push(u)}function s(){e.setup(t)}function l(u){e.setupView(t,u)}const c={lightsArray:t,shadowsArray:i,camera:null,lights:e,transmissionRenderTarget:{}};return{init:a,state:c,setupLights:s,setupLightsView:l,pushLight:o,pushShadow:r}}function G8(n){let e=new WeakMap;function t(a,o=0){const r=e.get(a);let s;return r===void 0?(s=new KN(n),e.set(a,[s])):o>=r.length?(s=new KN(n),r.push(s)):s=r[o],s}function i(){e=new WeakMap}return{get:t,dispose:i}}const S8=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,w8=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function R8(n,e,t){let i=new cb;const a=new Xt,o=new Xt,r=new yi,s=new LG({depthPacking:ax}),l=new _G,c={},u=t.maxTextureSize,C={[dg]:fr,[fr]:dg,[ms]:ms},h=new Ur({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Xt},radius:{value:4}},vertexShader:S8,fragmentShader:w8}),m=h.clone();m.defines.HORIZONTAL_PASS=1;const p=new $n;p.setAttribute("position",new Mi(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const B=new $i(p,h),b=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=uG;let y=this.type;this.render=function(M,E,F){if(b.enabled===!1||b.autoUpdate===!1&&b.needsUpdate===!1||M.length===0)return;const N=n.getRenderTarget(),H=n.getActiveCubeFace(),z=n.getActiveMipmapLevel(),_=n.state;_.setBlending(sg),_.buffers.color.setClear(1,1,1,1),_.buffers.depth.setTest(!0),_.setScissorTest(!1);const D=y!==oc&&this.type===oc,P=y===oc&&this.type!==oc;for(let $=0,X=M.length;$<X;$++){const L=M[$],U=L.shadow;if(U===void 0){console.warn("THREE.WebGLShadowMap:",L,"has no shadow.");continue}if(U.autoUpdate===!1&&U.needsUpdate===!1)continue;a.copy(U.mapSize);const q=U.getFrameExtents();if(a.multiply(q),o.copy(U.mapSize),(a.x>u||a.y>u)&&(a.x>u&&(o.x=Math.floor(u/q.x),a.x=o.x*q.x,U.mapSize.x=o.x),a.y>u&&(o.y=Math.floor(u/q.y),a.y=o.y*q.y,U.mapSize.y=o.y)),U.map===null||D===!0||P===!0){const O=this.type!==oc?{minFilter:Mo,magFilter:Mo}:{};U.map!==null&&U.map.dispose(),U.map=new Us(a.x,a.y,O),U.map.texture.name=L.name+".shadowMap",U.camera.updateProjectionMatrix()}n.setRenderTarget(U.map),n.clear();const K=U.getViewportCount();for(let O=0;O<K;O++){const j=U.getViewport(O);r.set(o.x*j.x,o.y*j.y,o.x*j.z,o.y*j.w),_.viewport(r),U.updateMatrices(L,O),i=U.getFrustum(),Z(E,F,U.camera,L,this.type)}U.isPointLightShadow!==!0&&this.type===oc&&S(U,F),U.needsUpdate=!1}y=this.type,b.needsUpdate=!1,n.setRenderTarget(N,H,z)};function S(M,E){const F=e.update(B);h.defines.VSM_SAMPLES!==M.blurSamples&&(h.defines.VSM_SAMPLES=M.blurSamples,m.defines.VSM_SAMPLES=M.blurSamples,h.needsUpdate=!0,m.needsUpdate=!0),M.mapPass===null&&(M.mapPass=new Us(a.x,a.y)),h.uniforms.shadow_pass.value=M.map.texture,h.uniforms.resolution.value=M.mapSize,h.uniforms.radius.value=M.radius,n.setRenderTarget(M.mapPass),n.clear(),n.renderBufferDirect(E,null,F,h,B,null),m.uniforms.shadow_pass.value=M.mapPass.texture,m.uniforms.resolution.value=M.mapSize,m.uniforms.radius.value=M.radius,n.setRenderTarget(M.map),n.clear(),n.renderBufferDirect(E,null,F,m,B,null)}function R(M,E,F,N){let H=null;const z=F.isPointLight===!0?M.customDistanceMaterial:M.customDepthMaterial;if(z!==void 0)H=z;else if(H=F.isPointLight===!0?l:s,n.localClippingEnabled&&E.clipShadows===!0&&Array.isArray(E.clippingPlanes)&&E.clippingPlanes.length!==0||E.displacementMap&&E.displacementScale!==0||E.alphaMap&&E.alphaTest>0||E.map&&E.alphaTest>0){const _=H.uuid,D=E.uuid;let P=c[_];P===void 0&&(P={},c[_]=P);let $=P[D];$===void 0&&($=H.clone(),P[D]=$,E.addEventListener("dispose",x)),H=$}if(H.visible=E.visible,H.wireframe=E.wireframe,N===oc?H.side=E.shadowSide!==null?E.shadowSide:E.side:H.side=E.shadowSide!==null?E.shadowSide:C[E.side],H.alphaMap=E.alphaMap,H.alphaTest=E.alphaTest,H.map=E.map,H.clipShadows=E.clipShadows,H.clippingPlanes=E.clippingPlanes,H.clipIntersection=E.clipIntersection,H.displacementMap=E.displacementMap,H.displacementScale=E.displacementScale,H.displacementBias=E.displacementBias,H.wireframeLinewidth=E.wireframeLinewidth,H.linewidth=E.linewidth,F.isPointLight===!0&&H.isMeshDistanceMaterial===!0){const _=n.properties.get(H);_.light=F}return H}function Z(M,E,F,N,H){if(M.visible===!1)return;if(M.layers.test(E.layers)&&(M.isMesh||M.isLine||M.isPoints)&&(M.castShadow||M.receiveShadow&&H===oc)&&(!M.frustumCulled||i.intersectsObject(M))){M.modelViewMatrix.multiplyMatrices(F.matrixWorldInverse,M.matrixWorld);const D=e.update(M),P=M.material;if(Array.isArray(P)){const $=D.groups;for(let X=0,L=$.length;X<L;X++){const U=$[X],q=P[U.materialIndex];if(q&&q.visible){const K=R(M,q,N,H);M.onBeforeShadow(n,M,E,F,D,K,U),n.renderBufferDirect(F,null,D,K,M,U),M.onAfterShadow(n,M,E,F,D,K,U)}}}else if(P.visible){const $=R(M,P,N,H);M.onBeforeShadow(n,M,E,F,D,$,null),n.renderBufferDirect(F,null,D,$,M,null),M.onAfterShadow(n,M,E,F,D,$,null)}}const _=M.children;for(let D=0,P=_.length;D<P;D++)Z(_[D],E,F,N,H)}function x(M){M.target.removeEventListener("dispose",x);for(const F in c){const N=c[F],H=M.target.uuid;H in N&&(N[H].dispose(),delete N[H])}}}const Z8={[jy]:Qy,[qy]:tB,[$y]:nB,[sI]:eB,[Qy]:jy,[tB]:qy,[nB]:$y,[eB]:sI};function x8(n,e){function t(){let we=!1;const ze=new yi;let Qe=null;const ut=new yi(0,0,0,0);return{setMask:function(Rt){Qe!==Rt&&!we&&(n.colorMask(Rt,Rt,Rt,Rt),Qe=Rt)},setLocked:function(Rt){we=Rt},setClear:function(Rt,mt,_t,Lt,Zt){Zt===!0&&(Rt*=Lt,mt*=Lt,_t*=Lt),ze.set(Rt,mt,_t,Lt),ut.equals(ze)===!1&&(n.clearColor(Rt,mt,_t,Lt),ut.copy(ze))},reset:function(){we=!1,Qe=null,ut.set(-1,0,0,0)}}}function i(){let we=!1,ze=!1,Qe=null,ut=null,Rt=null;return{setReversed:function(mt){if(ze!==mt){const _t=e.get("EXT_clip_control");mt?_t.clipControlEXT(_t.LOWER_LEFT_EXT,_t.ZERO_TO_ONE_EXT):_t.clipControlEXT(_t.LOWER_LEFT_EXT,_t.NEGATIVE_ONE_TO_ONE_EXT),ze=mt;const Lt=Rt;Rt=null,this.setClear(Lt)}},getReversed:function(){return ze},setTest:function(mt){mt?ge(n.DEPTH_TEST):de(n.DEPTH_TEST)},setMask:function(mt){Qe!==mt&&!we&&(n.depthMask(mt),Qe=mt)},setFunc:function(mt){if(ze&&(mt=Z8[mt]),ut!==mt){switch(mt){case jy:n.depthFunc(n.NEVER);break;case Qy:n.depthFunc(n.ALWAYS);break;case qy:n.depthFunc(n.LESS);break;case sI:n.depthFunc(n.LEQUAL);break;case $y:n.depthFunc(n.EQUAL);break;case eB:n.depthFunc(n.GEQUAL);break;case tB:n.depthFunc(n.GREATER);break;case nB:n.depthFunc(n.NOTEQUAL);break;default:n.depthFunc(n.LEQUAL)}ut=mt}},setLocked:function(mt){we=mt},setClear:function(mt){Rt!==mt&&(ze&&(mt=1-mt),n.clearDepth(mt),Rt=mt)},reset:function(){we=!1,Qe=null,ut=null,Rt=null,ze=!1}}}function a(){let we=!1,ze=null,Qe=null,ut=null,Rt=null,mt=null,_t=null,Lt=null,Zt=null;return{setTest:function(yt){we||(yt?ge(n.STENCIL_TEST):de(n.STENCIL_TEST))},setMask:function(yt){ze!==yt&&!we&&(n.stencilMask(yt),ze=yt)},setFunc:function(yt,Ht,jt){(Qe!==yt||ut!==Ht||Rt!==jt)&&(n.stencilFunc(yt,Ht,jt),Qe=yt,ut=Ht,Rt=jt)},setOp:function(yt,Ht,jt){(mt!==yt||_t!==Ht||Lt!==jt)&&(n.stencilOp(yt,Ht,jt),mt=yt,_t=Ht,Lt=jt)},setLocked:function(yt){we=yt},setClear:function(yt){Zt!==yt&&(n.clearStencil(yt),Zt=yt)},reset:function(){we=!1,ze=null,Qe=null,ut=null,Rt=null,mt=null,_t=null,Lt=null,Zt=null}}}const o=new t,r=new i,s=new a,l=new WeakMap,c=new WeakMap;let u={},C={},h=new WeakMap,m=[],p=null,B=!1,b=null,y=null,S=null,R=null,Z=null,x=null,M=null,E=new dn(0,0,0),F=0,N=!1,H=null,z=null,_=null,D=null,P=null;const $=n.getParameter(n.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let X=!1,L=0;const U=n.getParameter(n.VERSION);U.indexOf("WebGL")!==-1?(L=parseFloat(/^WebGL (\d)/.exec(U)[1]),X=L>=1):U.indexOf("OpenGL ES")!==-1&&(L=parseFloat(/^OpenGL ES (\d)/.exec(U)[1]),X=L>=2);let q=null,K={};const O=n.getParameter(n.SCISSOR_BOX),j=n.getParameter(n.VIEWPORT),ne=new yi().fromArray(O),k=new yi().fromArray(j);function ie(we,ze,Qe,ut){const Rt=new Uint8Array(4),mt=n.createTexture();n.bindTexture(we,mt),n.texParameteri(we,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(we,n.TEXTURE_MAG_FILTER,n.NEAREST);for(let _t=0;_t<Qe;_t++)we===n.TEXTURE_3D||we===n.TEXTURE_2D_ARRAY?n.texImage3D(ze,0,n.RGBA,1,1,ut,0,n.RGBA,n.UNSIGNED_BYTE,Rt):n.texImage2D(ze+_t,0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,Rt);return mt}const re={};re[n.TEXTURE_2D]=ie(n.TEXTURE_2D,n.TEXTURE_2D,1),re[n.TEXTURE_CUBE_MAP]=ie(n.TEXTURE_CUBE_MAP,n.TEXTURE_CUBE_MAP_POSITIVE_X,6),re[n.TEXTURE_2D_ARRAY]=ie(n.TEXTURE_2D_ARRAY,n.TEXTURE_2D_ARRAY,1,1),re[n.TEXTURE_3D]=ie(n.TEXTURE_3D,n.TEXTURE_3D,1,1),o.setClear(0,0,0,1),r.setClear(1),s.setClear(0),ge(n.DEPTH_TEST),r.setFunc(sI),he(!1),Ge(z1),ge(n.CULL_FACE),le(sg);function ge(we){u[we]!==!0&&(n.enable(we),u[we]=!0)}function de(we){u[we]!==!1&&(n.disable(we),u[we]=!1)}function xe(we,ze){return C[we]!==ze?(n.bindFramebuffer(we,ze),C[we]=ze,we===n.DRAW_FRAMEBUFFER&&(C[n.FRAMEBUFFER]=ze),we===n.FRAMEBUFFER&&(C[n.DRAW_FRAMEBUFFER]=ze),!0):!1}function Ne(we,ze){let Qe=m,ut=!1;if(we){Qe=h.get(ze),Qe===void 0&&(Qe=[],h.set(ze,Qe));const Rt=we.textures;if(Qe.length!==Rt.length||Qe[0]!==n.COLOR_ATTACHMENT0){for(let mt=0,_t=Rt.length;mt<_t;mt++)Qe[mt]=n.COLOR_ATTACHMENT0+mt;Qe.length=Rt.length,ut=!0}}else Qe[0]!==n.BACK&&(Qe[0]=n.BACK,ut=!0);ut&&n.drawBuffers(Qe)}function ye(we){return p!==we?(n.useProgram(we),p=we,!0):!1}const pe={[ud]:n.FUNC_ADD,[D5]:n.FUNC_SUBTRACT,[O5]:n.FUNC_REVERSE_SUBTRACT};pe[U5]=n.MIN,pe[k5]=n.MAX;const Te={[P5]:n.ZERO,[J5]:n.ONE,[j5]:n.SRC_COLOR,[Py]:n.SRC_ALPHA,[n9]:n.SRC_ALPHA_SATURATE,[e9]:n.DST_COLOR,[q5]:n.DST_ALPHA,[Q5]:n.ONE_MINUS_SRC_COLOR,[Jy]:n.ONE_MINUS_SRC_ALPHA,[t9]:n.ONE_MINUS_DST_COLOR,[$5]:n.ONE_MINUS_DST_ALPHA,[i9]:n.CONSTANT_COLOR,[a9]:n.ONE_MINUS_CONSTANT_COLOR,[o9]:n.CONSTANT_ALPHA,[r9]:n.ONE_MINUS_CONSTANT_ALPHA};function le(we,ze,Qe,ut,Rt,mt,_t,Lt,Zt,yt){if(we===sg){B===!0&&(de(n.BLEND),B=!1);return}if(B===!1&&(ge(n.BLEND),B=!0),we!==_5){if(we!==b||yt!==N){if((y!==ud||Z!==ud)&&(n.blendEquation(n.FUNC_ADD),y=ud,Z=ud),yt)switch(we){case eI:n.blendFuncSeparate(n.ONE,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case K1:n.blendFunc(n.ONE,n.ONE);break;case L1:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case _1:n.blendFuncSeparate(n.ZERO,n.SRC_COLOR,n.ZERO,n.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",we);break}else switch(we){case eI:n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case K1:n.blendFunc(n.SRC_ALPHA,n.ONE);break;case L1:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case _1:n.blendFunc(n.ZERO,n.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",we);break}S=null,R=null,x=null,M=null,E.set(0,0,0),F=0,b=we,N=yt}return}Rt=Rt||ze,mt=mt||Qe,_t=_t||ut,(ze!==y||Rt!==Z)&&(n.blendEquationSeparate(pe[ze],pe[Rt]),y=ze,Z=Rt),(Qe!==S||ut!==R||mt!==x||_t!==M)&&(n.blendFuncSeparate(Te[Qe],Te[ut],Te[mt],Te[_t]),S=Qe,R=ut,x=mt,M=_t),(Lt.equals(E)===!1||Zt!==F)&&(n.blendColor(Lt.r,Lt.g,Lt.b,Zt),E.copy(Lt),F=Zt),b=we,N=!1}function Ye(we,ze){we.side===ms?de(n.CULL_FACE):ge(n.CULL_FACE);let Qe=we.side===fr;ze&&(Qe=!Qe),he(Qe),we.blending===eI&&we.transparent===!1?le(sg):le(we.blending,we.blendEquation,we.blendSrc,we.blendDst,we.blendEquationAlpha,we.blendSrcAlpha,we.blendDstAlpha,we.blendColor,we.blendAlpha,we.premultipliedAlpha),r.setFunc(we.depthFunc),r.setTest(we.depthTest),r.setMask(we.depthWrite),o.setMask(we.colorWrite);const ut=we.stencilWrite;s.setTest(ut),ut&&(s.setMask(we.stencilWriteMask),s.setFunc(we.stencilFunc,we.stencilRef,we.stencilFuncMask),s.setOp(we.stencilFail,we.stencilZFail,we.stencilZPass)),Ee(we.polygonOffset,we.polygonOffsetFactor,we.polygonOffsetUnits),we.alphaToCoverage===!0?ge(n.SAMPLE_ALPHA_TO_COVERAGE):de(n.SAMPLE_ALPHA_TO_COVERAGE)}function he(we){H!==we&&(we?n.frontFace(n.CW):n.frontFace(n.CCW),H=we)}function Ge(we){we!==z5?(ge(n.CULL_FACE),we!==z&&(we===z1?n.cullFace(n.BACK):we===K5?n.cullFace(n.FRONT):n.cullFace(n.FRONT_AND_BACK))):de(n.CULL_FACE),z=we}function be(we){we!==_&&(X&&n.lineWidth(we),_=we)}function Ee(we,ze,Qe){we?(ge(n.POLYGON_OFFSET_FILL),(D!==ze||P!==Qe)&&(n.polygonOffset(ze,Qe),D=ze,P=Qe)):de(n.POLYGON_OFFSET_FILL)}function Se(we){we?ge(n.SCISSOR_TEST):de(n.SCISSOR_TEST)}function ee(we){we===void 0&&(we=n.TEXTURE0+$-1),q!==we&&(n.activeTexture(we),q=we)}function Q(we,ze,Qe){Qe===void 0&&(q===null?Qe=n.TEXTURE0+$-1:Qe=q);let ut=K[Qe];ut===void 0&&(ut={type:void 0,texture:void 0},K[Qe]=ut),(ut.type!==we||ut.texture!==ze)&&(q!==Qe&&(n.activeTexture(Qe),q=Qe),n.bindTexture(we,ze||re[we]),ut.type=we,ut.texture=ze)}function ce(){const we=K[q];we!==void 0&&we.type!==void 0&&(n.bindTexture(we.type,null),we.type=void 0,we.texture=void 0)}function me(){try{n.compressedTexImage2D(...arguments)}catch(we){console.error("THREE.WebGLState:",we)}}function Ze(){try{n.compressedTexImage3D(...arguments)}catch(we){console.error("THREE.WebGLState:",we)}}function Xe(){try{n.texSubImage2D(...arguments)}catch(we){console.error("THREE.WebGLState:",we)}}function De(){try{n.texSubImage3D(...arguments)}catch(we){console.error("THREE.WebGLState:",we)}}function Oe(){try{n.compressedTexSubImage2D(...arguments)}catch(we){console.error("THREE.WebGLState:",we)}}function Je(){try{n.compressedTexSubImage3D(...arguments)}catch(we){console.error("THREE.WebGLState:",we)}}function At(){try{n.texStorage2D(...arguments)}catch(we){console.error("THREE.WebGLState:",we)}}function qe(){try{n.texStorage3D(...arguments)}catch(we){console.error("THREE.WebGLState:",we)}}function lt(){try{n.texImage2D(...arguments)}catch(we){console.error("THREE.WebGLState:",we)}}function $e(){try{n.texImage3D(...arguments)}catch(we){console.error("THREE.WebGLState:",we)}}function je(we){ne.equals(we)===!1&&(n.scissor(we.x,we.y,we.z,we.w),ne.copy(we))}function ke(we){k.equals(we)===!1&&(n.viewport(we.x,we.y,we.z,we.w),k.copy(we))}function Ce(we,ze){let Qe=c.get(ze);Qe===void 0&&(Qe=new WeakMap,c.set(ze,Qe));let ut=Qe.get(we);ut===void 0&&(ut=n.getUniformBlockIndex(ze,we.name),Qe.set(we,ut))}function He(we,ze){const ut=c.get(ze).get(we);l.get(ze)!==ut&&(n.uniformBlockBinding(ze,ut,we.__bindingPointIndex),l.set(ze,ut))}function ht(){n.disable(n.BLEND),n.disable(n.CULL_FACE),n.disable(n.DEPTH_TEST),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SCISSOR_TEST),n.disable(n.STENCIL_TEST),n.disable(n.SAMPLE_ALPHA_TO_COVERAGE),n.blendEquation(n.FUNC_ADD),n.blendFunc(n.ONE,n.ZERO),n.blendFuncSeparate(n.ONE,n.ZERO,n.ONE,n.ZERO),n.blendColor(0,0,0,0),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(n.LESS),r.setReversed(!1),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(n.ALWAYS,0,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.KEEP),n.clearStencil(0),n.cullFace(n.BACK),n.frontFace(n.CCW),n.polygonOffset(0,0),n.activeTexture(n.TEXTURE0),n.bindFramebuffer(n.FRAMEBUFFER,null),n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),n.bindFramebuffer(n.READ_FRAMEBUFFER,null),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),u={},q=null,K={},C={},h=new WeakMap,m=[],p=null,B=!1,b=null,y=null,S=null,R=null,Z=null,x=null,M=null,E=new dn(0,0,0),F=0,N=!1,H=null,z=null,_=null,D=null,P=null,ne.set(0,0,n.canvas.width,n.canvas.height),k.set(0,0,n.canvas.width,n.canvas.height),o.reset(),r.reset(),s.reset()}return{buffers:{color:o,depth:r,stencil:s},enable:ge,disable:de,bindFramebuffer:xe,drawBuffers:Ne,useProgram:ye,setBlending:le,setMaterial:Ye,setFlipSided:he,setCullFace:Ge,setLineWidth:be,setPolygonOffset:Ee,setScissorTest:Se,activeTexture:ee,bindTexture:Q,unbindTexture:ce,compressedTexImage2D:me,compressedTexImage3D:Ze,texImage2D:lt,texImage3D:$e,updateUBOMapping:Ce,uniformBlockBinding:He,texStorage2D:At,texStorage3D:qe,texSubImage2D:Xe,texSubImage3D:De,compressedTexSubImage2D:Oe,compressedTexSubImage3D:Je,scissor:je,viewport:ke,reset:ht}}function M8(n,e,t,i,a,o,r){const s=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,l=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),c=new Xt,u=new WeakMap;let C;const h=new WeakMap;let m=!1;try{m=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function p(ee,Q){return m?new OffscreenCanvas(ee,Q):Zp("canvas")}function B(ee,Q,ce){let me=1;const Ze=Se(ee);if((Ze.width>ce||Ze.height>ce)&&(me=ce/Math.max(Ze.width,Ze.height)),me<1)if(typeof HTMLImageElement<"u"&&ee instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&ee instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&ee instanceof ImageBitmap||typeof VideoFrame<"u"&&ee instanceof VideoFrame){const Xe=Math.floor(me*Ze.width),De=Math.floor(me*Ze.height);C===void 0&&(C=p(Xe,De));const Oe=Q?p(Xe,De):C;return Oe.width=Xe,Oe.height=De,Oe.getContext("2d").drawImage(ee,0,0,Xe,De),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Ze.width+"x"+Ze.height+") to ("+Xe+"x"+De+")."),Oe}else return"data"in ee&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Ze.width+"x"+Ze.height+")."),ee;return ee}function b(ee){return ee.generateMipmaps}function y(ee){n.generateMipmap(ee)}function S(ee){return ee.isWebGLCubeRenderTarget?n.TEXTURE_CUBE_MAP:ee.isWebGL3DRenderTarget?n.TEXTURE_3D:ee.isWebGLArrayRenderTarget||ee.isCompressedArrayTexture?n.TEXTURE_2D_ARRAY:n.TEXTURE_2D}function R(ee,Q,ce,me,Ze=!1){if(ee!==null){if(n[ee]!==void 0)return n[ee];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+ee+"'")}let Xe=Q;if(Q===n.RED&&(ce===n.FLOAT&&(Xe=n.R32F),ce===n.HALF_FLOAT&&(Xe=n.R16F),ce===n.UNSIGNED_BYTE&&(Xe=n.R8)),Q===n.RED_INTEGER&&(ce===n.UNSIGNED_BYTE&&(Xe=n.R8UI),ce===n.UNSIGNED_SHORT&&(Xe=n.R16UI),ce===n.UNSIGNED_INT&&(Xe=n.R32UI),ce===n.BYTE&&(Xe=n.R8I),ce===n.SHORT&&(Xe=n.R16I),ce===n.INT&&(Xe=n.R32I)),Q===n.RG&&(ce===n.FLOAT&&(Xe=n.RG32F),ce===n.HALF_FLOAT&&(Xe=n.RG16F),ce===n.UNSIGNED_BYTE&&(Xe=n.RG8)),Q===n.RG_INTEGER&&(ce===n.UNSIGNED_BYTE&&(Xe=n.RG8UI),ce===n.UNSIGNED_SHORT&&(Xe=n.RG16UI),ce===n.UNSIGNED_INT&&(Xe=n.RG32UI),ce===n.BYTE&&(Xe=n.RG8I),ce===n.SHORT&&(Xe=n.RG16I),ce===n.INT&&(Xe=n.RG32I)),Q===n.RGB_INTEGER&&(ce===n.UNSIGNED_BYTE&&(Xe=n.RGB8UI),ce===n.UNSIGNED_SHORT&&(Xe=n.RGB16UI),ce===n.UNSIGNED_INT&&(Xe=n.RGB32UI),ce===n.BYTE&&(Xe=n.RGB8I),ce===n.SHORT&&(Xe=n.RGB16I),ce===n.INT&&(Xe=n.RGB32I)),Q===n.RGBA_INTEGER&&(ce===n.UNSIGNED_BYTE&&(Xe=n.RGBA8UI),ce===n.UNSIGNED_SHORT&&(Xe=n.RGBA16UI),ce===n.UNSIGNED_INT&&(Xe=n.RGBA32UI),ce===n.BYTE&&(Xe=n.RGBA8I),ce===n.SHORT&&(Xe=n.RGBA16I),ce===n.INT&&(Xe=n.RGBA32I)),Q===n.RGB&&ce===n.UNSIGNED_INT_5_9_9_9_REV&&(Xe=n.RGB9_E5),Q===n.RGBA){const De=Ze?Sp:vi.getTransfer(me);ce===n.FLOAT&&(Xe=n.RGBA32F),ce===n.HALF_FLOAT&&(Xe=n.RGBA16F),ce===n.UNSIGNED_BYTE&&(Xe=De===Ui?n.SRGB8_ALPHA8:n.RGBA8),ce===n.UNSIGNED_SHORT_4_4_4_4&&(Xe=n.RGBA4),ce===n.UNSIGNED_SHORT_5_5_5_1&&(Xe=n.RGB5_A1)}return(Xe===n.R16F||Xe===n.R32F||Xe===n.RG16F||Xe===n.RG32F||Xe===n.RGBA16F||Xe===n.RGBA32F)&&e.get("EXT_color_buffer_float"),Xe}function Z(ee,Q){let ce;return ee?Q===null||Q===Ig||Q===bf?ce=n.DEPTH24_STENCIL8:Q===ma?ce=n.DEPTH32F_STENCIL8:Q===pf&&(ce=n.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):Q===null||Q===Ig||Q===bf?ce=n.DEPTH_COMPONENT24:Q===ma?ce=n.DEPTH_COMPONENT32F:Q===pf&&(ce=n.DEPTH_COMPONENT16),ce}function x(ee,Q){return b(ee)===!0||ee.isFramebufferTexture&&ee.minFilter!==Mo&&ee.minFilter!==Bi?Math.log2(Math.max(Q.width,Q.height))+1:ee.mipmaps!==void 0&&ee.mipmaps.length>0?ee.mipmaps.length:ee.isCompressedTexture&&Array.isArray(ee.image)?Q.mipmaps.length:1}function M(ee){const Q=ee.target;Q.removeEventListener("dispose",M),F(Q),Q.isVideoTexture&&u.delete(Q)}function E(ee){const Q=ee.target;Q.removeEventListener("dispose",E),H(Q)}function F(ee){const Q=i.get(ee);if(Q.__webglInit===void 0)return;const ce=ee.source,me=h.get(ce);if(me){const Ze=me[Q.__cacheKey];Ze.usedTimes--,Ze.usedTimes===0&&N(ee),Object.keys(me).length===0&&h.delete(ce)}i.remove(ee)}function N(ee){const Q=i.get(ee);n.deleteTexture(Q.__webglTexture);const ce=ee.source,me=h.get(ce);delete me[Q.__cacheKey],r.memory.textures--}function H(ee){const Q=i.get(ee);if(ee.depthTexture&&(ee.depthTexture.dispose(),i.remove(ee.depthTexture)),ee.isWebGLCubeRenderTarget)for(let me=0;me<6;me++){if(Array.isArray(Q.__webglFramebuffer[me]))for(let Ze=0;Ze<Q.__webglFramebuffer[me].length;Ze++)n.deleteFramebuffer(Q.__webglFramebuffer[me][Ze]);else n.deleteFramebuffer(Q.__webglFramebuffer[me]);Q.__webglDepthbuffer&&n.deleteRenderbuffer(Q.__webglDepthbuffer[me])}else{if(Array.isArray(Q.__webglFramebuffer))for(let me=0;me<Q.__webglFramebuffer.length;me++)n.deleteFramebuffer(Q.__webglFramebuffer[me]);else n.deleteFramebuffer(Q.__webglFramebuffer);if(Q.__webglDepthbuffer&&n.deleteRenderbuffer(Q.__webglDepthbuffer),Q.__webglMultisampledFramebuffer&&n.deleteFramebuffer(Q.__webglMultisampledFramebuffer),Q.__webglColorRenderbuffer)for(let me=0;me<Q.__webglColorRenderbuffer.length;me++)Q.__webglColorRenderbuffer[me]&&n.deleteRenderbuffer(Q.__webglColorRenderbuffer[me]);Q.__webglDepthRenderbuffer&&n.deleteRenderbuffer(Q.__webglDepthRenderbuffer)}const ce=ee.textures;for(let me=0,Ze=ce.length;me<Ze;me++){const Xe=i.get(ce[me]);Xe.__webglTexture&&(n.deleteTexture(Xe.__webglTexture),r.memory.textures--),i.remove(ce[me])}i.remove(ee)}let z=0;function _(){z=0}function D(){const ee=z;return ee>=a.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+ee+" texture units while this GPU supports only "+a.maxTextures),z+=1,ee}function P(ee){const Q=[];return Q.push(ee.wrapS),Q.push(ee.wrapT),Q.push(ee.wrapR||0),Q.push(ee.magFilter),Q.push(ee.minFilter),Q.push(ee.anisotropy),Q.push(ee.internalFormat),Q.push(ee.format),Q.push(ee.type),Q.push(ee.generateMipmaps),Q.push(ee.premultiplyAlpha),Q.push(ee.flipY),Q.push(ee.unpackAlignment),Q.push(ee.colorSpace),Q.join()}function $(ee,Q){const ce=i.get(ee);if(ee.isVideoTexture&&be(ee),ee.isRenderTargetTexture===!1&&ee.version>0&&ce.__version!==ee.version){const me=ee.image;if(me===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(me.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{k(ce,ee,Q);return}}t.bindTexture(n.TEXTURE_2D,ce.__webglTexture,n.TEXTURE0+Q)}function X(ee,Q){const ce=i.get(ee);if(ee.version>0&&ce.__version!==ee.version){k(ce,ee,Q);return}t.bindTexture(n.TEXTURE_2D_ARRAY,ce.__webglTexture,n.TEXTURE0+Q)}function L(ee,Q){const ce=i.get(ee);if(ee.version>0&&ce.__version!==ee.version){k(ce,ee,Q);return}t.bindTexture(n.TEXTURE_3D,ce.__webglTexture,n.TEXTURE0+Q)}function U(ee,Q){const ce=i.get(ee);if(ee.version>0&&ce.__version!==ee.version){ie(ce,ee,Q);return}t.bindTexture(n.TEXTURE_CUBE_MAP,ce.__webglTexture,n.TEXTURE0+Q)}const q={[gu]:n.REPEAT,[Ka]:n.CLAMP_TO_EDGE,[mf]:n.MIRRORED_REPEAT},K={[Mo]:n.NEAREST,[dG]:n.NEAREST_MIPMAP_NEAREST,[OC]:n.NEAREST_MIPMAP_LINEAR,[Bi]:n.LINEAR,[cf]:n.LINEAR_MIPMAP_NEAREST,[pl]:n.LINEAR_MIPMAP_LINEAR},O={[y9]:n.NEVER,[Z9]:n.ALWAYS,[B9]:n.LESS,[ox]:n.LEQUAL,[G9]:n.EQUAL,[R9]:n.GEQUAL,[S9]:n.GREATER,[w9]:n.NOTEQUAL};function j(ee,Q){if(Q.type===ma&&e.has("OES_texture_float_linear")===!1&&(Q.magFilter===Bi||Q.magFilter===cf||Q.magFilter===OC||Q.magFilter===pl||Q.minFilter===Bi||Q.minFilter===cf||Q.minFilter===OC||Q.minFilter===pl)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),n.texParameteri(ee,n.TEXTURE_WRAP_S,q[Q.wrapS]),n.texParameteri(ee,n.TEXTURE_WRAP_T,q[Q.wrapT]),(ee===n.TEXTURE_3D||ee===n.TEXTURE_2D_ARRAY)&&n.texParameteri(ee,n.TEXTURE_WRAP_R,q[Q.wrapR]),n.texParameteri(ee,n.TEXTURE_MAG_FILTER,K[Q.magFilter]),n.texParameteri(ee,n.TEXTURE_MIN_FILTER,K[Q.minFilter]),Q.compareFunction&&(n.texParameteri(ee,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri(ee,n.TEXTURE_COMPARE_FUNC,O[Q.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(Q.magFilter===Mo||Q.minFilter!==OC&&Q.minFilter!==pl||Q.type===ma&&e.has("OES_texture_float_linear")===!1)return;if(Q.anisotropy>1||i.get(Q).__currentAnisotropy){const ce=e.get("EXT_texture_filter_anisotropic");n.texParameterf(ee,ce.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(Q.anisotropy,a.getMaxAnisotropy())),i.get(Q).__currentAnisotropy=Q.anisotropy}}}function ne(ee,Q){let ce=!1;ee.__webglInit===void 0&&(ee.__webglInit=!0,Q.addEventListener("dispose",M));const me=Q.source;let Ze=h.get(me);Ze===void 0&&(Ze={},h.set(me,Ze));const Xe=P(Q);if(Xe!==ee.__cacheKey){Ze[Xe]===void 0&&(Ze[Xe]={texture:n.createTexture(),usedTimes:0},r.memory.textures++,ce=!0),Ze[Xe].usedTimes++;const De=Ze[ee.__cacheKey];De!==void 0&&(Ze[ee.__cacheKey].usedTimes--,De.usedTimes===0&&N(Q)),ee.__cacheKey=Xe,ee.__webglTexture=Ze[Xe].texture}return ce}function k(ee,Q,ce){let me=n.TEXTURE_2D;(Q.isDataArrayTexture||Q.isCompressedArrayTexture)&&(me=n.TEXTURE_2D_ARRAY),Q.isData3DTexture&&(me=n.TEXTURE_3D);const Ze=ne(ee,Q),Xe=Q.source;t.bindTexture(me,ee.__webglTexture,n.TEXTURE0+ce);const De=i.get(Xe);if(Xe.version!==De.__version||Ze===!0){t.activeTexture(n.TEXTURE0+ce);const Oe=vi.getPrimaries(vi.workingColorSpace),Je=Q.colorSpace===$g?null:vi.getPrimaries(Q.colorSpace),At=Q.colorSpace===$g||Oe===Je?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,Q.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Q.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,Q.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,At);let qe=B(Q.image,!1,a.maxTextureSize);qe=Ee(Q,qe);const lt=o.convert(Q.format,Q.colorSpace),$e=o.convert(Q.type);let je=R(Q.internalFormat,lt,$e,Q.colorSpace,Q.isVideoTexture);j(me,Q);let ke;const Ce=Q.mipmaps,He=Q.isVideoTexture!==!0,ht=De.__version===void 0||Ze===!0,we=Xe.dataReady,ze=x(Q,qe);if(Q.isDepthTexture)je=Z(Q.format===yf,Q.type),ht&&(He?t.texStorage2D(n.TEXTURE_2D,1,je,qe.width,qe.height):t.texImage2D(n.TEXTURE_2D,0,je,qe.width,qe.height,0,lt,$e,null));else if(Q.isDataTexture)if(Ce.length>0){He&&ht&&t.texStorage2D(n.TEXTURE_2D,ze,je,Ce[0].width,Ce[0].height);for(let Qe=0,ut=Ce.length;Qe<ut;Qe++)ke=Ce[Qe],He?we&&t.texSubImage2D(n.TEXTURE_2D,Qe,0,0,ke.width,ke.height,lt,$e,ke.data):t.texImage2D(n.TEXTURE_2D,Qe,je,ke.width,ke.height,0,lt,$e,ke.data);Q.generateMipmaps=!1}else He?(ht&&t.texStorage2D(n.TEXTURE_2D,ze,je,qe.width,qe.height),we&&t.texSubImage2D(n.TEXTURE_2D,0,0,0,qe.width,qe.height,lt,$e,qe.data)):t.texImage2D(n.TEXTURE_2D,0,je,qe.width,qe.height,0,lt,$e,qe.data);else if(Q.isCompressedTexture)if(Q.isCompressedArrayTexture){He&&ht&&t.texStorage3D(n.TEXTURE_2D_ARRAY,ze,je,Ce[0].width,Ce[0].height,qe.depth);for(let Qe=0,ut=Ce.length;Qe<ut;Qe++)if(ke=Ce[Qe],Q.format!==La)if(lt!==null)if(He){if(we)if(Q.layerUpdates.size>0){const Rt=eR(ke.width,ke.height,Q.format,Q.type);for(const mt of Q.layerUpdates){const _t=ke.data.subarray(mt*Rt/ke.data.BYTES_PER_ELEMENT,(mt+1)*Rt/ke.data.BYTES_PER_ELEMENT);t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,Qe,0,0,mt,ke.width,ke.height,1,lt,_t)}Q.clearLayerUpdates()}else t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,Qe,0,0,0,ke.width,ke.height,qe.depth,lt,ke.data)}else t.compressedTexImage3D(n.TEXTURE_2D_ARRAY,Qe,je,ke.width,ke.height,qe.depth,0,ke.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else He?we&&t.texSubImage3D(n.TEXTURE_2D_ARRAY,Qe,0,0,0,ke.width,ke.height,qe.depth,lt,$e,ke.data):t.texImage3D(n.TEXTURE_2D_ARRAY,Qe,je,ke.width,ke.height,qe.depth,0,lt,$e,ke.data)}else{He&&ht&&t.texStorage2D(n.TEXTURE_2D,ze,je,Ce[0].width,Ce[0].height);for(let Qe=0,ut=Ce.length;Qe<ut;Qe++)ke=Ce[Qe],Q.format!==La?lt!==null?He?we&&t.compressedTexSubImage2D(n.TEXTURE_2D,Qe,0,0,ke.width,ke.height,lt,ke.data):t.compressedTexImage2D(n.TEXTURE_2D,Qe,je,ke.width,ke.height,0,ke.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):He?we&&t.texSubImage2D(n.TEXTURE_2D,Qe,0,0,ke.width,ke.height,lt,$e,ke.data):t.texImage2D(n.TEXTURE_2D,Qe,je,ke.width,ke.height,0,lt,$e,ke.data)}else if(Q.isDataArrayTexture)if(He){if(ht&&t.texStorage3D(n.TEXTURE_2D_ARRAY,ze,je,qe.width,qe.height,qe.depth),we)if(Q.layerUpdates.size>0){const Qe=eR(qe.width,qe.height,Q.format,Q.type);for(const ut of Q.layerUpdates){const Rt=qe.data.subarray(ut*Qe/qe.data.BYTES_PER_ELEMENT,(ut+1)*Qe/qe.data.BYTES_PER_ELEMENT);t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,ut,qe.width,qe.height,1,lt,$e,Rt)}Q.clearLayerUpdates()}else t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,qe.width,qe.height,qe.depth,lt,$e,qe.data)}else t.texImage3D(n.TEXTURE_2D_ARRAY,0,je,qe.width,qe.height,qe.depth,0,lt,$e,qe.data);else if(Q.isData3DTexture)He?(ht&&t.texStorage3D(n.TEXTURE_3D,ze,je,qe.width,qe.height,qe.depth),we&&t.texSubImage3D(n.TEXTURE_3D,0,0,0,0,qe.width,qe.height,qe.depth,lt,$e,qe.data)):t.texImage3D(n.TEXTURE_3D,0,je,qe.width,qe.height,qe.depth,0,lt,$e,qe.data);else if(Q.isFramebufferTexture){if(ht)if(He)t.texStorage2D(n.TEXTURE_2D,ze,je,qe.width,qe.height);else{let Qe=qe.width,ut=qe.height;for(let Rt=0;Rt<ze;Rt++)t.texImage2D(n.TEXTURE_2D,Rt,je,Qe,ut,0,lt,$e,null),Qe>>=1,ut>>=1}}else if(Ce.length>0){if(He&&ht){const Qe=Se(Ce[0]);t.texStorage2D(n.TEXTURE_2D,ze,je,Qe.width,Qe.height)}for(let Qe=0,ut=Ce.length;Qe<ut;Qe++)ke=Ce[Qe],He?we&&t.texSubImage2D(n.TEXTURE_2D,Qe,0,0,lt,$e,ke):t.texImage2D(n.TEXTURE_2D,Qe,je,lt,$e,ke);Q.generateMipmaps=!1}else if(He){if(ht){const Qe=Se(qe);t.texStorage2D(n.TEXTURE_2D,ze,je,Qe.width,Qe.height)}we&&t.texSubImage2D(n.TEXTURE_2D,0,0,0,lt,$e,qe)}else t.texImage2D(n.TEXTURE_2D,0,je,lt,$e,qe);b(Q)&&y(me),De.__version=Xe.version,Q.onUpdate&&Q.onUpdate(Q)}ee.__version=Q.version}function ie(ee,Q,ce){if(Q.image.length!==6)return;const me=ne(ee,Q),Ze=Q.source;t.bindTexture(n.TEXTURE_CUBE_MAP,ee.__webglTexture,n.TEXTURE0+ce);const Xe=i.get(Ze);if(Ze.version!==Xe.__version||me===!0){t.activeTexture(n.TEXTURE0+ce);const De=vi.getPrimaries(vi.workingColorSpace),Oe=Q.colorSpace===$g?null:vi.getPrimaries(Q.colorSpace),Je=Q.colorSpace===$g||De===Oe?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,Q.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Q.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,Q.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,Je);const At=Q.isCompressedTexture||Q.image[0].isCompressedTexture,qe=Q.image[0]&&Q.image[0].isDataTexture,lt=[];for(let ut=0;ut<6;ut++)!At&&!qe?lt[ut]=B(Q.image[ut],!0,a.maxCubemapSize):lt[ut]=qe?Q.image[ut].image:Q.image[ut],lt[ut]=Ee(Q,lt[ut]);const $e=lt[0],je=o.convert(Q.format,Q.colorSpace),ke=o.convert(Q.type),Ce=R(Q.internalFormat,je,ke,Q.colorSpace),He=Q.isVideoTexture!==!0,ht=Xe.__version===void 0||me===!0,we=Ze.dataReady;let ze=x(Q,$e);j(n.TEXTURE_CUBE_MAP,Q);let Qe;if(At){He&&ht&&t.texStorage2D(n.TEXTURE_CUBE_MAP,ze,Ce,$e.width,$e.height);for(let ut=0;ut<6;ut++){Qe=lt[ut].mipmaps;for(let Rt=0;Rt<Qe.length;Rt++){const mt=Qe[Rt];Q.format!==La?je!==null?He?we&&t.compressedTexSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ut,Rt,0,0,mt.width,mt.height,je,mt.data):t.compressedTexImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ut,Rt,Ce,mt.width,mt.height,0,mt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):He?we&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ut,Rt,0,0,mt.width,mt.height,je,ke,mt.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ut,Rt,Ce,mt.width,mt.height,0,je,ke,mt.data)}}}else{if(Qe=Q.mipmaps,He&&ht){Qe.length>0&&ze++;const ut=Se(lt[0]);t.texStorage2D(n.TEXTURE_CUBE_MAP,ze,Ce,ut.width,ut.height)}for(let ut=0;ut<6;ut++)if(qe){He?we&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ut,0,0,0,lt[ut].width,lt[ut].height,je,ke,lt[ut].data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ut,0,Ce,lt[ut].width,lt[ut].height,0,je,ke,lt[ut].data);for(let Rt=0;Rt<Qe.length;Rt++){const _t=Qe[Rt].image[ut].image;He?we&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ut,Rt+1,0,0,_t.width,_t.height,je,ke,_t.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ut,Rt+1,Ce,_t.width,_t.height,0,je,ke,_t.data)}}else{He?we&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ut,0,0,0,je,ke,lt[ut]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ut,0,Ce,je,ke,lt[ut]);for(let Rt=0;Rt<Qe.length;Rt++){const mt=Qe[Rt];He?we&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ut,Rt+1,0,0,je,ke,mt.image[ut]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ut,Rt+1,Ce,je,ke,mt.image[ut])}}}b(Q)&&y(n.TEXTURE_CUBE_MAP),Xe.__version=Ze.version,Q.onUpdate&&Q.onUpdate(Q)}ee.__version=Q.version}function re(ee,Q,ce,me,Ze,Xe){const De=o.convert(ce.format,ce.colorSpace),Oe=o.convert(ce.type),Je=R(ce.internalFormat,De,Oe,ce.colorSpace),At=i.get(Q),qe=i.get(ce);if(qe.__renderTarget=Q,!At.__hasExternalTextures){const lt=Math.max(1,Q.width>>Xe),$e=Math.max(1,Q.height>>Xe);Ze===n.TEXTURE_3D||Ze===n.TEXTURE_2D_ARRAY?t.texImage3D(Ze,Xe,Je,lt,$e,Q.depth,0,De,Oe,null):t.texImage2D(Ze,Xe,Je,lt,$e,0,De,Oe,null)}t.bindFramebuffer(n.FRAMEBUFFER,ee),Ge(Q)?s.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,me,Ze,qe.__webglTexture,0,he(Q)):(Ze===n.TEXTURE_2D||Ze>=n.TEXTURE_CUBE_MAP_POSITIVE_X&&Ze<=n.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&n.framebufferTexture2D(n.FRAMEBUFFER,me,Ze,qe.__webglTexture,Xe),t.bindFramebuffer(n.FRAMEBUFFER,null)}function ge(ee,Q,ce){if(n.bindRenderbuffer(n.RENDERBUFFER,ee),Q.depthBuffer){const me=Q.depthTexture,Ze=me&&me.isDepthTexture?me.type:null,Xe=Z(Q.stencilBuffer,Ze),De=Q.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,Oe=he(Q);Ge(Q)?s.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,Oe,Xe,Q.width,Q.height):ce?n.renderbufferStorageMultisample(n.RENDERBUFFER,Oe,Xe,Q.width,Q.height):n.renderbufferStorage(n.RENDERBUFFER,Xe,Q.width,Q.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,De,n.RENDERBUFFER,ee)}else{const me=Q.textures;for(let Ze=0;Ze<me.length;Ze++){const Xe=me[Ze],De=o.convert(Xe.format,Xe.colorSpace),Oe=o.convert(Xe.type),Je=R(Xe.internalFormat,De,Oe,Xe.colorSpace),At=he(Q);ce&&Ge(Q)===!1?n.renderbufferStorageMultisample(n.RENDERBUFFER,At,Je,Q.width,Q.height):Ge(Q)?s.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,At,Je,Q.width,Q.height):n.renderbufferStorage(n.RENDERBUFFER,Je,Q.width,Q.height)}}n.bindRenderbuffer(n.RENDERBUFFER,null)}function de(ee,Q){if(Q&&Q.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(n.FRAMEBUFFER,ee),!(Q.depthTexture&&Q.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const me=i.get(Q.depthTexture);me.__renderTarget=Q,(!me.__webglTexture||Q.depthTexture.image.width!==Q.width||Q.depthTexture.image.height!==Q.height)&&(Q.depthTexture.image.width=Q.width,Q.depthTexture.image.height=Q.height,Q.depthTexture.needsUpdate=!0),$(Q.depthTexture,0);const Ze=me.__webglTexture,Xe=he(Q);if(Q.depthTexture.format===vf)Ge(Q)?s.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,Ze,0,Xe):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,Ze,0);else if(Q.depthTexture.format===yf)Ge(Q)?s.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,Ze,0,Xe):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,Ze,0);else throw new Error("Unknown depthTexture format")}function xe(ee){const Q=i.get(ee),ce=ee.isWebGLCubeRenderTarget===!0;if(Q.__boundDepthTexture!==ee.depthTexture){const me=ee.depthTexture;if(Q.__depthDisposeCallback&&Q.__depthDisposeCallback(),me){const Ze=()=>{delete Q.__boundDepthTexture,delete Q.__depthDisposeCallback,me.removeEventListener("dispose",Ze)};me.addEventListener("dispose",Ze),Q.__depthDisposeCallback=Ze}Q.__boundDepthTexture=me}if(ee.depthTexture&&!Q.__autoAllocateDepthBuffer){if(ce)throw new Error("target.depthTexture not supported in Cube render targets");de(Q.__webglFramebuffer,ee)}else if(ce){Q.__webglDepthbuffer=[];for(let me=0;me<6;me++)if(t.bindFramebuffer(n.FRAMEBUFFER,Q.__webglFramebuffer[me]),Q.__webglDepthbuffer[me]===void 0)Q.__webglDepthbuffer[me]=n.createRenderbuffer(),ge(Q.__webglDepthbuffer[me],ee,!1);else{const Ze=ee.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,Xe=Q.__webglDepthbuffer[me];n.bindRenderbuffer(n.RENDERBUFFER,Xe),n.framebufferRenderbuffer(n.FRAMEBUFFER,Ze,n.RENDERBUFFER,Xe)}}else if(t.bindFramebuffer(n.FRAMEBUFFER,Q.__webglFramebuffer),Q.__webglDepthbuffer===void 0)Q.__webglDepthbuffer=n.createRenderbuffer(),ge(Q.__webglDepthbuffer,ee,!1);else{const me=ee.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,Ze=Q.__webglDepthbuffer;n.bindRenderbuffer(n.RENDERBUFFER,Ze),n.framebufferRenderbuffer(n.FRAMEBUFFER,me,n.RENDERBUFFER,Ze)}t.bindFramebuffer(n.FRAMEBUFFER,null)}function Ne(ee,Q,ce){const me=i.get(ee);Q!==void 0&&re(me.__webglFramebuffer,ee,ee.texture,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,0),ce!==void 0&&xe(ee)}function ye(ee){const Q=ee.texture,ce=i.get(ee),me=i.get(Q);ee.addEventListener("dispose",E);const Ze=ee.textures,Xe=ee.isWebGLCubeRenderTarget===!0,De=Ze.length>1;if(De||(me.__webglTexture===void 0&&(me.__webglTexture=n.createTexture()),me.__version=Q.version,r.memory.textures++),Xe){ce.__webglFramebuffer=[];for(let Oe=0;Oe<6;Oe++)if(Q.mipmaps&&Q.mipmaps.length>0){ce.__webglFramebuffer[Oe]=[];for(let Je=0;Je<Q.mipmaps.length;Je++)ce.__webglFramebuffer[Oe][Je]=n.createFramebuffer()}else ce.__webglFramebuffer[Oe]=n.createFramebuffer()}else{if(Q.mipmaps&&Q.mipmaps.length>0){ce.__webglFramebuffer=[];for(let Oe=0;Oe<Q.mipmaps.length;Oe++)ce.__webglFramebuffer[Oe]=n.createFramebuffer()}else ce.__webglFramebuffer=n.createFramebuffer();if(De)for(let Oe=0,Je=Ze.length;Oe<Je;Oe++){const At=i.get(Ze[Oe]);At.__webglTexture===void 0&&(At.__webglTexture=n.createTexture(),r.memory.textures++)}if(ee.samples>0&&Ge(ee)===!1){ce.__webglMultisampledFramebuffer=n.createFramebuffer(),ce.__webglColorRenderbuffer=[],t.bindFramebuffer(n.FRAMEBUFFER,ce.__webglMultisampledFramebuffer);for(let Oe=0;Oe<Ze.length;Oe++){const Je=Ze[Oe];ce.__webglColorRenderbuffer[Oe]=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,ce.__webglColorRenderbuffer[Oe]);const At=o.convert(Je.format,Je.colorSpace),qe=o.convert(Je.type),lt=R(Je.internalFormat,At,qe,Je.colorSpace,ee.isXRRenderTarget===!0),$e=he(ee);n.renderbufferStorageMultisample(n.RENDERBUFFER,$e,lt,ee.width,ee.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Oe,n.RENDERBUFFER,ce.__webglColorRenderbuffer[Oe])}n.bindRenderbuffer(n.RENDERBUFFER,null),ee.depthBuffer&&(ce.__webglDepthRenderbuffer=n.createRenderbuffer(),ge(ce.__webglDepthRenderbuffer,ee,!0)),t.bindFramebuffer(n.FRAMEBUFFER,null)}}if(Xe){t.bindTexture(n.TEXTURE_CUBE_MAP,me.__webglTexture),j(n.TEXTURE_CUBE_MAP,Q);for(let Oe=0;Oe<6;Oe++)if(Q.mipmaps&&Q.mipmaps.length>0)for(let Je=0;Je<Q.mipmaps.length;Je++)re(ce.__webglFramebuffer[Oe][Je],ee,Q,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+Oe,Je);else re(ce.__webglFramebuffer[Oe],ee,Q,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+Oe,0);b(Q)&&y(n.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(De){for(let Oe=0,Je=Ze.length;Oe<Je;Oe++){const At=Ze[Oe],qe=i.get(At);t.bindTexture(n.TEXTURE_2D,qe.__webglTexture),j(n.TEXTURE_2D,At),re(ce.__webglFramebuffer,ee,At,n.COLOR_ATTACHMENT0+Oe,n.TEXTURE_2D,0),b(At)&&y(n.TEXTURE_2D)}t.unbindTexture()}else{let Oe=n.TEXTURE_2D;if((ee.isWebGL3DRenderTarget||ee.isWebGLArrayRenderTarget)&&(Oe=ee.isWebGL3DRenderTarget?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY),t.bindTexture(Oe,me.__webglTexture),j(Oe,Q),Q.mipmaps&&Q.mipmaps.length>0)for(let Je=0;Je<Q.mipmaps.length;Je++)re(ce.__webglFramebuffer[Je],ee,Q,n.COLOR_ATTACHMENT0,Oe,Je);else re(ce.__webglFramebuffer,ee,Q,n.COLOR_ATTACHMENT0,Oe,0);b(Q)&&y(Oe),t.unbindTexture()}ee.depthBuffer&&xe(ee)}function pe(ee){const Q=ee.textures;for(let ce=0,me=Q.length;ce<me;ce++){const Ze=Q[ce];if(b(Ze)){const Xe=S(ee),De=i.get(Ze).__webglTexture;t.bindTexture(Xe,De),y(Xe),t.unbindTexture()}}}const Te=[],le=[];function Ye(ee){if(ee.samples>0){if(Ge(ee)===!1){const Q=ee.textures,ce=ee.width,me=ee.height;let Ze=n.COLOR_BUFFER_BIT;const Xe=ee.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,De=i.get(ee),Oe=Q.length>1;if(Oe)for(let Je=0;Je<Q.length;Je++)t.bindFramebuffer(n.FRAMEBUFFER,De.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Je,n.RENDERBUFFER,null),t.bindFramebuffer(n.FRAMEBUFFER,De.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+Je,n.TEXTURE_2D,null,0);t.bindFramebuffer(n.READ_FRAMEBUFFER,De.__webglMultisampledFramebuffer),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,De.__webglFramebuffer);for(let Je=0;Je<Q.length;Je++){if(ee.resolveDepthBuffer&&(ee.depthBuffer&&(Ze|=n.DEPTH_BUFFER_BIT),ee.stencilBuffer&&ee.resolveStencilBuffer&&(Ze|=n.STENCIL_BUFFER_BIT)),Oe){n.framebufferRenderbuffer(n.READ_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,De.__webglColorRenderbuffer[Je]);const At=i.get(Q[Je]).__webglTexture;n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,At,0)}n.blitFramebuffer(0,0,ce,me,0,0,ce,me,Ze,n.NEAREST),l===!0&&(Te.length=0,le.length=0,Te.push(n.COLOR_ATTACHMENT0+Je),ee.depthBuffer&&ee.resolveDepthBuffer===!1&&(Te.push(Xe),le.push(Xe),n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,le)),n.invalidateFramebuffer(n.READ_FRAMEBUFFER,Te))}if(t.bindFramebuffer(n.READ_FRAMEBUFFER,null),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),Oe)for(let Je=0;Je<Q.length;Je++){t.bindFramebuffer(n.FRAMEBUFFER,De.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Je,n.RENDERBUFFER,De.__webglColorRenderbuffer[Je]);const At=i.get(Q[Je]).__webglTexture;t.bindFramebuffer(n.FRAMEBUFFER,De.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+Je,n.TEXTURE_2D,At,0)}t.bindFramebuffer(n.DRAW_FRAMEBUFFER,De.__webglMultisampledFramebuffer)}else if(ee.depthBuffer&&ee.resolveDepthBuffer===!1&&l){const Q=ee.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT;n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,[Q])}}}function he(ee){return Math.min(a.maxSamples,ee.samples)}function Ge(ee){const Q=i.get(ee);return ee.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&Q.__useRenderToTexture!==!1}function be(ee){const Q=r.render.frame;u.get(ee)!==Q&&(u.set(ee,Q),ee.update())}function Ee(ee,Q){const ce=ee.colorSpace,me=ee.format,Ze=ee.type;return ee.isCompressedTexture===!0||ee.isVideoTexture===!0||ce!==Cc&&ce!==$g&&(vi.getTransfer(ce)===Ui?(me!==La||Ze!==vs)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",ce)),Q}function Se(ee){return typeof HTMLImageElement<"u"&&ee instanceof HTMLImageElement?(c.width=ee.naturalWidth||ee.width,c.height=ee.naturalHeight||ee.height):typeof VideoFrame<"u"&&ee instanceof VideoFrame?(c.width=ee.displayWidth,c.height=ee.displayHeight):(c.width=ee.width,c.height=ee.height),c}this.allocateTextureUnit=D,this.resetTextureUnits=_,this.setTexture2D=$,this.setTexture2DArray=X,this.setTexture3D=L,this.setTextureCube=U,this.rebindTextures=Ne,this.setupRenderTarget=ye,this.updateRenderTargetMipmap=pe,this.updateMultisampleRenderTarget=Ye,this.setupDepthRenderbuffer=xe,this.setupFrameBufferTexture=re,this.useMultisampledRTT=Ge}function EX(n,e){function t(i,a=$g){let o;const r=vi.getTransfer(a);if(i===vs)return n.UNSIGNED_BYTE;if(i===hG)return n.UNSIGNED_SHORT_4_4_4_4;if(i===fG)return n.UNSIGNED_SHORT_5_5_5_1;if(i===JZ)return n.UNSIGNED_INT_5_9_9_9_REV;if(i===CG)return n.BYTE;if(i===IG)return n.SHORT;if(i===pf)return n.UNSIGNED_SHORT;if(i===nb)return n.INT;if(i===Ig)return n.UNSIGNED_INT;if(i===ma)return n.FLOAT;if(i===Co)return n.HALF_FLOAT;if(i===jZ)return n.ALPHA;if(i===QZ)return n.RGB;if(i===La)return n.RGBA;if(i===qZ)return n.LUMINANCE;if(i===$Z)return n.LUMINANCE_ALPHA;if(i===vf)return n.DEPTH_COMPONENT;if(i===yf)return n.DEPTH_STENCIL;if(i===ib)return n.RED;if(i===ab)return n.RED_INTEGER;if(i===ex)return n.RG;if(i===AG)return n.RG_INTEGER;if(i===mG)return n.RGBA_INTEGER;if(i===ip||i===ap||i===op||i===rp)if(r===Ui)if(o=e.get("WEBGL_compressed_texture_s3tc_srgb"),o!==null){if(i===ip)return o.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(i===ap)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(i===op)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(i===rp)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(o=e.get("WEBGL_compressed_texture_s3tc"),o!==null){if(i===ip)return o.COMPRESSED_RGB_S3TC_DXT1_EXT;if(i===ap)return o.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(i===op)return o.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(i===rp)return o.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(i===iB||i===aB||i===oB||i===rB)if(o=e.get("WEBGL_compressed_texture_pvrtc"),o!==null){if(i===iB)return o.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(i===aB)return o.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(i===oB)return o.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(i===rB)return o.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(i===sB||i===lB||i===cB)if(o=e.get("WEBGL_compressed_texture_etc"),o!==null){if(i===sB||i===lB)return r===Ui?o.COMPRESSED_SRGB8_ETC2:o.COMPRESSED_RGB8_ETC2;if(i===cB)return r===Ui?o.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:o.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(i===gB||i===uB||i===dB||i===CB||i===IB||i===hB||i===fB||i===AB||i===mB||i===pB||i===bB||i===vB||i===yB||i===BB)if(o=e.get("WEBGL_compressed_texture_astc"),o!==null){if(i===gB)return r===Ui?o.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:o.COMPRESSED_RGBA_ASTC_4x4_KHR;if(i===uB)return r===Ui?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:o.COMPRESSED_RGBA_ASTC_5x4_KHR;if(i===dB)return r===Ui?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:o.COMPRESSED_RGBA_ASTC_5x5_KHR;if(i===CB)return r===Ui?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:o.COMPRESSED_RGBA_ASTC_6x5_KHR;if(i===IB)return r===Ui?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:o.COMPRESSED_RGBA_ASTC_6x6_KHR;if(i===hB)return r===Ui?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:o.COMPRESSED_RGBA_ASTC_8x5_KHR;if(i===fB)return r===Ui?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:o.COMPRESSED_RGBA_ASTC_8x6_KHR;if(i===AB)return r===Ui?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:o.COMPRESSED_RGBA_ASTC_8x8_KHR;if(i===mB)return r===Ui?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:o.COMPRESSED_RGBA_ASTC_10x5_KHR;if(i===pB)return r===Ui?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:o.COMPRESSED_RGBA_ASTC_10x6_KHR;if(i===bB)return r===Ui?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:o.COMPRESSED_RGBA_ASTC_10x8_KHR;if(i===vB)return r===Ui?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:o.COMPRESSED_RGBA_ASTC_10x10_KHR;if(i===yB)return r===Ui?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:o.COMPRESSED_RGBA_ASTC_12x10_KHR;if(i===BB)return r===Ui?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:o.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(i===sp||i===GB||i===SB)if(o=e.get("EXT_texture_compression_bptc"),o!==null){if(i===sp)return r===Ui?o.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:o.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(i===GB)return o.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(i===SB)return o.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(i===tx||i===wB||i===RB||i===ZB)if(o=e.get("EXT_texture_compression_rgtc"),o!==null){if(i===sp)return o.COMPRESSED_RED_RGTC1_EXT;if(i===wB)return o.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(i===RB)return o.COMPRESSED_RED_GREEN_RGTC2_EXT;if(i===ZB)return o.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return i===bf?n.UNSIGNED_INT_24_8:n[i]!==void 0?n[i]:null}return{convert:t}}const W8=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,V8=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class N8{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t,i){if(this.texture===null){const a=new Fi,o=e.properties.get(a);o.__webglTexture=t.texture,(t.depthNear!==i.depthNear||t.depthFar!==i.depthFar)&&(this.depthNear=t.depthNear,this.depthFar=t.depthFar),this.texture=a}}getMesh(e){if(this.texture!==null&&this.mesh===null){const t=e.cameras[0].viewport,i=new Ur({vertexShader:W8,fragmentShader:V8,uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new $i(new pc(20,20),i)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class E8 extends pg{constructor(e,t){super();const i=this;let a=null,o=1,r=null,s="local-floor",l=1,c=null,u=null,C=null,h=null,m=null,p=null;const B=new N8,b=t.getContextAttributes();let y=null,S=null;const R=[],Z=[],x=new Xt;let M=null;const E=new fa;E.viewport=new yi;const F=new fa;F.viewport=new yi;const N=[E,F],H=new GX;let z=null,_=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(k){let ie=R[k];return ie===void 0&&(ie=new By,R[k]=ie),ie.getTargetRaySpace()},this.getControllerGrip=function(k){let ie=R[k];return ie===void 0&&(ie=new By,R[k]=ie),ie.getGripSpace()},this.getHand=function(k){let ie=R[k];return ie===void 0&&(ie=new By,R[k]=ie),ie.getHandSpace()};function D(k){const ie=Z.indexOf(k.inputSource);if(ie===-1)return;const re=R[ie];re!==void 0&&(re.update(k.inputSource,k.frame,c||r),re.dispatchEvent({type:k.type,data:k.inputSource}))}function P(){a.removeEventListener("select",D),a.removeEventListener("selectstart",D),a.removeEventListener("selectend",D),a.removeEventListener("squeeze",D),a.removeEventListener("squeezestart",D),a.removeEventListener("squeezeend",D),a.removeEventListener("end",P),a.removeEventListener("inputsourceschange",$);for(let k=0;k<R.length;k++){const ie=Z[k];ie!==null&&(Z[k]=null,R[k].disconnect(ie))}z=null,_=null,B.reset(),e.setRenderTarget(y),m=null,h=null,C=null,a=null,S=null,ne.stop(),i.isPresenting=!1,e.setPixelRatio(M),e.setSize(x.width,x.height,!1),i.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(k){o=k,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(k){s=k,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return c||r},this.setReferenceSpace=function(k){c=k},this.getBaseLayer=function(){return h!==null?h:m},this.getBinding=function(){return C},this.getFrame=function(){return p},this.getSession=function(){return a},this.setSession=async function(k){if(a=k,a!==null){if(y=e.getRenderTarget(),a.addEventListener("select",D),a.addEventListener("selectstart",D),a.addEventListener("selectend",D),a.addEventListener("squeeze",D),a.addEventListener("squeezestart",D),a.addEventListener("squeezeend",D),a.addEventListener("end",P),a.addEventListener("inputsourceschange",$),b.xrCompatible!==!0&&await t.makeXRCompatible(),M=e.getPixelRatio(),e.getSize(x),typeof XRWebGLBinding<"u"&&"createProjectionLayer"in XRWebGLBinding.prototype){let re=null,ge=null,de=null;b.depth&&(de=b.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,re=b.stencil?yf:vf,ge=b.stencil?bf:Ig);const xe={colorFormat:t.RGBA8,depthFormat:de,scaleFactor:o};C=new XRWebGLBinding(a,t),h=C.createProjectionLayer(xe),a.updateRenderState({layers:[h]}),e.setPixelRatio(1),e.setSize(h.textureWidth,h.textureHeight,!1),S=new Us(h.textureWidth,h.textureHeight,{format:La,type:vs,depthTexture:new xG(h.textureWidth,h.textureHeight,ge,void 0,void 0,void 0,void 0,void 0,void 0,re),stencilBuffer:b.stencil,colorSpace:e.outputColorSpace,samples:b.antialias?4:0,resolveDepthBuffer:h.ignoreDepthValues===!1,resolveStencilBuffer:h.ignoreDepthValues===!1})}else{const re={antialias:b.antialias,alpha:!0,depth:b.depth,stencil:b.stencil,framebufferScaleFactor:o};m=new XRWebGLLayer(a,t,re),a.updateRenderState({baseLayer:m}),e.setPixelRatio(1),e.setSize(m.framebufferWidth,m.framebufferHeight,!1),S=new Us(m.framebufferWidth,m.framebufferHeight,{format:La,type:vs,colorSpace:e.outputColorSpace,stencilBuffer:b.stencil,resolveDepthBuffer:m.ignoreDepthValues===!1,resolveStencilBuffer:m.ignoreDepthValues===!1})}S.isXRRenderTarget=!0,this.setFoveation(l),c=null,r=await a.requestReferenceSpace(s),ne.setContext(a),ne.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(a!==null)return a.environmentBlendMode},this.getDepthTexture=function(){return B.getDepthTexture()};function $(k){for(let ie=0;ie<k.removed.length;ie++){const re=k.removed[ie],ge=Z.indexOf(re);ge>=0&&(Z[ge]=null,R[ge].disconnect(re))}for(let ie=0;ie<k.added.length;ie++){const re=k.added[ie];let ge=Z.indexOf(re);if(ge===-1){for(let xe=0;xe<R.length;xe++)if(xe>=Z.length){Z.push(re),ge=xe;break}else if(Z[xe]===null){Z[xe]=re,ge=xe;break}if(ge===-1)break}const de=R[ge];de&&de.connect(re)}}const X=new Be,L=new Be;function U(k,ie,re){X.setFromMatrixPosition(ie.matrixWorld),L.setFromMatrixPosition(re.matrixWorld);const ge=X.distanceTo(L),de=ie.projectionMatrix.elements,xe=re.projectionMatrix.elements,Ne=de[14]/(de[10]-1),ye=de[14]/(de[10]+1),pe=(de[9]+1)/de[5],Te=(de[9]-1)/de[5],le=(de[8]-1)/de[0],Ye=(xe[8]+1)/xe[0],he=Ne*le,Ge=Ne*Ye,be=ge/(-le+Ye),Ee=be*-le;if(ie.matrixWorld.decompose(k.position,k.quaternion,k.scale),k.translateX(Ee),k.translateZ(be),k.matrixWorld.compose(k.position,k.quaternion,k.scale),k.matrixWorldInverse.copy(k.matrixWorld).invert(),de[10]===-1)k.projectionMatrix.copy(ie.projectionMatrix),k.projectionMatrixInverse.copy(ie.projectionMatrixInverse);else{const Se=Ne+be,ee=ye+be,Q=he-Ee,ce=Ge+(ge-Ee),me=pe*ye/ee*Se,Ze=Te*ye/ee*Se;k.projectionMatrix.makePerspective(Q,ce,me,Ze,Se,ee),k.projectionMatrixInverse.copy(k.projectionMatrix).invert()}}function q(k,ie){ie===null?k.matrixWorld.copy(k.matrix):k.matrixWorld.multiplyMatrices(ie.matrixWorld,k.matrix),k.matrixWorldInverse.copy(k.matrixWorld).invert()}this.updateCamera=function(k){if(a===null)return;let ie=k.near,re=k.far;B.texture!==null&&(B.depthNear>0&&(ie=B.depthNear),B.depthFar>0&&(re=B.depthFar)),H.near=F.near=E.near=ie,H.far=F.far=E.far=re,(z!==H.near||_!==H.far)&&(a.updateRenderState({depthNear:H.near,depthFar:H.far}),z=H.near,_=H.far),E.layers.mask=k.layers.mask|2,F.layers.mask=k.layers.mask|4,H.layers.mask=E.layers.mask|F.layers.mask;const ge=k.parent,de=H.cameras;q(H,ge);for(let xe=0;xe<de.length;xe++)q(de[xe],ge);de.length===2?U(H,E,F):H.projectionMatrix.copy(E.projectionMatrix),K(k,H,ge)};function K(k,ie,re){re===null?k.matrix.copy(ie.matrixWorld):(k.matrix.copy(re.matrixWorld),k.matrix.invert(),k.matrix.multiply(ie.matrixWorld)),k.matrix.decompose(k.position,k.quaternion,k.scale),k.updateMatrixWorld(!0),k.projectionMatrix.copy(ie.projectionMatrix),k.projectionMatrixInverse.copy(ie.projectionMatrixInverse),k.isPerspectiveCamera&&(k.fov=Sf*2*Math.atan(1/k.projectionMatrix.elements[5]),k.zoom=1)}this.getCamera=function(){return H},this.getFoveation=function(){if(!(h===null&&m===null))return l},this.setFoveation=function(k){l=k,h!==null&&(h.fixedFoveation=k),m!==null&&m.fixedFoveation!==void 0&&(m.fixedFoveation=k)},this.hasDepthSensing=function(){return B.texture!==null},this.getDepthSensingMesh=function(){return B.getMesh(H)};let O=null;function j(k,ie){if(u=ie.getViewerPose(c||r),p=ie,u!==null){const re=u.views;m!==null&&(e.setRenderTargetFramebuffer(S,m.framebuffer),e.setRenderTarget(S));let ge=!1;re.length!==H.cameras.length&&(H.cameras.length=0,ge=!0);for(let Ne=0;Ne<re.length;Ne++){const ye=re[Ne];let pe=null;if(m!==null)pe=m.getViewport(ye);else{const le=C.getViewSubImage(h,ye);pe=le.viewport,Ne===0&&(e.setRenderTargetTextures(S,le.colorTexture,le.depthStencilTexture),e.setRenderTarget(S))}let Te=N[Ne];Te===void 0&&(Te=new fa,Te.layers.enable(Ne),Te.viewport=new yi,N[Ne]=Te),Te.matrix.fromArray(ye.transform.matrix),Te.matrix.decompose(Te.position,Te.quaternion,Te.scale),Te.projectionMatrix.fromArray(ye.projectionMatrix),Te.projectionMatrixInverse.copy(Te.projectionMatrix).invert(),Te.viewport.set(pe.x,pe.y,pe.width,pe.height),Ne===0&&(H.matrix.copy(Te.matrix),H.matrix.decompose(H.position,H.quaternion,H.scale)),ge===!0&&H.cameras.push(Te)}const de=a.enabledFeatures;if(de&&de.includes("depth-sensing")&&a.depthUsage=="gpu-optimized"&&C){const Ne=C.getDepthInformation(re[0]);Ne&&Ne.isValid&&Ne.texture&&B.init(e,Ne,a.renderState)}}for(let re=0;re<R.length;re++){const ge=Z[re],de=R[re];ge!==null&&de!==void 0&&de.update(ge,ie,c||r)}O&&O(k,ie),ie.detectedPlanes&&i.dispatchEvent({type:"planesdetected",data:ie}),p=null}const ne=new xX;ne.setAnimationLoop(j),this.setAnimationLoop=function(k){O=k},this.dispose=function(){}}}const ZC=new ys,H8=new Vn;function F8(n,e){function t(b,y){b.matrixAutoUpdate===!0&&b.updateMatrix(),y.value.copy(b.matrix)}function i(b,y){y.color.getRGB(b.fogColor.value,H9(n)),y.isFog?(b.fogNear.value=y.near,b.fogFar.value=y.far):y.isFogExp2&&(b.fogDensity.value=y.density)}function a(b,y,S,R,Z){y.isMeshBasicMaterial||y.isMeshLambertMaterial?o(b,y):y.isMeshToonMaterial?(o(b,y),C(b,y)):y.isMeshPhongMaterial?(o(b,y),u(b,y)):y.isMeshStandardMaterial?(o(b,y),h(b,y),y.isMeshPhysicalMaterial&&m(b,y,Z)):y.isMeshMatcapMaterial?(o(b,y),p(b,y)):y.isMeshDepthMaterial?o(b,y):y.isMeshDistanceMaterial?(o(b,y),B(b,y)):y.isMeshNormalMaterial?o(b,y):y.isLineBasicMaterial?(r(b,y),y.isLineDashedMaterial&&s(b,y)):y.isPointsMaterial?l(b,y,S,R):y.isSpriteMaterial?c(b,y):y.isShadowMaterial?(b.color.value.copy(y.color),b.opacity.value=y.opacity):y.isShaderMaterial&&(y.uniformsNeedUpdate=!1)}function o(b,y){b.opacity.value=y.opacity,y.color&&b.diffuse.value.copy(y.color),y.emissive&&b.emissive.value.copy(y.emissive).multiplyScalar(y.emissiveIntensity),y.map&&(b.map.value=y.map,t(y.map,b.mapTransform)),y.alphaMap&&(b.alphaMap.value=y.alphaMap,t(y.alphaMap,b.alphaMapTransform)),y.bumpMap&&(b.bumpMap.value=y.bumpMap,t(y.bumpMap,b.bumpMapTransform),b.bumpScale.value=y.bumpScale,y.side===fr&&(b.bumpScale.value*=-1)),y.normalMap&&(b.normalMap.value=y.normalMap,t(y.normalMap,b.normalMapTransform),b.normalScale.value.copy(y.normalScale),y.side===fr&&b.normalScale.value.negate()),y.displacementMap&&(b.displacementMap.value=y.displacementMap,t(y.displacementMap,b.displacementMapTransform),b.displacementScale.value=y.displacementScale,b.displacementBias.value=y.displacementBias),y.emissiveMap&&(b.emissiveMap.value=y.emissiveMap,t(y.emissiveMap,b.emissiveMapTransform)),y.specularMap&&(b.specularMap.value=y.specularMap,t(y.specularMap,b.specularMapTransform)),y.alphaTest>0&&(b.alphaTest.value=y.alphaTest);const S=e.get(y),R=S.envMap,Z=S.envMapRotation;R&&(b.envMap.value=R,ZC.copy(Z),ZC.x*=-1,ZC.y*=-1,ZC.z*=-1,R.isCubeTexture&&R.isRenderTargetTexture===!1&&(ZC.y*=-1,ZC.z*=-1),b.envMapRotation.value.setFromMatrix4(H8.makeRotationFromEuler(ZC)),b.flipEnvMap.value=R.isCubeTexture&&R.isRenderTargetTexture===!1?-1:1,b.reflectivity.value=y.reflectivity,b.ior.value=y.ior,b.refractionRatio.value=y.refractionRatio),y.lightMap&&(b.lightMap.value=y.lightMap,b.lightMapIntensity.value=y.lightMapIntensity,t(y.lightMap,b.lightMapTransform)),y.aoMap&&(b.aoMap.value=y.aoMap,b.aoMapIntensity.value=y.aoMapIntensity,t(y.aoMap,b.aoMapTransform))}function r(b,y){b.diffuse.value.copy(y.color),b.opacity.value=y.opacity,y.map&&(b.map.value=y.map,t(y.map,b.mapTransform))}function s(b,y){b.dashSize.value=y.dashSize,b.totalSize.value=y.dashSize+y.gapSize,b.scale.value=y.scale}function l(b,y,S,R){b.diffuse.value.copy(y.color),b.opacity.value=y.opacity,b.size.value=y.size*S,b.scale.value=R*.5,y.map&&(b.map.value=y.map,t(y.map,b.uvTransform)),y.alphaMap&&(b.alphaMap.value=y.alphaMap,t(y.alphaMap,b.alphaMapTransform)),y.alphaTest>0&&(b.alphaTest.value=y.alphaTest)}function c(b,y){b.diffuse.value.copy(y.color),b.opacity.value=y.opacity,b.rotation.value=y.rotation,y.map&&(b.map.value=y.map,t(y.map,b.mapTransform)),y.alphaMap&&(b.alphaMap.value=y.alphaMap,t(y.alphaMap,b.alphaMapTransform)),y.alphaTest>0&&(b.alphaTest.value=y.alphaTest)}function u(b,y){b.specular.value.copy(y.specular),b.shininess.value=Math.max(y.shininess,1e-4)}function C(b,y){y.gradientMap&&(b.gradientMap.value=y.gradientMap)}function h(b,y){b.metalness.value=y.metalness,y.metalnessMap&&(b.metalnessMap.value=y.metalnessMap,t(y.metalnessMap,b.metalnessMapTransform)),b.roughness.value=y.roughness,y.roughnessMap&&(b.roughnessMap.value=y.roughnessMap,t(y.roughnessMap,b.roughnessMapTransform)),y.envMap&&(b.envMapIntensity.value=y.envMapIntensity)}function m(b,y,S){b.ior.value=y.ior,y.sheen>0&&(b.sheenColor.value.copy(y.sheenColor).multiplyScalar(y.sheen),b.sheenRoughness.value=y.sheenRoughness,y.sheenColorMap&&(b.sheenColorMap.value=y.sheenColorMap,t(y.sheenColorMap,b.sheenColorMapTransform)),y.sheenRoughnessMap&&(b.sheenRoughnessMap.value=y.sheenRoughnessMap,t(y.sheenRoughnessMap,b.sheenRoughnessMapTransform))),y.clearcoat>0&&(b.clearcoat.value=y.clearcoat,b.clearcoatRoughness.value=y.clearcoatRoughness,y.clearcoatMap&&(b.clearcoatMap.value=y.clearcoatMap,t(y.clearcoatMap,b.clearcoatMapTransform)),y.clearcoatRoughnessMap&&(b.clearcoatRoughnessMap.value=y.clearcoatRoughnessMap,t(y.clearcoatRoughnessMap,b.clearcoatRoughnessMapTransform)),y.clearcoatNormalMap&&(b.clearcoatNormalMap.value=y.clearcoatNormalMap,t(y.clearcoatNormalMap,b.clearcoatNormalMapTransform),b.clearcoatNormalScale.value.copy(y.clearcoatNormalScale),y.side===fr&&b.clearcoatNormalScale.value.negate())),y.dispersion>0&&(b.dispersion.value=y.dispersion),y.iridescence>0&&(b.iridescence.value=y.iridescence,b.iridescenceIOR.value=y.iridescenceIOR,b.iridescenceThicknessMinimum.value=y.iridescenceThicknessRange[0],b.iridescenceThicknessMaximum.value=y.iridescenceThicknessRange[1],y.iridescenceMap&&(b.iridescenceMap.value=y.iridescenceMap,t(y.iridescenceMap,b.iridescenceMapTransform)),y.iridescenceThicknessMap&&(b.iridescenceThicknessMap.value=y.iridescenceThicknessMap,t(y.iridescenceThicknessMap,b.iridescenceThicknessMapTransform))),y.transmission>0&&(b.transmission.value=y.transmission,b.transmissionSamplerMap.value=S.texture,b.transmissionSamplerSize.value.set(S.width,S.height),y.transmissionMap&&(b.transmissionMap.value=y.transmissionMap,t(y.transmissionMap,b.transmissionMapTransform)),b.thickness.value=y.thickness,y.thicknessMap&&(b.thicknessMap.value=y.thicknessMap,t(y.thicknessMap,b.thicknessMapTransform)),b.attenuationDistance.value=y.attenuationDistance,b.attenuationColor.value.copy(y.attenuationColor)),y.anisotropy>0&&(b.anisotropyVector.value.set(y.anisotropy*Math.cos(y.anisotropyRotation),y.anisotropy*Math.sin(y.anisotropyRotation)),y.anisotropyMap&&(b.anisotropyMap.value=y.anisotropyMap,t(y.anisotropyMap,b.anisotropyMapTransform))),b.specularIntensity.value=y.specularIntensity,b.specularColor.value.copy(y.specularColor),y.specularColorMap&&(b.specularColorMap.value=y.specularColorMap,t(y.specularColorMap,b.specularColorMapTransform)),y.specularIntensityMap&&(b.specularIntensityMap.value=y.specularIntensityMap,t(y.specularIntensityMap,b.specularIntensityMapTransform))}function p(b,y){y.matcap&&(b.matcap.value=y.matcap)}function B(b,y){const S=e.get(y).light;b.referencePosition.value.setFromMatrixPosition(S.matrixWorld),b.nearDistance.value=S.shadow.camera.near,b.farDistance.value=S.shadow.camera.far}return{refreshFogUniforms:i,refreshMaterialUniforms:a}}function X8(n,e,t,i){let a={},o={},r=[];const s=n.getParameter(n.MAX_UNIFORM_BUFFER_BINDINGS);function l(S,R){const Z=R.program;i.uniformBlockBinding(S,Z)}function c(S,R){let Z=a[S.id];Z===void 0&&(p(S),Z=u(S),a[S.id]=Z,S.addEventListener("dispose",b));const x=R.program;i.updateUBOMapping(S,x);const M=e.render.frame;o[S.id]!==M&&(h(S),o[S.id]=M)}function u(S){const R=C();S.__bindingPointIndex=R;const Z=n.createBuffer(),x=S.__size,M=S.usage;return n.bindBuffer(n.UNIFORM_BUFFER,Z),n.bufferData(n.UNIFORM_BUFFER,x,M),n.bindBuffer(n.UNIFORM_BUFFER,null),n.bindBufferBase(n.UNIFORM_BUFFER,R,Z),Z}function C(){for(let S=0;S<s;S++)if(r.indexOf(S)===-1)return r.push(S),S;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function h(S){const R=a[S.id],Z=S.uniforms,x=S.__cache;n.bindBuffer(n.UNIFORM_BUFFER,R);for(let M=0,E=Z.length;M<E;M++){const F=Array.isArray(Z[M])?Z[M]:[Z[M]];for(let N=0,H=F.length;N<H;N++){const z=F[N];if(m(z,M,N,x)===!0){const _=z.__offset,D=Array.isArray(z.value)?z.value:[z.value];let P=0;for(let $=0;$<D.length;$++){const X=D[$],L=B(X);typeof X=="number"||typeof X=="boolean"?(z.__data[0]=X,n.bufferSubData(n.UNIFORM_BUFFER,_+P,z.__data)):X.isMatrix3?(z.__data[0]=X.elements[0],z.__data[1]=X.elements[1],z.__data[2]=X.elements[2],z.__data[3]=0,z.__data[4]=X.elements[3],z.__data[5]=X.elements[4],z.__data[6]=X.elements[5],z.__data[7]=0,z.__data[8]=X.elements[6],z.__data[9]=X.elements[7],z.__data[10]=X.elements[8],z.__data[11]=0):(X.toArray(z.__data,P),P+=L.storage/Float32Array.BYTES_PER_ELEMENT)}n.bufferSubData(n.UNIFORM_BUFFER,_,z.__data)}}}n.bindBuffer(n.UNIFORM_BUFFER,null)}function m(S,R,Z,x){const M=S.value,E=R+"_"+Z;if(x[E]===void 0)return typeof M=="number"||typeof M=="boolean"?x[E]=M:x[E]=M.clone(),!0;{const F=x[E];if(typeof M=="number"||typeof M=="boolean"){if(F!==M)return x[E]=M,!0}else if(F.equals(M)===!1)return F.copy(M),!0}return!1}function p(S){const R=S.uniforms;let Z=0;const x=16;for(let E=0,F=R.length;E<F;E++){const N=Array.isArray(R[E])?R[E]:[R[E]];for(let H=0,z=N.length;H<z;H++){const _=N[H],D=Array.isArray(_.value)?_.value:[_.value];for(let P=0,$=D.length;P<$;P++){const X=D[P],L=B(X),U=Z%x,q=U%L.boundary,K=U+q;Z+=q,K!==0&&x-K<L.storage&&(Z+=x-K),_.__data=new Float32Array(L.storage/Float32Array.BYTES_PER_ELEMENT),_.__offset=Z,Z+=L.storage}}}const M=Z%x;return M>0&&(Z+=x-M),S.__size=Z,S.__cache={},this}function B(S){const R={boundary:0,storage:0};return typeof S=="number"||typeof S=="boolean"?(R.boundary=4,R.storage=4):S.isVector2?(R.boundary=8,R.storage=8):S.isVector3||S.isColor?(R.boundary=16,R.storage=12):S.isVector4?(R.boundary=16,R.storage=16):S.isMatrix3?(R.boundary=48,R.storage=48):S.isMatrix4?(R.boundary=64,R.storage=64):S.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",S),R}function b(S){const R=S.target;R.removeEventListener("dispose",b);const Z=r.indexOf(R.__bindingPointIndex);r.splice(Z,1),n.deleteBuffer(a[R.id]),delete a[R.id],delete o[R.id]}function y(){for(const S in a)n.deleteBuffer(a[S]);r=[],a={},o={}}return{bind:l,update:c,dispose:y}}class Tx{constructor(e={}){const{canvas:t=V9(),context:i=null,depth:a=!0,stencil:o=!1,alpha:r=!1,antialias:s=!1,premultipliedAlpha:l=!0,preserveDrawingBuffer:c=!1,powerPreference:u="default",failIfMajorPerformanceCaveat:C=!1,reverseDepthBuffer:h=!1}=e;this.isWebGLRenderer=!0;let m;if(i!==null){if(typeof WebGLRenderingContext<"u"&&i instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");m=i.getContextAttributes().alpha}else m=r;const p=new Uint32Array(4),B=new Int32Array(4);let b=null,y=null;const S=[],R=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=lg,this.toneMappingExposure=1,this.transmissionResolutionScale=1;const Z=this;let x=!1;this._outputColorSpace=Uo;let M=0,E=0,F=null,N=-1,H=null;const z=new yi,_=new yi;let D=null;const P=new dn(0);let $=0,X=t.width,L=t.height,U=1,q=null,K=null;const O=new yi(0,0,X,L),j=new yi(0,0,X,L);let ne=!1;const k=new cb;let ie=!1,re=!1;const ge=new Vn,de=new Vn,xe=new Be,Ne=new yi,ye={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let pe=!1;function Te(){return F===null?U:1}let le=i;function Ye(te,Ie){return t.getContext(te,Ie)}try{const te={alpha:!0,depth:a,stencil:o,antialias:s,premultipliedAlpha:l,preserveDrawingBuffer:c,powerPreference:u,failIfMajorPerformanceCaveat:C};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${eb}`),t.addEventListener("webglcontextlost",ut,!1),t.addEventListener("webglcontextrestored",Rt,!1),t.addEventListener("webglcontextcreationerror",mt,!1),le===null){const Ie="webgl2";if(le=Ye(Ie,te),le===null)throw Ye(Ie)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(te){throw console.error("THREE.WebGLRenderer: "+te.message),te}let he,Ge,be,Ee,Se,ee,Q,ce,me,Ze,Xe,De,Oe,Je,At,qe,lt,$e,je,ke,Ce,He,ht,we;function ze(){he=new JQ(le),he.init(),He=new EX(le,he),Ge=new LQ(le,he,e,He),be=new x8(le,he),Ge.reverseDepthBuffer&&h&&be.buffers.depth.setReversed(!0),Ee=new qQ(le),Se=new f8,ee=new M8(le,he,be,Se,Ge,He,Ee),Q=new DQ(Z),ce=new PQ(Z),me=new a4(le),ht=new zQ(le,me),Ze=new jQ(le,me,Ee,ht),Xe=new e7(le,Ze,me,Ee),je=new $Q(le,Ge,ee),qe=new _Q(Se),De=new h8(Z,Q,ce,he,Ge,ht,qe),Oe=new F8(Z,Se),Je=new m8,At=new G8(he),$e=new YQ(Z,Q,ce,be,Xe,m,l),lt=new R8(Z,Xe,Ge),we=new X8(le,Ee,Ge,be),ke=new KQ(le,he,Ee),Ce=new QQ(le,he,Ee),Ee.programs=De.programs,Z.capabilities=Ge,Z.extensions=he,Z.properties=Se,Z.renderLists=Je,Z.shadowMap=lt,Z.state=be,Z.info=Ee}ze();const Qe=new E8(Z,le);this.xr=Qe,this.getContext=function(){return le},this.getContextAttributes=function(){return le.getContextAttributes()},this.forceContextLoss=function(){const te=he.get("WEBGL_lose_context");te&&te.loseContext()},this.forceContextRestore=function(){const te=he.get("WEBGL_lose_context");te&&te.restoreContext()},this.getPixelRatio=function(){return U},this.setPixelRatio=function(te){te!==void 0&&(U=te,this.setSize(X,L,!1))},this.getSize=function(te){return te.set(X,L)},this.setSize=function(te,Ie,Ae=!0){if(Qe.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}X=te,L=Ie,t.width=Math.floor(te*U),t.height=Math.floor(Ie*U),Ae===!0&&(t.style.width=te+"px",t.style.height=Ie+"px"),this.setViewport(0,0,te,Ie)},this.getDrawingBufferSize=function(te){return te.set(X*U,L*U).floor()},this.setDrawingBufferSize=function(te,Ie,Ae){X=te,L=Ie,U=Ae,t.width=Math.floor(te*Ae),t.height=Math.floor(Ie*Ae),this.setViewport(0,0,te,Ie)},this.getCurrentViewport=function(te){return te.copy(z)},this.getViewport=function(te){return te.copy(O)},this.setViewport=function(te,Ie,Ae,se){te.isVector4?O.set(te.x,te.y,te.z,te.w):O.set(te,Ie,Ae,se),be.viewport(z.copy(O).multiplyScalar(U).round())},this.getScissor=function(te){return te.copy(j)},this.setScissor=function(te,Ie,Ae,se){te.isVector4?j.set(te.x,te.y,te.z,te.w):j.set(te,Ie,Ae,se),be.scissor(_.copy(j).multiplyScalar(U).round())},this.getScissorTest=function(){return ne},this.setScissorTest=function(te){be.setScissorTest(ne=te)},this.setOpaqueSort=function(te){q=te},this.setTransparentSort=function(te){K=te},this.getClearColor=function(te){return te.copy($e.getClearColor())},this.setClearColor=function(){$e.setClearColor(...arguments)},this.getClearAlpha=function(){return $e.getClearAlpha()},this.setClearAlpha=function(){$e.setClearAlpha(...arguments)},this.clear=function(te=!0,Ie=!0,Ae=!0){let se=0;if(te){let Re=!1;if(F!==null){const Ue=F.texture.format;Re=Ue===mG||Ue===AG||Ue===ab}if(Re){const Ue=F.texture.type,nt=Ue===vs||Ue===Ig||Ue===pf||Ue===bf||Ue===hG||Ue===fG,pt=$e.getClearColor(),it=$e.getClearAlpha(),Bt=pt.r,Mt=pt.g,Yt=pt.b;nt?(p[0]=Bt,p[1]=Mt,p[2]=Yt,p[3]=it,le.clearBufferuiv(le.COLOR,0,p)):(B[0]=Bt,B[1]=Mt,B[2]=Yt,B[3]=it,le.clearBufferiv(le.COLOR,0,B))}else se|=le.COLOR_BUFFER_BIT}Ie&&(se|=le.DEPTH_BUFFER_BIT),Ae&&(se|=le.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),le.clear(se)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",ut,!1),t.removeEventListener("webglcontextrestored",Rt,!1),t.removeEventListener("webglcontextcreationerror",mt,!1),$e.dispose(),Je.dispose(),At.dispose(),Se.dispose(),Q.dispose(),ce.dispose(),Xe.dispose(),ht.dispose(),we.dispose(),De.dispose(),Qe.dispose(),Qe.removeEventListener("sessionstart",Ut),Qe.removeEventListener("sessionend",Nt),Tt.stop()};function ut(te){te.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),x=!0}function Rt(){console.log("THREE.WebGLRenderer: Context Restored."),x=!1;const te=Ee.autoReset,Ie=lt.enabled,Ae=lt.autoUpdate,se=lt.needsUpdate,Re=lt.type;ze(),Ee.autoReset=te,lt.enabled=Ie,lt.autoUpdate=Ae,lt.needsUpdate=se,lt.type=Re}function mt(te){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",te.statusMessage)}function _t(te){const Ie=te.target;Ie.removeEventListener("dispose",_t),Lt(Ie)}function Lt(te){Zt(te),Se.remove(te)}function Zt(te){const Ie=Se.get(te).programs;Ie!==void 0&&(Ie.forEach(function(Ae){De.releaseProgram(Ae)}),te.isShaderMaterial&&De.releaseShaderCache(te))}this.renderBufferDirect=function(te,Ie,Ae,se,Re,Ue){Ie===null&&(Ie=ye);const nt=Re.isMesh&&Re.matrixWorld.determinant()<0,pt=Fe(te,Ie,Ae,se,Re);be.setMaterial(se,nt);let it=Ae.index,Bt=1;if(se.wireframe===!0){if(it=Ze.getWireframeAttribute(Ae),it===void 0)return;Bt=2}const Mt=Ae.drawRange,Yt=Ae.attributes.position;let ln=Mt.start*Bt,on=(Mt.start+Mt.count)*Bt;Ue!==null&&(ln=Math.max(ln,Ue.start*Bt),on=Math.min(on,(Ue.start+Ue.count)*Bt)),it!==null?(ln=Math.max(ln,0),on=Math.min(on,it.count)):Yt!=null&&(ln=Math.max(ln,0),on=Math.min(on,Yt.count));const vn=on-ln;if(vn<0||vn===1/0)return;ht.setup(Re,se,pt,Ae,it);let nn,mn=ke;if(it!==null&&(nn=me.get(it),mn=Ce,mn.setIndex(nn)),Re.isMesh)se.wireframe===!0?(be.setLineWidth(se.wireframeLinewidth*Te()),mn.setMode(le.LINES)):mn.setMode(le.TRIANGLES);else if(Re.isLine){let gn=se.linewidth;gn===void 0&&(gn=1),be.setLineWidth(gn*Te()),Re.isLineSegments?mn.setMode(le.LINES):Re.isLineLoop?mn.setMode(le.LINE_LOOP):mn.setMode(le.LINE_STRIP)}else Re.isPoints?mn.setMode(le.POINTS):Re.isSprite&&mn.setMode(le.TRIANGLES);if(Re.isBatchedMesh)if(Re._multiDrawInstances!==null)yy("THREE.WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),mn.renderMultiDrawInstances(Re._multiDrawStarts,Re._multiDrawCounts,Re._multiDrawCount,Re._multiDrawInstances);else if(he.get("WEBGL_multi_draw"))mn.renderMultiDraw(Re._multiDrawStarts,Re._multiDrawCounts,Re._multiDrawCount);else{const gn=Re._multiDrawStarts,Xn=Re._multiDrawCounts,bn=Re._multiDrawCount,cn=it?me.get(it).bytesPerElement:1,Jt=Se.get(se).currentProgram.getUniforms();for(let Et=0;Et<bn;Et++)Jt.setValue(le,"_gl_DrawID",Et),mn.render(gn[Et]/cn,Xn[Et])}else if(Re.isInstancedMesh)mn.renderInstances(ln,vn,Re.count);else if(Ae.isInstancedBufferGeometry){const gn=Ae._maxInstanceCount!==void 0?Ae._maxInstanceCount:1/0,Xn=Math.min(Ae.instanceCount,gn);mn.renderInstances(ln,vn,Xn)}else mn.render(ln,vn)};function yt(te,Ie,Ae){te.transparent===!0&&te.side===ms&&te.forceSinglePass===!1?(te.side=fr,te.needsUpdate=!0,sn(te,Ie,Ae),te.side=dg,te.needsUpdate=!0,sn(te,Ie,Ae),te.side=ms):sn(te,Ie,Ae)}this.compile=function(te,Ie,Ae=null){Ae===null&&(Ae=te),y=At.get(Ae),y.init(Ie),R.push(y),Ae.traverseVisible(function(Re){Re.isLight&&Re.layers.test(Ie.layers)&&(y.pushLight(Re),Re.castShadow&&y.pushShadow(Re))}),te!==Ae&&te.traverseVisible(function(Re){Re.isLight&&Re.layers.test(Ie.layers)&&(y.pushLight(Re),Re.castShadow&&y.pushShadow(Re))}),y.setupLights();const se=new Set;return te.traverse(function(Re){if(!(Re.isMesh||Re.isPoints||Re.isLine||Re.isSprite))return;const Ue=Re.material;if(Ue)if(Array.isArray(Ue))for(let nt=0;nt<Ue.length;nt++){const pt=Ue[nt];yt(pt,Ae,Re),se.add(pt)}else yt(Ue,Ae,Re),se.add(Ue)}),y=R.pop(),se},this.compileAsync=function(te,Ie,Ae=null){const se=this.compile(te,Ie,Ae);return new Promise(Re=>{function Ue(){if(se.forEach(function(nt){Se.get(nt).currentProgram.isReady()&&se.delete(nt)}),se.size===0){Re(te);return}setTimeout(Ue,10)}he.get("KHR_parallel_shader_compile")!==null?Ue():setTimeout(Ue,10)})};let Ht=null;function jt(te){Ht&&Ht(te)}function Ut(){Tt.stop()}function Nt(){Tt.start()}const Tt=new xX;Tt.setAnimationLoop(jt),typeof self<"u"&&Tt.setContext(self),this.setAnimationLoop=function(te){Ht=te,Qe.setAnimationLoop(te),te===null?Tt.stop():Tt.start()},Qe.addEventListener("sessionstart",Ut),Qe.addEventListener("sessionend",Nt),this.render=function(te,Ie){if(Ie!==void 0&&Ie.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(x===!0)return;if(te.matrixWorldAutoUpdate===!0&&te.updateMatrixWorld(),Ie.parent===null&&Ie.matrixWorldAutoUpdate===!0&&Ie.updateMatrixWorld(),Qe.enabled===!0&&Qe.isPresenting===!0&&(Qe.cameraAutoUpdate===!0&&Qe.updateCamera(Ie),Ie=Qe.getCamera()),te.isScene===!0&&te.onBeforeRender(Z,te,Ie,F),y=At.get(te,R.length),y.init(Ie),R.push(y),de.multiplyMatrices(Ie.projectionMatrix,Ie.matrixWorldInverse),k.setFromProjectionMatrix(de),re=this.localClippingEnabled,ie=qe.init(this.clippingPlanes,re),b=Je.get(te,S.length),b.init(),S.push(b),Qe.enabled===!0&&Qe.isPresenting===!0){const Ue=Z.xr.getDepthSensingMesh();Ue!==null&&Pt(Ue,Ie,-1/0,Z.sortObjects)}Pt(te,Ie,0,Z.sortObjects),b.finish(),Z.sortObjects===!0&&b.sort(q,K),pe=Qe.enabled===!1||Qe.isPresenting===!1||Qe.hasDepthSensing()===!1,pe&&$e.addToRenderList(b,te),this.info.render.frame++,ie===!0&&qe.beginShadows();const Ae=y.state.shadowsArray;lt.render(Ae,te,Ie),ie===!0&&qe.endShadows(),this.info.autoReset===!0&&this.info.reset();const se=b.opaque,Re=b.transmissive;if(y.setupLights(),Ie.isArrayCamera){const Ue=Ie.cameras;if(Re.length>0)for(let nt=0,pt=Ue.length;nt<pt;nt++){const it=Ue[nt];kt(se,Re,te,it)}pe&&$e.render(te);for(let nt=0,pt=Ue.length;nt<pt;nt++){const it=Ue[nt];qt(b,te,it,it.viewport)}}else Re.length>0&&kt(se,Re,te,Ie),pe&&$e.render(te),qt(b,te,Ie);F!==null&&E===0&&(ee.updateMultisampleRenderTarget(F),ee.updateRenderTargetMipmap(F)),te.isScene===!0&&te.onAfterRender(Z,te,Ie),ht.resetDefaultState(),N=-1,H=null,R.pop(),R.length>0?(y=R[R.length-1],ie===!0&&qe.setGlobalState(Z.clippingPlanes,y.state.camera)):y=null,S.pop(),S.length>0?b=S[S.length-1]:b=null};function Pt(te,Ie,Ae,se){if(te.visible===!1)return;if(te.layers.test(Ie.layers)){if(te.isGroup)Ae=te.renderOrder;else if(te.isLOD)te.autoUpdate===!0&&te.update(Ie);else if(te.isLight)y.pushLight(te),te.castShadow&&y.pushShadow(te);else if(te.isSprite){if(!te.frustumCulled||k.intersectsSprite(te)){se&&Ne.setFromMatrixPosition(te.matrixWorld).applyMatrix4(de);const nt=Xe.update(te),pt=te.material;pt.visible&&b.push(te,nt,pt,Ae,Ne.z,null)}}else if((te.isMesh||te.isLine||te.isPoints)&&(!te.frustumCulled||k.intersectsObject(te))){const nt=Xe.update(te),pt=te.material;if(se&&(te.boundingSphere!==void 0?(te.boundingSphere===null&&te.computeBoundingSphere(),Ne.copy(te.boundingSphere.center)):(nt.boundingSphere===null&&nt.computeBoundingSphere(),Ne.copy(nt.boundingSphere.center)),Ne.applyMatrix4(te.matrixWorld).applyMatrix4(de)),Array.isArray(pt)){const it=nt.groups;for(let Bt=0,Mt=it.length;Bt<Mt;Bt++){const Yt=it[Bt],ln=pt[Yt.materialIndex];ln&&ln.visible&&b.push(te,nt,ln,Ae,Ne.z,Yt)}}else pt.visible&&b.push(te,nt,pt,Ae,Ne.z,null)}}const Ue=te.children;for(let nt=0,pt=Ue.length;nt<pt;nt++)Pt(Ue[nt],Ie,Ae,se)}function qt(te,Ie,Ae,se){const Re=te.opaque,Ue=te.transmissive,nt=te.transparent;y.setupLightsView(Ae),ie===!0&&qe.setGlobalState(Z.clippingPlanes,Ae),se&&be.viewport(z.copy(se)),Re.length>0&&Ft(Re,Ie,Ae),Ue.length>0&&Ft(Ue,Ie,Ae),nt.length>0&&Ft(nt,Ie,Ae),be.buffers.depth.setTest(!0),be.buffers.depth.setMask(!0),be.buffers.color.setMask(!0),be.setPolygonOffset(!1)}function kt(te,Ie,Ae,se){if((Ae.isScene===!0?Ae.overrideMaterial:null)!==null)return;y.state.transmissionRenderTarget[se.id]===void 0&&(y.state.transmissionRenderTarget[se.id]=new Us(1,1,{generateMipmaps:!0,type:he.has("EXT_color_buffer_half_float")||he.has("EXT_color_buffer_float")?Co:vs,minFilter:pl,samples:4,stencilBuffer:o,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:vi.workingColorSpace}));const Ue=y.state.transmissionRenderTarget[se.id],nt=se.viewport||z;Ue.setSize(nt.z*Z.transmissionResolutionScale,nt.w*Z.transmissionResolutionScale);const pt=Z.getRenderTarget();Z.setRenderTarget(Ue),Z.getClearColor(P),$=Z.getClearAlpha(),$<1&&Z.setClearColor(16777215,.5),Z.clear(),pe&&$e.render(Ae);const it=Z.toneMapping;Z.toneMapping=lg;const Bt=se.viewport;if(se.viewport!==void 0&&(se.viewport=void 0),y.setupLightsView(se),ie===!0&&qe.setGlobalState(Z.clippingPlanes,se),Ft(te,Ae,se),ee.updateMultisampleRenderTarget(Ue),ee.updateRenderTargetMipmap(Ue),he.has("WEBGL_multisampled_render_to_texture")===!1){let Mt=!1;for(let Yt=0,ln=Ie.length;Yt<ln;Yt++){const on=Ie[Yt],vn=on.object,nn=on.geometry,mn=on.material,gn=on.group;if(mn.side===ms&&vn.layers.test(se.layers)){const Xn=mn.side;mn.side=fr,mn.needsUpdate=!0,fn(vn,Ae,se,nn,mn,gn),mn.side=Xn,mn.needsUpdate=!0,Mt=!0}}Mt===!0&&(ee.updateMultisampleRenderTarget(Ue),ee.updateRenderTargetMipmap(Ue))}Z.setRenderTarget(pt),Z.setClearColor(P,$),Bt!==void 0&&(se.viewport=Bt),Z.toneMapping=it}function Ft(te,Ie,Ae){const se=Ie.isScene===!0?Ie.overrideMaterial:null;for(let Re=0,Ue=te.length;Re<Ue;Re++){const nt=te[Re],pt=nt.object,it=nt.geometry,Bt=nt.group;let Mt=nt.material;Mt.allowOverride===!0&&se!==null&&(Mt=se),pt.layers.test(Ae.layers)&&fn(pt,Ie,Ae,it,Mt,Bt)}}function fn(te,Ie,Ae,se,Re,Ue){te.onBeforeRender(Z,Ie,Ae,se,Re,Ue),te.modelViewMatrix.multiplyMatrices(Ae.matrixWorldInverse,te.matrixWorld),te.normalMatrix.getNormalMatrix(te.modelViewMatrix),Re.onBeforeRender(Z,Ie,Ae,se,te,Ue),Re.transparent===!0&&Re.side===ms&&Re.forceSinglePass===!1?(Re.side=fr,Re.needsUpdate=!0,Z.renderBufferDirect(Ae,Ie,se,Re,te,Ue),Re.side=dg,Re.needsUpdate=!0,Z.renderBufferDirect(Ae,Ie,se,Re,te,Ue),Re.side=ms):Z.renderBufferDirect(Ae,Ie,se,Re,te,Ue),te.onAfterRender(Z,Ie,Ae,se,Re,Ue)}function sn(te,Ie,Ae){Ie.isScene!==!0&&(Ie=ye);const se=Se.get(te),Re=y.state.lights,Ue=y.state.shadowsArray,nt=Re.state.version,pt=De.getParameters(te,Re.state,Ue,Ie,Ae),it=De.getProgramCacheKey(pt);let Bt=se.programs;se.environment=te.isMeshStandardMaterial?Ie.environment:null,se.fog=Ie.fog,se.envMap=(te.isMeshStandardMaterial?ce:Q).get(te.envMap||se.environment),se.envMapRotation=se.environment!==null&&te.envMap===null?Ie.environmentRotation:te.envMapRotation,Bt===void 0&&(te.addEventListener("dispose",_t),Bt=new Map,se.programs=Bt);let Mt=Bt.get(it);if(Mt!==void 0){if(se.currentProgram===Mt&&se.lightsStateVersion===nt)return ue(te,pt),Mt}else pt.uniforms=De.getUniforms(te),te.onBeforeCompile(pt,Z),Mt=De.acquireProgram(pt,it),Bt.set(it,Mt),se.uniforms=pt.uniforms;const Yt=se.uniforms;return(!te.isShaderMaterial&&!te.isRawShaderMaterial||te.clipping===!0)&&(Yt.clippingPlanes=qe.uniform),ue(te,pt),se.needsLights=at(te),se.lightsStateVersion=nt,se.needsLights&&(Yt.ambientLightColor.value=Re.state.ambient,Yt.lightProbe.value=Re.state.probe,Yt.directionalLights.value=Re.state.directional,Yt.directionalLightShadows.value=Re.state.directionalShadow,Yt.spotLights.value=Re.state.spot,Yt.spotLightShadows.value=Re.state.spotShadow,Yt.rectAreaLights.value=Re.state.rectArea,Yt.ltc_1.value=Re.state.rectAreaLTC1,Yt.ltc_2.value=Re.state.rectAreaLTC2,Yt.pointLights.value=Re.state.point,Yt.pointLightShadows.value=Re.state.pointShadow,Yt.hemisphereLights.value=Re.state.hemi,Yt.directionalShadowMap.value=Re.state.directionalShadowMap,Yt.directionalShadowMatrix.value=Re.state.directionalShadowMatrix,Yt.spotShadowMap.value=Re.state.spotShadowMap,Yt.spotLightMatrix.value=Re.state.spotLightMatrix,Yt.spotLightMap.value=Re.state.spotLightMap,Yt.pointShadowMap.value=Re.state.pointShadowMap,Yt.pointShadowMatrix.value=Re.state.pointShadowMatrix),se.currentProgram=Mt,se.uniformsList=null,Mt}function ae(te){if(te.uniformsList===null){const Ie=te.currentProgram.getUniforms();te.uniformsList=Gy.seqWithValue(Ie.seq,te.uniforms)}return te.uniformsList}function ue(te,Ie){const Ae=Se.get(te);Ae.outputColorSpace=Ie.outputColorSpace,Ae.batching=Ie.batching,Ae.batchingColor=Ie.batchingColor,Ae.instancing=Ie.instancing,Ae.instancingColor=Ie.instancingColor,Ae.instancingMorph=Ie.instancingMorph,Ae.skinning=Ie.skinning,Ae.morphTargets=Ie.morphTargets,Ae.morphNormals=Ie.morphNormals,Ae.morphColors=Ie.morphColors,Ae.morphTargetsCount=Ie.morphTargetsCount,Ae.numClippingPlanes=Ie.numClippingPlanes,Ae.numIntersection=Ie.numClipIntersection,Ae.vertexAlphas=Ie.vertexAlphas,Ae.vertexTangents=Ie.vertexTangents,Ae.toneMapping=Ie.toneMapping}function Fe(te,Ie,Ae,se,Re){Ie.isScene!==!0&&(Ie=ye),ee.resetTextureUnits();const Ue=Ie.fog,nt=se.isMeshStandardMaterial?Ie.environment:null,pt=F===null?Z.outputColorSpace:F.isXRRenderTarget===!0?F.texture.colorSpace:Cc,it=(se.isMeshStandardMaterial?ce:Q).get(se.envMap||nt),Bt=se.vertexColors===!0&&!!Ae.attributes.color&&Ae.attributes.color.itemSize===4,Mt=!!Ae.attributes.tangent&&(!!se.normalMap||se.anisotropy>0),Yt=!!Ae.morphAttributes.position,ln=!!Ae.morphAttributes.normal,on=!!Ae.morphAttributes.color;let vn=lg;se.toneMapped&&(F===null||F.isXRRenderTarget===!0)&&(vn=Z.toneMapping);const nn=Ae.morphAttributes.position||Ae.morphAttributes.normal||Ae.morphAttributes.color,mn=nn!==void 0?nn.length:0,gn=Se.get(se),Xn=y.state.lights;if(ie===!0&&(re===!0||te!==H)){const Kn=te===H&&se.id===N;qe.setState(se,te,Kn)}let bn=!1;se.version===gn.__version?(gn.needsLights&&gn.lightsStateVersion!==Xn.state.version||gn.outputColorSpace!==pt||Re.isBatchedMesh&&gn.batching===!1||!Re.isBatchedMesh&&gn.batching===!0||Re.isBatchedMesh&&gn.batchingColor===!0&&Re.colorTexture===null||Re.isBatchedMesh&&gn.batchingColor===!1&&Re.colorTexture!==null||Re.isInstancedMesh&&gn.instancing===!1||!Re.isInstancedMesh&&gn.instancing===!0||Re.isSkinnedMesh&&gn.skinning===!1||!Re.isSkinnedMesh&&gn.skinning===!0||Re.isInstancedMesh&&gn.instancingColor===!0&&Re.instanceColor===null||Re.isInstancedMesh&&gn.instancingColor===!1&&Re.instanceColor!==null||Re.isInstancedMesh&&gn.instancingMorph===!0&&Re.morphTexture===null||Re.isInstancedMesh&&gn.instancingMorph===!1&&Re.morphTexture!==null||gn.envMap!==it||se.fog===!0&&gn.fog!==Ue||gn.numClippingPlanes!==void 0&&(gn.numClippingPlanes!==qe.numPlanes||gn.numIntersection!==qe.numIntersection)||gn.vertexAlphas!==Bt||gn.vertexTangents!==Mt||gn.morphTargets!==Yt||gn.morphNormals!==ln||gn.morphColors!==on||gn.toneMapping!==vn||gn.morphTargetsCount!==mn)&&(bn=!0):(bn=!0,gn.__version=se.version);let cn=gn.currentProgram;bn===!0&&(cn=sn(se,Ie,Re));let Jt=!1,Et=!1,rn=!1;const Cn=cn.getUniforms(),Gn=gn.uniforms;if(be.useProgram(cn.program)&&(Jt=!0,Et=!0,rn=!0),se.id!==N&&(N=se.id,Et=!0),Jt||H!==te){be.buffers.depth.getReversed()?(ge.copy(te.projectionMatrix),Vk(ge),Nk(ge),Cn.setValue(le,"projectionMatrix",ge)):Cn.setValue(le,"projectionMatrix",te.projectionMatrix),Cn.setValue(le,"viewMatrix",te.matrixWorldInverse);const Qn=Cn.map.cameraPosition;Qn!==void 0&&Qn.setValue(le,xe.setFromMatrixPosition(te.matrixWorld)),Ge.logarithmicDepthBuffer&&Cn.setValue(le,"logDepthBufFC",2/(Math.log(te.far+1)/Math.LN2)),(se.isMeshPhongMaterial||se.isMeshToonMaterial||se.isMeshLambertMaterial||se.isMeshBasicMaterial||se.isMeshStandardMaterial||se.isShaderMaterial)&&Cn.setValue(le,"isOrthographic",te.isOrthographicCamera===!0),H!==te&&(H=te,Et=!0,rn=!0)}if(Re.isSkinnedMesh){Cn.setOptional(le,Re,"bindMatrix"),Cn.setOptional(le,Re,"bindMatrixInverse");const Kn=Re.skeleton;Kn&&(Kn.boneTexture===null&&Kn.computeBoneTexture(),Cn.setValue(le,"boneTexture",Kn.boneTexture,ee))}Re.isBatchedMesh&&(Cn.setOptional(le,Re,"batchingTexture"),Cn.setValue(le,"batchingTexture",Re._matricesTexture,ee),Cn.setOptional(le,Re,"batchingIdTexture"),Cn.setValue(le,"batchingIdTexture",Re._indirectTexture,ee),Cn.setOptional(le,Re,"batchingColorTexture"),Re._colorsTexture!==null&&Cn.setValue(le,"batchingColorTexture",Re._colorsTexture,ee));const pn=Ae.morphAttributes;if((pn.position!==void 0||pn.normal!==void 0||pn.color!==void 0)&&je.update(Re,Ae,cn),(Et||gn.receiveShadow!==Re.receiveShadow)&&(gn.receiveShadow=Re.receiveShadow,Cn.setValue(le,"receiveShadow",Re.receiveShadow)),se.isMeshGouraudMaterial&&se.envMap!==null&&(Gn.envMap.value=it,Gn.flipEnvMap.value=it.isCubeTexture&&it.isRenderTargetTexture===!1?-1:1),se.isMeshStandardMaterial&&se.envMap===null&&Ie.environment!==null&&(Gn.envMapIntensity.value=Ie.environmentIntensity),Et&&(Cn.setValue(le,"toneMappingExposure",Z.toneMappingExposure),gn.needsLights&&ot(Gn,rn),Ue&&se.fog===!0&&Oe.refreshFogUniforms(Gn,Ue),Oe.refreshMaterialUniforms(Gn,se,U,L,y.state.transmissionRenderTarget[te.id]),Gy.upload(le,ae(gn),Gn,ee)),se.isShaderMaterial&&se.uniformsNeedUpdate===!0&&(Gy.upload(le,ae(gn),Gn,ee),se.uniformsNeedUpdate=!1),se.isSpriteMaterial&&Cn.setValue(le,"center",Re.center),Cn.setValue(le,"modelViewMatrix",Re.modelViewMatrix),Cn.setValue(le,"normalMatrix",Re.normalMatrix),Cn.setValue(le,"modelMatrix",Re.matrixWorld),se.isShaderMaterial||se.isRawShaderMaterial){const Kn=se.uniformsGroups;for(let Qn=0,li=Kn.length;Qn<li;Qn++){const Zi=Kn[Qn];we.update(Zi,cn),we.bind(Zi,cn)}}return cn}function ot(te,Ie){te.ambientLightColor.needsUpdate=Ie,te.lightProbe.needsUpdate=Ie,te.directionalLights.needsUpdate=Ie,te.directionalLightShadows.needsUpdate=Ie,te.pointLights.needsUpdate=Ie,te.pointLightShadows.needsUpdate=Ie,te.spotLights.needsUpdate=Ie,te.spotLightShadows.needsUpdate=Ie,te.rectAreaLights.needsUpdate=Ie,te.hemisphereLights.needsUpdate=Ie}function at(te){return te.isMeshLambertMaterial||te.isMeshToonMaterial||te.isMeshPhongMaterial||te.isMeshStandardMaterial||te.isShadowMaterial||te.isShaderMaterial&&te.lights===!0}this.getActiveCubeFace=function(){return M},this.getActiveMipmapLevel=function(){return E},this.getRenderTarget=function(){return F},this.setRenderTargetTextures=function(te,Ie,Ae){const se=Se.get(te);se.__autoAllocateDepthBuffer=te.resolveDepthBuffer===!1,se.__autoAllocateDepthBuffer===!1&&(se.__useRenderToTexture=!1),Se.get(te.texture).__webglTexture=Ie,Se.get(te.depthTexture).__webglTexture=se.__autoAllocateDepthBuffer?void 0:Ae,se.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(te,Ie){const Ae=Se.get(te);Ae.__webglFramebuffer=Ie,Ae.__useDefaultFramebuffer=Ie===void 0};const It=le.createFramebuffer();this.setRenderTarget=function(te,Ie=0,Ae=0){F=te,M=Ie,E=Ae;let se=!0,Re=null,Ue=!1,nt=!1;if(te){const it=Se.get(te);if(it.__useDefaultFramebuffer!==void 0)be.bindFramebuffer(le.FRAMEBUFFER,null),se=!1;else if(it.__webglFramebuffer===void 0)ee.setupRenderTarget(te);else if(it.__hasExternalTextures)ee.rebindTextures(te,Se.get(te.texture).__webglTexture,Se.get(te.depthTexture).__webglTexture);else if(te.depthBuffer){const Yt=te.depthTexture;if(it.__boundDepthTexture!==Yt){if(Yt!==null&&Se.has(Yt)&&(te.width!==Yt.image.width||te.height!==Yt.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");ee.setupDepthRenderbuffer(te)}}const Bt=te.texture;(Bt.isData3DTexture||Bt.isDataArrayTexture||Bt.isCompressedArrayTexture)&&(nt=!0);const Mt=Se.get(te).__webglFramebuffer;te.isWebGLCubeRenderTarget?(Array.isArray(Mt[Ie])?Re=Mt[Ie][Ae]:Re=Mt[Ie],Ue=!0):te.samples>0&&ee.useMultisampledRTT(te)===!1?Re=Se.get(te).__webglMultisampledFramebuffer:Array.isArray(Mt)?Re=Mt[Ae]:Re=Mt,z.copy(te.viewport),_.copy(te.scissor),D=te.scissorTest}else z.copy(O).multiplyScalar(U).floor(),_.copy(j).multiplyScalar(U).floor(),D=ne;if(Ae!==0&&(Re=It),be.bindFramebuffer(le.FRAMEBUFFER,Re)&&se&&be.drawBuffers(te,Re),be.viewport(z),be.scissor(_),be.setScissorTest(D),Ue){const it=Se.get(te.texture);le.framebufferTexture2D(le.FRAMEBUFFER,le.COLOR_ATTACHMENT0,le.TEXTURE_CUBE_MAP_POSITIVE_X+Ie,it.__webglTexture,Ae)}else if(nt){const it=Se.get(te.texture),Bt=Ie;le.framebufferTextureLayer(le.FRAMEBUFFER,le.COLOR_ATTACHMENT0,it.__webglTexture,Ae,Bt)}else if(te!==null&&Ae!==0){const it=Se.get(te.texture);le.framebufferTexture2D(le.FRAMEBUFFER,le.COLOR_ATTACHMENT0,le.TEXTURE_2D,it.__webglTexture,Ae)}N=-1},this.readRenderTargetPixels=function(te,Ie,Ae,se,Re,Ue,nt){if(!(te&&te.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let pt=Se.get(te).__webglFramebuffer;if(te.isWebGLCubeRenderTarget&&nt!==void 0&&(pt=pt[nt]),pt){be.bindFramebuffer(le.FRAMEBUFFER,pt);try{const it=te.texture,Bt=it.format,Mt=it.type;if(!Ge.textureFormatReadable(Bt)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!Ge.textureTypeReadable(Mt)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}Ie>=0&&Ie<=te.width-se&&Ae>=0&&Ae<=te.height-Re&&le.readPixels(Ie,Ae,se,Re,He.convert(Bt),He.convert(Mt),Ue)}finally{const it=F!==null?Se.get(F).__webglFramebuffer:null;be.bindFramebuffer(le.FRAMEBUFFER,it)}}},this.readRenderTargetPixelsAsync=async function(te,Ie,Ae,se,Re,Ue,nt){if(!(te&&te.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let pt=Se.get(te).__webglFramebuffer;if(te.isWebGLCubeRenderTarget&&nt!==void 0&&(pt=pt[nt]),pt)if(Ie>=0&&Ie<=te.width-se&&Ae>=0&&Ae<=te.height-Re){be.bindFramebuffer(le.FRAMEBUFFER,pt);const it=te.texture,Bt=it.format,Mt=it.type;if(!Ge.textureFormatReadable(Bt))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!Ge.textureTypeReadable(Mt))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");const Yt=le.createBuffer();le.bindBuffer(le.PIXEL_PACK_BUFFER,Yt),le.bufferData(le.PIXEL_PACK_BUFFER,Ue.byteLength,le.STREAM_READ),le.readPixels(Ie,Ae,se,Re,He.convert(Bt),He.convert(Mt),0);const ln=F!==null?Se.get(F).__webglFramebuffer:null;be.bindFramebuffer(le.FRAMEBUFFER,ln);const on=le.fenceSync(le.SYNC_GPU_COMMANDS_COMPLETE,0);return le.flush(),await Wk(le,on,4),le.bindBuffer(le.PIXEL_PACK_BUFFER,Yt),le.getBufferSubData(le.PIXEL_PACK_BUFFER,0,Ue),le.deleteBuffer(Yt),le.deleteSync(on),Ue}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")},this.copyFramebufferToTexture=function(te,Ie=null,Ae=0){const se=Math.pow(2,-Ae),Re=Math.floor(te.image.width*se),Ue=Math.floor(te.image.height*se),nt=Ie!==null?Ie.x:0,pt=Ie!==null?Ie.y:0;ee.setTexture2D(te,0),le.copyTexSubImage2D(le.TEXTURE_2D,Ae,0,0,nt,pt,Re,Ue),be.unbindTexture()};const Wt=le.createFramebuffer(),xt=le.createFramebuffer();this.copyTextureToTexture=function(te,Ie,Ae=null,se=null,Re=0,Ue=null){Ue===null&&(Re!==0?(yy("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),Ue=Re,Re=0):Ue=0);let nt,pt,it,Bt,Mt,Yt,ln,on,vn;const nn=te.isCompressedTexture?te.mipmaps[Ue]:te.image;if(Ae!==null)nt=Ae.max.x-Ae.min.x,pt=Ae.max.y-Ae.min.y,it=Ae.isBox3?Ae.max.z-Ae.min.z:1,Bt=Ae.min.x,Mt=Ae.min.y,Yt=Ae.isBox3?Ae.min.z:0;else{const pn=Math.pow(2,-Re);nt=Math.floor(nn.width*pn),pt=Math.floor(nn.height*pn),te.isDataArrayTexture?it=nn.depth:te.isData3DTexture?it=Math.floor(nn.depth*pn):it=1,Bt=0,Mt=0,Yt=0}se!==null?(ln=se.x,on=se.y,vn=se.z):(ln=0,on=0,vn=0);const mn=He.convert(Ie.format),gn=He.convert(Ie.type);let Xn;Ie.isData3DTexture?(ee.setTexture3D(Ie,0),Xn=le.TEXTURE_3D):Ie.isDataArrayTexture||Ie.isCompressedArrayTexture?(ee.setTexture2DArray(Ie,0),Xn=le.TEXTURE_2D_ARRAY):(ee.setTexture2D(Ie,0),Xn=le.TEXTURE_2D),le.pixelStorei(le.UNPACK_FLIP_Y_WEBGL,Ie.flipY),le.pixelStorei(le.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Ie.premultiplyAlpha),le.pixelStorei(le.UNPACK_ALIGNMENT,Ie.unpackAlignment);const bn=le.getParameter(le.UNPACK_ROW_LENGTH),cn=le.getParameter(le.UNPACK_IMAGE_HEIGHT),Jt=le.getParameter(le.UNPACK_SKIP_PIXELS),Et=le.getParameter(le.UNPACK_SKIP_ROWS),rn=le.getParameter(le.UNPACK_SKIP_IMAGES);le.pixelStorei(le.UNPACK_ROW_LENGTH,nn.width),le.pixelStorei(le.UNPACK_IMAGE_HEIGHT,nn.height),le.pixelStorei(le.UNPACK_SKIP_PIXELS,Bt),le.pixelStorei(le.UNPACK_SKIP_ROWS,Mt),le.pixelStorei(le.UNPACK_SKIP_IMAGES,Yt);const Cn=te.isDataArrayTexture||te.isData3DTexture,Gn=Ie.isDataArrayTexture||Ie.isData3DTexture;if(te.isDepthTexture){const pn=Se.get(te),Kn=Se.get(Ie),Qn=Se.get(pn.__renderTarget),li=Se.get(Kn.__renderTarget);be.bindFramebuffer(le.READ_FRAMEBUFFER,Qn.__webglFramebuffer),be.bindFramebuffer(le.DRAW_FRAMEBUFFER,li.__webglFramebuffer);for(let Zi=0;Zi<it;Zi++)Cn&&(le.framebufferTextureLayer(le.READ_FRAMEBUFFER,le.COLOR_ATTACHMENT0,Se.get(te).__webglTexture,Re,Yt+Zi),le.framebufferTextureLayer(le.DRAW_FRAMEBUFFER,le.COLOR_ATTACHMENT0,Se.get(Ie).__webglTexture,Ue,vn+Zi)),le.blitFramebuffer(Bt,Mt,nt,pt,ln,on,nt,pt,le.DEPTH_BUFFER_BIT,le.NEAREST);be.bindFramebuffer(le.READ_FRAMEBUFFER,null),be.bindFramebuffer(le.DRAW_FRAMEBUFFER,null)}else if(Re!==0||te.isRenderTargetTexture||Se.has(te)){const pn=Se.get(te),Kn=Se.get(Ie);be.bindFramebuffer(le.READ_FRAMEBUFFER,Wt),be.bindFramebuffer(le.DRAW_FRAMEBUFFER,xt);for(let Qn=0;Qn<it;Qn++)Cn?le.framebufferTextureLayer(le.READ_FRAMEBUFFER,le.COLOR_ATTACHMENT0,pn.__webglTexture,Re,Yt+Qn):le.framebufferTexture2D(le.READ_FRAMEBUFFER,le.COLOR_ATTACHMENT0,le.TEXTURE_2D,pn.__webglTexture,Re),Gn?le.framebufferTextureLayer(le.DRAW_FRAMEBUFFER,le.COLOR_ATTACHMENT0,Kn.__webglTexture,Ue,vn+Qn):le.framebufferTexture2D(le.DRAW_FRAMEBUFFER,le.COLOR_ATTACHMENT0,le.TEXTURE_2D,Kn.__webglTexture,Ue),Re!==0?le.blitFramebuffer(Bt,Mt,nt,pt,ln,on,nt,pt,le.COLOR_BUFFER_BIT,le.NEAREST):Gn?le.copyTexSubImage3D(Xn,Ue,ln,on,vn+Qn,Bt,Mt,nt,pt):le.copyTexSubImage2D(Xn,Ue,ln,on,Bt,Mt,nt,pt);be.bindFramebuffer(le.READ_FRAMEBUFFER,null),be.bindFramebuffer(le.DRAW_FRAMEBUFFER,null)}else Gn?te.isDataTexture||te.isData3DTexture?le.texSubImage3D(Xn,Ue,ln,on,vn,nt,pt,it,mn,gn,nn.data):Ie.isCompressedArrayTexture?le.compressedTexSubImage3D(Xn,Ue,ln,on,vn,nt,pt,it,mn,nn.data):le.texSubImage3D(Xn,Ue,ln,on,vn,nt,pt,it,mn,gn,nn):te.isDataTexture?le.texSubImage2D(le.TEXTURE_2D,Ue,ln,on,nt,pt,mn,gn,nn.data):te.isCompressedTexture?le.compressedTexSubImage2D(le.TEXTURE_2D,Ue,ln,on,nn.width,nn.height,mn,nn.data):le.texSubImage2D(le.TEXTURE_2D,Ue,ln,on,nt,pt,mn,gn,nn);le.pixelStorei(le.UNPACK_ROW_LENGTH,bn),le.pixelStorei(le.UNPACK_IMAGE_HEIGHT,cn),le.pixelStorei(le.UNPACK_SKIP_PIXELS,Jt),le.pixelStorei(le.UNPACK_SKIP_ROWS,Et),le.pixelStorei(le.UNPACK_SKIP_IMAGES,rn),Ue===0&&Ie.generateMipmaps&&le.generateMipmap(Xn),be.unbindTexture()},this.copyTextureToTexture3D=function(te,Ie,Ae=null,se=null,Re=0){return yy('WebGLRenderer: copyTextureToTexture3D function has been deprecated. Use "copyTextureToTexture" instead.'),this.copyTextureToTexture(te,Ie,Ae,se,Re)},this.initRenderTarget=function(te){Se.get(te).__webglFramebuffer===void 0&&ee.setupRenderTarget(te)},this.initTexture=function(te){te.isCubeTexture?ee.setTextureCube(te,0):te.isData3DTexture?ee.setTexture3D(te,0):te.isDataArrayTexture||te.isCompressedArrayTexture?ee.setTexture2DArray(te,0):ee.setTexture2D(te,0),be.unbindTexture()},this.resetState=function(){M=0,E=0,F=null,be.reset(),ht.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return cc}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=vi._getDrawingBufferColorSpace(e),t.unpackColorSpace=vi._getUnpackColorSpace()}}const T8=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:PZ,AddEquation:ud,AddOperation:l9,AdditiveAnimationBlendMode:nx,AdditiveBlending:K1,AgXToneMapping:C9,AlphaFormat:jZ,AlwaysCompare:Z9,AlwaysDepth:Qy,AlwaysStencilFunc:U1,AmbientLight:mX,AnimationAction:RX,AnimationClip:xf,AnimationLoader:nJ,AnimationMixer:RJ,AnimationObjectGroup:SJ,AnimationUtils:qP,ArcCurve:D9,ArrayCamera:GX,ArrowHelper:JJ,AttachedBindMode:D1,Audio:SX,AudioAnalyser:hJ,AudioContext:Mx,AudioListener:dJ,AudioLoader:cJ,AxesHelper:jJ,BackSide:fr,BasicDepthPacking:b9,BasicShadowMap:L5,BatchedMesh:K9,Bone:wG,BooleanKeyframeTrack:bI,Box2:HJ,Box3:Wo,Box3Helper:kJ,BoxGeometry:wd,BoxHelper:UJ,BufferAttribute:Mi,BufferGeometry:$n,BufferGeometryLoader:yX,ByteType:CG,Cache:nu,Camera:BG,CameraHelper:OJ,CanvasTexture:_9,CapsuleGeometry:WG,CatmullRomCurve3:O9,CineonToneMapping:u9,CircleGeometry:VG,ClampToEdgeWrapping:Ka,Clock:Wx,Color:dn,ColorKeyframeTrack:Bx,ColorManagement:vi,CompressedArrayTexture:bP,CompressedCubeTexture:vP,CompressedTexture:ZG,CompressedTextureLoader:iJ,ConeGeometry:NG,ConstantAlphaFactor:o9,ConstantColorFactor:i9,Controls:qJ,CubeCamera:F9,CubeReflectionMapping:Cg,CubeRefractionMapping:bd,CubeTexture:rb,CubeTextureLoader:hX,CubeUVReflectionMapping:Of,CubicBezierCurve:fx,CubicBezierCurve3:U9,CubicInterpolant:uX,CullFaceBack:z1,CullFaceFront:K5,CullFaceFrontBack:TU,CullFaceNone:z5,Curve:mc,CurvePath:P9,CustomBlending:_5,CustomToneMapping:d9,CylinderGeometry:Uf,Cylindrical:EJ,Data3DTexture:vG,DataArrayTexture:ob,DataTexture:gc,DataTextureLoader:Gx,DataUtils:PC,DecrementStencilOp:PU,DecrementWrapStencilOp:jU,DefaultLoadingManager:IX,DepthFormat:vf,DepthStencilFormat:yf,DepthTexture:xG,DetachedBindMode:h9,DirectionalLight:Zx,DirectionalLightHelper:DJ,DiscreteInterpolant:dX,DodecahedronGeometry:EG,DoubleSide:ms,DstAlphaFactor:q5,DstColorFactor:e9,DynamicCopyUsage:gk,DynamicDrawUsage:x9,DynamicReadUsage:sk,EdgesGeometry:J9,EllipseCurve:MG,EqualCompare:G9,EqualDepth:$y,EqualStencilFunc:ek,EquirectangularReflectionMapping:Af,EquirectangularRefractionMapping:Bp,Euler:ys,EventDispatcher:pg,ExtrudeGeometry:HG,FileLoader:ko,Float16BufferAttribute:eP,Float32BufferAttribute:Sn,FloatType:ma,Fog:SG,FogExp2:GG,FramebufferTexture:pP,FrontSide:dg,Frustum:cb,GLBufferAttribute:NJ,GLSL1:dk,GLSL3:k1,GreaterCompare:S9,GreaterDepth:tB,GreaterEqualCompare:R9,GreaterEqualDepth:eB,GreaterEqualStencilFunc:ak,GreaterStencilFunc:nk,GridHelper:LJ,Group:tu,HalfFloatType:Co,HemisphereLight:AX,HemisphereLightHelper:KJ,IcosahedronGeometry:ub,ImageBitmapLoader:BX,ImageLoader:Np,ImageUtils:N9,IncrementStencilOp:kU,IncrementWrapStencilOp:JU,InstancedBufferAttribute:yd,InstancedBufferGeometry:xx,InstancedInterleavedBuffer:VJ,InstancedMesh:nI,Int16BufferAttribute:qk,Int32BufferAttribute:$k,Int8BufferAttribute:Jk,IntType:nb,InterleavedBuffer:lb,InterleavedBufferAttribute:vd,Interpolant:kf,InterpolateDiscrete:Bf,InterpolateLinear:Gf,InterpolateSmooth:vy,InvertStencilOp:QU,KeepStencilOp:FC,KeyframeTrack:Gl,LOD:Y9,LatheGeometry:gb,Layers:wf,LessCompare:B9,LessDepth:qy,LessEqualCompare:ox,LessEqualDepth:sI,LessEqualStencilFunc:tk,LessStencilFunc:$U,Light:Zd,LightProbe:vX,Line:uu,Line3:FJ,LineBasicMaterial:Ar,LineCurve:Ax,LineCurve3:k9,LineDashedMaterial:lX,LineLoop:Cx,LineSegments:Ac,LinearFilter:Bi,LinearInterpolant:yx,LinearMipMapLinearFilter:O1,LinearMipMapNearestFilter:KU,LinearMipmapLinearFilter:pl,LinearMipmapNearestFilter:cf,LinearSRGBColorSpace:Cc,LinearToneMapping:c9,LinearTransfer:Sp,Loader:Jo,LoaderUtils:Ad,LoadingManager:DG,LoopOnce:f9,LoopPingPong:m9,LoopRepeat:A9,LuminanceAlphaFormat:$Z,LuminanceFormat:qZ,MOUSE:EC,Material:ho,MaterialLoader:OG,MathUtils:M9,Matrix2:Fx,Matrix3:Jn,Matrix4:Vn,MaxEquation:k5,Mesh:$i,MeshBasicMaterial:Or,MeshDepthMaterial:LG,MeshDistanceMaterial:_G,MeshLambertMaterial:rX,MeshMatcapMaterial:sX,MeshNormalMaterial:oX,MeshPhongMaterial:iX,MeshPhysicalMaterial:Bl,MeshStandardMaterial:Ib,MeshToonMaterial:aX,MinEquation:U5,MirroredRepeatWrapping:mf,MixOperation:s9,MultiplyBlending:_1,MultiplyOperation:tb,NearestFilter:Mo,NearestMipMapLinearFilter:zU,NearestMipMapNearestFilter:YU,NearestMipmapLinearFilter:OC,NearestMipmapNearestFilter:dG,NeutralToneMapping:I9,NeverCompare:y9,NeverDepth:jy,NeverStencilFunc:qU,NoBlending:sg,NoColorSpace:$g,NoToneMapping:lg,NormalAnimationBlendMode:pG,NormalBlending:eI,NotEqualCompare:w9,NotEqualDepth:nB,NotEqualStencilFunc:ik,NumberKeyframeTrack:cI,Object3D:Ii,ObjectLoader:sJ,ObjectSpaceNormalMap:v9,OctahedronGeometry:db,OneFactor:J5,OneMinusConstantAlphaFactor:r9,OneMinusConstantColorFactor:a9,OneMinusDstAlphaFactor:$5,OneMinusDstColorFactor:t9,OneMinusSrcAlphaFactor:Jy,OneMinusSrcColorFactor:Q5,OrthographicCamera:bl,PCFShadowMap:uG,PCFSoftShadowMap:np,PMREMGenerator:tR,Path:xp,PerspectiveCamera:fa,Plane:qg,PlaneGeometry:pc,PlaneHelper:PJ,PointLight:Rx,PointLightHelper:YJ,Points:Ix,PointsMaterial:RG,PolarGridHelper:_J,PolyhedronGeometry:Rd,PositionalAudio:IJ,PropertyBinding:Ri,PropertyMixer:wX,QuadraticBezierCurve:mx,QuadraticBezierCurve3:px,Quaternion:eo,QuaternionKeyframeTrack:gI,QuaternionLinearInterpolant:CX,RED_GREEN_RGTC2_Format:RB,RED_RGTC1_Format:tx,REVISION:eb,RGBADepthPacking:ax,RGBAFormat:La,RGBAIntegerFormat:mG,RGBA_ASTC_10x10_Format:vB,RGBA_ASTC_10x5_Format:mB,RGBA_ASTC_10x6_Format:pB,RGBA_ASTC_10x8_Format:bB,RGBA_ASTC_12x10_Format:yB,RGBA_ASTC_12x12_Format:BB,RGBA_ASTC_4x4_Format:gB,RGBA_ASTC_5x4_Format:uB,RGBA_ASTC_5x5_Format:dB,RGBA_ASTC_6x5_Format:CB,RGBA_ASTC_6x6_Format:IB,RGBA_ASTC_8x5_Format:hB,RGBA_ASTC_8x6_Format:fB,RGBA_ASTC_8x8_Format:AB,RGBA_BPTC_Format:sp,RGBA_ETC2_EAC_Format:cB,RGBA_PVRTC_2BPPV1_Format:rB,RGBA_PVRTC_4BPPV1_Format:oB,RGBA_S3TC_DXT1_Format:ap,RGBA_S3TC_DXT3_Format:op,RGBA_S3TC_DXT5_Format:rp,RGBDepthPacking:_U,RGBFormat:QZ,RGBIntegerFormat:LU,RGB_BPTC_SIGNED_Format:GB,RGB_BPTC_UNSIGNED_Format:SB,RGB_ETC1_Format:sB,RGB_ETC2_Format:lB,RGB_PVRTC_2BPPV1_Format:aB,RGB_PVRTC_4BPPV1_Format:iB,RGB_S3TC_DXT1_Format:ip,RGDepthPacking:DU,RGFormat:ex,RGIntegerFormat:AG,RawShaderMaterial:nX,Ray:pI,Raycaster:Hx,RectAreaLight:pX,RedFormat:ib,RedIntegerFormat:ab,ReinhardToneMapping:g9,RenderTarget:bG,RenderTarget3D:ZJ,RenderTargetArray:xJ,RepeatWrapping:gu,ReplaceStencilOp:UU,ReverseSubtractEquation:O5,RingGeometry:FG,SIGNED_RED_GREEN_RGTC2_Format:ZB,SIGNED_RED_RGTC1_Format:wB,SRGBColorSpace:Uo,SRGBTransfer:Ui,Scene:sb,ShaderChunk:ti,ShaderLib:lc,ShaderMaterial:Ur,ShadowMaterial:tX,Shape:iI,ShapeGeometry:XG,ShapePath:QJ,ShapeUtils:cg,ShortType:IG,Skeleton:dx,SkeletonHelper:TJ,SkinnedMesh:ux,Source:dd,Sphere:Vo,SphereGeometry:Cb,Spherical:$1,SphericalHarmonics3:bX,SplineCurve:bx,SpotLight:wx,SpotLightHelper:XJ,Sprite:T9,SpriteMaterial:gx,SrcAlphaFactor:Py,SrcAlphaSaturateFactor:n9,SrcColorFactor:j5,StaticCopyUsage:ck,StaticDrawUsage:wp,StaticReadUsage:rk,StereoCamera:gJ,StreamCopyUsage:uk,StreamDrawUsage:ok,StreamReadUsage:lk,StringKeyframeTrack:vI,SubtractEquation:D5,SubtractiveBlending:L1,TOUCH:HC,TangentSpaceNormalMap:Sd,TetrahedronGeometry:TG,Texture:Fi,TextureLoader:fX,TextureUtils:i4,TimestampQuery:Ck,TorusGeometry:YG,TorusKnotGeometry:zG,Triangle:ps,TriangleFanDrawMode:xB,TriangleStripDrawMode:ix,TrianglesDrawMode:p9,TubeGeometry:KG,UVMapping:pd,Uint16BufferAttribute:sx,Uint32BufferAttribute:lx,Uint8BufferAttribute:jk,Uint8ClampedBufferAttribute:Qk,Uniform:Ex,UniformsGroup:WJ,UniformsLib:hn,UniformsUtils:yG,UnsignedByteType:vs,UnsignedInt248Type:bf,UnsignedInt5999Type:JZ,UnsignedIntType:Ig,UnsignedShort4444Type:hG,UnsignedShort5551Type:fG,UnsignedShortType:pf,VSMShadowMap:oc,Vector2:Xt,Vector3:Be,Vector4:yi,VectorKeyframeTrack:uI,VideoFrameTexture:mP,VideoTexture:L9,WebGL3DRenderTarget:Tk,WebGLArrayRenderTarget:Xk,WebGLCoordinateSystem:cc,WebGLCubeRenderTarget:cx,WebGLRenderTarget:Us,WebGLRenderer:Tx,WebGLUtils:EX,WebGPUCoordinateSystem:Rp,WebXRController:By,WireframeGeometry:eX,WrapAroundEnding:Gp,ZeroCurvatureEnding:UC,ZeroFactor:P5,ZeroSlopeEnding:kC,ZeroStencilOp:OU,createCanvasElement:V9},Symbol.toStringTag,{value:"Module"}));var ow={exports:{}},jg={};/**
 * @license React
 * react-reconciler-constants.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var LN;function Y8(){return LN||(LN=1,jg.ConcurrentRoot=1,jg.ContinuousEventPriority=8,jg.DefaultEventPriority=32,jg.DiscreteEventPriority=2,jg.IdleEventPriority=268435456,jg.LegacyRoot=0,jg.NoEventPriority=0),jg}var _N;function z8(){return _N||(_N=1,ow.exports=Y8()),ow.exports}var Sy=z8(),rw={exports:{}},sw={},lw={exports:{}},cw={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var DN;function K8(){if(DN)return cw;DN=1;var n=Kf();function e(C,h){return C===h&&(C!==0||1/C===1/h)||C!==C&&h!==h}var t=typeof Object.is=="function"?Object.is:e,i=n.useState,a=n.useEffect,o=n.useLayoutEffect,r=n.useDebugValue;function s(C,h){var m=h(),p=i({inst:{value:m,getSnapshot:h}}),B=p[0].inst,b=p[1];return o(function(){B.value=m,B.getSnapshot=h,l(B)&&b({inst:B})},[C,m,h]),a(function(){return l(B)&&b({inst:B}),C(function(){l(B)&&b({inst:B})})},[C]),r(m),m}function l(C){var h=C.getSnapshot;C=C.value;try{var m=h();return!t(C,m)}catch{return!0}}function c(C,h){return h()}var u=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?c:s;return cw.useSyncExternalStore=n.useSyncExternalStore!==void 0?n.useSyncExternalStore:u,cw}var ON;function L8(){return ON||(ON=1,lw.exports=K8()),lw.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var UN;function _8(){if(UN)return sw;UN=1;var n=Kf(),e=L8();function t(c,u){return c===u&&(c!==0||1/c===1/u)||c!==c&&u!==u}var i=typeof Object.is=="function"?Object.is:t,a=e.useSyncExternalStore,o=n.useRef,r=n.useEffect,s=n.useMemo,l=n.useDebugValue;return sw.useSyncExternalStoreWithSelector=function(c,u,C,h,m){var p=o(null);if(p.current===null){var B={hasValue:!1,value:null};p.current=B}else B=p.current;p=s(function(){function y(M){if(!S){if(S=!0,R=M,M=h(M),m!==void 0&&B.hasValue){var E=B.value;if(m(E,M))return Z=E}return Z=M}if(E=Z,i(R,M))return E;var F=h(M);return m!==void 0&&m(E,F)?(R=M,E):(R=M,Z=F)}var S=!1,R,Z,x=C===void 0?null:C;return[function(){return y(u())},x===null?void 0:function(){return y(x())}]},[u,C,h,m]);var b=a(c,p[0],p[1]);return r(function(){B.hasValue=!0,B.value=b},[b]),l(b),b},sw}var kN;function D8(){return kN||(kN=1,rw.exports=_8()),rw.exports}var O8=D8();const U8=mI(O8),PN=n=>{let e;const t=new Set,i=(c,u)=>{const C=typeof c=="function"?c(e):c;if(!Object.is(C,e)){const h=e;e=u??(typeof C!="object"||C===null)?C:Object.assign({},e,C),t.forEach(m=>m(e,h))}},a=()=>e,s={setState:i,getState:a,getInitialState:()=>l,subscribe:c=>(t.add(c),()=>t.delete(c))},l=e=n(i,a,s);return s},k8=n=>n?PN(n):PN,{useSyncExternalStoreWithSelector:P8}=U8,J8=n=>n;function j8(n,e=J8,t){const i=P8(n.subscribe,n.getState,n.getInitialState,e,t);return Ct.useDebugValue(i),i}const JN=(n,e)=>{const t=k8(n),i=(a,o=e)=>j8(t,a,o);return Object.assign(i,t),i},HX=(n,e)=>n?JN(n,e):JN;var gw={exports:{}},uw={exports:{}},dw={exports:{}},Cw={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jN;function Q8(){return jN||(jN=1,function(n){function e(X,L){var U=X.length;X.push(L);e:for(;0<U;){var q=U-1>>>1,K=X[q];if(0<a(K,L))X[q]=L,X[U]=K,U=q;else break e}}function t(X){return X.length===0?null:X[0]}function i(X){if(X.length===0)return null;var L=X[0],U=X.pop();if(U!==L){X[0]=U;e:for(var q=0,K=X.length,O=K>>>1;q<O;){var j=2*(q+1)-1,ne=X[j],k=j+1,ie=X[k];if(0>a(ne,U))k<K&&0>a(ie,ne)?(X[q]=ie,X[k]=U,q=k):(X[q]=ne,X[j]=U,q=j);else if(k<K&&0>a(ie,U))X[q]=ie,X[k]=U,q=k;else break e}}return L}function a(X,L){var U=X.sortIndex-L.sortIndex;return U!==0?U:X.id-L.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;n.unstable_now=function(){return o.now()}}else{var r=Date,s=r.now();n.unstable_now=function(){return r.now()-s}}var l=[],c=[],u=1,C=null,h=3,m=!1,p=!1,B=!1,b=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;function R(X){for(var L=t(c);L!==null;){if(L.callback===null)i(c);else if(L.startTime<=X)i(c),L.sortIndex=L.expirationTime,e(l,L);else break;L=t(c)}}function Z(X){if(B=!1,R(X),!p)if(t(l)!==null)p=!0,P();else{var L=t(c);L!==null&&$(Z,L.startTime-X)}}var x=!1,M=-1,E=5,F=-1;function N(){return!(n.unstable_now()-F<E)}function H(){if(x){var X=n.unstable_now();F=X;var L=!0;try{e:{p=!1,B&&(B=!1,y(M),M=-1),m=!0;var U=h;try{t:{for(R(X),C=t(l);C!==null&&!(C.expirationTime>X&&N());){var q=C.callback;if(typeof q=="function"){C.callback=null,h=C.priorityLevel;var K=q(C.expirationTime<=X);if(X=n.unstable_now(),typeof K=="function"){C.callback=K,R(X),L=!0;break t}C===t(l)&&i(l),R(X)}else i(l);C=t(l)}if(C!==null)L=!0;else{var O=t(c);O!==null&&$(Z,O.startTime-X),L=!1}}break e}finally{C=null,h=U,m=!1}L=void 0}}finally{L?z():x=!1}}}var z;if(typeof S=="function")z=function(){S(H)};else if(typeof MessageChannel<"u"){var _=new MessageChannel,D=_.port2;_.port1.onmessage=H,z=function(){D.postMessage(null)}}else z=function(){b(H,0)};function P(){x||(x=!0,z())}function $(X,L){M=b(function(){X(n.unstable_now())},L)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(X){X.callback=null},n.unstable_continueExecution=function(){p||m||(p=!0,P())},n.unstable_forceFrameRate=function(X){0>X||125<X?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<X?Math.floor(1e3/X):5},n.unstable_getCurrentPriorityLevel=function(){return h},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(X){switch(h){case 1:case 2:case 3:var L=3;break;default:L=h}var U=h;h=L;try{return X()}finally{h=U}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(X,L){switch(X){case 1:case 2:case 3:case 4:case 5:break;default:X=3}var U=h;h=X;try{return L()}finally{h=U}},n.unstable_scheduleCallback=function(X,L,U){var q=n.unstable_now();switch(typeof U=="object"&&U!==null?(U=U.delay,U=typeof U=="number"&&0<U?q+U:q):U=q,X){case 1:var K=-1;break;case 2:K=250;break;case 5:K=1073741823;break;case 4:K=1e4;break;default:K=5e3}return K=U+K,X={id:u++,callback:L,priorityLevel:X,startTime:U,expirationTime:K,sortIndex:-1},U>q?(X.sortIndex=U,e(c,X),t(l)===null&&X===t(c)&&(B?(y(M),M=-1):B=!0,$(Z,U-q))):(X.sortIndex=K,e(l,X),p||m||(p=!0,P())),X},n.unstable_shouldYield=N,n.unstable_wrapCallback=function(X){var L=h;return function(){var U=h;h=L;try{return X.apply(this,arguments)}finally{h=U}}}}(Cw)),Cw}var QN;function q8(){return QN||(QN=1,dw.exports=Q8()),dw.exports}/**
 * @license React
 * react-reconciler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qN;function $8(){return qN||(qN=1,function(n){n.exports=function(e){function t(I,f,w,V){return new xA(I,f,w,V)}function i(){}function a(I){var f="https://react.dev/errors/"+I;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var w=2;w<arguments.length;w++)f+="&args[]="+encodeURIComponent(arguments[w])}return"Minified React error #"+I+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(I){return I===null||typeof I!="object"?null:(I=Kl&&I[Kl]||I["@@iterator"],typeof I=="function"?I:null)}function r(I){if(I==null)return null;if(typeof I=="function")return I.$$typeof===NA?null:I.displayName||I.name||null;if(typeof I=="string")return I;switch(I){case Ec:return"Fragment";case ns:return"Portal";case OI:return"Profiler";case qd:return"StrictMode";case UI:return"Suspense";case Zu:return"SuspenseList"}if(typeof I=="object")switch(I.$$typeof){case Zs:return(I.displayName||"Context")+".Provider";case WA:return(I._context.displayName||"Context")+".Consumer";case eC:var f=I.render;return I=I.displayName,I||(I=f.displayName||f.name||"",I=I!==""?"ForwardRef("+I+")":"ForwardRef"),I;case kI:return f=I.displayName||null,f!==null?f:r(I.type)||"Memo";case is:f=I._payload,I=I._init;try{return r(I(f))}catch{}}return null}function s(I){if($s===void 0)try{throw Error()}catch(w){var f=w.stack.trim().match(/\n( *(at )?)/);$s=f&&f[1]||"",Ll=-1<w.stack.indexOf(`
    at`)?" (<anonymous>)":-1<w.stack.indexOf("@")?"@unknown:0:0":""}return`
`+$s+I+Ll}function l(I,f){if(!I||Sg)return"";Sg=!0;var w=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var V={DetermineComponentFrameRoot:function(){try{if(f){var In=function(){throw Error()};if(Object.defineProperty(In.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(In,[])}catch(Un){var An=Un}Reflect.construct(I,[],In)}else{try{In.call()}catch(Un){An=Un}I.call(In.prototype)}}else{try{throw Error()}catch(Un){An=Un}(In=I())&&typeof In.catch=="function"&&In.catch(function(){})}}catch(Un){if(Un&&An&&typeof Un.stack=="string")return[Un.stack,An.stack]}return[null,null]}};V.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var Y=Object.getOwnPropertyDescriptor(V.DetermineComponentFrameRoot,"name");Y&&Y.configurable&&Object.defineProperty(V.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var J=V.DetermineComponentFrameRoot(),ve=J[0],Pe=J[1];if(ve&&Pe){var dt=ve.split(`
`),zt=Pe.split(`
`);for(Y=V=0;V<dt.length&&!dt[V].includes("DetermineComponentFrameRoot");)V++;for(;Y<zt.length&&!zt[Y].includes("DetermineComponentFrameRoot");)Y++;if(V===dt.length||Y===zt.length)for(V=dt.length-1,Y=zt.length-1;1<=V&&0<=Y&&dt[V]!==zt[Y];)Y--;for(;1<=V&&0<=Y;V--,Y--)if(dt[V]!==zt[Y]){if(V!==1||Y!==1)do if(V--,Y--,0>Y||dt[V]!==zt[Y]){var en=`
`+dt[V].replace(" at new "," at ");return I.displayName&&en.includes("<anonymous>")&&(en=en.replace("<anonymous>",I.displayName)),en}while(1<=V&&0<=Y);break}}}finally{Sg=!1,Error.prepareStackTrace=w}return(w=I?I.displayName||I.name:"")?s(w):""}function c(I){switch(I.tag){case 26:case 27:case 5:return s(I.type);case 16:return s("Lazy");case 13:return s("Suspense");case 19:return s("SuspenseList");case 0:case 15:return I=l(I.type,!1),I;case 11:return I=l(I.type.render,!1),I;case 1:return I=l(I.type,!0),I;default:return""}}function u(I){try{var f="";do f+=c(I),I=I.return;while(I);return f}catch(w){return`
Error generating stack: `+w.message+`
`+w.stack}}function C(I){var f=I,w=I;if(I.alternate)for(;f.return;)f=f.return;else{I=f;do f=I,(f.flags&4098)!==0&&(w=f.return),I=f.return;while(I)}return f.tag===3?w:null}function h(I){if(C(I)!==I)throw Error(a(188))}function m(I){var f=I.alternate;if(!f){if(f=C(I),f===null)throw Error(a(188));return f!==I?null:I}for(var w=I,V=f;;){var Y=w.return;if(Y===null)break;var J=Y.alternate;if(J===null){if(V=Y.return,V!==null){w=V;continue}break}if(Y.child===J.child){for(J=Y.child;J;){if(J===w)return h(Y),I;if(J===V)return h(Y),f;J=J.sibling}throw Error(a(188))}if(w.return!==V.return)w=Y,V=J;else{for(var ve=!1,Pe=Y.child;Pe;){if(Pe===w){ve=!0,w=Y,V=J;break}if(Pe===V){ve=!0,V=Y,w=J;break}Pe=Pe.sibling}if(!ve){for(Pe=J.child;Pe;){if(Pe===w){ve=!0,w=J,V=Y;break}if(Pe===V){ve=!0,V=J,w=Y;break}Pe=Pe.sibling}if(!ve)throw Error(a(189))}}if(w.alternate!==V)throw Error(a(190))}if(w.tag!==3)throw Error(a(188));return w.stateNode.current===w?I:f}function p(I){var f=I.tag;if(f===5||f===26||f===27||f===6)return I;for(I=I.child;I!==null;){if(f=p(I),f!==null)return f;I=I.sibling}return null}function B(I){var f=I.tag;if(f===5||f===26||f===27||f===6)return I;for(I=I.child;I!==null;){if(I.tag!==4&&(f=B(I),f!==null))return f;I=I.sibling}return null}function b(I){return{current:I}}function y(I){0>Ul||(I.current=Ga[Ul],Ga[Ul]=null,Ul--)}function S(I,f){Ul++,Ga[Ul]=I.current,I.current=f}function R(I){return I>>>=0,I===0?32:31-(Z0(I)/x0|0)|0}function Z(I){var f=I&42;if(f!==0)return f;switch(I&-I){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return I&4194176;case 4194304:case 8388608:case 16777216:case 33554432:return I&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return I}}function x(I,f){var w=I.pendingLanes;if(w===0)return 0;var V=0,Y=I.suspendedLanes,J=I.pingedLanes,ve=I.warmLanes;I=I.finishedLanes!==0;var Pe=w&134217727;return Pe!==0?(w=Pe&~Y,w!==0?V=Z(w):(J&=Pe,J!==0?V=Z(J):I||(ve=Pe&~ve,ve!==0&&(V=Z(ve))))):(Pe=w&~Y,Pe!==0?V=Z(Pe):J!==0?V=Z(J):I||(ve=w&~ve,ve!==0&&(V=Z(ve)))),V===0?0:f!==0&&f!==V&&(f&Y)===0&&(Y=V&-V,ve=f&-f,Y>=ve||Y===32&&(ve&4194176)!==0)?f:V}function M(I,f){return(I.pendingLanes&~(I.suspendedLanes&~I.pingedLanes)&f)===0}function E(I,f){switch(I){case 1:case 2:case 4:case 8:return f+250;case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return f+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function F(){var I=tl;return tl<<=1,(tl&4194176)===0&&(tl=128),I}function N(){var I=Zg;return Zg<<=1,(Zg&62914560)===0&&(Zg=4194304),I}function H(I){for(var f=[],w=0;31>w;w++)f.push(I);return f}function z(I,f){I.pendingLanes|=f,f!==268435456&&(I.suspendedLanes=0,I.pingedLanes=0,I.warmLanes=0)}function _(I,f,w,V,Y,J){var ve=I.pendingLanes;I.pendingLanes=w,I.suspendedLanes=0,I.pingedLanes=0,I.warmLanes=0,I.expiredLanes&=w,I.entangledLanes&=w,I.errorRecoveryDisabledLanes&=w,I.shellSuspendCounter=0;var Pe=I.entanglements,dt=I.expirationTimes,zt=I.hiddenUpdates;for(w=ve&~w;0<w;){var en=31-zo(w),In=1<<en;Pe[en]=0,dt[en]=-1;var An=zt[en];if(An!==null)for(zt[en]=null,en=0;en<An.length;en++){var Un=An[en];Un!==null&&(Un.lane&=-536870913)}w&=~In}V!==0&&D(I,V,0),J!==0&&Y===0&&I.tag!==0&&(I.suspendedLanes|=J&~(ve&~f))}function D(I,f,w){I.pendingLanes|=f,I.suspendedLanes&=~f;var V=31-zo(f);I.entangledLanes|=f,I.entanglements[V]=I.entanglements[V]|1073741824|w&4194218}function P(I,f){var w=I.entangledLanes|=f;for(I=I.entanglements;w;){var V=31-zo(w),Y=1<<V;Y&f|I[V]&f&&(I[V]|=f),w&=~Y}}function $(I){return I&=-I,2<I?8<I?(I&134217727)!==0?32:268435456:8:2}function X(I){if(rr&&typeof rr.onCommitFiberRoot=="function")try{rr.onCommitFiberRoot(Sa,I,void 0,(I.current.flags&128)===128)}catch{}}function L(I){if(typeof V0=="function"&&Ja(I),rr&&typeof rr.setStrictMode=="function")try{rr.setStrictMode(Sa,I)}catch{}}function U(I,f){return I===f&&(I!==0||1/I===1/f)||I!==I&&f!==f}function q(I,f){if(typeof I=="object"&&I!==null){var w=qA.get(I);return w!==void 0?w:(f={value:I,source:f,stack:u(f)},qA.set(I,f),f)}return{value:I,source:f,stack:u(f)}}function K(I,f){xg[Mg++]=Xu,xg[Mg++]=Wg,Wg=I,Xu=f}function O(I,f,w){Rr[Zr++]=Ws,Rr[Zr++]=Vs,Rr[Zr++]=Kc,Kc=I;var V=Ws;I=Vs;var Y=32-zo(V)-1;V&=~(1<<Y),w+=1;var J=32-zo(f)+Y;if(30<J){var ve=Y-Y%5;J=(V&(1<<ve)-1).toString(32),V>>=ve,Y-=ve,Ws=1<<32-zo(f)+Y|w<<Y|V,Vs=J+I}else Ws=1<<J|w<<Y|V,Vs=I}function j(I){I.return!==null&&(K(I,1),O(I,1,0))}function ne(I){for(;I===Wg;)Wg=xg[--Mg],xg[Mg]=null,Xu=xg[--Mg],xg[Mg]=null;for(;I===Kc;)Kc=Rr[--Zr],Rr[Zr]=null,Vs=Rr[--Zr],Rr[Zr]=null,Ws=Rr[--Zr],Rr[Zr]=null}function k(I,f){S(nl,f),S(Tu,I),S(Fa,null),I=kb(f),y(Fa),S(Fa,I)}function ie(){y(Fa),y(Tu),y(nl)}function re(I){I.memoizedState!==null&&S(Vg,I);var f=Fa.current,w=Vu(f,I.type);f!==w&&(S(Tu,I),S(Fa,w))}function ge(I){Tu.current===I&&(y(Fa),y(Tu)),Vg.current===I&&(y(Vg),To?xs._currentValue=Fc:xs._currentValue2=Fc)}function de(I){var f=Error(a(418,""));throw Te(q(f,I)),cC}function xe(I,f){if(!co)throw Error(a(175));m0(I.stateNode,I.type,I.memoizedProps,f,I)||de(I)}function Ne(I){for(go=I.return;go;)switch(go.tag){case 3:case 27:ja=!0;return;case 5:case 13:ja=!1;return;default:go=go.return}}function ye(I){if(!co||I!==go)return!1;if(!fi)return Ne(I),fi=!0,!1;var f=!1;if(Li?I.tag!==3&&I.tag!==27&&(I.tag!==5||nh(I.type)&&!Pn(I.type,I.memoizedProps))&&(f=!0):I.tag!==3&&(I.tag!==5||nh(I.type)&&!Pn(I.type,I.memoizedProps))&&(f=!0),f&&uo&&de(I),Ne(I),I.tag===13){if(!co)throw Error(a(316));if(I=I.memoizedState,I=I!==null?I.dehydrated:null,!I)throw Error(a(317));uo=b0(I)}else uo=go?PA(I.stateNode):null;return!0}function pe(){co&&(uo=go=null,fi=!1)}function Te(I){rs===null?rs=[I]:rs.push(I)}function le(){for(var I=Ng,f=Ns=Ng=0;f<I;){var w=ss[f];ss[f++]=null;var V=ss[f];ss[f++]=null;var Y=ss[f];ss[f++]=null;var J=ss[f];if(ss[f++]=null,V!==null&&Y!==null){var ve=V.pending;ve===null?Y.next=Y:(Y.next=ve.next,ve.next=Y),V.pending=Y}J!==0&&be(w,Y,J)}}function Ye(I,f,w,V){ss[Ng++]=I,ss[Ng++]=f,ss[Ng++]=w,ss[Ng++]=V,Ns|=V,I.lanes|=V,I=I.alternate,I!==null&&(I.lanes|=V)}function he(I,f,w,V){return Ye(I,f,w,V),Ee(I)}function Ge(I,f){return Ye(I,null,null,f),Ee(I)}function be(I,f,w){I.lanes|=w;var V=I.alternate;V!==null&&(V.lanes|=w);for(var Y=!1,J=I.return;J!==null;)J.childLanes|=w,V=J.alternate,V!==null&&(V.childLanes|=w),J.tag===22&&(I=J.stateNode,I===null||I._visibility&1||(Y=!0)),I=J,J=J.return;Y&&f!==null&&I.tag===3&&(J=I.stateNode,Y=31-zo(w),J=J.hiddenUpdates,I=J[Y],I===null?J[Y]=[f]:I.push(f),f.lane=w|536870912)}function Ee(I){if(50<ku)throw ku=0,Ah=null,Error(a(185));for(var f=I.return;f!==null;)I=f,f=I.return;return I.tag===3?I.stateNode:null}function Se(I){I!==kl&&I.next===null&&(kl===null?gC=kl=I:kl=kl.next=I),ki=!0,Eg||(Eg=!0,Xe(Q))}function ee(I,f){if(!$A&&ki){$A=!0;do for(var w=!1,V=gC;V!==null;){if(I!==0){var Y=V.pendingLanes;if(Y===0)var J=0;else{var ve=V.suspendedLanes,Pe=V.pingedLanes;J=(1<<31-zo(42|I)+1)-1,J&=Y&~(ve&~Pe),J=J&201326677?J&201326677|1:J?J|2:0}J!==0&&(w=!0,Ze(V,J))}else J=ci,J=x(V,V===Ni?J:0),(J&3)===0||M(V,J)||(w=!0,Ze(V,J));V=V.next}while(w);$A=!1}}function Q(){ki=Eg=!1;var I=0;Yu!==0&&(Qb()&&(I=Yu),Yu=0);for(var f=os(),w=null,V=gC;V!==null;){var Y=V.next,J=ce(V,f);J===0?(V.next=null,w===null?gC=Y:w.next=Y,Y===null&&(kl=w)):(w=V,(I!==0||(J&3)!==0)&&(ki=!0)),V=Y}ee(I)}function ce(I,f){for(var w=I.suspendedLanes,V=I.pingedLanes,Y=I.expirationTimes,J=I.pendingLanes&-62914561;0<J;){var ve=31-zo(J),Pe=1<<ve,dt=Y[ve];dt===-1?((Pe&w)===0||(Pe&V)!==0)&&(Y[ve]=E(Pe,f)):dt<=f&&(I.expiredLanes|=Pe),J&=~Pe}if(f=Ni,w=ci,w=x(I,I===f?w:0),V=I.callbackNode,w===0||I===f&&Yi===2||I.cancelPendingCommit!==null)return V!==null&&V!==null&&rh(V),I.callbackNode=null,I.callbackPriority=0;if((w&3)===0||M(I,w)){if(f=w&-w,f===I.callbackPriority)return f;switch(V!==null&&rh(V),$(w)){case 2:case 8:w=W0;break;case 32:w=ch;break;case 268435456:w=FS;break;default:w=ch}return V=me.bind(null,I),w=lC(w,V),I.callbackPriority=f,I.callbackNode=w,f}return V!==null&&V!==null&&rh(V),I.callbackPriority=2,I.callbackNode=null,2}function me(I,f){var w=I.callbackNode;if(Rs()&&I.callbackNode!==w)return null;var V=ci;return V=x(I,I===Ni?V:0),V===0?null:(xc(I,V,f),ce(I,os()),I.callbackNode!=null&&I.callbackNode===w?me.bind(null,I):null)}function Ze(I,f){if(Rs())return null;xc(I,f,!0)}function Xe(I){TA?Ol(function(){(bi&6)!==0?lC(lh,I):I()}):lC(lh,I)}function De(){return Yu===0&&(Yu=F()),Yu}function Oe(I,f){if(zu===null){var w=zu=[];Hg=0,xr=De(),Fg={status:"pending",value:void 0,then:function(V){w.push(V)}}}return Hg++,f.then(Je,Je),f}function Je(){if(--Hg===0&&zu!==null){Fg!==null&&(Fg.status="fulfilled");var I=zu;zu=null,xr=0,Fg=null;for(var f=0;f<I.length;f++)(0,I[f])()}}function At(I,f){var w=[],V={status:"pending",value:null,reason:null,then:function(Y){w.push(Y)}};return I.then(function(){V.status="fulfilled",V.value=f;for(var Y=0;Y<w.length;Y++)(0,w[Y])(f)},function(Y){for(V.status="rejected",V.reason=Y,Y=0;Y<w.length;Y++)(0,w[Y])(void 0)}),V}function qe(I){I.updateQueue={baseState:I.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function lt(I,f){I=I.updateQueue,f.updateQueue===I&&(f.updateQueue={baseState:I.baseState,firstBaseUpdate:I.firstBaseUpdate,lastBaseUpdate:I.lastBaseUpdate,shared:I.shared,callbacks:null})}function $e(I){return{lane:I,tag:0,payload:null,callback:null,next:null}}function je(I,f,w){var V=I.updateQueue;if(V===null)return null;if(V=V.shared,(bi&2)!==0){var Y=V.pending;return Y===null?f.next=f:(f.next=Y.next,Y.next=f),V.pending=f,f=Ee(I),be(I,null,w),f}return Ye(I,V,f,w),Ee(I)}function ke(I,f,w){if(f=f.updateQueue,f!==null&&(f=f.shared,(w&4194176)!==0)){var V=f.lanes;V&=I.pendingLanes,w|=V,f.lanes=w,P(I,w)}}function Ce(I,f){var w=I.updateQueue,V=I.alternate;if(V!==null&&(V=V.updateQueue,w===V)){var Y=null,J=null;if(w=w.firstBaseUpdate,w!==null){do{var ve={lane:w.lane,tag:w.tag,payload:w.payload,callback:null,next:null};J===null?Y=J=ve:J=J.next=ve,w=w.next}while(w!==null);J===null?Y=J=f:J=J.next=f}else Y=J=f;w={baseState:V.baseState,firstBaseUpdate:Y,lastBaseUpdate:J,shared:V.shared,callbacks:V.callbacks},I.updateQueue=w;return}I=w.lastBaseUpdate,I===null?w.firstBaseUpdate=f:I.next=f,w.lastBaseUpdate=f}function He(){if(Xg){var I=Fg;if(I!==null)throw I}}function ht(I,f,w,V){Xg=!1;var Y=I.updateQueue;Pl=!1;var J=Y.firstBaseUpdate,ve=Y.lastBaseUpdate,Pe=Y.shared.pending;if(Pe!==null){Y.shared.pending=null;var dt=Pe,zt=dt.next;dt.next=null,ve===null?J=zt:ve.next=zt,ve=dt;var en=I.alternate;en!==null&&(en=en.updateQueue,Pe=en.lastBaseUpdate,Pe!==ve&&(Pe===null?en.firstBaseUpdate=zt:Pe.next=zt,en.lastBaseUpdate=dt))}if(J!==null){var In=Y.baseState;ve=0,en=zt=dt=null,Pe=J;do{var An=Pe.lane&-536870913,Un=An!==Pe.lane;if(Un?(ci&An)===An:(V&An)===An){An!==0&&An===xr&&(Xg=!0),en!==null&&(en=en.next={lane:0,tag:Pe.tag,payload:Pe.payload,callback:null,next:null});e:{var Xr=I,jc=Pe;An=f;var Qc=w;switch(jc.tag){case 1:if(Xr=jc.payload,typeof Xr=="function"){In=Xr.call(Qc,In,An);break e}In=Xr;break e;case 3:Xr.flags=Xr.flags&-65537|128;case 0:if(Xr=jc.payload,An=typeof Xr=="function"?Xr.call(Qc,In,An):Xr,An==null)break e;In=DI({},In,An);break e;case 2:Pl=!0}}An=Pe.callback,An!==null&&(I.flags|=64,Un&&(I.flags|=8192),Un=Y.callbacks,Un===null?Y.callbacks=[An]:Un.push(An))}else Un={lane:An,tag:Pe.tag,payload:Pe.payload,callback:Pe.callback,next:null},en===null?(zt=en=Un,dt=In):en=en.next=Un,ve|=An;if(Pe=Pe.next,Pe===null){if(Pe=Y.shared.pending,Pe===null)break;Un=Pe,Pe=Un.next,Un.next=null,Y.lastBaseUpdate=Un,Y.shared.pending=null}}while(!0);en===null&&(dt=In),Y.baseState=dt,Y.firstBaseUpdate=zt,Y.lastBaseUpdate=en,J===null&&(Y.shared.lanes=0),Hr|=ve,I.lanes=ve,I.memoizedState=In}}function we(I,f){if(typeof I!="function")throw Error(a(191,I));I.call(f)}function ze(I,f){var w=I.callbacks;if(w!==null)for(I.callbacks=null,I=0;I<w.length;I++)we(w[I],f)}function Qe(I,f){if(sr(I,f))return!0;if(typeof I!="object"||I===null||typeof f!="object"||f===null)return!1;var w=Object.keys(I),V=Object.keys(f);if(w.length!==V.length)return!1;for(V=0;V<w.length;V++){var Y=w[V];if(!il.call(f,Y)||!sr(I[Y],f[Y]))return!1}return!0}function ut(I){return I=I.status,I==="fulfilled"||I==="rejected"}function Rt(){}function mt(I,f,w){switch(w=I[w],w===void 0?I.push(f):w!==f&&(f.then(Rt,Rt),f=w),f.status){case"fulfilled":return f.value;case"rejected":throw I=f.reason,I===Ku?Error(a(483)):I;default:if(typeof f.status=="string")f.then(Rt,Rt);else{if(I=Ni,I!==null&&100<I.shellSuspendCounter)throw Error(a(482));I=f,I.status="pending",I.then(function(V){if(f.status==="pending"){var Y=f;Y.status="fulfilled",Y.value=V}},function(V){if(f.status==="pending"){var Y=f;Y.status="rejected",Y.reason=V}})}switch(f.status){case"fulfilled":return f.value;case"rejected":throw I=f.reason,I===Ku?Error(a(483)):I}throw Lc=f,Ku}}function _t(){if(Lc===null)throw Error(a(459));var I=Lc;return Lc=null,I}function Lt(I){var f=Dc;return Dc+=1,_c===null&&(_c=[]),mt(_c,I,f)}function Zt(I,f){f=f.props.ref,I.ref=f!==void 0?f:null}function yt(I,f){throw f.$$typeof===xS?Error(a(525)):(I=Object.prototype.toString.call(f),Error(a(31,I==="[object Object]"?"object with keys {"+Object.keys(f).join(", ")+"}":I)))}function Ht(I){var f=I._init;return f(I._payload)}function jt(I){function f(vt,et){if(I){var wt=vt.deletions;wt===null?(vt.deletions=[et],vt.flags|=16):wt.push(et)}}function w(vt,et){if(!I)return null;for(;et!==null;)f(vt,et),et=et.sibling;return null}function V(vt){for(var et=new Map;vt!==null;)vt.key!==null?et.set(vt.key,vt):et.set(vt.index,vt),vt=vt.sibling;return et}function Y(vt,et){return vt=ts(vt,et),vt.index=0,vt.sibling=null,vt}function J(vt,et,wt){return vt.index=wt,I?(wt=vt.alternate,wt!==null?(wt=wt.index,wt<et?(vt.flags|=33554434,et):wt):(vt.flags|=33554434,et)):(vt.flags|=1048576,et)}function ve(vt){return I&&vt.alternate===null&&(vt.flags|=33554434),vt}function Pe(vt,et,wt,Qt){return et===null||et.tag!==6?(et=LI(wt,vt.mode,Qt),et.return=vt,et):(et=Y(et,wt),et.return=vt,et)}function dt(vt,et,wt,Qt){var Rn=wt.type;return Rn===Ec?en(vt,et,wt.props.children,Qt,wt.key):et!==null&&(et.elementType===Rn||typeof Rn=="object"&&Rn!==null&&Rn.$$typeof===is&&Ht(Rn)===et.type)?(et=Y(et,wt.props),Zt(et,wt),et.return=vt,et):(et=qs(wt.type,wt.key,wt.props,null,vt.mode,Qt),Zt(et,wt),et.return=vt,et)}function zt(vt,et,wt,Qt){return et===null||et.tag!==4||et.stateNode.containerInfo!==wt.containerInfo||et.stateNode.implementation!==wt.implementation?(et=MA(wt,vt.mode,Qt),et.return=vt,et):(et=Y(et,wt.children||[]),et.return=vt,et)}function en(vt,et,wt,Qt,Rn){return et===null||et.tag!==7?(et=ua(wt,vt.mode,Qt,Rn),et.return=vt,et):(et=Y(et,wt),et.return=vt,et)}function In(vt,et,wt){if(typeof et=="string"&&et!==""||typeof et=="number"||typeof et=="bigint")return et=LI(""+et,vt.mode,wt),et.return=vt,et;if(typeof et=="object"&&et!==null){switch(et.$$typeof){case Qd:return wt=qs(et.type,et.key,et.props,null,vt.mode,wt),Zt(wt,et),wt.return=vt,wt;case ns:return et=MA(et,vt.mode,wt),et.return=vt,et;case is:var Qt=et._init;return et=Qt(et._payload),In(vt,et,wt)}if(xu(et)||o(et))return et=ua(et,vt.mode,wt,null),et.return=vt,et;if(typeof et.then=="function")return In(vt,Lt(et),wt);if(et.$$typeof===Zs)return In(vt,Fd(vt,et),wt);yt(vt,et)}return null}function An(vt,et,wt,Qt){var Rn=et!==null?et.key:null;if(typeof wt=="string"&&wt!==""||typeof wt=="number"||typeof wt=="bigint")return Rn!==null?null:Pe(vt,et,""+wt,Qt);if(typeof wt=="object"&&wt!==null){switch(wt.$$typeof){case Qd:return wt.key===Rn?dt(vt,et,wt,Qt):null;case ns:return wt.key===Rn?zt(vt,et,wt,Qt):null;case is:return Rn=wt._init,wt=Rn(wt._payload),An(vt,et,wt,Qt)}if(xu(wt)||o(wt))return Rn!==null?null:en(vt,et,wt,Qt,null);if(typeof wt.then=="function")return An(vt,et,Lt(wt),Qt);if(wt.$$typeof===Zs)return An(vt,et,Fd(vt,wt),Qt);yt(vt,wt)}return null}function Un(vt,et,wt,Qt,Rn){if(typeof Qt=="string"&&Qt!==""||typeof Qt=="number"||typeof Qt=="bigint")return vt=vt.get(wt)||null,Pe(et,vt,""+Qt,Rn);if(typeof Qt=="object"&&Qt!==null){switch(Qt.$$typeof){case Qd:return vt=vt.get(Qt.key===null?wt:Qt.key)||null,dt(et,vt,Qt,Rn);case ns:return vt=vt.get(Qt.key===null?wt:Qt.key)||null,zt(et,vt,Qt,Rn);case is:var na=Qt._init;return Qt=na(Qt._payload),Un(vt,et,wt,Qt,Rn)}if(xu(Qt)||o(Qt))return vt=vt.get(wt)||null,en(et,vt,Qt,Rn,null);if(typeof Qt.then=="function")return Un(vt,et,wt,Lt(Qt),Rn);if(Qt.$$typeof===Zs)return Un(vt,et,wt,Fd(et,Qt),Rn);yt(et,Qt)}return null}function Xr(vt,et,wt,Qt){for(var Rn=null,na=null,zn=et,wi=et=0,wa=null;zn!==null&&wi<wt.length;wi++){zn.index>wi?(wa=zn,zn=null):wa=zn.sibling;var ri=An(vt,zn,wt[wi],Qt);if(ri===null){zn===null&&(zn=wa);break}I&&zn&&ri.alternate===null&&f(vt,zn),et=J(ri,et,wi),na===null?Rn=ri:na.sibling=ri,na=ri,zn=wa}if(wi===wt.length)return w(vt,zn),fi&&K(vt,wi),Rn;if(zn===null){for(;wi<wt.length;wi++)zn=In(vt,wt[wi],Qt),zn!==null&&(et=J(zn,et,wi),na===null?Rn=zn:na.sibling=zn,na=zn);return fi&&K(vt,wi),Rn}for(zn=V(zn);wi<wt.length;wi++)wa=Un(zn,vt,wi,wt[wi],Qt),wa!==null&&(I&&wa.alternate!==null&&zn.delete(wa.key===null?wi:wa.key),et=J(wa,et,wi),na===null?Rn=wa:na.sibling=wa,na=wa);return I&&zn.forEach(function(ul){return f(vt,ul)}),fi&&K(vt,wi),Rn}function jc(vt,et,wt,Qt){if(wt==null)throw Error(a(151));for(var Rn=null,na=null,zn=et,wi=et=0,wa=null,ri=wt.next();zn!==null&&!ri.done;wi++,ri=wt.next()){zn.index>wi?(wa=zn,zn=null):wa=zn.sibling;var ul=An(vt,zn,ri.value,Qt);if(ul===null){zn===null&&(zn=wa);break}I&&zn&&ul.alternate===null&&f(vt,zn),et=J(ul,et,wi),na===null?Rn=ul:na.sibling=ul,na=ul,zn=wa}if(ri.done)return w(vt,zn),fi&&K(vt,wi),Rn;if(zn===null){for(;!ri.done;wi++,ri=wt.next())ri=In(vt,ri.value,Qt),ri!==null&&(et=J(ri,et,wi),na===null?Rn=ri:na.sibling=ri,na=ri);return fi&&K(vt,wi),Rn}for(zn=V(zn);!ri.done;wi++,ri=wt.next())ri=Un(zn,vt,wi,ri.value,Qt),ri!==null&&(I&&ri.alternate!==null&&zn.delete(ri.key===null?wi:ri.key),et=J(ri,et,wi),na===null?Rn=ri:na.sibling=ri,na=ri);return I&&zn.forEach(function(mh){return f(vt,mh)}),fi&&K(vt,wi),Rn}function Qc(vt,et,wt,Qt){if(typeof wt=="object"&&wt!==null&&wt.type===Ec&&wt.key===null&&(wt=wt.props.children),typeof wt=="object"&&wt!==null){switch(wt.$$typeof){case Qd:e:{for(var Rn=wt.key;et!==null;){if(et.key===Rn){if(Rn=wt.type,Rn===Ec){if(et.tag===7){w(vt,et.sibling),Qt=Y(et,wt.props.children),Qt.return=vt,vt=Qt;break e}}else if(et.elementType===Rn||typeof Rn=="object"&&Rn!==null&&Rn.$$typeof===is&&Ht(Rn)===et.type){w(vt,et.sibling),Qt=Y(et,wt.props),Zt(Qt,wt),Qt.return=vt,vt=Qt;break e}w(vt,et);break}else f(vt,et);et=et.sibling}wt.type===Ec?(Qt=ua(wt.props.children,vt.mode,Qt,wt.key),Qt.return=vt,vt=Qt):(Qt=qs(wt.type,wt.key,wt.props,null,vt.mode,Qt),Zt(Qt,wt),Qt.return=vt,vt=Qt)}return ve(vt);case ns:e:{for(Rn=wt.key;et!==null;){if(et.key===Rn)if(et.tag===4&&et.stateNode.containerInfo===wt.containerInfo&&et.stateNode.implementation===wt.implementation){w(vt,et.sibling),Qt=Y(et,wt.children||[]),Qt.return=vt,vt=Qt;break e}else{w(vt,et);break}else f(vt,et);et=et.sibling}Qt=MA(wt,vt.mode,Qt),Qt.return=vt,vt=Qt}return ve(vt);case is:return Rn=wt._init,wt=Rn(wt._payload),Qc(vt,et,wt,Qt)}if(xu(wt))return Xr(vt,et,wt,Qt);if(o(wt)){if(Rn=o(wt),typeof Rn!="function")throw Error(a(150));return wt=Rn.call(wt),jc(vt,et,wt,Qt)}if(typeof wt.then=="function")return Qc(vt,et,Lt(wt),Qt);if(wt.$$typeof===Zs)return Qc(vt,et,Fd(vt,wt),Qt);yt(vt,wt)}return typeof wt=="string"&&wt!==""||typeof wt=="number"||typeof wt=="bigint"?(wt=""+wt,et!==null&&et.tag===6?(w(vt,et.sibling),Qt=Y(et,wt),Qt.return=vt,vt=Qt):(w(vt,et),Qt=LI(wt,vt.mode,Qt),Qt.return=vt,vt=Qt),ve(vt)):w(vt,et)}return function(vt,et,wt,Qt){try{Dc=0;var Rn=Qc(vt,et,wt,Qt);return _c=null,Rn}catch(zn){if(zn===Ku)throw zn;var na=t(29,zn,null,vt.mode);return na.lanes=Qt,na.return=vt,na}finally{}}}function Ut(I,f){I=Go,S(Lu,I),S(Pi,f),Go=I|f.baseLanes}function Nt(){S(Lu,Go),S(Pi,Pi.current)}function Tt(){Go=Lu.current,y(Pi),y(Lu)}function Pt(I){var f=I.alternate;S(Xa,Xa.current&1),S(Mr,I),_i===null&&(f===null||Pi.current!==null||f.memoizedState!==null)&&(_i=I)}function qt(I){if(I.tag===22){if(S(Xa,Xa.current),S(Mr,I),_i===null){var f=I.alternate;f!==null&&f.memoizedState!==null&&(_i=I)}}else kt()}function kt(){S(Xa,Xa.current),S(Mr,Mr.current)}function Ft(I){y(Mr),_i===I&&(_i=null),y(Xa)}function fn(I){for(var f=I;f!==null;){if(f.tag===13){var w=f.memoizedState;if(w!==null&&(w=w.dehydrated,w===null||$I(w)||eh(w)))return f}else if(f.tag===19&&f.memoizedProps.revealOrder!==void 0){if((f.flags&128)!==0)return f}else if(f.child!==null){f.child.return=f,f=f.child;continue}if(f===I)break;for(;f.sibling===null;){if(f.return===null||f.return===I)return null;f=f.return}f.sibling.return=f.return,f=f.sibling}return null}function sn(){throw Error(a(321))}function ae(I,f){if(f===null)return!1;for(var w=0;w<f.length&&w<I.length;w++)if(!sr(I[w],f[w]))return!1;return!0}function ue(I,f,w,V,Y,J){return Jl=J,ei=f,f.memoizedState=null,f.updateQueue=null,f.lanes=0,Yn.H=I===null||I.memoizedState===null?kc:Ko,Uc=!1,J=w(V,Y),Uc=!1,Tg&&(J=ot(f,w,V,Y)),Fe(I),J}function Fe(I){Yn.H=da;var f=Nn!==null&&Nn.next!==null;if(Jl=0,pi=Nn=ei=null,ls=!1,Yg=0,Qa=null,f)throw Error(a(300));I===null||Di||(I=I.dependencies,I!==null&&Hd(I)&&(Di=!0))}function ot(I,f,w,V){ei=I;var Y=0;do{if(Tg&&(Qa=null),Yg=0,Tg=!1,25<=Y)throw Error(a(301));if(Y+=1,pi=Nn=null,I.updateQueue!=null){var J=I.updateQueue;J.lastEffect=null,J.events=null,J.stores=null,J.memoCache!=null&&(J.memoCache.index=0)}Yn.H=Wr,J=f(w,V)}while(Tg);return J}function at(){var I=Yn.H,f=I.useState()[0];return f=typeof f.then=="function"?Ae(f):f,I=I.useState()[0],(Nn!==null?Nn.memoizedState:null)!==I&&(ei.flags|=1024),f}function It(){var I=gh!==0;return gh=0,I}function Wt(I,f,w){f.updateQueue=I.updateQueue,f.flags&=-2053,I.lanes&=~w}function xt(I){if(ls){for(I=I.memoizedState;I!==null;){var f=I.queue;f!==null&&(f.pending=null),I=I.next}ls=!1}Jl=0,pi=Nn=ei=null,Tg=!1,Yg=gh=0,Qa=null}function te(){var I={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return pi===null?ei.memoizedState=pi=I:pi=pi.next=I,pi}function Ie(){if(Nn===null){var I=ei.alternate;I=I!==null?I.memoizedState:null}else I=Nn.next;var f=pi===null?ei.memoizedState:pi.next;if(f!==null)pi=f,Nn=I;else{if(I===null)throw ei.alternate===null?Error(a(467)):Error(a(310));Nn=I,I={memoizedState:Nn.memoizedState,baseState:Nn.baseState,baseQueue:Nn.baseQueue,queue:Nn.queue,next:null},pi===null?ei.memoizedState=pi=I:pi=pi.next=I}return pi}function Ae(I){var f=Yg;return Yg+=1,Qa===null&&(Qa=[]),I=mt(Qa,I,f),f=ei,(pi===null?f.memoizedState:pi.next)===null&&(f=f.alternate,Yn.H=f===null||f.memoizedState===null?kc:Ko),I}function se(I){if(I!==null&&typeof I=="object"){if(typeof I.then=="function")return Ae(I);if(I.$$typeof===Zs)return oo(I)}throw Error(a(438,String(I)))}function Re(I){var f=null,w=ei.updateQueue;if(w!==null&&(f=w.memoCache),f==null){var V=ei.alternate;V!==null&&(V=V.updateQueue,V!==null&&(V=V.memoCache,V!=null&&(f={data:V.data.map(function(Y){return Y.slice()}),index:0})))}if(f==null&&(f={data:[],index:0}),w===null&&(w=uh(),ei.updateQueue=w),w.memoCache=f,w=f.data[f.index],w===void 0)for(w=f.data[f.index]=Array(I),V=0;V<I;V++)w[V]=Ub;return f.index++,w}function Ue(I,f){return typeof f=="function"?f(I):f}function nt(I){var f=Ie();return pt(f,Nn,I)}function pt(I,f,w){var V=I.queue;if(V===null)throw Error(a(311));V.lastRenderedReducer=w;var Y=I.baseQueue,J=V.pending;if(J!==null){if(Y!==null){var ve=Y.next;Y.next=J.next,J.next=ve}f.baseQueue=Y=J,V.pending=null}if(J=I.baseState,Y===null)I.memoizedState=J;else{f=Y.next;var Pe=ve=null,dt=null,zt=f,en=!1;do{var In=zt.lane&-536870913;if(In!==zt.lane?(ci&In)===In:(Jl&In)===In){var An=zt.revertLane;if(An===0)dt!==null&&(dt=dt.next={lane:0,revertLane:0,action:zt.action,hasEagerState:zt.hasEagerState,eagerState:zt.eagerState,next:null}),In===xr&&(en=!0);else if((Jl&An)===An){zt=zt.next,An===xr&&(en=!0);continue}else In={lane:0,revertLane:zt.revertLane,action:zt.action,hasEagerState:zt.hasEagerState,eagerState:zt.eagerState,next:null},dt===null?(Pe=dt=In,ve=J):dt=dt.next=In,ei.lanes|=An,Hr|=An;In=zt.action,Uc&&w(J,In),J=zt.hasEagerState?zt.eagerState:w(J,In)}else An={lane:In,revertLane:zt.revertLane,action:zt.action,hasEagerState:zt.hasEagerState,eagerState:zt.eagerState,next:null},dt===null?(Pe=dt=An,ve=J):dt=dt.next=An,ei.lanes|=In,Hr|=In;zt=zt.next}while(zt!==null&&zt!==f);if(dt===null?ve=J:dt.next=Pe,!sr(J,I.memoizedState)&&(Di=!0,en&&(w=Fg,w!==null)))throw w;I.memoizedState=J,I.baseState=ve,I.baseQueue=dt,V.lastRenderedState=J}return Y===null&&(V.lanes=0),[I.memoizedState,V.dispatch]}function it(I){var f=Ie(),w=f.queue;if(w===null)throw Error(a(311));w.lastRenderedReducer=I;var V=w.dispatch,Y=w.pending,J=f.memoizedState;if(Y!==null){w.pending=null;var ve=Y=Y.next;do J=I(J,ve.action),ve=ve.next;while(ve!==Y);sr(J,f.memoizedState)||(Di=!0),f.memoizedState=J,f.baseQueue===null&&(f.baseState=J),w.lastRenderedState=J}return[J,V]}function Bt(I,f,w){var V=ei,Y=Ie(),J=fi;if(J){if(w===void 0)throw Error(a(407));w=w()}else w=f();var ve=!sr((Nn||Y).memoizedState,w);if(ve&&(Y.memoizedState=w,Di=!0),Y=Y.queue,mr(ln.bind(null,V,Y,I),[I]),Y.getSnapshot!==f||ve||pi!==null&&pi.memoizedState.tag&1){if(V.flags|=2048,li(9,Yt.bind(null,V,Y,w,f),{destroy:void 0},null),Ni===null)throw Error(a(349));J||(Jl&60)!==0||Mt(V,f,w)}return w}function Mt(I,f,w){I.flags|=16384,I={getSnapshot:f,value:w},f=ei.updateQueue,f===null?(f=uh(),ei.updateQueue=f,f.stores=[I]):(w=f.stores,w===null?f.stores=[I]:w.push(I))}function Yt(I,f,w,V){f.value=w,f.getSnapshot=V,on(f)&&vn(I)}function ln(I,f,w){return w(function(){on(f)&&vn(I)})}function on(I){var f=I.getSnapshot;I=I.value;try{var w=f();return!sr(I,w)}catch{return!0}}function vn(I){var f=Ge(I,2);f!==null&&Pa(f,I,2)}function nn(I){var f=te();if(typeof I=="function"){var w=I;if(I=w(),Uc){L(!0);try{w()}finally{L(!1)}}}return f.memoizedState=f.baseState=I,f.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ue,lastRenderedState:I},f}function mn(I,f,w,V){return I.baseState=w,pt(I,Nn,typeof V=="function"?V:Ue)}function gn(I,f,w,V,Y){if(vc(I))throw Error(a(485));if(I=f.action,I!==null){var J={payload:Y,action:I,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(ve){J.listeners.push(ve)}};Yn.T!==null?w(!0):J.isTransition=!1,V(J),w=f.pending,w===null?(J.next=f.pending=J,Xn(f,J)):(J.next=w.next,f.pending=w.next=J)}}function Xn(I,f){var w=f.action,V=f.payload,Y=I.state;if(f.isTransition){var J=Yn.T,ve={};Yn.T=ve;try{var Pe=w(Y,V),dt=Yn.S;dt!==null&&dt(ve,Pe),bn(I,f,Pe)}catch(zt){Jt(I,f,zt)}finally{Yn.T=J}}else try{J=w(Y,V),bn(I,f,J)}catch(zt){Jt(I,f,zt)}}function bn(I,f,w){w!==null&&typeof w=="object"&&typeof w.then=="function"?w.then(function(V){cn(I,f,V)},function(V){return Jt(I,f,V)}):cn(I,f,w)}function cn(I,f,w){f.status="fulfilled",f.value=w,Et(f),I.state=w,f=I.pending,f!==null&&(w=f.next,w===f?I.pending=null:(w=w.next,f.next=w,Xn(I,w)))}function Jt(I,f,w){var V=I.pending;if(I.pending=null,V!==null){V=V.next;do f.status="rejected",f.reason=w,Et(f),f=f.next;while(f!==V)}I.action=null}function Et(I){I=I.listeners;for(var f=0;f<I.length;f++)(0,I[f])()}function rn(I,f){return f}function Cn(I,f){if(fi){var w=Ni.formState;if(w!==null){e:{var V=ei;if(fi){if(uo){var Y=kA(uo,ja);if(Y){uo=PA(Y),V=I0(Y);break e}}de(V)}V=!1}V&&(f=w[0])}}w=te(),w.memoizedState=w.baseState=f,V={pending:null,lanes:0,dispatch:null,lastRenderedReducer:rn,lastRenderedState:f},w.queue=V,w=Js.bind(null,ei,V),V.dispatch=w,V=nn(!1);var J=Qo.bind(null,ei,!1,V.queue);return V=te(),Y={state:f,dispatch:null,action:I,pending:null},V.queue=Y,w=gn.bind(null,ei,Y,J,w),Y.dispatch=w,V.memoizedState=I,[f,w,!1]}function Gn(I){var f=Ie();return pn(f,Nn,I)}function pn(I,f,w){f=pt(I,f,rn)[0],I=nt(Ue)[0],f=typeof f=="object"&&f!==null&&typeof f.then=="function"?Ae(f):f;var V=Ie(),Y=V.queue,J=Y.dispatch;return w!==V.memoizedState&&(ei.flags|=2048,li(9,Kn.bind(null,Y,w),{destroy:void 0},null)),[f,J,I]}function Kn(I,f){I.action=f}function Qn(I){var f=Ie(),w=Nn;if(w!==null)return pn(f,w,I);Ie(),f=f.memoizedState,w=Ie();var V=w.queue.dispatch;return w.memoizedState=I,[f,V,!1]}function li(I,f,w,V){return I={tag:I,create:f,inst:w,deps:V,next:null},f=ei.updateQueue,f===null&&(f=uh(),ei.updateQueue=f),w=f.lastEffect,w===null?f.lastEffect=I.next=I:(V=w.next,w.next=I,I.next=V,f.lastEffect=I),I}function Zi(){return Ie().memoizedState}function aa(I,f,w,V){var Y=te();ei.flags|=I,Y.memoizedState=li(1|f,w,{destroy:void 0},V===void 0?null:V)}function pa(I,f,w,V){var Y=Ie();V=V===void 0?null:V;var J=Y.memoizedState.inst;Nn!==null&&V!==null&&ae(V,Nn.memoizedState.deps)?Y.memoizedState=li(f,w,J,V):(ei.flags|=I,Y.memoizedState=li(1|f,w,J,V))}function oa(I,f){aa(8390656,8,I,f)}function mr(I,f){pa(2048,8,I,f)}function bc(I,f){return pa(4,2,I,f)}function pr(I,f){return pa(4,4,I,f)}function Ki(I,f){if(typeof f=="function"){I=I();var w=f(I);return function(){typeof w=="function"?w():f(null)}}if(f!=null)return I=I(),f.current=I,function(){f.current=null}}function Ua(I,f,w){w=w!=null?w.concat([I]):null,pa(4,4,Ki.bind(null,f,I),w)}function ba(){}function Ea(I,f){var w=Ie();f=f===void 0?null:f;var V=w.memoizedState;return f!==null&&ae(f,V[1])?V[0]:(w.memoizedState=[I,f],I)}function po(I,f){var w=Ie();f=f===void 0?null:f;var V=w.memoizedState;if(f!==null&&ae(f,V[1]))return V[0];if(V=I(),Uc){L(!0);try{I()}finally{L(!1)}}return w.memoizedState=[V,f],V}function jo(I,f,w){return w===void 0||(Jl&1073741824)!==0?I.memoizedState=f:(I.memoizedState=w,I=GA(),ei.lanes|=I,Hr|=I,w)}function Jr(I,f,w,V){return sr(w,f)?w:Pi.current!==null?(I=jo(I,w,V),sr(I,f)||(Di=!0),I):(Jl&42)===0?(Di=!0,I.memoizedState=w):(I=GA(),ei.lanes|=I,Hr|=I,f)}function br(I,f,w,V,Y){var J=Dl();yo(J!==0&&8>J?J:8);var ve=Yn.T,Pe={};Yn.T=Pe,Qo(I,!1,f,w);try{var dt=Y(),zt=Yn.S;if(zt!==null&&zt(Pe,dt),dt!==null&&typeof dt=="object"&&typeof dt.then=="function"){var en=At(dt,V);Eo(I,f,en,ya(I))}else Eo(I,f,V,ya(I))}catch(In){Eo(I,f,{then:function(){},status:"rejected",reason:In},ya())}finally{yo(J),Yn.T=ve}}function un(I){var f=I.memoizedState;if(f!==null)return f;f={memoizedState:Fc,baseState:Fc,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ue,lastRenderedState:Fc},next:null};var w={};return f.next={memoizedState:w,baseState:w,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ue,lastRenderedState:w},next:null},I.memoizedState=f,I=I.alternate,I!==null&&(I.memoizedState=f),f}function wn(){return oo(xs)}function hi(){return Ie().memoizedState}function Dn(){return Ie().memoizedState}function Gi(I){for(var f=I.return;f!==null;){switch(f.tag){case 24:case 3:var w=ya();I=$e(w);var V=je(f,I,w);V!==null&&(Pa(V,f,w),ke(V,f,w)),f={cache:Gc()},I.payload=f;return}f=f.return}}function jr(I,f,w){var V=ya();w={lane:V,revertLane:0,action:w,hasEagerState:!1,eagerState:null,next:null},vc(I)?va(f,w):(w=he(I,f,w,V),w!==null&&(Pa(w,I,V),qo(w,f,V)))}function Js(I,f,w){var V=ya();Eo(I,f,w,V)}function Eo(I,f,w,V){var Y={lane:V,revertLane:0,action:w,hasEagerState:!1,eagerState:null,next:null};if(vc(I))va(f,Y);else{var J=I.alternate;if(I.lanes===0&&(J===null||J.lanes===0)&&(J=f.lastRenderedReducer,J!==null))try{var ve=f.lastRenderedState,Pe=J(ve,w);if(Y.hasEagerState=!0,Y.eagerState=Pe,sr(Pe,ve))return Ye(I,f,Y,0),Ni===null&&le(),!1}catch{}finally{}if(w=he(I,f,Y,V),w!==null)return Pa(w,I,V),qo(w,f,V),!0}return!1}function Qo(I,f,w,V){if(V={lane:2,revertLane:De(),action:V,hasEagerState:!1,eagerState:null,next:null},vc(I)){if(f)throw Error(a(479))}else f=he(I,w,V,2),f!==null&&Pa(f,I,2)}function vc(I){var f=I.alternate;return I===ei||f!==null&&f===ei}function va(I,f){Tg=ls=!0;var w=I.pending;w===null?f.next=f:(f.next=w.next,w.next=f),I.pending=f}function qo(I,f,w){if((w&4194176)!==0){var V=f.lanes;V&=I.pendingLanes,w|=V,f.lanes=w,P(I,w)}}function Ho(I,f,w,V){f=I.memoizedState,w=w(V,f),w=w==null?f:DI({},f,w),I.memoizedState=w,I.lanes===0&&(I.updateQueue.baseState=w)}function Zl(I,f,w,V,Y,J,ve){return I=I.stateNode,typeof I.shouldComponentUpdate=="function"?I.shouldComponentUpdate(V,J,ve):f.prototype&&f.prototype.isPureReactComponent?!Qe(w,V)||!Qe(Y,J):!0}function fu(I,f,w,V){I=f.state,typeof f.componentWillReceiveProps=="function"&&f.componentWillReceiveProps(w,V),typeof f.UNSAFE_componentWillReceiveProps=="function"&&f.UNSAFE_componentWillReceiveProps(w,V),f.state!==I&&ol.enqueueReplaceState(f,f.state,null)}function vr(I,f){var w=f;if("ref"in f){w={};for(var V in f)V!=="ref"&&(w[V]=f[V])}if(I=I.defaultProps){w===f&&(w=DI({},w));for(var Y in I)w[Y]===void 0&&(w[Y]=I[Y])}return w}function Qr(I,f){try{var w=I.onUncaughtError;w(f.value,{componentStack:f.stack})}catch(V){setTimeout(function(){throw V})}}function xl(I,f,w){try{var V=I.onCaughtError;V(w.value,{componentStack:w.stack,errorBoundary:f.tag===1?f.stateNode:null})}catch(Y){setTimeout(function(){throw Y})}}function qr(I,f,w){return w=$e(w),w.tag=3,w.payload={element:null},w.callback=function(){Qr(I,f)},w}function vg(I){return I=$e(I),I.tag=3,I}function bo(I,f,w,V){var Y=w.type.getDerivedStateFromError;if(typeof Y=="function"){var J=V.value;I.payload=function(){return Y(J)},I.callback=function(){xl(f,w,V)}}var ve=w.stateNode;ve!==null&&typeof ve.componentDidCatch=="function"&&(I.callback=function(){xl(f,w,V),typeof Y!="function"&&(Pc===null?Pc=new Set([this]):Pc.add(this));var Pe=V.stack;this.componentDidCatch(V.value,{componentStack:Pe!==null?Pe:""})})}function rA(I,f,w,V,Y){if(w.flags|=32768,V!==null&&typeof V=="object"&&typeof V.then=="function"){if(f=w.alternate,f!==null&&Ed(f,w,Y,!0),w=Mr.current,w!==null){switch(w.tag){case 13:return _i===null?Tl():w.alternate===null&&Oi===0&&(Oi=3),w.flags&=-257,w.flags|=65536,w.lanes=Y,V===dC?w.flags|=16384:(f=w.updateQueue,f===null?w.updateQueue=new Set([V]):f.add(V),Gg(I,V,Y)),!1;case 22:return w.flags|=65536,V===dC?w.flags|=16384:(f=w.updateQueue,f===null?(f={transitions:null,markerInstances:null,retryQueue:new Set([V])},w.updateQueue=f):(w=f.retryQueue,w===null?f.retryQueue=new Set([V]):w.add(V)),Gg(I,V,Y)),!1}throw Error(a(435,w.tag))}return Gg(I,V,Y),Tl(),!1}if(fi)return f=Mr.current,f!==null?((f.flags&65536)===0&&(f.flags|=256),f.flags|=65536,f.lanes=Y,V!==cC&&(I=Error(a(422),{cause:V}),Te(q(I,w)))):(V!==cC&&(f=Error(a(423),{cause:V}),Te(q(f,w))),I=I.current.alternate,I.flags|=65536,Y&=-Y,I.lanes|=Y,V=q(V,w),Y=qr(I.stateNode,V,Y),Ce(I,Y),Oi!==4&&(Oi=2)),!1;var J=Error(a(520),{cause:V});if(J=q(J,w),Kg===null?Kg=[J]:Kg.push(J),Oi!==4&&(Oi=2),f===null)return!0;V=q(V,w),w=f;do{switch(w.tag){case 3:return w.flags|=65536,I=Y&-Y,w.lanes|=I,I=qr(w.stateNode,V,I),Ce(w,I),!1;case 1:if(f=w.type,J=w.stateNode,(w.flags&128)===0&&(typeof f.getDerivedStateFromError=="function"||J!==null&&typeof J.componentDidCatch=="function"&&(Pc===null||!Pc.has(J))))return w.flags|=65536,Y&=-Y,w.lanes|=Y,Y=vg(Y),bo(Y,I,w,V),Ce(w,Y),!1}w=w.return}while(w!==null);return!1}function ga(I,f,w,V){f.child=I===null?al(f,null,w,V):Oc(f,I.child,w,V)}function Ml(I,f,w,V,Y){w=w.render;var J=f.ref;if("ref"in V){var ve={};for(var Pe in V)Pe!=="ref"&&(ve[Pe]=V[Pe])}else ve=V;return Bc(f),V=ue(I,f,w,ve,J,Y),Pe=It(),I!==null&&!Di?(Wt(I,f,Y),Wl(I,f,Y)):(fi&&Pe&&j(f),f.flags|=1,ga(I,f,V,Y),f.child)}function Md(I,f,w,V,Y){if(I===null){var J=w.type;return typeof J=="function"&&!kd(J)&&J.defaultProps===void 0&&w.compare===null?(f.tag=15,f.type=J,RI(I,f,J,V,Y)):(I=qs(w.type,null,V,f,f.mode,Y),I.ref=f.ref,I.return=f,f.child=I)}if(J=I.child,!uA(I,Y)){var ve=J.memoizedProps;if(w=w.compare,w=w!==null?w:Qe,w(ve,V)&&I.ref===f.ref)return Wl(I,f,Y)}return f.flags|=1,I=ts(J,V),I.ref=f.ref,I.return=f,f.child=I}function RI(I,f,w,V,Y){if(I!==null){var J=I.memoizedProps;if(Qe(J,V)&&I.ref===f.ref)if(Di=!1,f.pendingProps=V=J,uA(I,Y))(I.flags&131072)!==0&&(Di=!0);else return f.lanes=I.lanes,Wl(I,f,Y)}return yr(I,f,w,V,Y)}function ao(I,f,w){var V=f.pendingProps,Y=V.children,J=(f.stateNode._pendingVisibility&2)!==0,ve=I!==null?I.memoizedState:null;if(xa(I,f),V.mode==="hidden"||J){if((f.flags&128)!==0){if(V=ve!==null?ve.baseLanes|w:w,I!==null){for(Y=f.child=I.child,J=0;Y!==null;)J=J|Y.lanes|Y.childLanes,Y=Y.sibling;f.childLanes=J&~V}else f.childLanes=0,f.child=null;return $o(I,f,V,w)}if((w&536870912)!==0)f.memoizedState={baseLanes:0,cachePool:null},I!==null&&xI(f,ve!==null?ve.cachePool:null),ve!==null?Ut(f,ve):Nt(),qt(f);else return f.lanes=f.childLanes=536870912,$o(I,f,ve!==null?ve.baseLanes|w:w,w)}else ve!==null?(xI(f,ve.cachePool),Ut(f,ve),kt(),f.memoizedState=null):(I!==null&&xI(f,null),Nt(),kt());return ga(I,f,Y,w),f.child}function $o(I,f,w,V){var Y=CA();return Y=Y===null?null:{parent:To?Ji._currentValue:Ji._currentValue2,pool:Y},f.memoizedState={baseLanes:w,cachePool:Y},I!==null&&xI(f,null),Nt(),qt(f),I!==null&&Ed(I,f,V,!0),null}function xa(I,f){var w=f.ref;if(w===null)I!==null&&I.ref!==null&&(f.flags|=2097664);else{if(typeof w!="function"&&typeof w!="object")throw Error(a(284));(I===null||I.ref!==w)&&(f.flags|=2097664)}}function yr(I,f,w,V,Y){return Bc(f),w=ue(I,f,w,V,void 0,Y),V=It(),I!==null&&!Di?(Wt(I,f,Y),Wl(I,f,Y)):(fi&&V&&j(f),f.flags|=1,ga(I,f,w,Y),f.child)}function Wd(I,f,w,V,Y,J){return Bc(f),f.updateQueue=null,w=ot(f,V,w,Y),Fe(I),V=It(),I!==null&&!Di?(Wt(I,f,J),Wl(I,f,J)):(fi&&V&&j(f),f.flags|=1,ga(I,f,w,J),f.child)}function Vb(I,f,w,V,Y){if(Bc(f),f.stateNode===null){var J=zc,ve=w.contextType;typeof ve=="object"&&ve!==null&&(J=oo(ve)),J=new w(V,J),f.memoizedState=J.state!==null&&J.state!==void 0?J.state:null,J.updater=ol,f.stateNode=J,J._reactInternals=f,J=f.stateNode,J.props=V,J.state=f.memoizedState,J.refs={},qe(f),ve=w.contextType,J.context=typeof ve=="object"&&ve!==null?oo(ve):zc,J.state=f.memoizedState,ve=w.getDerivedStateFromProps,typeof ve=="function"&&(Ho(f,w,ve,V),J.state=f.memoizedState),typeof w.getDerivedStateFromProps=="function"||typeof J.getSnapshotBeforeUpdate=="function"||typeof J.UNSAFE_componentWillMount!="function"&&typeof J.componentWillMount!="function"||(ve=J.state,typeof J.componentWillMount=="function"&&J.componentWillMount(),typeof J.UNSAFE_componentWillMount=="function"&&J.UNSAFE_componentWillMount(),ve!==J.state&&ol.enqueueReplaceState(J,J.state,null),ht(f,V,J,Y),He(),J.state=f.memoizedState),typeof J.componentDidMount=="function"&&(f.flags|=4194308),V=!0}else if(I===null){J=f.stateNode;var Pe=f.memoizedProps,dt=vr(w,Pe);J.props=dt;var zt=J.context,en=w.contextType;ve=zc,typeof en=="object"&&en!==null&&(ve=oo(en));var In=w.getDerivedStateFromProps;en=typeof In=="function"||typeof J.getSnapshotBeforeUpdate=="function",Pe=f.pendingProps!==Pe,en||typeof J.UNSAFE_componentWillReceiveProps!="function"&&typeof J.componentWillReceiveProps!="function"||(Pe||zt!==ve)&&fu(f,J,V,ve),Pl=!1;var An=f.memoizedState;J.state=An,ht(f,V,J,Y),He(),zt=f.memoizedState,Pe||An!==zt||Pl?(typeof In=="function"&&(Ho(f,w,In,V),zt=f.memoizedState),(dt=Pl||Zl(f,w,dt,V,An,zt,ve))?(en||typeof J.UNSAFE_componentWillMount!="function"&&typeof J.componentWillMount!="function"||(typeof J.componentWillMount=="function"&&J.componentWillMount(),typeof J.UNSAFE_componentWillMount=="function"&&J.UNSAFE_componentWillMount()),typeof J.componentDidMount=="function"&&(f.flags|=4194308)):(typeof J.componentDidMount=="function"&&(f.flags|=4194308),f.memoizedProps=V,f.memoizedState=zt),J.props=V,J.state=zt,J.context=ve,V=dt):(typeof J.componentDidMount=="function"&&(f.flags|=4194308),V=!1)}else{J=f.stateNode,lt(I,f),ve=f.memoizedProps,en=vr(w,ve),J.props=en,In=f.pendingProps,An=J.context,zt=w.contextType,dt=zc,typeof zt=="object"&&zt!==null&&(dt=oo(zt)),Pe=w.getDerivedStateFromProps,(zt=typeof Pe=="function"||typeof J.getSnapshotBeforeUpdate=="function")||typeof J.UNSAFE_componentWillReceiveProps!="function"&&typeof J.componentWillReceiveProps!="function"||(ve!==In||An!==dt)&&fu(f,J,V,dt),Pl=!1,An=f.memoizedState,J.state=An,ht(f,V,J,Y),He();var Un=f.memoizedState;ve!==In||An!==Un||Pl||I!==null&&I.dependencies!==null&&Hd(I.dependencies)?(typeof Pe=="function"&&(Ho(f,w,Pe,V),Un=f.memoizedState),(en=Pl||Zl(f,w,en,V,An,Un,dt)||I!==null&&I.dependencies!==null&&Hd(I.dependencies))?(zt||typeof J.UNSAFE_componentWillUpdate!="function"&&typeof J.componentWillUpdate!="function"||(typeof J.componentWillUpdate=="function"&&J.componentWillUpdate(V,Un,dt),typeof J.UNSAFE_componentWillUpdate=="function"&&J.UNSAFE_componentWillUpdate(V,Un,dt)),typeof J.componentDidUpdate=="function"&&(f.flags|=4),typeof J.getSnapshotBeforeUpdate=="function"&&(f.flags|=1024)):(typeof J.componentDidUpdate!="function"||ve===I.memoizedProps&&An===I.memoizedState||(f.flags|=4),typeof J.getSnapshotBeforeUpdate!="function"||ve===I.memoizedProps&&An===I.memoizedState||(f.flags|=1024),f.memoizedProps=V,f.memoizedState=Un),J.props=V,J.state=Un,J.context=dt,V=en):(typeof J.componentDidUpdate!="function"||ve===I.memoizedProps&&An===I.memoizedState||(f.flags|=4),typeof J.getSnapshotBeforeUpdate!="function"||ve===I.memoizedProps&&An===I.memoizedState||(f.flags|=1024),V=!1)}return J=V,xa(I,f),V=(f.flags&128)!==0,J||V?(J=f.stateNode,w=V&&typeof w.getDerivedStateFromError!="function"?null:J.render(),f.flags|=1,I!==null&&V?(f.child=Oc(f,I.child,null,Y),f.child=Oc(f,null,w,Y)):ga(I,f,w,Y),f.memoizedState=J.state,I=f.child):I=Wl(I,f,Y),I}function Nb(I,f,w,V){return pe(),f.flags|=256,ga(I,f,w,V),f.child}function sA(I){return{baseLanes:I,cachePool:IA()}}function Vd(I,f,w){return I=I!==null?I.childLanes&~w:0,f&&(I|=Fr),I}function Eb(I,f,w){var V=f.pendingProps,Y=!1,J=(f.flags&128)!==0,ve;if((ve=J)||(ve=I!==null&&I.memoizedState===null?!1:(Xa.current&2)!==0),ve&&(Y=!0,f.flags&=-129),ve=(f.flags&32)!==0,f.flags&=-33,I===null){if(fi){if(Y?Pt(f):kt(),fi){var Pe=uo,dt;(dt=Pe)&&(Pe=A0(Pe,ja),Pe!==null?(f.memoizedState={dehydrated:Pe,treeContext:Kc!==null?{id:Ws,overflow:Vs}:null,retryLane:536870912},dt=t(18,null,null,0),dt.stateNode=Pe,dt.return=f,f.child=dt,go=f,uo=null,dt=!0):dt=!1),dt||de(f)}if(Pe=f.memoizedState,Pe!==null&&(Pe=Pe.dehydrated,Pe!==null))return eh(Pe)?f.lanes=16:f.lanes=536870912,null;Ft(f)}return Pe=V.children,V=V.fallback,Y?(kt(),Y=f.mode,Pe=cA({mode:"hidden",children:Pe},Y),V=ua(V,Y,w,null),Pe.return=f,V.return=f,Pe.sibling=V,f.child=Pe,Y=f.child,Y.memoizedState=sA(w),Y.childLanes=Vd(I,ve,w),f.memoizedState=Ih,V):(Pt(f),lA(f,Pe))}if(dt=I.memoizedState,dt!==null&&(Pe=dt.dehydrated,Pe!==null)){if(J)f.flags&256?(Pt(f),f.flags&=-257,f=ZI(I,f,w)):f.memoizedState!==null?(kt(),f.child=I.child,f.flags|=128,f=null):(kt(),Y=V.fallback,Pe=f.mode,V=cA({mode:"visible",children:V.children},Pe),Y=ua(Y,Pe,w,null),Y.flags|=2,V.return=f,Y.return=f,V.sibling=Y,f.child=V,Oc(f,I.child,null,w),V=f.child,V.memoizedState=sA(w),V.childLanes=Vd(I,ve,w),f.memoizedState=Ih,f=Y);else if(Pt(f),eh(Pe))ve=d0(Pe).digest,V=Error(a(419)),V.stack="",V.digest=ve,Te({value:V,source:null,stack:null}),f=ZI(I,f,w);else if(Di||Ed(I,f,w,!1),ve=(w&I.childLanes)!==0,Di||ve){if(ve=Ni,ve!==null){if(V=w&-w,(V&42)!==0)V=1;else switch(V){case 2:V=1;break;case 8:V=4;break;case 32:V=16;break;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:V=64;break;case 268435456:V=134217728;break;default:V=0}if(V=(V&(ve.suspendedLanes|w))!==0?0:V,V!==0&&V!==dt.retryLane)throw dt.retryLane=V,Ge(I,V),Pa(ve,I,V),Ch}$I(Pe)||Tl(),f=ZI(I,f,w)}else $I(Pe)?(f.flags|=128,f.child=I.child,f=Yl.bind(null,I),C0(Pe,f),f=null):(I=dt.treeContext,co&&(uo=f0(Pe),go=f,fi=!0,rs=null,ja=!1,I!==null&&(Rr[Zr++]=Ws,Rr[Zr++]=Vs,Rr[Zr++]=Kc,Ws=I.id,Vs=I.overflow,Kc=f)),f=lA(f,V.children),f.flags|=4096);return f}return Y?(kt(),Y=V.fallback,Pe=f.mode,dt=I.child,J=dt.sibling,V=ts(dt,{mode:"hidden",children:V.children}),V.subtreeFlags=dt.subtreeFlags&31457280,J!==null?Y=ts(J,Y):(Y=ua(Y,Pe,w,null),Y.flags|=2),Y.return=f,V.return=f,V.sibling=Y,f.child=V,V=Y,Y=f.child,Pe=I.child.memoizedState,Pe===null?Pe=sA(w):(dt=Pe.cachePool,dt!==null?(J=To?Ji._currentValue:Ji._currentValue2,dt=dt.parent!==J?{parent:J,pool:J}:dt):dt=IA(),Pe={baseLanes:Pe.baseLanes|w,cachePool:dt}),Y.memoizedState=Pe,Y.childLanes=Vd(I,ve,w),f.memoizedState=Ih,V):(Pt(f),w=I.child,I=w.sibling,w=ts(w,{mode:"visible",children:V.children}),w.return=f,w.sibling=null,I!==null&&(ve=f.deletions,ve===null?(f.deletions=[I],f.flags|=16):ve.push(I)),f.child=w,f.memoizedState=null,w)}function lA(I,f){return f=cA({mode:"visible",children:f},I.mode),f.return=I,I.child=f}function cA(I,f){return Jd(I,f,0,null)}function ZI(I,f,w){return Oc(f,I.child,null,w),I=lA(f,f.pendingProps.children),I.flags|=2,f.memoizedState=null,I}function Hb(I,f,w){I.lanes|=f;var V=I.alternate;V!==null&&(V.lanes|=f),Nd(I.return,f,w)}function gA(I,f,w,V,Y){var J=I.memoizedState;J===null?I.memoizedState={isBackwards:f,rendering:null,renderingStartTime:0,last:V,tail:w,tailMode:Y}:(J.isBackwards=f,J.rendering=null,J.renderingStartTime=0,J.last=V,J.tail=w,J.tailMode=Y)}function Fb(I,f,w){var V=f.pendingProps,Y=V.revealOrder,J=V.tail;if(ga(I,f,V.children,w),V=Xa.current,(V&2)!==0)V=V&1|2,f.flags|=128;else{if(I!==null&&(I.flags&128)!==0)e:for(I=f.child;I!==null;){if(I.tag===13)I.memoizedState!==null&&Hb(I,w,f);else if(I.tag===19)Hb(I,w,f);else if(I.child!==null){I.child.return=I,I=I.child;continue}if(I===f)break e;for(;I.sibling===null;){if(I.return===null||I.return===f)break e;I=I.return}I.sibling.return=I.return,I=I.sibling}V&=1}switch(S(Xa,V),Y){case"forwards":for(w=f.child,Y=null;w!==null;)I=w.alternate,I!==null&&fn(I)===null&&(Y=w),w=w.sibling;w=Y,w===null?(Y=f.child,f.child=null):(Y=w.sibling,w.sibling=null),gA(f,!1,Y,w,J);break;case"backwards":for(w=null,Y=f.child,f.child=null;Y!==null;){if(I=Y.alternate,I!==null&&fn(I)===null){f.child=Y;break}I=Y.sibling,Y.sibling=w,w=Y,Y=I}gA(f,!0,w,null,J);break;case"together":gA(f,!1,null,null,void 0);break;default:f.memoizedState=null}return f.child}function Wl(I,f,w){if(I!==null&&(f.dependencies=I.dependencies),Hr|=f.lanes,(w&f.childLanes)===0)if(I!==null){if(Ed(I,f,w,!1),(w&f.childLanes)===0)return null}else return null;if(I!==null&&f.child!==I.child)throw Error(a(153));if(f.child!==null){for(I=f.child,w=ts(I,I.pendingProps),f.child=w,w.return=f;I.sibling!==null;)I=I.sibling,w=w.sibling=ts(I,I.pendingProps),w.return=f;w.sibling=null}return f.child}function uA(I,f){return(I.lanes&f)!==0?!0:(I=I.dependencies,!!(I!==null&&Hd(I)))}function wS(I,f,w){switch(f.tag){case 3:k(f,f.stateNode.containerInfo),yc(f,Ji,I.memoizedState.cache),pe();break;case 27:case 5:re(f);break;case 4:k(f,f.stateNode.containerInfo);break;case 10:yc(f,f.type,f.memoizedProps.value);break;case 13:var V=f.memoizedState;if(V!==null)return V.dehydrated!==null?(Pt(f),f.flags|=128,null):(w&f.child.childLanes)!==0?Eb(I,f,w):(Pt(f),I=Wl(I,f,w),I!==null?I.sibling:null);Pt(f);break;case 19:var Y=(I.flags&128)!==0;if(V=(w&f.childLanes)!==0,V||(Ed(I,f,w,!1),V=(w&f.childLanes)!==0),Y){if(V)return Fb(I,f,w);f.flags|=128}if(Y=f.memoizedState,Y!==null&&(Y.rendering=null,Y.tail=null,Y.lastEffect=null),S(Xa,Xa.current),V)break;return null;case 22:case 23:return f.lanes=0,ao(I,f,w);case 24:yc(f,Ji,I.memoizedState.cache)}return Wl(I,f,w)}function Xb(I,f,w){if(I!==null)if(I.memoizedProps!==f.pendingProps)Di=!0;else{if(!uA(I,w)&&(f.flags&128)===0)return Di=!1,wS(I,f,w);Di=(I.flags&131072)!==0}else Di=!1,fi&&(f.flags&1048576)!==0&&O(f,Xu,f.index);switch(f.lanes=0,f.tag){case 16:e:{I=f.pendingProps;var V=f.elementType,Y=V._init;if(V=Y(V._payload),f.type=V,typeof V=="function")kd(V)?(I=vr(V,I),f.tag=1,f=Vb(null,f,V,I,w)):(f.tag=0,f=yr(null,f,V,I,w));else{if(V!=null){if(Y=V.$$typeof,Y===eC){f.tag=11,f=Ml(null,f,V,I,w);break e}else if(Y===kI){f.tag=14,f=Md(null,f,V,I,w);break e}}throw f=r(V)||V,Error(a(306,f,""))}}return f;case 0:return yr(I,f,f.type,f.pendingProps,w);case 1:return V=f.type,Y=vr(V,f.pendingProps),Vb(I,f,V,Y,w);case 3:e:{if(k(f,f.stateNode.containerInfo),I===null)throw Error(a(387));var J=f.pendingProps;Y=f.memoizedState,V=Y.element,lt(I,f),ht(f,J,null,w);var ve=f.memoizedState;if(J=ve.cache,yc(f,Ji,J),J!==Y.cache&&yg(f,[Ji],w,!0),He(),J=ve.element,co&&Y.isDehydrated)if(Y={element:J,isDehydrated:!1,cache:ve.cache},f.updateQueue.baseState=Y,f.memoizedState=Y,f.flags&256){f=Nb(I,f,J,w);break e}else if(J!==V){V=q(Error(a(424)),f),Te(V),f=Nb(I,f,J,w);break e}else for(co&&(uo=h0(f.stateNode.containerInfo),go=f,fi=!0,rs=null,ja=!0),w=al(f,null,J,w),f.child=w;w;)w.flags=w.flags&-3|4096,w=w.sibling;else{if(pe(),J===V){f=Wl(I,f,w);break e}ga(I,f,J,w)}f=f.child}return f;case 26:if(wr)return xa(I,f),I===null?(w=QA(f.type,null,f.pendingProps,null))?f.memoizedState=w:fi||(f.stateNode=oh(f.type,f.pendingProps,nl.current,f)):f.memoizedState=QA(f.type,I.memoizedProps,f.pendingProps,I.memoizedState),null;case 27:if(Li)return re(f),I===null&&Li&&fi&&(V=f.stateNode=Ms(f.type,f.pendingProps,nl.current,Fa.current,!1),go=f,ja=!0,uo=th(V)),V=f.pendingProps.children,I!==null||fi?ga(I,f,V,w):f.child=Oc(f,null,V,w),xa(I,f),f.child;case 5:return I===null&&fi&&(ih(f.type,f.pendingProps,Fa.current),(Y=V=uo)&&(V=NS(V,f.type,f.pendingProps,ja),V!==null?(f.stateNode=V,go=f,uo=th(V),ja=!1,Y=!0):Y=!1),Y||de(f)),re(f),Y=f.type,J=f.pendingProps,ve=I!==null?I.memoizedProps:null,V=J.children,Pn(Y,J)?V=null:ve!==null&&Pn(Y,ve)&&(f.flags|=32),f.memoizedState!==null&&(Y=ue(I,f,at,null,null,w),To?xs._currentValue=Y:xs._currentValue2=Y),xa(I,f),ga(I,f,V,w),f.child;case 6:return I===null&&fi&&(y0(f.pendingProps,Fa.current),(I=w=uo)&&(w=JA(w,f.pendingProps,ja),w!==null?(f.stateNode=w,go=f,uo=null,I=!0):I=!1),I||de(f)),null;case 13:return Eb(I,f,w);case 4:return k(f,f.stateNode.containerInfo),V=f.pendingProps,I===null?f.child=Oc(f,null,V,w):ga(I,f,V,w),f.child;case 11:return Ml(I,f,f.type,f.pendingProps,w);case 7:return ga(I,f,f.pendingProps,w),f.child;case 8:return ga(I,f,f.pendingProps.children,w),f.child;case 12:return ga(I,f,f.pendingProps.children,w),f.child;case 10:return V=f.pendingProps,yc(f,f.type,V.value),ga(I,f,V.children,w),f.child;case 9:return Y=f.type._context,V=f.pendingProps.children,Bc(f),Y=oo(Y),V=V(Y),f.flags|=1,ga(I,f,V,w),f.child;case 14:return Md(I,f,f.type,f.pendingProps,w);case 15:return RI(I,f,f.type,f.pendingProps,w);case 19:return Fb(I,f,w);case 22:return ao(I,f,w);case 24:return Bc(f),V=oo(Ji),I===null?(Y=CA(),Y===null&&(Y=Ni,J=Gc(),Y.pooledCache=J,J.refCount++,J!==null&&(Y.pooledCacheLanes|=w),Y=J),f.memoizedState={parent:V,cache:Y},qe(f),yc(f,Ji,Y)):((I.lanes&w)!==0&&(lt(I,f),ht(f,null,null,w),He()),Y=I.memoizedState,J=f.memoizedState,Y.parent!==V?(Y={parent:V,cache:V},f.memoizedState=Y,f.lanes===0&&(f.memoizedState=f.updateQueue.baseState=Y),yc(f,Ji,V)):(V=J.cache,yc(f,Ji,V),V!==Y.cache&&yg(f,[Ji],w,!0))),ga(I,f,f.pendingProps.children,w),f.child;case 29:throw f.pendingProps}throw Error(a(156,f.tag))}function yc(I,f,w){To?(S(jl,f._currentValue),f._currentValue=w):(S(jl,f._currentValue2),f._currentValue2=w)}function Vl(I){var f=jl.current;To?I._currentValue=f:I._currentValue2=f,y(jl)}function Nd(I,f,w){for(;I!==null;){var V=I.alternate;if((I.childLanes&f)!==f?(I.childLanes|=f,V!==null&&(V.childLanes|=f)):V!==null&&(V.childLanes&f)!==f&&(V.childLanes|=f),I===w)break;I=I.return}}function yg(I,f,w,V){var Y=I.child;for(Y!==null&&(Y.return=I);Y!==null;){var J=Y.dependencies;if(J!==null){var ve=Y.child;J=J.firstContext;e:for(;J!==null;){var Pe=J;J=Y;for(var dt=0;dt<f.length;dt++)if(Pe.context===f[dt]){J.lanes|=w,Pe=J.alternate,Pe!==null&&(Pe.lanes|=w),Nd(J.return,w,I),V||(ve=null);break e}J=Pe.next}}else if(Y.tag===18){if(ve=Y.return,ve===null)throw Error(a(341));ve.lanes|=w,J=ve.alternate,J!==null&&(J.lanes|=w),Nd(ve,w,I),ve=null}else ve=Y.child;if(ve!==null)ve.return=Y;else for(ve=Y;ve!==null;){if(ve===I){ve=null;break}if(Y=ve.sibling,Y!==null){Y.return=ve.return,ve=Y;break}ve=ve.return}Y=ve}}function Ed(I,f,w,V){I=null;for(var Y=f,J=!1;Y!==null;){if(!J){if((Y.flags&524288)!==0)J=!0;else if((Y.flags&262144)!==0)break}if(Y.tag===10){var ve=Y.alternate;if(ve===null)throw Error(a(387));if(ve=ve.memoizedProps,ve!==null){var Pe=Y.type;sr(Y.pendingProps.value,ve.value)||(I!==null?I.push(Pe):I=[Pe])}}else if(Y===Vg.current){if(ve=Y.alternate,ve===null)throw Error(a(387));ve.memoizedState.memoizedState!==Y.memoizedState.memoizedState&&(I!==null?I.push(xs):I=[xs])}Y=Y.return}I!==null&&yg(f,I,w,V),f.flags|=262144}function Hd(I){for(I=I.firstContext;I!==null;){var f=I.context;if(!sr(To?f._currentValue:f._currentValue2,I.memoizedValue))return!0;I=I.next}return!1}function Bc(I){Hs=I,Vr=null,I=I.dependencies,I!==null&&(I.firstContext=null)}function oo(I){return dA(Hs,I)}function Fd(I,f){return Hs===null&&Bc(I),dA(I,f)}function dA(I,f){var w=To?f._currentValue:f._currentValue2;if(f={context:f,memoizedValue:w,next:null},Vr===null){if(I===null)throw Error(a(308));Vr=f,I.dependencies={lanes:0,firstContext:f},I.flags|=524288}else Vr=Vr.next=f;return w}function Gc(){return{controller:new _u,data:new Map,refCount:0}}function Xd(I){I.refCount--,I.refCount===0&&N0(E0,function(){I.controller.abort()})}function CA(){var I=rl.current;return I!==null?I:Ni.pooledCache}function xI(I,f){f===null?S(rl,rl.current):S(rl,f.pool)}function IA(){var I=CA();return I===null?null:{parent:To?Ji._currentValue:Ji._currentValue2,pool:I}}function er(I){I.flags|=4}function Au(I,f){if(I!==null&&I.child===f.child)return!1;if((f.flags&16)!==0)return!0;for(I=f.child;I!==null;){if((I.flags&13878)!==0||(I.subtreeFlags&13878)!==0)return!0;I=I.sibling}return!1}function Bg(I,f,w,V){if(Ha)for(w=f.child;w!==null;){if(w.tag===5||w.tag===6)nC(I,w.stateNode);else if(!(w.tag===4||Li&&w.tag===27)&&w.child!==null){w.child.return=w,w=w.child;continue}if(w===f)break;for(;w.sibling===null;){if(w.return===null||w.return===f)return;w=w.return}w.sibling.return=w.return,w=w.sibling}else if(as)for(var Y=f.child;Y!==null;){if(Y.tag===5){var J=Y.stateNode;w&&V&&(J=OA(J,Y.type,Y.memoizedProps)),nC(I,J)}else if(Y.tag===6)J=Y.stateNode,w&&V&&(J=UA(J,Y.memoizedProps)),nC(I,J);else if(Y.tag!==4){if(Y.tag===22&&Y.memoizedState!==null)J=Y.child,J!==null&&(J.return=Y),Bg(I,Y,!0,!0);else if(Y.child!==null){Y.child.return=Y,Y=Y.child;continue}}if(Y===f)break;for(;Y.sibling===null;){if(Y.return===null||Y.return===f)return;Y=Y.return}Y.sibling.return=Y.return,Y=Y.sibling}}function Tb(I,f,w,V){if(as)for(var Y=f.child;Y!==null;){if(Y.tag===5){var J=Y.stateNode;w&&V&&(J=OA(J,Y.type,Y.memoizedProps)),DA(I,J)}else if(Y.tag===6)J=Y.stateNode,w&&V&&(J=UA(J,Y.memoizedProps)),DA(I,J);else if(Y.tag!==4){if(Y.tag===22&&Y.memoizedState!==null)J=Y.child,J!==null&&(J.return=Y),Tb(I,Y,!(Y.memoizedProps!==null&&Y.memoizedProps.mode==="manual"),!0);else if(Y.child!==null){Y.child.return=Y,Y=Y.child;continue}}if(Y===f)break;for(;Y.sibling===null;){if(Y.return===null||Y.return===f)return;Y=Y.return}Y.sibling.return=Y.return,Y=Y.sibling}}function Td(I,f){if(as&&Au(I,f)){I=f.stateNode;var w=I.containerInfo,V=iC();Tb(V,f,!1,!1),I.pendingChildren=V,er(f),qI(w,V)}}function MI(I,f,w,V){if(Ha)I.memoizedProps!==V&&er(f);else if(as){var Y=I.stateNode,J=I.memoizedProps;if((I=Au(I,f))||J!==V){var ve=Fa.current;J=Eu(Y,w,J,V,!I,null),J===Y?f.stateNode=Y:(_l(J,w,V,ve)&&er(f),f.stateNode=J,I?Bg(J,f,!1,!1):er(f))}else f.stateNode=Y}}function WI(I,f,w){if(FA(f,w)){if(I.flags|=16777216,!jI(f,w))if(Mc())I.flags|=8192;else throw Lc=dC,uC}else I.flags&=-16777217}function VI(I,f){if(S0(f)){if(I.flags|=16777216,!Rg(f))if(Mc())I.flags|=8192;else throw Lc=dC,uC}else I.flags&=-16777217}function mu(I,f){f!==null&&(I.flags|=4),I.flags&16384&&(f=I.tag!==22?N():536870912,I.lanes|=f,cl|=f)}function pu(I,f){if(!fi)switch(I.tailMode){case"hidden":f=I.tail;for(var w=null;f!==null;)f.alternate!==null&&(w=f),f=f.sibling;w===null?I.tail=null:w.sibling=null;break;case"collapsed":w=I.tail;for(var V=null;w!==null;)w.alternate!==null&&(V=w),w=w.sibling;V===null?f||I.tail===null?I.tail=null:I.tail.sibling=null:V.sibling=null}}function ra(I){var f=I.alternate!==null&&I.alternate.child===I.child,w=0,V=0;if(f)for(var Y=I.child;Y!==null;)w|=Y.lanes|Y.childLanes,V|=Y.subtreeFlags&31457280,V|=Y.flags&31457280,Y.return=I,Y=Y.sibling;else for(Y=I.child;Y!==null;)w|=Y.lanes|Y.childLanes,V|=Y.subtreeFlags,V|=Y.flags,Y.return=I,Y=Y.sibling;return I.subtreeFlags|=V,I.childLanes=w,f}function Yb(I,f,w){var V=f.pendingProps;switch(ne(f),f.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ra(f),null;case 1:return ra(f),null;case 3:return w=f.stateNode,V=null,I!==null&&(V=I.memoizedState.cache),f.memoizedState.cache!==V&&(f.flags|=2048),Vl(Ji),ie(),w.pendingContext&&(w.context=w.pendingContext,w.pendingContext=null),(I===null||I.child===null)&&(ye(f)?er(f):I===null||I.memoizedState.isDehydrated&&(f.flags&256)===0||(f.flags|=1024,rs!==null&&(Od(rs),rs=null))),Td(I,f),ra(f),null;case 26:if(wr){w=f.type;var Y=f.memoizedState;return I===null?(er(f),Y!==null?(ra(f),VI(f,Y)):(ra(f),WI(f,w,V))):Y?Y!==I.memoizedState?(er(f),ra(f),VI(f,Y)):(ra(f),f.flags&=-16777217):(Ha?I.memoizedProps!==V&&er(f):MI(I,f,w,V),ra(f),WI(f,w,V)),null}case 27:if(Li){if(ge(f),w=nl.current,Y=f.type,I!==null&&f.stateNode!=null)Ha?I.memoizedProps!==V&&er(f):MI(I,f,Y,V);else{if(!V){if(f.stateNode===null)throw Error(a(166));return ra(f),null}I=Fa.current,ye(f)?xe(f,I):(I=Ms(Y,V,w,I,!0),f.stateNode=I,er(f))}return ra(f),null}case 5:if(ge(f),w=f.type,I!==null&&f.stateNode!=null)MI(I,f,w,V);else{if(!V){if(f.stateNode===null)throw Error(a(166));return ra(f),null}I=Fa.current,ye(f)?xe(f,I):(Y=HA(w,V,nl.current,I,f),Bg(Y,f,!1,!1),f.stateNode=Y,_l(Y,w,V,I)&&er(f))}return ra(f),WI(f,f.type,f.pendingProps),null;case 6:if(I&&f.stateNode!=null)w=I.memoizedProps,Ha?w!==V&&er(f):as&&(w!==V?(f.stateNode=Hi(V,nl.current,Fa.current,f),er(f)):f.stateNode=I.stateNode);else{if(typeof V!="string"&&f.stateNode===null)throw Error(a(166));if(I=nl.current,w=Fa.current,ye(f)){if(!co)throw Error(a(176));if(I=f.stateNode,w=f.memoizedProps,V=null,Y=go,Y!==null)switch(Y.tag){case 27:case 5:V=Y.memoizedProps}jA(I,w,f,V)||de(f)}else f.stateNode=Hi(V,I,w,f)}return ra(f),null;case 13:if(V=f.memoizedState,I===null||I.memoizedState!==null&&I.memoizedState.dehydrated!==null){if(Y=ye(f),V!==null&&V.dehydrated!==null){if(I===null){if(!Y)throw Error(a(318));if(!co)throw Error(a(344));if(Y=f.memoizedState,Y=Y!==null?Y.dehydrated:null,!Y)throw Error(a(317));p0(Y,f)}else pe(),(f.flags&128)===0&&(f.memoizedState=null),f.flags|=4;ra(f),Y=!1}else rs!==null&&(Od(rs),rs=null),Y=!0;if(!Y)return f.flags&256?(Ft(f),f):(Ft(f),null)}if(Ft(f),(f.flags&128)!==0)return f.lanes=w,f;if(w=V!==null,I=I!==null&&I.memoizedState!==null,w){V=f.child,Y=null,V.alternate!==null&&V.alternate.memoizedState!==null&&V.alternate.memoizedState.cachePool!==null&&(Y=V.alternate.memoizedState.cachePool.pool);var J=null;V.memoizedState!==null&&V.memoizedState.cachePool!==null&&(J=V.memoizedState.cachePool.pool),J!==Y&&(V.flags|=2048)}return w!==I&&w&&(f.child.flags|=8192),mu(f,f.updateQueue),ra(f),null;case 4:return ie(),Td(I,f),I===null&&Ba(f.stateNode.containerInfo),ra(f),null;case 10:return Vl(f.type),ra(f),null;case 19:if(y(Xa),Y=f.memoizedState,Y===null)return ra(f),null;if(V=(f.flags&128)!==0,J=Y.rendering,J===null)if(V)pu(Y,!1);else{if(Oi!==0||I!==null&&(I.flags&128)!==0)for(I=f.child;I!==null;){if(J=fn(I),J!==null){for(f.flags|=128,pu(Y,!1),I=J.updateQueue,f.updateQueue=I,mu(f,I),f.subtreeFlags=0,I=w,w=f.child;w!==null;)Pd(w,I),w=w.sibling;return S(Xa,Xa.current&1|2),f.child}I=I.sibling}Y.tail!==null&&os()>Uu&&(f.flags|=128,V=!0,pu(Y,!1),f.lanes=4194304)}else{if(!V)if(I=fn(J),I!==null){if(f.flags|=128,V=!0,I=I.updateQueue,f.updateQueue=I,mu(f,I),pu(Y,!0),Y.tail===null&&Y.tailMode==="hidden"&&!J.alternate&&!fi)return ra(f),null}else 2*os()-Y.renderingStartTime>Uu&&w!==536870912&&(f.flags|=128,V=!0,pu(Y,!1),f.lanes=4194304);Y.isBackwards?(J.sibling=f.child,f.child=J):(I=Y.last,I!==null?I.sibling=J:f.child=J,Y.last=J)}return Y.tail!==null?(f=Y.tail,Y.rendering=f,Y.tail=f.sibling,Y.renderingStartTime=os(),f.sibling=null,I=Xa.current,S(Xa,V?I&1|2:I&1),f):(ra(f),null);case 22:case 23:return Ft(f),Tt(),V=f.memoizedState!==null,I!==null?I.memoizedState!==null!==V&&(f.flags|=8192):V&&(f.flags|=8192),V?(w&536870912)!==0&&(f.flags&128)===0&&(ra(f),f.subtreeFlags&6&&(f.flags|=8192)):ra(f),w=f.updateQueue,w!==null&&mu(f,w.retryQueue),w=null,I!==null&&I.memoizedState!==null&&I.memoizedState.cachePool!==null&&(w=I.memoizedState.cachePool.pool),V=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(V=f.memoizedState.cachePool.pool),V!==w&&(f.flags|=2048),I!==null&&y(rl),null;case 24:return w=null,I!==null&&(w=I.memoizedState.cache),f.memoizedState.cache!==w&&(f.flags|=2048),Vl(Ji),ra(f),null;case 25:return null}throw Error(a(156,f.tag))}function RS(I,f){switch(ne(f),f.tag){case 1:return I=f.flags,I&65536?(f.flags=I&-65537|128,f):null;case 3:return Vl(Ji),ie(),I=f.flags,(I&65536)!==0&&(I&128)===0?(f.flags=I&-65537|128,f):null;case 26:case 27:case 5:return ge(f),null;case 13:if(Ft(f),I=f.memoizedState,I!==null&&I.dehydrated!==null){if(f.alternate===null)throw Error(a(340));pe()}return I=f.flags,I&65536?(f.flags=I&-65537|128,f):null;case 19:return y(Xa),null;case 4:return ie(),null;case 10:return Vl(f.type),null;case 22:case 23:return Ft(f),Tt(),I!==null&&y(rl),I=f.flags,I&65536?(f.flags=I&-65537|128,f):null;case 24:return Vl(Ji),null;case 25:return null;default:return null}}function zb(I,f){switch(ne(f),f.tag){case 3:Vl(Ji),ie();break;case 26:case 27:case 5:ge(f);break;case 4:ie();break;case 13:Ft(f);break;case 19:y(Xa);break;case 10:Vl(f.type);break;case 22:case 23:Ft(f),Tt(),I!==null&&y(rl);break;case 24:Vl(Ji)}}function Yd(I,f){try{var w=f.updateQueue,V=w!==null?w.lastEffect:null;if(V!==null){var Y=V.next;w=Y;do{if((w.tag&I)===I){V=void 0;var J=w.create,ve=w.inst;V=J(),ve.destroy=V}w=w.next}while(w!==Y)}}catch(Pe){Wi(f,f.return,Pe)}}function Sc(I,f,w){try{var V=f.updateQueue,Y=V!==null?V.lastEffect:null;if(Y!==null){var J=Y.next;V=J;do{if((V.tag&I)===I){var ve=V.inst,Pe=ve.destroy;if(Pe!==void 0){ve.destroy=void 0,Y=f;var dt=w;try{Pe()}catch(zt){Wi(Y,dt,zt)}}}V=V.next}while(V!==J)}}catch(zt){Wi(f,f.return,zt)}}function Kb(I){var f=I.updateQueue;if(f!==null){var w=I.stateNode;try{ze(f,w)}catch(V){Wi(I,I.return,V)}}}function tr(I,f,w){w.props=vr(I.type,I.memoizedProps),w.state=I.memoizedState;try{w.componentWillUnmount()}catch(V){Wi(I,f,V)}}function ws(I,f){try{var w=I.ref;if(w!==null){var V=I.stateNode;switch(I.tag){case 26:case 27:case 5:var Y=Wu(V);break;default:Y=V}typeof w=="function"?I.refCleanup=w(Y):w.current=Y}}catch(J){Wi(I,f,J)}}function nr(I,f){var w=I.ref,V=I.refCleanup;if(w!==null)if(typeof V=="function")try{V()}catch(Y){Wi(I,f,Y)}finally{I.refCleanup=null,I=I.alternate,I!=null&&(I.refCleanup=null)}else if(typeof w=="function")try{w(null)}catch(Y){Wi(I,f,Y)}else w.current=null}function hA(I){var f=I.type,w=I.memoizedProps,V=I.stateNode;try{WS(V,f,w,I)}catch(Y){Wi(I,I.return,Y)}}function fA(I,f,w){try{a0(I.stateNode,I.type,w,f,I)}catch(V){Wi(I,I.return,V)}}function AA(I){return I.tag===5||I.tag===3||(wr?I.tag===26:!1)||(Li?I.tag===27:!1)||I.tag===4}function zd(I){e:for(;;){for(;I.sibling===null;){if(I.return===null||AA(I.return))return null;I=I.return}for(I.sibling.return=I.return,I=I.sibling;I.tag!==5&&I.tag!==6&&(!Li||I.tag!==27)&&I.tag!==18;){if(I.flags&2||I.child===null||I.tag===4)continue e;I.child.return=I,I=I.child}if(!(I.flags&2))return I.stateNode}}function mA(I,f,w){var V=I.tag;if(V===5||V===6)I=I.stateNode,f?r0(w,I,f):KA(w,I);else if(!(V===4||Li&&V===27)&&(I=I.child,I!==null))for(mA(I,f,w),I=I.sibling;I!==null;)mA(I,f,w),I=I.sibling}function Nl(I,f,w){var V=I.tag;if(V===5||V===6)I=I.stateNode,f?o0(w,I,f):n0(w,I);else if(!(V===4||Li&&V===27)&&(I=I.child,I!==null))for(Nl(I,f,w),I=I.sibling;I!==null;)Nl(I,f,w),I=I.sibling}function NI(I,f,w){I=I.containerInfo;try{Hu(I,w)}catch(V){Wi(f,f.return,V)}}function Kd(I,f){for(PI(I.containerInfo),On=f;On!==null;)if(I=On,f=I.child,(I.subtreeFlags&1028)!==0&&f!==null)f.return=I,On=f;else for(;On!==null;){I=On;var w=I.alternate;switch(f=I.flags,I.tag){case 0:break;case 11:case 15:break;case 1:if((f&1024)!==0&&w!==null){f=void 0;var V=I,Y=w.memoizedProps;w=w.memoizedState;var J=V.stateNode;try{var ve=vr(V.type,Y,V.elementType===V.type);f=J.getSnapshotBeforeUpdate(ve,w),J.__reactInternalSnapshotBeforeUpdate=f}catch(Pe){Wi(V,V.return,Pe)}}break;case 3:(f&1024)!==0&&Ha&&u0(I.stateNode.containerInfo);break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((f&1024)!==0)throw Error(a(163))}if(f=I.sibling,f!==null){f.return=I.return,On=f;break}On=I.return}return ve=oi,oi=!1,ve}function EI(I,f,w){var V=w.flags;switch(w.tag){case 0:case 11:case 15:Hl(I,w),V&4&&Yd(5,w);break;case 1:if(Hl(I,w),V&4)if(I=w.stateNode,f===null)try{I.componentDidMount()}catch(Pe){Wi(w,w.return,Pe)}else{var Y=vr(w.type,f.memoizedProps);f=f.memoizedState;try{I.componentDidUpdate(Y,f,I.__reactInternalSnapshotBeforeUpdate)}catch(Pe){Wi(w,w.return,Pe)}}V&64&&Kb(w),V&512&&ws(w,w.return);break;case 3:if(Hl(I,w),V&64&&(V=w.updateQueue,V!==null)){if(I=null,w.child!==null)switch(w.child.tag){case 27:case 5:I=Wu(w.child.stateNode);break;case 1:I=w.child.stateNode}try{ze(V,I)}catch(Pe){Wi(w,w.return,Pe)}}break;case 26:if(wr){Hl(I,w),V&512&&ws(w,w.return);break}case 27:case 5:Hl(I,w),f===null&&V&4&&hA(w),V&512&&ws(w,w.return);break;case 12:Hl(I,w);break;case 13:Hl(I,w),V&4&&HI(I,w);break;case 22:if(Y=w.memoizedState!==null||sl,!Y){f=f!==null&&f.memoizedState!==null||Ca;var J=sl,ve=Ca;sl=Y,(Ca=f)&&!ve?Fl(I,w,(w.subtreeFlags&8772)!==0):Hl(I,w),sl=J,Ca=ve}V&512&&(w.memoizedProps.mode==="manual"?ws(w,w.return):nr(w,w.return));break;default:Hl(I,w)}}function pA(I){var f=I.alternate;f!==null&&(I.alternate=null,pA(f)),I.child=null,I.deletions=null,I.sibling=null,I.tag===5&&(f=I.stateNode,f!==null&&MS(f)),I.stateNode=null,I.return=null,I.dependencies=null,I.memoizedProps=null,I.memoizedState=null,I.pendingProps=null,I.stateNode=null,I.updateQueue=null}function ro(I,f,w){for(w=w.child;w!==null;)wc(I,f,w),w=w.sibling}function wc(I,f,w){if(rr&&typeof rr.onCommitFiberUnmount=="function")try{rr.onCommitFiberUnmount(Sa,w)}catch{}switch(w.tag){case 26:if(wr){Ca||nr(w,f),ro(I,f,w),w.memoizedState?wg(w.memoizedState):w.stateNode&&Fu(w.stateNode);break}case 27:if(Li){Ca||nr(w,f);var V=Wn,Y=qn;Wn=w.stateNode,ro(I,f,w),Yc(w.stateNode),Wn=V,qn=Y;break}case 5:Ca||nr(w,f);case 6:if(Ha){if(V=Wn,Y=qn,Wn=null,ro(I,f,w),Wn=V,qn=Y,Wn!==null)if(qn)try{s0(Wn,w.stateNode)}catch(J){Wi(w,f,J)}else try{LA(Wn,w.stateNode)}catch(J){Wi(w,f,J)}}else ro(I,f,w);break;case 18:Ha&&Wn!==null&&(qn?aC(Wn,w.stateNode):v0(Wn,w.stateNode));break;case 4:Ha?(V=Wn,Y=qn,Wn=w.stateNode.containerInfo,qn=!0,ro(I,f,w),Wn=V,qn=Y):(as&&NI(w.stateNode,w,iC()),ro(I,f,w));break;case 0:case 11:case 14:case 15:Ca||Sc(2,w,f),Ca||Sc(4,w,f),ro(I,f,w);break;case 1:Ca||(nr(w,f),V=w.stateNode,typeof V.componentWillUnmount=="function"&&tr(w,f,V)),ro(I,f,w);break;case 21:ro(I,f,w);break;case 22:Ca||nr(w,f),Ca=(V=Ca)||w.memoizedState!==null,ro(I,f,w),Ca=V;break;default:ro(I,f,w)}}function HI(I,f){if(co&&f.memoizedState===null&&(I=f.alternate,I!==null&&(I=I.memoizedState,I!==null&&(I=I.dehydrated,I!==null))))try{HS(I)}catch(w){Wi(f,f.return,w)}}function Lb(I){switch(I.tag){case 13:case 19:var f=I.stateNode;return f===null&&(f=I.stateNode=new Vi),f;case 22:return I=I.stateNode,f=I._retryCache,f===null&&(f=I._retryCache=new Vi),f;default:throw Error(a(435,I.tag))}}function El(I,f){var w=Lb(I);f.forEach(function(V){var Y=Nc.bind(null,I,V);w.has(V)||(w.add(V),V.then(Y,Y))})}function Fo(I,f){var w=f.deletions;if(w!==null)for(var V=0;V<w.length;V++){var Y=w[V],J=I,ve=f;if(Ha){var Pe=ve;e:for(;Pe!==null;){switch(Pe.tag){case 27:case 5:Wn=Pe.stateNode,qn=!1;break e;case 3:Wn=Pe.stateNode.containerInfo,qn=!0;break e;case 4:Wn=Pe.stateNode.containerInfo,qn=!0;break e}Pe=Pe.return}if(Wn===null)throw Error(a(160));wc(J,ve,Y),Wn=null,qn=!1}else wc(J,ve,Y);J=Y.alternate,J!==null&&(J.return=null),Y.return=null}if(f.subtreeFlags&13878)for(f=f.child;f!==null;)bA(f,I),f=f.sibling}function bA(I,f){var w=I.alternate,V=I.flags;switch(I.tag){case 0:case 11:case 14:case 15:Fo(f,I),ir(I),V&4&&(Sc(3,I,I.return),Yd(3,I),Sc(5,I,I.return));break;case 1:Fo(f,I),ir(I),V&512&&(Ca||w===null||nr(w,w.return)),V&64&&sl&&(I=I.updateQueue,I!==null&&(V=I.callbacks,V!==null&&(w=I.shared.hiddenCallbacks,I.shared.hiddenCallbacks=w===null?V:w.concat(V))));break;case 26:if(wr){var Y=la;Fo(f,I),ir(I),V&512&&(Ca||w===null||nr(w,w.return)),V&4&&(V=w!==null?w.memoizedState:null,f=I.memoizedState,w===null?f===null?I.stateNode===null?I.stateNode=rC(Y,I.type,I.memoizedProps,I):sC(Y,I.type,I.stateNode):I.stateNode=B0(Y,f,I.memoizedProps):V!==f?(V===null?w.stateNode!==null&&Fu(w.stateNode):wg(V),f===null?sC(Y,I.type,I.stateNode):B0(Y,f,I.memoizedProps)):f===null&&I.stateNode!==null&&fA(I,I.memoizedProps,w.memoizedProps));break}case 27:if(Li&&V&4&&I.alternate===null){Y=I.stateNode;var J=I.memoizedProps;try{Tc(Y),R0(I.type,J,Y,I)}catch(en){Wi(I,I.return,en)}}case 5:if(Fo(f,I),ir(I),V&512&&(Ca||w===null||nr(w,w.return)),Ha){if(I.flags&32){f=I.stateNode;try{_A(f)}catch(en){Wi(I,I.return,en)}}V&4&&I.stateNode!=null&&(f=I.memoizedProps,fA(I,f,w!==null?w.memoizedProps:f)),V&1024&&(tm=!0)}break;case 6:if(Fo(f,I),ir(I),V&4&&Ha){if(I.stateNode===null)throw Error(a(162));V=I.memoizedProps,w=w!==null?w.memoizedProps:V,f=I.stateNode;try{i0(f,w,V)}catch(en){Wi(I,I.return,en)}}break;case 3:if(wr?(G0(),Y=la,la=ah(f.containerInfo),Fo(f,I),la=Y):Fo(f,I),ir(I),V&4){if(Ha&&co&&w!==null&&w.memoizedState.isDehydrated)try{ES(f.containerInfo)}catch(en){Wi(I,I.return,en)}if(as){V=f.containerInfo,w=f.pendingChildren;try{Hu(V,w)}catch(en){Wi(I,I.return,en)}}}tm&&(tm=!1,_b(I));break;case 4:wr?(w=la,la=ah(I.stateNode.containerInfo),Fo(f,I),ir(I),la=w):(Fo(f,I),ir(I)),V&4&&as&&NI(I.stateNode,I,I.stateNode.pendingChildren);break;case 12:Fo(f,I),ir(I);break;case 13:Fo(f,I),ir(I),I.child.flags&8192&&I.memoizedState!==null!=(w!==null&&w.memoizedState!==null)&&(Lo=os()),V&4&&(V=I.updateQueue,V!==null&&(I.updateQueue=null,El(I,V)));break;case 22:V&512&&(Ca||w===null||nr(w,w.return)),Y=I.memoizedState!==null;var ve=w!==null&&w.memoizedState!==null,Pe=sl,dt=Ca;if(sl=Pe||Y,Ca=dt||ve,Fo(f,I),Ca=dt,sl=Pe,ir(I),f=I.stateNode,f._current=I,f._visibility&=-3,f._visibility|=f._pendingVisibility&2,V&8192&&(f._visibility=Y?f._visibility&-2:f._visibility|1,Y&&(f=sl||Ca,w===null||ve||f||bu(I)),Ha&&(I.memoizedProps===null||I.memoizedProps.mode!=="manual"))){e:if(w=null,Ha)for(f=I;;){if(f.tag===5||wr&&f.tag===26||Li&&f.tag===27){if(w===null){ve=w=f;try{J=ve.stateNode,Y?l0(J):g0(ve.stateNode,ve.memoizedProps)}catch(en){Wi(ve,ve.return,en)}}}else if(f.tag===6){if(w===null){ve=f;try{var zt=ve.stateNode;Y?c0(zt):VS(zt,ve.memoizedProps)}catch(en){Wi(ve,ve.return,en)}}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===I)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===I)break e;for(;f.sibling===null;){if(f.return===null||f.return===I)break e;w===f&&(w=null),f=f.return}w===f&&(w=null),f.sibling.return=f.return,f=f.sibling}}V&4&&(V=I.updateQueue,V!==null&&(w=V.retryQueue,w!==null&&(V.retryQueue=null,El(I,w))));break;case 19:Fo(f,I),ir(I),V&4&&(V=I.updateQueue,V!==null&&(I.updateQueue=null,El(I,V)));break;case 21:break;default:Fo(f,I),ir(I)}}function ir(I){var f=I.flags;if(f&2){try{if(Ha&&(!Li||I.tag!==27)){e:{for(var w=I.return;w!==null;){if(AA(w)){var V=w;break e}w=w.return}throw Error(a(160))}switch(V.tag){case 27:if(Li){var Y=V.stateNode,J=zd(I);Nl(I,J,Y);break}case 5:var ve=V.stateNode;V.flags&32&&(_A(ve),V.flags&=-33);var Pe=zd(I);Nl(I,Pe,ve);break;case 3:case 4:var dt=V.stateNode.containerInfo,zt=zd(I);mA(I,zt,dt);break;default:throw Error(a(161))}}}catch(en){Wi(I,I.return,en)}I.flags&=-3}f&4096&&(I.flags&=-4097)}function _b(I){if(I.subtreeFlags&1024)for(I=I.child;I!==null;){var f=I;_b(f),f.tag===5&&f.flags&1024&&QI(f.stateNode),I=I.sibling}}function Hl(I,f){if(f.subtreeFlags&8772)for(f=f.child;f!==null;)EI(I,f.alternate,f),f=f.sibling}function bu(I){for(I=I.child;I!==null;){var f=I;switch(f.tag){case 0:case 11:case 14:case 15:Sc(4,f,f.return),bu(f);break;case 1:nr(f,f.return);var w=f.stateNode;typeof w.componentWillUnmount=="function"&&tr(f,f.return,w),bu(f);break;case 26:case 27:case 5:nr(f,f.return),bu(f);break;case 22:nr(f,f.return),f.memoizedState===null&&bu(f);break;default:bu(f)}I=I.sibling}}function Fl(I,f,w){for(w=w&&(f.subtreeFlags&8772)!==0,f=f.child;f!==null;){var V=f.alternate,Y=I,J=f,ve=J.flags;switch(J.tag){case 0:case 11:case 15:Fl(Y,J,w),Yd(4,J);break;case 1:if(Fl(Y,J,w),V=J,Y=V.stateNode,typeof Y.componentDidMount=="function")try{Y.componentDidMount()}catch(zt){Wi(V,V.return,zt)}if(V=J,Y=V.updateQueue,Y!==null){var Pe=V.stateNode;try{var dt=Y.shared.hiddenCallbacks;if(dt!==null)for(Y.shared.hiddenCallbacks=null,Y=0;Y<dt.length;Y++)we(dt[Y],Pe)}catch(zt){Wi(V,V.return,zt)}}w&&ve&64&&Kb(J),ws(J,J.return);break;case 26:case 27:case 5:Fl(Y,J,w),w&&V===null&&ve&4&&hA(J),ws(J,J.return);break;case 12:Fl(Y,J,w);break;case 13:Fl(Y,J,w),w&&ve&4&&HI(Y,J);break;case 22:J.memoizedState===null&&Fl(Y,J,w),ws(J,J.return);break;default:Fl(Y,J,w)}f=f.sibling}}function FI(I,f){var w=null;I!==null&&I.memoizedState!==null&&I.memoizedState.cachePool!==null&&(w=I.memoizedState.cachePool.pool),I=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(I=f.memoizedState.cachePool.pool),I!==w&&(I!=null&&I.refCount++,w!=null&&Xd(w))}function Ld(I,f){I=null,f.alternate!==null&&(I=f.alternate.memoizedState.cache),f=f.memoizedState.cache,f!==I&&(f.refCount++,I!=null&&Xd(I))}function ka(I,f,w,V){if(f.subtreeFlags&10256)for(f=f.child;f!==null;)vA(I,f,w,V),f=f.sibling}function vA(I,f,w,V){var Y=f.flags;switch(f.tag){case 0:case 11:case 15:ka(I,f,w,V),Y&2048&&Yd(9,f);break;case 3:ka(I,f,w,V),Y&2048&&(I=null,f.alternate!==null&&(I=f.alternate.memoizedState.cache),f=f.memoizedState.cache,f!==I&&(f.refCount++,I!=null&&Xd(I)));break;case 12:if(Y&2048){ka(I,f,w,V),I=f.stateNode;try{var J=f.memoizedProps,ve=J.id,Pe=J.onPostCommit;typeof Pe=="function"&&Pe(ve,f.alternate===null?"mount":"update",I.passiveEffectDuration,-0)}catch(dt){Wi(f,f.return,dt)}}else ka(I,f,w,V);break;case 23:break;case 22:J=f.stateNode,f.memoizedState!==null?J._visibility&4?ka(I,f,w,V):vo(I,f):J._visibility&4?ka(I,f,w,V):(J._visibility|=4,so(I,f,w,V,(f.subtreeFlags&10256)!==0)),Y&2048&&FI(f.alternate,f);break;case 24:ka(I,f,w,V),Y&2048&&Ld(f.alternate,f);break;default:ka(I,f,w,V)}}function so(I,f,w,V,Y){for(Y=Y&&(f.subtreeFlags&10256)!==0,f=f.child;f!==null;){var J=I,ve=f,Pe=w,dt=V,zt=ve.flags;switch(ve.tag){case 0:case 11:case 15:so(J,ve,Pe,dt,Y),Yd(8,ve);break;case 23:break;case 22:var en=ve.stateNode;ve.memoizedState!==null?en._visibility&4?so(J,ve,Pe,dt,Y):vo(J,ve):(en._visibility|=4,so(J,ve,Pe,dt,Y)),Y&&zt&2048&&FI(ve.alternate,ve);break;case 24:so(J,ve,Pe,dt,Y),Y&&zt&2048&&Ld(ve.alternate,ve);break;default:so(J,ve,Pe,dt,Y)}f=f.sibling}}function vo(I,f){if(f.subtreeFlags&10256)for(f=f.child;f!==null;){var w=I,V=f,Y=V.flags;switch(V.tag){case 22:vo(w,V),Y&2048&&FI(V.alternate,V);break;case 24:vo(w,V),Y&2048&&Ld(V.alternate,V);break;default:vo(w,V)}f=f.sibling}}function $r(I){if(I.subtreeFlags&Nr)for(I=I.child;I!==null;)XI(I),I=I.sibling}function XI(I){switch(I.tag){case 26:$r(I),I.flags&Nr&&(I.memoizedState!==null?w0(la,I.memoizedState,I.memoizedProps):Yo(I.type,I.memoizedProps));break;case 5:$r(I),I.flags&Nr&&Yo(I.type,I.memoizedProps);break;case 3:case 4:if(wr){var f=la;la=ah(I.stateNode.containerInfo),$r(I),la=f}else $r(I);break;case 22:I.memoizedState===null&&(f=I.alternate,f!==null&&f.memoizedState!==null?(f=Nr,Nr=16777216,$r(I),Nr=f):$r(I));break;default:$r(I)}}function _d(I){var f=I.alternate;if(f!==null&&(I=f.child,I!==null)){f.child=null;do f=I.sibling,I.sibling=null,I=f;while(I!==null)}}function Rc(I){var f=I.deletions;if((I.flags&16)!==0){if(f!==null)for(var w=0;w<f.length;w++){var V=f[w];On=V,yA(V,I)}_d(I)}if(I.subtreeFlags&10256)for(I=I.child;I!==null;)TI(I),I=I.sibling}function TI(I){switch(I.tag){case 0:case 11:case 15:Rc(I),I.flags&2048&&Sc(9,I,I.return);break;case 3:Rc(I);break;case 12:Rc(I);break;case 22:var f=I.stateNode;I.memoizedState!==null&&f._visibility&4&&(I.return===null||I.return.tag!==13)?(f._visibility&=-5,Xl(I)):Rc(I);break;default:Rc(I)}}function Xl(I){var f=I.deletions;if((I.flags&16)!==0){if(f!==null)for(var w=0;w<f.length;w++){var V=f[w];On=V,yA(V,I)}_d(I)}for(I=I.child;I!==null;){switch(f=I,f.tag){case 0:case 11:case 15:Sc(8,f,f.return),Xl(f);break;case 22:w=f.stateNode,w._visibility&4&&(w._visibility&=-5,Xl(f));break;default:Xl(f)}I=I.sibling}}function yA(I,f){for(;On!==null;){var w=On;switch(w.tag){case 0:case 11:case 15:Sc(8,w,f);break;case 23:case 22:if(w.memoizedState!==null&&w.memoizedState.cachePool!==null){var V=w.memoizedState.cachePool.pool;V!=null&&V.refCount++}break;case 24:Xd(w.memoizedState.cache)}if(V=w.child,V!==null)V.return=w,On=V;else e:for(w=I;On!==null;){V=On;var Y=V.sibling,J=V.return;if(pA(V),V===w){On=null;break e}if(Y!==null){Y.return=J,On=Y;break e}On=J}}}function vu(I){var f=Jb(I);if(f!=null){if(typeof f.memoizedProps["data-testname"]!="string")throw Error(a(364));return f}if(I=YA(I),I===null)throw Error(a(362));return I.stateNode.current}function Zc(I,f){var w=I.tag;switch(f.$$typeof){case Ou:if(I.type===f.value)return!0;break;case cs:e:{for(f=f.value,I=[I,0],w=0;w<I.length;){var V=I[w++],Y=V.tag,J=I[w++],ve=f[J];if(Y!==5&&Y!==26&&Y!==27||!Nu(V)){for(;ve!=null&&Zc(V,ve);)J++,ve=f[J];if(J===f.length){f=!0;break e}else for(V=V.child;V!==null;)I.push(V,J),V=V.sibling}}f=!1}return f;case ta:if((w===5||w===26||w===27)&&$b(I.stateNode,f.value))return!0;break;case ll:if((w===5||w===6||w===26||w===27)&&(I=qb(I),I!==null&&0<=I.indexOf(f.value)))return!0;break;case Fs:if((w===5||w===26||w===27)&&(I=I.memoizedProps["data-testname"],typeof I=="string"&&I.toLowerCase()===f.value.toLowerCase()))return!0;break;default:throw Error(a(365))}return!1}function BA(I){switch(I.$$typeof){case Ou:return"<"+(r(I.value)||"Unknown")+">";case cs:return":has("+(BA(I)||"")+")";case ta:return'[role="'+I.value+'"]';case ll:return'"'+I.value+'"';case Fs:return'[data-testname="'+I.value+'"]';default:throw Error(a(365))}}function ar(I,f){var w=[];I=[I,0];for(var V=0;V<I.length;){var Y=I[V++],J=Y.tag,ve=I[V++],Pe=f[ve];if(J!==5&&J!==26&&J!==27||!Nu(Y)){for(;Pe!=null&&Zc(Y,Pe);)ve++,Pe=f[ve];if(ve===f.length)w.push(Y);else for(Y=Y.child;Y!==null;)I.push(Y,ve),Y=Y.sibling}}return w}function Dd(I,f){if(!Xc)throw Error(a(363));I=vu(I),I=ar(I,f),f=[],I=Array.from(I);for(var w=0;w<I.length;){var V=I[w++],Y=V.tag;if(Y===5||Y===26||Y===27)Nu(V)||f.push(V.stateNode);else for(V=V.child;V!==null;)I.push(V),V=V.sibling}return f}function ya(){if((bi&2)!==0&&ci!==0)return ci&-ci;if(Yn.T!==null){var I=xr;return I!==0?I:De()}return jb()}function GA(){Fr===0&&(Fr=(ci&536870912)===0||fi?F():536870912);var I=Mr.current;return I!==null&&(I.flags|=32),Fr}function Pa(I,f,w){(I===Ni&&Yi===2||I.cancelPendingCommit!==null)&&(lo(I,0),or(I,ci,Fr,!1)),z(I,w),((bi&2)===0||I!==Ni)&&(I===Ni&&((bi&2)===0&&(Ql|=w),Oi===4&&or(I,ci,Fr,!1)),Se(I))}function xc(I,f,w){if((bi&6)!==0)throw Error(a(327));var V=!w&&(f&60)===0&&(f&I.expiredLanes)===0||M(I,f),Y=V?wA(I,f):zI(I,f,!0),J=V;do{if(Y===0){Er&&!V&&or(I,f,0,!1);break}else if(Y===6)or(I,f,0,!us);else{if(w=I.current.alternate,J&&!yu(w)){Y=zI(I,f,!1),J=!1;continue}if(Y===2){if(J=f,I.errorRecoveryDisabledLanes&J)var ve=0;else ve=I.pendingLanes&-536870913,ve=ve!==0?ve:ve&536870912?536870912:0;if(ve!==0){f=ve;e:{var Pe=I;Y=Kg;var dt=co&&Pe.current.memoizedState.isDehydrated;if(dt&&(lo(Pe,ve).flags|=256),ve=zI(Pe,ve,!1),ve!==2){if(Ta&&!dt){Pe.errorRecoveryDisabledLanes|=J,Ql|=J,Y=4;break e}J=Ia,Ia=Y,J!==null&&Od(J)}Y=ve}if(J=!1,Y!==2)continue}}if(Y===1){lo(I,0),or(I,f,0,!0);break}e:{switch(V=I,Y){case 0:case 1:throw Error(a(345));case 4:if((f&4194176)===f){or(V,f,Fr,!us);break e}break;case 2:Ia=null;break;case 3:case 5:break;default:throw Error(a(329))}if(V.finishedWork=w,V.finishedLanes=f,(f&62914560)===f&&(J=Lo+300-os(),10<J)){if(or(V,f,Fr,!us),x(V,0)!==0)break e;V.timeoutHandle=Wa(YI.bind(null,V,w,Ia,IC,hh,f,Fr,Ql,cl,us,2,-0,0),J);break e}YI(V,w,Ia,IC,hh,f,Fr,Ql,cl,us,0,-0,0)}}break}while(!0);Se(I)}function Od(I){Ia===null?Ia=I:Ia.push.apply(Ia,I)}function YI(I,f,w,V,Y,J,ve,Pe,dt,zt,en,In,An){var Un=f.subtreeFlags;if((Un&8192||(Un&16785408)===16785408)&&(XA(),XI(f),f=Va(),f!==null)){I.cancelPendingCommit=f(Wc.bind(null,I,w,V,Y,ve,Pe,dt,1,In,An)),or(I,J,ve,!zt);return}Wc(I,w,V,Y,ve,Pe,dt,en,In,An)}function yu(I){for(var f=I;;){var w=f.tag;if((w===0||w===11||w===15)&&f.flags&16384&&(w=f.updateQueue,w!==null&&(w=w.stores,w!==null)))for(var V=0;V<w.length;V++){var Y=w[V],J=Y.getSnapshot;Y=Y.value;try{if(!sr(J(),Y))return!1}catch{return!1}}if(w=f.child,f.subtreeFlags&16384&&w!==null)w.return=f,f=w;else{if(f===I)break;for(;f.sibling===null;){if(f.return===null||f.return===I)return!0;f=f.return}f.sibling.return=f.return,f=f.sibling}}return!0}function or(I,f,w,V){f&=~CC,f&=~Ql,I.suspendedLanes|=f,I.pingedLanes&=~f,V&&(I.warmLanes|=f),V=I.expirationTimes;for(var Y=f;0<Y;){var J=31-zo(Y),ve=1<<J;V[J]=-1,Y&=~ve}w!==0&&D(I,w,f)}function Ud(){return(bi&6)===0?(ee(0),!1):!0}function Bu(){if(En!==null){if(Yi===0)var I=En.return;else I=En,Vr=Hs=null,xt(I),_c=null,Dc=0,I=En;for(;I!==null;)zb(I.alternate,I),I=I.return;En=null}}function lo(I,f){I.finishedWork=null,I.finishedLanes=0;var w=I.timeoutHandle;w!==Hc&&(I.timeoutHandle=Hc,JI(w)),w=I.cancelPendingCommit,w!==null&&(I.cancelPendingCommit=null,w()),Bu(),Ni=I,En=w=ts(I.current,null),ci=f,Yi=0,Bo=null,us=!1,Er=M(I,f),Ta=!1,cl=Fr=CC=Ql=Hr=Oi=0,Ia=Kg=null,hh=!1,(f&8)!==0&&(f|=f&32);var V=I.entangledLanes;if(V!==0)for(I=I.entanglements,V&=f;0<V;){var Y=31-zo(V),J=1<<Y;f|=I[Y],V&=~J}return Go=f,le(),w}function Br(I,f){ei=null,Yn.H=da,f===Ku?(f=_t(),Yi=3):f===uC?(f=_t(),Yi=4):Yi=f===Ch?8:f!==null&&typeof f=="object"&&typeof f.then=="function"?6:1,Bo=f,En===null&&(Oi=1,Qr(I,q(f,I.current)))}function Mc(){var I=Mr.current;return I===null?!0:(ci&4194176)===ci?_i===null:(ci&62914560)===ci||(ci&536870912)!==0?I===_i:!1}function js(){var I=Yn.H;return Yn.H=da,I===null?da:I}function Qs(){var I=Yn.A;return Yn.A=Du,I}function Tl(){Oi=4,us||(ci&4194176)!==ci&&Mr.current!==null||(Er=!0),(Hr&134217727)===0&&(Ql&134217727)===0||Ni===null||or(Ni,ci,Fr,!1)}function zI(I,f,w){var V=bi;bi|=2;var Y=js(),J=Qs();(Ni!==I||ci!==f)&&(IC=null,lo(I,f)),f=!1;var ve=Oi;e:do try{if(Yi!==0&&En!==null){var Pe=En,dt=Bo;switch(Yi){case 8:Bu(),ve=6;break e;case 3:case 2:case 6:Mr.current===null&&(f=!0);var zt=Yi;if(Yi=0,Bo=null,es(I,Pe,dt,zt),w&&Er){ve=0;break e}break;default:zt=Yi,Yi=0,Bo=null,es(I,Pe,dt,zt)}}SA(),ve=Oi;break}catch(en){Br(I,en)}while(!0);return f&&I.shellSuspendCounter++,Vr=Hs=null,bi=V,Yn.H=Y,Yn.A=J,En===null&&(Ni=null,ci=0,le()),ve}function SA(){for(;En!==null;)sa(En)}function wA(I,f){var w=bi;bi|=2;var V=js(),Y=Qs();Ni!==I||ci!==f?(IC=null,Uu=os()+500,lo(I,f)):Er=M(I,f);e:do try{if(Yi!==0&&En!==null){f=En;var J=Bo;t:switch(Yi){case 1:Yi=0,Bo=null,es(I,f,J,1);break;case 2:if(ut(J)){Yi=0,Bo=null,Si(f);break}f=function(){Yi===2&&Ni===I&&(Yi=7),Se(I)},J.then(f,f);break e;case 3:Yi=7;break e;case 4:Yi=5;break e;case 7:ut(J)?(Yi=0,Bo=null,Si(f)):(Yi=0,Bo=null,es(I,f,J,7));break;case 5:var ve=null;switch(En.tag){case 26:ve=En.memoizedState;case 5:case 27:var Pe=En,dt=Pe.type,zt=Pe.pendingProps;if(ve?Rg(ve):jI(dt,zt)){Yi=0,Bo=null;var en=Pe.sibling;if(en!==null)En=en;else{var In=Pe.return;In!==null?(En=In,Gr(In)):En=null}break t}}Yi=0,Bo=null,es(I,f,J,5);break;case 6:Yi=0,Bo=null,es(I,f,J,6);break;case 8:Bu(),Oi=6;break e;default:throw Error(a(462))}}Xo();break}catch(An){Br(I,An)}while(!0);return Vr=Hs=null,Yn.H=V,Yn.A=Y,bi=w,En!==null?0:(Ni=null,ci=0,le(),Oi)}function Xo(){for(;En!==null&&!M0();)sa(En)}function sa(I){var f=Xb(I.alternate,I,Go);I.memoizedProps=I.pendingProps,f===null?Gr(I):En=f}function Si(I){var f=I,w=f.alternate;switch(f.tag){case 15:case 0:f=Wd(w,f,f.pendingProps,f.type,void 0,ci);break;case 11:f=Wd(w,f,f.pendingProps,f.type.render,f.ref,ci);break;case 5:xt(f);default:zb(w,f),f=En=Pd(f,Go),f=Xb(w,f,Go)}I.memoizedProps=I.pendingProps,f===null?Gr(I):En=f}function es(I,f,w,V){Vr=Hs=null,xt(f),_c=null,Dc=0;var Y=f.return;try{if(rA(I,Y,f,w,ci)){Oi=1,Qr(I,q(w,I.current)),En=null;return}}catch(J){if(Y!==null)throw En=Y,J;Oi=1,Qr(I,q(w,I.current)),En=null;return}f.flags&32768?(fi||V===1?I=!0:Er||(ci&536870912)!==0?I=!1:(us=I=!0,(V===2||V===3||V===6)&&(V=Mr.current,V!==null&&V.tag===13&&(V.flags|=16384))),KI(f,I)):Gr(f)}function Gr(I){var f=I;do{if((f.flags&32768)!==0){KI(f,us);return}I=f.return;var w=Yb(f.alternate,f,Go);if(w!==null){En=w;return}if(f=f.sibling,f!==null){En=f;return}En=f=I}while(f!==null);Oi===0&&(Oi=5)}function KI(I,f){do{var w=RS(I.alternate,I);if(w!==null){w.flags&=32767,En=w;return}if(w=I.return,w!==null&&(w.flags|=32768,w.subtreeFlags=0,w.deletions=null),!f&&(I=I.sibling,I!==null)){En=I;return}En=I=w}while(I!==null);Oi=6,En=null}function Wc(I,f,w,V,Y,J,ve,Pe,dt,zt){var en=Yn.T,In=Dl();try{yo(2),Yn.T=null,Db(I,f,w,V,In,Y,J,ve,Pe,dt,zt)}finally{Yn.T=en,yo(In)}}function Db(I,f,w,V,Y,J,ve,Pe){do Rs();while(gl!==null);if((bi&6)!==0)throw Error(a(327));var dt=I.finishedWork;if(V=I.finishedLanes,dt===null)return null;if(I.finishedWork=null,I.finishedLanes=0,dt===I.current)throw Error(a(177));I.callbackNode=null,I.callbackPriority=0,I.cancelPendingCommit=null;var zt=dt.lanes|dt.childLanes;if(zt|=Ns,_(I,V,zt,J,ve,Pe),I===Ni&&(En=Ni=null,ci=0),(dt.subtreeFlags&10256)===0&&(dt.flags&10256)===0||Xs||(Xs=!0,Jc=zt,fh=w,zl(ch,function(){return Rs(),null})),w=(dt.flags&15990)!==0,(dt.subtreeFlags&15990)!==0||w?(w=Yn.T,Yn.T=null,J=Dl(),yo(2),ve=bi,bi|=4,Kd(I,dt),bA(dt,I),Pb(I.containerInfo),I.current=dt,EI(I,dt.alternate,dt),sh(),bi=ve,yo(J),Yn.T=w):I.current=dt,Xs?(Xs=!1,gl=I,Lg=V):RA(I,zt),zt=I.pendingLanes,zt===0&&(Pc=null),X(dt.stateNode),Se(I),f!==null)for(Y=I.onRecoverableError,dt=0;dt<f.length;dt++)zt=f[dt],Y(zt.value,{componentStack:zt.stack});return(Lg&3)!==0&&Rs(),zt=I.pendingLanes,(V&4194218)!==0&&(zt&42)!==0?I===Ah?ku++:(ku=0,Ah=I):ku=0,ee(0),null}function RA(I,f){(I.pooledCacheLanes&=f)===0&&(f=I.pooledCache,f!=null&&(I.pooledCache=null,Xd(f)))}function Rs(){if(gl!==null){var I=gl,f=Jc;Jc=0;var w=$(Lg),V=32>w?32:w;w=Yn.T;var Y=Dl();try{if(yo(V),Yn.T=null,gl===null)var J=!1;else{V=fh,fh=null;var ve=gl,Pe=Lg;if(gl=null,Lg=0,(bi&6)!==0)throw Error(a(331));var dt=bi;if(bi|=4,TI(ve.current),vA(ve,ve.current,Pe,V),bi=dt,ee(0,!1),rr&&typeof rr.onPostCommitFiberRoot=="function")try{rr.onPostCommitFiberRoot(Sa,ve)}catch{}J=!0}return J}finally{yo(Y),Yn.T=w,RA(I,f)}}return!1}function Gu(I,f,w){f=q(w,f),f=qr(I.stateNode,f,2),I=je(I,f,2),I!==null&&(z(I,2),Se(I))}function Wi(I,f,w){if(I.tag===3)Gu(I,I,w);else for(;f!==null;){if(f.tag===3){Gu(f,I,w);break}else if(f.tag===1){var V=f.stateNode;if(typeof f.type.getDerivedStateFromError=="function"||typeof V.componentDidCatch=="function"&&(Pc===null||!Pc.has(V))){I=q(w,I),w=vg(2),V=je(f,w,2),V!==null&&(bo(w,V,f,I),z(V,2),Se(V));break}}f=f.return}}function Gg(I,f,w){var V=I.pingCache;if(V===null){V=I.pingCache=new gs;var Y=new Set;V.set(f,Y)}else Y=V.get(f),Y===void 0&&(Y=new Set,V.set(f,Y));Y.has(w)||(Ta=!0,Y.add(w),I=ZA.bind(null,I,f,w),f.then(I,I))}function ZA(I,f,w){var V=I.pingCache;V!==null&&V.delete(f),I.pingedLanes|=I.suspendedLanes&w,I.warmLanes&=~w,Ni===I&&(ci&w)===w&&(Oi===4||Oi===3&&(ci&62914560)===ci&&300>os()-Lo?(bi&2)===0&&lo(I,0):CC|=w,cl===ci&&(cl=0)),Se(I)}function Vc(I,f){f===0&&(f=N()),I=Ge(I,f),I!==null&&(z(I,f),Se(I))}function Yl(I){var f=I.memoizedState,w=0;f!==null&&(w=f.retryLane),Vc(I,w)}function Nc(I,f){var w=0;switch(I.tag){case 13:var V=I.stateNode,Y=I.memoizedState;Y!==null&&(w=Y.retryLane);break;case 19:V=I.stateNode;break;case 22:V=I.stateNode._retryCache;break;default:throw Error(a(314))}V!==null&&V.delete(f),Vc(I,w)}function zl(I,f){return lC(I,f)}function xA(I,f,w,V){this.tag=I,this.key=w,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=f,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=V,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function kd(I){return I=I.prototype,!(!I||!I.isReactComponent)}function ts(I,f){var w=I.alternate;return w===null?(w=t(I.tag,f,I.key,I.mode),w.elementType=I.elementType,w.type=I.type,w.stateNode=I.stateNode,w.alternate=I,I.alternate=w):(w.pendingProps=f,w.type=I.type,w.flags=0,w.subtreeFlags=0,w.deletions=null),w.flags=I.flags&31457280,w.childLanes=I.childLanes,w.lanes=I.lanes,w.child=I.child,w.memoizedProps=I.memoizedProps,w.memoizedState=I.memoizedState,w.updateQueue=I.updateQueue,f=I.dependencies,w.dependencies=f===null?null:{lanes:f.lanes,firstContext:f.firstContext},w.sibling=I.sibling,w.index=I.index,w.ref=I.ref,w.refCleanup=I.refCleanup,w}function Pd(I,f){I.flags&=31457282;var w=I.alternate;return w===null?(I.childLanes=0,I.lanes=f,I.child=null,I.subtreeFlags=0,I.memoizedProps=null,I.memoizedState=null,I.updateQueue=null,I.dependencies=null,I.stateNode=null):(I.childLanes=w.childLanes,I.lanes=w.lanes,I.child=w.child,I.subtreeFlags=0,I.deletions=null,I.memoizedProps=w.memoizedProps,I.memoizedState=w.memoizedState,I.updateQueue=w.updateQueue,I.type=w.type,f=w.dependencies,I.dependencies=f===null?null:{lanes:f.lanes,firstContext:f.firstContext}),I}function qs(I,f,w,V,Y,J){var ve=0;if(V=I,typeof I=="function")kd(I)&&(ve=1);else if(typeof I=="string")ve=wr&&Li?oC(I,w,Fa.current)?26:el(I)?27:5:wr?oC(I,w,Fa.current)?26:5:Li&&el(I)?27:5;else e:switch(I){case Ec:return ua(w.children,Y,J,f);case qd:ve=8,Y|=24;break;case OI:return I=t(12,w,f,Y|2),I.elementType=OI,I.lanes=J,I;case UI:return I=t(13,w,f,Y),I.elementType=UI,I.lanes=J,I;case Zu:return I=t(19,w,f,Y),I.elementType=Zu,I.lanes=J,I;case VA:return Jd(w,Y,J,f);default:if(typeof I=="object"&&I!==null)switch(I.$$typeof){case $d:case Zs:ve=10;break e;case WA:ve=9;break e;case eC:ve=11;break e;case kI:ve=14;break e;case is:ve=16,V=null;break e}ve=29,w=Error(a(130,I===null?"null":typeof I,"")),V=null}return f=t(ve,w,f,Y),f.elementType=I,f.type=V,f.lanes=J,f}function ua(I,f,w,V){return I=t(7,I,V,f),I.lanes=w,I}function Jd(I,f,w,V){I=t(22,I,V,f),I.elementType=VA,I.lanes=w;var Y={_visibility:1,_pendingVisibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null,_current:null,detach:function(){var J=Y._current;if(J===null)throw Error(a(456));if((Y._pendingVisibility&2)===0){var ve=Ge(J,2);ve!==null&&(Y._pendingVisibility|=2,Pa(ve,J,2))}},attach:function(){var J=Y._current;if(J===null)throw Error(a(456));if((Y._pendingVisibility&2)!==0){var ve=Ge(J,2);ve!==null&&(Y._pendingVisibility&=-3,Pa(ve,J,2))}}};return I.stateNode=Y,I}function LI(I,f,w){return I=t(6,I,null,f),I.lanes=w,I}function MA(I,f,w){return f=t(4,I.children!==null?I.children:[],I.key,f),f.lanes=w,f.stateNode={containerInfo:I.containerInfo,pendingChildren:null,implementation:I.implementation},f}function ZS(I,f,w,V,Y,J,ve,Pe){this.tag=1,this.containerInfo=I,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=Hc,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=H(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.finishedLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=H(0),this.hiddenUpdates=H(null),this.identifierPrefix=V,this.onUncaughtError=Y,this.onCaughtError=J,this.onRecoverableError=ve,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Pe,this.incompleteTransitions=new Map}function Ob(I,f,w,V,Y,J,ve,Pe,dt,zt,en,In){return I=new ZS(I,f,w,ve,Pe,dt,zt,In),f=1,J===!0&&(f|=24),J=t(3,null,null,f),I.current=J,J.stateNode=I,f=Gc(),f.refCount++,I.pooledCache=f,f.refCount++,J.memoizedState={element:V,isDehydrated:w,cache:f},qe(J),I}function Ma(I){return I?(I=zc,I):zc}function _I(I){var f=I._reactInternals;if(f===void 0)throw typeof I.render=="function"?Error(a(188)):(I=Object.keys(I).join(","),Error(a(268,I)));return I=m(f),I=I!==null?p(I):null,I===null?null:Wu(I.stateNode)}function Su(I,f,w,V,Y,J){Y=Ma(Y),V.context===null?V.context=Y:V.pendingContext=Y,V=$e(f),V.payload={element:w},J=J===void 0?null:J,J!==null&&(V.callback=J),w=je(I,V,f),w!==null&&(Pa(w,I,f),ke(w,I,f))}function wu(I,f){if(I=I.memoizedState,I!==null&&I.dehydrated!==null){var w=I.retryLane;I.retryLane=w!==0&&w<f?w:f}}function jd(I,f){wu(I,f),(I=I.alternate)&&wu(I,f)}var kn={},Ru=Kf(),Sr=q8(),DI=Object.assign,xS=Symbol.for("react.element"),Qd=Symbol.for("react.transitional.element"),ns=Symbol.for("react.portal"),Ec=Symbol.for("react.fragment"),qd=Symbol.for("react.strict_mode"),OI=Symbol.for("react.profiler"),$d=Symbol.for("react.provider"),WA=Symbol.for("react.consumer"),Zs=Symbol.for("react.context"),eC=Symbol.for("react.forward_ref"),UI=Symbol.for("react.suspense"),Zu=Symbol.for("react.suspense_list"),kI=Symbol.for("react.memo"),is=Symbol.for("react.lazy"),VA=Symbol.for("react.offscreen"),Ub=Symbol.for("react.memo_cache_sentinel"),Kl=Symbol.iterator,NA=Symbol.for("react.client.reference"),Yn=Ru.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,$s,Ll,Sg=!1,xu=Array.isArray,EA=e.rendererVersion,tC=e.rendererPackageName,Mu=e.extraDevToolsConfig,Wu=e.getPublicInstance,kb=e.getRootHostContext,Vu=e.getChildHostContext,PI=e.prepareForCommit,Pb=e.resetAfterCommit,HA=e.createInstance,nC=e.appendInitialChild,_l=e.finalizeInitialChildren,Pn=e.shouldSetTextContent,Hi=e.createTextInstance,Wa=e.scheduleTimeout,JI=e.cancelTimeout,Hc=e.noTimeout,To=e.isPrimaryRenderer;e.warnsIfNotActing;var Ha=e.supportsMutation,as=e.supportsPersistence,co=e.supportsHydration,Jb=e.getInstanceFromNode;e.beforeActiveInstanceBlur,e.afterActiveInstanceBlur;var Ba=e.preparePortalMount;e.prepareScopeUpdate,e.getInstanceFromScope;var yo=e.setCurrentUpdatePriority,Dl=e.getCurrentUpdatePriority,jb=e.resolveUpdatePriority;e.resolveEventType,e.resolveEventTimeStamp;var Qb=e.shouldAttemptEagerTransition,MS=e.detachDeletedInstance;e.requestPostPaintCallback;var FA=e.maySuspendCommit,jI=e.preloadInstance,XA=e.startSuspendingCommit,Yo=e.suspendInstance,Va=e.waitForCommitToBeReady,Fc=e.NotPendingTransition,xs=e.HostTransitionContext,QI=e.resetFormInstance;e.bindToConsole;var TA=e.supportsMicrotasks,Ol=e.scheduleMicrotask,Xc=e.supportsTestSelectors,YA=e.findFiberRoot,zA=e.getBoundingRect,qb=e.getTextContent,Nu=e.isHiddenSubtree,$b=e.matchAccessibilityRole,e0=e.setFocusIfFocusable,t0=e.setupIntersectionObserver,n0=e.appendChild,KA=e.appendChildToContainer,i0=e.commitTextUpdate,WS=e.commitMount,a0=e.commitUpdate,o0=e.insertBefore,r0=e.insertInContainerBefore,LA=e.removeChild,s0=e.removeChildFromContainer,_A=e.resetTextContent,l0=e.hideInstance,c0=e.hideTextInstance,g0=e.unhideInstance,VS=e.unhideTextInstance,u0=e.clearContainer,Eu=e.cloneInstance,iC=e.createContainerChildSet,DA=e.appendChildToContainerChildSet,qI=e.finalizeContainerChildren,Hu=e.replaceContainerChildren,OA=e.cloneHiddenInstance,UA=e.cloneHiddenTextInstance,$I=e.isSuspenseInstancePending,eh=e.isSuspenseInstanceFallback,d0=e.getSuspenseInstanceFallbackErrorDetails,C0=e.registerSuspenseInstanceRetry,kA=e.canHydrateFormStateMarker,I0=e.isFormStateMarkerMatching,PA=e.getNextHydratableSibling,th=e.getFirstHydratableChild,h0=e.getFirstHydratableChildWithinContainer,f0=e.getFirstHydratableChildWithinSuspenseInstance,NS=e.canHydrateInstance,JA=e.canHydrateTextInstance,A0=e.canHydrateSuspenseInstance,m0=e.hydrateInstance,jA=e.hydrateTextInstance,p0=e.hydrateSuspenseInstance,b0=e.getNextHydratableInstanceAfterSuspenseInstance,ES=e.commitHydratedContainer,HS=e.commitHydratedSuspenseInstance,v0=e.clearSuspenseBoundary,aC=e.clearSuspenseBoundaryFromContainer,nh=e.shouldDeleteUnhydratedTailInstances;e.diffHydratedPropsForDevWarnings,e.diffHydratedTextForDevWarnings,e.describeHydratableInstanceForDevWarnings;var ih=e.validateHydratableInstance,y0=e.validateHydratableTextInstance,wr=e.supportsResources,oC=e.isHostHoistableType,ah=e.getHoistableRoot,QA=e.getResource,B0=e.acquireResource,wg=e.releaseResource,rC=e.hydrateHoistable,sC=e.mountHoistable,Fu=e.unmountHoistable,oh=e.createHoistableInstance,G0=e.prepareToCommitHoistables,S0=e.mayResourceSuspendCommit,Rg=e.preloadResource,w0=e.suspendResource,Li=e.supportsSingletons,Ms=e.resolveSingletonInstance,Tc=e.clearSingleton,R0=e.acquireSingletonInstance,Yc=e.releaseSingletonInstance,el=e.isHostSingletonType,Ga=[],Ul=-1,zc={},zo=Math.clz32?Math.clz32:R,Z0=Math.log,x0=Math.LN2,tl=128,Zg=4194304,lC=Sr.unstable_scheduleCallback,rh=Sr.unstable_cancelCallback,M0=Sr.unstable_shouldYield,sh=Sr.unstable_requestPaint,os=Sr.unstable_now,lh=Sr.unstable_ImmediatePriority,W0=Sr.unstable_UserBlockingPriority,ch=Sr.unstable_NormalPriority,FS=Sr.unstable_IdlePriority,V0=Sr.log,Ja=Sr.unstable_setDisableYieldValue,Sa=null,rr=null,sr=typeof Object.is=="function"?Object.is:U,qA=new WeakMap,xg=[],Mg=0,Wg=null,Xu=0,Rr=[],Zr=0,Kc=null,Ws=1,Vs="",Fa=b(null),Tu=b(null),nl=b(null),Vg=b(null),go=null,uo=null,fi=!1,rs=null,ja=!1,cC=Error(a(519)),ss=[],Ng=0,Ns=0,gC=null,kl=null,Eg=!1,ki=!1,$A=!1,Yu=0,zu=null,Hg=0,xr=0,Fg=null,Pl=!1,Xg=!1,il=Object.prototype.hasOwnProperty,Ku=Error(a(460)),uC=Error(a(474)),dC={then:function(){}},Lc=null,_c=null,Dc=0,Oc=jt(!0),al=jt(!1),Pi=b(null),Lu=b(0),Mr=b(null),_i=null,Xa=b(0),Jl=0,ei=null,Nn=null,pi=null,ls=!1,Tg=!1,Uc=!1,gh=0,Yg=0,Qa=null,Es=0,uh=function(){return{lastEffect:null,events:null,stores:null,memoCache:null}},da={readContext:oo,use:se,useCallback:sn,useContext:sn,useEffect:sn,useImperativeHandle:sn,useLayoutEffect:sn,useInsertionEffect:sn,useMemo:sn,useReducer:sn,useRef:sn,useState:sn,useDebugValue:sn,useDeferredValue:sn,useTransition:sn,useSyncExternalStore:sn,useId:sn};da.useCacheRefresh=sn,da.useMemoCache=sn,da.useHostTransitionStatus=sn,da.useFormState=sn,da.useActionState=sn,da.useOptimistic=sn;var kc={readContext:oo,use:se,useCallback:function(I,f){return te().memoizedState=[I,f===void 0?null:f],I},useContext:oo,useEffect:oa,useImperativeHandle:function(I,f,w){w=w!=null?w.concat([I]):null,aa(4194308,4,Ki.bind(null,f,I),w)},useLayoutEffect:function(I,f){return aa(4194308,4,I,f)},useInsertionEffect:function(I,f){aa(4,2,I,f)},useMemo:function(I,f){var w=te();f=f===void 0?null:f;var V=I();if(Uc){L(!0);try{I()}finally{L(!1)}}return w.memoizedState=[V,f],V},useReducer:function(I,f,w){var V=te();if(w!==void 0){var Y=w(f);if(Uc){L(!0);try{w(f)}finally{L(!1)}}}else Y=f;return V.memoizedState=V.baseState=Y,I={pending:null,lanes:0,dispatch:null,lastRenderedReducer:I,lastRenderedState:Y},V.queue=I,I=I.dispatch=jr.bind(null,ei,I),[V.memoizedState,I]},useRef:function(I){var f=te();return I={current:I},f.memoizedState=I},useState:function(I){I=nn(I);var f=I.queue,w=Js.bind(null,ei,f);return f.dispatch=w,[I.memoizedState,w]},useDebugValue:ba,useDeferredValue:function(I,f){var w=te();return jo(w,I,f)},useTransition:function(){var I=nn(!1);return I=br.bind(null,ei,I.queue,!0,!1),te().memoizedState=I,[!1,I]},useSyncExternalStore:function(I,f,w){var V=ei,Y=te();if(fi){if(w===void 0)throw Error(a(407));w=w()}else{if(w=f(),Ni===null)throw Error(a(349));(ci&60)!==0||Mt(V,f,w)}Y.memoizedState=w;var J={value:w,getSnapshot:f};return Y.queue=J,oa(ln.bind(null,V,J,I),[I]),V.flags|=2048,li(9,Yt.bind(null,V,J,w,f),{destroy:void 0},null),w},useId:function(){var I=te(),f=Ni.identifierPrefix;if(fi){var w=Vs,V=Ws;w=(V&~(1<<32-zo(V)-1)).toString(32)+w,f=":"+f+"R"+w,w=gh++,0<w&&(f+="H"+w.toString(32)),f+=":"}else w=Es++,f=":"+f+"r"+w.toString(32)+":";return I.memoizedState=f},useCacheRefresh:function(){return te().memoizedState=Gi.bind(null,ei)}};kc.useMemoCache=Re,kc.useHostTransitionStatus=wn,kc.useFormState=Cn,kc.useActionState=Cn,kc.useOptimistic=function(I){var f=te();f.memoizedState=f.baseState=I;var w={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return f.queue=w,f=Qo.bind(null,ei,!0,w),w.dispatch=f,[I,f]};var Ko={readContext:oo,use:se,useCallback:Ea,useContext:oo,useEffect:mr,useImperativeHandle:Ua,useInsertionEffect:bc,useLayoutEffect:pr,useMemo:po,useReducer:nt,useRef:Zi,useState:function(){return nt(Ue)},useDebugValue:ba,useDeferredValue:function(I,f){var w=Ie();return Jr(w,Nn.memoizedState,I,f)},useTransition:function(){var I=nt(Ue)[0],f=Ie().memoizedState;return[typeof I=="boolean"?I:Ae(I),f]},useSyncExternalStore:Bt,useId:hi};Ko.useCacheRefresh=Dn,Ko.useMemoCache=Re,Ko.useHostTransitionStatus=wn,Ko.useFormState=Gn,Ko.useActionState=Gn,Ko.useOptimistic=function(I,f){var w=Ie();return mn(w,Nn,I,f)};var Wr={readContext:oo,use:se,useCallback:Ea,useContext:oo,useEffect:mr,useImperativeHandle:Ua,useInsertionEffect:bc,useLayoutEffect:pr,useMemo:po,useReducer:it,useRef:Zi,useState:function(){return it(Ue)},useDebugValue:ba,useDeferredValue:function(I,f){var w=Ie();return Nn===null?jo(w,I,f):Jr(w,Nn.memoizedState,I,f)},useTransition:function(){var I=it(Ue)[0],f=Ie().memoizedState;return[typeof I=="boolean"?I:Ae(I),f]},useSyncExternalStore:Bt,useId:hi};Wr.useCacheRefresh=Dn,Wr.useMemoCache=Re,Wr.useHostTransitionStatus=wn,Wr.useFormState=Qn,Wr.useActionState=Qn,Wr.useOptimistic=function(I,f){var w=Ie();return Nn!==null?mn(w,Nn,I,f):(w.baseState=I,[I,w.queue.dispatch])};var ol={isMounted:function(I){return(I=I._reactInternals)?C(I)===I:!1},enqueueSetState:function(I,f,w){I=I._reactInternals;var V=ya(),Y=$e(V);Y.payload=f,w!=null&&(Y.callback=w),f=je(I,Y,V),f!==null&&(Pa(f,I,V),ke(f,I,V))},enqueueReplaceState:function(I,f,w){I=I._reactInternals;var V=ya(),Y=$e(V);Y.tag=1,Y.payload=f,w!=null&&(Y.callback=w),f=je(I,Y,V),f!==null&&(Pa(f,I,V),ke(f,I,V))},enqueueForceUpdate:function(I,f){I=I._reactInternals;var w=ya(),V=$e(w);V.tag=2,f!=null&&(V.callback=f),f=je(I,V,w),f!==null&&(Pa(f,I,w),ke(f,I,w))}},dh=typeof reportError=="function"?reportError:function(I){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var f=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof I=="object"&&I!==null&&typeof I.message=="string"?String(I.message):String(I),error:I});if(!window.dispatchEvent(f))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",I);return}console.error(I)},Ch=Error(a(461)),Di=!1,Ih={dehydrated:null,treeContext:null,retryLane:0},jl=b(null),Hs=null,Vr=null,_u=typeof AbortController<"u"?AbortController:function(){var I=[],f=this.signal={aborted:!1,addEventListener:function(w,V){I.push(V)}};this.abort=function(){f.aborted=!0,I.forEach(function(w){return w()})}},N0=Sr.unstable_scheduleCallback,E0=Sr.unstable_NormalPriority,Ji={$$typeof:Zs,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0},em=Yn.S;Yn.S=function(I,f){typeof f=="object"&&f!==null&&typeof f.then=="function"&&Oe(I,f),em!==null&&em(I,f)};var rl=b(null),sl=!1,Ca=!1,tm=!1,Vi=typeof WeakSet=="function"?WeakSet:Set,On=null,oi=!1,Wn=null,qn=!1,la=null,Nr=8192,Du={getCacheForType:function(I){var f=oo(Ji),w=f.data.get(I);return w===void 0&&(w=I(),f.data.set(I,w)),w}},Ou=0,cs=1,ta=2,Fs=3,ll=4;if(typeof Symbol=="function"&&Symbol.for){var zg=Symbol.for;Ou=zg("selector.component"),cs=zg("selector.has_pseudo_class"),ta=zg("selector.role"),Fs=zg("selector.test_id"),ll=zg("selector.text")}var gs=typeof WeakMap=="function"?WeakMap:Map,bi=0,Ni=null,En=null,ci=0,Yi=0,Bo=null,us=!1,Er=!1,Ta=!1,Go=0,Oi=0,Hr=0,Ql=0,CC=0,Fr=0,cl=0,Kg=null,Ia=null,hh=!1,Lo=0,Uu=1/0,IC=null,Pc=null,Xs=!1,gl=null,Lg=0,Jc=0,fh=null,ku=0,Ah=null;return kn.attemptContinuousHydration=function(I){if(I.tag===13){var f=Ge(I,67108864);f!==null&&Pa(f,I,67108864),jd(I,67108864)}},kn.attemptHydrationAtCurrentPriority=function(I){if(I.tag===13){var f=ya(),w=Ge(I,f);w!==null&&Pa(w,I,f),jd(I,f)}},kn.attemptSynchronousHydration=function(I){switch(I.tag){case 3:if(I=I.stateNode,I.current.memoizedState.isDehydrated){var f=Z(I.pendingLanes);if(f!==0){for(I.pendingLanes|=2,I.entangledLanes|=2;f;){var w=1<<31-zo(f);I.entanglements[1]|=w,f&=~w}Se(I),(bi&6)===0&&(Uu=os()+500,ee(0))}}break;case 13:f=Ge(I,2),f!==null&&Pa(f,I,2),Ud(),jd(I,2)}},kn.batchedUpdates=function(I,f){return I(f)},kn.createComponentSelector=function(I){return{$$typeof:Ou,value:I}},kn.createContainer=function(I,f,w,V,Y,J,ve,Pe,dt,zt){return Ob(I,f,!1,null,w,V,J,ve,Pe,dt,zt,null)},kn.createHasPseudoClassSelector=function(I){return{$$typeof:cs,value:I}},kn.createHydrationContainer=function(I,f,w,V,Y,J,ve,Pe,dt,zt,en,In,An){return I=Ob(w,V,!0,I,Y,J,Pe,dt,zt,en,In,An),I.context=Ma(null),w=I.current,V=ya(),Y=$e(V),Y.callback=f??null,je(w,Y,V),I.current.lanes=V,z(I,V),Se(I),I},kn.createPortal=function(I,f,w){var V=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ns,key:V==null?null:""+V,children:I,containerInfo:f,implementation:w}},kn.createRoleSelector=function(I){return{$$typeof:ta,value:I}},kn.createTestNameSelector=function(I){return{$$typeof:Fs,value:I}},kn.createTextSelector=function(I){return{$$typeof:ll,value:I}},kn.defaultOnCaughtError=function(I){console.error(I)},kn.defaultOnRecoverableError=function(I){dh(I)},kn.defaultOnUncaughtError=function(I){dh(I)},kn.deferredUpdates=function(I){var f=Yn.T,w=Dl();try{return yo(32),Yn.T=null,I()}finally{yo(w),Yn.T=f}},kn.discreteUpdates=function(I,f,w,V,Y){var J=Yn.T,ve=Dl();try{return yo(2),Yn.T=null,I(f,w,V,Y)}finally{yo(ve),Yn.T=J,bi===0&&(Uu=os()+500)}},kn.findAllNodes=Dd,kn.findBoundingRects=function(I,f){if(!Xc)throw Error(a(363));f=Dd(I,f),I=[];for(var w=0;w<f.length;w++)I.push(zA(f[w]));for(f=I.length-1;0<f;f--){w=I[f];for(var V=w.x,Y=V+w.width,J=w.y,ve=J+w.height,Pe=f-1;0<=Pe;Pe--)if(f!==Pe){var dt=I[Pe],zt=dt.x,en=zt+dt.width,In=dt.y,An=In+dt.height;if(V>=zt&&J>=In&&Y<=en&&ve<=An){I.splice(f,1);break}else if(V!==zt||w.width!==dt.width||An<J||In>ve){if(!(J!==In||w.height!==dt.height||en<V||zt>Y)){zt>V&&(dt.width+=zt-V,dt.x=V),en<Y&&(dt.width=Y-zt),I.splice(f,1);break}}else{In>J&&(dt.height+=In-J,dt.y=J),An<ve&&(dt.height=ve-In),I.splice(f,1);break}}}return I},kn.findHostInstance=_I,kn.findHostInstanceWithNoPortals=function(I){return I=m(I),I=I!==null?B(I):null,I===null?null:Wu(I.stateNode)},kn.findHostInstanceWithWarning=function(I){return _I(I)},kn.flushPassiveEffects=Rs,kn.flushSyncFromReconciler=function(I){var f=bi;bi|=1;var w=Yn.T,V=Dl();try{if(yo(2),Yn.T=null,I)return I()}finally{yo(V),Yn.T=w,bi=f,(bi&6)===0&&ee(0)}},kn.flushSyncWork=Ud,kn.focusWithin=function(I,f){if(!Xc)throw Error(a(363));for(I=vu(I),f=ar(I,f),f=Array.from(f),I=0;I<f.length;){var w=f[I++],V=w.tag;if(!Nu(w)){if((V===5||V===26||V===27)&&e0(w.stateNode))return!0;for(w=w.child;w!==null;)f.push(w),w=w.sibling}}return!1},kn.getFindAllNodesFailureDescription=function(I,f){if(!Xc)throw Error(a(363));var w=0,V=[];I=[vu(I),0];for(var Y=0;Y<I.length;){var J=I[Y++],ve=J.tag,Pe=I[Y++],dt=f[Pe];if((ve!==5&&ve!==26&&ve!==27||!Nu(J))&&(Zc(J,dt)&&(V.push(BA(dt)),Pe++,Pe>w&&(w=Pe)),Pe<f.length))for(J=J.child;J!==null;)I.push(J,Pe),J=J.sibling}if(w<f.length){for(I=[];w<f.length;w++)I.push(BA(f[w]));return`findAllNodes was able to match part of the selector:
  `+(V.join(" > ")+`

No matching component was found for:
  `)+I.join(" > ")}return null},kn.getPublicRootInstance=function(I){if(I=I.current,!I.child)return null;switch(I.child.tag){case 27:case 5:return Wu(I.child.stateNode);default:return I.child.stateNode}},kn.injectIntoDevTools=function(){var I={bundleType:0,version:EA,rendererPackageName:tC,currentDispatcherRef:Yn,findFiberByHostInstance:Jb,reconcilerVersion:"19.0.0"};if(Mu!==null&&(I.rendererConfig=Mu),typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")I=!1;else{var f=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(f.isDisabled||!f.supportsFiber)I=!0;else{try{Sa=f.inject(I),rr=f}catch{}I=!!f.checkDCE}}return I},kn.isAlreadyRendering=function(){return!1},kn.observeVisibleRects=function(I,f,w,V){if(!Xc)throw Error(a(363));I=Dd(I,f);var Y=t0(I,w,V).disconnect;return{disconnect:function(){Y()}}},kn.shouldError=function(){return null},kn.shouldSuspend=function(){return!1},kn.startHostTransition=function(I,f,w,V){if(I.tag!==5)throw Error(a(476));var Y=un(I).queue;br(I,Y,f,Fc,w===null?i:function(){var J=un(I).next.queue;return Eo(I,J,{},ya()),w(V)})},kn.updateContainer=function(I,f,w,V){var Y=f.current,J=ya();return Su(Y,J,I,f,w,V),J},kn.updateContainerSync=function(I,f,w,V){return f.tag===0&&Rs(),Su(f.current,2,I,f,w,V),2},kn},n.exports.default=n.exports,Object.defineProperty(n.exports,"__esModule",{value:!0})}(uw)),uw.exports}var $N;function e6(){return $N||($N=1,gw.exports=$8()),gw.exports}var t6=e6();const n6=mI(t6);var Iw={exports:{}},hw={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var eE;function i6(){return eE||(eE=1,function(n){function e(X,L){var U=X.length;X.push(L);e:for(;0<U;){var q=U-1>>>1,K=X[q];if(0<a(K,L))X[q]=L,X[U]=K,U=q;else break e}}function t(X){return X.length===0?null:X[0]}function i(X){if(X.length===0)return null;var L=X[0],U=X.pop();if(U!==L){X[0]=U;e:for(var q=0,K=X.length,O=K>>>1;q<O;){var j=2*(q+1)-1,ne=X[j],k=j+1,ie=X[k];if(0>a(ne,U))k<K&&0>a(ie,ne)?(X[q]=ie,X[k]=U,q=k):(X[q]=ne,X[j]=U,q=j);else if(k<K&&0>a(ie,U))X[q]=ie,X[k]=U,q=k;else break e}}return L}function a(X,L){var U=X.sortIndex-L.sortIndex;return U!==0?U:X.id-L.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;n.unstable_now=function(){return o.now()}}else{var r=Date,s=r.now();n.unstable_now=function(){return r.now()-s}}var l=[],c=[],u=1,C=null,h=3,m=!1,p=!1,B=!1,b=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;function R(X){for(var L=t(c);L!==null;){if(L.callback===null)i(c);else if(L.startTime<=X)i(c),L.sortIndex=L.expirationTime,e(l,L);else break;L=t(c)}}function Z(X){if(B=!1,R(X),!p)if(t(l)!==null)p=!0,P();else{var L=t(c);L!==null&&$(Z,L.startTime-X)}}var x=!1,M=-1,E=5,F=-1;function N(){return!(n.unstable_now()-F<E)}function H(){if(x){var X=n.unstable_now();F=X;var L=!0;try{e:{p=!1,B&&(B=!1,y(M),M=-1),m=!0;var U=h;try{t:{for(R(X),C=t(l);C!==null&&!(C.expirationTime>X&&N());){var q=C.callback;if(typeof q=="function"){C.callback=null,h=C.priorityLevel;var K=q(C.expirationTime<=X);if(X=n.unstable_now(),typeof K=="function"){C.callback=K,R(X),L=!0;break t}C===t(l)&&i(l),R(X)}else i(l);C=t(l)}if(C!==null)L=!0;else{var O=t(c);O!==null&&$(Z,O.startTime-X),L=!1}}break e}finally{C=null,h=U,m=!1}L=void 0}}finally{L?z():x=!1}}}var z;if(typeof S=="function")z=function(){S(H)};else if(typeof MessageChannel<"u"){var _=new MessageChannel,D=_.port2;_.port1.onmessage=H,z=function(){D.postMessage(null)}}else z=function(){b(H,0)};function P(){x||(x=!0,z())}function $(X,L){M=b(function(){X(n.unstable_now())},L)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(X){X.callback=null},n.unstable_continueExecution=function(){p||m||(p=!0,P())},n.unstable_forceFrameRate=function(X){0>X||125<X?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<X?Math.floor(1e3/X):5},n.unstable_getCurrentPriorityLevel=function(){return h},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(X){switch(h){case 1:case 2:case 3:var L=3;break;default:L=h}var U=h;h=L;try{return X()}finally{h=U}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(X,L){switch(X){case 1:case 2:case 3:case 4:case 5:break;default:X=3}var U=h;h=X;try{return L()}finally{h=U}},n.unstable_scheduleCallback=function(X,L,U){var q=n.unstable_now();switch(typeof U=="object"&&U!==null?(U=U.delay,U=typeof U=="number"&&0<U?q+U:q):U=q,X){case 1:var K=-1;break;case 2:K=250;break;case 5:K=1073741823;break;case 4:K=1e4;break;default:K=5e3}return K=U+K,X={id:u++,callback:L,priorityLevel:X,startTime:U,expirationTime:K,sortIndex:-1},U>q?(X.sortIndex=U,e(c,X),t(l)===null&&X===t(c)&&(B?(y(M),M=-1):B=!0,$(Z,U-q))):(X.sortIndex=K,e(l,X),p||m||(p=!0,P())),X},n.unstable_shouldYield=N,n.unstable_wrapCallback=function(X){var L=h;return function(){var U=h;h=L;try{return X.apply(this,arguments)}finally{h=U}}}}(hw)),hw}var tE;function a6(){return tE||(tE=1,Iw.exports=i6()),Iw.exports}var nE=a6();const o6=n=>typeof n=="object"&&typeof n.then=="function",jC=[];function FX(n,e,t=(i,a)=>i===a){if(n===e)return!0;if(!n||!e)return!1;const i=n.length;if(e.length!==i)return!1;for(let a=0;a<i;a++)if(!t(n[a],e[a]))return!1;return!0}function XX(n,e=null,t=!1,i={}){e===null&&(e=[n]);for(const o of jC)if(FX(e,o.keys,o.equal)){if(t)return;if(Object.prototype.hasOwnProperty.call(o,"error"))throw o.error;if(Object.prototype.hasOwnProperty.call(o,"response"))return i.lifespan&&i.lifespan>0&&(o.timeout&&clearTimeout(o.timeout),o.timeout=setTimeout(o.remove,i.lifespan)),o.response;if(!t)throw o.promise}const a={keys:e,equal:i.equal,remove:()=>{const o=jC.indexOf(a);o!==-1&&jC.splice(o,1)},promise:(o6(n)?n:n(...e)).then(o=>{a.response=o,i.lifespan&&i.lifespan>0&&(a.timeout=setTimeout(a.remove,i.lifespan))}).catch(o=>a.error=o)};if(jC.push(a),!t)throw a.promise}const TX=(n,e,t)=>XX(n,e,!1,t),r6=(n,e,t)=>void XX(n,e,!0,t),s6=n=>{if(n===void 0||n.length===0)jC.splice(0,jC.length);else{const e=jC.find(t=>FX(n,t.keys,t.equal));e&&e.remove()}};function Yx(n,e,t){if(!n)return;if(t(n)===!0)return n;let i=e?n.return:n.child;for(;i;){const a=Yx(i,e,t);if(a)return a;i=e?null:i.sibling}}function YX(n){try{return Object.defineProperties(n,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return n}}const zx=YX(v.createContext(null));let zX=class extends v.Component{render(){return v.createElement(zx.Provider,{value:this._reactInternals},this.props.children)}};function KX(){const n=v.useContext(zx);if(n===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=v.useId();return v.useMemo(()=>{for(const t of[n,n==null?void 0:n.alternate]){if(!t)continue;const i=Yx(t,!1,a=>{let o=a.memoizedState;for(;o;){if(o.memoizedState===e)return!0;o=o.next}});if(i)return i}},[n,e])}const l6=Symbol.for("react.context"),c6=n=>n!==null&&typeof n=="object"&&"$$typeof"in n&&n.$$typeof===l6;function g6(){const n=KX(),[e]=v.useState(()=>new Map);e.clear();let t=n;for(;t;){const i=t.type;c6(i)&&i!==zx&&!e.has(i)&&e.set(i,v.use(YX(i))),t=t.return}return e}function u6(){const n=g6();return v.useMemo(()=>Array.from(n.keys()).reduce((e,t)=>i=>v.createElement(e,null,v.createElement(t.Provider,{...i,value:n.get(t)})),e=>v.createElement(zX,{...e})),[n])}function LX(n){let e=n.root;for(;e.getState().previousRoot;)e=e.getState().previousRoot;return e}const _X=n=>n&&n.isOrthographicCamera,d6=n=>n&&n.hasOwnProperty("current"),C6=n=>n!=null&&(typeof n=="string"||typeof n=="number"||n.isColor),hb=((n,e)=>typeof window<"u"&&(((n=window.document)==null?void 0:n.createElement)||((e=window.navigator)==null?void 0:e.product)==="ReactNative"))()?v.useLayoutEffect:v.useEffect;function Kx(n){const e=v.useRef(n);return hb(()=>void(e.current=n),[n]),e}function I6(){const n=KX(),e=u6();return v.useMemo(()=>({children:t})=>{const a=!!Yx(n,!0,o=>o.type===v.StrictMode)?v.StrictMode:v.Fragment;return Le.jsx(a,{children:Le.jsx(e,{children:t})})},[n,e])}function h6({set:n}){return hb(()=>(n(new Promise(()=>null)),()=>n(!1)),[n]),null}const f6=(n=>(n=class extends v.Component{constructor(...t){super(...t),this.state={error:!1}}componentDidCatch(t){this.props.set(t)}render(){return this.state.error?null:this.props.children}},n.getDerivedStateFromError=()=>({error:!0}),n))();function DX(n){var e;const t=typeof window<"u"?(e=window.devicePixelRatio)!=null?e:2:1;return Array.isArray(n)?Math.min(Math.max(n[0],t),n[1]):n}function Kh(n){var e;return(e=n.__r3f)==null?void 0:e.root.getState()}const ha={obj:n=>n===Object(n)&&!ha.arr(n)&&typeof n!="function",fun:n=>typeof n=="function",str:n=>typeof n=="string",num:n=>typeof n=="number",boo:n=>typeof n=="boolean",und:n=>n===void 0,nul:n=>n===null,arr:n=>Array.isArray(n),equ(n,e,{arrays:t="shallow",objects:i="reference",strict:a=!0}={}){if(typeof n!=typeof e||!!n!=!!e)return!1;if(ha.str(n)||ha.num(n)||ha.boo(n))return n===e;const o=ha.obj(n);if(o&&i==="reference")return n===e;const r=ha.arr(n);if(r&&t==="reference")return n===e;if((r||o)&&n===e)return!0;let s;for(s in n)if(!(s in e))return!1;if(o&&t==="shallow"&&i==="shallow"){for(s in a?e:n)if(!ha.equ(n[s],e[s],{strict:a,objects:"reference"}))return!1}else for(s in a?e:n)if(n[s]!==e[s])return!1;if(ha.und(s)){if(r&&n.length===0&&e.length===0||o&&Object.keys(n).length===0&&Object.keys(e).length===0)return!0;if(n!==e)return!1}return!0}};function A6(n){const e={nodes:{},materials:{},meshes:{}};return n&&n.traverse(t=>{t.name&&(e.nodes[t.name]=t),t.material&&!e.materials[t.material.name]&&(e.materials[t.material.name]=t.material),t.isMesh&&!e.meshes[t.name]&&(e.meshes[t.name]=t)}),e}function m6(n){n.type!=="Scene"&&(n.dispose==null||n.dispose());for(const e in n){const t=n[e];(t==null?void 0:t.type)!=="Scene"&&(t==null||t.dispose==null||t.dispose())}}const OX=["children","key","ref"];function p6(n){const e={};for(const t in n)OX.includes(t)||(e[t]=n[t]);return e}function NB(n,e,t,i){const a=n;let o=a==null?void 0:a.__r3f;return o||(o={root:e,type:t,parent:null,children:[],props:p6(i),object:a,eventCount:0,handlers:{},isHidden:!1},a&&(a.__r3f=o)),o}function Ep(n,e){let t=n[e];if(!e.includes("-"))return{root:n,key:e,target:t};t=n;for(const a of e.split("-")){var i;e=a,n=t,t=(i=t)==null?void 0:i[e]}return{root:n,key:e,target:t}}const iE=/-\d+$/;function EB(n,e){if(ha.str(e.props.attach)){if(iE.test(e.props.attach)){const a=e.props.attach.replace(iE,""),{root:o,key:r}=Ep(n.object,a);Array.isArray(o[r])||(o[r]=[])}const{root:t,key:i}=Ep(n.object,e.props.attach);e.previousAttach=t[i],t[i]=e.object}else ha.fun(e.props.attach)&&(e.previousAttach=e.props.attach(n.object,e.object))}function HB(n,e){if(ha.str(e.props.attach)){const{root:t,key:i}=Ep(n.object,e.props.attach),a=e.previousAttach;a===void 0?delete t[i]:t[i]=a}else e.previousAttach==null||e.previousAttach(n.object,e.object);delete e.previousAttach}const iR=[...OX,"args","dispose","attach","object","onUpdate","dispose"],aE=new Map;function b6(n){let e=aE.get(n.constructor);try{e||(e=new n.constructor,aE.set(n.constructor,e))}catch{}return e}function v6(n,e){const t={};for(const i in e)if(!iR.includes(i)&&!ha.equ(e[i],n.props[i])){t[i]=e[i];for(const a in e)a.startsWith(`${i}-`)&&(t[a]=e[a])}for(const i in n.props){if(iR.includes(i)||e.hasOwnProperty(i))continue;const{root:a,key:o}=Ep(n.object,i);if(a.constructor&&a.constructor.length===0){const r=b6(a);ha.und(r)||(t[o]=r[o])}else t[o]=0}return t}const y6=["map","emissiveMap","sheenColorMap","specularColorMap","envMap"],B6=/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/;function og(n,e){var t;const i=n.__r3f,a=i&&LX(i).getState(),o=i==null?void 0:i.eventCount;for(const s in e){let l=e[s];if(iR.includes(s))continue;if(i&&B6.test(s)){typeof l=="function"?i.handlers[s]=l:delete i.handlers[s],i.eventCount=Object.keys(i.handlers).length;continue}if(l===void 0)continue;let{root:c,key:u,target:C}=Ep(n,s);if(C instanceof wf&&l instanceof wf)C.mask=l.mask;else if(C instanceof dn&&C6(l))C.set(l);else if(C!==null&&typeof C=="object"&&typeof C.set=="function"&&typeof C.copy=="function"&&l!=null&&l.constructor&&C.constructor===l.constructor)C.copy(l);else if(C!==null&&typeof C=="object"&&typeof C.set=="function"&&Array.isArray(l))typeof C.fromArray=="function"?C.fromArray(l):C.set(...l);else if(C!==null&&typeof C=="object"&&typeof C.set=="function"&&typeof l=="number")typeof C.setScalar=="function"?C.setScalar(l):C.set(l);else{var r;c[u]=l,a&&!a.linear&&y6.includes(u)&&(r=c[u])!=null&&r.isTexture&&c[u].format===La&&c[u].type===vs&&(c[u].colorSpace=Uo)}}if(i!=null&&i.parent&&a!=null&&a.internal&&(t=i.object)!=null&&t.isObject3D&&o!==i.eventCount){const s=i.object,l=a.internal.interaction.indexOf(s);l>-1&&a.internal.interaction.splice(l,1),i.eventCount&&s.raycast!==null&&a.internal.interaction.push(s)}return i&&i.props.attach===void 0&&(i.object.isBufferGeometry?i.props.attach="geometry":i.object.isMaterial&&(i.props.attach="material")),i&&Jf(i),n}function Jf(n){var e;if(!n.parent)return;n.props.onUpdate==null||n.props.onUpdate(n.object);const t=(e=n.root)==null||e.getState==null?void 0:e.getState();t&&t.internal.frames===0&&t.invalidate()}function UX(n,e){n.manual||(_X(n)?(n.left=e.width/-2,n.right=e.width/2,n.top=e.height/2,n.bottom=e.height/-2):n.aspect=e.width/e.height,n.updateProjectionMatrix())}const Kr=n=>n==null?void 0:n.isObject3D;function _v(n){return(n.eventObject||n.object).uuid+"/"+n.index+n.instanceId}function kX(n,e,t,i){const a=t.get(e);a&&(t.delete(e),t.size===0&&(n.delete(i),a.target.releasePointerCapture(i)))}function G6(n,e){const{internal:t}=n.getState();t.interaction=t.interaction.filter(i=>i!==e),t.initialHits=t.initialHits.filter(i=>i!==e),t.hovered.forEach((i,a)=>{(i.eventObject===e||i.object===e)&&t.hovered.delete(a)}),t.capturedMap.forEach((i,a)=>{kX(t.capturedMap,e,i,a)})}function S6(n){function e(l){const{internal:c}=n.getState(),u=l.offsetX-c.initialClick[0],C=l.offsetY-c.initialClick[1];return Math.round(Math.sqrt(u*u+C*C))}function t(l){return l.filter(c=>["Move","Over","Enter","Out","Leave"].some(u=>{var C;return(C=c.__r3f)==null?void 0:C.handlers["onPointer"+u]}))}function i(l,c){const u=n.getState(),C=new Set,h=[],m=c?c(u.internal.interaction):u.internal.interaction;for(let y=0;y<m.length;y++){const S=Kh(m[y]);S&&(S.raycaster.camera=void 0)}u.previousRoot||u.events.compute==null||u.events.compute(l,u);function p(y){const S=Kh(y);if(!S||!S.events.enabled||S.raycaster.camera===null)return[];if(S.raycaster.camera===void 0){var R;S.events.compute==null||S.events.compute(l,S,(R=S.previousRoot)==null?void 0:R.getState()),S.raycaster.camera===void 0&&(S.raycaster.camera=null)}return S.raycaster.camera?S.raycaster.intersectObject(y,!0):[]}let B=m.flatMap(p).sort((y,S)=>{const R=Kh(y.object),Z=Kh(S.object);return!R||!Z?y.distance-S.distance:Z.events.priority-R.events.priority||y.distance-S.distance}).filter(y=>{const S=_v(y);return C.has(S)?!1:(C.add(S),!0)});u.events.filter&&(B=u.events.filter(B,u));for(const y of B){let S=y.object;for(;S;){var b;(b=S.__r3f)!=null&&b.eventCount&&h.push({...y,eventObject:S}),S=S.parent}}if("pointerId"in l&&u.internal.capturedMap.has(l.pointerId))for(let y of u.internal.capturedMap.get(l.pointerId).values())C.has(_v(y.intersection))||h.push(y.intersection);return h}function a(l,c,u,C){if(l.length){const h={stopped:!1};for(const m of l){let p=Kh(m.object);if(p||m.object.traverseAncestors(B=>{const b=Kh(B);if(b)return p=b,!1}),p){const{raycaster:B,pointer:b,camera:y,internal:S}=p,R=new Be(b.x,b.y,0).unproject(y),Z=N=>{var H,z;return(H=(z=S.capturedMap.get(N))==null?void 0:z.has(m.eventObject))!=null?H:!1},x=N=>{const H={intersection:m,target:c.target};S.capturedMap.has(N)?S.capturedMap.get(N).set(m.eventObject,H):S.capturedMap.set(N,new Map([[m.eventObject,H]])),c.target.setPointerCapture(N)},M=N=>{const H=S.capturedMap.get(N);H&&kX(S.capturedMap,m.eventObject,H,N)};let E={};for(let N in c){let H=c[N];typeof H!="function"&&(E[N]=H)}let F={...m,...E,pointer:b,intersections:l,stopped:h.stopped,delta:u,unprojectedPoint:R,ray:B.ray,camera:y,stopPropagation(){const N="pointerId"in c&&S.capturedMap.get(c.pointerId);if((!N||N.has(m.eventObject))&&(F.stopped=h.stopped=!0,S.hovered.size&&Array.from(S.hovered.values()).find(H=>H.eventObject===m.eventObject))){const H=l.slice(0,l.indexOf(m));o([...H,m])}},target:{hasPointerCapture:Z,setPointerCapture:x,releasePointerCapture:M},currentTarget:{hasPointerCapture:Z,setPointerCapture:x,releasePointerCapture:M},nativeEvent:c};if(C(F),h.stopped===!0)break}}}return l}function o(l){const{internal:c}=n.getState();for(const u of c.hovered.values())if(!l.length||!l.find(C=>C.object===u.object&&C.index===u.index&&C.instanceId===u.instanceId)){const h=u.eventObject.__r3f;if(c.hovered.delete(_v(u)),h!=null&&h.eventCount){const m=h.handlers,p={...u,intersections:l};m.onPointerOut==null||m.onPointerOut(p),m.onPointerLeave==null||m.onPointerLeave(p)}}}function r(l,c){for(let u=0;u<c.length;u++){const C=c[u].__r3f;C==null||C.handlers.onPointerMissed==null||C.handlers.onPointerMissed(l)}}function s(l){switch(l){case"onPointerLeave":case"onPointerCancel":return()=>o([]);case"onLostPointerCapture":return c=>{const{internal:u}=n.getState();"pointerId"in c&&u.capturedMap.has(c.pointerId)&&requestAnimationFrame(()=>{u.capturedMap.has(c.pointerId)&&(u.capturedMap.delete(c.pointerId),o([]))})}}return function(u){const{onPointerMissed:C,internal:h}=n.getState();h.lastEvent.current=u;const m=l==="onPointerMove",p=l==="onClick"||l==="onContextMenu"||l==="onDoubleClick",b=i(u,m?t:void 0),y=p?e(u):0;l==="onPointerDown"&&(h.initialClick=[u.offsetX,u.offsetY],h.initialHits=b.map(R=>R.eventObject)),p&&!b.length&&y<=2&&(r(u,h.interaction),C&&C(u)),m&&o(b);function S(R){const Z=R.eventObject,x=Z.__r3f;if(!(x!=null&&x.eventCount))return;const M=x.handlers;if(m){if(M.onPointerOver||M.onPointerEnter||M.onPointerOut||M.onPointerLeave){const E=_v(R),F=h.hovered.get(E);F?F.stopped&&R.stopPropagation():(h.hovered.set(E,R),M.onPointerOver==null||M.onPointerOver(R),M.onPointerEnter==null||M.onPointerEnter(R))}M.onPointerMove==null||M.onPointerMove(R)}else{const E=M[l];E?(!p||h.initialHits.includes(Z))&&(r(u,h.interaction.filter(F=>!h.initialHits.includes(F))),E(R)):p&&h.initialHits.includes(Z)&&r(u,h.interaction.filter(F=>!h.initialHits.includes(F)))}}a(b,u,y,S)}}return{handlePointer:s}}const oE=n=>!!(n!=null&&n.render),Lx=v.createContext(null),w6=(n,e)=>{const t=HX((s,l)=>{const c=new Be,u=new Be,C=new Be;function h(y=l().camera,S=u,R=l().size){const{width:Z,height:x,top:M,left:E}=R,F=Z/x;S.isVector3?C.copy(S):C.set(...S);const N=y.getWorldPosition(c).distanceTo(C);if(_X(y))return{width:Z/y.zoom,height:x/y.zoom,top:M,left:E,factor:1,distance:N,aspect:F};{const H=y.fov*Math.PI/180,z=2*Math.tan(H/2)*N,_=z*(Z/x);return{width:_,height:z,top:M,left:E,factor:Z/_,distance:N,aspect:F}}}let m;const p=y=>s(S=>({performance:{...S.performance,current:y}})),B=new Xt;return{set:s,get:l,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},scene:null,xr:null,invalidate:(y=1)=>n(l(),y),advance:(y,S)=>e(y,S,l()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new Wx,pointer:B,mouse:B,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const y=l();m&&clearTimeout(m),y.performance.current!==y.performance.min&&p(y.performance.min),m=setTimeout(()=>p(l().performance.max),y.performance.debounce)}},size:{width:0,height:0,top:0,left:0},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:h},setEvents:y=>s(S=>({...S,events:{...S.events,...y}})),setSize:(y,S,R=0,Z=0)=>{const x=l().camera,M={width:y,height:S,top:R,left:Z};s(E=>({size:M,viewport:{...E.viewport,...h(x,u,M)}}))},setDpr:y=>s(S=>{const R=DX(y);return{viewport:{...S.viewport,dpr:R,initialDpr:S.viewport.initialDpr||R}}}),setFrameloop:(y="always")=>{const S=l().clock;S.stop(),S.elapsedTime=0,y!=="never"&&(S.start(),S.elapsedTime=0),s(()=>({frameloop:y}))},previousRoot:void 0,internal:{interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,lastEvent:v.createRef(),active:!1,frames:0,priority:0,subscribe:(y,S,R)=>{const Z=l().internal;return Z.priority=Z.priority+(S>0?1:0),Z.subscribers.push({ref:y,priority:S,store:R}),Z.subscribers=Z.subscribers.sort((x,M)=>x.priority-M.priority),()=>{const x=l().internal;x!=null&&x.subscribers&&(x.priority=x.priority-(S>0?1:0),x.subscribers=x.subscribers.filter(M=>M.ref!==y))}}}}}),i=t.getState();let a=i.size,o=i.viewport.dpr,r=i.camera;return t.subscribe(()=>{const{camera:s,size:l,viewport:c,gl:u,set:C}=t.getState();if(l.width!==a.width||l.height!==a.height||c.dpr!==o){a=l,o=c.dpr,UX(s,l),c.dpr>0&&u.setPixelRatio(c.dpr);const h=typeof HTMLCanvasElement<"u"&&u.domElement instanceof HTMLCanvasElement;u.setSize(l.width,l.height,h)}s!==r&&(r=s,C(h=>({viewport:{...h.viewport,...h.viewport.getCurrentViewport(s)}})))}),t.subscribe(s=>n(s)),t};function _x(){const n=v.useContext(Lx);if(!n)throw new Error("R3F: Hooks can only be used within the Canvas component!");return n}function Ra(n=t=>t,e){return _x()(n,e)}function bg(n,e=0){const t=_x(),i=t.getState().internal.subscribe,a=Kx(n);return hb(()=>i(a,e,t),[e,i,t]),null}const rE=new WeakMap,R6=n=>{var e;return typeof n=="function"&&(n==null||(e=n.prototype)==null?void 0:e.constructor)===n};function PX(n,e){return function(t,...i){let a;return R6(t)?(a=rE.get(t),a||(a=new t,rE.set(t,a))):a=t,n&&n(a),Promise.all(i.map(o=>new Promise((r,s)=>a.load(o,l=>{Kr(l==null?void 0:l.scene)&&Object.assign(l,A6(l.scene)),r(l)},e,l=>s(new Error(`Could not load ${o}: ${l==null?void 0:l.message}`))))))}}function du(n,e,t,i){const a=Array.isArray(e)?e:[e],o=TX(PX(t,i),[n,...a],{equal:ha.equ});return Array.isArray(e)?o:o[0]}du.preload=function(n,e,t){const i=Array.isArray(e)?e:[e];return r6(PX(t),[n,...i])};du.clear=function(n,e){const t=Array.isArray(e)?e:[e];return s6([n,...t])};function Z6(n){const e=n6(n);return e.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:v.version}),e}const JX=0,Mf={},x6=/^three(?=[A-Z])/,kG=n=>`${n[0].toUpperCase()}${n.slice(1)}`;let M6=0;const W6=n=>typeof n=="function";function jX(n){if(W6(n)){const e=`${M6++}`;return Mf[e]=n,e}else Object.assign(Mf,n)}function QX(n,e){const t=kG(n),i=Mf[t];if(n!=="primitive"&&!i)throw new Error(`R3F: ${t} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(n==="primitive"&&!e.object)throw new Error("R3F: Primitives without 'object' are invalid!");if(e.args!==void 0&&!Array.isArray(e.args))throw new Error("R3F: The args prop must be an array!")}function V6(n,e,t){var i;return n=kG(n)in Mf?n:n.replace(x6,""),QX(n,e),n==="primitive"&&(i=e.object)!=null&&i.__r3f&&delete e.object.__r3f,NB(e.object,t,n,e)}function N6(n){if(!n.isHidden){var e;n.props.attach&&(e=n.parent)!=null&&e.object?HB(n.parent,n):Kr(n.object)&&(n.object.visible=!1),n.isHidden=!0,Jf(n)}}function qX(n){if(n.isHidden){var e;n.props.attach&&(e=n.parent)!=null&&e.object?EB(n.parent,n):Kr(n.object)&&n.props.visible!==!1&&(n.object.visible=!0),n.isHidden=!1,Jf(n)}}function Dx(n,e,t){const i=e.root.getState();if(!(!n.parent&&n.object!==i.scene)){if(!e.object){var a,o;const r=Mf[kG(e.type)];e.object=(a=e.props.object)!=null?a:new r(...(o=e.props.args)!=null?o:[]),e.object.__r3f=e}if(og(e.object,e.props),e.props.attach)EB(n,e);else if(Kr(e.object)&&Kr(n.object)){const r=n.object.children.indexOf(t==null?void 0:t.object);if(t&&r!==-1){const s=n.object.children.indexOf(e.object);if(s!==-1){n.object.children.splice(s,1);const l=s<r?r-1:r;n.object.children.splice(l,0,e.object)}else e.object.parent=n.object,n.object.children.splice(r,0,e.object),e.object.dispatchEvent({type:"added"}),n.object.dispatchEvent({type:"childadded",child:e.object})}else n.object.add(e.object)}for(const r of e.children)Dx(e,r);Jf(e)}}function fw(n,e){e&&(e.parent=n,n.children.push(e),Dx(n,e))}function sE(n,e,t){if(!e||!t)return;e.parent=n;const i=n.children.indexOf(t);i!==-1?n.children.splice(i,0,e):n.children.push(e),Dx(n,e,t)}function $X(n){if(typeof n.dispose=="function"){const e=()=>{try{n.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT<"u"?e():nE.unstable_scheduleCallback(nE.unstable_IdlePriority,e)}}function aR(n,e,t){if(!e)return;e.parent=null;const i=n.children.indexOf(e);i!==-1&&n.children.splice(i,1),e.props.attach?HB(n,e):Kr(e.object)&&Kr(n.object)&&(n.object.remove(e.object),G6(LX(e),e.object));const a=e.props.dispose!==null&&t!==!1;for(let o=e.children.length-1;o>=0;o--){const r=e.children[o];aR(e,r,a)}e.children.length=0,delete e.object.__r3f,a&&e.type!=="primitive"&&e.object.type!=="Scene"&&$X(e.object),t===void 0&&Jf(e)}function E6(n,e){for(const t of[n,n.alternate])if(t!==null)if(typeof t.ref=="function"){t.refCleanup==null||t.refCleanup();const i=t.ref(e);typeof i=="function"&&(t.refCleanup=i)}else t.ref&&(t.ref.current=e)}const wy=[];function H6(){for(const[t]of wy){const i=t.parent;if(i){t.props.attach?HB(i,t):Kr(t.object)&&Kr(i.object)&&i.object.remove(t.object);for(const a of t.children)a.props.attach?HB(t,a):Kr(a.object)&&Kr(t.object)&&t.object.remove(a.object)}t.isHidden&&qX(t),t.object.__r3f&&delete t.object.__r3f,t.type!=="primitive"&&$X(t.object)}for(const[t,i,a]of wy){t.props=i;const o=t.parent;if(o){var n,e;const r=Mf[kG(t.type)];t.object=(n=t.props.object)!=null?n:new r(...(e=t.props.args)!=null?e:[]),t.object.__r3f=t,E6(a,t.object),og(t.object,t.props),t.props.attach?EB(o,t):Kr(t.object)&&Kr(o.object)&&o.object.add(t.object);for(const s of t.children)s.props.attach?EB(t,s):Kr(s.object)&&Kr(t.object)&&t.object.add(s.object);Jf(t)}}wy.length=0}const Aw=()=>{},lE={};let Dv=JX;const F6=0,X6=4,FB=Z6({isPrimaryRenderer:!1,warnsIfNotActing:!1,supportsMutation:!0,supportsPersistence:!1,supportsHydration:!1,createInstance:V6,removeChild:aR,appendChild:fw,appendInitialChild:fw,insertBefore:sE,appendChildToContainer(n,e){const t=n.getState().scene.__r3f;!e||!t||fw(t,e)},removeChildFromContainer(n,e){const t=n.getState().scene.__r3f;!e||!t||aR(t,e)},insertInContainerBefore(n,e,t){const i=n.getState().scene.__r3f;!e||!t||!i||sE(i,e,t)},getRootHostContext:()=>lE,getChildHostContext:()=>lE,commitUpdate(n,e,t,i,a){var o,r,s;QX(e,i);let l=!1;if((n.type==="primitive"&&t.object!==i.object||((o=i.args)==null?void 0:o.length)!==((r=t.args)==null?void 0:r.length)||(s=i.args)!=null&&s.some((u,C)=>{var h;return u!==((h=t.args)==null?void 0:h[C])}))&&(l=!0),l)wy.push([n,{...i},a]);else{const u=v6(n,i);Object.keys(u).length&&(Object.assign(n.props,u),og(n.object,u))}(a.sibling===null||(a.flags&X6)===F6)&&H6()},finalizeInitialChildren:()=>!1,commitMount(){},getPublicInstance:n=>n==null?void 0:n.object,prepareForCommit:()=>null,preparePortalMount:n=>NB(n.getState().scene,n,"",{}),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance:N6,unhideInstance:qX,createTextInstance:Aw,hideTextInstance:Aw,unhideTextInstance:Aw,scheduleTimeout:typeof setTimeout=="function"?setTimeout:void 0,cancelTimeout:typeof clearTimeout=="function"?clearTimeout:void 0,noTimeout:-1,getInstanceFromNode:()=>null,beforeActiveInstanceBlur(){},afterActiveInstanceBlur(){},detachDeletedInstance(){},prepareScopeUpdate(){},getInstanceFromScope:()=>null,shouldAttemptEagerTransition:()=>!1,trackSchedulerEvent:()=>{},resolveEventType:()=>null,resolveEventTimeStamp:()=>-1.1,requestPostPaintCallback(){},maySuspendCommit:()=>!1,preloadInstance:()=>!0,startSuspendingCommit(){},suspendInstance(){},waitForCommitToBeReady:()=>null,NotPendingTransition:null,HostTransitionContext:v.createContext(null),setCurrentUpdatePriority(n){Dv=n},getCurrentUpdatePriority(){return Dv},resolveUpdatePriority(){var n;if(Dv!==JX)return Dv;switch(typeof window<"u"&&((n=window.event)==null?void 0:n.type)){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return Sy.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return Sy.ContinuousEventPriority;default:return Sy.DefaultEventPriority}},resetFormInstance(){}}),dI=new Map,Lh={objects:"shallow",strict:!1};function T6(n,e){if(!e&&typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement&&n.parentElement){const{width:t,height:i,top:a,left:o}=n.parentElement.getBoundingClientRect();return{width:t,height:i,top:a,left:o}}else if(!e&&typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas)return{width:n.width,height:n.height,top:0,left:0};return{width:0,height:0,top:0,left:0,...e}}function Y6(n){const e=dI.get(n),t=e==null?void 0:e.fiber,i=e==null?void 0:e.store;e&&console.warn("R3F.createRoot should only be called once!");const a=typeof reportError=="function"?reportError:console.error,o=i||w6(sR,gE),r=t||FB.createContainer(o,Sy.ConcurrentRoot,null,!1,null,"",a,a,a,null);e||dI.set(n,{fiber:r,store:o});let s,l,c=!1,u=null;return{async configure(C={}){let h;u=new Promise(O=>h=O);let{gl:m,size:p,scene:B,events:b,onCreated:y,shadows:S=!1,linear:R=!1,flat:Z=!1,legacy:x=!1,orthographic:M=!1,frameloop:E="always",dpr:F=[1,2],performance:N,raycaster:H,camera:z,onPointerMissed:_}=C,D=o.getState(),P=D.gl;if(!D.gl){const O={canvas:n,powerPreference:"high-performance",antialias:!0,alpha:!0},j=typeof m=="function"?await m(O):m;oE(j)?P=j:P=new Tx({...O,...m}),D.set({gl:P})}let $=D.raycaster;$||D.set({raycaster:$=new Hx});const{params:X,...L}=H||{};if(ha.equ(L,$,Lh)||og($,{...L}),ha.equ(X,$.params,Lh)||og($,{params:{...$.params,...X}}),!D.camera||D.camera===l&&!ha.equ(l,z,Lh)){l=z;const O=z==null?void 0:z.isCamera,j=O?z:M?new bl(0,0,0,0,.1,1e3):new fa(75,0,.1,1e3);O||(j.position.z=5,z&&(og(j,z),j.manual||("aspect"in z||"left"in z||"right"in z||"bottom"in z||"top"in z)&&(j.manual=!0,j.updateProjectionMatrix())),!D.camera&&!(z!=null&&z.rotation)&&j.lookAt(0,0,0)),D.set({camera:j}),$.camera=j}if(!D.scene){let O;B!=null&&B.isScene?(O=B,NB(O,o,"",{})):(O=new sb,NB(O,o,"",{}),B&&og(O,B)),D.set({scene:O})}b&&!D.events.handlers&&D.set({events:b(o)});const U=T6(n,p);if(ha.equ(U,D.size,Lh)||D.setSize(U.width,U.height,U.top,U.left),F&&D.viewport.dpr!==DX(F)&&D.setDpr(F),D.frameloop!==E&&D.setFrameloop(E),D.onPointerMissed||D.set({onPointerMissed:_}),N&&!ha.equ(N,D.performance,Lh)&&D.set(O=>({performance:{...O.performance,...N}})),!D.xr){var q;const O=(k,ie)=>{const re=o.getState();re.frameloop!=="never"&&gE(k,!0,re,ie)},j=()=>{const k=o.getState();k.gl.xr.enabled=k.gl.xr.isPresenting,k.gl.xr.setAnimationLoop(k.gl.xr.isPresenting?O:null),k.gl.xr.isPresenting||sR(k)},ne={connect(){const k=o.getState().gl;k.xr.addEventListener("sessionstart",j),k.xr.addEventListener("sessionend",j)},disconnect(){const k=o.getState().gl;k.xr.removeEventListener("sessionstart",j),k.xr.removeEventListener("sessionend",j)}};typeof((q=P.xr)==null?void 0:q.addEventListener)=="function"&&ne.connect(),D.set({xr:ne})}if(P.shadowMap){const O=P.shadowMap.enabled,j=P.shadowMap.type;if(P.shadowMap.enabled=!!S,ha.boo(S))P.shadowMap.type=np;else if(ha.str(S)){var K;const ne={basic:L5,percentage:uG,soft:np,variance:oc};P.shadowMap.type=(K=ne[S])!=null?K:np}else ha.obj(S)&&Object.assign(P.shadowMap,S);(O!==P.shadowMap.enabled||j!==P.shadowMap.type)&&(P.shadowMap.needsUpdate=!0)}return vi.enabled=!x,c||(P.outputColorSpace=R?Cc:Uo,P.toneMapping=Z?lg:PZ),D.legacy!==x&&D.set(()=>({legacy:x})),D.linear!==R&&D.set(()=>({linear:R})),D.flat!==Z&&D.set(()=>({flat:Z})),m&&!ha.fun(m)&&!oE(m)&&!ha.equ(m,P,Lh)&&og(P,m),s=y,c=!0,h(),this},render(C){return!c&&!u&&this.configure(),u.then(()=>{FB.updateContainer(Le.jsx(z6,{store:o,children:C,onCreated:s,rootElement:n}),r,null,()=>{})}),o},unmount(){eT(n)}}}function z6({store:n,children:e,onCreated:t,rootElement:i}){return hb(()=>{const a=n.getState();a.set(o=>({internal:{...o.internal,active:!0}})),t&&t(a),n.getState().events.connected||a.events.connect==null||a.events.connect(i)},[]),Le.jsx(Lx.Provider,{value:n,children:e})}function eT(n,e){const t=dI.get(n),i=t==null?void 0:t.fiber;if(i){const a=t==null?void 0:t.store.getState();a&&(a.internal.active=!1),FB.updateContainer(null,i,null,()=>{a&&setTimeout(()=>{try{var o,r,s,l;a.events.disconnect==null||a.events.disconnect(),(o=a.gl)==null||(r=o.renderLists)==null||r.dispose==null||r.dispose(),(s=a.gl)==null||s.forceContextLoss==null||s.forceContextLoss(),(l=a.gl)!=null&&l.xr&&a.xr.disconnect(),m6(a.scene),dI.delete(n)}catch{}},500)})}}function K6(n,e,t){return Le.jsx(L6,{children:n,container:e,state:t})}function L6({state:n={},children:e,container:t}){const{events:i,size:a,...o}=n,r=_x(),[s]=v.useState(()=>new Hx),[l]=v.useState(()=>new Xt),c=Kx((C,h)=>{let m;if(h.camera&&a){const p=h.camera;m=C.viewport.getCurrentViewport(p,new Be,a),p!==C.camera&&UX(p,a)}return{...C,...h,scene:t,raycaster:s,pointer:l,mouse:l,previousRoot:r,events:{...C.events,...h.events,...i},size:{...C.size,...a},viewport:{...C.viewport,...m},setEvents:p=>h.set(B=>({...B,events:{...B.events,...p}}))}}),u=v.useMemo(()=>{const C=HX((m,p)=>({...o,set:m,get:p})),h=m=>C.setState(p=>c.current(m,p));return h(r.getState()),r.subscribe(h),C},[r,t]);return Le.jsx(Le.Fragment,{children:FB.createPortal(Le.jsx(Lx.Provider,{value:u,children:e}),u,null)})}function tT(n,e){const t={callback:n};return e.add(t),()=>void e.delete(t)}const nT=new Set,iT=new Set,_6=new Set,D6=n=>tT(n,nT),O6=n=>tT(n,iT);function mw(n,e){if(n.size)for(const{callback:t}of n.values())t(e)}function up(n,e){switch(n){case"before":return mw(nT,e);case"after":return mw(iT,e);case"tail":return mw(_6,e)}}let pw,bw;function oR(n,e,t){let i=e.clock.getDelta();e.frameloop==="never"&&typeof n=="number"&&(i=n-e.clock.elapsedTime,e.clock.oldTime=e.clock.elapsedTime,e.clock.elapsedTime=n),pw=e.internal.subscribers;for(let a=0;a<pw.length;a++)bw=pw[a],bw.ref.current(bw.store.getState(),i,t);return!e.internal.priority&&e.gl.render&&e.gl.render(e.scene,e.camera),e.internal.frames=Math.max(0,e.internal.frames-1),e.frameloop==="always"?1:e.internal.frames}let XB=!1,rR=!1,vw,cE,_h;function aT(n){cE=requestAnimationFrame(aT),XB=!0,vw=0,up("before",n),rR=!0;for(const t of dI.values()){var e;_h=t.store.getState(),_h.internal.active&&(_h.frameloop==="always"||_h.internal.frames>0)&&!((e=_h.gl.xr)!=null&&e.isPresenting)&&(vw+=oR(n,_h))}if(rR=!1,up("after",n),vw===0)return up("tail",n),XB=!1,cancelAnimationFrame(cE)}function sR(n,e=1){var t;if(!n)return dI.forEach(i=>sR(i.store.getState(),e));(t=n.gl.xr)!=null&&t.isPresenting||!n.internal.active||n.frameloop==="never"||(e>1?n.internal.frames=Math.min(60,n.internal.frames+e):rR?n.internal.frames=2:n.internal.frames=1,XB||(XB=!0,requestAnimationFrame(aT)))}function gE(n,e=!0,t,i){if(e&&up("before",n),t)oR(n,t,i);else for(const a of dI.values())oR(n,a.store.getState());e&&up("after",n)}const yw={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function U6(n){const{handlePointer:e}=S6(n);return{priority:1,enabled:!0,compute(t,i,a){i.pointer.set(t.offsetX/i.size.width*2-1,-(t.offsetY/i.size.height)*2+1),i.raycaster.setFromCamera(i.pointer,i.camera)},connected:void 0,handlers:Object.keys(yw).reduce((t,i)=>({...t,[i]:e(i)}),{}),update:()=>{var t;const{events:i,internal:a}=n.getState();(t=a.lastEvent)!=null&&t.current&&i.handlers&&i.handlers.onPointerMove(a.lastEvent.current)},connect:t=>{const{set:i,events:a}=n.getState();if(a.disconnect==null||a.disconnect(),i(o=>({events:{...o.events,connected:t}})),a.handlers)for(const o in a.handlers){const r=a.handlers[o],[s,l]=yw[o];t.addEventListener(s,r,{passive:l})}},disconnect:()=>{const{set:t,events:i}=n.getState();if(i.connected){if(i.handlers)for(const a in i.handlers){const o=i.handlers[a],[r]=yw[a];i.connected.removeEventListener(r,o)}t(a=>({events:{...a.events,connected:void 0}}))}}}}function uE(n,e){let t;return(...i)=>{window.clearTimeout(t),t=window.setTimeout(()=>n(...i),e)}}function k6({debounce:n,scroll:e,polyfill:t,offsetSize:i}={debounce:0,scroll:!1,offsetSize:!1}){const a=t||(typeof window>"u"?class{}:window.ResizeObserver);if(!a)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[o,r]=v.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),s=v.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:o,orientationHandler:null}),l=n?typeof n=="number"?n:n.scroll:null,c=n?typeof n=="number"?n:n.resize:null,u=v.useRef(!1);v.useEffect(()=>(u.current=!0,()=>void(u.current=!1)));const[C,h,m]=v.useMemo(()=>{const y=()=>{if(!s.current.element)return;const{left:S,top:R,width:Z,height:x,bottom:M,right:E,x:F,y:N}=s.current.element.getBoundingClientRect(),H={left:S,top:R,width:Z,height:x,bottom:M,right:E,x:F,y:N};s.current.element instanceof HTMLElement&&i&&(H.height=s.current.element.offsetHeight,H.width=s.current.element.offsetWidth),Object.freeze(H),u.current&&!Q6(s.current.lastBounds,H)&&r(s.current.lastBounds=H)};return[y,c?uE(y,c):y,l?uE(y,l):y]},[r,i,l,c]);function p(){s.current.scrollContainers&&(s.current.scrollContainers.forEach(y=>y.removeEventListener("scroll",m,!0)),s.current.scrollContainers=null),s.current.resizeObserver&&(s.current.resizeObserver.disconnect(),s.current.resizeObserver=null),s.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",s.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",s.current.orientationHandler))}function B(){s.current.element&&(s.current.resizeObserver=new a(m),s.current.resizeObserver.observe(s.current.element),e&&s.current.scrollContainers&&s.current.scrollContainers.forEach(y=>y.addEventListener("scroll",m,{capture:!0,passive:!0})),s.current.orientationHandler=()=>{m()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",s.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",s.current.orientationHandler))}const b=y=>{!y||y===s.current.element||(p(),s.current.element=y,s.current.scrollContainers=oT(y),B())};return J6(m,!!e),P6(h),v.useEffect(()=>{p(),B()},[e,m,h]),v.useEffect(()=>p,[]),[b,o,C]}function P6(n){v.useEffect(()=>{const e=n;return window.addEventListener("resize",e),()=>void window.removeEventListener("resize",e)},[n])}function J6(n,e){v.useEffect(()=>{if(e){const t=n;return window.addEventListener("scroll",t,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",t,!0)}},[n,e])}function oT(n){const e=[];if(!n||n===document.body)return e;const{overflow:t,overflowX:i,overflowY:a}=window.getComputedStyle(n);return[t,i,a].some(o=>o==="auto"||o==="scroll")&&e.push(n),[...e,...oT(n.parentElement)]}const j6=["x","y","top","bottom","left","right","width","height"],Q6=(n,e)=>j6.every(t=>n[t]===e[t]);function q6({ref:n,children:e,fallback:t,resize:i,style:a,gl:o,events:r=U6,eventSource:s,eventPrefix:l,shadows:c,linear:u,flat:C,legacy:h,orthographic:m,frameloop:p,dpr:B,performance:b,raycaster:y,camera:S,scene:R,onPointerMissed:Z,onCreated:x,...M}){v.useMemo(()=>jX(T8),[]);const E=I6(),[F,N]=k6({scroll:!0,debounce:{scroll:50,resize:0},...i}),H=v.useRef(null),z=v.useRef(null);v.useImperativeHandle(n,()=>H.current);const _=Kx(Z),[D,P]=v.useState(!1),[$,X]=v.useState(!1);if(D)throw D;if($)throw $;const L=v.useRef(null);hb(()=>{const q=H.current;if(N.width>0&&N.height>0&&q){L.current||(L.current=Y6(q));async function K(){await L.current.configure({gl:o,scene:R,events:r,shadows:c,linear:u,flat:C,legacy:h,orthographic:m,frameloop:p,dpr:B,performance:b,raycaster:y,camera:S,size:N,onPointerMissed:(...O)=>_.current==null?void 0:_.current(...O),onCreated:O=>{O.events.connect==null||O.events.connect(s?d6(s)?s.current:s:z.current),l&&O.setEvents({compute:(j,ne)=>{const k=j[l+"X"],ie=j[l+"Y"];ne.pointer.set(k/ne.size.width*2-1,-(ie/ne.size.height)*2+1),ne.raycaster.setFromCamera(ne.pointer,ne.camera)}}),x==null||x(O)}}),L.current.render(Le.jsx(E,{children:Le.jsx(f6,{set:X,children:Le.jsx(v.Suspense,{fallback:Le.jsx(h6,{set:P}),children:e??null})})}))}K()}}),v.useEffect(()=>{const q=H.current;if(q)return()=>eT(q)},[]);const U=s?"none":"auto";return Le.jsx("div",{ref:z,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:U,...a},...M,children:Le.jsx("div",{ref:F,style:{width:"100%",height:"100%"},children:Le.jsx("canvas",{ref:H,style:{display:"block"},children:t})})})}function Ox(n){return Le.jsx(zX,{children:Le.jsx(q6,{...n})})}function $t(){return $t=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)({}).hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},$t.apply(null,arguments)}const fb=new Be,Ux=new Be,$6=new Be,dE=new Xt;function eq(n,e,t){const i=fb.setFromMatrixPosition(n.matrixWorld);i.project(e);const a=t.width/2,o=t.height/2;return[i.x*a+a,-(i.y*o)+o]}function tq(n,e){const t=fb.setFromMatrixPosition(n.matrixWorld),i=Ux.setFromMatrixPosition(e.matrixWorld),a=t.sub(i),o=e.getWorldDirection($6);return a.angleTo(o)>Math.PI/2}function nq(n,e,t,i){const a=fb.setFromMatrixPosition(n.matrixWorld),o=a.clone();o.project(e),dE.set(o.x,o.y),t.setFromCamera(dE,e);const r=t.intersectObjects(i,!0);if(r.length){const s=r[0].distance;return a.distanceTo(t.ray.origin)<s}return!0}function iq(n,e){if(e instanceof bl)return e.zoom;if(e instanceof fa){const t=fb.setFromMatrixPosition(n.matrixWorld),i=Ux.setFromMatrixPosition(e.matrixWorld),a=e.fov*Math.PI/180,o=t.distanceTo(i);return 1/(2*Math.tan(a/2)*o)}else return 1}function aq(n,e,t){if(e instanceof fa||e instanceof bl){const i=fb.setFromMatrixPosition(n.matrixWorld),a=Ux.setFromMatrixPosition(e.matrixWorld),o=i.distanceTo(a),r=(t[1]-t[0])/(e.far-e.near),s=t[1]-r*e.far;return Math.round(r*o+s)}}const lR=n=>Math.abs(n)<1e-10?0:n;function rT(n,e,t=""){let i="matrix3d(";for(let a=0;a!==16;a++)i+=lR(e[a]*n.elements[a])+(a!==15?",":")");return t+i}const oq=(n=>e=>rT(e,n))([1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1]),rq=(n=>(e,t)=>rT(e,n(t),"translate(-50%,-50%)"))(n=>[1/n,1/n,1/n,1,-1/n,-1/n,-1/n,-1,1/n,1/n,1/n,1,1,1,1,1]);function sq(n){return n&&typeof n=="object"&&"current"in n}const lq=v.forwardRef(({children:n,eps:e=.001,style:t,className:i,prepend:a,center:o,fullscreen:r,portal:s,distanceFactor:l,sprite:c=!1,transform:u=!1,occlude:C,onOcclude:h,castShadow:m,receiveShadow:p,material:B,geometry:b,zIndexRange:y=[16777271,0],calculatePosition:S=eq,as:R="div",wrapperClass:Z,pointerEvents:x="auto",...M},E)=>{const{gl:F,camera:N,scene:H,size:z,raycaster:_,events:D,viewport:P}=Ra(),[$]=v.useState(()=>document.createElement(R)),X=v.useRef(null),L=v.useRef(null),U=v.useRef(0),q=v.useRef([0,0]),K=v.useRef(null),O=v.useRef(null),j=(s==null?void 0:s.current)||D.connected||F.domElement.parentNode,ne=v.useRef(null),k=v.useRef(!1),ie=v.useMemo(()=>C&&C!=="blending"||Array.isArray(C)&&C.length&&sq(C[0]),[C]);v.useLayoutEffect(()=>{const Ne=F.domElement;C&&C==="blending"?(Ne.style.zIndex=`${Math.floor(y[0]/2)}`,Ne.style.position="absolute",Ne.style.pointerEvents="none"):(Ne.style.zIndex=null,Ne.style.position=null,Ne.style.pointerEvents=null)},[C]),v.useLayoutEffect(()=>{if(L.current){const Ne=X.current=kF.createRoot($);if(H.updateMatrixWorld(),u)$.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{const ye=S(L.current,N,z);$.style.cssText=`position:absolute;top:0;left:0;transform:translate3d(${ye[0]}px,${ye[1]}px,0);transform-origin:0 0;`}return j&&(a?j.prepend($):j.appendChild($)),()=>{j&&j.removeChild($),Ne.unmount()}}},[j,u]),v.useLayoutEffect(()=>{Z&&($.className=Z)},[Z]);const re=v.useMemo(()=>u?{position:"absolute",top:0,left:0,width:z.width,height:z.height,transformStyle:"preserve-3d",pointerEvents:"none"}:{position:"absolute",transform:o?"translate3d(-50%,-50%,0)":"none",...r&&{top:-z.height/2,left:-z.width/2,width:z.width,height:z.height},...t},[t,o,r,z,u]),ge=v.useMemo(()=>({position:"absolute",pointerEvents:x}),[x]);v.useLayoutEffect(()=>{if(k.current=!1,u){var Ne;(Ne=X.current)==null||Ne.render(v.createElement("div",{ref:K,style:re},v.createElement("div",{ref:O,style:ge},v.createElement("div",{ref:E,className:i,style:t,children:n}))))}else{var ye;(ye=X.current)==null||ye.render(v.createElement("div",{ref:E,style:re,className:i,children:n}))}});const de=v.useRef(!0);bg(Ne=>{if(L.current){N.updateMatrixWorld(),L.current.updateWorldMatrix(!0,!1);const ye=u?q.current:S(L.current,N,z);if(u||Math.abs(U.current-N.zoom)>e||Math.abs(q.current[0]-ye[0])>e||Math.abs(q.current[1]-ye[1])>e){const pe=tq(L.current,N);let Te=!1;ie&&(Array.isArray(C)?Te=C.map(Ge=>Ge.current):C!=="blending"&&(Te=[H]));const le=de.current;if(Te){const Ge=nq(L.current,N,_,Te);de.current=Ge&&!pe}else de.current=!pe;le!==de.current&&(h?h(!de.current):$.style.display=de.current?"block":"none");const Ye=Math.floor(y[0]/2),he=C?ie?[y[0],Ye]:[Ye-1,0]:y;if($.style.zIndex=`${aq(L.current,N,he)}`,u){const[Ge,be]=[z.width/2,z.height/2],Ee=N.projectionMatrix.elements[5]*be,{isOrthographicCamera:Se,top:ee,left:Q,bottom:ce,right:me}=N,Ze=oq(N.matrixWorldInverse),Xe=Se?`scale(${Ee})translate(${lR(-(me+Q)/2)}px,${lR((ee+ce)/2)}px)`:`translateZ(${Ee}px)`;let De=L.current.matrixWorld;c&&(De=N.matrixWorldInverse.clone().transpose().copyPosition(De).scale(L.current.scale),De.elements[3]=De.elements[7]=De.elements[11]=0,De.elements[15]=1),$.style.width=z.width+"px",$.style.height=z.height+"px",$.style.perspective=Se?"":`${Ee}px`,K.current&&O.current&&(K.current.style.transform=`${Xe}${Ze}translate(${Ge}px,${be}px)`,O.current.style.transform=rq(De,1/((l||10)/400)))}else{const Ge=l===void 0?1:iq(L.current,N)*l;$.style.transform=`translate3d(${ye[0]}px,${ye[1]}px,0) scale(${Ge})`}q.current=ye,U.current=N.zoom}}if(!ie&&ne.current&&!k.current)if(u){if(K.current){const ye=K.current.children[0];if(ye!=null&&ye.clientWidth&&ye!=null&&ye.clientHeight){const{isOrthographicCamera:pe}=N;if(pe||b)M.scale&&(Array.isArray(M.scale)?M.scale instanceof Be?ne.current.scale.copy(M.scale.clone().divideScalar(1)):ne.current.scale.set(1/M.scale[0],1/M.scale[1],1/M.scale[2]):ne.current.scale.setScalar(1/M.scale));else{const Te=(l||10)/400,le=ye.clientWidth*Te,Ye=ye.clientHeight*Te;ne.current.scale.set(le,Ye,1)}k.current=!0}}}else{const ye=$.children[0];if(ye!=null&&ye.clientWidth&&ye!=null&&ye.clientHeight){const pe=1/P.factor,Te=ye.clientWidth*pe,le=ye.clientHeight*pe;ne.current.scale.set(Te,le,1),k.current=!0}ne.current.lookAt(Ne.camera.position)}});const xe=v.useMemo(()=>({vertexShader:u?void 0:`
          /*
            This shader is from the THREE's SpriteMaterial.
            We need to turn the backing plane into a Sprite
            (make it always face the camera) if "transfrom"
            is false.
          */
          #include <common>

          void main() {
            vec2 center = vec2(0., 1.);
            float rotation = 0.0;

            // This is somewhat arbitrary, but it seems to work well
            // Need to figure out how to derive this dynamically if it even matters
            float size = 0.03;

            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
            vec2 scale;
            scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
            scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );

            bool isPerspective = isPerspectiveMatrix( projectionMatrix );
            if ( isPerspective ) scale *= - mvPosition.z;

            vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;
            vec2 rotatedPosition;
            rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
            rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
            mvPosition.xy += rotatedPosition;

            gl_Position = projectionMatrix * mvPosition;
          }
      `,fragmentShader:`
        void main() {
          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
        }
      `}),[u]);return v.createElement("group",$t({},M,{ref:L}),C&&!ie&&v.createElement("mesh",{castShadow:m,receiveShadow:p,ref:ne},b||v.createElement("planeGeometry",null),B||v.createElement("shaderMaterial",{side:ms,vertexShader:xe.vertexShader,fragmentShader:xe.fragmentShader})))}),PG=parseInt(eb.replace(/\D+/g,""));function CE(n,e){if(e===p9)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),n;if(e===xB||e===ix){let t=n.getIndex();if(t===null){const r=[],s=n.getAttribute("position");if(s!==void 0){for(let l=0;l<s.count;l++)r.push(l);n.setIndex(r),t=n.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),n}const i=t.count-2,a=[];if(t)if(e===xB)for(let r=1;r<=i;r++)a.push(t.getX(0)),a.push(t.getX(r)),a.push(t.getX(r+1));else for(let r=0;r<i;r++)r%2===0?(a.push(t.getX(r)),a.push(t.getX(r+1)),a.push(t.getX(r+2))):(a.push(t.getX(r+2)),a.push(t.getX(r+1)),a.push(t.getX(r)));a.length/3!==i&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const o=n.clone();return o.setIndex(a),o.clearGroups(),o}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),n}var ml=Uint8Array,Cd=Uint16Array,cR=Uint32Array,sT=new ml([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),lT=new ml([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),cq=new ml([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),cT=function(n,e){for(var t=new Cd(31),i=0;i<31;++i)t[i]=e+=1<<n[i-1];for(var a=new cR(t[30]),i=1;i<30;++i)for(var o=t[i];o<t[i+1];++o)a[o]=o-t[i]<<5|i;return[t,a]},gT=cT(sT,2),uT=gT[0],gq=gT[1];uT[28]=258,gq[258]=28;var uq=cT(lT,0),dq=uq[0],gR=new Cd(32768);for(var ca=0;ca<32768;++ca){var sd=(ca&43690)>>>1|(ca&21845)<<1;sd=(sd&52428)>>>2|(sd&13107)<<2,sd=(sd&61680)>>>4|(sd&3855)<<4,gR[ca]=((sd&65280)>>>8|(sd&255)<<8)>>>1}var dp=function(n,e,t){for(var i=n.length,a=0,o=new Cd(e);a<i;++a)++o[n[a]-1];var r=new Cd(e);for(a=0;a<e;++a)r[a]=r[a-1]+o[a-1]<<1;var s;if(t){s=new Cd(1<<e);var l=15-e;for(a=0;a<i;++a)if(n[a])for(var c=a<<4|n[a],u=e-n[a],C=r[n[a]-1]++<<u,h=C|(1<<u)-1;C<=h;++C)s[gR[C]>>>l]=c}else for(s=new Cd(i),a=0;a<i;++a)n[a]&&(s[a]=gR[r[n[a]-1]++]>>>15-n[a]);return s},Ab=new ml(288);for(var ca=0;ca<144;++ca)Ab[ca]=8;for(var ca=144;ca<256;++ca)Ab[ca]=9;for(var ca=256;ca<280;++ca)Ab[ca]=7;for(var ca=280;ca<288;++ca)Ab[ca]=8;var dT=new ml(32);for(var ca=0;ca<32;++ca)dT[ca]=5;var Cq=dp(Ab,9,1),Iq=dp(dT,5,1),Bw=function(n){for(var e=n[0],t=1;t<n.length;++t)n[t]>e&&(e=n[t]);return e},nc=function(n,e,t){var i=e/8|0;return(n[i]|n[i+1]<<8)>>(e&7)&t},Gw=function(n,e){var t=e/8|0;return(n[t]|n[t+1]<<8|n[t+2]<<16)>>(e&7)},hq=function(n){return(n/8|0)+(n&7&&1)},fq=function(n,e,t){(t==null||t>n.length)&&(t=n.length);var i=new(n instanceof Cd?Cd:n instanceof cR?cR:ml)(t-e);return i.set(n.subarray(e,t)),i},Aq=function(n,e,t){var i=n.length;if(!i||t&&!t.l&&i<5)return e||new ml(0);var a=!e||t,o=!t||t.i;t||(t={}),e||(e=new ml(i*3));var r=function(re){var ge=e.length;if(re>ge){var de=new ml(Math.max(ge*2,re));de.set(e),e=de}},s=t.f||0,l=t.p||0,c=t.b||0,u=t.l,C=t.d,h=t.m,m=t.n,p=i*8;do{if(!u){t.f=s=nc(n,l,1);var B=nc(n,l+1,3);if(l+=3,B)if(B==1)u=Cq,C=Iq,h=9,m=5;else if(B==2){var R=nc(n,l,31)+257,Z=nc(n,l+10,15)+4,x=R+nc(n,l+5,31)+1;l+=14;for(var M=new ml(x),E=new ml(19),F=0;F<Z;++F)E[cq[F]]=nc(n,l+F*3,7);l+=Z*3;for(var N=Bw(E),H=(1<<N)-1,z=dp(E,N,1),F=0;F<x;){var _=z[nc(n,l,H)];l+=_&15;var b=_>>>4;if(b<16)M[F++]=b;else{var D=0,P=0;for(b==16?(P=3+nc(n,l,3),l+=2,D=M[F-1]):b==17?(P=3+nc(n,l,7),l+=3):b==18&&(P=11+nc(n,l,127),l+=7);P--;)M[F++]=D}}var $=M.subarray(0,R),X=M.subarray(R);h=Bw($),m=Bw(X),u=dp($,h,1),C=dp(X,m,1)}else throw"invalid block type";else{var b=hq(l)+4,y=n[b-4]|n[b-3]<<8,S=b+y;if(S>i){if(o)throw"unexpected EOF";break}a&&r(c+y),e.set(n.subarray(b,S),c),t.b=c+=y,t.p=l=S*8;continue}if(l>p){if(o)throw"unexpected EOF";break}}a&&r(c+131072);for(var L=(1<<h)-1,U=(1<<m)-1,q=l;;q=l){var D=u[Gw(n,l)&L],K=D>>>4;if(l+=D&15,l>p){if(o)throw"unexpected EOF";break}if(!D)throw"invalid length/literal";if(K<256)e[c++]=K;else if(K==256){q=l,u=null;break}else{var O=K-254;if(K>264){var F=K-257,j=sT[F];O=nc(n,l,(1<<j)-1)+uT[F],l+=j}var ne=C[Gw(n,l)&U],k=ne>>>4;if(!ne)throw"invalid distance";l+=ne&15;var X=dq[k];if(k>3){var j=lT[k];X+=Gw(n,l)&(1<<j)-1,l+=j}if(l>p){if(o)throw"unexpected EOF";break}a&&r(c+131072);for(var ie=c+O;c<ie;c+=4)e[c]=e[c-X],e[c+1]=e[c+1-X],e[c+2]=e[c+2-X],e[c+3]=e[c+3-X];c=ie}}t.l=u,t.p=q,t.b=c,u&&(s=1,t.m=h,t.d=C,t.n=m)}while(!s);return c==e.length?e:fq(e,0,c)},mq=new ml(0),pq=function(n){if((n[0]&15)!=8||n[0]>>>4>7||(n[0]<<8|n[1])%31)throw"invalid zlib data";if(n[1]&32)throw"invalid zlib data: preset dictionaries not supported"};function Ov(n,e){return Aq((pq(n),n.subarray(2,-4)),e)}var bq=typeof TextDecoder<"u"&&new TextDecoder,vq=0;try{bq.decode(mq,{stream:!0}),vq=1}catch{}var yq=Object.defineProperty,Bq=(n,e,t)=>e in n?yq(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,IE=(n,e,t)=>(Bq(n,typeof e!="symbol"?e+"":e,t),t);const Gq=(()=>{const n={uniforms:{turbidity:{value:2},rayleigh:{value:1},mieCoefficient:{value:.005},mieDirectionalG:{value:.8},sunPosition:{value:new Be},up:{value:new Be(0,1,0)}},vertexShader:`
      uniform vec3 sunPosition;
      uniform float rayleigh;
      uniform float turbidity;
      uniform float mieCoefficient;
      uniform vec3 up;

      varying vec3 vWorldPosition;
      varying vec3 vSunDirection;
      varying float vSunfade;
      varying vec3 vBetaR;
      varying vec3 vBetaM;
      varying float vSunE;

      // constants for atmospheric scattering
      const float e = 2.71828182845904523536028747135266249775724709369995957;
      const float pi = 3.141592653589793238462643383279502884197169;

      // wavelength of used primaries, according to preetham
      const vec3 lambda = vec3( 680E-9, 550E-9, 450E-9 );
      // this pre-calcuation replaces older TotalRayleigh(vec3 lambda) function:
      // (8.0 * pow(pi, 3.0) * pow(pow(n, 2.0) - 1.0, 2.0) * (6.0 + 3.0 * pn)) / (3.0 * N * pow(lambda, vec3(4.0)) * (6.0 - 7.0 * pn))
      const vec3 totalRayleigh = vec3( 5.804542996261093E-6, 1.3562911419845635E-5, 3.0265902468824876E-5 );

      // mie stuff
      // K coefficient for the primaries
      const float v = 4.0;
      const vec3 K = vec3( 0.686, 0.678, 0.666 );
      // MieConst = pi * pow( ( 2.0 * pi ) / lambda, vec3( v - 2.0 ) ) * K
      const vec3 MieConst = vec3( 1.8399918514433978E14, 2.7798023919660528E14, 4.0790479543861094E14 );

      // earth shadow hack
      // cutoffAngle = pi / 1.95;
      const float cutoffAngle = 1.6110731556870734;
      const float steepness = 1.5;
      const float EE = 1000.0;

      float sunIntensity( float zenithAngleCos ) {
        zenithAngleCos = clamp( zenithAngleCos, -1.0, 1.0 );
        return EE * max( 0.0, 1.0 - pow( e, -( ( cutoffAngle - acos( zenithAngleCos ) ) / steepness ) ) );
      }

      vec3 totalMie( float T ) {
        float c = ( 0.2 * T ) * 10E-18;
        return 0.434 * c * MieConst;
      }

      void main() {

        vec4 worldPosition = modelMatrix * vec4( position, 1.0 );
        vWorldPosition = worldPosition.xyz;

        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        gl_Position.z = gl_Position.w; // set z to camera.far

        vSunDirection = normalize( sunPosition );

        vSunE = sunIntensity( dot( vSunDirection, up ) );

        vSunfade = 1.0 - clamp( 1.0 - exp( ( sunPosition.y / 450000.0 ) ), 0.0, 1.0 );

        float rayleighCoefficient = rayleigh - ( 1.0 * ( 1.0 - vSunfade ) );

      // extinction (absorbtion + out scattering)
      // rayleigh coefficients
        vBetaR = totalRayleigh * rayleighCoefficient;

      // mie coefficients
        vBetaM = totalMie( turbidity ) * mieCoefficient;

      }
    `,fragmentShader:`
      varying vec3 vWorldPosition;
      varying vec3 vSunDirection;
      varying float vSunfade;
      varying vec3 vBetaR;
      varying vec3 vBetaM;
      varying float vSunE;

      uniform float mieDirectionalG;
      uniform vec3 up;

      const vec3 cameraPos = vec3( 0.0, 0.0, 0.0 );

      // constants for atmospheric scattering
      const float pi = 3.141592653589793238462643383279502884197169;

      const float n = 1.0003; // refractive index of air
      const float N = 2.545E25; // number of molecules per unit volume for air at 288.15K and 1013mb (sea level -45 celsius)

      // optical length at zenith for molecules
      const float rayleighZenithLength = 8.4E3;
      const float mieZenithLength = 1.25E3;
      // 66 arc seconds -> degrees, and the cosine of that
      const float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;

      // 3.0 / ( 16.0 * pi )
      const float THREE_OVER_SIXTEENPI = 0.05968310365946075;
      // 1.0 / ( 4.0 * pi )
      const float ONE_OVER_FOURPI = 0.07957747154594767;

      float rayleighPhase( float cosTheta ) {
        return THREE_OVER_SIXTEENPI * ( 1.0 + pow( cosTheta, 2.0 ) );
      }

      float hgPhase( float cosTheta, float g ) {
        float g2 = pow( g, 2.0 );
        float inverse = 1.0 / pow( 1.0 - 2.0 * g * cosTheta + g2, 1.5 );
        return ONE_OVER_FOURPI * ( ( 1.0 - g2 ) * inverse );
      }

      void main() {

        vec3 direction = normalize( vWorldPosition - cameraPos );

      // optical length
      // cutoff angle at 90 to avoid singularity in next formula.
        float zenithAngle = acos( max( 0.0, dot( up, direction ) ) );
        float inverse = 1.0 / ( cos( zenithAngle ) + 0.15 * pow( 93.885 - ( ( zenithAngle * 180.0 ) / pi ), -1.253 ) );
        float sR = rayleighZenithLength * inverse;
        float sM = mieZenithLength * inverse;

      // combined extinction factor
        vec3 Fex = exp( -( vBetaR * sR + vBetaM * sM ) );

      // in scattering
        float cosTheta = dot( direction, vSunDirection );

        float rPhase = rayleighPhase( cosTheta * 0.5 + 0.5 );
        vec3 betaRTheta = vBetaR * rPhase;

        float mPhase = hgPhase( cosTheta, mieDirectionalG );
        vec3 betaMTheta = vBetaM * mPhase;

        vec3 Lin = pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * ( 1.0 - Fex ), vec3( 1.5 ) );
        Lin *= mix( vec3( 1.0 ), pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * Fex, vec3( 1.0 / 2.0 ) ), clamp( pow( 1.0 - dot( up, vSunDirection ), 5.0 ), 0.0, 1.0 ) );

      // nightsky
        float theta = acos( direction.y ); // elevation --> y-axis, [-pi/2, pi/2]
        float phi = atan( direction.z, direction.x ); // azimuth --> x-axis [-pi/2, pi/2]
        vec2 uv = vec2( phi, theta ) / vec2( 2.0 * pi, pi ) + vec2( 0.5, 0.0 );
        vec3 L0 = vec3( 0.1 ) * Fex;

      // composition + solar disc
        float sundisk = smoothstep( sunAngularDiameterCos, sunAngularDiameterCos + 0.00002, cosTheta );
        L0 += ( vSunE * 19000.0 * Fex ) * sundisk;

        vec3 texColor = ( Lin + L0 ) * 0.04 + vec3( 0.0, 0.0003, 0.00075 );

        vec3 retColor = pow( texColor, vec3( 1.0 / ( 1.2 + ( 1.2 * vSunfade ) ) ) );

        gl_FragColor = vec4( retColor, 1.0 );

      #include <tonemapping_fragment>
      #include <${PG>=154?"colorspace_fragment":"encodings_fragment"}>

      }
    `},e=new Ur({name:"SkyShader",fragmentShader:n.fragmentShader,vertexShader:n.vertexShader,uniforms:yG.clone(n.uniforms),side:fr,depthWrite:!1});class t extends $i{constructor(){super(new wd(1,1,1),e)}}return IE(t,"SkyShader",n),IE(t,"material",e),t})(),Sq=n=>n&&n.isCubeTexture;class wq extends $i{constructor(e,t){var i,a;const o=Sq(e),s=((a=o?(i=e.image[0])==null?void 0:i.width:e.image.width)!=null?a:1024)/4,l=Math.floor(Math.log2(s)),c=Math.pow(2,l),u=3*Math.max(c,16*7),C=4*c,h=[o?"#define ENVMAP_TYPE_CUBE":"",`#define CUBEUV_TEXEL_WIDTH ${1/u}`,`#define CUBEUV_TEXEL_HEIGHT ${1/C}`,`#define CUBEUV_MAX_MIP ${l}.0`],m=`
        varying vec3 vWorldPosition;
        void main() 
        {
            vec4 worldPosition = ( modelMatrix * vec4( position, 1.0 ) );
            vWorldPosition = worldPosition.xyz;
            
            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        }
        `,p=h.join(`
`)+`
        #define ENVMAP_TYPE_CUBE_UV
        varying vec3 vWorldPosition;
        uniform float radius;
        uniform float height;
        uniform float angle;
        #ifdef ENVMAP_TYPE_CUBE
            uniform samplerCube map;
        #else
            uniform sampler2D map;
        #endif
        // From: https://www.shadertoy.com/view/4tsBD7
        float diskIntersectWithBackFaceCulling( vec3 ro, vec3 rd, vec3 c, vec3 n, float r ) 
        {
            float d = dot ( rd, n );
            
            if( d > 0.0 ) { return 1e6; }
            
            vec3  o = ro - c;
            float t = - dot( n, o ) / d;
            vec3  q = o + rd * t;
            
            return ( dot( q, q ) < r * r ) ? t : 1e6;
        }
        // From: https://www.iquilezles.org/www/articles/intersectors/intersectors.htm
        float sphereIntersect( vec3 ro, vec3 rd, vec3 ce, float ra ) 
        {
            vec3 oc = ro - ce;
            float b = dot( oc, rd );
            float c = dot( oc, oc ) - ra * ra;
            float h = b * b - c;
            
            if( h < 0.0 ) { return -1.0; }
            
            h = sqrt( h );
            
            return - b + h;
        }
        vec3 project() 
        {
            vec3 p = normalize( vWorldPosition );
            vec3 camPos = cameraPosition;
            camPos.y -= height;
            float intersection = sphereIntersect( camPos, p, vec3( 0.0 ), radius );
            if( intersection > 0.0 ) {
                
                vec3 h = vec3( 0.0, - height, 0.0 );
                float intersection2 = diskIntersectWithBackFaceCulling( camPos, p, h, vec3( 0.0, 1.0, 0.0 ), radius );
                p = ( camPos + min( intersection, intersection2 ) * p ) / radius;
            } else {
                p = vec3( 0.0, 1.0, 0.0 );
            }
            return p;
        }
        #include <common>
        #include <cube_uv_reflection_fragment>
        void main() 
        {
            vec3 projectedWorldPosition = project();
            
            #ifdef ENVMAP_TYPE_CUBE
                vec3 outcolor = textureCube( map, projectedWorldPosition ).rgb;
            #else
                vec3 direction = normalize( projectedWorldPosition );
                vec2 uv = equirectUv( direction );
                vec3 outcolor = texture2D( map, uv ).rgb;
            #endif
            gl_FragColor = vec4( outcolor, 1.0 );
            #include <tonemapping_fragment>
            #include <${PG>=154?"colorspace_fragment":"encodings_fragment"}>
        }
        `,B={map:{value:e},height:{value:(t==null?void 0:t.height)||15},radius:{value:(t==null?void 0:t.radius)||100}},b=new ub(1,16),y=new Ur({uniforms:B,fragmentShader:p,vertexShader:m,side:ms});super(b,y)}set radius(e){this.material.uniforms.radius.value=e}get radius(){return this.material.uniforms.radius.value}set height(e){this.material.uniforms.height.value=e}get height(){return this.material.uniforms.height.value}}var Rq=Object.defineProperty,Zq=(n,e,t)=>e in n?Rq(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,xq=(n,e,t)=>(Zq(n,e+"",t),t);class Mq{constructor(){xq(this,"_listeners")}addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(t)===-1&&i[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const i=this._listeners;return i[e]!==void 0&&i[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const a=this._listeners[e];if(a!==void 0){const o=a.indexOf(t);o!==-1&&a.splice(o,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const i=this._listeners[e.type];if(i!==void 0){e.target=this;const a=i.slice(0);for(let o=0,r=a.length;o<r;o++)a[o].call(this,e);e.target=null}}}var Wq=Object.defineProperty,Vq=(n,e,t)=>e in n?Wq(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Hn=(n,e,t)=>(Vq(n,typeof e!="symbol"?e+"":e,t),t);const Uv=new pI,hE=new qg,Nq=Math.cos(70*(Math.PI/180)),fE=(n,e)=>(n%e+e)%e;let Eq=class extends Mq{constructor(e,t){super(),Hn(this,"object"),Hn(this,"domElement"),Hn(this,"enabled",!0),Hn(this,"target",new Be),Hn(this,"minDistance",0),Hn(this,"maxDistance",1/0),Hn(this,"minZoom",0),Hn(this,"maxZoom",1/0),Hn(this,"minPolarAngle",0),Hn(this,"maxPolarAngle",Math.PI),Hn(this,"minAzimuthAngle",-1/0),Hn(this,"maxAzimuthAngle",1/0),Hn(this,"enableDamping",!1),Hn(this,"dampingFactor",.05),Hn(this,"enableZoom",!0),Hn(this,"zoomSpeed",1),Hn(this,"enableRotate",!0),Hn(this,"rotateSpeed",1),Hn(this,"enablePan",!0),Hn(this,"panSpeed",1),Hn(this,"screenSpacePanning",!0),Hn(this,"keyPanSpeed",7),Hn(this,"zoomToCursor",!1),Hn(this,"autoRotate",!1),Hn(this,"autoRotateSpeed",2),Hn(this,"reverseOrbit",!1),Hn(this,"reverseHorizontalOrbit",!1),Hn(this,"reverseVerticalOrbit",!1),Hn(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),Hn(this,"mouseButtons",{LEFT:EC.ROTATE,MIDDLE:EC.DOLLY,RIGHT:EC.PAN}),Hn(this,"touches",{ONE:HC.ROTATE,TWO:HC.DOLLY_PAN}),Hn(this,"target0"),Hn(this,"position0"),Hn(this,"zoom0"),Hn(this,"_domElementKeyEvents",null),Hn(this,"getPolarAngle"),Hn(this,"getAzimuthalAngle"),Hn(this,"setPolarAngle"),Hn(this,"setAzimuthalAngle"),Hn(this,"getDistance"),Hn(this,"getZoomScale"),Hn(this,"listenToKeyEvents"),Hn(this,"stopListenToKeyEvents"),Hn(this,"saveState"),Hn(this,"reset"),Hn(this,"update"),Hn(this,"connect"),Hn(this,"dispose"),Hn(this,"dollyIn"),Hn(this,"dollyOut"),Hn(this,"getScale"),Hn(this,"setScale"),this.object=e,this.domElement=t,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>u.phi,this.getAzimuthalAngle=()=>u.theta,this.setPolarAngle=Ce=>{let He=fE(Ce,2*Math.PI),ht=u.phi;ht<0&&(ht+=2*Math.PI),He<0&&(He+=2*Math.PI);let we=Math.abs(He-ht);2*Math.PI-we<we&&(He<ht?He+=2*Math.PI:ht+=2*Math.PI),C.phi=He-ht,i.update()},this.setAzimuthalAngle=Ce=>{let He=fE(Ce,2*Math.PI),ht=u.theta;ht<0&&(ht+=2*Math.PI),He<0&&(He+=2*Math.PI);let we=Math.abs(He-ht);2*Math.PI-we<we&&(He<ht?He+=2*Math.PI:ht+=2*Math.PI),C.theta=He-ht,i.update()},this.getDistance=()=>i.object.position.distanceTo(i.target),this.listenToKeyEvents=Ce=>{Ce.addEventListener("keydown",Oe),this._domElementKeyEvents=Ce},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",Oe),this._domElementKeyEvents=null},this.saveState=()=>{i.target0.copy(i.target),i.position0.copy(i.object.position),i.zoom0=i.object.zoom},this.reset=()=>{i.target.copy(i.target0),i.object.position.copy(i.position0),i.object.zoom=i.zoom0,i.object.updateProjectionMatrix(),i.dispatchEvent(a),i.update(),l=s.NONE},this.update=(()=>{const Ce=new Be,He=new Be(0,1,0),ht=new eo().setFromUnitVectors(e.up,He),we=ht.clone().invert(),ze=new Be,Qe=new eo,ut=2*Math.PI;return function(){const mt=i.object.position;ht.setFromUnitVectors(e.up,He),we.copy(ht).invert(),Ce.copy(mt).sub(i.target),Ce.applyQuaternion(ht),u.setFromVector3(Ce),i.autoRotate&&l===s.NONE&&P(_()),i.enableDamping?(u.theta+=C.theta*i.dampingFactor,u.phi+=C.phi*i.dampingFactor):(u.theta+=C.theta,u.phi+=C.phi);let _t=i.minAzimuthAngle,Lt=i.maxAzimuthAngle;isFinite(_t)&&isFinite(Lt)&&(_t<-Math.PI?_t+=ut:_t>Math.PI&&(_t-=ut),Lt<-Math.PI?Lt+=ut:Lt>Math.PI&&(Lt-=ut),_t<=Lt?u.theta=Math.max(_t,Math.min(Lt,u.theta)):u.theta=u.theta>(_t+Lt)/2?Math.max(_t,u.theta):Math.min(Lt,u.theta)),u.phi=Math.max(i.minPolarAngle,Math.min(i.maxPolarAngle,u.phi)),u.makeSafe(),i.enableDamping===!0?i.target.addScaledVector(m,i.dampingFactor):i.target.add(m),i.zoomToCursor&&N||i.object.isOrthographicCamera?u.radius=ne(u.radius):u.radius=ne(u.radius*h),Ce.setFromSpherical(u),Ce.applyQuaternion(we),mt.copy(i.target).add(Ce),i.object.matrixAutoUpdate||i.object.updateMatrix(),i.object.lookAt(i.target),i.enableDamping===!0?(C.theta*=1-i.dampingFactor,C.phi*=1-i.dampingFactor,m.multiplyScalar(1-i.dampingFactor)):(C.set(0,0,0),m.set(0,0,0));let Zt=!1;if(i.zoomToCursor&&N){let yt=null;if(i.object instanceof fa&&i.object.isPerspectiveCamera){const Ht=Ce.length();yt=ne(Ht*h);const jt=Ht-yt;i.object.position.addScaledVector(E,jt),i.object.updateMatrixWorld()}else if(i.object.isOrthographicCamera){const Ht=new Be(F.x,F.y,0);Ht.unproject(i.object),i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/h)),i.object.updateProjectionMatrix(),Zt=!0;const jt=new Be(F.x,F.y,0);jt.unproject(i.object),i.object.position.sub(jt).add(Ht),i.object.updateMatrixWorld(),yt=Ce.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),i.zoomToCursor=!1;yt!==null&&(i.screenSpacePanning?i.target.set(0,0,-1).transformDirection(i.object.matrix).multiplyScalar(yt).add(i.object.position):(Uv.origin.copy(i.object.position),Uv.direction.set(0,0,-1).transformDirection(i.object.matrix),Math.abs(i.object.up.dot(Uv.direction))<Nq?e.lookAt(i.target):(hE.setFromNormalAndCoplanarPoint(i.object.up,i.target),Uv.intersectPlane(hE,i.target))))}else i.object instanceof bl&&i.object.isOrthographicCamera&&(Zt=h!==1,Zt&&(i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/h)),i.object.updateProjectionMatrix()));return h=1,N=!1,Zt||ze.distanceToSquared(i.object.position)>c||8*(1-Qe.dot(i.object.quaternion))>c?(i.dispatchEvent(a),ze.copy(i.object.position),Qe.copy(i.object.quaternion),Zt=!1,!0):!1}})(),this.connect=Ce=>{i.domElement=Ce,i.domElement.style.touchAction="none",i.domElement.addEventListener("contextmenu",qe),i.domElement.addEventListener("pointerdown",Q),i.domElement.addEventListener("pointercancel",me),i.domElement.addEventListener("wheel",De)},this.dispose=()=>{var Ce,He,ht,we,ze,Qe;i.domElement&&(i.domElement.style.touchAction="auto"),(Ce=i.domElement)==null||Ce.removeEventListener("contextmenu",qe),(He=i.domElement)==null||He.removeEventListener("pointerdown",Q),(ht=i.domElement)==null||ht.removeEventListener("pointercancel",me),(we=i.domElement)==null||we.removeEventListener("wheel",De),(ze=i.domElement)==null||ze.ownerDocument.removeEventListener("pointermove",ce),(Qe=i.domElement)==null||Qe.ownerDocument.removeEventListener("pointerup",me),i._domElementKeyEvents!==null&&i._domElementKeyEvents.removeEventListener("keydown",Oe)};const i=this,a={type:"change"},o={type:"start"},r={type:"end"},s={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let l=s.NONE;const c=1e-6,u=new $1,C=new $1;let h=1;const m=new Be,p=new Xt,B=new Xt,b=new Xt,y=new Xt,S=new Xt,R=new Xt,Z=new Xt,x=new Xt,M=new Xt,E=new Be,F=new Xt;let N=!1;const H=[],z={};function _(){return 2*Math.PI/60/60*i.autoRotateSpeed}function D(){return Math.pow(.95,i.zoomSpeed)}function P(Ce){i.reverseOrbit||i.reverseHorizontalOrbit?C.theta+=Ce:C.theta-=Ce}function $(Ce){i.reverseOrbit||i.reverseVerticalOrbit?C.phi+=Ce:C.phi-=Ce}const X=(()=>{const Ce=new Be;return function(ht,we){Ce.setFromMatrixColumn(we,0),Ce.multiplyScalar(-ht),m.add(Ce)}})(),L=(()=>{const Ce=new Be;return function(ht,we){i.screenSpacePanning===!0?Ce.setFromMatrixColumn(we,1):(Ce.setFromMatrixColumn(we,0),Ce.crossVectors(i.object.up,Ce)),Ce.multiplyScalar(ht),m.add(Ce)}})(),U=(()=>{const Ce=new Be;return function(ht,we){const ze=i.domElement;if(ze&&i.object instanceof fa&&i.object.isPerspectiveCamera){const Qe=i.object.position;Ce.copy(Qe).sub(i.target);let ut=Ce.length();ut*=Math.tan(i.object.fov/2*Math.PI/180),X(2*ht*ut/ze.clientHeight,i.object.matrix),L(2*we*ut/ze.clientHeight,i.object.matrix)}else ze&&i.object instanceof bl&&i.object.isOrthographicCamera?(X(ht*(i.object.right-i.object.left)/i.object.zoom/ze.clientWidth,i.object.matrix),L(we*(i.object.top-i.object.bottom)/i.object.zoom/ze.clientHeight,i.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),i.enablePan=!1)}})();function q(Ce){i.object instanceof fa&&i.object.isPerspectiveCamera||i.object instanceof bl&&i.object.isOrthographicCamera?h=Ce:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function K(Ce){q(h/Ce)}function O(Ce){q(h*Ce)}function j(Ce){if(!i.zoomToCursor||!i.domElement)return;N=!0;const He=i.domElement.getBoundingClientRect(),ht=Ce.clientX-He.left,we=Ce.clientY-He.top,ze=He.width,Qe=He.height;F.x=ht/ze*2-1,F.y=-(we/Qe)*2+1,E.set(F.x,F.y,1).unproject(i.object).sub(i.object.position).normalize()}function ne(Ce){return Math.max(i.minDistance,Math.min(i.maxDistance,Ce))}function k(Ce){p.set(Ce.clientX,Ce.clientY)}function ie(Ce){j(Ce),Z.set(Ce.clientX,Ce.clientY)}function re(Ce){y.set(Ce.clientX,Ce.clientY)}function ge(Ce){B.set(Ce.clientX,Ce.clientY),b.subVectors(B,p).multiplyScalar(i.rotateSpeed);const He=i.domElement;He&&(P(2*Math.PI*b.x/He.clientHeight),$(2*Math.PI*b.y/He.clientHeight)),p.copy(B),i.update()}function de(Ce){x.set(Ce.clientX,Ce.clientY),M.subVectors(x,Z),M.y>0?K(D()):M.y<0&&O(D()),Z.copy(x),i.update()}function xe(Ce){S.set(Ce.clientX,Ce.clientY),R.subVectors(S,y).multiplyScalar(i.panSpeed),U(R.x,R.y),y.copy(S),i.update()}function Ne(Ce){j(Ce),Ce.deltaY<0?O(D()):Ce.deltaY>0&&K(D()),i.update()}function ye(Ce){let He=!1;switch(Ce.code){case i.keys.UP:U(0,i.keyPanSpeed),He=!0;break;case i.keys.BOTTOM:U(0,-i.keyPanSpeed),He=!0;break;case i.keys.LEFT:U(i.keyPanSpeed,0),He=!0;break;case i.keys.RIGHT:U(-i.keyPanSpeed,0),He=!0;break}He&&(Ce.preventDefault(),i.update())}function pe(){if(H.length==1)p.set(H[0].pageX,H[0].pageY);else{const Ce=.5*(H[0].pageX+H[1].pageX),He=.5*(H[0].pageY+H[1].pageY);p.set(Ce,He)}}function Te(){if(H.length==1)y.set(H[0].pageX,H[0].pageY);else{const Ce=.5*(H[0].pageX+H[1].pageX),He=.5*(H[0].pageY+H[1].pageY);y.set(Ce,He)}}function le(){const Ce=H[0].pageX-H[1].pageX,He=H[0].pageY-H[1].pageY,ht=Math.sqrt(Ce*Ce+He*He);Z.set(0,ht)}function Ye(){i.enableZoom&&le(),i.enablePan&&Te()}function he(){i.enableZoom&&le(),i.enableRotate&&pe()}function Ge(Ce){if(H.length==1)B.set(Ce.pageX,Ce.pageY);else{const ht=ke(Ce),we=.5*(Ce.pageX+ht.x),ze=.5*(Ce.pageY+ht.y);B.set(we,ze)}b.subVectors(B,p).multiplyScalar(i.rotateSpeed);const He=i.domElement;He&&(P(2*Math.PI*b.x/He.clientHeight),$(2*Math.PI*b.y/He.clientHeight)),p.copy(B)}function be(Ce){if(H.length==1)S.set(Ce.pageX,Ce.pageY);else{const He=ke(Ce),ht=.5*(Ce.pageX+He.x),we=.5*(Ce.pageY+He.y);S.set(ht,we)}R.subVectors(S,y).multiplyScalar(i.panSpeed),U(R.x,R.y),y.copy(S)}function Ee(Ce){const He=ke(Ce),ht=Ce.pageX-He.x,we=Ce.pageY-He.y,ze=Math.sqrt(ht*ht+we*we);x.set(0,ze),M.set(0,Math.pow(x.y/Z.y,i.zoomSpeed)),K(M.y),Z.copy(x)}function Se(Ce){i.enableZoom&&Ee(Ce),i.enablePan&&be(Ce)}function ee(Ce){i.enableZoom&&Ee(Ce),i.enableRotate&&Ge(Ce)}function Q(Ce){var He,ht;i.enabled!==!1&&(H.length===0&&((He=i.domElement)==null||He.ownerDocument.addEventListener("pointermove",ce),(ht=i.domElement)==null||ht.ownerDocument.addEventListener("pointerup",me)),lt(Ce),Ce.pointerType==="touch"?Je(Ce):Ze(Ce))}function ce(Ce){i.enabled!==!1&&(Ce.pointerType==="touch"?At(Ce):Xe(Ce))}function me(Ce){var He,ht,we;$e(Ce),H.length===0&&((He=i.domElement)==null||He.releasePointerCapture(Ce.pointerId),(ht=i.domElement)==null||ht.ownerDocument.removeEventListener("pointermove",ce),(we=i.domElement)==null||we.ownerDocument.removeEventListener("pointerup",me)),i.dispatchEvent(r),l=s.NONE}function Ze(Ce){let He;switch(Ce.button){case 0:He=i.mouseButtons.LEFT;break;case 1:He=i.mouseButtons.MIDDLE;break;case 2:He=i.mouseButtons.RIGHT;break;default:He=-1}switch(He){case EC.DOLLY:if(i.enableZoom===!1)return;ie(Ce),l=s.DOLLY;break;case EC.ROTATE:if(Ce.ctrlKey||Ce.metaKey||Ce.shiftKey){if(i.enablePan===!1)return;re(Ce),l=s.PAN}else{if(i.enableRotate===!1)return;k(Ce),l=s.ROTATE}break;case EC.PAN:if(Ce.ctrlKey||Ce.metaKey||Ce.shiftKey){if(i.enableRotate===!1)return;k(Ce),l=s.ROTATE}else{if(i.enablePan===!1)return;re(Ce),l=s.PAN}break;default:l=s.NONE}l!==s.NONE&&i.dispatchEvent(o)}function Xe(Ce){if(i.enabled!==!1)switch(l){case s.ROTATE:if(i.enableRotate===!1)return;ge(Ce);break;case s.DOLLY:if(i.enableZoom===!1)return;de(Ce);break;case s.PAN:if(i.enablePan===!1)return;xe(Ce);break}}function De(Ce){i.enabled===!1||i.enableZoom===!1||l!==s.NONE&&l!==s.ROTATE||(Ce.preventDefault(),i.dispatchEvent(o),Ne(Ce),i.dispatchEvent(r))}function Oe(Ce){i.enabled===!1||i.enablePan===!1||ye(Ce)}function Je(Ce){switch(je(Ce),H.length){case 1:switch(i.touches.ONE){case HC.ROTATE:if(i.enableRotate===!1)return;pe(),l=s.TOUCH_ROTATE;break;case HC.PAN:if(i.enablePan===!1)return;Te(),l=s.TOUCH_PAN;break;default:l=s.NONE}break;case 2:switch(i.touches.TWO){case HC.DOLLY_PAN:if(i.enableZoom===!1&&i.enablePan===!1)return;Ye(),l=s.TOUCH_DOLLY_PAN;break;case HC.DOLLY_ROTATE:if(i.enableZoom===!1&&i.enableRotate===!1)return;he(),l=s.TOUCH_DOLLY_ROTATE;break;default:l=s.NONE}break;default:l=s.NONE}l!==s.NONE&&i.dispatchEvent(o)}function At(Ce){switch(je(Ce),l){case s.TOUCH_ROTATE:if(i.enableRotate===!1)return;Ge(Ce),i.update();break;case s.TOUCH_PAN:if(i.enablePan===!1)return;be(Ce),i.update();break;case s.TOUCH_DOLLY_PAN:if(i.enableZoom===!1&&i.enablePan===!1)return;Se(Ce),i.update();break;case s.TOUCH_DOLLY_ROTATE:if(i.enableZoom===!1&&i.enableRotate===!1)return;ee(Ce),i.update();break;default:l=s.NONE}}function qe(Ce){i.enabled!==!1&&Ce.preventDefault()}function lt(Ce){H.push(Ce)}function $e(Ce){delete z[Ce.pointerId];for(let He=0;He<H.length;He++)if(H[He].pointerId==Ce.pointerId){H.splice(He,1);return}}function je(Ce){let He=z[Ce.pointerId];He===void 0&&(He=new Xt,z[Ce.pointerId]=He),He.set(Ce.pageX,Ce.pageY)}function ke(Ce){const He=Ce.pointerId===H[0].pointerId?H[1]:H[0];return z[He.pointerId]}this.dollyIn=(Ce=D())=>{O(Ce),i.update()},this.dollyOut=(Ce=D())=>{K(Ce),i.update()},this.getScale=()=>h,this.setScale=Ce=>{q(Ce),i.update()},this.getZoomScale=()=>D(),t!==void 0&&this.connect(t),this.update()}};function TB(n){if(typeof TextDecoder<"u")return new TextDecoder().decode(n);let e="";for(let t=0,i=n.length;t<i;t++)e+=String.fromCharCode(n[t]);try{return decodeURIComponent(escape(e))}catch{return e}}const QC="srgb",su="srgb-linear",AE=3001,Hq=3e3;class kx extends Jo{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new zq(t)}),this.register(function(t){return new Kq(t)}),this.register(function(t){return new jq(t)}),this.register(function(t){return new Qq(t)}),this.register(function(t){return new qq(t)}),this.register(function(t){return new _q(t)}),this.register(function(t){return new Dq(t)}),this.register(function(t){return new Oq(t)}),this.register(function(t){return new Uq(t)}),this.register(function(t){return new Yq(t)}),this.register(function(t){return new kq(t)}),this.register(function(t){return new Lq(t)}),this.register(function(t){return new Jq(t)}),this.register(function(t){return new Pq(t)}),this.register(function(t){return new Xq(t)}),this.register(function(t){return new $q(t)}),this.register(function(t){return new e$(t)})}load(e,t,i,a){const o=this;let r;if(this.resourcePath!=="")r=this.resourcePath;else if(this.path!==""){const c=Ad.extractUrlBase(e);r=Ad.resolveURL(c,this.path)}else r=Ad.extractUrlBase(e);this.manager.itemStart(e);const s=function(c){a?a(c):console.error(c),o.manager.itemError(e),o.manager.itemEnd(e)},l=new ko(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(c){try{o.parse(c,r,function(u){t(u),o.manager.itemEnd(e)},s)}catch(u){s(u)}},i,s)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,i,a){let o;const r={},s={};if(typeof e=="string")o=JSON.parse(e);else if(e instanceof ArrayBuffer)if(TB(new Uint8Array(e.slice(0,4)))===CT){try{r[Ci.KHR_BINARY_GLTF]=new t$(e)}catch(u){a&&a(u);return}o=JSON.parse(r[Ci.KHR_BINARY_GLTF].content)}else o=JSON.parse(TB(new Uint8Array(e)));else o=e;if(o.asset===void 0||o.asset.version[0]<2){a&&a(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const l=new I$(o,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});l.fileLoader.setRequestHeader(this.requestHeader);for(let c=0;c<this.pluginCallbacks.length;c++){const u=this.pluginCallbacks[c](l);u.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),s[u.name]=u,r[u.name]=!0}if(o.extensionsUsed)for(let c=0;c<o.extensionsUsed.length;++c){const u=o.extensionsUsed[c],C=o.extensionsRequired||[];switch(u){case Ci.KHR_MATERIALS_UNLIT:r[u]=new Tq;break;case Ci.KHR_DRACO_MESH_COMPRESSION:r[u]=new n$(o,this.dracoLoader);break;case Ci.KHR_TEXTURE_TRANSFORM:r[u]=new i$;break;case Ci.KHR_MESH_QUANTIZATION:r[u]=new a$;break;default:C.indexOf(u)>=0&&s[u]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+u+'".')}}l.setExtensions(r),l.setPlugins(s),l.parse(i,a)}parseAsync(e,t){const i=this;return new Promise(function(a,o){i.parse(e,t,a,o)})}}function Fq(){let n={};return{get:function(e){return n[e]},add:function(e,t){n[e]=t},remove:function(e){delete n[e]},removeAll:function(){n={}}}}const Ci={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class Xq{constructor(e){this.parser=e,this.name=Ci.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let i=0,a=t.length;i<a;i++){const o=t[i];o.extensions&&o.extensions[this.name]&&o.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,o.extensions[this.name].light)}}_loadLight(e){const t=this.parser,i="light:"+e;let a=t.cache.get(i);if(a)return a;const o=t.json,l=((o.extensions&&o.extensions[this.name]||{}).lights||[])[e];let c;const u=new dn(16777215);l.color!==void 0&&u.setRGB(l.color[0],l.color[1],l.color[2],su);const C=l.range!==void 0?l.range:0;switch(l.type){case"directional":c=new Zx(u),c.target.position.set(0,0,-1),c.add(c.target);break;case"point":c=new Rx(u),c.distance=C;break;case"spot":c=new wx(u),c.distance=C,l.spot=l.spot||{},l.spot.innerConeAngle=l.spot.innerConeAngle!==void 0?l.spot.innerConeAngle:0,l.spot.outerConeAngle=l.spot.outerConeAngle!==void 0?l.spot.outerConeAngle:Math.PI/4,c.angle=l.spot.outerConeAngle,c.penumbra=1-l.spot.innerConeAngle/l.spot.outerConeAngle,c.target.position.set(0,0,-1),c.add(c.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+l.type)}return c.position.set(0,0,0),c.decay=2,Qg(c,l),l.intensity!==void 0&&(c.intensity=l.intensity),c.name=t.createUniqueName(l.name||"light_"+e),a=Promise.resolve(c),t.cache.add(i,a),a}getDependency(e,t){if(e==="light")return this._loadLight(t)}createNodeAttachment(e){const t=this,i=this.parser,o=i.json.nodes[e],s=(o.extensions&&o.extensions[this.name]||{}).light;return s===void 0?null:this._loadLight(s).then(function(l){return i._getNodeRef(t.cache,s,l)})}}class Tq{constructor(){this.name=Ci.KHR_MATERIALS_UNLIT}getMaterialType(){return Or}extendParams(e,t,i){const a=[];e.color=new dn(1,1,1),e.opacity=1;const o=t.pbrMetallicRoughness;if(o){if(Array.isArray(o.baseColorFactor)){const r=o.baseColorFactor;e.color.setRGB(r[0],r[1],r[2],su),e.opacity=r[3]}o.baseColorTexture!==void 0&&a.push(i.assignTexture(e,"map",o.baseColorTexture,QC))}return Promise.all(a)}}class Yq{constructor(e){this.parser=e,this.name=Ci.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const a=this.parser.json.materials[e];if(!a.extensions||!a.extensions[this.name])return Promise.resolve();const o=a.extensions[this.name].emissiveStrength;return o!==void 0&&(t.emissiveIntensity=o),Promise.resolve()}}class zq{constructor(e){this.parser=e,this.name=Ci.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Bl}extendMaterialParams(e,t){const i=this.parser,a=i.json.materials[e];if(!a.extensions||!a.extensions[this.name])return Promise.resolve();const o=[],r=a.extensions[this.name];if(r.clearcoatFactor!==void 0&&(t.clearcoat=r.clearcoatFactor),r.clearcoatTexture!==void 0&&o.push(i.assignTexture(t,"clearcoatMap",r.clearcoatTexture)),r.clearcoatRoughnessFactor!==void 0&&(t.clearcoatRoughness=r.clearcoatRoughnessFactor),r.clearcoatRoughnessTexture!==void 0&&o.push(i.assignTexture(t,"clearcoatRoughnessMap",r.clearcoatRoughnessTexture)),r.clearcoatNormalTexture!==void 0&&(o.push(i.assignTexture(t,"clearcoatNormalMap",r.clearcoatNormalTexture)),r.clearcoatNormalTexture.scale!==void 0)){const s=r.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new Xt(s,s)}return Promise.all(o)}}class Kq{constructor(e){this.parser=e,this.name=Ci.KHR_MATERIALS_DISPERSION}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Bl}extendMaterialParams(e,t){const a=this.parser.json.materials[e];if(!a.extensions||!a.extensions[this.name])return Promise.resolve();const o=a.extensions[this.name];return t.dispersion=o.dispersion!==void 0?o.dispersion:0,Promise.resolve()}}class Lq{constructor(e){this.parser=e,this.name=Ci.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Bl}extendMaterialParams(e,t){const i=this.parser,a=i.json.materials[e];if(!a.extensions||!a.extensions[this.name])return Promise.resolve();const o=[],r=a.extensions[this.name];return r.iridescenceFactor!==void 0&&(t.iridescence=r.iridescenceFactor),r.iridescenceTexture!==void 0&&o.push(i.assignTexture(t,"iridescenceMap",r.iridescenceTexture)),r.iridescenceIor!==void 0&&(t.iridescenceIOR=r.iridescenceIor),t.iridescenceThicknessRange===void 0&&(t.iridescenceThicknessRange=[100,400]),r.iridescenceThicknessMinimum!==void 0&&(t.iridescenceThicknessRange[0]=r.iridescenceThicknessMinimum),r.iridescenceThicknessMaximum!==void 0&&(t.iridescenceThicknessRange[1]=r.iridescenceThicknessMaximum),r.iridescenceThicknessTexture!==void 0&&o.push(i.assignTexture(t,"iridescenceThicknessMap",r.iridescenceThicknessTexture)),Promise.all(o)}}class _q{constructor(e){this.parser=e,this.name=Ci.KHR_MATERIALS_SHEEN}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Bl}extendMaterialParams(e,t){const i=this.parser,a=i.json.materials[e];if(!a.extensions||!a.extensions[this.name])return Promise.resolve();const o=[];t.sheenColor=new dn(0,0,0),t.sheenRoughness=0,t.sheen=1;const r=a.extensions[this.name];if(r.sheenColorFactor!==void 0){const s=r.sheenColorFactor;t.sheenColor.setRGB(s[0],s[1],s[2],su)}return r.sheenRoughnessFactor!==void 0&&(t.sheenRoughness=r.sheenRoughnessFactor),r.sheenColorTexture!==void 0&&o.push(i.assignTexture(t,"sheenColorMap",r.sheenColorTexture,QC)),r.sheenRoughnessTexture!==void 0&&o.push(i.assignTexture(t,"sheenRoughnessMap",r.sheenRoughnessTexture)),Promise.all(o)}}class Dq{constructor(e){this.parser=e,this.name=Ci.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Bl}extendMaterialParams(e,t){const i=this.parser,a=i.json.materials[e];if(!a.extensions||!a.extensions[this.name])return Promise.resolve();const o=[],r=a.extensions[this.name];return r.transmissionFactor!==void 0&&(t.transmission=r.transmissionFactor),r.transmissionTexture!==void 0&&o.push(i.assignTexture(t,"transmissionMap",r.transmissionTexture)),Promise.all(o)}}class Oq{constructor(e){this.parser=e,this.name=Ci.KHR_MATERIALS_VOLUME}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Bl}extendMaterialParams(e,t){const i=this.parser,a=i.json.materials[e];if(!a.extensions||!a.extensions[this.name])return Promise.resolve();const o=[],r=a.extensions[this.name];t.thickness=r.thicknessFactor!==void 0?r.thicknessFactor:0,r.thicknessTexture!==void 0&&o.push(i.assignTexture(t,"thicknessMap",r.thicknessTexture)),t.attenuationDistance=r.attenuationDistance||1/0;const s=r.attenuationColor||[1,1,1];return t.attenuationColor=new dn().setRGB(s[0],s[1],s[2],su),Promise.all(o)}}class Uq{constructor(e){this.parser=e,this.name=Ci.KHR_MATERIALS_IOR}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Bl}extendMaterialParams(e,t){const a=this.parser.json.materials[e];if(!a.extensions||!a.extensions[this.name])return Promise.resolve();const o=a.extensions[this.name];return t.ior=o.ior!==void 0?o.ior:1.5,Promise.resolve()}}class kq{constructor(e){this.parser=e,this.name=Ci.KHR_MATERIALS_SPECULAR}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Bl}extendMaterialParams(e,t){const i=this.parser,a=i.json.materials[e];if(!a.extensions||!a.extensions[this.name])return Promise.resolve();const o=[],r=a.extensions[this.name];t.specularIntensity=r.specularFactor!==void 0?r.specularFactor:1,r.specularTexture!==void 0&&o.push(i.assignTexture(t,"specularIntensityMap",r.specularTexture));const s=r.specularColorFactor||[1,1,1];return t.specularColor=new dn().setRGB(s[0],s[1],s[2],su),r.specularColorTexture!==void 0&&o.push(i.assignTexture(t,"specularColorMap",r.specularColorTexture,QC)),Promise.all(o)}}class Pq{constructor(e){this.parser=e,this.name=Ci.EXT_MATERIALS_BUMP}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Bl}extendMaterialParams(e,t){const i=this.parser,a=i.json.materials[e];if(!a.extensions||!a.extensions[this.name])return Promise.resolve();const o=[],r=a.extensions[this.name];return t.bumpScale=r.bumpFactor!==void 0?r.bumpFactor:1,r.bumpTexture!==void 0&&o.push(i.assignTexture(t,"bumpMap",r.bumpTexture)),Promise.all(o)}}class Jq{constructor(e){this.parser=e,this.name=Ci.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Bl}extendMaterialParams(e,t){const i=this.parser,a=i.json.materials[e];if(!a.extensions||!a.extensions[this.name])return Promise.resolve();const o=[],r=a.extensions[this.name];return r.anisotropyStrength!==void 0&&(t.anisotropy=r.anisotropyStrength),r.anisotropyRotation!==void 0&&(t.anisotropyRotation=r.anisotropyRotation),r.anisotropyTexture!==void 0&&o.push(i.assignTexture(t,"anisotropyMap",r.anisotropyTexture)),Promise.all(o)}}class jq{constructor(e){this.parser=e,this.name=Ci.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,i=t.json,a=i.textures[e];if(!a.extensions||!a.extensions[this.name])return null;const o=a.extensions[this.name],r=t.options.ktx2Loader;if(!r){if(i.extensionsRequired&&i.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,o.source,r)}}class Qq{constructor(e){this.parser=e,this.name=Ci.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,i=this.parser,a=i.json,o=a.textures[e];if(!o.extensions||!o.extensions[t])return null;const r=o.extensions[t],s=a.images[r.source];let l=i.textureLoader;if(s.uri){const c=i.options.manager.getHandler(s.uri);c!==null&&(l=c)}return this.detectSupport().then(function(c){if(c)return i.loadTextureImage(e,r.source,l);if(a.extensionsRequired&&a.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class qq{constructor(e){this.parser=e,this.name=Ci.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,i=this.parser,a=i.json,o=a.textures[e];if(!o.extensions||!o.extensions[t])return null;const r=o.extensions[t],s=a.images[r.source];let l=i.textureLoader;if(s.uri){const c=i.options.manager.getHandler(s.uri);c!==null&&(l=c)}return this.detectSupport().then(function(c){if(c)return i.loadTextureImage(e,r.source,l);if(a.extensionsRequired&&a.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class $q{constructor(e){this.name=Ci.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,i=t.bufferViews[e];if(i.extensions&&i.extensions[this.name]){const a=i.extensions[this.name],o=this.parser.getDependency("buffer",a.buffer),r=this.parser.options.meshoptDecoder;if(!r||!r.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return o.then(function(s){const l=a.byteOffset||0,c=a.byteLength||0,u=a.count,C=a.byteStride,h=new Uint8Array(s,l,c);return r.decodeGltfBufferAsync?r.decodeGltfBufferAsync(u,C,h,a.mode,a.filter).then(function(m){return m.buffer}):r.ready.then(function(){const m=new ArrayBuffer(u*C);return r.decodeGltfBuffer(new Uint8Array(m),u,C,h,a.mode,a.filter),m})})}else return null}}class e${constructor(e){this.name=Ci.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,i=t.nodes[e];if(!i.extensions||!i.extensions[this.name]||i.mesh===void 0)return null;const a=t.meshes[i.mesh];for(const c of a.primitives)if(c.mode!==Al.TRIANGLES&&c.mode!==Al.TRIANGLE_STRIP&&c.mode!==Al.TRIANGLE_FAN&&c.mode!==void 0)return null;const r=i.extensions[this.name].attributes,s=[],l={};for(const c in r)s.push(this.parser.getDependency("accessor",r[c]).then(u=>(l[c]=u,l[c])));return s.length<1?null:(s.push(this.parser.createNodeMesh(e)),Promise.all(s).then(c=>{const u=c.pop(),C=u.isGroup?u.children:[u],h=c[0].count,m=[];for(const p of C){const B=new Vn,b=new Be,y=new eo,S=new Be(1,1,1),R=new nI(p.geometry,p.material,h);for(let Z=0;Z<h;Z++)l.TRANSLATION&&b.fromBufferAttribute(l.TRANSLATION,Z),l.ROTATION&&y.fromBufferAttribute(l.ROTATION,Z),l.SCALE&&S.fromBufferAttribute(l.SCALE,Z),R.setMatrixAt(Z,B.compose(b,y,S));for(const Z in l)if(Z==="_COLOR_0"){const x=l[Z];R.instanceColor=new yd(x.array,x.itemSize,x.normalized)}else Z!=="TRANSLATION"&&Z!=="ROTATION"&&Z!=="SCALE"&&p.geometry.setAttribute(Z,l[Z]);Ii.prototype.copy.call(R,p),this.parser.assignFinalMaterial(R),m.push(R)}return u.isGroup?(u.clear(),u.add(...m),u):m[0]}))}}const CT="glTF",Wm=12,mE={JSON:1313821514,BIN:5130562};class t${constructor(e){this.name=Ci.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,Wm);if(this.header={magic:TB(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==CT)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const i=this.header.length-Wm,a=new DataView(e,Wm);let o=0;for(;o<i;){const r=a.getUint32(o,!0);o+=4;const s=a.getUint32(o,!0);if(o+=4,s===mE.JSON){const l=new Uint8Array(e,Wm+o,r);this.content=TB(l)}else if(s===mE.BIN){const l=Wm+o;this.body=e.slice(l,l+r)}o+=r}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class n${constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=Ci.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const i=this.json,a=this.dracoLoader,o=e.extensions[this.name].bufferView,r=e.extensions[this.name].attributes,s={},l={},c={};for(const u in r){const C=uR[u]||u.toLowerCase();s[C]=r[u]}for(const u in e.attributes){const C=uR[u]||u.toLowerCase();if(r[u]!==void 0){const h=i.accessors[e.attributes[u]],m=uf[h.componentType];c[C]=m.name,l[C]=h.normalized===!0}}return t.getDependency("bufferView",o).then(function(u){return new Promise(function(C,h){a.decodeDracoFile(u,function(m){for(const p in m.attributes){const B=m.attributes[p],b=l[p];b!==void 0&&(B.normalized=b)}C(m)},s,c,su,h)})})}}class i${constructor(){this.name=Ci.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(t.texCoord===void 0||t.texCoord===e.channel)&&t.offset===void 0&&t.rotation===void 0&&t.scale===void 0||(e=e.clone(),t.texCoord!==void 0&&(e.channel=t.texCoord),t.offset!==void 0&&e.offset.fromArray(t.offset),t.rotation!==void 0&&(e.rotation=t.rotation),t.scale!==void 0&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class a${constructor(){this.name=Ci.KHR_MESH_QUANTIZATION}}class IT extends kf{constructor(e,t,i,a){super(e,t,i,a)}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,a=this.valueSize,o=e*a*3+a;for(let r=0;r!==a;r++)t[r]=i[o+r];return t}interpolate_(e,t,i,a){const o=this.resultBuffer,r=this.sampleValues,s=this.valueSize,l=s*2,c=s*3,u=a-t,C=(i-t)/u,h=C*C,m=h*C,p=e*c,B=p-c,b=-2*m+3*h,y=m-h,S=1-b,R=y-h+C;for(let Z=0;Z!==s;Z++){const x=r[B+Z+s],M=r[B+Z+l]*u,E=r[p+Z+s],F=r[p+Z]*u;o[Z]=S*x+R*M+b*E+y*F}return o}}const o$=new eo;class r$ extends IT{interpolate_(e,t,i,a){const o=super.interpolate_(e,t,i,a);return o$.fromArray(o).normalize().toArray(o),o}}const Al={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},uf={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},pE={9728:Mo,9729:Bi,9984:dG,9985:cf,9986:OC,9987:pl},bE={33071:Ka,33648:mf,10497:gu},Sw={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},uR={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",...PG>=152?{TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3"}:{TEXCOORD_0:"uv",TEXCOORD_1:"uv2"},COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},ld={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},s$={CUBICSPLINE:void 0,LINEAR:Gf,STEP:Bf},ww={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function l$(n){return n.DefaultMaterial===void 0&&(n.DefaultMaterial=new Ib({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:dg})),n.DefaultMaterial}function xC(n,e,t){for(const i in t.extensions)n[i]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[i]=t.extensions[i])}function Qg(n,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(n.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function c$(n,e,t){let i=!1,a=!1,o=!1;for(let c=0,u=e.length;c<u;c++){const C=e[c];if(C.POSITION!==void 0&&(i=!0),C.NORMAL!==void 0&&(a=!0),C.COLOR_0!==void 0&&(o=!0),i&&a&&o)break}if(!i&&!a&&!o)return Promise.resolve(n);const r=[],s=[],l=[];for(let c=0,u=e.length;c<u;c++){const C=e[c];if(i){const h=C.POSITION!==void 0?t.getDependency("accessor",C.POSITION):n.attributes.position;r.push(h)}if(a){const h=C.NORMAL!==void 0?t.getDependency("accessor",C.NORMAL):n.attributes.normal;s.push(h)}if(o){const h=C.COLOR_0!==void 0?t.getDependency("accessor",C.COLOR_0):n.attributes.color;l.push(h)}}return Promise.all([Promise.all(r),Promise.all(s),Promise.all(l)]).then(function(c){const u=c[0],C=c[1],h=c[2];return i&&(n.morphAttributes.position=u),a&&(n.morphAttributes.normal=C),o&&(n.morphAttributes.color=h),n.morphTargetsRelative=!0,n})}function g$(n,e){if(n.updateMorphTargets(),e.weights!==void 0)for(let t=0,i=e.weights.length;t<i;t++)n.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(n.morphTargetInfluences.length===t.length){n.morphTargetDictionary={};for(let i=0,a=t.length;i<a;i++)n.morphTargetDictionary[t[i]]=i}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function u$(n){let e;const t=n.extensions&&n.extensions[Ci.KHR_DRACO_MESH_COMPRESSION];if(t?e="draco:"+t.bufferView+":"+t.indices+":"+Rw(t.attributes):e=n.indices+":"+Rw(n.attributes)+":"+n.mode,n.targets!==void 0)for(let i=0,a=n.targets.length;i<a;i++)e+=":"+Rw(n.targets[i]);return e}function Rw(n){let e="";const t=Object.keys(n).sort();for(let i=0,a=t.length;i<a;i++)e+=t[i]+":"+n[t[i]]+";";return e}function dR(n){switch(n){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function d$(n){return n.search(/\.jpe?g($|\?)/i)>0||n.search(/^data\:image\/jpeg/)===0?"image/jpeg":n.search(/\.webp($|\?)/i)>0||n.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const C$=new Vn;class I${constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new Fq,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let i=!1,a=!1,o=-1;typeof navigator<"u"&&typeof navigator.userAgent<"u"&&(i=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,a=navigator.userAgent.indexOf("Firefox")>-1,o=a?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||i||a&&o<98?this.textureLoader=new fX(this.options.manager):this.textureLoader=new BX(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new ko(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const i=this,a=this.json,o=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(r){return r._markDefs&&r._markDefs()}),Promise.all(this._invokeAll(function(r){return r.beforeRoot&&r.beforeRoot()})).then(function(){return Promise.all([i.getDependencies("scene"),i.getDependencies("animation"),i.getDependencies("camera")])}).then(function(r){const s={scene:r[0][a.scene||0],scenes:r[0],animations:r[1],cameras:r[2],asset:a.asset,parser:i,userData:{}};return xC(o,s,a),Qg(s,a),Promise.all(i._invokeAll(function(l){return l.afterRoot&&l.afterRoot(s)})).then(function(){for(const l of s.scenes)l.updateMatrixWorld();e(s)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],i=this.json.meshes||[];for(let a=0,o=t.length;a<o;a++){const r=t[a].joints;for(let s=0,l=r.length;s<l;s++)e[r[s]].isBone=!0}for(let a=0,o=e.length;a<o;a++){const r=e[a];r.mesh!==void 0&&(this._addNodeRef(this.meshCache,r.mesh),r.skin!==void 0&&(i[r.mesh].isSkinnedMesh=!0)),r.camera!==void 0&&this._addNodeRef(this.cameraCache,r.camera)}}_addNodeRef(e,t){t!==void 0&&(e.refs[t]===void 0&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,i){if(e.refs[t]<=1)return i;const a=i.clone(),o=(r,s)=>{const l=this.associations.get(r);l!=null&&this.associations.set(s,l);for(const[c,u]of r.children.entries())o(u,s.children[c])};return o(i,a),a.name+="_instance_"+e.uses[t]++,a}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let i=0;i<t.length;i++){const a=e(t[i]);if(a)return a}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const i=[];for(let a=0;a<t.length;a++){const o=e(t[a]);o&&i.push(o)}return i}getDependency(e,t){const i=e+":"+t;let a=this.cache.get(i);if(!a){switch(e){case"scene":a=this.loadScene(t);break;case"node":a=this._invokeOne(function(o){return o.loadNode&&o.loadNode(t)});break;case"mesh":a=this._invokeOne(function(o){return o.loadMesh&&o.loadMesh(t)});break;case"accessor":a=this.loadAccessor(t);break;case"bufferView":a=this._invokeOne(function(o){return o.loadBufferView&&o.loadBufferView(t)});break;case"buffer":a=this.loadBuffer(t);break;case"material":a=this._invokeOne(function(o){return o.loadMaterial&&o.loadMaterial(t)});break;case"texture":a=this._invokeOne(function(o){return o.loadTexture&&o.loadTexture(t)});break;case"skin":a=this.loadSkin(t);break;case"animation":a=this._invokeOne(function(o){return o.loadAnimation&&o.loadAnimation(t)});break;case"camera":a=this.loadCamera(t);break;default:if(a=this._invokeOne(function(o){return o!=this&&o.getDependency&&o.getDependency(e,t)}),!a)throw new Error("Unknown type: "+e);break}this.cache.add(i,a)}return a}getDependencies(e){let t=this.cache.get(e);if(!t){const i=this,a=this.json[e+(e==="mesh"?"es":"s")]||[];t=Promise.all(a.map(function(o,r){return i.getDependency(e,r)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],i=this.fileLoader;if(t.type&&t.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(t.uri===void 0&&e===0)return Promise.resolve(this.extensions[Ci.KHR_BINARY_GLTF].body);const a=this.options;return new Promise(function(o,r){i.load(Ad.resolveURL(t.uri,a.path),o,void 0,function(){r(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(i){const a=t.byteLength||0,o=t.byteOffset||0;return i.slice(o,o+a)})}loadAccessor(e){const t=this,i=this.json,a=this.json.accessors[e];if(a.bufferView===void 0&&a.sparse===void 0){const r=Sw[a.type],s=uf[a.componentType],l=a.normalized===!0,c=new s(a.count*r);return Promise.resolve(new Mi(c,r,l))}const o=[];return a.bufferView!==void 0?o.push(this.getDependency("bufferView",a.bufferView)):o.push(null),a.sparse!==void 0&&(o.push(this.getDependency("bufferView",a.sparse.indices.bufferView)),o.push(this.getDependency("bufferView",a.sparse.values.bufferView))),Promise.all(o).then(function(r){const s=r[0],l=Sw[a.type],c=uf[a.componentType],u=c.BYTES_PER_ELEMENT,C=u*l,h=a.byteOffset||0,m=a.bufferView!==void 0?i.bufferViews[a.bufferView].byteStride:void 0,p=a.normalized===!0;let B,b;if(m&&m!==C){const y=Math.floor(h/m),S="InterleavedBuffer:"+a.bufferView+":"+a.componentType+":"+y+":"+a.count;let R=t.cache.get(S);R||(B=new c(s,y*m,a.count*m/u),R=new lb(B,m/u),t.cache.add(S,R)),b=new vd(R,l,h%m/u,p)}else s===null?B=new c(a.count*l):B=new c(s,h,a.count*l),b=new Mi(B,l,p);if(a.sparse!==void 0){const y=Sw.SCALAR,S=uf[a.sparse.indices.componentType],R=a.sparse.indices.byteOffset||0,Z=a.sparse.values.byteOffset||0,x=new S(r[1],R,a.sparse.count*y),M=new c(r[2],Z,a.sparse.count*l);s!==null&&(b=new Mi(b.array.slice(),b.itemSize,b.normalized));for(let E=0,F=x.length;E<F;E++){const N=x[E];if(b.setX(N,M[E*l]),l>=2&&b.setY(N,M[E*l+1]),l>=3&&b.setZ(N,M[E*l+2]),l>=4&&b.setW(N,M[E*l+3]),l>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return b})}loadTexture(e){const t=this.json,i=this.options,o=t.textures[e].source,r=t.images[o];let s=this.textureLoader;if(r.uri){const l=i.manager.getHandler(r.uri);l!==null&&(s=l)}return this.loadTextureImage(e,o,s)}loadTextureImage(e,t,i){const a=this,o=this.json,r=o.textures[e],s=o.images[t],l=(s.uri||s.bufferView)+":"+r.sampler;if(this.textureCache[l])return this.textureCache[l];const c=this.loadImageSource(t,i).then(function(u){u.flipY=!1,u.name=r.name||s.name||"",u.name===""&&typeof s.uri=="string"&&s.uri.startsWith("data:image/")===!1&&(u.name=s.uri);const h=(o.samplers||{})[r.sampler]||{};return u.magFilter=pE[h.magFilter]||Bi,u.minFilter=pE[h.minFilter]||pl,u.wrapS=bE[h.wrapS]||gu,u.wrapT=bE[h.wrapT]||gu,a.associations.set(u,{textures:e}),u}).catch(function(){return null});return this.textureCache[l]=c,c}loadImageSource(e,t){const i=this,a=this.json,o=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(C=>C.clone());const r=a.images[e],s=self.URL||self.webkitURL;let l=r.uri||"",c=!1;if(r.bufferView!==void 0)l=i.getDependency("bufferView",r.bufferView).then(function(C){c=!0;const h=new Blob([C],{type:r.mimeType});return l=s.createObjectURL(h),l});else if(r.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const u=Promise.resolve(l).then(function(C){return new Promise(function(h,m){let p=h;t.isImageBitmapLoader===!0&&(p=function(B){const b=new Fi(B);b.needsUpdate=!0,h(b)}),t.load(Ad.resolveURL(C,o.path),p,void 0,m)})}).then(function(C){return c===!0&&s.revokeObjectURL(l),Qg(C,r),C.userData.mimeType=r.mimeType||d$(r.uri),C}).catch(function(C){throw console.error("THREE.GLTFLoader: Couldn't load texture",l),C});return this.sourceCache[e]=u,u}assignTexture(e,t,i,a){const o=this;return this.getDependency("texture",i.index).then(function(r){if(!r)return null;if(i.texCoord!==void 0&&i.texCoord>0&&(r=r.clone(),r.channel=i.texCoord),o.extensions[Ci.KHR_TEXTURE_TRANSFORM]){const s=i.extensions!==void 0?i.extensions[Ci.KHR_TEXTURE_TRANSFORM]:void 0;if(s){const l=o.associations.get(r);r=o.extensions[Ci.KHR_TEXTURE_TRANSFORM].extendTexture(r,s),o.associations.set(r,l)}}return a!==void 0&&(typeof a=="number"&&(a=a===AE?QC:su),"colorSpace"in r?r.colorSpace=a:r.encoding=a===QC?AE:Hq),e[t]=r,r})}assignFinalMaterial(e){const t=e.geometry;let i=e.material;const a=t.attributes.tangent===void 0,o=t.attributes.color!==void 0,r=t.attributes.normal===void 0;if(e.isPoints){const s="PointsMaterial:"+i.uuid;let l=this.cache.get(s);l||(l=new RG,ho.prototype.copy.call(l,i),l.color.copy(i.color),l.map=i.map,l.sizeAttenuation=!1,this.cache.add(s,l)),i=l}else if(e.isLine){const s="LineBasicMaterial:"+i.uuid;let l=this.cache.get(s);l||(l=new Ar,ho.prototype.copy.call(l,i),l.color.copy(i.color),l.map=i.map,this.cache.add(s,l)),i=l}if(a||o||r){let s="ClonedMaterial:"+i.uuid+":";a&&(s+="derivative-tangents:"),o&&(s+="vertex-colors:"),r&&(s+="flat-shading:");let l=this.cache.get(s);l||(l=i.clone(),o&&(l.vertexColors=!0),r&&(l.flatShading=!0),a&&(l.normalScale&&(l.normalScale.y*=-1),l.clearcoatNormalScale&&(l.clearcoatNormalScale.y*=-1)),this.cache.add(s,l),this.associations.set(l,this.associations.get(i))),i=l}e.material=i}getMaterialType(){return Ib}loadMaterial(e){const t=this,i=this.json,a=this.extensions,o=i.materials[e];let r;const s={},l=o.extensions||{},c=[];if(l[Ci.KHR_MATERIALS_UNLIT]){const C=a[Ci.KHR_MATERIALS_UNLIT];r=C.getMaterialType(),c.push(C.extendParams(s,o,t))}else{const C=o.pbrMetallicRoughness||{};if(s.color=new dn(1,1,1),s.opacity=1,Array.isArray(C.baseColorFactor)){const h=C.baseColorFactor;s.color.setRGB(h[0],h[1],h[2],su),s.opacity=h[3]}C.baseColorTexture!==void 0&&c.push(t.assignTexture(s,"map",C.baseColorTexture,QC)),s.metalness=C.metallicFactor!==void 0?C.metallicFactor:1,s.roughness=C.roughnessFactor!==void 0?C.roughnessFactor:1,C.metallicRoughnessTexture!==void 0&&(c.push(t.assignTexture(s,"metalnessMap",C.metallicRoughnessTexture)),c.push(t.assignTexture(s,"roughnessMap",C.metallicRoughnessTexture))),r=this._invokeOne(function(h){return h.getMaterialType&&h.getMaterialType(e)}),c.push(Promise.all(this._invokeAll(function(h){return h.extendMaterialParams&&h.extendMaterialParams(e,s)})))}o.doubleSided===!0&&(s.side=ms);const u=o.alphaMode||ww.OPAQUE;if(u===ww.BLEND?(s.transparent=!0,s.depthWrite=!1):(s.transparent=!1,u===ww.MASK&&(s.alphaTest=o.alphaCutoff!==void 0?o.alphaCutoff:.5)),o.normalTexture!==void 0&&r!==Or&&(c.push(t.assignTexture(s,"normalMap",o.normalTexture)),s.normalScale=new Xt(1,1),o.normalTexture.scale!==void 0)){const C=o.normalTexture.scale;s.normalScale.set(C,C)}if(o.occlusionTexture!==void 0&&r!==Or&&(c.push(t.assignTexture(s,"aoMap",o.occlusionTexture)),o.occlusionTexture.strength!==void 0&&(s.aoMapIntensity=o.occlusionTexture.strength)),o.emissiveFactor!==void 0&&r!==Or){const C=o.emissiveFactor;s.emissive=new dn().setRGB(C[0],C[1],C[2],su)}return o.emissiveTexture!==void 0&&r!==Or&&c.push(t.assignTexture(s,"emissiveMap",o.emissiveTexture,QC)),Promise.all(c).then(function(){const C=new r(s);return o.name&&(C.name=o.name),Qg(C,o),t.associations.set(C,{materials:e}),o.extensions&&xC(a,C,o),C})}createUniqueName(e){const t=Ri.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){const t=this,i=this.extensions,a=this.primitiveCache;function o(s){return i[Ci.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(s,t).then(function(l){return vE(l,s,t)})}const r=[];for(let s=0,l=e.length;s<l;s++){const c=e[s],u=u$(c),C=a[u];if(C)r.push(C.promise);else{let h;c.extensions&&c.extensions[Ci.KHR_DRACO_MESH_COMPRESSION]?h=o(c):h=vE(new $n,c,t),a[u]={primitive:c,promise:h},r.push(h)}}return Promise.all(r)}loadMesh(e){const t=this,i=this.json,a=this.extensions,o=i.meshes[e],r=o.primitives,s=[];for(let l=0,c=r.length;l<c;l++){const u=r[l].material===void 0?l$(this.cache):this.getDependency("material",r[l].material);s.push(u)}return s.push(t.loadGeometries(r)),Promise.all(s).then(function(l){const c=l.slice(0,l.length-1),u=l[l.length-1],C=[];for(let m=0,p=u.length;m<p;m++){const B=u[m],b=r[m];let y;const S=c[m];if(b.mode===Al.TRIANGLES||b.mode===Al.TRIANGLE_STRIP||b.mode===Al.TRIANGLE_FAN||b.mode===void 0)y=o.isSkinnedMesh===!0?new ux(B,S):new $i(B,S),y.isSkinnedMesh===!0&&y.normalizeSkinWeights(),b.mode===Al.TRIANGLE_STRIP?y.geometry=CE(y.geometry,ix):b.mode===Al.TRIANGLE_FAN&&(y.geometry=CE(y.geometry,xB));else if(b.mode===Al.LINES)y=new Ac(B,S);else if(b.mode===Al.LINE_STRIP)y=new uu(B,S);else if(b.mode===Al.LINE_LOOP)y=new Cx(B,S);else if(b.mode===Al.POINTS)y=new Ix(B,S);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+b.mode);Object.keys(y.geometry.morphAttributes).length>0&&g$(y,o),y.name=t.createUniqueName(o.name||"mesh_"+e),Qg(y,o),b.extensions&&xC(a,y,b),t.assignFinalMaterial(y),C.push(y)}for(let m=0,p=C.length;m<p;m++)t.associations.set(C[m],{meshes:e,primitives:m});if(C.length===1)return o.extensions&&xC(a,C[0],o),C[0];const h=new tu;o.extensions&&xC(a,h,o),t.associations.set(h,{meshes:e});for(let m=0,p=C.length;m<p;m++)h.add(C[m]);return h})}loadCamera(e){let t;const i=this.json.cameras[e],a=i[i.type];if(!a){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return i.type==="perspective"?t=new fa(M9.radToDeg(a.yfov),a.aspectRatio||1,a.znear||1,a.zfar||2e6):i.type==="orthographic"&&(t=new bl(-a.xmag,a.xmag,a.ymag,-a.ymag,a.znear,a.zfar)),i.name&&(t.name=this.createUniqueName(i.name)),Qg(t,i),Promise.resolve(t)}loadSkin(e){const t=this.json.skins[e],i=[];for(let a=0,o=t.joints.length;a<o;a++)i.push(this._loadNodeShallow(t.joints[a]));return t.inverseBindMatrices!==void 0?i.push(this.getDependency("accessor",t.inverseBindMatrices)):i.push(null),Promise.all(i).then(function(a){const o=a.pop(),r=a,s=[],l=[];for(let c=0,u=r.length;c<u;c++){const C=r[c];if(C){s.push(C);const h=new Vn;o!==null&&h.fromArray(o.array,c*16),l.push(h)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[c])}return new dx(s,l)})}loadAnimation(e){const t=this.json,i=this,a=t.animations[e],o=a.name?a.name:"animation_"+e,r=[],s=[],l=[],c=[],u=[];for(let C=0,h=a.channels.length;C<h;C++){const m=a.channels[C],p=a.samplers[m.sampler],B=m.target,b=B.node,y=a.parameters!==void 0?a.parameters[p.input]:p.input,S=a.parameters!==void 0?a.parameters[p.output]:p.output;B.node!==void 0&&(r.push(this.getDependency("node",b)),s.push(this.getDependency("accessor",y)),l.push(this.getDependency("accessor",S)),c.push(p),u.push(B))}return Promise.all([Promise.all(r),Promise.all(s),Promise.all(l),Promise.all(c),Promise.all(u)]).then(function(C){const h=C[0],m=C[1],p=C[2],B=C[3],b=C[4],y=[];for(let S=0,R=h.length;S<R;S++){const Z=h[S],x=m[S],M=p[S],E=B[S],F=b[S];if(Z===void 0)continue;Z.updateMatrix&&Z.updateMatrix();const N=i._createAnimationTracks(Z,x,M,E,F);if(N)for(let H=0;H<N.length;H++)y.push(N[H])}return new xf(o,void 0,y)})}createNodeMesh(e){const t=this.json,i=this,a=t.nodes[e];return a.mesh===void 0?null:i.getDependency("mesh",a.mesh).then(function(o){const r=i._getNodeRef(i.meshCache,a.mesh,o);return a.weights!==void 0&&r.traverse(function(s){if(s.isMesh)for(let l=0,c=a.weights.length;l<c;l++)s.morphTargetInfluences[l]=a.weights[l]}),r})}loadNode(e){const t=this.json,i=this,a=t.nodes[e],o=i._loadNodeShallow(e),r=[],s=a.children||[];for(let c=0,u=s.length;c<u;c++)r.push(i.getDependency("node",s[c]));const l=a.skin===void 0?Promise.resolve(null):i.getDependency("skin",a.skin);return Promise.all([o,Promise.all(r),l]).then(function(c){const u=c[0],C=c[1],h=c[2];h!==null&&u.traverse(function(m){m.isSkinnedMesh&&m.bind(h,C$)});for(let m=0,p=C.length;m<p;m++)u.add(C[m]);return u})}_loadNodeShallow(e){const t=this.json,i=this.extensions,a=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];const o=t.nodes[e],r=o.name?a.createUniqueName(o.name):"",s=[],l=a._invokeOne(function(c){return c.createNodeMesh&&c.createNodeMesh(e)});return l&&s.push(l),o.camera!==void 0&&s.push(a.getDependency("camera",o.camera).then(function(c){return a._getNodeRef(a.cameraCache,o.camera,c)})),a._invokeAll(function(c){return c.createNodeAttachment&&c.createNodeAttachment(e)}).forEach(function(c){s.push(c)}),this.nodeCache[e]=Promise.all(s).then(function(c){let u;if(o.isBone===!0?u=new wG:c.length>1?u=new tu:c.length===1?u=c[0]:u=new Ii,u!==c[0])for(let C=0,h=c.length;C<h;C++)u.add(c[C]);if(o.name&&(u.userData.name=o.name,u.name=r),Qg(u,o),o.extensions&&xC(i,u,o),o.matrix!==void 0){const C=new Vn;C.fromArray(o.matrix),u.applyMatrix4(C)}else o.translation!==void 0&&u.position.fromArray(o.translation),o.rotation!==void 0&&u.quaternion.fromArray(o.rotation),o.scale!==void 0&&u.scale.fromArray(o.scale);return a.associations.has(u)||a.associations.set(u,{}),a.associations.get(u).nodes=e,u}),this.nodeCache[e]}loadScene(e){const t=this.extensions,i=this.json.scenes[e],a=this,o=new tu;i.name&&(o.name=a.createUniqueName(i.name)),Qg(o,i),i.extensions&&xC(t,o,i);const r=i.nodes||[],s=[];for(let l=0,c=r.length;l<c;l++)s.push(a.getDependency("node",r[l]));return Promise.all(s).then(function(l){for(let u=0,C=l.length;u<C;u++)o.add(l[u]);const c=u=>{const C=new Map;for(const[h,m]of a.associations)(h instanceof ho||h instanceof Fi)&&C.set(h,m);return u.traverse(h=>{const m=a.associations.get(h);m!=null&&C.set(h,m)}),C};return a.associations=c(o),o})}_createAnimationTracks(e,t,i,a,o){const r=[],s=e.name?e.name:e.uuid,l=[];ld[o.path]===ld.weights?e.traverse(function(h){h.morphTargetInfluences&&l.push(h.name?h.name:h.uuid)}):l.push(s);let c;switch(ld[o.path]){case ld.weights:c=cI;break;case ld.rotation:c=gI;break;case ld.position:case ld.scale:c=uI;break;default:switch(i.itemSize){case 1:c=cI;break;case 2:case 3:default:c=uI;break}break}const u=a.interpolation!==void 0?s$[a.interpolation]:Gf,C=this._getArrayFromAccessor(i);for(let h=0,m=l.length;h<m;h++){const p=new c(l[h]+"."+ld[o.path],t.array,C,u);a.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(p),r.push(p)}return r}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){const i=dR(t.constructor),a=new Float32Array(t.length);for(let o=0,r=t.length;o<r;o++)a[o]=t[o]*i;t=a}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(i){const a=this instanceof gI?r$:IT;return new a(this.times,this.values,this.getValueSize()/3,i)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function h$(n,e,t){const i=e.attributes,a=new Wo;if(i.POSITION!==void 0){const s=t.json.accessors[i.POSITION],l=s.min,c=s.max;if(l!==void 0&&c!==void 0){if(a.set(new Be(l[0],l[1],l[2]),new Be(c[0],c[1],c[2])),s.normalized){const u=dR(uf[s.componentType]);a.min.multiplyScalar(u),a.max.multiplyScalar(u)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const o=e.targets;if(o!==void 0){const s=new Be,l=new Be;for(let c=0,u=o.length;c<u;c++){const C=o[c];if(C.POSITION!==void 0){const h=t.json.accessors[C.POSITION],m=h.min,p=h.max;if(m!==void 0&&p!==void 0){if(l.setX(Math.max(Math.abs(m[0]),Math.abs(p[0]))),l.setY(Math.max(Math.abs(m[1]),Math.abs(p[1]))),l.setZ(Math.max(Math.abs(m[2]),Math.abs(p[2]))),h.normalized){const B=dR(uf[h.componentType]);l.multiplyScalar(B)}s.max(l)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}a.expandByVector(s)}n.boundingBox=a;const r=new Vo;a.getCenter(r.center),r.radius=a.min.distanceTo(a.max)/2,n.boundingSphere=r}function vE(n,e,t){const i=e.attributes,a=[];function o(r,s){return t.getDependency("accessor",r).then(function(l){n.setAttribute(s,l)})}for(const r in i){const s=uR[r]||r.toLowerCase();s in n.attributes||a.push(o(i[r],s))}if(e.indices!==void 0&&!n.index){const r=t.getDependency("accessor",e.indices).then(function(s){n.setIndex(s)});a.push(r)}return Qg(n,e),h$(n,e,t),Promise.all(a).then(function(){return e.targets!==void 0?c$(n,e.targets,t):n})}class f$ extends Gx{constructor(e){super(e),this.type=Co}parse(e){const r=function(F,N){switch(F){case 1:throw new Error("THREE.RGBELoader: Read Error: "+(N||""));case 2:throw new Error("THREE.RGBELoader: Write Error: "+(N||""));case 3:throw new Error("THREE.RGBELoader: Bad File Format: "+(N||""));default:case 4:throw new Error("THREE.RGBELoader: Memory Error: "+(N||""))}},u=`
`,C=function(F,N,H){N=N||1024;let _=F.pos,D=-1,P=0,$="",X=String.fromCharCode.apply(null,new Uint16Array(F.subarray(_,_+128)));for(;0>(D=X.indexOf(u))&&P<N&&_<F.byteLength;)$+=X,P+=X.length,_+=128,X+=String.fromCharCode.apply(null,new Uint16Array(F.subarray(_,_+128)));return-1<D?(F.pos+=P+D+1,$+X.slice(0,D)):!1},h=function(F){const N=/^#\?(\S+)/,H=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,z=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,_=/^\s*FORMAT=(\S+)\s*$/,D=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,P={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let $,X;for((F.pos>=F.byteLength||!($=C(F)))&&r(1,"no header found"),(X=$.match(N))||r(3,"bad initial token"),P.valid|=1,P.programtype=X[1],P.string+=$+`
`;$=C(F),$!==!1;){if(P.string+=$+`
`,$.charAt(0)==="#"){P.comments+=$+`
`;continue}if((X=$.match(H))&&(P.gamma=parseFloat(X[1])),(X=$.match(z))&&(P.exposure=parseFloat(X[1])),(X=$.match(_))&&(P.valid|=2,P.format=X[1]),(X=$.match(D))&&(P.valid|=4,P.height=parseInt(X[1],10),P.width=parseInt(X[2],10)),P.valid&2&&P.valid&4)break}return P.valid&2||r(3,"missing format specifier"),P.valid&4||r(3,"missing image size specifier"),P},m=function(F,N,H){const z=N;if(z<8||z>32767||F[0]!==2||F[1]!==2||F[2]&128)return new Uint8Array(F);z!==(F[2]<<8|F[3])&&r(3,"wrong scanline width");const _=new Uint8Array(4*N*H);_.length||r(4,"unable to allocate buffer space");let D=0,P=0;const $=4*z,X=new Uint8Array(4),L=new Uint8Array($);let U=H;for(;U>0&&P<F.byteLength;){P+4>F.byteLength&&r(1),X[0]=F[P++],X[1]=F[P++],X[2]=F[P++],X[3]=F[P++],(X[0]!=2||X[1]!=2||(X[2]<<8|X[3])!=z)&&r(3,"bad rgbe scanline format");let q=0,K;for(;q<$&&P<F.byteLength;){K=F[P++];const j=K>128;if(j&&(K-=128),(K===0||q+K>$)&&r(3,"bad scanline data"),j){const ne=F[P++];for(let k=0;k<K;k++)L[q++]=ne}else L.set(F.subarray(P,P+K),q),q+=K,P+=K}const O=z;for(let j=0;j<O;j++){let ne=0;_[D]=L[j+ne],ne+=z,_[D+1]=L[j+ne],ne+=z,_[D+2]=L[j+ne],ne+=z,_[D+3]=L[j+ne],D+=4}U--}return _},p=function(F,N,H,z){const _=F[N+3],D=Math.pow(2,_-128)/255;H[z+0]=F[N+0]*D,H[z+1]=F[N+1]*D,H[z+2]=F[N+2]*D,H[z+3]=1},B=function(F,N,H,z){const _=F[N+3],D=Math.pow(2,_-128)/255;H[z+0]=PC.toHalfFloat(Math.min(F[N+0]*D,65504)),H[z+1]=PC.toHalfFloat(Math.min(F[N+1]*D,65504)),H[z+2]=PC.toHalfFloat(Math.min(F[N+2]*D,65504)),H[z+3]=PC.toHalfFloat(1)},b=new Uint8Array(e);b.pos=0;const y=h(b),S=y.width,R=y.height,Z=m(b.subarray(b.pos),S,R);let x,M,E;switch(this.type){case ma:E=Z.length/4;const F=new Float32Array(E*4);for(let H=0;H<E;H++)p(Z,H*4,F,H*4);x=F,M=ma;break;case Co:E=Z.length/4;const N=new Uint16Array(E*4);for(let H=0;H<E;H++)B(Z,H*4,N,H*4);x=N,M=Co;break;default:throw new Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:S,height:R,data:x,header:y.string,gamma:y.gamma,exposure:y.exposure,type:M}}setDataType(e){return this.type=e,this}load(e,t,i,a){function o(r,s){switch(r.type){case ma:case Co:"colorSpace"in r?r.colorSpace="srgb-linear":r.encoding=3e3,r.minFilter=Bi,r.magFilter=Bi,r.generateMipmaps=!1,r.flipY=!0;break}t&&t(r,s)}return super.load(e,o,i,a)}}const Vm=PG>=152;class A$ extends Gx{constructor(e){super(e),this.type=Co}parse(e){const N=Math.pow(2.7182818,2.2);function H(ae,ue){for(var Fe=0,ot=0;ot<65536;++ot)(ot==0||ae[ot>>3]&1<<(ot&7))&&(ue[Fe++]=ot);for(var at=Fe-1;Fe<65536;)ue[Fe++]=0;return at}function z(ae){for(var ue=0;ue<16384;ue++)ae[ue]={},ae[ue].len=0,ae[ue].lit=0,ae[ue].p=null}const _={l:0,c:0,lc:0};function D(ae,ue,Fe,ot,at){for(;Fe<ae;)ue=ue<<8|ke(ot,at),Fe+=8;Fe-=ae,_.l=ue>>Fe&(1<<ae)-1,_.c=ue,_.lc=Fe}const P=new Array(59);function $(ae){for(var ue=0;ue<=58;++ue)P[ue]=0;for(var ue=0;ue<65537;++ue)P[ae[ue]]+=1;for(var Fe=0,ue=58;ue>0;--ue){var ot=Fe+P[ue]>>1;P[ue]=Fe,Fe=ot}for(var ue=0;ue<65537;++ue){var at=ae[ue];at>0&&(ae[ue]=at|P[at]++<<6)}}function X(ae,ue,Fe,ot,at,It,Wt){for(var xt=Fe,te=0,Ie=0;at<=It;at++){if(xt.value-Fe.value>ot)return!1;D(6,te,Ie,ae,xt);var Ae=_.l;if(te=_.c,Ie=_.lc,Wt[at]=Ae,Ae==63){if(xt.value-Fe.value>ot)throw"Something wrong with hufUnpackEncTable";D(8,te,Ie,ae,xt);var se=_.l+6;if(te=_.c,Ie=_.lc,at+se>It+1)throw"Something wrong with hufUnpackEncTable";for(;se--;)Wt[at++]=0;at--}else if(Ae>=59){var se=Ae-59+2;if(at+se>It+1)throw"Something wrong with hufUnpackEncTable";for(;se--;)Wt[at++]=0;at--}}$(Wt)}function L(ae){return ae&63}function U(ae){return ae>>6}function q(ae,ue,Fe,ot){for(;ue<=Fe;ue++){var at=U(ae[ue]),It=L(ae[ue]);if(at>>It)throw"Invalid table entry";if(It>14){var Wt=ot[at>>It-14];if(Wt.len)throw"Invalid table entry";if(Wt.lit++,Wt.p){var xt=Wt.p;Wt.p=new Array(Wt.lit);for(var te=0;te<Wt.lit-1;++te)Wt.p[te]=xt[te]}else Wt.p=new Array(1);Wt.p[Wt.lit-1]=ue}else if(It)for(var Ie=0,te=1<<14-It;te>0;te--){var Wt=ot[(at<<14-It)+Ie];if(Wt.len||Wt.p)throw"Invalid table entry";Wt.len=It,Wt.lit=ue,Ie++}}return!0}const K={c:0,lc:0};function O(ae,ue,Fe,ot){ae=ae<<8|ke(Fe,ot),ue+=8,K.c=ae,K.lc=ue}const j={c:0,lc:0};function ne(ae,ue,Fe,ot,at,It,Wt,xt,te,Ie){if(ae==ue){ot<8&&(O(Fe,ot,at,Wt),Fe=K.c,ot=K.lc),ot-=8;var Ae=Fe>>ot,Ae=new Uint8Array([Ae])[0];if(te.value+Ae>Ie)return!1;for(var se=xt[te.value-1];Ae-- >0;)xt[te.value++]=se}else if(te.value<Ie)xt[te.value++]=ae;else return!1;j.c=Fe,j.lc=ot}function k(ae){return ae&65535}function ie(ae){var ue=k(ae);return ue>32767?ue-65536:ue}const re={a:0,b:0};function ge(ae,ue){var Fe=ie(ae),ot=ie(ue),at=ot,It=Fe+(at&1)+(at>>1),Wt=It,xt=It-at;re.a=Wt,re.b=xt}function de(ae,ue){var Fe=k(ae),ot=k(ue),at=Fe-(ot>>1)&65535,It=ot+at-32768&65535;re.a=It,re.b=at}function xe(ae,ue,Fe,ot,at,It,Wt){for(var xt=Wt<16384,te=Fe>at?at:Fe,Ie=1,Ae;Ie<=te;)Ie<<=1;for(Ie>>=1,Ae=Ie,Ie>>=1;Ie>=1;){for(var se=0,Re=se+It*(at-Ae),Ue=It*Ie,nt=It*Ae,pt=ot*Ie,it=ot*Ae,Bt,Mt,Yt,ln;se<=Re;se+=nt){for(var on=se,vn=se+ot*(Fe-Ae);on<=vn;on+=it){var nn=on+pt,mn=on+Ue,gn=mn+pt;xt?(ge(ae[on+ue],ae[mn+ue]),Bt=re.a,Yt=re.b,ge(ae[nn+ue],ae[gn+ue]),Mt=re.a,ln=re.b,ge(Bt,Mt),ae[on+ue]=re.a,ae[nn+ue]=re.b,ge(Yt,ln),ae[mn+ue]=re.a,ae[gn+ue]=re.b):(de(ae[on+ue],ae[mn+ue]),Bt=re.a,Yt=re.b,de(ae[nn+ue],ae[gn+ue]),Mt=re.a,ln=re.b,de(Bt,Mt),ae[on+ue]=re.a,ae[nn+ue]=re.b,de(Yt,ln),ae[mn+ue]=re.a,ae[gn+ue]=re.b)}if(Fe&Ie){var mn=on+Ue;xt?ge(ae[on+ue],ae[mn+ue]):de(ae[on+ue],ae[mn+ue]),Bt=re.a,ae[mn+ue]=re.b,ae[on+ue]=Bt}}if(at&Ie)for(var on=se,vn=se+ot*(Fe-Ae);on<=vn;on+=it){var nn=on+pt;xt?ge(ae[on+ue],ae[nn+ue]):de(ae[on+ue],ae[nn+ue]),Bt=re.a,ae[nn+ue]=re.b,ae[on+ue]=Bt}Ae=Ie,Ie>>=1}return se}function Ne(ae,ue,Fe,ot,at,It,Wt,xt,te,Ie){for(var Ae=0,se=0,Re=xt,Ue=Math.trunc(at.value+(It+7)/8);at.value<Ue;)for(O(Ae,se,Fe,at),Ae=K.c,se=K.lc;se>=14;){var nt=Ae>>se-14&16383,pt=ue[nt];if(pt.len)se-=pt.len,ne(pt.lit,Wt,Ae,se,Fe,ot,at,te,Ie,Re),Ae=j.c,se=j.lc;else{if(!pt.p)throw"hufDecode issues";var it;for(it=0;it<pt.lit;it++){for(var Bt=L(ae[pt.p[it]]);se<Bt&&at.value<Ue;)O(Ae,se,Fe,at),Ae=K.c,se=K.lc;if(se>=Bt&&U(ae[pt.p[it]])==(Ae>>se-Bt&(1<<Bt)-1)){se-=Bt,ne(pt.p[it],Wt,Ae,se,Fe,ot,at,te,Ie,Re),Ae=j.c,se=j.lc;break}}if(it==pt.lit)throw"hufDecode issues"}}var Mt=8-It&7;for(Ae>>=Mt,se-=Mt;se>0;){var pt=ue[Ae<<14-se&16383];if(pt.len)se-=pt.len,ne(pt.lit,Wt,Ae,se,Fe,ot,at,te,Ie,Re),Ae=j.c,se=j.lc;else throw"hufDecode issues"}return!0}function ye(ae,ue,Fe,ot,at,It){var Wt={value:0},xt=Fe.value,te=je(ue,Fe),Ie=je(ue,Fe);Fe.value+=4;var Ae=je(ue,Fe);if(Fe.value+=4,te<0||te>=65537||Ie<0||Ie>=65537)throw"Something wrong with HUF_ENCSIZE";var se=new Array(65537),Re=new Array(16384);z(Re);var Ue=ot-(Fe.value-xt);if(X(ae,ue,Fe,Ue,te,Ie,se),Ae>8*(ot-(Fe.value-xt)))throw"Something wrong with hufUncompress";q(se,te,Ie,Re),Ne(se,Re,ae,ue,Fe,Ae,Ie,It,at,Wt)}function pe(ae,ue,Fe){for(var ot=0;ot<Fe;++ot)ue[ot]=ae[ue[ot]]}function Te(ae){for(var ue=1;ue<ae.length;ue++){var Fe=ae[ue-1]+ae[ue]-128;ae[ue]=Fe}}function le(ae,ue){for(var Fe=0,ot=Math.floor((ae.length+1)/2),at=0,It=ae.length-1;!(at>It||(ue[at++]=ae[Fe++],at>It));)ue[at++]=ae[ot++]}function Ye(ae){for(var ue=ae.byteLength,Fe=new Array,ot=0,at=new DataView(ae);ue>0;){var It=at.getInt8(ot++);if(It<0){var Wt=-It;ue-=Wt+1;for(var xt=0;xt<Wt;xt++)Fe.push(at.getUint8(ot++))}else{var Wt=It;ue-=2;for(var te=at.getUint8(ot++),xt=0;xt<Wt+1;xt++)Fe.push(te)}}return Fe}function he(ae,ue,Fe,ot,at,It){var nn=new DataView(It.buffer),Wt=Fe[ae.idx[0]].width,xt=Fe[ae.idx[0]].height,te=3,Ie=Math.floor(Wt/8),Ae=Math.ceil(Wt/8),se=Math.ceil(xt/8),Re=Wt-(Ae-1)*8,Ue=xt-(se-1)*8,nt={value:0},pt=new Array(te),it=new Array(te),Bt=new Array(te),Mt=new Array(te),Yt=new Array(te);for(let cn=0;cn<te;++cn)Yt[cn]=ue[ae.idx[cn]],pt[cn]=cn<1?0:pt[cn-1]+Ae*se,it[cn]=new Float32Array(64),Bt[cn]=new Uint16Array(64),Mt[cn]=new Uint16Array(Ae*64);for(let cn=0;cn<se;++cn){var ln=8;cn==se-1&&(ln=Ue);var on=8;for(let Et=0;Et<Ae;++Et){Et==Ae-1&&(on=Re);for(let rn=0;rn<te;++rn)Bt[rn].fill(0),Bt[rn][0]=at[pt[rn]++],Ge(nt,ot,Bt[rn]),be(Bt[rn],it[rn]),Ee(it[rn]);Se(it);for(let rn=0;rn<te;++rn)ee(it[rn],Mt[rn],Et*64)}let Jt=0;for(let Et=0;Et<te;++Et){const rn=Fe[ae.idx[Et]].type;for(let Cn=8*cn;Cn<8*cn+ln;++Cn){Jt=Yt[Et][Cn];for(let Gn=0;Gn<Ie;++Gn){const pn=Gn*64+(Cn&7)*8;nn.setUint16(Jt+0*2*rn,Mt[Et][pn+0],!0),nn.setUint16(Jt+1*2*rn,Mt[Et][pn+1],!0),nn.setUint16(Jt+2*2*rn,Mt[Et][pn+2],!0),nn.setUint16(Jt+3*2*rn,Mt[Et][pn+3],!0),nn.setUint16(Jt+4*2*rn,Mt[Et][pn+4],!0),nn.setUint16(Jt+5*2*rn,Mt[Et][pn+5],!0),nn.setUint16(Jt+6*2*rn,Mt[Et][pn+6],!0),nn.setUint16(Jt+7*2*rn,Mt[Et][pn+7],!0),Jt+=8*2*rn}}if(Ie!=Ae)for(let Cn=8*cn;Cn<8*cn+ln;++Cn){const Gn=Yt[Et][Cn]+8*Ie*2*rn,pn=Ie*64+(Cn&7)*8;for(let Kn=0;Kn<on;++Kn)nn.setUint16(Gn+Kn*2*rn,Mt[Et][pn+Kn],!0)}}}for(var vn=new Uint16Array(Wt),nn=new DataView(It.buffer),mn=0;mn<te;++mn){Fe[ae.idx[mn]].decoded=!0;var gn=Fe[ae.idx[mn]].type;if(Fe[mn].type==2)for(var Xn=0;Xn<xt;++Xn){const cn=Yt[mn][Xn];for(var bn=0;bn<Wt;++bn)vn[bn]=nn.getUint16(cn+bn*2*gn,!0);for(var bn=0;bn<Wt;++bn)nn.setFloat32(cn+bn*2*gn,ze(vn[bn]),!0)}}}function Ge(ae,ue,Fe){for(var ot,at=1;at<64;)ot=ue[ae.value],ot==65280?at=64:ot>>8==255?at+=ot&255:(Fe[at]=ot,at++),ae.value++}function be(ae,ue){ue[0]=ze(ae[0]),ue[1]=ze(ae[1]),ue[2]=ze(ae[5]),ue[3]=ze(ae[6]),ue[4]=ze(ae[14]),ue[5]=ze(ae[15]),ue[6]=ze(ae[27]),ue[7]=ze(ae[28]),ue[8]=ze(ae[2]),ue[9]=ze(ae[4]),ue[10]=ze(ae[7]),ue[11]=ze(ae[13]),ue[12]=ze(ae[16]),ue[13]=ze(ae[26]),ue[14]=ze(ae[29]),ue[15]=ze(ae[42]),ue[16]=ze(ae[3]),ue[17]=ze(ae[8]),ue[18]=ze(ae[12]),ue[19]=ze(ae[17]),ue[20]=ze(ae[25]),ue[21]=ze(ae[30]),ue[22]=ze(ae[41]),ue[23]=ze(ae[43]),ue[24]=ze(ae[9]),ue[25]=ze(ae[11]),ue[26]=ze(ae[18]),ue[27]=ze(ae[24]),ue[28]=ze(ae[31]),ue[29]=ze(ae[40]),ue[30]=ze(ae[44]),ue[31]=ze(ae[53]),ue[32]=ze(ae[10]),ue[33]=ze(ae[19]),ue[34]=ze(ae[23]),ue[35]=ze(ae[32]),ue[36]=ze(ae[39]),ue[37]=ze(ae[45]),ue[38]=ze(ae[52]),ue[39]=ze(ae[54]),ue[40]=ze(ae[20]),ue[41]=ze(ae[22]),ue[42]=ze(ae[33]),ue[43]=ze(ae[38]),ue[44]=ze(ae[46]),ue[45]=ze(ae[51]),ue[46]=ze(ae[55]),ue[47]=ze(ae[60]),ue[48]=ze(ae[21]),ue[49]=ze(ae[34]),ue[50]=ze(ae[37]),ue[51]=ze(ae[47]),ue[52]=ze(ae[50]),ue[53]=ze(ae[56]),ue[54]=ze(ae[59]),ue[55]=ze(ae[61]),ue[56]=ze(ae[35]),ue[57]=ze(ae[36]),ue[58]=ze(ae[48]),ue[59]=ze(ae[49]),ue[60]=ze(ae[57]),ue[61]=ze(ae[58]),ue[62]=ze(ae[62]),ue[63]=ze(ae[63])}function Ee(ae){const ue=.5*Math.cos(.7853975),Fe=.5*Math.cos(3.14159/16),ot=.5*Math.cos(3.14159/8),at=.5*Math.cos(3*3.14159/16),It=.5*Math.cos(5*3.14159/16),Wt=.5*Math.cos(3*3.14159/8),xt=.5*Math.cos(7*3.14159/16);for(var te=new Array(4),Ie=new Array(4),Ae=new Array(4),se=new Array(4),Re=0;Re<8;++Re){var Ue=Re*8;te[0]=ot*ae[Ue+2],te[1]=Wt*ae[Ue+2],te[2]=ot*ae[Ue+6],te[3]=Wt*ae[Ue+6],Ie[0]=Fe*ae[Ue+1]+at*ae[Ue+3]+It*ae[Ue+5]+xt*ae[Ue+7],Ie[1]=at*ae[Ue+1]-xt*ae[Ue+3]-Fe*ae[Ue+5]-It*ae[Ue+7],Ie[2]=It*ae[Ue+1]-Fe*ae[Ue+3]+xt*ae[Ue+5]+at*ae[Ue+7],Ie[3]=xt*ae[Ue+1]-It*ae[Ue+3]+at*ae[Ue+5]-Fe*ae[Ue+7],Ae[0]=ue*(ae[Ue+0]+ae[Ue+4]),Ae[3]=ue*(ae[Ue+0]-ae[Ue+4]),Ae[1]=te[0]+te[3],Ae[2]=te[1]-te[2],se[0]=Ae[0]+Ae[1],se[1]=Ae[3]+Ae[2],se[2]=Ae[3]-Ae[2],se[3]=Ae[0]-Ae[1],ae[Ue+0]=se[0]+Ie[0],ae[Ue+1]=se[1]+Ie[1],ae[Ue+2]=se[2]+Ie[2],ae[Ue+3]=se[3]+Ie[3],ae[Ue+4]=se[3]-Ie[3],ae[Ue+5]=se[2]-Ie[2],ae[Ue+6]=se[1]-Ie[1],ae[Ue+7]=se[0]-Ie[0]}for(var nt=0;nt<8;++nt)te[0]=ot*ae[16+nt],te[1]=Wt*ae[16+nt],te[2]=ot*ae[48+nt],te[3]=Wt*ae[48+nt],Ie[0]=Fe*ae[8+nt]+at*ae[24+nt]+It*ae[40+nt]+xt*ae[56+nt],Ie[1]=at*ae[8+nt]-xt*ae[24+nt]-Fe*ae[40+nt]-It*ae[56+nt],Ie[2]=It*ae[8+nt]-Fe*ae[24+nt]+xt*ae[40+nt]+at*ae[56+nt],Ie[3]=xt*ae[8+nt]-It*ae[24+nt]+at*ae[40+nt]-Fe*ae[56+nt],Ae[0]=ue*(ae[nt]+ae[32+nt]),Ae[3]=ue*(ae[nt]-ae[32+nt]),Ae[1]=te[0]+te[3],Ae[2]=te[1]-te[2],se[0]=Ae[0]+Ae[1],se[1]=Ae[3]+Ae[2],se[2]=Ae[3]-Ae[2],se[3]=Ae[0]-Ae[1],ae[0+nt]=se[0]+Ie[0],ae[8+nt]=se[1]+Ie[1],ae[16+nt]=se[2]+Ie[2],ae[24+nt]=se[3]+Ie[3],ae[32+nt]=se[3]-Ie[3],ae[40+nt]=se[2]-Ie[2],ae[48+nt]=se[1]-Ie[1],ae[56+nt]=se[0]-Ie[0]}function Se(ae){for(var ue=0;ue<64;++ue){var Fe=ae[0][ue],ot=ae[1][ue],at=ae[2][ue];ae[0][ue]=Fe+1.5747*at,ae[1][ue]=Fe-.1873*ot-.4682*at,ae[2][ue]=Fe+1.8556*ot}}function ee(ae,ue,Fe){for(var ot=0;ot<64;++ot)ue[Fe+ot]=PC.toHalfFloat(Q(ae[ot]))}function Q(ae){return ae<=1?Math.sign(ae)*Math.pow(Math.abs(ae),2.2):Math.sign(ae)*Math.pow(N,Math.abs(ae)-1)}function ce(ae){return new DataView(ae.array.buffer,ae.offset.value,ae.size)}function me(ae){var ue=ae.viewer.buffer.slice(ae.offset.value,ae.offset.value+ae.size),Fe=new Uint8Array(Ye(ue)),ot=new Uint8Array(Fe.length);return Te(Fe),le(Fe,ot),new DataView(ot.buffer)}function Ze(ae){var ue=ae.array.slice(ae.offset.value,ae.offset.value+ae.size),Fe=Ov(ue),ot=new Uint8Array(Fe.length);return Te(Fe),le(Fe,ot),new DataView(ot.buffer)}function Xe(ae){for(var ue=ae.viewer,Fe={value:ae.offset.value},ot=new Uint16Array(ae.width*ae.scanlineBlockSize*(ae.channels*ae.type)),at=new Uint8Array(8192),It=0,Wt=new Array(ae.channels),xt=0;xt<ae.channels;xt++)Wt[xt]={},Wt[xt].start=It,Wt[xt].end=Wt[xt].start,Wt[xt].nx=ae.width,Wt[xt].ny=ae.lines,Wt[xt].size=ae.type,It+=Wt[xt].nx*Wt[xt].ny*Wt[xt].size;var te=Qe(ue,Fe),Ie=Qe(ue,Fe);if(Ie>=8192)throw"Something is wrong with PIZ_COMPRESSION BITMAP_SIZE";if(te<=Ie)for(var xt=0;xt<Ie-te+1;xt++)at[xt+te]=Ce(ue,Fe);var Ae=new Uint16Array(65536),se=H(at,Ae),Re=je(ue,Fe);ye(ae.array,ue,Fe,Re,ot,It);for(var xt=0;xt<ae.channels;++xt)for(var Ue=Wt[xt],nt=0;nt<Wt[xt].size;++nt)xe(ot,Ue.start+nt,Ue.nx,Ue.size,Ue.ny,Ue.nx*Ue.size,se);pe(Ae,ot,It);for(var pt=0,it=new Uint8Array(ot.buffer.byteLength),Bt=0;Bt<ae.lines;Bt++)for(var Mt=0;Mt<ae.channels;Mt++){var Ue=Wt[Mt],Yt=Ue.nx*Ue.size,ln=new Uint8Array(ot.buffer,Ue.end*2,Yt*2);it.set(ln,pt),pt+=Yt*2,Ue.end+=Yt}return new DataView(it.buffer)}function De(ae){var ue=ae.array.slice(ae.offset.value,ae.offset.value+ae.size),Fe=Ov(ue);const ot=ae.lines*ae.channels*ae.width,at=ae.type==1?new Uint16Array(ot):new Uint32Array(ot);let It=0,Wt=0;const xt=new Array(4);for(let te=0;te<ae.lines;te++)for(let Ie=0;Ie<ae.channels;Ie++){let Ae=0;switch(ae.type){case 1:xt[0]=It,xt[1]=xt[0]+ae.width,It=xt[1]+ae.width;for(let se=0;se<ae.width;++se){const Re=Fe[xt[0]++]<<8|Fe[xt[1]++];Ae+=Re,at[Wt]=Ae,Wt++}break;case 2:xt[0]=It,xt[1]=xt[0]+ae.width,xt[2]=xt[1]+ae.width,It=xt[2]+ae.width;for(let se=0;se<ae.width;++se){const Re=Fe[xt[0]++]<<24|Fe[xt[1]++]<<16|Fe[xt[2]++]<<8;Ae+=Re,at[Wt]=Ae,Wt++}break}}return new DataView(at.buffer)}function Oe(ae){var ue=ae.viewer,Fe={value:ae.offset.value},ot=new Uint8Array(ae.width*ae.lines*(ae.channels*ae.type*2)),at={version:He(ue,Fe),unknownUncompressedSize:He(ue,Fe),unknownCompressedSize:He(ue,Fe),acCompressedSize:He(ue,Fe),dcCompressedSize:He(ue,Fe),rleCompressedSize:He(ue,Fe),rleUncompressedSize:He(ue,Fe),rleRawSize:He(ue,Fe),totalAcUncompressedCount:He(ue,Fe),totalDcUncompressedCount:He(ue,Fe),acCompression:He(ue,Fe)};if(at.version<2)throw"EXRLoader.parse: "+kt.compression+" version "+at.version+" is unsupported";for(var It=new Array,Wt=Qe(ue,Fe)-2;Wt>0;){var xt=Je(ue.buffer,Fe),te=Ce(ue,Fe),Ie=te>>2&3,Ae=(te>>4)-1,se=new Int8Array([Ae])[0],Re=Ce(ue,Fe);It.push({name:xt,index:se,type:Re,compression:Ie}),Wt-=xt.length+3}for(var Ue=kt.channels,nt=new Array(ae.channels),pt=0;pt<ae.channels;++pt){var it=nt[pt]={},Bt=Ue[pt];it.name=Bt.name,it.compression=0,it.decoded=!1,it.type=Bt.pixelType,it.pLinear=Bt.pLinear,it.width=ae.width,it.height=ae.lines}for(var Mt={idx:new Array(3)},Yt=0;Yt<ae.channels;++Yt)for(var it=nt[Yt],pt=0;pt<It.length;++pt){var ln=It[pt];it.name==ln.name&&(it.compression=ln.compression,ln.index>=0&&(Mt.idx[ln.index]=Yt),it.offset=Yt)}if(at.acCompressedSize>0)switch(at.acCompression){case 0:var nn=new Uint16Array(at.totalAcUncompressedCount);ye(ae.array,ue,Fe,at.acCompressedSize,nn,at.totalAcUncompressedCount);break;case 1:var on=ae.array.slice(Fe.value,Fe.value+at.totalAcUncompressedCount),vn=Ov(on),nn=new Uint16Array(vn.buffer);Fe.value+=at.totalAcUncompressedCount;break}if(at.dcCompressedSize>0){var mn={array:ae.array,offset:Fe,size:at.dcCompressedSize},gn=new Uint16Array(Ze(mn).buffer);Fe.value+=at.dcCompressedSize}if(at.rleRawSize>0){var on=ae.array.slice(Fe.value,Fe.value+at.rleCompressedSize),vn=Ov(on),Xn=Ye(vn.buffer);Fe.value+=at.rleCompressedSize}for(var bn=0,cn=new Array(nt.length),pt=0;pt<cn.length;++pt)cn[pt]=new Array;for(var Jt=0;Jt<ae.lines;++Jt)for(var Et=0;Et<nt.length;++Et)cn[Et].push(bn),bn+=nt[Et].width*ae.type*2;he(Mt,cn,nt,nn,gn,ot);for(var pt=0;pt<nt.length;++pt){var it=nt[pt];if(!it.decoded)switch(it.compression){case 2:for(var rn=0,Cn=0,Jt=0;Jt<ae.lines;++Jt){for(var Gn=cn[pt][rn],pn=0;pn<it.width;++pn){for(var Kn=0;Kn<2*it.type;++Kn)ot[Gn++]=Xn[Cn+Kn*it.width*it.height];Cn++}rn++}break;case 1:default:throw"EXRLoader.parse: unsupported channel compression"}}return new DataView(ot.buffer)}function Je(ae,ue){for(var Fe=new Uint8Array(ae),ot=0;Fe[ue.value+ot]!=0;)ot+=1;var at=new TextDecoder().decode(Fe.slice(ue.value,ue.value+ot));return ue.value=ue.value+ot+1,at}function At(ae,ue,Fe){var ot=new TextDecoder().decode(new Uint8Array(ae).slice(ue.value,ue.value+Fe));return ue.value=ue.value+Fe,ot}function qe(ae,ue){var Fe=$e(ae,ue),ot=je(ae,ue);return[Fe,ot]}function lt(ae,ue){var Fe=je(ae,ue),ot=je(ae,ue);return[Fe,ot]}function $e(ae,ue){var Fe=ae.getInt32(ue.value,!0);return ue.value=ue.value+4,Fe}function je(ae,ue){var Fe=ae.getUint32(ue.value,!0);return ue.value=ue.value+4,Fe}function ke(ae,ue){var Fe=ae[ue.value];return ue.value=ue.value+1,Fe}function Ce(ae,ue){var Fe=ae.getUint8(ue.value);return ue.value=ue.value+1,Fe}const He=function(ae,ue){let Fe;return"getBigInt64"in DataView.prototype?Fe=Number(ae.getBigInt64(ue.value,!0)):Fe=ae.getUint32(ue.value+4,!0)+Number(ae.getUint32(ue.value,!0)<<32),ue.value+=8,Fe};function ht(ae,ue){var Fe=ae.getFloat32(ue.value,!0);return ue.value+=4,Fe}function we(ae,ue){return PC.toHalfFloat(ht(ae,ue))}function ze(ae){var ue=(ae&31744)>>10,Fe=ae&1023;return(ae>>15?-1:1)*(ue?ue===31?Fe?NaN:1/0:Math.pow(2,ue-15)*(1+Fe/1024):6103515625e-14*(Fe/1024))}function Qe(ae,ue){var Fe=ae.getUint16(ue.value,!0);return ue.value+=2,Fe}function ut(ae,ue){return ze(Qe(ae,ue))}function Rt(ae,ue,Fe,ot){for(var at=Fe.value,It=[];Fe.value<at+ot-1;){var Wt=Je(ue,Fe),xt=$e(ae,Fe),te=Ce(ae,Fe);Fe.value+=3;var Ie=$e(ae,Fe),Ae=$e(ae,Fe);It.push({name:Wt,pixelType:xt,pLinear:te,xSampling:Ie,ySampling:Ae})}return Fe.value+=1,It}function mt(ae,ue){var Fe=ht(ae,ue),ot=ht(ae,ue),at=ht(ae,ue),It=ht(ae,ue),Wt=ht(ae,ue),xt=ht(ae,ue),te=ht(ae,ue),Ie=ht(ae,ue);return{redX:Fe,redY:ot,greenX:at,greenY:It,blueX:Wt,blueY:xt,whiteX:te,whiteY:Ie}}function _t(ae,ue){var Fe=["NO_COMPRESSION","RLE_COMPRESSION","ZIPS_COMPRESSION","ZIP_COMPRESSION","PIZ_COMPRESSION","PXR24_COMPRESSION","B44_COMPRESSION","B44A_COMPRESSION","DWAA_COMPRESSION","DWAB_COMPRESSION"],ot=Ce(ae,ue);return Fe[ot]}function Lt(ae,ue){var Fe=je(ae,ue),ot=je(ae,ue),at=je(ae,ue),It=je(ae,ue);return{xMin:Fe,yMin:ot,xMax:at,yMax:It}}function Zt(ae,ue){var Fe=["INCREASING_Y"],ot=Ce(ae,ue);return Fe[ot]}function yt(ae,ue){var Fe=ht(ae,ue),ot=ht(ae,ue);return[Fe,ot]}function Ht(ae,ue){var Fe=ht(ae,ue),ot=ht(ae,ue),at=ht(ae,ue);return[Fe,ot,at]}function jt(ae,ue,Fe,ot,at){if(ot==="string"||ot==="stringvector"||ot==="iccProfile")return At(ue,Fe,at);if(ot==="chlist")return Rt(ae,ue,Fe,at);if(ot==="chromaticities")return mt(ae,Fe);if(ot==="compression")return _t(ae,Fe);if(ot==="box2i")return Lt(ae,Fe);if(ot==="lineOrder")return Zt(ae,Fe);if(ot==="float")return ht(ae,Fe);if(ot==="v2f")return yt(ae,Fe);if(ot==="v3f")return Ht(ae,Fe);if(ot==="int")return $e(ae,Fe);if(ot==="rational")return qe(ae,Fe);if(ot==="timecode")return lt(ae,Fe);if(ot==="preview")return Fe.value+=at,"skipped";Fe.value+=at}function Ut(ae,ue,Fe){const ot={};if(ae.getUint32(0,!0)!=20000630)throw"THREE.EXRLoader: provided file doesn't appear to be in OpenEXR format.";ot.version=ae.getUint8(4);const at=ae.getUint8(5);ot.spec={singleTile:!!(at&2),longName:!!(at&4),deepFormat:!!(at&8),multiPart:!!(at&16)},Fe.value=8;for(var It=!0;It;){var Wt=Je(ue,Fe);if(Wt==0)It=!1;else{var xt=Je(ue,Fe),te=je(ae,Fe),Ie=jt(ae,ue,Fe,xt,te);Ie===void 0?console.warn(`EXRLoader.parse: skipped unknown header attribute type '${xt}'.`):ot[Wt]=Ie}}if((at&-5)!=0)throw console.error("EXRHeader:",ot),"THREE.EXRLoader: provided file is currently unsupported.";return ot}function Nt(ae,ue,Fe,ot,at){const It={size:0,viewer:ue,array:Fe,offset:ot,width:ae.dataWindow.xMax-ae.dataWindow.xMin+1,height:ae.dataWindow.yMax-ae.dataWindow.yMin+1,channels:ae.channels.length,bytesPerLine:null,lines:null,inputSize:null,type:ae.channels[0].pixelType,uncompress:null,getter:null,format:null,[Vm?"colorSpace":"encoding"]:null};switch(ae.compression){case"NO_COMPRESSION":It.lines=1,It.uncompress=ce;break;case"RLE_COMPRESSION":It.lines=1,It.uncompress=me;break;case"ZIPS_COMPRESSION":It.lines=1,It.uncompress=Ze;break;case"ZIP_COMPRESSION":It.lines=16,It.uncompress=Ze;break;case"PIZ_COMPRESSION":It.lines=32,It.uncompress=Xe;break;case"PXR24_COMPRESSION":It.lines=16,It.uncompress=De;break;case"DWAA_COMPRESSION":It.lines=32,It.uncompress=Oe;break;case"DWAB_COMPRESSION":It.lines=256,It.uncompress=Oe;break;default:throw"EXRLoader.parse: "+ae.compression+" is unsupported"}if(It.scanlineBlockSize=It.lines,It.type==1)switch(at){case ma:It.getter=ut,It.inputSize=2;break;case Co:It.getter=Qe,It.inputSize=2;break}else if(It.type==2)switch(at){case ma:It.getter=ht,It.inputSize=4;break;case Co:It.getter=we,It.inputSize=4}else throw"EXRLoader.parse: unsupported pixelType "+It.type+" for "+ae.compression+".";It.blockCount=(ae.dataWindow.yMax+1)/It.scanlineBlockSize;for(var Wt=0;Wt<It.blockCount;Wt++)He(ue,ot);It.outputChannels=It.channels==3?4:It.channels;const xt=It.width*It.height*It.outputChannels;switch(at){case ma:It.byteArray=new Float32Array(xt),It.channels<It.outputChannels&&It.byteArray.fill(1,0,xt);break;case Co:It.byteArray=new Uint16Array(xt),It.channels<It.outputChannels&&It.byteArray.fill(15360,0,xt);break;default:console.error("THREE.EXRLoader: unsupported type: ",at);break}return It.bytesPerLine=It.width*It.inputSize*It.channels,It.outputChannels==4?It.format=La:It.format=ib,Vm?It.colorSpace="srgb-linear":It.encoding=3e3,It}const Tt=new DataView(e),Pt=new Uint8Array(e),qt={value:0},kt=Ut(Tt,e,qt),Ft=Nt(kt,Tt,Pt,qt,this.type),fn={value:0},sn={R:0,G:1,B:2,A:3,Y:0};for(let ae=0;ae<Ft.height/Ft.scanlineBlockSize;ae++){const ue=je(Tt,qt);Ft.size=je(Tt,qt),Ft.lines=ue+Ft.scanlineBlockSize>Ft.height?Ft.height-ue:Ft.scanlineBlockSize;const ot=Ft.size<Ft.lines*Ft.bytesPerLine?Ft.uncompress(Ft):ce(Ft);qt.value+=Ft.size;for(let at=0;at<Ft.scanlineBlockSize;at++){const It=at+ae*Ft.scanlineBlockSize;if(It>=Ft.height)break;for(let Wt=0;Wt<Ft.channels;Wt++){const xt=sn[kt.channels[Wt].name];for(let te=0;te<Ft.width;te++){fn.value=(at*(Ft.channels*Ft.width)+Wt*Ft.width+te)*Ft.inputSize;const Ie=(Ft.height-1-It)*(Ft.width*Ft.outputChannels)+te*Ft.outputChannels+xt;Ft.byteArray[Ie]=Ft.getter(ot,fn)}}}}return{header:kt,width:Ft.width,height:Ft.height,data:Ft.byteArray,format:Ft.format,[Vm?"colorSpace":"encoding"]:Ft[Vm?"colorSpace":"encoding"],type:this.type}}setDataType(e){return this.type=e,this}load(e,t,i,a){function o(r,s){Vm?r.colorSpace=s.colorSpace:r.encoding=s.encoding,r.minFilter=Bi,r.magFilter=Bi,r.generateMipmaps=!1,r.flipY=!1,t&&t(r,s)}return super.load(e,o,i,a)}}const Zw=new WeakMap;class m$ extends Jo{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,i,a){const o=new ko(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,r=>{const s={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(r,s).then(t).catch(a)},i,a)}decodeDracoFile(e,t,i,a){const o={attributeIDs:i||this.defaultAttributeIDs,attributeTypes:a||this.defaultAttributeTypes,useUniqueIDs:!!i};this.decodeGeometry(e,o).then(t)}decodeGeometry(e,t){for(const l in t.attributeTypes){const c=t.attributeTypes[l];c.BYTES_PER_ELEMENT!==void 0&&(t.attributeTypes[l]=c.name)}const i=JSON.stringify(t);if(Zw.has(e)){const l=Zw.get(e);if(l.key===i)return l.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let a;const o=this.workerNextTaskID++,r=e.byteLength,s=this._getWorker(o,r).then(l=>(a=l,new Promise((c,u)=>{a._callbacks[o]={resolve:c,reject:u},a.postMessage({type:"decode",id:o,taskConfig:t,buffer:e},[e])}))).then(l=>this._createGeometry(l.geometry));return s.catch(()=>!0).then(()=>{a&&o&&this._releaseTask(a,o)}),Zw.set(e,{key:i,promise:s}),s}_createGeometry(e){const t=new $n;e.index&&t.setIndex(new Mi(e.index.array,1));for(let i=0;i<e.attributes.length;i++){const a=e.attributes[i],o=a.name,r=a.array,s=a.itemSize;t.setAttribute(o,new Mi(r,s))}return t}_loadLibrary(e,t){const i=new ko(this.manager);return i.setPath(this.decoderPath),i.setResponseType(t),i.setWithCredentials(this.withCredentials),new Promise((a,o)=>{i.load(e,a,void 0,o)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(i=>{const a=i[0];e||(this.decoderConfig.wasmBinary=i[1]);const o=p$.toString(),r=["/* draco decoder */",a,"","/* worker */",o.substring(o.indexOf("{")+1,o.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([r]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const a=new Worker(this.workerSourceURL);a._callbacks={},a._taskCosts={},a._taskLoad=0,a.postMessage({type:"init",decoderConfig:this.decoderConfig}),a.onmessage=function(o){const r=o.data;switch(r.type){case"decode":a._callbacks[r.id].resolve(r);break;case"error":a._callbacks[r.id].reject(r);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+r.type+'"')}},this.workerPool.push(a)}else this.workerPool.sort(function(a,o){return a._taskLoad>o._taskLoad?-1:1});const i=this.workerPool[this.workerPool.length-1];return i._taskCosts[e]=t,i._taskLoad+=t,i})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this}}function p$(){let n,e;onmessage=function(r){const s=r.data;switch(s.type){case"init":n=s.decoderConfig,e=new Promise(function(u){n.onModuleLoaded=function(C){u({draco:C})},DracoDecoderModule(n)});break;case"decode":const l=s.buffer,c=s.taskConfig;e.then(u=>{const C=u.draco,h=new C.Decoder,m=new C.DecoderBuffer;m.Init(new Int8Array(l),l.byteLength);try{const p=t(C,h,m,c),B=p.attributes.map(b=>b.array.buffer);p.index&&B.push(p.index.array.buffer),self.postMessage({type:"decode",id:s.id,geometry:p},B)}catch(p){console.error(p),self.postMessage({type:"error",id:s.id,error:p.message})}finally{C.destroy(m),C.destroy(h)}});break}};function t(r,s,l,c){const u=c.attributeIDs,C=c.attributeTypes;let h,m;const p=s.GetEncodedGeometryType(l);if(p===r.TRIANGULAR_MESH)h=new r.Mesh,m=s.DecodeBufferToMesh(l,h);else if(p===r.POINT_CLOUD)h=new r.PointCloud,m=s.DecodeBufferToPointCloud(l,h);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!m.ok()||h.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+m.error_msg());const B={index:null,attributes:[]};for(const b in u){const y=self[C[b]];let S,R;if(c.useUniqueIDs)R=u[b],S=s.GetAttributeByUniqueId(h,R);else{if(R=s.GetAttributeId(h,r[u[b]]),R===-1)continue;S=s.GetAttribute(h,R)}B.attributes.push(a(r,s,h,b,y,S))}return p===r.TRIANGULAR_MESH&&(B.index=i(r,s,h)),r.destroy(h),B}function i(r,s,l){const u=l.num_faces()*3,C=u*4,h=r._malloc(C);s.GetTrianglesUInt32Array(l,C,h);const m=new Uint32Array(r.HEAPF32.buffer,h,u).slice();return r._free(h),{array:m,itemSize:1}}function a(r,s,l,c,u,C){const h=C.num_components(),p=l.num_points()*h,B=p*u.BYTES_PER_ELEMENT,b=o(r,u),y=r._malloc(B);s.GetAttributeDataArrayForAllPoints(l,C,b,B,y);const S=new u(r.HEAPF32.buffer,y,p).slice();return r._free(y),{name:c,array:S,itemSize:h}}function o(r,s){switch(s){case Float32Array:return r.DT_FLOAT32;case Int8Array:return r.DT_INT8;case Int16Array:return r.DT_INT16;case Int32Array:return r.DT_INT32;case Uint8Array:return r.DT_UINT8;case Uint16Array:return r.DT_UINT16;case Uint32Array:return r.DT_UINT32}}}let kv;const xw=()=>{if(kv)return kv;const n="B9h9z9tFBBBF8fL9gBB9gLaaaaaFa9gEaaaB9gFaFa9gEaaaFaEMcBFFFGGGEIIILF9wFFFLEFBFKNFaFCx/IFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBF8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBGy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBEn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBIi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBKI9z9iqlBOc+x8ycGBM/qQFTa8jUUUUBCU/EBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAGTkUUUBRNCUoBAG9uC/wgBZHKCUGAKCUG9JyRVAECFJRICBRcGXEXAcAF9PQFAVAFAclAcAVJAF9JyRMGXGXAG9FQBAMCbJHKC9wZRSAKCIrCEJCGrRQANCUGJRfCBRbAIRTEXGXAOATlAQ9PQBCBRISEMATAQJRIGXAS9FQBCBRtCBREEXGXAOAIlCi9PQBCBRISLMANCU/CBJAEJRKGXGXGXGXGXATAECKrJ2BBAtCKZrCEZfIBFGEBMAKhB83EBAKCNJhB83EBSEMAKAI2BIAI2BBHmCKrHYAYCE6HYy86BBAKCFJAICIJAYJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCGJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCEJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCIJAYAmJHY2BBAI2BFHmCKrHPAPCE6HPy86BBAKCLJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCKJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCOJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCNJAYAmJHY2BBAI2BGHmCKrHPAPCE6HPy86BBAKCVJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCcJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCMJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCSJAYAmJHm2BBAI2BEHICKrHYAYCE6HYy86BBAKCQJAmAYJHm2BBAICIrCEZHYAYCE6HYy86BBAKCfJAmAYJHm2BBAICGrCEZHYAYCE6HYy86BBAKCbJAmAYJHK2BBAICEZHIAICE6HIy86BBAKAIJRISGMAKAI2BNAI2BBHmCIrHYAYCb6HYy86BBAKCFJAICNJAYJHY2BBAmCbZHmAmCb6Hmy86BBAKCGJAYAmJHm2BBAI2BFHYCIrHPAPCb6HPy86BBAKCEJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCIJAmAYJHm2BBAI2BGHYCIrHPAPCb6HPy86BBAKCLJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCKJAmAYJHm2BBAI2BEHYCIrHPAPCb6HPy86BBAKCOJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCNJAmAYJHm2BBAI2BIHYCIrHPAPCb6HPy86BBAKCVJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCcJAmAYJHm2BBAI2BLHYCIrHPAPCb6HPy86BBAKCMJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCSJAmAYJHm2BBAI2BKHYCIrHPAPCb6HPy86BBAKCQJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCfJAmAYJHm2BBAI2BOHICIrHYAYCb6HYy86BBAKCbJAmAYJHK2BBAICbZHIAICb6HIy86BBAKAIJRISFMAKAI8pBB83BBAKCNJAICNJ8pBB83BBAICTJRIMAtCGJRtAECTJHEAS9JQBMMGXAIQBCBRISEMGXAM9FQBANAbJ2BBRtCBRKAfREEXAEANCU/CBJAKJ2BBHTCFrCBATCFZl9zAtJHt86BBAEAGJREAKCFJHKAM9HQBMMAfCFJRfAIRTAbCFJHbAG9HQBMMABAcAG9sJANCUGJAMAG9sTkUUUBpANANCUGJAMCaJAG9sJAGTkUUUBpMAMCBAIyAcJRcAIQBMC9+RKSFMCBC99AOAIlAGCAAGCA9Ly6yRKMALCU/EBJ8kUUUUBAKM+OmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUFT+JUUUBpALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM+lLKFaF99GaG99FaG99GXGXAGCI9HQBAF9FQFEXGXGX9DBBB8/9DBBB+/ABCGJHG1BB+yAB1BBHE+yHI+L+TABCFJHL1BBHK+yHO+L+THN9DBBBB9gHVyAN9DBB/+hANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE86BBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG86BBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG86BBABCIJRBAFCaJHFQBSGMMAF9FQBEXGXGX9DBBB8/9DBBB+/ABCIJHG8uFB+yAB8uFBHE+yHI+L+TABCGJHL8uFBHK+yHO+L+THN9DBBBB9gHVyAN9DB/+g6ANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE87FBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG87FBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG87FBABCNJRBAFCaJHFQBMMM/SEIEaE99EaF99GXAF9FQBCBREABRIEXGXGX9D/zI818/AICKJ8uFBHLCEq+y+VHKAI8uFB+y+UHO9DB/+g6+U9DBBB8/9DBBB+/AO9DBBBB9gy+SHN+L9DBBB9P9d9FQBAN+oRVSFMCUUUU94RVMAICIJ8uFBRcAICGJ8uFBRMABALCFJCEZAEqCFWJAV87FBGXGXAKAM+y+UHN9DB/+g6+U9DBBB8/9DBBB+/AN9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRMSFMCUUUU94RMMABALCGJCEZAEqCFWJAM87FBGXGXAKAc+y+UHK9DB/+g6+U9DBBB8/9DBBB+/AK9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRcSFMCUUUU94RcMABALCaJCEZAEqCFWJAc87FBGXGX9DBBU8/AOAO+U+TANAN+U+TAKAK+U+THO9DBBBBAO9DBBBB9gy+R9DB/+g6+U9DBBB8/+SHO+L9DBBB9P9d9FQBAO+oRcSFMCUUUU94RcMABALCEZAEqCFWJAc87FBAICNJRIAECIJREAFCaJHFQBMMM9JBGXAGCGrAF9sHF9FQBEXABAB8oGBHGCNWCN91+yAGCi91CnWCUUU/8EJ+++U84GBABCIJRBAFCaJHFQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEM/lFFFaGXGXAFABqCEZ9FQBABRESFMGXGXAGCT9PQBABRESFMABREEXAEAF8oGBjGBAECIJAFCIJ8oGBjGBAECNJAFCNJ8oGBjGBAECSJAFCSJ8oGBjGBAECTJREAFCTJRFAGC9wJHGCb9LQBMMAGCI9JQBEXAEAF8oGBjGBAFCIJRFAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF2BB86BBAECFJREAFCFJRFAGCaJHGQBMMABMoFFGaGXGXABCEZ9FQBABRESFMAFCgFZC+BwsN9sRIGXGXAGCT9PQBABRESFMABREEXAEAIjGBAECSJAIjGBAECNJAIjGBAECIJAIjGBAECTJREAGC9wJHGCb9LQBMMAGCI9JQBEXAEAIjGBAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF86BBAECFJREAGCaJHGQBMMABMMMFBCUNMIT9kBB",e="B9h9z9tFBBBFiI9gBB9gLaaaaaFa9gEaaaB9gFaFaEMcBBFBFFGGGEILF9wFFFLEFBFKNFaFCx/aFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBG8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBIy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBKi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBOn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBNI9z9iqlBVc+N9IcIBTEM9+FLa8jUUUUBCTlRBCBRFEXCBRGCBREEXABCNJAGJAECUaAFAGrCFZHIy86BBAEAIJREAGCFJHGCN9HQBMAFCx+YUUBJAE86BBAFCEWCxkUUBJAB8pEN83EBAFCFJHFCUG9HQBMMk8lLbaE97F9+FaL978jUUUUBCU/KBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAG/8cBBCUoBAG9uC/wgBZHKCUGAKCUG9JyRNAECFJRKCBRVGXEXAVAF9PQFANAFAVlAVANJAF9JyRcGXGXAG9FQBAcCbJHIC9wZHMCE9sRSAMCFWRQAICIrCEJCGrRfCBRbEXAKRTCBRtGXEXGXAOATlAf9PQBCBRKSLMALCU/CBJAtAM9sJRmATAfJRKCBREGXAMCoB9JQBAOAKlC/gB9JQBCBRIEXAmAIJREGXGXGXGXGXATAICKrJ2BBHYCEZfIBFGEBMAECBDtDMIBSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIBAKCTJRKMGXGXGXGXGXAYCGrCEZfIBFGEBMAECBDtDMITSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMITAKCTJRKMGXGXGXGXGXAYCIrCEZfIBFGEBMAECBDtDMIASEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIAAKCTJRKMGXGXGXGXGXAYCKrfIBFGEBMAECBDtDMI8wSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCIJAeDeBJAYCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCNJAeDeBJAYCx+YUUBJ2BBJRKSFMAEAKDBBBDMI8wAKCTJRKMAICoBJREAICUFJAM9LQFAERIAOAKlC/fB9LQBMMGXAEAM9PQBAECErRIEXGXAOAKlCi9PQBCBRKSOMAmAEJRYGXGXGXGXGXATAECKrJ2BBAICKZrCEZfIBFGEBMAYCBDtDMIBSEMAYAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAYAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAYAKDBBBDMIBAKCTJRKMAICGJRIAECTJHEAM9JQBMMGXAK9FQBAKRTAtCFJHtCI6QGSFMMCBRKSEMGXAM9FQBALCUGJAbJREALAbJDBGBReCBRYEXAEALCU/CBJAYJHIDBIBHdCFD9tAdCFDbHPD9OD9hD9RHdAIAMJDBIBH8ZCFD9tA8ZAPD9OD9hD9RH8ZDQBTFtGmEYIPLdKeOnHpAIAQJDBIBHyCFD9tAyAPD9OD9hD9RHyAIASJDBIBH8cCFD9tA8cAPD9OD9hD9RH8cDQBTFtGmEYIPLdKeOnH8dDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGEAeD9uHeDyBjGBAEAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeApA8dDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNiV8ZcpMyS8cQ8df8eb8fHdAyA8cDQNiV8ZcpMyS8cQ8df8eb8fH8ZDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJREAYCTJHYAM9JQBMMAbCIJHbAG9JQBMMABAVAG9sJALCUGJAcAG9s/8cBBALALCUGJAcCaJAG9sJAG/8cBBMAcCBAKyAVJRVAKQBMC9+RKSFMCBC99AOAKlAGCAAGCA9Ly6yRKMALCU/KBJ8kUUUUBAKMNBT+BUUUBM+KmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUF/8MBALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM/dLEK97FaF97GXGXAGCI9HQBAF9FQFCBRGEXABABDBBBHECiD+rFCiD+sFD/6FHIAECND+rFCiD+sFD/6FAID/gFAECTD+rFCiD+sFD/6FHLD/gFD/kFD/lFHKCBDtD+2FHOAICUUUU94DtHND9OD9RD/kFHI9DBB/+hDYAIAID/mFAKAKD/mFALAOALAND9OD9RD/kFHIAID/mFD/kFD/kFD/jFD/nFHLD/mF9DBBX9LDYHOD/kFCgFDtD9OAECUUU94DtD9OD9QAIALD/mFAOD/kFCND+rFCU/+EDtD9OD9QAKALD/mFAOD/kFCTD+rFCUU/8ODtD9OD9QDMBBABCTJRBAGCIJHGAF9JQBSGMMAF9FQBCBRGEXABCTJHVAVDBBBHECBDtHOCUU98D8cFCUU98D8cEHND9OABDBBBHKAEDQILKOSQfbPden8c8d8e8fCggFDtD9OD/6FAKAEDQBFGENVcMTtmYi8ZpyHECTD+sFD/6FHID/gFAECTD+rFCTD+sFD/6FHLD/gFD/kFD/lFHE9DB/+g6DYALAEAOD+2FHOALCUUUU94DtHcD9OD9RD/kFHLALD/mFAEAED/mFAIAOAIAcD9OD9RD/kFHEAED/mFD/kFD/kFD/jFD/nFHID/mF9DBBX9LDYHOD/kFCTD+rFALAID/mFAOD/kFCggEDtD9OD9QHLAEAID/mFAOD/kFCaDbCBDnGCBDnECBDnKCBDnOCBDncCBDnMCBDnfCBDnbD9OHEDQNVi8ZcMpySQ8c8dfb8e8fD9QDMBBABAKAND9OALAEDQBFTtGEmYILPdKOenD9QDMBBABCAJRBAGCIJHGAF9JQBMMM/hEIGaF97FaL978jUUUUBCTlREGXAF9FQBCBRIEXAEABDBBBHLABCTJHKDBBBHODQILKOSQfbPden8c8d8e8fHNCTD+sFHVCID+rFDMIBAB9DBBU8/DY9D/zI818/DYAVCEDtD9QD/6FD/nFHVALAODQBFGENVcMTtmYi8ZpyHLCTD+rFCTD+sFD/6FD/mFHOAOD/mFAVALCTD+sFD/6FD/mFHcAcD/mFAVANCTD+rFCTD+sFD/6FD/mFHNAND/mFD/kFD/kFD/lFCBDtD+4FD/jF9DB/+g6DYHVD/mF9DBBX9LDYHLD/kFCggEDtHMD9OAcAVD/mFALD/kFCTD+rFD9QHcANAVD/mFALD/kFCTD+rFAOAVD/mFALD/kFAMD9OD9QHVDQBFTtGEmYILPdKOenHLD8dBAEDBIBDyB+t+J83EBABCNJALD8dFAEDBIBDyF+t+J83EBAKAcAVDQNVi8ZcMpySQ8c8dfb8e8fHVD8dBAEDBIBDyG+t+J83EBABCiJAVD8dFAEDBIBDyE+t+J83EBABCAJRBAICIJHIAF9JQBMMM9jFF97GXAGCGrAF9sHG9FQBCBRFEXABABDBBBHECND+rFCND+sFD/6FAECiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMBBABCTJRBAFCIJHFAG9JQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEMMMFBCUNMIT9tBB",t=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),i=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]);if(typeof WebAssembly!="object")return{supported:!1};let a=n;WebAssembly.validate(t)&&(a=e);let o;const r=WebAssembly.instantiate(s(a),{}).then(C=>{o=C.instance,o.exports.__wasm_call_ctors()});function s(C){const h=new Uint8Array(C.length);for(let p=0;p<C.length;++p){const B=C.charCodeAt(p);h[p]=B>96?B-71:B>64?B-65:B>47?B+4:B>46?63:62}let m=0;for(let p=0;p<C.length;++p)h[m++]=h[p]<60?i[h[p]]:(h[p]-60)*64+h[++p];return h.buffer.slice(0,m)}function l(C,h,m,p,B,b){const y=o.exports.sbrk,S=m+3&-4,R=y(S*p),Z=y(B.length),x=new Uint8Array(o.exports.memory.buffer);x.set(B,Z);const M=C(R,m,p,Z,B.length);if(M===0&&b&&b(R,S,p),h.set(x.subarray(R,R+m*p)),y(R-y(0)),M!==0)throw new Error(`Malformed buffer data: ${M}`)}const c={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},u={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return kv={ready:r,supported:!0,decodeVertexBuffer(C,h,m,p,B){l(o.exports.meshopt_decodeVertexBuffer,C,h,m,p,o.exports[c[B]])},decodeIndexBuffer(C,h,m,p){l(o.exports.meshopt_decodeIndexBuffer,C,h,m,p)},decodeIndexSequence(C,h,m,p){l(o.exports.meshopt_decodeIndexSequence,C,h,m,p)},decodeGltfBuffer(C,h,m,p,B,b){l(o.exports[u[B]],C,h,m,p,o.exports[c[b]])}},kv};function b$(){var n=Object.create(null);function e(a,o){var r=a.id,s=a.name,l=a.dependencies;l===void 0&&(l=[]);var c=a.init;c===void 0&&(c=function(){});var u=a.getTransferables;if(u===void 0&&(u=null),!n[r])try{l=l.map(function(h){return h&&h.isWorkerModule&&(e(h,function(m){if(m instanceof Error)throw m}),h=n[h.id].value),h}),c=i("<"+s+">.init",c),u&&(u=i("<"+s+">.getTransferables",u));var C=null;typeof c=="function"?C=c.apply(void 0,l):console.error("worker module init function failed to rehydrate"),n[r]={id:r,value:C,getTransferables:u},o(C)}catch(h){h&&h.noLog||console.error(h),o(h)}}function t(a,o){var r,s=a.id,l=a.args;(!n[s]||typeof n[s].value!="function")&&o(new Error("Worker module "+s+": not found or its 'init' did not return a function"));try{var c=(r=n[s]).value.apply(r,l);c&&typeof c.then=="function"?c.then(u,function(C){return o(C instanceof Error?C:new Error(""+C))}):u(c)}catch(C){o(C)}function u(C){try{var h=n[s].getTransferables&&n[s].getTransferables(C);(!h||!Array.isArray(h)||!h.length)&&(h=void 0),o(C,h)}catch(m){console.error(m),o(m)}}}function i(a,o){var r=void 0;self.troikaDefine=function(l){return r=l};var s=URL.createObjectURL(new Blob(["/** "+a.replace(/\*/g,"")+` **/

troikaDefine(
`+o+`
)`],{type:"application/javascript"}));try{importScripts(s)}catch(l){console.error(l)}return URL.revokeObjectURL(s),delete self.troikaDefine,r}self.addEventListener("message",function(a){var o=a.data,r=o.messageId,s=o.action,l=o.data;try{s==="registerModule"&&e(l,function(c){c instanceof Error?postMessage({messageId:r,success:!1,error:c.message}):postMessage({messageId:r,success:!0,result:{isCallable:typeof c=="function"}})}),s==="callModule"&&t(l,function(c,u){c instanceof Error?postMessage({messageId:r,success:!1,error:c.message}):postMessage({messageId:r,success:!0,result:c},u||void 0)})}catch(c){postMessage({messageId:r,success:!1,error:c.stack})}})}function v$(n){var e=function(){for(var t=[],i=arguments.length;i--;)t[i]=arguments[i];return e._getInitResult().then(function(a){if(typeof a=="function")return a.apply(void 0,t);throw new Error("Worker module function was called but `init` did not return a callable function")})};return e._getInitResult=function(){var t=n.dependencies,i=n.init;t=Array.isArray(t)?t.map(function(o){return o&&(o=o.onMainThread||o,o._getInitResult&&(o=o._getInitResult())),o}):[];var a=Promise.all(t).then(function(o){return i.apply(null,o)});return e._getInitResult=function(){return a},a},e}var hT=function(){var n=!1;if(typeof window<"u"&&typeof window.document<"u")try{var e=new Worker(URL.createObjectURL(new Blob([""],{type:"application/javascript"})));e.terminate(),n=!0}catch(t){console.log("Troika createWorkerModule: web workers not allowed; falling back to main thread execution. Cause: ["+t.message+"]")}return hT=function(){return n},n},y$=0,B$=0,Mw=!1,Cp=Object.create(null),Ip=Object.create(null),CR=Object.create(null);function jf(n){if((!n||typeof n.init!="function")&&!Mw)throw new Error("requires `options.init` function");var e=n.dependencies,t=n.init,i=n.getTransferables,a=n.workerId,o=v$(n);a==null&&(a="#default");var r="workerModule"+ ++y$,s=n.name||r,l=null;e=e&&e.map(function(u){return typeof u=="function"&&!u.workerModuleData&&(Mw=!0,u=jf({workerId:a,name:"<"+s+"> function dependency: "+u.name,init:`function(){return (
`+Ry(u)+`
)}`}),Mw=!1),u&&u.workerModuleData&&(u=u.workerModuleData),u});function c(){for(var u=[],C=arguments.length;C--;)u[C]=arguments[C];if(!hT())return o.apply(void 0,u);if(!l){l=yE(a,"registerModule",c.workerModuleData);var h=function(){l=null,Ip[a].delete(h)};(Ip[a]||(Ip[a]=new Set)).add(h)}return l.then(function(m){var p=m.isCallable;if(p)return yE(a,"callModule",{id:r,args:u});throw new Error("Worker module function was called but `init` did not return a callable function")})}return c.workerModuleData={isWorkerModule:!0,id:r,name:s,dependencies:e,init:Ry(t),getTransferables:i&&Ry(i)},c.onMainThread=o,c}function G$(n){Ip[n]&&Ip[n].forEach(function(e){e()}),Cp[n]&&(Cp[n].terminate(),delete Cp[n])}function Ry(n){var e=n.toString();return!/^function/.test(e)&&/^\w+\s*\(/.test(e)&&(e="function "+e),e}function S$(n){var e=Cp[n];if(!e){var t=Ry(b$);e=Cp[n]=new Worker(URL.createObjectURL(new Blob(["/** Worker Module Bootstrap: "+n.replace(/\*/g,"")+` **/

;(`+t+")()"],{type:"application/javascript"}))),e.onmessage=function(i){var a=i.data,o=a.messageId,r=CR[o];if(!r)throw new Error("WorkerModule response with empty or unknown messageId");delete CR[o],r(a)}}return e}function yE(n,e,t){return new Promise(function(i,a){var o=++B$;CR[o]=function(r){r.success?i(r.result):a(new Error("Error in worker "+e+" call: "+r.error))},S$(n).postMessage({messageId:o,action:e,data:t})})}function fT(){var n=function(e){function t(q,K,O,j,ne,k,ie,re){var ge=1-ie;re.x=ge*ge*q+2*ge*ie*O+ie*ie*ne,re.y=ge*ge*K+2*ge*ie*j+ie*ie*k}function i(q,K,O,j,ne,k,ie,re,ge,de){var xe=1-ge;de.x=xe*xe*xe*q+3*xe*xe*ge*O+3*xe*ge*ge*ne+ge*ge*ge*ie,de.y=xe*xe*xe*K+3*xe*xe*ge*j+3*xe*ge*ge*k+ge*ge*ge*re}function a(q,K){for(var O=/([MLQCZ])([^MLQCZ]*)/g,j,ne,k,ie,re;j=O.exec(q);){var ge=j[2].replace(/^\s*|\s*$/g,"").split(/[,\s]+/).map(function(de){return parseFloat(de)});switch(j[1]){case"M":ie=ne=ge[0],re=k=ge[1];break;case"L":(ge[0]!==ie||ge[1]!==re)&&K("L",ie,re,ie=ge[0],re=ge[1]);break;case"Q":{K("Q",ie,re,ie=ge[2],re=ge[3],ge[0],ge[1]);break}case"C":{K("C",ie,re,ie=ge[4],re=ge[5],ge[0],ge[1],ge[2],ge[3]);break}case"Z":(ie!==ne||re!==k)&&K("L",ie,re,ne,k);break}}}function o(q,K,O){O===void 0&&(O=16);var j={x:0,y:0};a(q,function(ne,k,ie,re,ge,de,xe,Ne,ye){switch(ne){case"L":K(k,ie,re,ge);break;case"Q":{for(var pe=k,Te=ie,le=1;le<O;le++)t(k,ie,de,xe,re,ge,le/(O-1),j),K(pe,Te,j.x,j.y),pe=j.x,Te=j.y;break}case"C":{for(var Ye=k,he=ie,Ge=1;Ge<O;Ge++)i(k,ie,de,xe,Ne,ye,re,ge,Ge/(O-1),j),K(Ye,he,j.x,j.y),Ye=j.x,he=j.y;break}}})}var r="precision highp float;attribute vec2 aUV;varying vec2 vUV;void main(){vUV=aUV;gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",s="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){gl_FragColor=texture2D(tex,vUV);}",l=new WeakMap,c={premultipliedAlpha:!1,preserveDrawingBuffer:!0,antialias:!1,depth:!1};function u(q,K){var O=q.getContext?q.getContext("webgl",c):q,j=l.get(O);if(!j){let Ye=function(ee){var Q=k[ee];if(!Q&&(Q=k[ee]=O.getExtension(ee),!Q))throw new Error(ee+" not supported");return Q},he=function(ee,Q){var ce=O.createShader(Q);return O.shaderSource(ce,ee),O.compileShader(ce),ce},Ge=function(ee,Q,ce,me){if(!ie[ee]){var Ze={},Xe={},De=O.createProgram();O.attachShader(De,he(Q,O.VERTEX_SHADER)),O.attachShader(De,he(ce,O.FRAGMENT_SHADER)),O.linkProgram(De),ie[ee]={program:De,transaction:function(Je){O.useProgram(De),Je({setUniform:function(qe,lt){for(var $e=[],je=arguments.length-2;je-- >0;)$e[je]=arguments[je+2];var ke=Xe[lt]||(Xe[lt]=O.getUniformLocation(De,lt));O["uniform"+qe].apply(O,[ke].concat($e))},setAttribute:function(qe,lt,$e,je,ke){var Ce=Ze[qe];Ce||(Ce=Ze[qe]={buf:O.createBuffer(),loc:O.getAttribLocation(De,qe),data:null}),O.bindBuffer(O.ARRAY_BUFFER,Ce.buf),O.vertexAttribPointer(Ce.loc,lt,O.FLOAT,!1,0,0),O.enableVertexAttribArray(Ce.loc),ne?O.vertexAttribDivisor(Ce.loc,je):Ye("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(Ce.loc,je),ke!==Ce.data&&(O.bufferData(O.ARRAY_BUFFER,ke,$e),Ce.data=ke)}})}}}ie[ee].transaction(me)},be=function(ee,Q){ge++;try{O.activeTexture(O.TEXTURE0+ge);var ce=re[ee];ce||(ce=re[ee]=O.createTexture(),O.bindTexture(O.TEXTURE_2D,ce),O.texParameteri(O.TEXTURE_2D,O.TEXTURE_MIN_FILTER,O.NEAREST),O.texParameteri(O.TEXTURE_2D,O.TEXTURE_MAG_FILTER,O.NEAREST)),O.bindTexture(O.TEXTURE_2D,ce),Q(ce,ge)}finally{ge--}},Ee=function(ee,Q,ce){var me=O.createFramebuffer();de.push(me),O.bindFramebuffer(O.FRAMEBUFFER,me),O.activeTexture(O.TEXTURE0+Q),O.bindTexture(O.TEXTURE_2D,ee),O.framebufferTexture2D(O.FRAMEBUFFER,O.COLOR_ATTACHMENT0,O.TEXTURE_2D,ee,0);try{ce(me)}finally{O.deleteFramebuffer(me),O.bindFramebuffer(O.FRAMEBUFFER,de[--de.length-1]||null)}},Se=function(){k={},ie={},re={},ge=-1,de.length=0};var xe=Ye,Ne=he,ye=Ge,pe=be,Te=Ee,le=Se,ne=typeof WebGL2RenderingContext<"u"&&O instanceof WebGL2RenderingContext,k={},ie={},re={},ge=-1,de=[];O.canvas.addEventListener("webglcontextlost",function(ee){Se(),ee.preventDefault()},!1),l.set(O,j={gl:O,isWebGL2:ne,getExtension:Ye,withProgram:Ge,withTexture:be,withTextureFramebuffer:Ee,handleContextLoss:Se})}K(j)}function C(q,K,O,j,ne,k,ie,re){ie===void 0&&(ie=15),re===void 0&&(re=null),u(q,function(ge){var de=ge.gl,xe=ge.withProgram,Ne=ge.withTexture;Ne("copy",function(ye,pe){de.texImage2D(de.TEXTURE_2D,0,de.RGBA,ne,k,0,de.RGBA,de.UNSIGNED_BYTE,K),xe("copy",r,s,function(Te){var le=Te.setUniform,Ye=Te.setAttribute;Ye("aUV",2,de.STATIC_DRAW,0,new Float32Array([0,0,2,0,0,2])),le("1i","image",pe),de.bindFramebuffer(de.FRAMEBUFFER,re||null),de.disable(de.BLEND),de.colorMask(ie&8,ie&4,ie&2,ie&1),de.viewport(O,j,ne,k),de.scissor(O,j,ne,k),de.drawArrays(de.TRIANGLES,0,3)})})})}function h(q,K,O){var j=q.width,ne=q.height;u(q,function(k){var ie=k.gl,re=new Uint8Array(j*ne*4);ie.readPixels(0,0,j,ne,ie.RGBA,ie.UNSIGNED_BYTE,re),q.width=K,q.height=O,C(ie,re,0,0,j,ne)})}var m=Object.freeze({__proto__:null,withWebGLContext:u,renderImageData:C,resizeWebGLCanvasWithoutClearing:h});function p(q,K,O,j,ne,k){k===void 0&&(k=1);var ie=new Uint8Array(q*K),re=j[2]-j[0],ge=j[3]-j[1],de=[];o(O,function(Ye,he,Ge,be){de.push({x1:Ye,y1:he,x2:Ge,y2:be,minX:Math.min(Ye,Ge),minY:Math.min(he,be),maxX:Math.max(Ye,Ge),maxY:Math.max(he,be)})}),de.sort(function(Ye,he){return Ye.maxX-he.maxX});for(var xe=0;xe<q;xe++)for(var Ne=0;Ne<K;Ne++){var ye=Te(j[0]+re*(xe+.5)/q,j[1]+ge*(Ne+.5)/K),pe=Math.pow(1-Math.abs(ye)/ne,k)/2;ye<0&&(pe=1-pe),pe=Math.max(0,Math.min(255,Math.round(pe*255))),ie[Ne*q+xe]=pe}return ie;function Te(Ye,he){for(var Ge=1/0,be=1/0,Ee=de.length;Ee--;){var Se=de[Ee];if(Se.maxX+be<=Ye)break;if(Ye+be>Se.minX&&he-be<Se.maxY&&he+be>Se.minY){var ee=y(Ye,he,Se.x1,Se.y1,Se.x2,Se.y2);ee<Ge&&(Ge=ee,be=Math.sqrt(Ge))}}return le(Ye,he)&&(be=-be),be}function le(Ye,he){for(var Ge=0,be=de.length;be--;){var Ee=de[be];if(Ee.maxX<=Ye)break;var Se=Ee.y1>he!=Ee.y2>he&&Ye<(Ee.x2-Ee.x1)*(he-Ee.y1)/(Ee.y2-Ee.y1)+Ee.x1;Se&&(Ge+=Ee.y1<Ee.y2?1:-1)}return Ge!==0}}function B(q,K,O,j,ne,k,ie,re,ge,de){k===void 0&&(k=1),re===void 0&&(re=0),ge===void 0&&(ge=0),de===void 0&&(de=0),b(q,K,O,j,ne,k,ie,null,re,ge,de)}function b(q,K,O,j,ne,k,ie,re,ge,de,xe){k===void 0&&(k=1),ge===void 0&&(ge=0),de===void 0&&(de=0),xe===void 0&&(xe=0);for(var Ne=p(q,K,O,j,ne,k),ye=new Uint8Array(Ne.length*4),pe=0;pe<Ne.length;pe++)ye[pe*4+xe]=Ne[pe];C(ie,ye,ge,de,q,K,1<<3-xe,re)}function y(q,K,O,j,ne,k){var ie=ne-O,re=k-j,ge=ie*ie+re*re,de=ge?Math.max(0,Math.min(1,((q-O)*ie+(K-j)*re)/ge)):0,xe=q-(O+de*ie),Ne=K-(j+de*re);return xe*xe+Ne*Ne}var S=Object.freeze({__proto__:null,generate:p,generateIntoCanvas:B,generateIntoFramebuffer:b}),R="precision highp float;uniform vec4 uGlyphBounds;attribute vec2 aUV;attribute vec4 aLineSegment;varying vec4 vLineSegment;varying vec2 vGlyphXY;void main(){vLineSegment=aLineSegment;vGlyphXY=mix(uGlyphBounds.xy,uGlyphBounds.zw,aUV);gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",Z="precision highp float;uniform vec4 uGlyphBounds;uniform float uMaxDistance;uniform float uExponent;varying vec4 vLineSegment;varying vec2 vGlyphXY;float absDistToSegment(vec2 point,vec2 lineA,vec2 lineB){vec2 lineDir=lineB-lineA;float lenSq=dot(lineDir,lineDir);float t=lenSq==0.0 ? 0.0 : clamp(dot(point-lineA,lineDir)/lenSq,0.0,1.0);vec2 linePt=lineA+t*lineDir;return distance(point,linePt);}void main(){vec4 seg=vLineSegment;vec2 p=vGlyphXY;float dist=absDistToSegment(p,seg.xy,seg.zw);float val=pow(1.0-clamp(dist/uMaxDistance,0.0,1.0),uExponent)*0.5;bool crossing=(seg.y>p.y!=seg.w>p.y)&&(p.x<(seg.z-seg.x)*(p.y-seg.y)/(seg.w-seg.y)+seg.x);bool crossingUp=crossing&&vLineSegment.y<vLineSegment.w;gl_FragColor=vec4(crossingUp ? 1.0/255.0 : 0.0,crossing&&!crossingUp ? 1.0/255.0 : 0.0,0.0,val);}",x="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){vec4 color=texture2D(tex,vUV);bool inside=color.r!=color.g;float val=inside ? 1.0-color.a : color.a;gl_FragColor=vec4(val);}",M=new Float32Array([0,0,2,0,0,2]),E=null,F=!1,N={},H=new WeakMap;function z(q){if(!F&&!$(q))throw new Error("WebGL generation not supported")}function _(q,K,O,j,ne,k,ie){if(k===void 0&&(k=1),ie===void 0&&(ie=null),!ie&&(ie=E,!ie)){var re=typeof OffscreenCanvas=="function"?new OffscreenCanvas(1,1):typeof document<"u"?document.createElement("canvas"):null;if(!re)throw new Error("OffscreenCanvas or DOM canvas not supported");ie=E=re.getContext("webgl",{depth:!1})}z(ie);var ge=new Uint8Array(q*K*4);u(ie,function(ye){var pe=ye.gl,Te=ye.withTexture,le=ye.withTextureFramebuffer;Te("readable",function(Ye,he){pe.texImage2D(pe.TEXTURE_2D,0,pe.RGBA,q,K,0,pe.RGBA,pe.UNSIGNED_BYTE,null),le(Ye,he,function(Ge){P(q,K,O,j,ne,k,pe,Ge,0,0,0),pe.readPixels(0,0,q,K,pe.RGBA,pe.UNSIGNED_BYTE,ge)})})});for(var de=new Uint8Array(q*K),xe=0,Ne=0;xe<ge.length;xe+=4)de[Ne++]=ge[xe];return de}function D(q,K,O,j,ne,k,ie,re,ge,de){k===void 0&&(k=1),re===void 0&&(re=0),ge===void 0&&(ge=0),de===void 0&&(de=0),P(q,K,O,j,ne,k,ie,null,re,ge,de)}function P(q,K,O,j,ne,k,ie,re,ge,de,xe){k===void 0&&(k=1),ge===void 0&&(ge=0),de===void 0&&(de=0),xe===void 0&&(xe=0),z(ie);var Ne=[];o(O,function(ye,pe,Te,le){Ne.push(ye,pe,Te,le)}),Ne=new Float32Array(Ne),u(ie,function(ye){var pe=ye.gl,Te=ye.isWebGL2,le=ye.getExtension,Ye=ye.withProgram,he=ye.withTexture,Ge=ye.withTextureFramebuffer,be=ye.handleContextLoss;if(he("rawDistances",function(Ee,Se){(q!==Ee._lastWidth||K!==Ee._lastHeight)&&pe.texImage2D(pe.TEXTURE_2D,0,pe.RGBA,Ee._lastWidth=q,Ee._lastHeight=K,0,pe.RGBA,pe.UNSIGNED_BYTE,null),Ye("main",R,Z,function(ee){var Q=ee.setAttribute,ce=ee.setUniform,me=!Te&&le("ANGLE_instanced_arrays"),Ze=!Te&&le("EXT_blend_minmax");Q("aUV",2,pe.STATIC_DRAW,0,M),Q("aLineSegment",4,pe.DYNAMIC_DRAW,1,Ne),ce.apply(void 0,["4f","uGlyphBounds"].concat(j)),ce("1f","uMaxDistance",ne),ce("1f","uExponent",k),Ge(Ee,Se,function(Xe){pe.enable(pe.BLEND),pe.colorMask(!0,!0,!0,!0),pe.viewport(0,0,q,K),pe.scissor(0,0,q,K),pe.blendFunc(pe.ONE,pe.ONE),pe.blendEquationSeparate(pe.FUNC_ADD,Te?pe.MAX:Ze.MAX_EXT),pe.clear(pe.COLOR_BUFFER_BIT),Te?pe.drawArraysInstanced(pe.TRIANGLES,0,3,Ne.length/4):me.drawArraysInstancedANGLE(pe.TRIANGLES,0,3,Ne.length/4)})}),Ye("post",r,x,function(ee){ee.setAttribute("aUV",2,pe.STATIC_DRAW,0,M),ee.setUniform("1i","tex",Se),pe.bindFramebuffer(pe.FRAMEBUFFER,re),pe.disable(pe.BLEND),pe.colorMask(xe===0,xe===1,xe===2,xe===3),pe.viewport(ge,de,q,K),pe.scissor(ge,de,q,K),pe.drawArrays(pe.TRIANGLES,0,3)})}),pe.isContextLost())throw be(),new Error("webgl context lost")})}function $(q){var K=!q||q===E?N:q.canvas||q,O=H.get(K);if(O===void 0){F=!0;var j=null;try{var ne=[97,106,97,61,99,137,118,80,80,118,137,99,61,97,106,97],k=_(4,4,"M8,8L16,8L24,24L16,24Z",[0,0,32,32],24,1,q);O=k&&ne.length===k.length&&k.every(function(ie,re){return ie===ne[re]}),O||(j="bad trial run results",console.info(ne,k))}catch(ie){O=!1,j=ie.message}j&&console.warn("WebGL SDF generation not supported:",j),F=!1,H.set(K,O)}return O}var X=Object.freeze({__proto__:null,generate:_,generateIntoCanvas:D,generateIntoFramebuffer:P,isSupported:$});function L(q,K,O,j,ne,k){ne===void 0&&(ne=Math.max(j[2]-j[0],j[3]-j[1])/2),k===void 0&&(k=1);try{return _.apply(X,arguments)}catch(ie){return console.info("WebGL SDF generation failed, falling back to JS",ie),p.apply(S,arguments)}}function U(q,K,O,j,ne,k,ie,re,ge,de){ne===void 0&&(ne=Math.max(j[2]-j[0],j[3]-j[1])/2),k===void 0&&(k=1),re===void 0&&(re=0),ge===void 0&&(ge=0),de===void 0&&(de=0);try{return D.apply(X,arguments)}catch(xe){return console.info("WebGL SDF generation failed, falling back to JS",xe),B.apply(S,arguments)}}return e.forEachPathCommand=a,e.generate=L,e.generateIntoCanvas=U,e.javascript=S,e.pathToLineSegments=o,e.webgl=X,e.webglUtils=m,Object.defineProperty(e,"__esModule",{value:!0}),e}({});return n}function w$(){var n=function(e){var t={R:"13k,1a,2,3,3,2+1j,ch+16,a+1,5+2,2+n,5,a,4,6+16,4+3,h+1b,4mo,179q,2+9,2+11,2i9+7y,2+68,4,3+4,5+13,4+3,2+4k,3+29,8+cf,1t+7z,w+17,3+3m,1t+3z,16o1+5r,8+30,8+mc,29+1r,29+4v,75+73",EN:"1c+9,3d+1,6,187+9,513,4+5,7+9,sf+j,175h+9,qw+q,161f+1d,4xt+a,25i+9",ES:"17,2,6dp+1,f+1,av,16vr,mx+1,4o,2",ET:"z+2,3h+3,b+1,ym,3e+1,2o,p4+1,8,6u,7c,g6,1wc,1n9+4,30+1b,2n,6d,qhx+1,h0m,a+1,49+2,63+1,4+1,6bb+3,12jj",AN:"16o+5,2j+9,2+1,35,ed,1ff2+9,87+u",CS:"18,2+1,b,2u,12k,55v,l,17v0,2,3,53,2+1,b",B:"a,3,f+2,2v,690",S:"9,2,k",WS:"c,k,4f4,1vk+a,u,1j,335",ON:"x+1,4+4,h+5,r+5,r+3,z,5+3,2+1,2+1,5,2+2,3+4,o,w,ci+1,8+d,3+d,6+8,2+g,39+1,9,6+1,2,33,b8,3+1,3c+1,7+1,5r,b,7h+3,sa+5,2,3i+6,jg+3,ur+9,2v,ij+1,9g+9,7+a,8m,4+1,49+x,14u,2+2,c+2,e+2,e+2,e+1,i+n,e+e,2+p,u+2,e+2,36+1,2+3,2+1,b,2+2,6+5,2,2,2,h+1,5+4,6+3,3+f,16+2,5+3l,3+81,1y+p,2+40,q+a,m+13,2r+ch,2+9e,75+hf,3+v,2+2w,6e+5,f+6,75+2a,1a+p,2+2g,d+5x,r+b,6+3,4+o,g,6+1,6+2,2k+1,4,2j,5h+z,1m+1,1e+f,t+2,1f+e,d+3,4o+3,2s+1,w,535+1r,h3l+1i,93+2,2s,b+1,3l+x,2v,4g+3,21+3,kz+1,g5v+1,5a,j+9,n+v,2,3,2+8,2+1,3+2,2,3,46+1,4+4,h+5,r+5,r+a,3h+2,4+6,b+4,78,1r+24,4+c,4,1hb,ey+6,103+j,16j+c,1ux+7,5+g,fsh,jdq+1t,4,57+2e,p1,1m,1m,1m,1m,4kt+1,7j+17,5+2r,d+e,3+e,2+e,2+10,m+4,w,1n+5,1q,4z+5,4b+rb,9+c,4+c,4+37,d+2g,8+b,l+b,5+1j,9+9,7+13,9+t,3+1,27+3c,2+29,2+3q,d+d,3+4,4+2,6+6,a+o,8+6,a+2,e+6,16+42,2+1i",BN:"0+8,6+d,2s+5,2+p,e,4m9,1kt+2,2b+5,5+5,17q9+v,7k,6p+8,6+1,119d+3,440+7,96s+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+75,6p+2rz,1ben+1,1ekf+1,1ekf+1",NSM:"lc+33,7o+6,7c+18,2,2+1,2+1,2,21+a,1d+k,h,2u+6,3+5,3+1,2+3,10,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,g+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+g,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,k1+w,2db+2,3y,2p+v,ff+3,30+1,n9x+3,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,r2,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+5,3+1,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2d+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,f0c+4,1o+6,t5,1s+3,2a,f5l+1,43t+2,i+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,gzhy+6n",AL:"16w,3,2,e+1b,z+2,2+2s,g+1,8+1,b+m,2+t,s+2i,c+e,4h+f,1d+1e,1bwe+dp,3+3z,x+c,2+1,35+3y,2rm+z,5+7,b+5,dt+l,c+u,17nl+27,1t+27,4x+6n,3+d",LRO:"6ct",RLO:"6cu",LRE:"6cq",RLE:"6cr",PDF:"6cs",LRI:"6ee",RLI:"6ef",FSI:"6eg",PDI:"6eh"},i={},a={};i.L=1,a[1]="L",Object.keys(t).forEach(function(be,Ee){i[be]=1<<Ee+1,a[i[be]]=be}),Object.freeze(i);var o=i.LRI|i.RLI|i.FSI,r=i.L|i.R|i.AL,s=i.B|i.S|i.WS|i.ON|i.FSI|i.LRI|i.RLI|i.PDI,l=i.BN|i.RLE|i.LRE|i.RLO|i.LRO|i.PDF,c=i.S|i.WS|i.B|o|i.PDI|l,u=null;function C(){if(!u){u=new Map;var be=function(Se){if(t.hasOwnProperty(Se)){var ee=0;t[Se].split(",").forEach(function(Q){var ce=Q.split("+"),me=ce[0],Ze=ce[1];me=parseInt(me,36),Ze=Ze?parseInt(Ze,36):0,u.set(ee+=me,i[Se]);for(var Xe=0;Xe<Ze;Xe++)u.set(++ee,i[Se])})}};for(var Ee in t)be(Ee)}}function h(be){return C(),u.get(be.codePointAt(0))||i.L}function m(be){return a[h(be)]}var p={pairs:"14>1,1e>2,u>2,2wt>1,1>1,1ge>1,1wp>1,1j>1,f>1,hm>1,1>1,u>1,u6>1,1>1,+5,28>1,w>1,1>1,+3,b8>1,1>1,+3,1>3,-1>-1,3>1,1>1,+2,1s>1,1>1,x>1,th>1,1>1,+2,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,4q>1,1e>2,u>2,2>1,+1",canonical:"6f1>-6dx,6dy>-6dx,6ec>-6ed,6ee>-6ed,6ww>2jj,-2ji>2jj,14r4>-1e7l,1e7m>-1e7l,1e7m>-1e5c,1e5d>-1e5b,1e5c>-14qx,14qy>-14qx,14vn>-1ecg,1ech>-1ecg,1edu>-1ecg,1eci>-1ecg,1eda>-1ecg,1eci>-1ecg,1eci>-168q,168r>-168q,168s>-14ye,14yf>-14ye"};function B(be,Ee){var Se=36,ee=0,Q=new Map,ce=Ee&&new Map,me;return be.split(",").forEach(function Ze(Xe){if(Xe.indexOf("+")!==-1)for(var De=+Xe;De--;)Ze(me);else{me=Xe;var Oe=Xe.split(">"),Je=Oe[0],At=Oe[1];Je=String.fromCodePoint(ee+=parseInt(Je,Se)),At=String.fromCodePoint(ee+=parseInt(At,Se)),Q.set(Je,At),Ee&&ce.set(At,Je)}}),{map:Q,reverseMap:ce}}var b,y,S;function R(){if(!b){var be=B(p.pairs,!0),Ee=be.map,Se=be.reverseMap;b=Ee,y=Se,S=B(p.canonical,!1).map}}function Z(be){return R(),b.get(be)||null}function x(be){return R(),y.get(be)||null}function M(be){return R(),S.get(be)||null}var E=i.L,F=i.R,N=i.EN,H=i.ES,z=i.ET,_=i.AN,D=i.CS,P=i.B,$=i.S,X=i.ON,L=i.BN,U=i.NSM,q=i.AL,K=i.LRO,O=i.RLO,j=i.LRE,ne=i.RLE,k=i.PDF,ie=i.LRI,re=i.RLI,ge=i.FSI,de=i.PDI;function xe(be,Ee){for(var Se=125,ee=new Uint32Array(be.length),Q=0;Q<be.length;Q++)ee[Q]=h(be[Q]);var ce=new Map;function me(ao,$o){var xa=ee[ao];ee[ao]=$o,ce.set(xa,ce.get(xa)-1),xa&s&&ce.set(s,ce.get(s)-1),ce.set($o,(ce.get($o)||0)+1),$o&s&&ce.set(s,(ce.get(s)||0)+1)}for(var Ze=new Uint8Array(be.length),Xe=new Map,De=[],Oe=null,Je=0;Je<be.length;Je++)Oe||De.push(Oe={start:Je,end:be.length-1,level:Ee==="rtl"?1:Ee==="ltr"?0:Md(Je,!1)}),ee[Je]&P&&(Oe.end=Je,Oe=null);for(var At=ne|j|O|K|o|de|k|P,qe=function(ao){return ao+(ao&1?1:2)},lt=function(ao){return ao+(ao&1?2:1)},$e=0;$e<De.length;$e++){Oe=De[$e];var je=[{_level:Oe.level,_override:0,_isolate:0}],ke=void 0,Ce=0,He=0,ht=0;ce.clear();for(var we=Oe.start;we<=Oe.end;we++){var ze=ee[we];if(ke=je[je.length-1],ce.set(ze,(ce.get(ze)||0)+1),ze&s&&ce.set(s,(ce.get(s)||0)+1),ze&At)if(ze&(ne|j)){Ze[we]=ke._level;var Qe=(ze===ne?lt:qe)(ke._level);Qe<=Se&&!Ce&&!He?je.push({_level:Qe,_override:0,_isolate:0}):Ce||He++}else if(ze&(O|K)){Ze[we]=ke._level;var ut=(ze===O?lt:qe)(ke._level);ut<=Se&&!Ce&&!He?je.push({_level:ut,_override:ze&O?F:E,_isolate:0}):Ce||He++}else if(ze&o){ze&ge&&(ze=Md(we+1,!0)===1?re:ie),Ze[we]=ke._level,ke._override&&me(we,ke._override);var Rt=(ze===re?lt:qe)(ke._level);Rt<=Se&&Ce===0&&He===0?(ht++,je.push({_level:Rt,_override:0,_isolate:1,_isolInitIndex:we})):Ce++}else if(ze&de){if(Ce>0)Ce--;else if(ht>0){for(He=0;!je[je.length-1]._isolate;)je.pop();var mt=je[je.length-1]._isolInitIndex;mt!=null&&(Xe.set(mt,we),Xe.set(we,mt)),je.pop(),ht--}ke=je[je.length-1],Ze[we]=ke._level,ke._override&&me(we,ke._override)}else ze&k?(Ce===0&&(He>0?He--:!ke._isolate&&je.length>1&&(je.pop(),ke=je[je.length-1])),Ze[we]=ke._level):ze&P&&(Ze[we]=Oe.level);else Ze[we]=ke._level,ke._override&&ze!==L&&me(we,ke._override)}for(var _t=[],Lt=null,Zt=Oe.start;Zt<=Oe.end;Zt++){var yt=ee[Zt];if(!(yt&l)){var Ht=Ze[Zt],jt=yt&o,Ut=yt===de;Lt&&Ht===Lt._level?(Lt._end=Zt,Lt._endsWithIsolInit=jt):_t.push(Lt={_start:Zt,_end:Zt,_level:Ht,_startsWithPDI:Ut,_endsWithIsolInit:jt})}}for(var Nt=[],Tt=0;Tt<_t.length;Tt++){var Pt=_t[Tt];if(!Pt._startsWithPDI||Pt._startsWithPDI&&!Xe.has(Pt._start)){for(var qt=[Lt=Pt],kt=void 0;Lt&&Lt._endsWithIsolInit&&(kt=Xe.get(Lt._end))!=null;)for(var Ft=Tt+1;Ft<_t.length;Ft++)if(_t[Ft]._start===kt){qt.push(Lt=_t[Ft]);break}for(var fn=[],sn=0;sn<qt.length;sn++)for(var ae=qt[sn],ue=ae._start;ue<=ae._end;ue++)fn.push(ue);for(var Fe=Ze[fn[0]],ot=Oe.level,at=fn[0]-1;at>=0;at--)if(!(ee[at]&l)){ot=Ze[at];break}var It=fn[fn.length-1],Wt=Ze[It],xt=Oe.level;if(!(ee[It]&o)){for(var te=It+1;te<=Oe.end;te++)if(!(ee[te]&l)){xt=Ze[te];break}}Nt.push({_seqIndices:fn,_sosType:Math.max(ot,Fe)%2?F:E,_eosType:Math.max(xt,Wt)%2?F:E})}}for(var Ie=0;Ie<Nt.length;Ie++){var Ae=Nt[Ie],se=Ae._seqIndices,Re=Ae._sosType,Ue=Ae._eosType,nt=Ze[se[0]]&1?F:E;if(ce.get(U))for(var pt=0;pt<se.length;pt++){var it=se[pt];if(ee[it]&U){for(var Bt=Re,Mt=pt-1;Mt>=0;Mt--)if(!(ee[se[Mt]]&l)){Bt=ee[se[Mt]];break}me(it,Bt&(o|de)?X:Bt)}}if(ce.get(N))for(var Yt=0;Yt<se.length;Yt++){var ln=se[Yt];if(ee[ln]&N)for(var on=Yt-1;on>=-1;on--){var vn=on===-1?Re:ee[se[on]];if(vn&r){vn===q&&me(ln,_);break}}}if(ce.get(q))for(var nn=0;nn<se.length;nn++){var mn=se[nn];ee[mn]&q&&me(mn,F)}if(ce.get(H)||ce.get(D))for(var gn=1;gn<se.length-1;gn++){var Xn=se[gn];if(ee[Xn]&(H|D)){for(var bn=0,cn=0,Jt=gn-1;Jt>=0&&(bn=ee[se[Jt]],!!(bn&l));Jt--);for(var Et=gn+1;Et<se.length&&(cn=ee[se[Et]],!!(cn&l));Et++);bn===cn&&(ee[Xn]===H?bn===N:bn&(N|_))&&me(Xn,bn)}}if(ce.get(N))for(var rn=0;rn<se.length;rn++){var Cn=se[rn];if(ee[Cn]&N){for(var Gn=rn-1;Gn>=0&&ee[se[Gn]]&(z|l);Gn--)me(se[Gn],N);for(rn++;rn<se.length&&ee[se[rn]]&(z|l|N);rn++)ee[se[rn]]!==N&&me(se[rn],N)}}if(ce.get(z)||ce.get(H)||ce.get(D))for(var pn=0;pn<se.length;pn++){var Kn=se[pn];if(ee[Kn]&(z|H|D)){me(Kn,X);for(var Qn=pn-1;Qn>=0&&ee[se[Qn]]&l;Qn--)me(se[Qn],X);for(var li=pn+1;li<se.length&&ee[se[li]]&l;li++)me(se[li],X)}}if(ce.get(N))for(var Zi=0,aa=Re;Zi<se.length;Zi++){var pa=se[Zi],oa=ee[pa];oa&N?aa===E&&me(pa,E):oa&r&&(aa=oa)}if(ce.get(s)){var mr=F|N|_,bc=mr|E,pr=[];{for(var Ki=[],Ua=0;Ua<se.length;Ua++)if(ee[se[Ua]]&s){var ba=be[se[Ua]],Ea=void 0;if(Z(ba)!==null)if(Ki.length<63)Ki.push({char:ba,seqIndex:Ua});else break;else if((Ea=x(ba))!==null)for(var po=Ki.length-1;po>=0;po--){var jo=Ki[po].char;if(jo===Ea||jo===x(M(ba))||Z(M(jo))===ba){pr.push([Ki[po].seqIndex,Ua]),Ki.length=po;break}}}pr.sort(function(ao,$o){return ao[0]-$o[0]})}for(var Jr=0;Jr<pr.length;Jr++){for(var br=pr[Jr],un=br[0],wn=br[1],hi=!1,Dn=0,Gi=un+1;Gi<wn;Gi++){var jr=se[Gi];if(ee[jr]&bc){hi=!0;var Js=ee[jr]&mr?F:E;if(Js===nt){Dn=Js;break}}}if(hi&&!Dn){Dn=Re;for(var Eo=un-1;Eo>=0;Eo--){var Qo=se[Eo];if(ee[Qo]&bc){var vc=ee[Qo]&mr?F:E;vc!==nt?Dn=vc:Dn=nt;break}}}if(Dn){if(ee[se[un]]=ee[se[wn]]=Dn,Dn!==nt){for(var va=un+1;va<se.length;va++)if(!(ee[se[va]]&l)){h(be[se[va]])&U&&(ee[se[va]]=Dn);break}}if(Dn!==nt){for(var qo=wn+1;qo<se.length;qo++)if(!(ee[se[qo]]&l)){h(be[se[qo]])&U&&(ee[se[qo]]=Dn);break}}}}for(var Ho=0;Ho<se.length;Ho++)if(ee[se[Ho]]&s){for(var Zl=Ho,fu=Ho,vr=Re,Qr=Ho-1;Qr>=0;Qr--)if(ee[se[Qr]]&l)Zl=Qr;else{vr=ee[se[Qr]]&mr?F:E;break}for(var xl=Ue,qr=Ho+1;qr<se.length;qr++)if(ee[se[qr]]&(s|l))fu=qr;else{xl=ee[se[qr]]&mr?F:E;break}for(var vg=Zl;vg<=fu;vg++)ee[se[vg]]=vr===xl?vr:nt;Ho=fu}}}for(var bo=Oe.start;bo<=Oe.end;bo++){var rA=Ze[bo],ga=ee[bo];if(rA&1?ga&(E|N|_)&&Ze[bo]++:ga&F?Ze[bo]++:ga&(_|N)&&(Ze[bo]+=2),ga&l&&(Ze[bo]=bo===0?Oe.level:Ze[bo-1]),bo===Oe.end||h(be[bo])&($|P))for(var Ml=bo;Ml>=0&&h(be[Ml])&c;Ml--)Ze[Ml]=Oe.level}}return{levels:Ze,paragraphs:De};function Md(ao,$o){for(var xa=ao;xa<be.length;xa++){var yr=ee[xa];if(yr&(F|q))return 1;if(yr&(P|E)||$o&&yr===de)return 0;if(yr&o){var Wd=RI(xa);xa=Wd===-1?be.length:Wd}}return 0}function RI(ao){for(var $o=1,xa=ao+1;xa<be.length;xa++){var yr=ee[xa];if(yr&P)break;if(yr&de){if(--$o===0)return xa}else yr&o&&$o++}return-1}}var Ne="14>1,j>2,t>2,u>2,1a>g,2v3>1,1>1,1ge>1,1wd>1,b>1,1j>1,f>1,ai>3,-2>3,+1,8>1k0,-1jq>1y7,-1y6>1hf,-1he>1h6,-1h5>1ha,-1h8>1qi,-1pu>1,6>3u,-3s>7,6>1,1>1,f>1,1>1,+2,3>1,1>1,+13,4>1,1>1,6>1eo,-1ee>1,3>1mg,-1me>1mk,-1mj>1mi,-1mg>1mi,-1md>1,1>1,+2,1>10k,-103>1,1>1,4>1,5>1,1>1,+10,3>1,1>8,-7>8,+1,-6>7,+1,a>1,1>1,u>1,u6>1,1>1,+5,26>1,1>1,2>1,2>2,8>1,7>1,4>1,1>1,+5,b8>1,1>1,+3,1>3,-2>1,2>1,1>1,+2,c>1,3>1,1>1,+2,h>1,3>1,a>1,1>1,2>1,3>1,1>1,d>1,f>1,3>1,1a>1,1>1,6>1,7>1,13>1,k>1,1>1,+19,4>1,1>1,+2,2>1,1>1,+18,m>1,a>1,1>1,lk>1,1>1,4>1,2>1,f>1,3>1,1>1,+3,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,6>1,4j>1,j>2,t>2,u>2,2>1,+1",ye;function pe(){if(!ye){var be=B(Ne,!0),Ee=be.map,Se=be.reverseMap;Se.forEach(function(ee,Q){Ee.set(Q,ee)}),ye=Ee}}function Te(be){return pe(),ye.get(be)||null}function le(be,Ee,Se,ee){var Q=be.length;Se=Math.max(0,Se==null?0:+Se),ee=Math.min(Q-1,ee==null?Q-1:+ee);for(var ce=new Map,me=Se;me<=ee;me++)if(Ee[me]&1){var Ze=Te(be[me]);Ze!==null&&ce.set(me,Ze)}return ce}function Ye(be,Ee,Se,ee){var Q=be.length;Se=Math.max(0,Se==null?0:+Se),ee=Math.min(Q-1,ee==null?Q-1:+ee);var ce=[];return Ee.paragraphs.forEach(function(me){var Ze=Math.max(Se,me.start),Xe=Math.min(ee,me.end);if(Ze<Xe){for(var De=Ee.levels.slice(Ze,Xe+1),Oe=Xe;Oe>=Ze&&h(be[Oe])&c;Oe--)De[Oe]=me.level;for(var Je=me.level,At=1/0,qe=0;qe<De.length;qe++){var lt=De[qe];lt>Je&&(Je=lt),lt<At&&(At=lt|1)}for(var $e=Je;$e>=At;$e--)for(var je=0;je<De.length;je++)if(De[je]>=$e){for(var ke=je;je+1<De.length&&De[je+1]>=$e;)je++;je>ke&&ce.push([ke+Ze,je+Ze])}}}),ce}function he(be,Ee,Se,ee){var Q=Ge(be,Ee,Se,ee),ce=[].concat(be);return Q.forEach(function(me,Ze){ce[Ze]=(Ee.levels[me]&1?Te(be[me]):null)||be[me]}),ce.join("")}function Ge(be,Ee,Se,ee){for(var Q=Ye(be,Ee,Se,ee),ce=[],me=0;me<be.length;me++)ce[me]=me;return Q.forEach(function(Ze){for(var Xe=Ze[0],De=Ze[1],Oe=ce.slice(Xe,De+1),Je=Oe.length;Je--;)ce[De-Je]=Oe[Je]}),ce}return e.closingToOpeningBracket=x,e.getBidiCharType=h,e.getBidiCharTypeName=m,e.getCanonicalBracket=M,e.getEmbeddingLevels=xe,e.getMirroredCharacter=Te,e.getMirroredCharactersMap=le,e.getReorderSegments=Ye,e.getReorderedIndices=Ge,e.getReorderedString=he,e.openingToClosingBracket=Z,Object.defineProperty(e,"__esModule",{value:!0}),e}({});return n}const AT=/\bvoid\s+main\s*\(\s*\)\s*{/g;function IR(n){const e=/^[ \t]*#include +<([\w\d./]+)>/gm;function t(i,a){let o=ti[a];return o?IR(o):i}return n.replace(e,t)}const Do=[];for(let n=0;n<256;n++)Do[n]=(n<16?"0":"")+n.toString(16);function R$(){const n=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(Do[n&255]+Do[n>>8&255]+Do[n>>16&255]+Do[n>>24&255]+"-"+Do[e&255]+Do[e>>8&255]+"-"+Do[e>>16&15|64]+Do[e>>24&255]+"-"+Do[t&63|128]+Do[t>>8&255]+"-"+Do[t>>16&255]+Do[t>>24&255]+Do[i&255]+Do[i>>8&255]+Do[i>>16&255]+Do[i>>24&255]).toUpperCase()}const MC=Object.assign||function(){let n=arguments[0];for(let e=1,t=arguments.length;e<t;e++){let i=arguments[e];if(i)for(let a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])}return n},Z$=Date.now(),BE=new WeakMap,GE=new Map;let x$=1e10;function hR(n,e){const t=N$(e);let i=BE.get(n);if(i||BE.set(n,i=Object.create(null)),i[t])return new i[t];const a=`_onBeforeCompile${t}`,o=function(c,u){n.onBeforeCompile.call(this,c,u);const C=this.customProgramCacheKey()+"|"+c.vertexShader+"|"+c.fragmentShader;let h=GE[C];if(!h){const m=M$(this,c,e,t);h=GE[C]=m}c.vertexShader=h.vertexShader,c.fragmentShader=h.fragmentShader,MC(c.uniforms,this.uniforms),e.timeUniform&&(c.uniforms[e.timeUniform]={get value(){return Date.now()-Z$}}),this[a]&&this[a](c)},r=function(){return s(e.chained?n:n.clone())},s=function(c){const u=Object.create(c,l);return Object.defineProperty(u,"baseMaterial",{value:n}),Object.defineProperty(u,"id",{value:x$++}),u.uuid=R$(),u.uniforms=MC({},c.uniforms,e.uniforms),u.defines=MC({},c.defines,e.defines),u.defines[`TROIKA_DERIVED_MATERIAL_${t}`]="",u.extensions=MC({},c.extensions,e.extensions),u._listeners=void 0,u},l={constructor:{value:r},isDerivedMaterial:{value:!0},type:{get:()=>n.type,set:c=>{n.type=c}},isDerivedFrom:{writable:!0,configurable:!0,value:function(c){const u=this.baseMaterial;return c===u||u.isDerivedMaterial&&u.isDerivedFrom(c)||!1}},customProgramCacheKey:{writable:!0,configurable:!0,value:function(){return n.customProgramCacheKey()+"|"+t}},onBeforeCompile:{get(){return o},set(c){this[a]=c}},copy:{writable:!0,configurable:!0,value:function(c){return n.copy.call(this,c),!n.isShaderMaterial&&!n.isDerivedMaterial&&(MC(this.extensions,c.extensions),MC(this.defines,c.defines),MC(this.uniforms,yG.clone(c.uniforms))),this}},clone:{writable:!0,configurable:!0,value:function(){const c=new n.constructor;return s(c).copy(this)}},getDepthMaterial:{writable:!0,configurable:!0,value:function(){let c=this._depthMaterial;return c||(c=this._depthMaterial=hR(n.isDerivedMaterial?n.getDepthMaterial():new LG({depthPacking:ax}),e),c.defines.IS_DEPTH_MATERIAL="",c.uniforms=this.uniforms),c}},getDistanceMaterial:{writable:!0,configurable:!0,value:function(){let c=this._distanceMaterial;return c||(c=this._distanceMaterial=hR(n.isDerivedMaterial?n.getDistanceMaterial():new _G,e),c.defines.IS_DISTANCE_MATERIAL="",c.uniforms=this.uniforms),c}},dispose:{writable:!0,configurable:!0,value(){const{_depthMaterial:c,_distanceMaterial:u}=this;c&&c.dispose(),u&&u.dispose(),n.dispose.call(this)}}};return i[t]=r,new r}function M$(n,{vertexShader:e,fragmentShader:t},i,a){let{vertexDefs:o,vertexMainIntro:r,vertexMainOutro:s,vertexTransform:l,fragmentDefs:c,fragmentMainIntro:u,fragmentMainOutro:C,fragmentColorTransform:h,customRewriter:m,timeUniform:p}=i;if(o=o||"",r=r||"",s=s||"",c=c||"",u=u||"",C=C||"",(l||m)&&(e=IR(e)),(h||m)&&(t=t.replace(/^[ \t]*#include <((?:tonemapping|encodings|colorspace|fog|premultiplied_alpha|dithering)_fragment)>/gm,`
//!BEGIN_POST_CHUNK $1
$&
//!END_POST_CHUNK
`),t=IR(t)),m){let B=m({vertexShader:e,fragmentShader:t});e=B.vertexShader,t=B.fragmentShader}if(h){let B=[];t=t.replace(/^\/\/!BEGIN_POST_CHUNK[^]+?^\/\/!END_POST_CHUNK/gm,b=>(B.push(b),"")),C=`${h}
${B.join(`
`)}
${C}`}if(p){const B=`
uniform float ${p};
`;o=B+o,c=B+c}return l&&(e=`vec3 troika_position_${a};
vec3 troika_normal_${a};
vec2 troika_uv_${a};
${e}
`,o=`${o}
void troikaVertexTransform${a}(inout vec3 position, inout vec3 normal, inout vec2 uv) {
  ${l}
}
`,r=`
troika_position_${a} = vec3(position);
troika_normal_${a} = vec3(normal);
troika_uv_${a} = vec2(uv);
troikaVertexTransform${a}(troika_position_${a}, troika_normal_${a}, troika_uv_${a});
${r}
`,e=e.replace(/\b(position|normal|uv)\b/g,(B,b,y,S)=>/\battribute\s+vec[23]\s+$/.test(S.substr(0,y))?b:`troika_${b}_${a}`),n.map&&n.map.channel>0||(e=e.replace(/\bMAP_UV\b/g,`troika_uv_${a}`))),e=SE(e,a,o,r,s),t=SE(t,a,c,u,C),{vertexShader:e,fragmentShader:t}}function SE(n,e,t,i,a){return(i||a||t)&&(n=n.replace(AT,`
${t}
void troikaOrigMain${e}() {`),n+=`
void main() {
  ${i}
  troikaOrigMain${e}();
  ${a}
}`),n}function W$(n,e){return n==="uniforms"?void 0:typeof e=="function"?e.toString():e}let V$=0;const wE=new Map;function N$(n){const e=JSON.stringify(n,W$);let t=wE.get(e);return t==null&&wE.set(e,t=++V$),t}/*!
Custom build of Typr.ts (https://github.com/fredli74/Typr.ts) for use in Troika text rendering.
Original MIT license applies: https://github.com/fredli74/Typr.ts/blob/master/LICENSE
*/function E$(){return typeof window>"u"&&(self.window=self),function(n){var e={parse:function(a){var o=e._bin,r=new Uint8Array(a);if(o.readASCII(r,0,4)=="ttcf"){var s=4;o.readUshort(r,s),s+=2,o.readUshort(r,s),s+=2;var l=o.readUint(r,s);s+=4;for(var c=[],u=0;u<l;u++){var C=o.readUint(r,s);s+=4,c.push(e._readFont(r,C))}return c}return[e._readFont(r,0)]},_readFont:function(a,o){var r=e._bin,s=o;r.readFixed(a,o),o+=4;var l=r.readUshort(a,o);o+=2,r.readUshort(a,o),o+=2,r.readUshort(a,o),o+=2,r.readUshort(a,o),o+=2;for(var c=["cmap","head","hhea","maxp","hmtx","name","OS/2","post","loca","glyf","kern","CFF ","GDEF","GPOS","GSUB","SVG "],u={_data:a,_offset:s},C={},h=0;h<l;h++){var m=r.readASCII(a,o,4);o+=4,r.readUint(a,o),o+=4;var p=r.readUint(a,o);o+=4;var B=r.readUint(a,o);o+=4,C[m]={offset:p,length:B}}for(h=0;h<c.length;h++){var b=c[h];C[b]&&(u[b.trim()]=e[b.trim()].parse(a,C[b].offset,C[b].length,u))}return u},_tabOffset:function(a,o,r){for(var s=e._bin,l=s.readUshort(a,r+4),c=r+12,u=0;u<l;u++){var C=s.readASCII(a,c,4);c+=4,s.readUint(a,c),c+=4;var h=s.readUint(a,c);if(c+=4,s.readUint(a,c),c+=4,C==o)return h}return 0}};e._bin={readFixed:function(a,o){return(a[o]<<8|a[o+1])+(a[o+2]<<8|a[o+3])/65540},readF2dot14:function(a,o){return e._bin.readShort(a,o)/16384},readInt:function(a,o){return e._bin._view(a).getInt32(o)},readInt8:function(a,o){return e._bin._view(a).getInt8(o)},readShort:function(a,o){return e._bin._view(a).getInt16(o)},readUshort:function(a,o){return e._bin._view(a).getUint16(o)},readUshorts:function(a,o,r){for(var s=[],l=0;l<r;l++)s.push(e._bin.readUshort(a,o+2*l));return s},readUint:function(a,o){return e._bin._view(a).getUint32(o)},readUint64:function(a,o){return 4294967296*e._bin.readUint(a,o)+e._bin.readUint(a,o+4)},readASCII:function(a,o,r){for(var s="",l=0;l<r;l++)s+=String.fromCharCode(a[o+l]);return s},readUnicode:function(a,o,r){for(var s="",l=0;l<r;l++){var c=a[o++]<<8|a[o++];s+=String.fromCharCode(c)}return s},_tdec:typeof window<"u"&&window.TextDecoder?new window.TextDecoder:null,readUTF8:function(a,o,r){var s=e._bin._tdec;return s&&o==0&&r==a.length?s.decode(a):e._bin.readASCII(a,o,r)},readBytes:function(a,o,r){for(var s=[],l=0;l<r;l++)s.push(a[o+l]);return s},readASCIIArray:function(a,o,r){for(var s=[],l=0;l<r;l++)s.push(String.fromCharCode(a[o+l]));return s},_view:function(a){return a._dataView||(a._dataView=a.buffer?new DataView(a.buffer,a.byteOffset,a.byteLength):new DataView(new Uint8Array(a).buffer))}},e._lctf={},e._lctf.parse=function(a,o,r,s,l){var c=e._bin,u={},C=o;c.readFixed(a,o),o+=4;var h=c.readUshort(a,o);o+=2;var m=c.readUshort(a,o);o+=2;var p=c.readUshort(a,o);return o+=2,u.scriptList=e._lctf.readScriptList(a,C+h),u.featureList=e._lctf.readFeatureList(a,C+m),u.lookupList=e._lctf.readLookupList(a,C+p,l),u},e._lctf.readLookupList=function(a,o,r){var s=e._bin,l=o,c=[],u=s.readUshort(a,o);o+=2;for(var C=0;C<u;C++){var h=s.readUshort(a,o);o+=2;var m=e._lctf.readLookupTable(a,l+h,r);c.push(m)}return c},e._lctf.readLookupTable=function(a,o,r){var s=e._bin,l=o,c={tabs:[]};c.ltype=s.readUshort(a,o),o+=2,c.flag=s.readUshort(a,o),o+=2;var u=s.readUshort(a,o);o+=2;for(var C=c.ltype,h=0;h<u;h++){var m=s.readUshort(a,o);o+=2;var p=r(a,C,l+m,c);c.tabs.push(p)}return c},e._lctf.numOfOnes=function(a){for(var o=0,r=0;r<32;r++)(a>>>r&1)!=0&&o++;return o},e._lctf.readClassDef=function(a,o){var r=e._bin,s=[],l=r.readUshort(a,o);if(o+=2,l==1){var c=r.readUshort(a,o);o+=2;var u=r.readUshort(a,o);o+=2;for(var C=0;C<u;C++)s.push(c+C),s.push(c+C),s.push(r.readUshort(a,o)),o+=2}if(l==2){var h=r.readUshort(a,o);for(o+=2,C=0;C<h;C++)s.push(r.readUshort(a,o)),o+=2,s.push(r.readUshort(a,o)),o+=2,s.push(r.readUshort(a,o)),o+=2}return s},e._lctf.getInterval=function(a,o){for(var r=0;r<a.length;r+=3){var s=a[r],l=a[r+1];if(a[r+2],s<=o&&o<=l)return r}return-1},e._lctf.readCoverage=function(a,o){var r=e._bin,s={};s.fmt=r.readUshort(a,o),o+=2;var l=r.readUshort(a,o);return o+=2,s.fmt==1&&(s.tab=r.readUshorts(a,o,l)),s.fmt==2&&(s.tab=r.readUshorts(a,o,3*l)),s},e._lctf.coverageIndex=function(a,o){var r=a.tab;if(a.fmt==1)return r.indexOf(o);if(a.fmt==2){var s=e._lctf.getInterval(r,o);if(s!=-1)return r[s+2]+(o-r[s])}return-1},e._lctf.readFeatureList=function(a,o){var r=e._bin,s=o,l=[],c=r.readUshort(a,o);o+=2;for(var u=0;u<c;u++){var C=r.readASCII(a,o,4);o+=4;var h=r.readUshort(a,o);o+=2;var m=e._lctf.readFeatureTable(a,s+h);m.tag=C.trim(),l.push(m)}return l},e._lctf.readFeatureTable=function(a,o){var r=e._bin,s=o,l={},c=r.readUshort(a,o);o+=2,c>0&&(l.featureParams=s+c);var u=r.readUshort(a,o);o+=2,l.tab=[];for(var C=0;C<u;C++)l.tab.push(r.readUshort(a,o+2*C));return l},e._lctf.readScriptList=function(a,o){var r=e._bin,s=o,l={},c=r.readUshort(a,o);o+=2;for(var u=0;u<c;u++){var C=r.readASCII(a,o,4);o+=4;var h=r.readUshort(a,o);o+=2,l[C.trim()]=e._lctf.readScriptTable(a,s+h)}return l},e._lctf.readScriptTable=function(a,o){var r=e._bin,s=o,l={},c=r.readUshort(a,o);o+=2,c>0&&(l.default=e._lctf.readLangSysTable(a,s+c));var u=r.readUshort(a,o);o+=2;for(var C=0;C<u;C++){var h=r.readASCII(a,o,4);o+=4;var m=r.readUshort(a,o);o+=2,l[h.trim()]=e._lctf.readLangSysTable(a,s+m)}return l},e._lctf.readLangSysTable=function(a,o){var r=e._bin,s={};r.readUshort(a,o),o+=2,s.reqFeature=r.readUshort(a,o),o+=2;var l=r.readUshort(a,o);return o+=2,s.features=r.readUshorts(a,o,l),s},e.CFF={},e.CFF.parse=function(a,o,r){var s=e._bin;(a=new Uint8Array(a.buffer,o,r))[o=0],a[++o],a[++o],a[++o],o++;var l=[];o=e.CFF.readIndex(a,o,l);for(var c=[],u=0;u<l.length-1;u++)c.push(s.readASCII(a,o+l[u],l[u+1]-l[u]));o+=l[l.length-1];var C=[];o=e.CFF.readIndex(a,o,C);var h=[];for(u=0;u<C.length-1;u++)h.push(e.CFF.readDict(a,o+C[u],o+C[u+1]));o+=C[C.length-1];var m=h[0],p=[];o=e.CFF.readIndex(a,o,p);var B=[];for(u=0;u<p.length-1;u++)B.push(s.readASCII(a,o+p[u],p[u+1]-p[u]));if(o+=p[p.length-1],e.CFF.readSubrs(a,o,m),m.CharStrings){o=m.CharStrings,p=[],o=e.CFF.readIndex(a,o,p);var b=[];for(u=0;u<p.length-1;u++)b.push(s.readBytes(a,o+p[u],p[u+1]-p[u]));m.CharStrings=b}if(m.ROS){o=m.FDArray;var y=[];for(o=e.CFF.readIndex(a,o,y),m.FDArray=[],u=0;u<y.length-1;u++){var S=e.CFF.readDict(a,o+y[u],o+y[u+1]);e.CFF._readFDict(a,S,B),m.FDArray.push(S)}o+=y[y.length-1],o=m.FDSelect,m.FDSelect=[];var R=a[o];if(o++,R!=3)throw R;var Z=s.readUshort(a,o);for(o+=2,u=0;u<Z+1;u++)m.FDSelect.push(s.readUshort(a,o),a[o+2]),o+=3}return m.Encoding&&(m.Encoding=e.CFF.readEncoding(a,m.Encoding,m.CharStrings.length)),m.charset&&(m.charset=e.CFF.readCharset(a,m.charset,m.CharStrings.length)),e.CFF._readFDict(a,m,B),m},e.CFF._readFDict=function(a,o,r){var s;for(var l in o.Private&&(s=o.Private[1],o.Private=e.CFF.readDict(a,s,s+o.Private[0]),o.Private.Subrs&&e.CFF.readSubrs(a,s+o.Private.Subrs,o.Private)),o)["FamilyName","FontName","FullName","Notice","version","Copyright"].indexOf(l)!=-1&&(o[l]=r[o[l]-426+35])},e.CFF.readSubrs=function(a,o,r){var s=e._bin,l=[];o=e.CFF.readIndex(a,o,l);var c,u=l.length;c=u<1240?107:u<33900?1131:32768,r.Bias=c,r.Subrs=[];for(var C=0;C<l.length-1;C++)r.Subrs.push(s.readBytes(a,o+l[C],l[C+1]-l[C]))},e.CFF.tableSE=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,0,111,112,113,114,0,115,116,117,118,119,120,121,122,0,123,0,124,125,126,127,128,129,130,131,0,132,133,0,134,135,136,137,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,138,0,139,0,0,0,0,140,141,142,143,0,0,0,0,0,144,0,0,0,145,0,0,146,147,148,149,0,0,0,0],e.CFF.glyphByUnicode=function(a,o){for(var r=0;r<a.charset.length;r++)if(a.charset[r]==o)return r;return-1},e.CFF.glyphBySE=function(a,o){return o<0||o>255?-1:e.CFF.glyphByUnicode(a,e.CFF.tableSE[o])},e.CFF.readEncoding=function(a,o,r){e._bin;var s=[".notdef"],l=a[o];if(o++,l!=0)throw"error: unknown encoding format: "+l;var c=a[o];o++;for(var u=0;u<c;u++)s.push(a[o+u]);return s},e.CFF.readCharset=function(a,o,r){var s=e._bin,l=[".notdef"],c=a[o];if(o++,c==0)for(var u=0;u<r;u++){var C=s.readUshort(a,o);o+=2,l.push(C)}else{if(c!=1&&c!=2)throw"error: format: "+c;for(;l.length<r;){C=s.readUshort(a,o),o+=2;var h=0;for(c==1?(h=a[o],o++):(h=s.readUshort(a,o),o+=2),u=0;u<=h;u++)l.push(C),C++}}return l},e.CFF.readIndex=function(a,o,r){var s=e._bin,l=s.readUshort(a,o)+1,c=a[o+=2];if(o++,c==1)for(var u=0;u<l;u++)r.push(a[o+u]);else if(c==2)for(u=0;u<l;u++)r.push(s.readUshort(a,o+2*u));else if(c==3)for(u=0;u<l;u++)r.push(16777215&s.readUint(a,o+3*u-1));else if(l!=1)throw"unsupported offset size: "+c+", count: "+l;return(o+=l*c)-1},e.CFF.getCharString=function(a,o,r){var s=e._bin,l=a[o],c=a[o+1];a[o+2],a[o+3],a[o+4];var u=1,C=null,h=null;l<=20&&(C=l,u=1),l==12&&(C=100*l+c,u=2),21<=l&&l<=27&&(C=l,u=1),l==28&&(h=s.readShort(a,o+1),u=3),29<=l&&l<=31&&(C=l,u=1),32<=l&&l<=246&&(h=l-139,u=1),247<=l&&l<=250&&(h=256*(l-247)+c+108,u=2),251<=l&&l<=254&&(h=256*-(l-251)-c-108,u=2),l==255&&(h=s.readInt(a,o+1)/65535,u=5),r.val=h??"o"+C,r.size=u},e.CFF.readCharString=function(a,o,r){for(var s=o+r,l=e._bin,c=[];o<s;){var u=a[o],C=a[o+1];a[o+2],a[o+3],a[o+4];var h=1,m=null,p=null;u<=20&&(m=u,h=1),u==12&&(m=100*u+C,h=2),u!=19&&u!=20||(m=u,h=2),21<=u&&u<=27&&(m=u,h=1),u==28&&(p=l.readShort(a,o+1),h=3),29<=u&&u<=31&&(m=u,h=1),32<=u&&u<=246&&(p=u-139,h=1),247<=u&&u<=250&&(p=256*(u-247)+C+108,h=2),251<=u&&u<=254&&(p=256*-(u-251)-C-108,h=2),u==255&&(p=l.readInt(a,o+1)/65535,h=5),c.push(p??"o"+m),o+=h}return c},e.CFF.readDict=function(a,o,r){for(var s=e._bin,l={},c=[];o<r;){var u=a[o],C=a[o+1];a[o+2],a[o+3],a[o+4];var h=1,m=null,p=null;if(u==28&&(p=s.readShort(a,o+1),h=3),u==29&&(p=s.readInt(a,o+1),h=5),32<=u&&u<=246&&(p=u-139,h=1),247<=u&&u<=250&&(p=256*(u-247)+C+108,h=2),251<=u&&u<=254&&(p=256*-(u-251)-C-108,h=2),u==255)throw p=s.readInt(a,o+1)/65535,h=5,"unknown number";if(u==30){var B=[];for(h=1;;){var b=a[o+h];h++;var y=b>>4,S=15&b;if(y!=15&&B.push(y),S!=15&&B.push(S),S==15)break}for(var R="",Z=[0,1,2,3,4,5,6,7,8,9,".","e","e-","reserved","-","endOfNumber"],x=0;x<B.length;x++)R+=Z[B[x]];p=parseFloat(R)}u<=21&&(m=["version","Notice","FullName","FamilyName","Weight","FontBBox","BlueValues","OtherBlues","FamilyBlues","FamilyOtherBlues","StdHW","StdVW","escape","UniqueID","XUID","charset","Encoding","CharStrings","Private","Subrs","defaultWidthX","nominalWidthX"][u],h=1,u==12&&(m=["Copyright","isFixedPitch","ItalicAngle","UnderlinePosition","UnderlineThickness","PaintType","CharstringType","FontMatrix","StrokeWidth","BlueScale","BlueShift","BlueFuzz","StemSnapH","StemSnapV","ForceBold",0,0,"LanguageGroup","ExpansionFactor","initialRandomSeed","SyntheticBase","PostScript","BaseFontName","BaseFontBlend",0,0,0,0,0,0,"ROS","CIDFontVersion","CIDFontRevision","CIDFontType","CIDCount","UIDBase","FDArray","FDSelect","FontName"][C],h=2)),m!=null?(l[m]=c.length==1?c[0]:c,c=[]):c.push(p),o+=h}return l},e.cmap={},e.cmap.parse=function(a,o,r){a=new Uint8Array(a.buffer,o,r),o=0;var s=e._bin,l={};s.readUshort(a,o),o+=2;var c=s.readUshort(a,o);o+=2;var u=[];l.tables=[];for(var C=0;C<c;C++){var h=s.readUshort(a,o);o+=2;var m=s.readUshort(a,o);o+=2;var p=s.readUint(a,o);o+=4;var B="p"+h+"e"+m,b=u.indexOf(p);if(b==-1){var y;b=l.tables.length,u.push(p);var S=s.readUshort(a,p);S==0?y=e.cmap.parse0(a,p):S==4?y=e.cmap.parse4(a,p):S==6?y=e.cmap.parse6(a,p):S==12?y=e.cmap.parse12(a,p):console.debug("unknown format: "+S,h,m,p),l.tables.push(y)}if(l[B]!=null)throw"multiple tables for one platform+encoding";l[B]=b}return l},e.cmap.parse0=function(a,o){var r=e._bin,s={};s.format=r.readUshort(a,o),o+=2;var l=r.readUshort(a,o);o+=2,r.readUshort(a,o),o+=2,s.map=[];for(var c=0;c<l-6;c++)s.map.push(a[o+c]);return s},e.cmap.parse4=function(a,o){var r=e._bin,s=o,l={};l.format=r.readUshort(a,o),o+=2;var c=r.readUshort(a,o);o+=2,r.readUshort(a,o),o+=2;var u=r.readUshort(a,o);o+=2;var C=u/2;l.searchRange=r.readUshort(a,o),o+=2,l.entrySelector=r.readUshort(a,o),o+=2,l.rangeShift=r.readUshort(a,o),o+=2,l.endCount=r.readUshorts(a,o,C),o+=2*C,o+=2,l.startCount=r.readUshorts(a,o,C),o+=2*C,l.idDelta=[];for(var h=0;h<C;h++)l.idDelta.push(r.readShort(a,o)),o+=2;for(l.idRangeOffset=r.readUshorts(a,o,C),o+=2*C,l.glyphIdArray=[];o<s+c;)l.glyphIdArray.push(r.readUshort(a,o)),o+=2;return l},e.cmap.parse6=function(a,o){var r=e._bin,s={};s.format=r.readUshort(a,o),o+=2,r.readUshort(a,o),o+=2,r.readUshort(a,o),o+=2,s.firstCode=r.readUshort(a,o),o+=2;var l=r.readUshort(a,o);o+=2,s.glyphIdArray=[];for(var c=0;c<l;c++)s.glyphIdArray.push(r.readUshort(a,o)),o+=2;return s},e.cmap.parse12=function(a,o){var r=e._bin,s={};s.format=r.readUshort(a,o),o+=2,o+=2,r.readUint(a,o),o+=4,r.readUint(a,o),o+=4;var l=r.readUint(a,o);o+=4,s.groups=[];for(var c=0;c<l;c++){var u=o+12*c,C=r.readUint(a,u+0),h=r.readUint(a,u+4),m=r.readUint(a,u+8);s.groups.push([C,h,m])}return s},e.glyf={},e.glyf.parse=function(a,o,r,s){for(var l=[],c=0;c<s.maxp.numGlyphs;c++)l.push(null);return l},e.glyf._parseGlyf=function(a,o){var r=e._bin,s=a._data,l=e._tabOffset(s,"glyf",a._offset)+a.loca[o];if(a.loca[o]==a.loca[o+1])return null;var c={};if(c.noc=r.readShort(s,l),l+=2,c.xMin=r.readShort(s,l),l+=2,c.yMin=r.readShort(s,l),l+=2,c.xMax=r.readShort(s,l),l+=2,c.yMax=r.readShort(s,l),l+=2,c.xMin>=c.xMax||c.yMin>=c.yMax)return null;if(c.noc>0){c.endPts=[];for(var u=0;u<c.noc;u++)c.endPts.push(r.readUshort(s,l)),l+=2;var C=r.readUshort(s,l);if(l+=2,s.length-l<C)return null;c.instructions=r.readBytes(s,l,C),l+=C;var h=c.endPts[c.noc-1]+1;for(c.flags=[],u=0;u<h;u++){var m=s[l];if(l++,c.flags.push(m),(8&m)!=0){var p=s[l];l++;for(var B=0;B<p;B++)c.flags.push(m),u++}}for(c.xs=[],u=0;u<h;u++){var b=(2&c.flags[u])!=0,y=(16&c.flags[u])!=0;b?(c.xs.push(y?s[l]:-s[l]),l++):y?c.xs.push(0):(c.xs.push(r.readShort(s,l)),l+=2)}for(c.ys=[],u=0;u<h;u++)b=(4&c.flags[u])!=0,y=(32&c.flags[u])!=0,b?(c.ys.push(y?s[l]:-s[l]),l++):y?c.ys.push(0):(c.ys.push(r.readShort(s,l)),l+=2);var S=0,R=0;for(u=0;u<h;u++)S+=c.xs[u],R+=c.ys[u],c.xs[u]=S,c.ys[u]=R}else{var Z;c.parts=[];do{Z=r.readUshort(s,l),l+=2;var x={m:{a:1,b:0,c:0,d:1,tx:0,ty:0},p1:-1,p2:-1};if(c.parts.push(x),x.glyphIndex=r.readUshort(s,l),l+=2,1&Z){var M=r.readShort(s,l);l+=2;var E=r.readShort(s,l);l+=2}else M=r.readInt8(s,l),l++,E=r.readInt8(s,l),l++;2&Z?(x.m.tx=M,x.m.ty=E):(x.p1=M,x.p2=E),8&Z?(x.m.a=x.m.d=r.readF2dot14(s,l),l+=2):64&Z?(x.m.a=r.readF2dot14(s,l),l+=2,x.m.d=r.readF2dot14(s,l),l+=2):128&Z&&(x.m.a=r.readF2dot14(s,l),l+=2,x.m.b=r.readF2dot14(s,l),l+=2,x.m.c=r.readF2dot14(s,l),l+=2,x.m.d=r.readF2dot14(s,l),l+=2)}while(32&Z);if(256&Z){var F=r.readUshort(s,l);for(l+=2,c.instr=[],u=0;u<F;u++)c.instr.push(s[l]),l++}}return c},e.GDEF={},e.GDEF.parse=function(a,o,r,s){var l=o;o+=4;var c=e._bin.readUshort(a,o);return{glyphClassDef:c===0?null:e._lctf.readClassDef(a,l+c)}},e.GPOS={},e.GPOS.parse=function(a,o,r,s){return e._lctf.parse(a,o,r,s,e.GPOS.subt)},e.GPOS.subt=function(a,o,r,s){var l=e._bin,c=r,u={};if(u.fmt=l.readUshort(a,r),r+=2,o==1||o==2||o==3||o==7||o==8&&u.fmt<=2){var C=l.readUshort(a,r);r+=2,u.coverage=e._lctf.readCoverage(a,C+c)}if(o==1&&u.fmt==1){var h=l.readUshort(a,r);r+=2,h!=0&&(u.pos=e.GPOS.readValueRecord(a,r,h))}else if(o==2&&u.fmt>=1&&u.fmt<=2){h=l.readUshort(a,r),r+=2;var m=l.readUshort(a,r);r+=2;var p=e._lctf.numOfOnes(h),B=e._lctf.numOfOnes(m);if(u.fmt==1){u.pairsets=[];var b=l.readUshort(a,r);r+=2;for(var y=0;y<b;y++){var S=c+l.readUshort(a,r);r+=2;var R=l.readUshort(a,S);S+=2;for(var Z=[],x=0;x<R;x++){var M=l.readUshort(a,S);S+=2,h!=0&&(_=e.GPOS.readValueRecord(a,S,h),S+=2*p),m!=0&&(D=e.GPOS.readValueRecord(a,S,m),S+=2*B),Z.push({gid2:M,val1:_,val2:D})}u.pairsets.push(Z)}}if(u.fmt==2){var E=l.readUshort(a,r);r+=2;var F=l.readUshort(a,r);r+=2;var N=l.readUshort(a,r);r+=2;var H=l.readUshort(a,r);for(r+=2,u.classDef1=e._lctf.readClassDef(a,c+E),u.classDef2=e._lctf.readClassDef(a,c+F),u.matrix=[],y=0;y<N;y++){var z=[];for(x=0;x<H;x++){var _=null,D=null;h!=0&&(_=e.GPOS.readValueRecord(a,r,h),r+=2*p),m!=0&&(D=e.GPOS.readValueRecord(a,r,m),r+=2*B),z.push({val1:_,val2:D})}u.matrix.push(z)}}}else if(o==4&&u.fmt==1)u.markCoverage=e._lctf.readCoverage(a,l.readUshort(a,r)+c),u.baseCoverage=e._lctf.readCoverage(a,l.readUshort(a,r+2)+c),u.markClassCount=l.readUshort(a,r+4),u.markArray=e.GPOS.readMarkArray(a,l.readUshort(a,r+6)+c),u.baseArray=e.GPOS.readBaseArray(a,l.readUshort(a,r+8)+c,u.markClassCount);else if(o==6&&u.fmt==1)u.mark1Coverage=e._lctf.readCoverage(a,l.readUshort(a,r)+c),u.mark2Coverage=e._lctf.readCoverage(a,l.readUshort(a,r+2)+c),u.markClassCount=l.readUshort(a,r+4),u.mark1Array=e.GPOS.readMarkArray(a,l.readUshort(a,r+6)+c),u.mark2Array=e.GPOS.readBaseArray(a,l.readUshort(a,r+8)+c,u.markClassCount);else{if(o==9&&u.fmt==1){var P=l.readUshort(a,r);r+=2;var $=l.readUint(a,r);if(r+=4,s.ltype==9)s.ltype=P;else if(s.ltype!=P)throw"invalid extension substitution";return e.GPOS.subt(a,s.ltype,c+$)}console.debug("unsupported GPOS table LookupType",o,"format",u.fmt)}return u},e.GPOS.readValueRecord=function(a,o,r){var s=e._bin,l=[];return l.push(1&r?s.readShort(a,o):0),o+=1&r?2:0,l.push(2&r?s.readShort(a,o):0),o+=2&r?2:0,l.push(4&r?s.readShort(a,o):0),o+=4&r?2:0,l.push(8&r?s.readShort(a,o):0),o+=8&r?2:0,l},e.GPOS.readBaseArray=function(a,o,r){var s=e._bin,l=[],c=o,u=s.readUshort(a,o);o+=2;for(var C=0;C<u;C++){for(var h=[],m=0;m<r;m++)h.push(e.GPOS.readAnchorRecord(a,c+s.readUshort(a,o))),o+=2;l.push(h)}return l},e.GPOS.readMarkArray=function(a,o){var r=e._bin,s=[],l=o,c=r.readUshort(a,o);o+=2;for(var u=0;u<c;u++){var C=e.GPOS.readAnchorRecord(a,r.readUshort(a,o+2)+l);C.markClass=r.readUshort(a,o),s.push(C),o+=4}return s},e.GPOS.readAnchorRecord=function(a,o){var r=e._bin,s={};return s.fmt=r.readUshort(a,o),s.x=r.readShort(a,o+2),s.y=r.readShort(a,o+4),s},e.GSUB={},e.GSUB.parse=function(a,o,r,s){return e._lctf.parse(a,o,r,s,e.GSUB.subt)},e.GSUB.subt=function(a,o,r,s){var l=e._bin,c=r,u={};if(u.fmt=l.readUshort(a,r),r+=2,o!=1&&o!=2&&o!=4&&o!=5&&o!=6)return null;if(o==1||o==2||o==4||o==5&&u.fmt<=2||o==6&&u.fmt<=2){var C=l.readUshort(a,r);r+=2,u.coverage=e._lctf.readCoverage(a,c+C)}if(o==1&&u.fmt>=1&&u.fmt<=2){if(u.fmt==1)u.delta=l.readShort(a,r),r+=2;else if(u.fmt==2){var h=l.readUshort(a,r);r+=2,u.newg=l.readUshorts(a,r,h),r+=2*u.newg.length}}else if(o==2&&u.fmt==1){h=l.readUshort(a,r),r+=2,u.seqs=[];for(var m=0;m<h;m++){var p=l.readUshort(a,r)+c;r+=2;var B=l.readUshort(a,p);u.seqs.push(l.readUshorts(a,p+2,B))}}else if(o==4)for(u.vals=[],h=l.readUshort(a,r),r+=2,m=0;m<h;m++){var b=l.readUshort(a,r);r+=2,u.vals.push(e.GSUB.readLigatureSet(a,c+b))}else if(o==5&&u.fmt==2){if(u.fmt==2){var y=l.readUshort(a,r);r+=2,u.cDef=e._lctf.readClassDef(a,c+y),u.scset=[];var S=l.readUshort(a,r);for(r+=2,m=0;m<S;m++){var R=l.readUshort(a,r);r+=2,u.scset.push(R==0?null:e.GSUB.readSubClassSet(a,c+R))}}}else if(o==6&&u.fmt==3){if(u.fmt==3){for(m=0;m<3;m++){h=l.readUshort(a,r),r+=2;for(var Z=[],x=0;x<h;x++)Z.push(e._lctf.readCoverage(a,c+l.readUshort(a,r+2*x)));r+=2*h,m==0&&(u.backCvg=Z),m==1&&(u.inptCvg=Z),m==2&&(u.ahedCvg=Z)}h=l.readUshort(a,r),r+=2,u.lookupRec=e.GSUB.readSubstLookupRecords(a,r,h)}}else{if(o==7&&u.fmt==1){var M=l.readUshort(a,r);r+=2;var E=l.readUint(a,r);if(r+=4,s.ltype==9)s.ltype=M;else if(s.ltype!=M)throw"invalid extension substitution";return e.GSUB.subt(a,s.ltype,c+E)}console.debug("unsupported GSUB table LookupType",o,"format",u.fmt)}return u},e.GSUB.readSubClassSet=function(a,o){var r=e._bin.readUshort,s=o,l=[],c=r(a,o);o+=2;for(var u=0;u<c;u++){var C=r(a,o);o+=2,l.push(e.GSUB.readSubClassRule(a,s+C))}return l},e.GSUB.readSubClassRule=function(a,o){var r=e._bin.readUshort,s={},l=r(a,o),c=r(a,o+=2);o+=2,s.input=[];for(var u=0;u<l-1;u++)s.input.push(r(a,o)),o+=2;return s.substLookupRecords=e.GSUB.readSubstLookupRecords(a,o,c),s},e.GSUB.readSubstLookupRecords=function(a,o,r){for(var s=e._bin.readUshort,l=[],c=0;c<r;c++)l.push(s(a,o),s(a,o+2)),o+=4;return l},e.GSUB.readChainSubClassSet=function(a,o){var r=e._bin,s=o,l=[],c=r.readUshort(a,o);o+=2;for(var u=0;u<c;u++){var C=r.readUshort(a,o);o+=2,l.push(e.GSUB.readChainSubClassRule(a,s+C))}return l},e.GSUB.readChainSubClassRule=function(a,o){for(var r=e._bin,s={},l=["backtrack","input","lookahead"],c=0;c<l.length;c++){var u=r.readUshort(a,o);o+=2,c==1&&u--,s[l[c]]=r.readUshorts(a,o,u),o+=2*s[l[c]].length}return u=r.readUshort(a,o),o+=2,s.subst=r.readUshorts(a,o,2*u),o+=2*s.subst.length,s},e.GSUB.readLigatureSet=function(a,o){var r=e._bin,s=o,l=[],c=r.readUshort(a,o);o+=2;for(var u=0;u<c;u++){var C=r.readUshort(a,o);o+=2,l.push(e.GSUB.readLigature(a,s+C))}return l},e.GSUB.readLigature=function(a,o){var r=e._bin,s={chain:[]};s.nglyph=r.readUshort(a,o),o+=2;var l=r.readUshort(a,o);o+=2;for(var c=0;c<l-1;c++)s.chain.push(r.readUshort(a,o)),o+=2;return s},e.head={},e.head.parse=function(a,o,r){var s=e._bin,l={};return s.readFixed(a,o),o+=4,l.fontRevision=s.readFixed(a,o),o+=4,s.readUint(a,o),o+=4,s.readUint(a,o),o+=4,l.flags=s.readUshort(a,o),o+=2,l.unitsPerEm=s.readUshort(a,o),o+=2,l.created=s.readUint64(a,o),o+=8,l.modified=s.readUint64(a,o),o+=8,l.xMin=s.readShort(a,o),o+=2,l.yMin=s.readShort(a,o),o+=2,l.xMax=s.readShort(a,o),o+=2,l.yMax=s.readShort(a,o),o+=2,l.macStyle=s.readUshort(a,o),o+=2,l.lowestRecPPEM=s.readUshort(a,o),o+=2,l.fontDirectionHint=s.readShort(a,o),o+=2,l.indexToLocFormat=s.readShort(a,o),o+=2,l.glyphDataFormat=s.readShort(a,o),o+=2,l},e.hhea={},e.hhea.parse=function(a,o,r){var s=e._bin,l={};return s.readFixed(a,o),o+=4,l.ascender=s.readShort(a,o),o+=2,l.descender=s.readShort(a,o),o+=2,l.lineGap=s.readShort(a,o),o+=2,l.advanceWidthMax=s.readUshort(a,o),o+=2,l.minLeftSideBearing=s.readShort(a,o),o+=2,l.minRightSideBearing=s.readShort(a,o),o+=2,l.xMaxExtent=s.readShort(a,o),o+=2,l.caretSlopeRise=s.readShort(a,o),o+=2,l.caretSlopeRun=s.readShort(a,o),o+=2,l.caretOffset=s.readShort(a,o),o+=2,o+=8,l.metricDataFormat=s.readShort(a,o),o+=2,l.numberOfHMetrics=s.readUshort(a,o),o+=2,l},e.hmtx={},e.hmtx.parse=function(a,o,r,s){for(var l=e._bin,c={aWidth:[],lsBearing:[]},u=0,C=0,h=0;h<s.maxp.numGlyphs;h++)h<s.hhea.numberOfHMetrics&&(u=l.readUshort(a,o),o+=2,C=l.readShort(a,o),o+=2),c.aWidth.push(u),c.lsBearing.push(C);return c},e.kern={},e.kern.parse=function(a,o,r,s){var l=e._bin,c=l.readUshort(a,o);if(o+=2,c==1)return e.kern.parseV1(a,o-2,r,s);var u=l.readUshort(a,o);o+=2;for(var C={glyph1:[],rval:[]},h=0;h<u;h++){o+=2,r=l.readUshort(a,o),o+=2;var m=l.readUshort(a,o);o+=2;var p=m>>>8;if((p&=15)!=0)throw"unknown kern table format: "+p;o=e.kern.readFormat0(a,o,C)}return C},e.kern.parseV1=function(a,o,r,s){var l=e._bin;l.readFixed(a,o),o+=4;var c=l.readUint(a,o);o+=4;for(var u={glyph1:[],rval:[]},C=0;C<c;C++){l.readUint(a,o),o+=4;var h=l.readUshort(a,o);o+=2,l.readUshort(a,o),o+=2;var m=h>>>8;if((m&=15)!=0)throw"unknown kern table format: "+m;o=e.kern.readFormat0(a,o,u)}return u},e.kern.readFormat0=function(a,o,r){var s=e._bin,l=-1,c=s.readUshort(a,o);o+=2,s.readUshort(a,o),o+=2,s.readUshort(a,o),o+=2,s.readUshort(a,o),o+=2;for(var u=0;u<c;u++){var C=s.readUshort(a,o);o+=2;var h=s.readUshort(a,o);o+=2;var m=s.readShort(a,o);o+=2,C!=l&&(r.glyph1.push(C),r.rval.push({glyph2:[],vals:[]}));var p=r.rval[r.rval.length-1];p.glyph2.push(h),p.vals.push(m),l=C}return o},e.loca={},e.loca.parse=function(a,o,r,s){var l=e._bin,c=[],u=s.head.indexToLocFormat,C=s.maxp.numGlyphs+1;if(u==0)for(var h=0;h<C;h++)c.push(l.readUshort(a,o+(h<<1))<<1);if(u==1)for(h=0;h<C;h++)c.push(l.readUint(a,o+(h<<2)));return c},e.maxp={},e.maxp.parse=function(a,o,r){var s=e._bin,l={},c=s.readUint(a,o);return o+=4,l.numGlyphs=s.readUshort(a,o),o+=2,c==65536&&(l.maxPoints=s.readUshort(a,o),o+=2,l.maxContours=s.readUshort(a,o),o+=2,l.maxCompositePoints=s.readUshort(a,o),o+=2,l.maxCompositeContours=s.readUshort(a,o),o+=2,l.maxZones=s.readUshort(a,o),o+=2,l.maxTwilightPoints=s.readUshort(a,o),o+=2,l.maxStorage=s.readUshort(a,o),o+=2,l.maxFunctionDefs=s.readUshort(a,o),o+=2,l.maxInstructionDefs=s.readUshort(a,o),o+=2,l.maxStackElements=s.readUshort(a,o),o+=2,l.maxSizeOfInstructions=s.readUshort(a,o),o+=2,l.maxComponentElements=s.readUshort(a,o),o+=2,l.maxComponentDepth=s.readUshort(a,o),o+=2),l},e.name={},e.name.parse=function(a,o,r){var s=e._bin,l={};s.readUshort(a,o),o+=2;var c=s.readUshort(a,o);o+=2,s.readUshort(a,o);for(var u,C=["copyright","fontFamily","fontSubfamily","ID","fullName","version","postScriptName","trademark","manufacturer","designer","description","urlVendor","urlDesigner","licence","licenceURL","---","typoFamilyName","typoSubfamilyName","compatibleFull","sampleText","postScriptCID","wwsFamilyName","wwsSubfamilyName","lightPalette","darkPalette"],h=o+=2,m=0;m<c;m++){var p=s.readUshort(a,o);o+=2;var B=s.readUshort(a,o);o+=2;var b=s.readUshort(a,o);o+=2;var y=s.readUshort(a,o);o+=2;var S=s.readUshort(a,o);o+=2;var R=s.readUshort(a,o);o+=2;var Z,x=C[y],M=h+12*c+R;if(p==0)Z=s.readUnicode(a,M,S/2);else if(p==3&&B==0)Z=s.readUnicode(a,M,S/2);else if(B==0)Z=s.readASCII(a,M,S);else if(B==1)Z=s.readUnicode(a,M,S/2);else if(B==3)Z=s.readUnicode(a,M,S/2);else{if(p!=1)throw"unknown encoding "+B+", platformID: "+p;Z=s.readASCII(a,M,S),console.debug("reading unknown MAC encoding "+B+" as ASCII")}var E="p"+p+","+b.toString(16);l[E]==null&&(l[E]={}),l[E][x!==void 0?x:y]=Z,l[E]._lang=b}for(var F in l)if(l[F].postScriptName!=null&&l[F]._lang==1033)return l[F];for(var F in l)if(l[F].postScriptName!=null&&l[F]._lang==0)return l[F];for(var F in l)if(l[F].postScriptName!=null&&l[F]._lang==3084)return l[F];for(var F in l)if(l[F].postScriptName!=null)return l[F];for(var F in l){u=F;break}return console.debug("returning name table with languageID "+l[u]._lang),l[u]},e["OS/2"]={},e["OS/2"].parse=function(a,o,r){var s=e._bin.readUshort(a,o);o+=2;var l={};if(s==0)e["OS/2"].version0(a,o,l);else if(s==1)e["OS/2"].version1(a,o,l);else if(s==2||s==3||s==4)e["OS/2"].version2(a,o,l);else{if(s!=5)throw"unknown OS/2 table version: "+s;e["OS/2"].version5(a,o,l)}return l},e["OS/2"].version0=function(a,o,r){var s=e._bin;return r.xAvgCharWidth=s.readShort(a,o),o+=2,r.usWeightClass=s.readUshort(a,o),o+=2,r.usWidthClass=s.readUshort(a,o),o+=2,r.fsType=s.readUshort(a,o),o+=2,r.ySubscriptXSize=s.readShort(a,o),o+=2,r.ySubscriptYSize=s.readShort(a,o),o+=2,r.ySubscriptXOffset=s.readShort(a,o),o+=2,r.ySubscriptYOffset=s.readShort(a,o),o+=2,r.ySuperscriptXSize=s.readShort(a,o),o+=2,r.ySuperscriptYSize=s.readShort(a,o),o+=2,r.ySuperscriptXOffset=s.readShort(a,o),o+=2,r.ySuperscriptYOffset=s.readShort(a,o),o+=2,r.yStrikeoutSize=s.readShort(a,o),o+=2,r.yStrikeoutPosition=s.readShort(a,o),o+=2,r.sFamilyClass=s.readShort(a,o),o+=2,r.panose=s.readBytes(a,o,10),o+=10,r.ulUnicodeRange1=s.readUint(a,o),o+=4,r.ulUnicodeRange2=s.readUint(a,o),o+=4,r.ulUnicodeRange3=s.readUint(a,o),o+=4,r.ulUnicodeRange4=s.readUint(a,o),o+=4,r.achVendID=[s.readInt8(a,o),s.readInt8(a,o+1),s.readInt8(a,o+2),s.readInt8(a,o+3)],o+=4,r.fsSelection=s.readUshort(a,o),o+=2,r.usFirstCharIndex=s.readUshort(a,o),o+=2,r.usLastCharIndex=s.readUshort(a,o),o+=2,r.sTypoAscender=s.readShort(a,o),o+=2,r.sTypoDescender=s.readShort(a,o),o+=2,r.sTypoLineGap=s.readShort(a,o),o+=2,r.usWinAscent=s.readUshort(a,o),o+=2,r.usWinDescent=s.readUshort(a,o),o+=2},e["OS/2"].version1=function(a,o,r){var s=e._bin;return o=e["OS/2"].version0(a,o,r),r.ulCodePageRange1=s.readUint(a,o),o+=4,r.ulCodePageRange2=s.readUint(a,o),o+=4},e["OS/2"].version2=function(a,o,r){var s=e._bin;return o=e["OS/2"].version1(a,o,r),r.sxHeight=s.readShort(a,o),o+=2,r.sCapHeight=s.readShort(a,o),o+=2,r.usDefault=s.readUshort(a,o),o+=2,r.usBreak=s.readUshort(a,o),o+=2,r.usMaxContext=s.readUshort(a,o),o+=2},e["OS/2"].version5=function(a,o,r){var s=e._bin;return o=e["OS/2"].version2(a,o,r),r.usLowerOpticalPointSize=s.readUshort(a,o),o+=2,r.usUpperOpticalPointSize=s.readUshort(a,o),o+=2},e.post={},e.post.parse=function(a,o,r){var s=e._bin,l={};return l.version=s.readFixed(a,o),o+=4,l.italicAngle=s.readFixed(a,o),o+=4,l.underlinePosition=s.readShort(a,o),o+=2,l.underlineThickness=s.readShort(a,o),o+=2,l},e==null&&(e={}),e.U==null&&(e.U={}),e.U.codeToGlyph=function(a,o){var r=a.cmap,s=-1;if(r.p0e4!=null?s=r.p0e4:r.p3e1!=null?s=r.p3e1:r.p1e0!=null?s=r.p1e0:r.p0e3!=null&&(s=r.p0e3),s==-1)throw"no familiar platform and encoding!";var l=r.tables[s];if(l.format==0)return o>=l.map.length?0:l.map[o];if(l.format==4){for(var c=-1,u=0;u<l.endCount.length;u++)if(o<=l.endCount[u]){c=u;break}return c==-1||l.startCount[c]>o?0:65535&(l.idRangeOffset[c]!=0?l.glyphIdArray[o-l.startCount[c]+(l.idRangeOffset[c]>>1)-(l.idRangeOffset.length-c)]:o+l.idDelta[c])}if(l.format==12){if(o>l.groups[l.groups.length-1][1])return 0;for(u=0;u<l.groups.length;u++){var C=l.groups[u];if(C[0]<=o&&o<=C[1])return C[2]+(o-C[0])}return 0}throw"unknown cmap table format "+l.format},e.U.glyphToPath=function(a,o){var r={cmds:[],crds:[]};if(a.SVG&&a.SVG.entries[o]){var s=a.SVG.entries[o];return s==null?r:(typeof s=="string"&&(s=e.SVG.toPath(s),a.SVG.entries[o]=s),s)}if(a.CFF){var l={x:0,y:0,stack:[],nStems:0,haveWidth:!1,width:a.CFF.Private?a.CFF.Private.defaultWidthX:0,open:!1},c=a.CFF,u=a.CFF.Private;if(c.ROS){for(var C=0;c.FDSelect[C+2]<=o;)C+=2;u=c.FDArray[c.FDSelect[C+1]].Private}e.U._drawCFF(a.CFF.CharStrings[o],l,c,u,r)}else a.glyf&&e.U._drawGlyf(o,a,r);return r},e.U._drawGlyf=function(a,o,r){var s=o.glyf[a];s==null&&(s=o.glyf[a]=e.glyf._parseGlyf(o,a)),s!=null&&(s.noc>-1?e.U._simpleGlyph(s,r):e.U._compoGlyph(s,o,r))},e.U._simpleGlyph=function(a,o){for(var r=0;r<a.noc;r++){for(var s=r==0?0:a.endPts[r-1]+1,l=a.endPts[r],c=s;c<=l;c++){var u=c==s?l:c-1,C=c==l?s:c+1,h=1&a.flags[c],m=1&a.flags[u],p=1&a.flags[C],B=a.xs[c],b=a.ys[c];if(c==s)if(h){if(!m){e.U.P.moveTo(o,B,b);continue}e.U.P.moveTo(o,a.xs[u],a.ys[u])}else m?e.U.P.moveTo(o,a.xs[u],a.ys[u]):e.U.P.moveTo(o,(a.xs[u]+B)/2,(a.ys[u]+b)/2);h?m&&e.U.P.lineTo(o,B,b):p?e.U.P.qcurveTo(o,B,b,a.xs[C],a.ys[C]):e.U.P.qcurveTo(o,B,b,(B+a.xs[C])/2,(b+a.ys[C])/2)}e.U.P.closePath(o)}},e.U._compoGlyph=function(a,o,r){for(var s=0;s<a.parts.length;s++){var l={cmds:[],crds:[]},c=a.parts[s];e.U._drawGlyf(c.glyphIndex,o,l);for(var u=c.m,C=0;C<l.crds.length;C+=2){var h=l.crds[C],m=l.crds[C+1];r.crds.push(h*u.a+m*u.b+u.tx),r.crds.push(h*u.c+m*u.d+u.ty)}for(C=0;C<l.cmds.length;C++)r.cmds.push(l.cmds[C])}},e.U._getGlyphClass=function(a,o){var r=e._lctf.getInterval(o,a);return r==-1?0:o[r+2]},e.U._applySubs=function(a,o,r,s){for(var l=a.length-o-1,c=0;c<r.tabs.length;c++)if(r.tabs[c]!=null){var u,C=r.tabs[c];if(!C.coverage||(u=e._lctf.coverageIndex(C.coverage,a[o]))!=-1){if(r.ltype==1)a[o],C.fmt==1?a[o]=a[o]+C.delta:a[o]=C.newg[u];else if(r.ltype==4)for(var h=C.vals[u],m=0;m<h.length;m++){var p=h[m],B=p.chain.length;if(!(B>l)){for(var b=!0,y=0,S=0;S<B;S++){for(;a[o+y+(1+S)]==-1;)y++;p.chain[S]!=a[o+y+(1+S)]&&(b=!1)}if(b){for(a[o]=p.nglyph,S=0;S<B+y;S++)a[o+S+1]=-1;break}}}else if(r.ltype==5&&C.fmt==2)for(var R=e._lctf.getInterval(C.cDef,a[o]),Z=C.cDef[R+2],x=C.scset[Z],M=0;M<x.length;M++){var E=x[M],F=E.input;if(!(F.length>l)){for(b=!0,S=0;S<F.length;S++){var N=e._lctf.getInterval(C.cDef,a[o+1+S]);if(R==-1&&C.cDef[N+2]!=F[S]){b=!1;break}}if(b){var H=E.substLookupRecords;for(m=0;m<H.length;m+=2)H[m],H[m+1]}}}else if(r.ltype==6&&C.fmt==3){if(!e.U._glsCovered(a,C.backCvg,o-C.backCvg.length)||!e.U._glsCovered(a,C.inptCvg,o)||!e.U._glsCovered(a,C.ahedCvg,o+C.inptCvg.length))continue;var z=C.lookupRec;for(M=0;M<z.length;M+=2){R=z[M];var _=s[z[M+1]];e.U._applySubs(a,o+R,_,s)}}}}},e.U._glsCovered=function(a,o,r){for(var s=0;s<o.length;s++)if(e._lctf.coverageIndex(o[s],a[r+s])==-1)return!1;return!0},e.U.glyphsToPath=function(a,o,r){for(var s={cmds:[],crds:[]},l=0,c=0;c<o.length;c++){var u=o[c];if(u!=-1){for(var C=c<o.length-1&&o[c+1]!=-1?o[c+1]:0,h=e.U.glyphToPath(a,u),m=0;m<h.crds.length;m+=2)s.crds.push(h.crds[m]+l),s.crds.push(h.crds[m+1]);for(r&&s.cmds.push(r),m=0;m<h.cmds.length;m++)s.cmds.push(h.cmds[m]);r&&s.cmds.push("X"),l+=a.hmtx.aWidth[u],c<o.length-1&&(l+=e.U.getPairAdjustment(a,u,C))}}return s},e.U.P={},e.U.P.moveTo=function(a,o,r){a.cmds.push("M"),a.crds.push(o,r)},e.U.P.lineTo=function(a,o,r){a.cmds.push("L"),a.crds.push(o,r)},e.U.P.curveTo=function(a,o,r,s,l,c,u){a.cmds.push("C"),a.crds.push(o,r,s,l,c,u)},e.U.P.qcurveTo=function(a,o,r,s,l){a.cmds.push("Q"),a.crds.push(o,r,s,l)},e.U.P.closePath=function(a){a.cmds.push("Z")},e.U._drawCFF=function(a,o,r,s,l){for(var c=o.stack,u=o.nStems,C=o.haveWidth,h=o.width,m=o.open,p=0,B=o.x,b=o.y,y=0,S=0,R=0,Z=0,x=0,M=0,E=0,F=0,N=0,H=0,z={val:0,size:0};p<a.length;){e.CFF.getCharString(a,p,z);var _=z.val;if(p+=z.size,_=="o1"||_=="o18")c.length%2!=0&&!C&&(h=c.shift()+s.nominalWidthX),u+=c.length>>1,c.length=0,C=!0;else if(_=="o3"||_=="o23")c.length%2!=0&&!C&&(h=c.shift()+s.nominalWidthX),u+=c.length>>1,c.length=0,C=!0;else if(_=="o4")c.length>1&&!C&&(h=c.shift()+s.nominalWidthX,C=!0),m&&e.U.P.closePath(l),b+=c.pop(),e.U.P.moveTo(l,B,b),m=!0;else if(_=="o5")for(;c.length>0;)B+=c.shift(),b+=c.shift(),e.U.P.lineTo(l,B,b);else if(_=="o6"||_=="o7")for(var D=c.length,P=_=="o6",$=0;$<D;$++){var X=c.shift();P?B+=X:b+=X,P=!P,e.U.P.lineTo(l,B,b)}else if(_=="o8"||_=="o24"){D=c.length;for(var L=0;L+6<=D;)y=B+c.shift(),S=b+c.shift(),R=y+c.shift(),Z=S+c.shift(),B=R+c.shift(),b=Z+c.shift(),e.U.P.curveTo(l,y,S,R,Z,B,b),L+=6;_=="o24"&&(B+=c.shift(),b+=c.shift(),e.U.P.lineTo(l,B,b))}else{if(_=="o11")break;if(_=="o1234"||_=="o1235"||_=="o1236"||_=="o1237")_=="o1234"&&(S=b,R=(y=B+c.shift())+c.shift(),H=Z=S+c.shift(),M=Z,F=b,B=(E=(x=(N=R+c.shift())+c.shift())+c.shift())+c.shift(),e.U.P.curveTo(l,y,S,R,Z,N,H),e.U.P.curveTo(l,x,M,E,F,B,b)),_=="o1235"&&(y=B+c.shift(),S=b+c.shift(),R=y+c.shift(),Z=S+c.shift(),N=R+c.shift(),H=Z+c.shift(),x=N+c.shift(),M=H+c.shift(),E=x+c.shift(),F=M+c.shift(),B=E+c.shift(),b=F+c.shift(),c.shift(),e.U.P.curveTo(l,y,S,R,Z,N,H),e.U.P.curveTo(l,x,M,E,F,B,b)),_=="o1236"&&(y=B+c.shift(),S=b+c.shift(),R=y+c.shift(),H=Z=S+c.shift(),M=Z,E=(x=(N=R+c.shift())+c.shift())+c.shift(),F=M+c.shift(),B=E+c.shift(),e.U.P.curveTo(l,y,S,R,Z,N,H),e.U.P.curveTo(l,x,M,E,F,B,b)),_=="o1237"&&(y=B+c.shift(),S=b+c.shift(),R=y+c.shift(),Z=S+c.shift(),N=R+c.shift(),H=Z+c.shift(),x=N+c.shift(),M=H+c.shift(),E=x+c.shift(),F=M+c.shift(),Math.abs(E-B)>Math.abs(F-b)?B=E+c.shift():b=F+c.shift(),e.U.P.curveTo(l,y,S,R,Z,N,H),e.U.P.curveTo(l,x,M,E,F,B,b));else if(_=="o14"){if(c.length>0&&!C&&(h=c.shift()+r.nominalWidthX,C=!0),c.length==4){var U=c.shift(),q=c.shift(),K=c.shift(),O=c.shift(),j=e.CFF.glyphBySE(r,K),ne=e.CFF.glyphBySE(r,O);e.U._drawCFF(r.CharStrings[j],o,r,s,l),o.x=U,o.y=q,e.U._drawCFF(r.CharStrings[ne],o,r,s,l)}m&&(e.U.P.closePath(l),m=!1)}else if(_=="o19"||_=="o20")c.length%2!=0&&!C&&(h=c.shift()+s.nominalWidthX),u+=c.length>>1,c.length=0,C=!0,p+=u+7>>3;else if(_=="o21")c.length>2&&!C&&(h=c.shift()+s.nominalWidthX,C=!0),b+=c.pop(),B+=c.pop(),m&&e.U.P.closePath(l),e.U.P.moveTo(l,B,b),m=!0;else if(_=="o22")c.length>1&&!C&&(h=c.shift()+s.nominalWidthX,C=!0),B+=c.pop(),m&&e.U.P.closePath(l),e.U.P.moveTo(l,B,b),m=!0;else if(_=="o25"){for(;c.length>6;)B+=c.shift(),b+=c.shift(),e.U.P.lineTo(l,B,b);y=B+c.shift(),S=b+c.shift(),R=y+c.shift(),Z=S+c.shift(),B=R+c.shift(),b=Z+c.shift(),e.U.P.curveTo(l,y,S,R,Z,B,b)}else if(_=="o26")for(c.length%2&&(B+=c.shift());c.length>0;)y=B,S=b+c.shift(),B=R=y+c.shift(),b=(Z=S+c.shift())+c.shift(),e.U.P.curveTo(l,y,S,R,Z,B,b);else if(_=="o27")for(c.length%2&&(b+=c.shift());c.length>0;)S=b,R=(y=B+c.shift())+c.shift(),Z=S+c.shift(),B=R+c.shift(),b=Z,e.U.P.curveTo(l,y,S,R,Z,B,b);else if(_=="o10"||_=="o29"){var k=_=="o10"?s:r;if(c.length==0)console.debug("error: empty stack");else{var ie=c.pop(),re=k.Subrs[ie+k.Bias];o.x=B,o.y=b,o.nStems=u,o.haveWidth=C,o.width=h,o.open=m,e.U._drawCFF(re,o,r,s,l),B=o.x,b=o.y,u=o.nStems,C=o.haveWidth,h=o.width,m=o.open}}else if(_=="o30"||_=="o31"){var ge=c.length,de=(L=0,_=="o31");for(L+=ge-(D=-3&ge);L<D;)de?(S=b,R=(y=B+c.shift())+c.shift(),b=(Z=S+c.shift())+c.shift(),D-L==5?(B=R+c.shift(),L++):B=R,de=!1):(y=B,S=b+c.shift(),R=y+c.shift(),Z=S+c.shift(),B=R+c.shift(),D-L==5?(b=Z+c.shift(),L++):b=Z,de=!0),e.U.P.curveTo(l,y,S,R,Z,B,b),L+=4}else{if((_+"").charAt(0)=="o")throw console.debug("Unknown operation: "+_,a),_;c.push(_)}}}o.x=B,o.y=b,o.nStems=u,o.haveWidth=C,o.width=h,o.open=m};var t=e,i={Typr:t};return n.Typr=t,n.default=i,Object.defineProperty(n,"__esModule",{value:!0}),n}({}).Typr}/*!
Custom bundle of woff2otf (https://github.com/arty-name/woff2otf) with fflate
(https://github.com/101arrowz/fflate) for use in Troika text rendering. 
Original licenses apply: 
- fflate: https://github.com/101arrowz/fflate/blob/master/LICENSE (MIT)
- woff2otf.js: https://github.com/arty-name/woff2otf/blob/master/woff2otf.js (Apache2)
*/function H$(){return function(n){var e=Uint8Array,t=Uint16Array,i=Uint32Array,a=new e([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),o=new e([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),r=new e([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),s=function(_,D){for(var P=new t(31),$=0;$<31;++$)P[$]=D+=1<<_[$-1];var X=new i(P[30]);for($=1;$<30;++$)for(var L=P[$];L<P[$+1];++L)X[L]=L-P[$]<<5|$;return[P,X]},l=s(a,2),c=l[0],u=l[1];c[28]=258,u[258]=28;for(var C=s(o,0)[0],h=new t(32768),m=0;m<32768;++m){var p=(43690&m)>>>1|(21845&m)<<1;p=(61680&(p=(52428&p)>>>2|(13107&p)<<2))>>>4|(3855&p)<<4,h[m]=((65280&p)>>>8|(255&p)<<8)>>>1}var B=function(_,D,P){for(var $=_.length,X=0,L=new t(D);X<$;++X)++L[_[X]-1];var U,q=new t(D);for(X=0;X<D;++X)q[X]=q[X-1]+L[X-1]<<1;{U=new t(1<<D);var K=15-D;for(X=0;X<$;++X)if(_[X])for(var O=X<<4|_[X],j=D-_[X],ne=q[_[X]-1]++<<j,k=ne|(1<<j)-1;ne<=k;++ne)U[h[ne]>>>K]=O}return U},b=new e(288);for(m=0;m<144;++m)b[m]=8;for(m=144;m<256;++m)b[m]=9;for(m=256;m<280;++m)b[m]=7;for(m=280;m<288;++m)b[m]=8;var y=new e(32);for(m=0;m<32;++m)y[m]=5;var S=B(b,9),R=B(y,5),Z=function(_){for(var D=_[0],P=1;P<_.length;++P)_[P]>D&&(D=_[P]);return D},x=function(_,D,P){var $=D/8|0;return(_[$]|_[$+1]<<8)>>(7&D)&P},M=function(_,D){var P=D/8|0;return(_[P]|_[P+1]<<8|_[P+2]<<16)>>(7&D)},E=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],F=function(_,D,P){var $=new Error(D||E[_]);if($.code=_,Error.captureStackTrace&&Error.captureStackTrace($,F),!P)throw $;return $},N=function(_,D,P){var $=_.length;if(!$||P&&!P.l&&$<5)return D||new e(0);var X=!D||P,L=!P||P.i;P||(P={}),D||(D=new e(3*$));var U,q=function(ke){var Ce=D.length;if(ke>Ce){var He=new e(Math.max(2*Ce,ke));He.set(D),D=He}},K=P.f||0,O=P.p||0,j=P.b||0,ne=P.l,k=P.d,ie=P.m,re=P.n,ge=8*$;do{if(!ne){P.f=K=x(_,O,1);var de=x(_,O+1,3);if(O+=3,!de){var xe=_[(Se=((U=O)/8|0)+(7&U&&1)+4)-4]|_[Se-3]<<8,Ne=Se+xe;if(Ne>$){L&&F(0);break}X&&q(j+xe),D.set(_.subarray(Se,Ne),j),P.b=j+=xe,P.p=O=8*Ne;continue}if(de==1)ne=S,k=R,ie=9,re=5;else if(de==2){var ye=x(_,O,31)+257,pe=x(_,O+10,15)+4,Te=ye+x(_,O+5,31)+1;O+=14;for(var le=new e(Te),Ye=new e(19),he=0;he<pe;++he)Ye[r[he]]=x(_,O+3*he,7);O+=3*pe;var Ge=Z(Ye),be=(1<<Ge)-1,Ee=B(Ye,Ge);for(he=0;he<Te;){var Se,ee=Ee[x(_,O,be)];if(O+=15&ee,(Se=ee>>>4)<16)le[he++]=Se;else{var Q=0,ce=0;for(Se==16?(ce=3+x(_,O,3),O+=2,Q=le[he-1]):Se==17?(ce=3+x(_,O,7),O+=3):Se==18&&(ce=11+x(_,O,127),O+=7);ce--;)le[he++]=Q}}var me=le.subarray(0,ye),Ze=le.subarray(ye);ie=Z(me),re=Z(Ze),ne=B(me,ie),k=B(Ze,re)}else F(1);if(O>ge){L&&F(0);break}}X&&q(j+131072);for(var Xe=(1<<ie)-1,De=(1<<re)-1,Oe=O;;Oe=O){var Je=(Q=ne[M(_,O)&Xe])>>>4;if((O+=15&Q)>ge){L&&F(0);break}if(Q||F(2),Je<256)D[j++]=Je;else{if(Je==256){Oe=O,ne=null;break}var At=Je-254;if(Je>264){var qe=a[he=Je-257];At=x(_,O,(1<<qe)-1)+c[he],O+=qe}var lt=k[M(_,O)&De],$e=lt>>>4;if(lt||F(3),O+=15&lt,Ze=C[$e],$e>3&&(qe=o[$e],Ze+=M(_,O)&(1<<qe)-1,O+=qe),O>ge){L&&F(0);break}X&&q(j+131072);for(var je=j+At;j<je;j+=4)D[j]=D[j-Ze],D[j+1]=D[j+1-Ze],D[j+2]=D[j+2-Ze],D[j+3]=D[j+3-Ze];j=je}}P.l=ne,P.p=Oe,P.b=j,ne&&(K=1,P.m=ie,P.d=k,P.n=re)}while(!K);return j==D.length?D:function(ke,Ce,He){(He==null||He>ke.length)&&(He=ke.length);var ht=new(ke instanceof t?t:ke instanceof i?i:e)(He-Ce);return ht.set(ke.subarray(Ce,He)),ht}(D,0,j)},H=new e(0),z=typeof TextDecoder<"u"&&new TextDecoder;try{z.decode(H,{stream:!0})}catch{}return n.convert_streams=function(_){var D=new DataView(_),P=0;function $(){var ye=D.getUint16(P);return P+=2,ye}function X(){var ye=D.getUint32(P);return P+=4,ye}function L(ye){xe.setUint16(Ne,ye),Ne+=2}function U(ye){xe.setUint32(Ne,ye),Ne+=4}for(var q={signature:X(),flavor:X(),length:X(),numTables:$(),reserved:$(),totalSfntSize:X(),majorVersion:$(),minorVersion:$(),metaOffset:X(),metaLength:X(),metaOrigLength:X(),privOffset:X(),privLength:X()},K=0;Math.pow(2,K)<=q.numTables;)K++;K--;for(var O=16*Math.pow(2,K),j=16*q.numTables-O,ne=12,k=[],ie=0;ie<q.numTables;ie++)k.push({tag:X(),offset:X(),compLength:X(),origLength:X(),origChecksum:X()}),ne+=16;var re,ge=new Uint8Array(12+16*k.length+k.reduce(function(ye,pe){return ye+pe.origLength+4},0)),de=ge.buffer,xe=new DataView(de),Ne=0;return U(q.flavor),L(q.numTables),L(O),L(K),L(j),k.forEach(function(ye){U(ye.tag),U(ye.origChecksum),U(ne),U(ye.origLength),ye.outOffset=ne,(ne+=ye.origLength)%4!=0&&(ne+=4-ne%4)}),k.forEach(function(ye){var pe,Te=_.slice(ye.offset,ye.offset+ye.compLength);if(ye.compLength!=ye.origLength){var le=new Uint8Array(ye.origLength);pe=new Uint8Array(Te,2),N(pe,le)}else le=new Uint8Array(Te);ge.set(le,ye.outOffset);var Ye=0;(ne=ye.outOffset+ye.origLength)%4!=0&&(Ye=4-ne%4),ge.set(new Uint8Array(Ye).buffer,ye.outOffset+ye.origLength),re=ne+Ye}),de.slice(0,re)},Object.defineProperty(n,"__esModule",{value:!0}),n}({}).convert_streams}function F$(n,e){const t={M:2,L:2,Q:4,C:6,Z:0},i={C:"18g,ca,368,1kz",D:"17k,6,2,2+4,5+c,2+6,2+1,10+1,9+f,j+11,2+1,a,2,2+1,15+2,3,j+2,6+3,2+8,2,2,2+1,w+a,4+e,3+3,2,3+2,3+5,23+w,2f+4,3,2+9,2,b,2+3,3,1k+9,6+1,3+1,2+2,2+d,30g,p+y,1,1+1g,f+x,2,sd2+1d,jf3+4,f+3,2+4,2+2,b+3,42,2,4+2,2+1,2,3,t+1,9f+w,2,el+2,2+g,d+2,2l,2+1,5,3+1,2+1,2,3,6,16wm+1v",R:"17m+3,2,2,6+3,m,15+2,2+2,h+h,13,3+8,2,2,3+1,2,p+1,x,5+4,5,a,2,2,3,u,c+2,g+1,5,2+1,4+1,5j,6+1,2,b,2+2,f,2+1,1s+2,2,3+1,7,1ez0,2,2+1,4+4,b,4,3,b,42,2+2,4,3,2+1,2,o+3,ae,ep,x,2o+2,3+1,3,5+1,6",L:"x9u,jff,a,fd,jv",T:"4t,gj+33,7o+4,1+1,7c+18,2,2+1,2+1,2,21+a,2,1b+k,h,2u+6,3+5,3+1,2+3,y,2,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,3,7,6+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+d,1,1+1,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,ek,3+1,r+4,1e+4,6+5,2p+c,1+3,1,1+2,1+b,2db+2,3y,2p+v,ff+3,30+1,n9x,1+2,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,5s,6y+2,ea,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+9,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2,2b+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,470+8,at4+4,1o+6,t5,1s+3,2a,f5l+1,2+3,43o+2,a+7,1+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,1,gzau,v+2n,3l+6n"},a=1,o=2,r=4,s=8,l=16,c=32;let u;function C(E){if(!u){const F={R:o,L:a,D:r,C:l,U:c,T:s};u=new Map;for(let N in i){let H=0;i[N].split(",").forEach(z=>{let[_,D]=z.split("+");_=parseInt(_,36),D=D?parseInt(D,36):0,u.set(H+=_,F[N]);for(let P=D;P--;)u.set(++H,F[N])})}}return u.get(E)||c}const h=1,m=2,p=3,B=4,b=[null,"isol","init","fina","medi"];function y(E){const F=new Uint8Array(E.length);let N=c,H=h,z=-1;for(let _=0;_<E.length;_++){const D=E.codePointAt(_);let P=C(D)|0,$=h;P&s||(N&(a|r|l)?P&(o|r|l)?($=p,(H===h||H===p)&&F[z]++):P&(a|c)&&(H===m||H===B)&&F[z]--:N&(o|c)&&(H===m||H===B)&&F[z]--,H=F[_]=$,N=P,z=_,D>65535&&_++)}return F}function S(E,F){const N=[];for(let z=0;z<F.length;z++){const _=F.codePointAt(z);_>65535&&z++,N.push(n.U.codeToGlyph(E,_))}const H=E.GSUB;if(H){const{lookupList:z,featureList:_}=H;let D;const P=/^(rlig|liga|mset|isol|init|fina|medi|half|pres|blws|ccmp)$/,$=[];_.forEach(X=>{if(P.test(X.tag))for(let L=0;L<X.tab.length;L++){if($[X.tab[L]])continue;$[X.tab[L]]=!0;const U=z[X.tab[L]],q=/^(isol|init|fina|medi)$/.test(X.tag);q&&!D&&(D=y(F));for(let K=0;K<N.length;K++)(!D||!q||b[D[K]]===X.tag)&&n.U._applySubs(N,K,U,z)}})}return N}function R(E,F){const N=new Int16Array(F.length*3);let H=0;for(;H<F.length;H++){const P=F[H];if(P===-1)continue;N[H*3+2]=E.hmtx.aWidth[P];const $=E.GPOS;if($){const X=$.lookupList;for(let L=0;L<X.length;L++){const U=X[L];for(let q=0;q<U.tabs.length;q++){const K=U.tabs[q];if(U.ltype===1){if(n._lctf.coverageIndex(K.coverage,P)!==-1&&K.pos){D(K.pos,H);break}}else if(U.ltype===2){let O=null,j=z();if(j!==-1){const ne=n._lctf.coverageIndex(K.coverage,F[j]);if(ne!==-1){if(K.fmt===1){const k=K.pairsets[ne];for(let ie=0;ie<k.length;ie++)k[ie].gid2===P&&(O=k[ie])}else if(K.fmt===2){const k=n.U._getGlyphClass(F[j],K.classDef1),ie=n.U._getGlyphClass(P,K.classDef2);O=K.matrix[k][ie]}if(O){O.val1&&D(O.val1,j),O.val2&&D(O.val2,H);break}}}}else if(U.ltype===4){const O=n._lctf.coverageIndex(K.markCoverage,P);if(O!==-1){const j=z(_),ne=j===-1?-1:n._lctf.coverageIndex(K.baseCoverage,F[j]);if(ne!==-1){const k=K.markArray[O],ie=K.baseArray[ne][k.markClass];N[H*3]=ie.x-k.x+N[j*3]-N[j*3+2],N[H*3+1]=ie.y-k.y+N[j*3+1];break}}}else if(U.ltype===6){const O=n._lctf.coverageIndex(K.mark1Coverage,P);if(O!==-1){const j=z();if(j!==-1){const ne=F[j];if(Z(E,ne)===3){const k=n._lctf.coverageIndex(K.mark2Coverage,ne);if(k!==-1){const ie=K.mark1Array[O],re=K.mark2Array[k][ie.markClass];N[H*3]=re.x-ie.x+N[j*3]-N[j*3+2],N[H*3+1]=re.y-ie.y+N[j*3+1];break}}}}}}}}else if(E.kern&&!E.cff){const X=z();if(X!==-1){const L=E.kern.glyph1.indexOf(F[X]);if(L!==-1){const U=E.kern.rval[L].glyph2.indexOf(P);U!==-1&&(N[X*3+2]+=E.kern.rval[L].vals[U])}}}}return N;function z(P){for(let $=H-1;$>=0;$--)if(F[$]!==-1&&(!P||P(F[$])))return $;return-1}function _(P){return Z(E,P)===1}function D(P,$){for(let X=0;X<3;X++)N[$*3+X]+=P[X]||0}}function Z(E,F){const N=E.GDEF&&E.GDEF.glyphClassDef;return N?n.U._getGlyphClass(F,N):0}function x(...E){for(let F=0;F<E.length;F++)if(typeof E[F]=="number")return E[F]}function M(E){const F=Object.create(null),N=E["OS/2"],H=E.hhea,z=E.head.unitsPerEm,_=x(N&&N.sTypoAscender,H&&H.ascender,z),D={unitsPerEm:z,ascender:_,descender:x(N&&N.sTypoDescender,H&&H.descender,0),capHeight:x(N&&N.sCapHeight,_),xHeight:x(N&&N.sxHeight,_),lineGap:x(N&&N.sTypoLineGap,H&&H.lineGap),supportsCodePoint(P){return n.U.codeToGlyph(E,P)>0},forEachGlyph(P,$,X,L){let U=0;const q=1/D.unitsPerEm*$,K=S(E,P);let O=0;const j=R(E,K);return K.forEach((ne,k)=>{if(ne!==-1){let ie=F[ne];if(!ie){const{cmds:re,crds:ge}=n.U.glyphToPath(E,ne);let de="",xe=0;for(let le=0,Ye=re.length;le<Ye;le++){const he=t[re[le]];de+=re[le];for(let Ge=1;Ge<=he;Ge++)de+=(Ge>1?",":"")+ge[xe++]}let Ne,ye,pe,Te;if(ge.length){Ne=ye=1/0,pe=Te=-1/0;for(let le=0,Ye=ge.length;le<Ye;le+=2){let he=ge[le],Ge=ge[le+1];he<Ne&&(Ne=he),Ge<ye&&(ye=Ge),he>pe&&(pe=he),Ge>Te&&(Te=Ge)}}else Ne=pe=ye=Te=0;ie=F[ne]={index:ne,advanceWidth:E.hmtx.aWidth[ne],xMin:Ne,yMin:ye,xMax:pe,yMax:Te,path:de}}L.call(null,ie,U+j[k*3]*q,j[k*3+1]*q,O),U+=j[k*3+2]*q,X&&(U+=X*$)}O+=P.codePointAt(O)>65535?2:1}),U}};return D}return function(F){const N=new Uint8Array(F,0,4),H=n._bin.readASCII(N,0,4);if(H==="wOFF")F=e(F);else if(H==="wOF2")throw new Error("woff2 fonts not supported");return M(n.parse(F)[0])}}const X$=jf({name:"Typr Font Parser",dependencies:[E$,H$,F$],init(n,e,t){const i=n(),a=e();return t(i,a)}});/*!
Custom bundle of @unicode-font-resolver/client v1.0.2 (https://github.com/lojjic/unicode-font-resolver)
for use in Troika text rendering. 
Original MIT license applies
*/function T$(){return function(n){var e=function(){this.buckets=new Map};e.prototype.add=function(R){var Z=R>>5;this.buckets.set(Z,(this.buckets.get(Z)||0)|1<<(31&R))},e.prototype.has=function(R){var Z=this.buckets.get(R>>5);return Z!==void 0&&(Z&1<<(31&R))!=0},e.prototype.serialize=function(){var R=[];return this.buckets.forEach(function(Z,x){R.push((+x).toString(36)+":"+Z.toString(36))}),R.join(",")},e.prototype.deserialize=function(R){var Z=this;this.buckets.clear(),R.split(",").forEach(function(x){var M=x.split(":");Z.buckets.set(parseInt(M[0],36),parseInt(M[1],36))})};var t=Math.pow(2,8),i=t-1,a=~i;function o(R){var Z=function(M){return M&a}(R).toString(16),x=function(M){return(M&a)+t-1}(R).toString(16);return"codepoint-index/plane"+(R>>16)+"/"+Z+"-"+x+".json"}function r(R,Z){var x=R&i,M=Z.codePointAt(x/6|0);return((M=(M||48)-48)&1<<x%6)!=0}function s(R,Z){var x;(x=R,x.replace(/U\+/gi,"").replace(/^,+|,+$/g,"").split(/,+/).map(function(M){return M.split("-").map(function(E){return parseInt(E.trim(),16)})})).forEach(function(M){var E=M[0],F=M[1];F===void 0&&(F=E),Z(E,F)})}function l(R,Z){s(R,function(x,M){for(var E=x;E<=M;E++)Z(E)})}var c={},u={},C=new WeakMap,h="https://cdn.jsdelivr.net/gh/lojjic/unicode-font-resolver@v1.0.1/packages/data";function m(R){var Z=C.get(R);return Z||(Z=new e,l(R.ranges,function(x){return Z.add(x)}),C.set(R,Z)),Z}var p,B=new Map;function b(R,Z,x){return R[Z]?Z:R[x]?x:function(M){for(var E in M)return E}(R)}function y(R,Z){var x=Z;if(!R.includes(x)){x=1/0;for(var M=0;M<R.length;M++)Math.abs(R[M]-Z)<Math.abs(x-Z)&&(x=R[M])}return x}function S(R){return p||(p=new Set,l("9-D,20,85,A0,1680,2000-200A,2028-202F,205F,3000",function(Z){p.add(Z)})),p.has(R)}return n.CodePointSet=e,n.clearCache=function(){c={},u={}},n.getFontsForString=function(R,Z){Z===void 0&&(Z={});var x,M=Z.lang;M===void 0&&(M=new RegExp("\\p{Script=Hangul}","u").test(x=R)?"ko":new RegExp("\\p{Script=Hiragana}|\\p{Script=Katakana}","u").test(x)?"ja":"en");var E=Z.category;E===void 0&&(E="sans-serif");var F=Z.style;F===void 0&&(F="normal");var N=Z.weight;N===void 0&&(N=400);var H=(Z.dataUrl||h).replace(/\/$/g,""),z=new Map,_=new Uint8Array(R.length),D={},P={},$=new Array(R.length),X=new Map,L=!1;function U(O){var j=B.get(O);return j||(j=fetch(H+"/"+O).then(function(ne){if(!ne.ok)throw new Error(ne.statusText);return ne.json().then(function(k){if(!Array.isArray(k)||k[0]!==1)throw new Error("Incorrect schema version; need 1, got "+k[0]);return k[1]})}).catch(function(ne){if(H!==h)return L||(console.error('unicode-font-resolver: Failed loading from dataUrl "'+H+'", trying default CDN. '+ne.message),L=!0),H=h,B.delete(O),U(O);throw ne}),B.set(O,j)),j}for(var q=function(O){var j=R.codePointAt(O),ne=o(j);$[O]=ne,c[ne]||X.has(ne)||X.set(ne,U(ne).then(function(k){c[ne]=k})),j>65535&&(O++,K=O)},K=0;K<R.length;K++)q(K);return Promise.all(X.values()).then(function(){X.clear();for(var O=function(ne){var k=R.codePointAt(ne),ie=null,re=c[$[ne]],ge=void 0;for(var de in re){var xe=P[de];if(xe===void 0&&(xe=P[de]=new RegExp(de).test(M||"en")),xe){for(var Ne in ge=de,re[de])if(r(k,re[de][Ne])){ie=Ne;break}break}}if(!ie){e:for(var ye in re)if(ye!==ge){for(var pe in re[ye])if(r(k,re[ye][pe])){ie=pe;break e}}}ie||(console.debug("No font coverage for U+"+k.toString(16)),ie="latin"),$[ne]=ie,u[ie]||X.has(ie)||X.set(ie,U("font-meta/"+ie+".json").then(function(Te){u[ie]=Te})),k>65535&&(ne++,j=ne)},j=0;j<R.length;j++)O(j);return Promise.all(X.values())}).then(function(){for(var O,j=null,ne=0;ne<R.length;ne++){var k=R.codePointAt(ne);if(j&&(S(k)||m(j).has(k)))_[ne]=_[ne-1];else{j=u[$[ne]];var ie=D[j.id];if(!ie){var re=j.typeforms,ge=b(re,E,"sans-serif"),de=b(re[ge],F,"normal"),xe=y((O=re[ge])===null||O===void 0?void 0:O[de],N);ie=D[j.id]=H+"/font-files/"+j.id+"/"+ge+"."+de+"."+xe+".woff"}var Ne=z.get(ie);Ne==null&&(Ne=z.size,z.set(ie,Ne)),_[ne]=Ne}k>65535&&(ne++,_[ne]=_[ne-1])}return{fontUrls:Array.from(z.keys()),chars:_}})},Object.defineProperty(n,"__esModule",{value:!0}),n}({})}function Y$(n,e){const t=Object.create(null),i=Object.create(null);function a(r,s){const l=c=>{console.error(`Failure loading font ${r}`,c)};try{const c=new XMLHttpRequest;c.open("get",r,!0),c.responseType="arraybuffer",c.onload=function(){if(c.status>=400)l(new Error(c.statusText));else if(c.status>0)try{const u=n(c.response);u.src=r,s(u)}catch(u){l(u)}},c.onerror=l,c.send()}catch(c){l(c)}}function o(r,s){let l=t[r];l?s(l):i[r]?i[r].push(s):(i[r]=[s],a(r,c=>{c.src=r,t[r]=c,i[r].forEach(u=>u(c)),delete i[r]}))}return function(r,s,{lang:l,fonts:c=[],style:u="normal",weight:C="normal",unicodeFontsURL:h}={}){const m=new Uint8Array(r.length),p=[];r.length||S();const B=new Map,b=[];if(u!=="italic"&&(u="normal"),typeof C!="number"&&(C=C==="bold"?700:400),c&&!Array.isArray(c)&&(c=[c]),c=c.slice().filter(Z=>!Z.lang||Z.lang.test(l)).reverse(),c.length){let E=0;(function F(N=0){for(let H=N,z=r.length;H<z;H++){const _=r.codePointAt(H);if(E===1&&p[m[H-1]].supportsCodePoint(_)||H>0&&/\s/.test(r[H]))m[H]=m[H-1],E===2&&(b[b.length-1][1]=H);else for(let D=m[H],P=c.length;D<=P;D++)if(D===P){const $=E===2?b[b.length-1]:b[b.length]=[H,H];$[1]=H,E=2}else{m[H]=D;const{src:$,unicodeRange:X}=c[D];if(!X||R(_,X)){const L=t[$];if(!L){o($,()=>{F(H)});return}if(L.supportsCodePoint(_)){let U=B.get(L);typeof U!="number"&&(U=p.length,p.push(L),B.set(L,U)),m[H]=U,E=1;break}}}_>65535&&H+1<z&&(m[H+1]=m[H],H++,E===2&&(b[b.length-1][1]=H))}y()})()}else b.push([0,r.length-1]),y();function y(){if(b.length){const Z=b.map(x=>r.substring(x[0],x[1]+1)).join(`
`);e.getFontsForString(Z,{lang:l||void 0,style:u,weight:C,dataUrl:h}).then(({fontUrls:x,chars:M})=>{const E=p.length;let F=0;b.forEach(H=>{for(let z=0,_=H[1]-H[0];z<=_;z++)m[H[0]+z]=M[F++]+E;F++});let N=0;x.forEach((H,z)=>{o(H,_=>{p[z+E]=_,++N===x.length&&S()})})})}else S()}function S(){s({chars:m,fonts:p})}function R(Z,x){for(let M=0;M<x.length;M++){const[E,F=E]=x[M];if(E<=Z&&Z<=F)return!0}return!1}}}const z$=jf({name:"FontResolver",dependencies:[Y$,X$,T$],init(n,e,t){return n(e,t())}});function K$(n,e){const i=/[\u00AD\u034F\u061C\u115F-\u1160\u17B4-\u17B5\u180B-\u180E\u200B-\u200F\u202A-\u202E\u2060-\u206F\u3164\uFE00-\uFE0F\uFEFF\uFFA0\uFFF0-\uFFF8]/,a="[^\\S\\u00A0]",o=new RegExp(`${a}|[\\-\\u007C\\u00AD\\u2010\\u2012-\\u2014\\u2027\\u2056\\u2E17\\u2E40]`);function r({text:p,lang:B,fonts:b,style:y,weight:S,preResolvedFonts:R,unicodeFontsURL:Z},x){const M=({chars:E,fonts:F})=>{let N,H;const z=[];for(let _=0;_<E.length;_++)E[_]!==H?(H=E[_],z.push(N={start:_,end:_,fontObj:F[E[_]]})):N.end=_;x(z)};R?M(R):n(p,M,{lang:B,fonts:b,style:y,weight:S,unicodeFontsURL:Z})}function s({text:p="",font:B,lang:b,sdfGlyphSize:y=64,fontSize:S=400,fontWeight:R=1,fontStyle:Z="normal",letterSpacing:x=0,lineHeight:M="normal",maxWidth:E=1/0,direction:F,textAlign:N="left",textIndent:H=0,whiteSpace:z="normal",overflowWrap:_="normal",anchorX:D=0,anchorY:P=0,metricsOnly:$=!1,unicodeFontsURL:X,preResolvedFonts:L=null,includeCaretPositions:U=!1,chunkedBoundsSize:q=8192,colorRanges:K=null},O){const j=C(),ne={fontLoad:0,typesetting:0};p.indexOf("\r")>-1&&(console.info("Typesetter: got text with \\r chars; normalizing to \\n"),p=p.replace(/\r\n/g,`
`).replace(/\r/g,`
`)),S=+S,x=+x,E=+E,M=M||"normal",H=+H,r({text:p,lang:b,style:Z,weight:R,fonts:typeof B=="string"?[{src:B}]:B,unicodeFontsURL:X,preResolvedFonts:L},k=>{ne.fontLoad=C()-j;const ie=isFinite(E);let re=null,ge=null,de=null,xe=null,Ne=null,ye=null,pe=null,Te=null,le=0,Ye=0,he=z!=="nowrap";const Ge=new Map,be=C();let Ee=H,Se=0,ee=new h;const Q=[ee];k.forEach(De=>{const{fontObj:Oe}=De,{ascender:Je,descender:At,unitsPerEm:qe,lineGap:lt,capHeight:$e,xHeight:je}=Oe;let ke=Ge.get(Oe);if(!ke){const ze=S/qe,Qe=M==="normal"?(Je-At+lt)*ze:M*S,ut=(Qe-(Je-At)*ze)/2,Rt=Math.min(Qe,(Je-At)*ze),mt=(Je+At)/2*ze+Rt/2;ke={index:Ge.size,src:Oe.src,fontObj:Oe,fontSizeMult:ze,unitsPerEm:qe,ascender:Je*ze,descender:At*ze,capHeight:$e*ze,xHeight:je*ze,lineHeight:Qe,baseline:-ut-Je*ze,caretTop:mt,caretBottom:mt-Rt},Ge.set(Oe,ke)}const{fontSizeMult:Ce}=ke,He=p.slice(De.start,De.end+1);let ht,we;Oe.forEachGlyph(He,S,x,(ze,Qe,ut,Rt)=>{Qe+=Se,Rt+=De.start,ht=Qe,we=ze;const mt=p.charAt(Rt),_t=ze.advanceWidth*Ce,Lt=ee.count;let Zt;if("isEmpty"in ze||(ze.isWhitespace=!!mt&&new RegExp(a).test(mt),ze.canBreakAfter=!!mt&&o.test(mt),ze.isEmpty=ze.xMin===ze.xMax||ze.yMin===ze.yMax||i.test(mt)),!ze.isWhitespace&&!ze.isEmpty&&Ye++,he&&ie&&!ze.isWhitespace&&Qe+_t+Ee>E&&Lt){if(ee.glyphAt(Lt-1).glyphObj.canBreakAfter)Zt=new h,Ee=-Qe;else for(let Ht=Lt;Ht--;)if(Ht===0&&_==="break-word"){Zt=new h,Ee=-Qe;break}else if(ee.glyphAt(Ht).glyphObj.canBreakAfter){Zt=ee.splitAt(Ht+1);const jt=Zt.glyphAt(0).x;Ee-=jt;for(let Ut=Zt.count;Ut--;)Zt.glyphAt(Ut).x-=jt;break}Zt&&(ee.isSoftWrapped=!0,ee=Zt,Q.push(ee),le=E)}let yt=ee.glyphAt(ee.count);yt.glyphObj=ze,yt.x=Qe+Ee,yt.y=ut,yt.width=_t,yt.charIndex=Rt,yt.fontData=ke,mt===`
`&&(ee=new h,Q.push(ee),Ee=-(Qe+_t+x*S)+H)}),Se=ht+we.advanceWidth*Ce+x*S});let ce=0;Q.forEach(De=>{let Oe=!0;for(let Je=De.count;Je--;){const At=De.glyphAt(Je);Oe&&!At.glyphObj.isWhitespace&&(De.width=At.x+At.width,De.width>le&&(le=De.width),Oe=!1);let{lineHeight:qe,capHeight:lt,xHeight:$e,baseline:je}=At.fontData;qe>De.lineHeight&&(De.lineHeight=qe);const ke=je-De.baseline;ke<0&&(De.baseline+=ke,De.cap+=ke,De.ex+=ke),De.cap=Math.max(De.cap,De.baseline+lt),De.ex=Math.max(De.ex,De.baseline+$e)}De.baseline-=ce,De.cap-=ce,De.ex-=ce,ce+=De.lineHeight});let me=0,Ze=0;if(D&&(typeof D=="number"?me=-D:typeof D=="string"&&(me=-le*(D==="left"?0:D==="center"?.5:D==="right"?1:c(D)))),P&&(typeof P=="number"?Ze=-P:typeof P=="string"&&(Ze=P==="top"?0:P==="top-baseline"?-Q[0].baseline:P==="top-cap"?-Q[0].cap:P==="top-ex"?-Q[0].ex:P==="middle"?ce/2:P==="bottom"?ce:P==="bottom-baseline"?-Q[Q.length-1].baseline:c(P)*ce)),!$){const De=e.getEmbeddingLevels(p,F);re=new Uint16Array(Ye),ge=new Uint8Array(Ye),de=new Float32Array(Ye*2),xe={},pe=[1/0,1/0,-1/0,-1/0],Te=[],U&&(ye=new Float32Array(p.length*4)),K&&(Ne=new Uint8Array(Ye*3));let Oe=0,Je=-1,At=-1,qe,lt;if(Q.forEach(($e,je)=>{let{count:ke,width:Ce}=$e;if(ke>0){let He=0;for(let Rt=ke;Rt--&&$e.glyphAt(Rt).glyphObj.isWhitespace;)He++;let ht=0,we=0;if(N==="center")ht=(le-Ce)/2;else if(N==="right")ht=le-Ce;else if(N==="justify"&&$e.isSoftWrapped){let Rt=0;for(let mt=ke-He;mt--;)$e.glyphAt(mt).glyphObj.isWhitespace&&Rt++;we=(le-Ce)/Rt}if(we||ht){let Rt=0;for(let mt=0;mt<ke;mt++){let _t=$e.glyphAt(mt);const Lt=_t.glyphObj;_t.x+=ht+Rt,we!==0&&Lt.isWhitespace&&mt<ke-He&&(Rt+=we,_t.width+=we)}}const ze=e.getReorderSegments(p,De,$e.glyphAt(0).charIndex,$e.glyphAt($e.count-1).charIndex);for(let Rt=0;Rt<ze.length;Rt++){const[mt,_t]=ze[Rt];let Lt=1/0,Zt=-1/0;for(let yt=0;yt<ke;yt++)if($e.glyphAt(yt).charIndex>=mt){let Ht=yt,jt=yt;for(;jt<ke;jt++){let Ut=$e.glyphAt(jt);if(Ut.charIndex>_t)break;jt<ke-He&&(Lt=Math.min(Lt,Ut.x),Zt=Math.max(Zt,Ut.x+Ut.width))}for(let Ut=Ht;Ut<jt;Ut++){const Nt=$e.glyphAt(Ut);Nt.x=Zt-(Nt.x+Nt.width-Lt)}break}}let Qe;const ut=Rt=>Qe=Rt;for(let Rt=0;Rt<ke;Rt++){const mt=$e.glyphAt(Rt);Qe=mt.glyphObj;const _t=Qe.index,Lt=De.levels[mt.charIndex]&1;if(Lt){const Zt=e.getMirroredCharacter(p[mt.charIndex]);Zt&&mt.fontData.fontObj.forEachGlyph(Zt,0,0,ut)}if(U){const{charIndex:Zt,fontData:yt}=mt,Ht=mt.x+me,jt=mt.x+mt.width+me;ye[Zt*4]=Lt?jt:Ht,ye[Zt*4+1]=Lt?Ht:jt,ye[Zt*4+2]=$e.baseline+yt.caretBottom+Ze,ye[Zt*4+3]=$e.baseline+yt.caretTop+Ze;const Ut=Zt-Je;Ut>1&&u(ye,Je,Ut),Je=Zt}if(K){const{charIndex:Zt}=mt;for(;Zt>At;)At++,K.hasOwnProperty(At)&&(lt=K[At])}if(!Qe.isWhitespace&&!Qe.isEmpty){const Zt=Oe++,{fontSizeMult:yt,src:Ht,index:jt}=mt.fontData,Ut=xe[Ht]||(xe[Ht]={});Ut[_t]||(Ut[_t]={path:Qe.path,pathBounds:[Qe.xMin,Qe.yMin,Qe.xMax,Qe.yMax]});const Nt=mt.x+me,Tt=mt.y+$e.baseline+Ze;de[Zt*2]=Nt,de[Zt*2+1]=Tt;const Pt=Nt+Qe.xMin*yt,qt=Tt+Qe.yMin*yt,kt=Nt+Qe.xMax*yt,Ft=Tt+Qe.yMax*yt;Pt<pe[0]&&(pe[0]=Pt),qt<pe[1]&&(pe[1]=qt),kt>pe[2]&&(pe[2]=kt),Ft>pe[3]&&(pe[3]=Ft),Zt%q===0&&(qe={start:Zt,end:Zt,rect:[1/0,1/0,-1/0,-1/0]},Te.push(qe)),qe.end++;const fn=qe.rect;if(Pt<fn[0]&&(fn[0]=Pt),qt<fn[1]&&(fn[1]=qt),kt>fn[2]&&(fn[2]=kt),Ft>fn[3]&&(fn[3]=Ft),re[Zt]=_t,ge[Zt]=jt,K){const sn=Zt*3;Ne[sn]=lt>>16&255,Ne[sn+1]=lt>>8&255,Ne[sn+2]=lt&255}}}}}),ye){const $e=p.length-Je;$e>1&&u(ye,Je,$e)}}const Xe=[];Ge.forEach(({index:De,src:Oe,unitsPerEm:Je,ascender:At,descender:qe,lineHeight:lt,capHeight:$e,xHeight:je})=>{Xe[De]={src:Oe,unitsPerEm:Je,ascender:At,descender:qe,lineHeight:lt,capHeight:$e,xHeight:je}}),ne.typesetting=C()-be,O({glyphIds:re,glyphFontIndices:ge,glyphPositions:de,glyphData:xe,fontData:Xe,caretPositions:ye,glyphColors:Ne,chunkedBounds:Te,fontSize:S,topBaseline:Ze+Q[0].baseline,blockBounds:[me,Ze-ce,me+le,Ze],visibleBounds:pe,timings:ne})})}function l(p,B){s({...p,metricsOnly:!0},b=>{const[y,S,R,Z]=b.blockBounds;B({width:R-y,height:Z-S})})}function c(p){let B=p.match(/^([\d.]+)%$/),b=B?parseFloat(B[1]):NaN;return isNaN(b)?0:b/100}function u(p,B,b){const y=p[B*4],S=p[B*4+1],R=p[B*4+2],Z=p[B*4+3],x=(S-y)/b;for(let M=0;M<b;M++){const E=(B+M)*4;p[E]=y+x*M,p[E+1]=y+x*(M+1),p[E+2]=R,p[E+3]=Z}}function C(){return(self.performance||Date).now()}function h(){this.data=[]}const m=["glyphObj","x","y","width","charIndex","fontData"];return h.prototype={width:0,lineHeight:0,baseline:0,cap:0,ex:0,isSoftWrapped:!1,get count(){return Math.ceil(this.data.length/m.length)},glyphAt(p){let B=h.flyweight;return B.data=this.data,B.index=p,B},splitAt(p){let B=new h;return B.data=this.data.splice(p*m.length),B}},h.flyweight=m.reduce((p,B,b,y)=>(Object.defineProperty(p,B,{get(){return this.data[this.index*m.length+b]},set(S){this.data[this.index*m.length+b]=S}}),p),{data:null,index:0}),{typeset:s,measure:l}}const aI=()=>(self.performance||Date).now(),JG=fT();let RE;function L$(n,e,t,i,a,o,r,s,l,c,u=!0){return u?D$(n,e,t,i,a,o,r,s,l,c).then(null,C=>(RE||(console.warn("WebGL SDF generation failed, falling back to JS",C),RE=!0),xE(n,e,t,i,a,o,r,s,l,c))):xE(n,e,t,i,a,o,r,s,l,c)}const Zy=[],_$=5;let fR=0;function mT(){const n=aI();for(;Zy.length&&aI()-n<_$;)Zy.shift()();fR=Zy.length?setTimeout(mT,0):0}const D$=(...n)=>new Promise((e,t)=>{Zy.push(()=>{const i=aI();try{JG.webgl.generateIntoCanvas(...n),e({timing:aI()-i})}catch(a){t(a)}}),fR||(fR=setTimeout(mT,0))}),O$=4,U$=2e3,ZE={};let k$=0;function xE(n,e,t,i,a,o,r,s,l,c){const u="TroikaTextSDFGenerator_JS_"+k$++%O$;let C=ZE[u];return C||(C=ZE[u]={workerModule:jf({name:u,workerId:u,dependencies:[fT,aI],init(h,m){const p=h().javascript.generate;return function(...B){const b=m();return{textureData:p(...B),timing:m()-b}}},getTransferables(h){return[h.textureData.buffer]}}),requests:0,idleTimer:null}),C.requests++,clearTimeout(C.idleTimer),C.workerModule(n,e,t,i,a,o).then(({textureData:h,timing:m})=>{const p=aI(),B=new Uint8Array(h.length*4);for(let b=0;b<h.length;b++)B[b*4+c]=h[b];return JG.webglUtils.renderImageData(r,B,s,l,n,e,1<<3-c),m+=aI()-p,--C.requests===0&&(C.idleTimer=setTimeout(()=>{G$(u)},U$)),{timing:m}})}function P$(n){n._warm||(JG.webgl.isSupported(n),n._warm=!0)}const J$=JG.webglUtils.resizeWebGLCanvasWithoutClearing,Qm={unicodeFontsURL:null,sdfGlyphSize:64,sdfMargin:1/16,sdfExponent:9,textureWidth:2048},j$=new dn;function Dh(){return(self.performance||Date).now()}const ME=Object.create(null);function pT(n,e){n=$$({},n);const t=Dh(),i=[];if(n.font&&i.push({label:"user",src:eee(n.font)}),n.font=i,n.text=""+n.text,n.sdfGlyphSize=n.sdfGlyphSize||Qm.sdfGlyphSize,n.unicodeFontsURL=n.unicodeFontsURL||Qm.unicodeFontsURL,n.colorRanges!=null){let h={};for(let m in n.colorRanges)if(n.colorRanges.hasOwnProperty(m)){let p=n.colorRanges[m];typeof p!="number"&&(p=j$.set(p).getHex()),h[m]=p}n.colorRanges=h}Object.freeze(n);const{textureWidth:a,sdfExponent:o}=Qm,{sdfGlyphSize:r}=n,s=a/r*4;let l=ME[r];if(!l){const h=document.createElement("canvas");h.width=a,h.height=r*256/s,l=ME[r]={glyphCount:0,sdfGlyphSize:r,sdfCanvas:h,sdfTexture:new Fi(h,void 0,void 0,void 0,Bi,Bi),contextLost:!1,glyphsByFont:new Map},l.sdfTexture.generateMipmaps=!1,Q$(l)}const{sdfTexture:c,sdfCanvas:u}=l;yT(n).then(h=>{const{glyphIds:m,glyphFontIndices:p,fontData:B,glyphPositions:b,fontSize:y,timings:S}=h,R=[],Z=new Float32Array(m.length*4);let x=0,M=0;const E=Dh(),F=B.map(D=>{let P=l.glyphsByFont.get(D.src);return P||l.glyphsByFont.set(D.src,P=new Map),P});m.forEach((D,P)=>{const $=p[P],{src:X,unitsPerEm:L}=B[$];let U=F[$].get(D);if(!U){const{path:ne,pathBounds:k}=h.glyphData[X][D],ie=Math.max(k[2]-k[0],k[3]-k[1])/r*(Qm.sdfMargin*r+.5),re=l.glyphCount++,ge=[k[0]-ie,k[1]-ie,k[2]+ie,k[3]+ie];F[$].set(D,U={path:ne,atlasIndex:re,sdfViewBox:ge}),R.push(U)}const{sdfViewBox:q}=U,K=b[M++],O=b[M++],j=y/L;Z[x++]=K+q[0]*j,Z[x++]=O+q[1]*j,Z[x++]=K+q[2]*j,Z[x++]=O+q[3]*j,m[P]=U.atlasIndex}),S.quads=(S.quads||0)+(Dh()-E);const N=Dh();S.sdf={};const H=u.height,z=Math.ceil(l.glyphCount/s),_=Math.pow(2,Math.ceil(Math.log2(z*r)));_>H&&(console.info(`Increasing SDF texture size ${H}->${_}`),J$(u,a,_),c.dispose()),Promise.all(R.map(D=>bT(D,l,n.gpuAccelerateSDF).then(({timing:P})=>{S.sdf[D.atlasIndex]=P}))).then(()=>{R.length&&!l.contextLost&&(vT(l),c.needsUpdate=!0),S.sdfTotal=Dh()-N,S.total=Dh()-t,e(Object.freeze({parameters:n,sdfTexture:c,sdfGlyphSize:r,sdfExponent:o,glyphBounds:Z,glyphAtlasIndices:m,glyphColors:h.glyphColors,caretPositions:h.caretPositions,chunkedBounds:h.chunkedBounds,ascender:h.ascender,descender:h.descender,lineHeight:h.lineHeight,capHeight:h.capHeight,xHeight:h.xHeight,topBaseline:h.topBaseline,blockBounds:h.blockBounds,visibleBounds:h.visibleBounds,timings:h.timings}))})}),Promise.resolve().then(()=>{l.contextLost||P$(u)})}function bT({path:n,atlasIndex:e,sdfViewBox:t},{sdfGlyphSize:i,sdfCanvas:a,contextLost:o},r){if(o)return Promise.resolve({timing:-1});const{textureWidth:s,sdfExponent:l}=Qm,c=Math.max(t[2]-t[0],t[3]-t[1]),u=Math.floor(e/4),C=u%(s/i)*i,h=Math.floor(u/(s/i))*i,m=e%4;return L$(i,i,n,t,c,l,a,C,h,m,r)}function Q$(n){const e=n.sdfCanvas;e.addEventListener("webglcontextlost",t=>{console.log("Context Lost",t),t.preventDefault(),n.contextLost=!0}),e.addEventListener("webglcontextrestored",t=>{console.log("Context Restored",t),n.contextLost=!1;const i=[];n.glyphsByFont.forEach(a=>{a.forEach(o=>{i.push(bT(o,n,!0))})}),Promise.all(i).then(()=>{vT(n),n.sdfTexture.needsUpdate=!0})})}function q$({font:n,characters:e,sdfGlyphSize:t},i){let a=Array.isArray(e)?e.join(`
`):""+e;pT({font:n,sdfGlyphSize:t,text:a},i)}function $$(n,e){for(let t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n}let Pv;function eee(n){return Pv||(Pv=typeof document>"u"?{}:document.createElement("a")),Pv.href=n,Pv.href}function vT(n){if(typeof createImageBitmap!="function"){console.info("Safari<15: applying SDF canvas workaround");const{sdfCanvas:e,sdfTexture:t}=n,{width:i,height:a}=e,o=n.sdfCanvas.getContext("webgl");let r=t.image.data;(!r||r.length!==i*a*4)&&(r=new Uint8Array(i*a*4),t.image={width:i,height:a,data:r},t.flipY=!1,t.isDataTexture=!0),o.readPixels(0,0,i,a,o.RGBA,o.UNSIGNED_BYTE,r)}}const tee=jf({name:"Typesetter",dependencies:[K$,z$,w$],init(n,e,t){return n(e,t())}}),yT=jf({name:"Typesetter",dependencies:[tee],init(n){return function(e){return new Promise(t=>{n.typeset(e,t)})}},getTransferables(n){const e=[];for(let t in n)n[t]&&n[t].buffer&&e.push(n[t].buffer);return e}});yT.onMainThread;const WE={};function nee(n){let e=WE[n];return e||(e=WE[n]=new pc(1,1,n,n).translate(.5,.5,0)),e}const iee="aTroikaGlyphBounds",VE="aTroikaGlyphIndex",aee="aTroikaGlyphColor";class oee extends xx{constructor(){super(),this.detail=1,this.curveRadius=0,this.groups=[{start:0,count:1/0,materialIndex:0},{start:0,count:1/0,materialIndex:1}],this.boundingSphere=new Vo,this.boundingBox=new Wo}computeBoundingSphere(){}computeBoundingBox(){}set detail(e){if(e!==this._detail){this._detail=e,(typeof e!="number"||e<1)&&(e=1);let t=nee(e);["position","normal","uv"].forEach(i=>{this.attributes[i]=t.attributes[i].clone()}),this.setIndex(t.getIndex().clone())}}get detail(){return this._detail}set curveRadius(e){e!==this._curveRadius&&(this._curveRadius=e,this._updateBounds())}get curveRadius(){return this._curveRadius}updateGlyphs(e,t,i,a,o){this.updateAttributeData(iee,e,4),this.updateAttributeData(VE,t,1),this.updateAttributeData(aee,o,3),this._blockBounds=i,this._chunkedBounds=a,this.instanceCount=t.length,this._updateBounds()}_updateBounds(){const e=this._blockBounds;if(e){const{curveRadius:t,boundingBox:i}=this;if(t){const{PI:a,floor:o,min:r,max:s,sin:l,cos:c}=Math,u=a/2,C=a*2,h=Math.abs(t),m=e[0]/h,p=e[2]/h,B=o((m+u)/C)!==o((p+u)/C)?-h:r(l(m)*h,l(p)*h),b=o((m-u)/C)!==o((p-u)/C)?h:s(l(m)*h,l(p)*h),y=o((m+a)/C)!==o((p+a)/C)?h*2:s(h-c(m)*h,h-c(p)*h);i.min.set(B,e[1],t<0?-y:0),i.max.set(b,e[3],t<0?0:y)}else i.min.set(e[0],e[1],0),i.max.set(e[2],e[3],0);i.getBoundingSphere(this.boundingSphere)}}applyClipRect(e){let t=this.getAttribute(VE).count,i=this._chunkedBounds;if(i)for(let a=i.length;a--;){t=i[a].end;let o=i[a].rect;if(o[1]<e.w&&o[3]>e.y&&o[0]<e.z&&o[2]>e.x)break}this.instanceCount=t}updateAttributeData(e,t,i){const a=this.getAttribute(e);t?a&&a.array.length===t.length?(a.array.set(t),a.needsUpdate=!0):(this.setAttribute(e,new yd(t,i)),delete this._maxInstanceCount,this.dispose()):a&&this.deleteAttribute(e)}}const ree=`
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform vec4 uTroikaTotalBounds;
uniform vec4 uTroikaClipRect;
uniform mat3 uTroikaOrient;
uniform bool uTroikaUseGlyphColors;
uniform float uTroikaEdgeOffset;
uniform float uTroikaBlurRadius;
uniform vec2 uTroikaPositionOffset;
uniform float uTroikaCurveRadius;
attribute vec4 aTroikaGlyphBounds;
attribute float aTroikaGlyphIndex;
attribute vec3 aTroikaGlyphColor;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec3 vTroikaGlyphColor;
varying vec2 vTroikaGlyphDimensions;
`,see=`
vec4 bounds = aTroikaGlyphBounds;
bounds.xz += uTroikaPositionOffset.x;
bounds.yw -= uTroikaPositionOffset.y;

vec4 outlineBounds = vec4(
  bounds.xy - uTroikaEdgeOffset - uTroikaBlurRadius,
  bounds.zw + uTroikaEdgeOffset + uTroikaBlurRadius
);
vec4 clippedBounds = vec4(
  clamp(outlineBounds.xy, uTroikaClipRect.xy, uTroikaClipRect.zw),
  clamp(outlineBounds.zw, uTroikaClipRect.xy, uTroikaClipRect.zw)
);

vec2 clippedXY = (mix(clippedBounds.xy, clippedBounds.zw, position.xy) - bounds.xy) / (bounds.zw - bounds.xy);

position.xy = mix(bounds.xy, bounds.zw, clippedXY);

uv = (position.xy - uTroikaTotalBounds.xy) / (uTroikaTotalBounds.zw - uTroikaTotalBounds.xy);

float rad = uTroikaCurveRadius;
if (rad != 0.0) {
  float angle = position.x / rad;
  position.xz = vec2(sin(angle) * rad, rad - cos(angle) * rad);
  normal.xz = vec2(sin(angle), cos(angle));
}
  
position = uTroikaOrient * position;
normal = uTroikaOrient * normal;

vTroikaGlyphUV = clippedXY.xy;
vTroikaGlyphDimensions = vec2(bounds[2] - bounds[0], bounds[3] - bounds[1]);


float txCols = uTroikaSDFTextureSize.x / uTroikaSDFGlyphSize;
vec2 txUvPerSquare = uTroikaSDFGlyphSize / uTroikaSDFTextureSize;
vec2 txStartUV = txUvPerSquare * vec2(
  mod(floor(aTroikaGlyphIndex / 4.0), txCols),
  floor(floor(aTroikaGlyphIndex / 4.0) / txCols)
);
vTroikaTextureUVBounds = vec4(txStartUV, vec2(txStartUV) + txUvPerSquare);
vTroikaTextureChannel = mod(aTroikaGlyphIndex, 4.0);
`,lee=`
uniform sampler2D uTroikaSDFTexture;
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform float uTroikaSDFExponent;
uniform float uTroikaEdgeOffset;
uniform float uTroikaFillOpacity;
uniform float uTroikaBlurRadius;
uniform vec3 uTroikaStrokeColor;
uniform float uTroikaStrokeWidth;
uniform float uTroikaStrokeOpacity;
uniform bool uTroikaSDFDebug;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec2 vTroikaGlyphDimensions;

float troikaSdfValueToSignedDistance(float alpha) {
  // Inverse of exponential encoding in webgl-sdf-generator
  
  float maxDimension = max(vTroikaGlyphDimensions.x, vTroikaGlyphDimensions.y);
  float absDist = (1.0 - pow(2.0 * (alpha > 0.5 ? 1.0 - alpha : alpha), 1.0 / uTroikaSDFExponent)) * maxDimension;
  float signedDist = absDist * (alpha > 0.5 ? -1.0 : 1.0);
  return signedDist;
}

float troikaGlyphUvToSdfValue(vec2 glyphUV) {
  vec2 textureUV = mix(vTroikaTextureUVBounds.xy, vTroikaTextureUVBounds.zw, glyphUV);
  vec4 rgba = texture2D(uTroikaSDFTexture, textureUV);
  float ch = floor(vTroikaTextureChannel + 0.5); //NOTE: can't use round() in WebGL1
  return ch == 0.0 ? rgba.r : ch == 1.0 ? rgba.g : ch == 2.0 ? rgba.b : rgba.a;
}

float troikaGlyphUvToDistance(vec2 uv) {
  return troikaSdfValueToSignedDistance(troikaGlyphUvToSdfValue(uv));
}

float troikaGetAADist() {
  
  #if defined(GL_OES_standard_derivatives) || __VERSION__ >= 300
  return length(fwidth(vTroikaGlyphUV * vTroikaGlyphDimensions)) * 0.5;
  #else
  return vTroikaGlyphDimensions.x / 64.0;
  #endif
}

float troikaGetFragDistValue() {
  vec2 clampedGlyphUV = clamp(vTroikaGlyphUV, 0.5 / uTroikaSDFGlyphSize, 1.0 - 0.5 / uTroikaSDFGlyphSize);
  float distance = troikaGlyphUvToDistance(clampedGlyphUV);
 
  // Extrapolate distance when outside bounds:
  distance += clampedGlyphUV == vTroikaGlyphUV ? 0.0 : 
    length((vTroikaGlyphUV - clampedGlyphUV) * vTroikaGlyphDimensions);

  

  return distance;
}

float troikaGetEdgeAlpha(float distance, float distanceOffset, float aaDist) {
  #if defined(IS_DEPTH_MATERIAL) || defined(IS_DISTANCE_MATERIAL)
  float alpha = step(-distanceOffset, -distance);
  #else

  float alpha = smoothstep(
    distanceOffset + aaDist,
    distanceOffset - aaDist,
    distance
  );
  #endif

  return alpha;
}
`,cee=`
float aaDist = troikaGetAADist();
float fragDistance = troikaGetFragDistValue();
float edgeAlpha = uTroikaSDFDebug ?
  troikaGlyphUvToSdfValue(vTroikaGlyphUV) :
  troikaGetEdgeAlpha(fragDistance, uTroikaEdgeOffset, max(aaDist, uTroikaBlurRadius));

#if !defined(IS_DEPTH_MATERIAL) && !defined(IS_DISTANCE_MATERIAL)
vec4 fillRGBA = gl_FragColor;
fillRGBA.a *= uTroikaFillOpacity;
vec4 strokeRGBA = uTroikaStrokeWidth == 0.0 ? fillRGBA : vec4(uTroikaStrokeColor, uTroikaStrokeOpacity);
if (fillRGBA.a == 0.0) fillRGBA.rgb = strokeRGBA.rgb;
gl_FragColor = mix(fillRGBA, strokeRGBA, smoothstep(
  -uTroikaStrokeWidth - aaDist,
  -uTroikaStrokeWidth + aaDist,
  fragDistance
));
gl_FragColor.a *= edgeAlpha;
#endif

if (edgeAlpha == 0.0) {
  discard;
}
`;function gee(n){const e=hR(n,{chained:!0,extensions:{derivatives:!0},uniforms:{uTroikaSDFTexture:{value:null},uTroikaSDFTextureSize:{value:new Xt},uTroikaSDFGlyphSize:{value:0},uTroikaSDFExponent:{value:0},uTroikaTotalBounds:{value:new yi(0,0,0,0)},uTroikaClipRect:{value:new yi(0,0,0,0)},uTroikaEdgeOffset:{value:0},uTroikaFillOpacity:{value:1},uTroikaPositionOffset:{value:new Xt},uTroikaCurveRadius:{value:0},uTroikaBlurRadius:{value:0},uTroikaStrokeWidth:{value:0},uTroikaStrokeColor:{value:new dn},uTroikaStrokeOpacity:{value:1},uTroikaOrient:{value:new Jn},uTroikaUseGlyphColors:{value:!0},uTroikaSDFDebug:{value:!1}},vertexDefs:ree,vertexTransform:see,fragmentDefs:lee,fragmentColorTransform:cee,customRewriter({vertexShader:t,fragmentShader:i}){let a=/\buniform\s+vec3\s+diffuse\b/;return a.test(i)&&(i=i.replace(a,"varying vec3 vTroikaGlyphColor").replace(/\bdiffuse\b/g,"vTroikaGlyphColor"),a.test(t)||(t=t.replace(AT,`uniform vec3 diffuse;
$&
vTroikaGlyphColor = uTroikaUseGlyphColors ? aTroikaGlyphColor / 255.0 : diffuse;
`))),{vertexShader:t,fragmentShader:i}}});return e.transparent=!0,e.forceSinglePass=!0,Object.defineProperties(e,{isTroikaTextMaterial:{value:!0},shadowSide:{get(){return this.side},set(){}}}),e}const Px=new Or({color:16777215,side:ms,transparent:!0}),NE=8421504,EE=new Vn,Jv=new Be,Ww=new Be,Nm=[],uee=new Be,Vw="+x+y";function HE(n){return Array.isArray(n)?n[0]:n}let BT=()=>{const n=new $i(new pc(1,1),Px);return BT=()=>n,n},GT=()=>{const n=new $i(new pc(1,1,32,1),Px);return GT=()=>n,n};const dee={type:"syncstart"},Cee={type:"synccomplete"},ST=["font","fontSize","fontStyle","fontWeight","lang","letterSpacing","lineHeight","maxWidth","overflowWrap","text","direction","textAlign","textIndent","whiteSpace","anchorX","anchorY","colorRanges","sdfGlyphSize"],Iee=ST.concat("material","color","depthOffset","clipRect","curveRadius","orientation","glyphGeometryDetail");let wT=class extends $i{constructor(){const e=new oee;super(e,null),this.text="",this.anchorX=0,this.anchorY=0,this.curveRadius=0,this.direction="auto",this.font=null,this.unicodeFontsURL=null,this.fontSize=.1,this.fontWeight="normal",this.fontStyle="normal",this.lang=null,this.letterSpacing=0,this.lineHeight="normal",this.maxWidth=1/0,this.overflowWrap="normal",this.textAlign="left",this.textIndent=0,this.whiteSpace="normal",this.material=null,this.color=null,this.colorRanges=null,this.outlineWidth=0,this.outlineColor=0,this.outlineOpacity=1,this.outlineBlur=0,this.outlineOffsetX=0,this.outlineOffsetY=0,this.strokeWidth=0,this.strokeColor=NE,this.strokeOpacity=1,this.fillOpacity=1,this.depthOffset=0,this.clipRect=null,this.orientation=Vw,this.glyphGeometryDetail=1,this.sdfGlyphSize=null,this.gpuAccelerateSDF=!0,this.debugSDF=!1}sync(e){this._needsSync&&(this._needsSync=!1,this._isSyncing?(this._queuedSyncs||(this._queuedSyncs=[])).push(e):(this._isSyncing=!0,this.dispatchEvent(dee),pT({text:this.text,font:this.font,lang:this.lang,fontSize:this.fontSize||.1,fontWeight:this.fontWeight||"normal",fontStyle:this.fontStyle||"normal",letterSpacing:this.letterSpacing||0,lineHeight:this.lineHeight||"normal",maxWidth:this.maxWidth,direction:this.direction||"auto",textAlign:this.textAlign,textIndent:this.textIndent,whiteSpace:this.whiteSpace,overflowWrap:this.overflowWrap,anchorX:this.anchorX,anchorY:this.anchorY,colorRanges:this.colorRanges,includeCaretPositions:!0,sdfGlyphSize:this.sdfGlyphSize,gpuAccelerateSDF:this.gpuAccelerateSDF,unicodeFontsURL:this.unicodeFontsURL},t=>{this._isSyncing=!1,this._textRenderInfo=t,this.geometry.updateGlyphs(t.glyphBounds,t.glyphAtlasIndices,t.blockBounds,t.chunkedBounds,t.glyphColors);const i=this._queuedSyncs;i&&(this._queuedSyncs=null,this._needsSync=!0,this.sync(()=>{i.forEach(a=>a&&a())})),this.dispatchEvent(Cee),e&&e()})))}onBeforeRender(e,t,i,a,o,r){this.sync(),o.isTroikaTextMaterial&&this._prepareForRender(o)}dispose(){this.geometry.dispose()}get textRenderInfo(){return this._textRenderInfo||null}createDerivedMaterial(e){return gee(e)}get material(){let e=this._derivedMaterial;const t=this._baseMaterial||this._defaultMaterial||(this._defaultMaterial=Px.clone());if((!e||!e.isDerivedFrom(t))&&(e=this._derivedMaterial=this.createDerivedMaterial(t),t.addEventListener("dispose",function i(){t.removeEventListener("dispose",i),e.dispose()})),this.hasOutline()){let i=e._outlineMtl;return i||(i=e._outlineMtl=Object.create(e,{id:{value:e.id+.1}}),i.isTextOutlineMaterial=!0,i.depthWrite=!1,i.map=null,e.addEventListener("dispose",function a(){e.removeEventListener("dispose",a),i.dispose()})),[i,e]}else return e}set material(e){e&&e.isTroikaTextMaterial?(this._derivedMaterial=e,this._baseMaterial=e.baseMaterial):this._baseMaterial=e}hasOutline(){return!!(this.outlineWidth||this.outlineBlur||this.outlineOffsetX||this.outlineOffsetY)}get glyphGeometryDetail(){return this.geometry.detail}set glyphGeometryDetail(e){this.geometry.detail=e}get curveRadius(){return this.geometry.curveRadius}set curveRadius(e){this.geometry.curveRadius=e}get customDepthMaterial(){return HE(this.material).getDepthMaterial()}set customDepthMaterial(e){}get customDistanceMaterial(){return HE(this.material).getDistanceMaterial()}set customDistanceMaterial(e){}_prepareForRender(e){const t=e.isTextOutlineMaterial,i=e.uniforms,a=this.textRenderInfo;if(a){const{sdfTexture:s,blockBounds:l}=a;i.uTroikaSDFTexture.value=s,i.uTroikaSDFTextureSize.value.set(s.image.width,s.image.height),i.uTroikaSDFGlyphSize.value=a.sdfGlyphSize,i.uTroikaSDFExponent.value=a.sdfExponent,i.uTroikaTotalBounds.value.fromArray(l),i.uTroikaUseGlyphColors.value=!t&&!!a.glyphColors;let c=0,u=0,C=0,h,m,p,B=0,b=0;if(t){let{outlineWidth:S,outlineOffsetX:R,outlineOffsetY:Z,outlineBlur:x,outlineOpacity:M}=this;c=this._parsePercent(S)||0,u=Math.max(0,this._parsePercent(x)||0),h=M,B=this._parsePercent(R)||0,b=this._parsePercent(Z)||0}else C=Math.max(0,this._parsePercent(this.strokeWidth)||0),C&&(p=this.strokeColor,i.uTroikaStrokeColor.value.set(p??NE),m=this.strokeOpacity,m==null&&(m=1)),h=this.fillOpacity;i.uTroikaEdgeOffset.value=c,i.uTroikaPositionOffset.value.set(B,b),i.uTroikaBlurRadius.value=u,i.uTroikaStrokeWidth.value=C,i.uTroikaStrokeOpacity.value=m,i.uTroikaFillOpacity.value=h??1,i.uTroikaCurveRadius.value=this.curveRadius||0;let y=this.clipRect;if(y&&Array.isArray(y)&&y.length===4)i.uTroikaClipRect.value.fromArray(y);else{const S=(this.fontSize||.1)*100;i.uTroikaClipRect.value.set(l[0]-S,l[1]-S,l[2]+S,l[3]+S)}this.geometry.applyClipRect(i.uTroikaClipRect.value)}i.uTroikaSDFDebug.value=!!this.debugSDF,e.polygonOffset=!!this.depthOffset,e.polygonOffsetFactor=e.polygonOffsetUnits=this.depthOffset||0;const o=t?this.outlineColor||0:this.color;if(o==null)delete e.color;else{const s=e.hasOwnProperty("color")?e.color:e.color=new dn;(o!==s._input||typeof o=="object")&&s.set(s._input=o)}let r=this.orientation||Vw;if(r!==e._orientation){let s=i.uTroikaOrient.value;r=r.replace(/[^-+xyz]/g,"");let l=r!==Vw&&r.match(/^([-+])([xyz])([-+])([xyz])$/);if(l){let[,c,u,C,h]=l;Jv.set(0,0,0)[u]=c==="-"?1:-1,Ww.set(0,0,0)[h]=C==="-"?-1:1,EE.lookAt(uee,Jv.cross(Ww),Ww),s.setFromMatrix4(EE)}else s.identity();e._orientation=r}}_parsePercent(e){if(typeof e=="string"){let t=e.match(/^(-?[\d.]+)%$/),i=t?parseFloat(t[1]):NaN;e=(isNaN(i)?0:i/100)*this.fontSize}return e}localPositionToTextCoords(e,t=new Xt){t.copy(e);const i=this.curveRadius;return i&&(t.x=Math.atan2(e.x,Math.abs(i)-Math.abs(e.z))*Math.abs(i)),t}worldPositionToTextCoords(e,t=new Xt){return Jv.copy(e),this.localPositionToTextCoords(this.worldToLocal(Jv),t)}raycast(e,t){const{textRenderInfo:i,curveRadius:a}=this;if(i){const o=i.blockBounds,r=a?GT():BT(),s=r.geometry,{position:l,uv:c}=s.attributes;for(let u=0;u<c.count;u++){let C=o[0]+c.getX(u)*(o[2]-o[0]);const h=o[1]+c.getY(u)*(o[3]-o[1]);let m=0;a&&(m=a-Math.cos(C/a)*a,C=Math.sin(C/a)*a),l.setXYZ(u,C,h,m)}s.boundingSphere=this.geometry.boundingSphere,s.boundingBox=this.geometry.boundingBox,r.matrixWorld=this.matrixWorld,r.material.side=this.material.side,Nm.length=0,r.raycast(e,Nm);for(let u=0;u<Nm.length;u++)Nm[u].object=this,t.push(Nm[u])}}copy(e){const t=this.geometry;return super.copy(e),this.geometry=t,Iee.forEach(i=>{this[i]=e[i]}),this}clone(){return new this.constructor().copy(this)}};ST.forEach(n=>{const e="_private_"+n;Object.defineProperty(wT.prototype,n,{get(){return this[e]},set(t){t!==this[e]&&(this[e]=t,this._needsSync=!0)}})});new Wo;new dn;const hee=v.forwardRef(({sdfGlyphSize:n=64,anchorX:e="center",anchorY:t="middle",font:i,fontSize:a=1,children:o,characters:r,onSync:s,...l},c)=>{const u=Ra(({invalidate:p})=>p),[C]=v.useState(()=>new wT),[h,m]=v.useMemo(()=>{const p=[];let B="";return v.Children.forEach(o,b=>{typeof b=="string"||typeof b=="number"?B+=b:p.push(b)}),[p,B]},[o]);return TX(()=>new Promise(p=>q$({font:i,characters:r},p)),["troika-text",i,r]),v.useLayoutEffect(()=>void C.sync(()=>{u(),s&&s(C)})),v.useEffect(()=>()=>C.dispose(),[C]),v.createElement("primitive",$t({object:C,ref:c,font:i,text:m,anchorX:e,anchorY:t,fontSize:a,sdfGlyphSize:n},l),h)});let jv=null,RT="https://www.gstatic.com/draco/versioned/decoders/1.5.5/";function ZT(n=!0,e=!0,t){return i=>{t&&t(i),n&&(jv||(jv=new m$),jv.setDecoderPath(typeof n=="string"?n:RT),i.setDRACOLoader(jv)),e&&i.setMeshoptDecoder(typeof xw=="function"?xw():xw)}}const jG=(n,e,t,i)=>du(kx,n,ZT(e,t,i));jG.preload=(n,e,t,i)=>du.preload(kx,n,ZT(e,t,i));jG.clear=n=>du.clear(kx,n);jG.setDecoderPath=n=>{RT=n};function fee(n,e,t){const i=Ra(h=>h.size),a=Ra(h=>h.viewport),o=typeof n=="number"?n:i.width*a.dpr,r=i.height*a.dpr,s=(typeof n=="number"?t:n)||{},{samples:l=0,depth:c,...u}=s,C=v.useMemo(()=>{const h=new Us(o,r,{minFilter:Bi,magFilter:Bi,type:Co,...u});return c&&(h.depthTexture=new xG(o,r,ma)),h.samples=l,h},[]);return v.useLayoutEffect(()=>{C.setSize(o,r),l&&(C.samples=l)},[l,C,o,r]),v.useEffect(()=>()=>C.dispose(),[]),C}const Aee=n=>typeof n=="function",Jx=v.forwardRef(({envMap:n,resolution:e=256,frames:t=1/0,makeDefault:i,children:a,...o},r)=>{const s=Ra(({set:b})=>b),l=Ra(({camera:b})=>b),c=Ra(({size:b})=>b),u=v.useRef(null);v.useImperativeHandle(r,()=>u.current,[]);const C=v.useRef(null),h=fee(e);v.useLayoutEffect(()=>{o.manual||(u.current.aspect=c.width/c.height)},[c,o]),v.useLayoutEffect(()=>{u.current.updateProjectionMatrix()});let m=0,p=null;const B=Aee(a);return bg(b=>{B&&(t===1/0||m<t)&&(C.current.visible=!1,b.gl.setRenderTarget(h),p=b.scene.background,n&&(b.scene.background=n),b.gl.render(b.scene,u.current),b.scene.background=p,b.gl.setRenderTarget(null),C.current.visible=!0,m++)}),v.useLayoutEffect(()=>{if(i){const b=l;return s(()=>({camera:u.current})),()=>s(()=>({camera:b}))}},[u,i,s]),v.createElement(v.Fragment,null,v.createElement("perspectiveCamera",$t({ref:u},o),!B&&a),v.createElement("group",{ref:C},B&&a(h.texture)))}),jx=v.forwardRef(({makeDefault:n,camera:e,regress:t,domElement:i,enableDamping:a=!0,keyEvents:o=!1,onChange:r,onStart:s,onEnd:l,...c},u)=>{const C=Ra(M=>M.invalidate),h=Ra(M=>M.camera),m=Ra(M=>M.gl),p=Ra(M=>M.events),B=Ra(M=>M.setEvents),b=Ra(M=>M.set),y=Ra(M=>M.get),S=Ra(M=>M.performance),R=e||h,Z=i||p.connected||m.domElement,x=v.useMemo(()=>new Eq(R),[R]);return bg(()=>{x.enabled&&x.update()},-1),v.useEffect(()=>(o&&x.connect(o===!0?Z:o),x.connect(Z),()=>void x.dispose()),[o,Z,t,x,C]),v.useEffect(()=>{const M=N=>{C(),t&&S.regress(),r&&r(N)},E=N=>{s&&s(N)},F=N=>{l&&l(N)};return x.addEventListener("change",M),x.addEventListener("start",E),x.addEventListener("end",F),()=>{x.removeEventListener("start",E),x.removeEventListener("end",F),x.removeEventListener("change",M)}},[r,s,l,x,C,B]),v.useEffect(()=>{if(n){const M=y().controls;return b({controls:x}),()=>b({controls:M})}},[n,x]),v.createElement("primitive",$t({ref:u,object:x,enableDamping:a},c))});function mee(n,e,...t){const i=v.useRef(null),a=Ra(o=>o.scene);return v.useLayoutEffect(()=>{n&&n!=null&&n.current},[a,e,n,...t]),bg(()=>{var o;return void((o=i.current)==null||o.update==null?void 0:o.update())}),i}var xy={exports:{}},pee=xy.exports,FE;function bee(){return FE||(FE=1,function(n,e){(function(t,i){n.exports=i()})(pee,function(){var t=function(){function i(m){return r.appendChild(m.dom),m}function a(m){for(var p=0;p<r.children.length;p++)r.children[p].style.display=p===m?"block":"none";o=m}var o=0,r=document.createElement("div");r.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",r.addEventListener("click",function(m){m.preventDefault(),a(++o%r.children.length)},!1);var s=(performance||Date).now(),l=s,c=0,u=i(new t.Panel("FPS","#0ff","#002")),C=i(new t.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var h=i(new t.Panel("MB","#f08","#201"));return a(0),{REVISION:16,dom:r,addPanel:i,showPanel:a,begin:function(){s=(performance||Date).now()},end:function(){c++;var m=(performance||Date).now();if(C.update(m-s,200),m>l+1e3&&(u.update(1e3*c/(m-l),100),l=m,c=0,h)){var p=performance.memory;h.update(p.usedJSHeapSize/1048576,p.jsHeapSizeLimit/1048576)}return m},update:function(){s=this.end()},domElement:r,setMode:a}};return t.Panel=function(i,a,o){var r=1/0,s=0,l=Math.round,c=l(window.devicePixelRatio||1),u=80*c,C=48*c,h=3*c,m=2*c,p=3*c,B=15*c,b=74*c,y=30*c,S=document.createElement("canvas");S.width=u,S.height=C,S.style.cssText="width:80px;height:48px";var R=S.getContext("2d");return R.font="bold "+9*c+"px Helvetica,Arial,sans-serif",R.textBaseline="top",R.fillStyle=o,R.fillRect(0,0,u,C),R.fillStyle=a,R.fillText(i,h,m),R.fillRect(p,B,b,y),R.fillStyle=o,R.globalAlpha=.9,R.fillRect(p,B,b,y),{dom:S,update:function(Z,x){r=Math.min(r,Z),s=Math.max(s,Z),R.fillStyle=o,R.globalAlpha=1,R.fillRect(0,0,u,B),R.fillStyle=a,R.fillText(l(Z)+" "+i+" ("+l(r)+"-"+l(s)+")",h,m),R.drawImage(S,p+c,B,b-c,y,p,B,b-c,y),R.fillRect(p+b-c,B,c,y),R.fillStyle=o,R.globalAlpha=.9,R.fillRect(p+b-c,B,c,l((1-Z/x)*y))}}},t})}(xy)),xy.exports}var vee=bee();const yee=mI(vee);function Bee(n,e=[],t){const[i,a]=v.useState();return v.useLayoutEffect(()=>{const o=n();return a(o),()=>void 0},e),i}function Gee({showPanel:n=0,className:e,parent:t}){const i=Bee(()=>new yee,[]);return v.useEffect(()=>{if(i){const a=t&&t.current||document.body;i.showPanel(n),a==null||a.appendChild(i.dom);const o=(e??"").split(" ").filter(l=>l);o.length&&i.dom.classList.add(...o);const r=D6(()=>i.begin()),s=O6(()=>i.end());return()=>{o.length&&i.dom.classList.remove(...o),a==null||a.removeChild(i.dom),r(),s()}}},[t,i,e,n]),null}function See(n,e){const t=n+"Geometry";return v.forwardRef(({args:i,children:a,...o},r)=>{const s=v.useRef(null);return v.useImperativeHandle(r,()=>s.current),v.useLayoutEffect(()=>void(e==null?void 0:e(s.current))),v.createElement("mesh",$t({ref:s},o),v.createElement(t,{attach:"geometry",args:i}),a)})}const wee=See("box"),xT=(n,e,t)=>{let i;switch(n){case vs:i=new Uint8ClampedArray(e*t*4);break;case Co:i=new Uint16Array(e*t*4);break;case Ig:i=new Uint32Array(e*t*4);break;case CG:i=new Int8Array(e*t*4);break;case IG:i=new Int16Array(e*t*4);break;case nb:i=new Int32Array(e*t*4);break;case ma:i=new Float32Array(e*t*4);break;default:throw new Error("Unsupported data type")}return i};let Qv;const Ree=(n,e,t,i)=>{if(Qv!==void 0)return Qv;const a=new Us(1,1,i);e.setRenderTarget(a);const o=new $i(new pc,new Or({color:16777215}));e.render(o,t),e.setRenderTarget(null);const r=xT(n,a.width,a.height);return e.readRenderTargetPixels(a,0,0,a.width,a.height,r),a.dispose(),o.geometry.dispose(),o.material.dispose(),Qv=r[0]!==0,Qv};class Qx{constructor(e){var t,i,a,o,r,s,l,c,u,C,h,m,p,B,b,y;this._rendererIsDisposable=!1,this._supportsReadPixels=!0,this.render=()=>{this._renderer.setRenderTarget(this._renderTarget);try{this._renderer.render(this._scene,this._camera)}catch(R){throw this._renderer.setRenderTarget(null),R}this._renderer.setRenderTarget(null)},this._width=e.width,this._height=e.height,this._type=e.type,this._colorSpace=e.colorSpace;const S={format:La,depthBuffer:!1,stencilBuffer:!1,type:this._type,colorSpace:this._colorSpace,anisotropy:((t=e.renderTargetOptions)===null||t===void 0?void 0:t.anisotropy)!==void 0?(i=e.renderTargetOptions)===null||i===void 0?void 0:i.anisotropy:1,generateMipmaps:((a=e.renderTargetOptions)===null||a===void 0?void 0:a.generateMipmaps)!==void 0?(o=e.renderTargetOptions)===null||o===void 0?void 0:o.generateMipmaps:!1,magFilter:((r=e.renderTargetOptions)===null||r===void 0?void 0:r.magFilter)!==void 0?(s=e.renderTargetOptions)===null||s===void 0?void 0:s.magFilter:Bi,minFilter:((l=e.renderTargetOptions)===null||l===void 0?void 0:l.minFilter)!==void 0?(c=e.renderTargetOptions)===null||c===void 0?void 0:c.minFilter:Bi,samples:((u=e.renderTargetOptions)===null||u===void 0?void 0:u.samples)!==void 0?(C=e.renderTargetOptions)===null||C===void 0?void 0:C.samples:void 0,wrapS:((h=e.renderTargetOptions)===null||h===void 0?void 0:h.wrapS)!==void 0?(m=e.renderTargetOptions)===null||m===void 0?void 0:m.wrapS:Ka,wrapT:((p=e.renderTargetOptions)===null||p===void 0?void 0:p.wrapT)!==void 0?(B=e.renderTargetOptions)===null||B===void 0?void 0:B.wrapT:Ka};if(this._material=e.material,e.renderer?this._renderer=e.renderer:(this._renderer=Qx.instantiateRenderer(),this._rendererIsDisposable=!0),this._scene=new sb,this._camera=new bl,this._camera.position.set(0,0,10),this._camera.left=-.5,this._camera.right=.5,this._camera.top=.5,this._camera.bottom=-.5,this._camera.updateProjectionMatrix(),!Ree(this._type,this._renderer,this._camera,S)){let R;switch(this._type){case Co:R=this._renderer.extensions.has("EXT_color_buffer_float")?ma:void 0;break}R!==void 0?(console.warn(`This browser does not support reading pixels from ${this._type} RenderTargets, switching to ${ma}`),this._type=R):(this._supportsReadPixels=!1,console.warn("This browser dos not support toArray or toDataTexture, calls to those methods will result in an error thrown"))}this._quad=new $i(new pc,this._material),this._quad.geometry.computeBoundingBox(),this._scene.add(this._quad),this._renderTarget=new Us(this.width,this.height,S),this._renderTarget.texture.mapping=((b=e.renderTargetOptions)===null||b===void 0?void 0:b.mapping)!==void 0?(y=e.renderTargetOptions)===null||y===void 0?void 0:y.mapping:pd}static instantiateRenderer(){const e=new Tx;return e.setSize(128,128),e}toArray(){if(!this._supportsReadPixels)throw new Error("Can't read pixels in this browser");const e=xT(this._type,this._width,this._height);return this._renderer.readRenderTargetPixels(this._renderTarget,0,0,this._width,this._height,e),e}toDataTexture(e){const t=new gc(this.toArray(),this.width,this.height,La,this._type,(e==null?void 0:e.mapping)||pd,(e==null?void 0:e.wrapS)||Ka,(e==null?void 0:e.wrapT)||Ka,(e==null?void 0:e.magFilter)||Bi,(e==null?void 0:e.minFilter)||Bi,(e==null?void 0:e.anisotropy)||1,Cc);return t.generateMipmaps=(e==null?void 0:e.generateMipmaps)!==void 0?e==null?void 0:e.generateMipmaps:!1,t}disposeOnDemandRenderer(){this._renderer.setRenderTarget(null),this._rendererIsDisposable&&(this._renderer.dispose(),this._renderer.forceContextLoss())}dispose(e){this.disposeOnDemandRenderer(),e&&this.renderTarget.dispose(),this.material instanceof Ur&&Object.values(this.material.uniforms).forEach(t=>{t.value instanceof Fi&&t.value.dispose()}),Object.values(this.material).forEach(t=>{t instanceof Fi&&t.dispose()}),this.material.dispose(),this._quad.geometry.dispose()}get width(){return this._width}set width(e){this._width=e,this._renderTarget.setSize(this._width,this._height)}get height(){return this._height}set height(e){this._height=e,this._renderTarget.setSize(this._width,this._height)}get renderer(){return this._renderer}get renderTarget(){return this._renderTarget}set renderTarget(e){this._renderTarget=e,this._width=e.width,this._height=e.height}get material(){return this._material}get type(){return this._type}get colorSpace(){return this._colorSpace}}const Zee=`
varying vec2 vUv;

void main() {
  vUv = uv;
  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
}
`,xee=`
// min half float value
#define HALF_FLOAT_MIN vec3( -65504, -65504, -65504 )
// max half float value
#define HALF_FLOAT_MAX vec3( 65504, 65504, 65504 )

uniform sampler2D sdr;
uniform sampler2D gainMap;
uniform vec3 gamma;
uniform vec3 offsetHdr;
uniform vec3 offsetSdr;
uniform vec3 gainMapMin;
uniform vec3 gainMapMax;
uniform float weightFactor;

varying vec2 vUv;

void main() {
  vec3 rgb = texture2D( sdr, vUv ).rgb;
  vec3 recovery = texture2D( gainMap, vUv ).rgb;
  vec3 logRecovery = pow( recovery, gamma );
  vec3 logBoost = gainMapMin * ( 1.0 - logRecovery ) + gainMapMax * logRecovery;
  vec3 hdrColor = (rgb + offsetSdr) * exp2( logBoost * weightFactor ) - offsetHdr;
  vec3 clampedHdrColor = max( HALF_FLOAT_MIN, min( HALF_FLOAT_MAX, hdrColor ));
  gl_FragColor = vec4( clampedHdrColor , 1.0 );
}
`;class Mee extends Ur{constructor({gamma:e,offsetHdr:t,offsetSdr:i,gainMapMin:a,gainMapMax:o,maxDisplayBoost:r,hdrCapacityMin:s,hdrCapacityMax:l,sdr:c,gainMap:u}){super({name:"GainMapDecoderMaterial",vertexShader:Zee,fragmentShader:xee,uniforms:{sdr:{value:c},gainMap:{value:u},gamma:{value:new Be(1/e[0],1/e[1],1/e[2])},offsetHdr:{value:new Be().fromArray(t)},offsetSdr:{value:new Be().fromArray(i)},gainMapMin:{value:new Be().fromArray(a)},gainMapMax:{value:new Be().fromArray(o)},weightFactor:{value:(Math.log2(r)-s)/(l-s)}},blending:sg,depthTest:!1,depthWrite:!1}),this._maxDisplayBoost=r,this._hdrCapacityMin=s,this._hdrCapacityMax=l,this.needsUpdate=!0,this.uniformsNeedUpdate=!0}get sdr(){return this.uniforms.sdr.value}set sdr(e){this.uniforms.sdr.value=e}get gainMap(){return this.uniforms.gainMap.value}set gainMap(e){this.uniforms.gainMap.value=e}get offsetHdr(){return this.uniforms.offsetHdr.value.toArray()}set offsetHdr(e){this.uniforms.offsetHdr.value.fromArray(e)}get offsetSdr(){return this.uniforms.offsetSdr.value.toArray()}set offsetSdr(e){this.uniforms.offsetSdr.value.fromArray(e)}get gainMapMin(){return this.uniforms.gainMapMin.value.toArray()}set gainMapMin(e){this.uniforms.gainMapMin.value.fromArray(e)}get gainMapMax(){return this.uniforms.gainMapMax.value.toArray()}set gainMapMax(e){this.uniforms.gainMapMax.value.fromArray(e)}get gamma(){const e=this.uniforms.gamma.value;return[1/e.x,1/e.y,1/e.z]}set gamma(e){const t=this.uniforms.gamma.value;t.x=1/e[0],t.y=1/e[1],t.z=1/e[2]}get hdrCapacityMin(){return this._hdrCapacityMin}set hdrCapacityMin(e){this._hdrCapacityMin=e,this.calculateWeight()}get hdrCapacityMax(){return this._hdrCapacityMax}set hdrCapacityMax(e){this._hdrCapacityMax=e,this.calculateWeight()}get maxDisplayBoost(){return this._maxDisplayBoost}set maxDisplayBoost(e){this._maxDisplayBoost=Math.max(1,Math.min(65504,e)),this.calculateWeight()}calculateWeight(){const e=(Math.log2(this._maxDisplayBoost)-this._hdrCapacityMin)/(this._hdrCapacityMax-this._hdrCapacityMin);this.uniforms.weightFactor.value=Math.max(0,Math.min(1,e))}}class MT extends Error{}class WT extends Error{}const Em=(n,e,t)=>{const i=new RegExp(`${e}="([^"]*)"`,"i").exec(n);if(i)return i[1];const a=new RegExp(`<${e}[^>]*>([\\s\\S]*?)</${e}>`,"i").exec(n);if(a){const o=a[1].match(/<rdf:li>([^<]*)<\/rdf:li>/g);return o&&o.length===3?o.map(r=>r.replace(/<\/?rdf:li>/g,"")):a[1].trim()}if(t!==void 0)return t;throw new Error(`Can't find ${e} in gainmap metadata`)},Wee=n=>{let e;typeof TextDecoder<"u"?e=new TextDecoder().decode(n):e=n.toString();let t=e.indexOf("<x:xmpmeta");for(;t!==-1;){const i=e.indexOf("x:xmpmeta>",t),a=e.slice(t,i+10);try{const o=Em(a,"hdrgm:GainMapMin","0"),r=Em(a,"hdrgm:GainMapMax"),s=Em(a,"hdrgm:Gamma","1"),l=Em(a,"hdrgm:OffsetSDR","0.015625"),c=Em(a,"hdrgm:OffsetHDR","0.015625"),u=/hdrgm:HDRCapacityMin="([^"]*)"/.exec(a),C=u?u[1]:"0",h=/hdrgm:HDRCapacityMax="([^"]*)"/.exec(a);if(!h)throw new Error("Incomplete gainmap metadata");const m=h[1];return{gainMapMin:Array.isArray(o)?o.map(p=>parseFloat(p)):[parseFloat(o),parseFloat(o),parseFloat(o)],gainMapMax:Array.isArray(r)?r.map(p=>parseFloat(p)):[parseFloat(r),parseFloat(r),parseFloat(r)],gamma:Array.isArray(s)?s.map(p=>parseFloat(p)):[parseFloat(s),parseFloat(s),parseFloat(s)],offsetSdr:Array.isArray(l)?l.map(p=>parseFloat(p)):[parseFloat(l),parseFloat(l),parseFloat(l)],offsetHdr:Array.isArray(c)?c.map(p=>parseFloat(p)):[parseFloat(c),parseFloat(c),parseFloat(c)],hdrCapacityMin:parseFloat(C),hdrCapacityMax:parseFloat(m)}}catch{}t=e.indexOf("<x:xmpmeta",i)}};class Vee{constructor(e){this.options={debug:e&&e.debug!==void 0?e.debug:!1,extractFII:e&&e.extractFII!==void 0?e.extractFII:!0,extractNonFII:e&&e.extractNonFII!==void 0?e.extractNonFII:!0}}extract(e){return new Promise((t,i)=>{const a=this.options.debug,o=new DataView(e.buffer);if(o.getUint16(0)!==65496){i(new Error("Not a valid jpeg"));return}const r=o.byteLength;let s=2,l=0,c;for(;s<r;){if(++l>250){i(new Error(`Found no marker after ${l} loops `));return}if(o.getUint8(s)!==255){i(new Error(`Not a valid marker at offset 0x${s.toString(16)}, found: 0x${o.getUint8(s).toString(16)}`));return}if(c=o.getUint8(s+1),a&&console.log(`Marker: ${c.toString(16)}`),c===226){a&&console.log("Found APP2 marker (0xffe2)");const u=s+4;if(o.getUint32(u)===1297106432){const C=u+4;let h;if(o.getUint16(C)===18761)h=!1;else if(o.getUint16(C)===19789)h=!0;else{i(new Error("No valid endianness marker found in TIFF header"));return}if(o.getUint16(C+2,!h)!==42){i(new Error("Not valid TIFF data! (no 0x002A marker)"));return}const m=o.getUint32(C+4,!h);if(m<8){i(new Error("Not valid TIFF data! (First offset less than 8)"));return}const p=C+m,B=o.getUint16(p,!h),b=p+2;let y=0;for(let x=b;x<b+12*B;x+=12)o.getUint16(x,!h)===45057&&(y=o.getUint32(x+8,!h));const R=p+2+B*12+4,Z=[];for(let x=R;x<R+y*16;x+=16){const M={MPType:o.getUint32(x,!h),size:o.getUint32(x+4,!h),dataOffset:o.getUint32(x+8,!h),dependantImages:o.getUint32(x+12,!h),start:-1,end:-1,isFII:!1};M.dataOffset?(M.start=C+M.dataOffset,M.isFII=!1):(M.start=0,M.isFII=!0),M.end=M.start+M.size,Z.push(M)}if(this.options.extractNonFII&&Z.length){const x=new Blob([o]),M=[];for(const E of Z){if(E.isFII&&!this.options.extractFII)continue;const F=x.slice(E.start,E.end+1,"image/jpeg");M.push(F)}t(M)}}}s+=2+o.getUint16(s+2)}})}}const Nee=async n=>{const e=Wee(n);if(!e)throw new WT("Gain map XMP metadata not found");const i=await new Vee({extractFII:!0,extractNonFII:!0}).extract(n);if(i.length!==2)throw new MT("Gain map recovery image not found");return{sdr:new Uint8Array(await i[0].arrayBuffer()),gainMap:new Uint8Array(await i[1].arrayBuffer()),metadata:e}},XE=n=>new Promise((e,t)=>{const i=document.createElement("img");i.onload=()=>{e(i)},i.onerror=a=>{t(a)},i.src=URL.createObjectURL(n)});class VT extends Jo{constructor(e,t){super(t),e&&(this._renderer=e),this._internalLoadingManager=new DG}setRenderer(e){return this._renderer=e,this}setRenderTargetOptions(e){return this._renderTargetOptions=e,this}prepareQuadRenderer(){this._renderer||console.warn("WARNING: An existing WebGL Renderer was not passed to this Loader constructor or in setRenderer, the result of this Loader will need to be converted to a Data Texture with toDataTexture() before you can use it in your renderer.");const e=new Mee({gainMapMax:[1,1,1],gainMapMin:[0,0,0],gamma:[1,1,1],offsetHdr:[1,1,1],offsetSdr:[1,1,1],hdrCapacityMax:1,hdrCapacityMin:0,maxDisplayBoost:1,gainMap:new Fi,sdr:new Fi});return new Qx({width:16,height:16,type:Co,colorSpace:Cc,material:e,renderer:this._renderer,renderTargetOptions:this._renderTargetOptions})}async render(e,t,i,a){const o=a?new Blob([a],{type:"image/jpeg"}):void 0,r=new Blob([i],{type:"image/jpeg"});let s,l,c=!1;if(typeof createImageBitmap>"u"){const h=await Promise.all([o?XE(o):Promise.resolve(void 0),XE(r)]);l=h[0],s=h[1],c=!0}else{const h=await Promise.all([o?createImageBitmap(o,{imageOrientation:"flipY"}):Promise.resolve(void 0),createImageBitmap(r,{imageOrientation:"flipY"})]);l=h[0],s=h[1]}const u=new Fi(l||new ImageData(2,2),pd,Ka,Ka,Bi,O1,La,vs,1,Cc);u.flipY=c,u.needsUpdate=!0;const C=new Fi(s,pd,Ka,Ka,Bi,O1,La,vs,1,Uo);C.flipY=c,C.needsUpdate=!0,e.width=s.width,e.height=s.height,e.material.gainMap=u,e.material.sdr=C,e.material.gainMapMin=t.gainMapMin,e.material.gainMapMax=t.gainMapMax,e.material.offsetHdr=t.offsetHdr,e.material.offsetSdr=t.offsetSdr,e.material.gamma=t.gamma,e.material.hdrCapacityMin=t.hdrCapacityMin,e.material.hdrCapacityMax=t.hdrCapacityMax,e.material.maxDisplayBoost=Math.pow(2,t.hdrCapacityMax),e.material.needsUpdate=!0,e.render()}}class Eee extends VT{load([e,t,i],a,o,r){const s=this.prepareQuadRenderer();let l,c,u;const C=async()=>{if(l&&c&&u){try{await this.render(s,u,l,c)}catch(N){this.manager.itemError(e),this.manager.itemError(t),this.manager.itemError(i),typeof r=="function"&&r(N),s.disposeOnDemandRenderer();return}typeof a=="function"&&a(s),this.manager.itemEnd(e),this.manager.itemEnd(t),this.manager.itemEnd(i),s.disposeOnDemandRenderer()}};let h=!0,m=0,p=0,B=!0,b=0,y=0,S=!0,R=0,Z=0;const x=()=>{if(typeof o=="function"){const N=m+b+R,H=p+y+Z,z=h&&B&&S;o(new ProgressEvent("progress",{lengthComputable:z,loaded:H,total:N}))}};this.manager.itemStart(e),this.manager.itemStart(t),this.manager.itemStart(i);const M=new ko(this._internalLoadingManager);M.setResponseType("arraybuffer"),M.setRequestHeader(this.requestHeader),M.setPath(this.path),M.setWithCredentials(this.withCredentials),M.load(e,async N=>{if(typeof N=="string")throw new Error("Invalid sdr buffer");l=N,await C()},N=>{h=N.lengthComputable,p=N.loaded,m=N.total,x()},N=>{this.manager.itemError(e),typeof r=="function"&&r(N)});const E=new ko(this._internalLoadingManager);E.setResponseType("arraybuffer"),E.setRequestHeader(this.requestHeader),E.setPath(this.path),E.setWithCredentials(this.withCredentials),E.load(t,async N=>{if(typeof N=="string")throw new Error("Invalid gainmap buffer");c=N,await C()},N=>{B=N.lengthComputable,y=N.loaded,b=N.total,x()},N=>{this.manager.itemError(t),typeof r=="function"&&r(N)});const F=new ko(this._internalLoadingManager);return F.setRequestHeader(this.requestHeader),F.setPath(this.path),F.setWithCredentials(this.withCredentials),F.load(i,async N=>{if(typeof N!="string")throw new Error("Invalid metadata string");u=JSON.parse(N),await C()},N=>{S=N.lengthComputable,Z=N.loaded,R=N.total,x()},N=>{this.manager.itemError(i),typeof r=="function"&&r(N)}),s}}class Hee extends VT{load(e,t,i,a){const o=this.prepareQuadRenderer(),r=new ko(this._internalLoadingManager);return r.setResponseType("arraybuffer"),r.setRequestHeader(this.requestHeader),r.setPath(this.path),r.setWithCredentials(this.withCredentials),this.manager.itemStart(e),r.load(e,async s=>{if(typeof s=="string")throw new Error("Invalid buffer, received [string], was expecting [ArrayBuffer]");const l=new Uint8Array(s);let c,u,C;try{const h=await Nee(l);c=h.sdr,u=h.gainMap,C=h.metadata}catch(h){if(h instanceof WT||h instanceof MT)console.warn(`Failure to reconstruct an HDR image from ${e}: Gain map metadata not found in the file, HDRJPGLoader will render the SDR jpeg`),C={gainMapMin:[0,0,0],gainMapMax:[1,1,1],gamma:[1,1,1],hdrCapacityMin:0,hdrCapacityMax:1,offsetHdr:[0,0,0],offsetSdr:[0,0,0]},c=l;else throw h}try{await this.render(o,C,c,u)}catch(h){this.manager.itemError(e),typeof a=="function"&&a(h),o.disposeOnDemandRenderer();return}typeof t=="function"&&t(o),this.manager.itemEnd(e),o.disposeOnDemandRenderer()},i,s=>{this.manager.itemError(e),typeof a=="function"&&a(s)}),o}}const Hp={apartment:"lebombo_1k.hdr",city:"potsdamer_platz_1k.hdr",dawn:"kiara_1_dawn_1k.hdr",forest:"forest_slope_1k.hdr",lobby:"st_fagans_interior_1k.hdr",night:"dikhololo_night_1k.hdr",park:"rooitou_park_1k.hdr",studio:"studio_small_03_1k.hdr",sunset:"venice_sunset_1k.hdr",warehouse:"empty_warehouse_01_1k.hdr"},NT="https://raw.githack.com/pmndrs/drei-assets/456060a26bbeb8fdf79326f224b6d99b8bcce736/hdri/",df=n=>Array.isArray(n),qx=["/px.png","/nx.png","/py.png","/ny.png","/pz.png","/nz.png"];function QG({files:n=qx,path:e="",preset:t=void 0,colorSpace:i=void 0,extensions:a}={}){t&&($x(t),n=Hp[t],e=NT);const o=df(n),{extension:r,isCubemap:s}=eM(n),l=tM(r);if(!l)throw new Error("useEnvironment: Unrecognized file extension: "+n);const c=Ra(m=>m.gl);v.useLayoutEffect(()=>{if(r!=="webp"&&r!=="jpg"&&r!=="jpeg")return;function m(){du.clear(l,o?[n]:n)}c.domElement.addEventListener("webglcontextlost",m,{once:!0})},[n,c.domElement]);const u=du(l,o?[n]:n,m=>{(r==="webp"||r==="jpg"||r==="jpeg")&&m.setRenderer(c),m.setPath==null||m.setPath(e),a&&a(m)});let C=o?u[0]:u;if(r==="jpg"||r==="jpeg"||r==="webp"){var h;C=(h=C.renderTarget)==null?void 0:h.texture}return C.mapping=s?Cg:Af,C.colorSpace=i??(s?"srgb":"srgb-linear"),C}const Fee={files:qx,path:"",preset:void 0,extensions:void 0};QG.preload=n=>{const e={...Fee,...n};let{files:t,path:i=""}=e;const{preset:a,extensions:o}=e;a&&($x(a),t=Hp[a],i=NT);const{extension:r}=eM(t);if(r==="webp"||r==="jpg"||r==="jpeg")throw new Error("useEnvironment: Preloading gainmaps is not supported");const s=tM(r);if(!s)throw new Error("useEnvironment: Unrecognized file extension: "+t);du.preload(s,df(t)?[t]:t,l=>{l.setPath==null||l.setPath(i),o&&o(l)})};const Xee={files:qx,preset:void 0};QG.clear=n=>{const e={...Xee,...n};let{files:t}=e;const{preset:i}=e;i&&($x(i),t=Hp[i]);const{extension:a}=eM(t),o=tM(a);if(!o)throw new Error("useEnvironment: Unrecognized file extension: "+t);du.clear(o,df(t)?[t]:t)};function $x(n){if(!(n in Hp))throw new Error("Preset must be one of: "+Object.keys(Hp).join(", "))}function eM(n){var e;const t=df(n)&&n.length===6,i=df(n)&&n.length===3&&n.some(r=>r.endsWith("json")),a=df(n)?n[0]:n;return{extension:t?"cube":i?"webp":a.startsWith("data:application/exr")?"exr":a.startsWith("data:application/hdr")?"hdr":a.startsWith("data:image/jpeg")?"jpg":(e=a.split(".").pop())==null||(e=e.split("?"))==null||(e=e.shift())==null?void 0:e.toLowerCase(),isCubemap:t,isGainmap:i}}function tM(n){return n==="cube"?hX:n==="hdr"?f$:n==="exr"?A$:n==="jpg"||n==="jpeg"?Hee:n==="webp"?Eee:null}const Tee=n=>n.current&&n.current.isScene,Yee=n=>Tee(n)?n.current:n;function nM(n,e,t,i,a={}){var o,r,s,l;a={backgroundBlurriness:0,backgroundIntensity:1,backgroundRotation:[0,0,0],environmentIntensity:1,environmentRotation:[0,0,0],...a};const c=Yee(e||t),u=c.background,C=c.environment,h={backgroundBlurriness:c.backgroundBlurriness,backgroundIntensity:c.backgroundIntensity,backgroundRotation:(o=(r=c.backgroundRotation)==null||r.clone==null?void 0:r.clone())!==null&&o!==void 0?o:[0,0,0],environmentIntensity:c.environmentIntensity,environmentRotation:(s=(l=c.environmentRotation)==null||l.clone==null?void 0:l.clone())!==null&&s!==void 0?s:[0,0,0]};return n!=="only"&&(c.environment=i),n&&(c.background=i),og(c,a),()=>{n!=="only"&&(c.environment=C),n&&(c.background=u),og(c,h)}}function iM({scene:n,background:e=!1,map:t,...i}){const a=Ra(o=>o.scene);return v.useLayoutEffect(()=>{if(t)return nM(e,n,a,t,i)}),null}function ET({background:n=!1,scene:e,blur:t,backgroundBlurriness:i,backgroundIntensity:a,backgroundRotation:o,environmentIntensity:r,environmentRotation:s,...l}){const c=QG(l),u=Ra(C=>C.scene);return v.useLayoutEffect(()=>nM(n,e,u,c,{backgroundBlurriness:t??i,backgroundIntensity:a,backgroundRotation:o,environmentIntensity:r,environmentRotation:s})),v.useEffect(()=>()=>{c.dispose()},[c]),null}function zee({children:n,near:e=.1,far:t=1e3,resolution:i=256,frames:a=1,map:o,background:r=!1,blur:s,backgroundBlurriness:l,backgroundIntensity:c,backgroundRotation:u,environmentIntensity:C,environmentRotation:h,scene:m,files:p,path:B,preset:b=void 0,extensions:y}){const S=Ra(F=>F.gl),R=Ra(F=>F.scene),Z=v.useRef(null),[x]=v.useState(()=>new sb),M=v.useMemo(()=>{const F=new cx(i);return F.texture.type=Co,F},[i]);v.useEffect(()=>()=>{M.dispose()},[M]),v.useLayoutEffect(()=>{if(a===1){const F=S.autoClear;S.autoClear=!0,Z.current.update(S,x),S.autoClear=F}return nM(r,m,R,M.texture,{backgroundBlurriness:s??l,backgroundIntensity:c,backgroundRotation:u,environmentIntensity:C,environmentRotation:h})},[n,x,M.texture,m,R,r,a,S]);let E=1;return bg(()=>{if(a===1/0||E<a){const F=S.autoClear;S.autoClear=!0,Z.current.update(S,x),S.autoClear=F,E++}}),v.createElement(v.Fragment,null,K6(v.createElement(v.Fragment,null,n,v.createElement("cubeCamera",{ref:Z,args:[e,t,M]}),p||b?v.createElement(ET,{background:!0,files:p,preset:b,path:B,extensions:y}):o?v.createElement(iM,{background:!0,map:o,extensions:y}):null),x))}function Kee(n){var e,t,i,a;const o=QG(n),r=n.map||o;v.useMemo(()=>jX({GroundProjectedEnvImpl:wq}),[]),v.useEffect(()=>()=>{o.dispose()},[o]);const s=v.useMemo(()=>[r],[r]),l=(e=n.ground)==null?void 0:e.height,c=(t=n.ground)==null?void 0:t.radius,u=(i=(a=n.ground)==null?void 0:a.scale)!==null&&i!==void 0?i:1e3;return v.createElement(v.Fragment,null,v.createElement(iM,$t({},n,{map:r})),v.createElement("groundProjectedEnvImpl",{args:s,scale:u,height:l,radius:c}))}function HT(n){return n.ground?v.createElement(Kee,n):n.map?v.createElement(iM,n):n.children?v.createElement(zee,n):v.createElement(ET,n)}function Lee(n,e,t=new Be){const i=Math.PI*(n-.5),a=2*Math.PI*(e-.5);return t.x=Math.cos(a),t.y=Math.sin(i),t.z=Math.sin(a),t}const _ee=v.forwardRef(({inclination:n=.6,azimuth:e=.1,distance:t=1e3,mieCoefficient:i=.005,mieDirectionalG:a=.8,rayleigh:o=.5,turbidity:r=10,sunPosition:s=Lee(n,e),...l},c)=>{const u=v.useMemo(()=>new Be().setScalar(t),[t]),[C]=v.useState(()=>new Gq);return v.createElement("primitive",$t({object:C,ref:c,"material-uniforms-mieCoefficient-value":i,"material-uniforms-mieDirectionalG-value":a,"material-uniforms-rayleigh-value":o,"material-uniforms-sunPosition-value":s,"material-uniforms-turbidity-value":r,scale:u},l))});function FT(){const n=v.useRef();return bg((e,t)=>{n.current.rotation.x+=t,n.current.rotation.y+=t*.5}),Le.jsx(wee,{ref:n,args:[1,1,1],scale:1.5,children:Le.jsx("meshStandardMaterial",{color:"royalblue"})})}const Dee=Object.freeze(Object.defineProperty({__proto__:null,default:FT},Symbol.toStringTag,{value:"Module"})),Oee="_scene3dContainer_f7lme_3",Uee={scene3dContainer:Oee};function kee(){return Le.jsx("div",{className:Uee.scene3dContainer,children:Le.jsxs(Ox,{children:[Le.jsx(Jx,{makeDefault:!0,position:[0,0,5]}),Le.jsx(jx,{}),Le.jsx("ambientLight",{intensity:.5}),Le.jsx("pointLight",{position:[10,10,10]}),Le.jsx(FT,{})]})})}const Pee=Object.freeze(Object.defineProperty({__proto__:null,default:kee},Symbol.toStringTag,{value:"Module"}));function Jee(){return Le.jsxs("div",{className:"chart-panel",children:[Le.jsx("h4",{children:" "}),Le.jsx("div",{className:"chart-container",children:Le.jsx("div",{className:"chart-placeholder",children:"  "})})]})}const jee=Object.freeze(Object.defineProperty({__proto__:null,default:Jee},Symbol.toStringTag,{value:"Module"}));function Qee(){const n=[{id:1,title:" 1",value:100},{id:2,title:" 2",value:200},{id:3,title:" 3",value:300}];return Le.jsx("div",{className:"list-panel",children:Le.jsx("ul",{className:"list-container",children:n.map(e=>Le.jsxs("li",{className:"list-item",children:[Le.jsx("span",{children:e.title}),Le.jsx("span",{children:e.value})]},e.id))})})}const qee=Object.freeze(Object.defineProperty({__proto__:null,default:Qee},Symbol.toStringTag,{value:"Module"}));function $ee(){const[n,e]=v.useState(1),[t,i]=v.useState([]),a=()=>{alert("")};return v.useEffect(()=>{e(1),i([{id:1,title:" 1",value:"a100"},{id:2,title:" 2",value:"a200"},{id:3,title:" 3",value:"a300"}])},[]),Le.jsxs("div",{className:"list-panel",children:[Le.jsx("ul",{className:"list-container",children:t.map(o=>Le.jsxs("li",{className:"list-item",children:[Le.jsx("span",{children:o.title}),Le.jsx("span",{children:o.value})]},o.id))}),Le.jsxs("select",{name:"selected",id:"selected",value:n,onChange:o=>e(o.target.value),children:[Le.jsx("option",{value:1,children:" 1"}),Le.jsx("option",{value:2,children:"2"}),Le.jsx("option",{value:3,children:"3"}),Le.jsx("option",{value:4,children:"4"}),Le.jsx("option",{value:5,children:"5"})]}),Le.jsx("button",{onClick:a,children:""})]})}const ete=Object.freeze(Object.defineProperty({__proto__:null,default:$ee},Symbol.toStringTag,{value:"Module"}));var Nw={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/var TE;function tte(){return TE||(TE=1,function(n){(function(){var e={}.hasOwnProperty;function t(){for(var o="",r=0;r<arguments.length;r++){var s=arguments[r];s&&(o=a(o,i(s)))}return o}function i(o){if(typeof o=="string"||typeof o=="number")return o;if(typeof o!="object")return"";if(Array.isArray(o))return t.apply(null,o);if(o.toString!==Object.prototype.toString&&!o.toString.toString().includes("[native code]"))return o.toString();var r="";for(var s in o)e.call(o,s)&&o[s]&&(r=a(r,s));return r}function a(o,r){return r?o?o+" "+r:o+r:o}n.exports?(t.default=t,n.exports=t):window.classNames=t})()}(Nw)),Nw.exports}var nte=tte();const gt=mI(nte);function Bn(n){"@babel/helpers - typeof";return Bn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Bn(n)}var ite=Symbol.for("react.element"),ate=Symbol.for("react.transitional.element"),ote=Symbol.for("react.fragment");function XT(n){return n&&Bn(n)==="object"&&(n.$$typeof===ite||n.$$typeof===ate)&&n.type===ote}function Ic(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=[];return Ct.Children.forEach(n,function(i){i==null&&!e.keepEmpty||(Array.isArray(i)?t=t.concat(Ic(i)):XT(i)&&i.props?t=t.concat(Ic(i.props.children,e)):t.push(i))}),t}var AR={},rte=function(e){};function ste(n,e){}function lte(n,e){}function cte(){AR={}}function TT(n,e,t){!e&&!AR[t]&&(n(!1,t),AR[t]=!0)}function No(n,e){TT(ste,n,e)}function gte(n,e){TT(lte,n,e)}No.preMessage=rte;No.resetWarned=cte;No.noteOnce=gte;function ute(n,e){if(Bn(n)!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(Bn(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function YT(n){var e=ute(n,"string");return Bn(e)=="symbol"?e:e+""}function Ve(n,e,t){return(e=YT(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function YE(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,i)}return t}function Ke(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?YE(Object(t),!0).forEach(function(i){Ve(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):YE(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}function Fp(n){return n instanceof HTMLElement||n instanceof SVGElement}function dte(n){return n&&Bn(n)==="object"&&Fp(n.nativeElement)?n.nativeElement:Fp(n)?n:null}function My(n){var e=dte(n);if(e)return e;if(n instanceof Ct.Component){var t;return(t=W1.findDOMNode)===null||t===void 0?void 0:t.call(W1,n)}return null}var Ew={exports:{}},zi={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zE;function Cte(){if(zE)return zi;zE=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),r=Symbol.for("react.context"),s=Symbol.for("react.server_context"),l=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),u=Symbol.for("react.suspense_list"),C=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),m=Symbol.for("react.offscreen"),p;p=Symbol.for("react.module.reference");function B(b){if(typeof b=="object"&&b!==null){var y=b.$$typeof;switch(y){case n:switch(b=b.type,b){case t:case a:case i:case c:case u:return b;default:switch(b=b&&b.$$typeof,b){case s:case r:case l:case h:case C:case o:return b;default:return y}}case e:return y}}}return zi.ContextConsumer=r,zi.ContextProvider=o,zi.Element=n,zi.ForwardRef=l,zi.Fragment=t,zi.Lazy=h,zi.Memo=C,zi.Portal=e,zi.Profiler=a,zi.StrictMode=i,zi.Suspense=c,zi.SuspenseList=u,zi.isAsyncMode=function(){return!1},zi.isConcurrentMode=function(){return!1},zi.isContextConsumer=function(b){return B(b)===r},zi.isContextProvider=function(b){return B(b)===o},zi.isElement=function(b){return typeof b=="object"&&b!==null&&b.$$typeof===n},zi.isForwardRef=function(b){return B(b)===l},zi.isFragment=function(b){return B(b)===t},zi.isLazy=function(b){return B(b)===h},zi.isMemo=function(b){return B(b)===C},zi.isPortal=function(b){return B(b)===e},zi.isProfiler=function(b){return B(b)===a},zi.isStrictMode=function(b){return B(b)===i},zi.isSuspense=function(b){return B(b)===c},zi.isSuspenseList=function(b){return B(b)===u},zi.isValidElementType=function(b){return typeof b=="string"||typeof b=="function"||b===t||b===a||b===i||b===c||b===u||b===m||typeof b=="object"&&b!==null&&(b.$$typeof===h||b.$$typeof===C||b.$$typeof===o||b.$$typeof===r||b.$$typeof===l||b.$$typeof===p||b.getModuleId!==void 0)},zi.typeOf=B,zi}var KE;function Ite(){return KE||(KE=1,Ew.exports=Cte()),Ew.exports}var Hw=Ite();function mb(n,e,t){var i=v.useRef({});return(!("value"in i.current)||t(i.current.condition,e))&&(i.current.value=n(),i.current.condition=e),i.current.value}var hte=Number(v.version.split(".")[0]),aM=function(e,t){typeof e=="function"?e(t):Bn(e)==="object"&&e&&"current"in e&&(e.current=t)},Bs=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];var a=t.filter(Boolean);return a.length<=1?a[0]:function(o){t.forEach(function(r){aM(r,o)})}},yI=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return mb(function(){return Bs.apply(void 0,t)},t,function(a,o){return a.length!==o.length||a.every(function(r,s){return r!==o[s]})})},BI=function(e){var t,i;if(!e)return!1;if(zT(e)&&hte>=19)return!0;var a=Hw.isMemo(e)?e.type.type:e.type;return!(typeof a=="function"&&!((t=a.prototype)!==null&&t!==void 0&&t.render)&&a.$$typeof!==Hw.ForwardRef||typeof e=="function"&&!((i=e.prototype)!==null&&i!==void 0&&i.render)&&e.$$typeof!==Hw.ForwardRef)};function zT(n){return v.isValidElement(n)&&!XT(n)}var Qf=function(e){if(e&&zT(e)){var t=e;return t.props.propertyIsEnumerable("ref")?t.props.ref:t.ref}return null},mR=v.createContext(null);function fte(n){var e=n.children,t=n.onBatchResize,i=v.useRef(0),a=v.useRef([]),o=v.useContext(mR),r=v.useCallback(function(s,l,c){i.current+=1;var u=i.current;a.current.push({size:s,element:l,data:c}),Promise.resolve().then(function(){u===i.current&&(t==null||t(a.current),a.current=[])}),o==null||o(s,l,c)},[t,o]);return v.createElement(mR.Provider,{value:r},e)}var KT=function(){if(typeof Map<"u")return Map;function n(e,t){var i=-1;return e.some(function(a,o){return a[0]===t?(i=o,!0):!1}),i}return function(){function e(){this.__entries__=[]}return Object.defineProperty(e.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),e.prototype.get=function(t){var i=n(this.__entries__,t),a=this.__entries__[i];return a&&a[1]},e.prototype.set=function(t,i){var a=n(this.__entries__,t);~a?this.__entries__[a][1]=i:this.__entries__.push([t,i])},e.prototype.delete=function(t){var i=this.__entries__,a=n(i,t);~a&&i.splice(a,1)},e.prototype.has=function(t){return!!~n(this.__entries__,t)},e.prototype.clear=function(){this.__entries__.splice(0)},e.prototype.forEach=function(t,i){i===void 0&&(i=null);for(var a=0,o=this.__entries__;a<o.length;a++){var r=o[a];t.call(i,r[1],r[0])}},e}()}(),pR=typeof window<"u"&&typeof document<"u"&&window.document===document,YB=function(){return typeof global<"u"&&global.Math===Math?global:typeof self<"u"&&self.Math===Math?self:typeof window<"u"&&window.Math===Math?window:Function("return this")()}(),Ate=function(){return typeof requestAnimationFrame=="function"?requestAnimationFrame.bind(YB):function(n){return setTimeout(function(){return n(Date.now())},1e3/60)}}(),mte=2;function pte(n,e){var t=!1,i=!1,a=0;function o(){t&&(t=!1,n()),i&&s()}function r(){Ate(o)}function s(){var l=Date.now();if(t){if(l-a<mte)return;i=!0}else t=!0,i=!1,setTimeout(r,e);a=l}return s}var bte=20,vte=["top","right","bottom","left","width","height","size","weight"],yte=typeof MutationObserver<"u",Bte=function(){function n(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=pte(this.refresh.bind(this),bte)}return n.prototype.addObserver=function(e){~this.observers_.indexOf(e)||this.observers_.push(e),this.connected_||this.connect_()},n.prototype.removeObserver=function(e){var t=this.observers_,i=t.indexOf(e);~i&&t.splice(i,1),!t.length&&this.connected_&&this.disconnect_()},n.prototype.refresh=function(){var e=this.updateObservers_();e&&this.refresh()},n.prototype.updateObservers_=function(){var e=this.observers_.filter(function(t){return t.gatherActive(),t.hasActive()});return e.forEach(function(t){return t.broadcastActive()}),e.length>0},n.prototype.connect_=function(){!pR||this.connected_||(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),yte?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},n.prototype.disconnect_=function(){!pR||!this.connected_||(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},n.prototype.onTransitionEnd_=function(e){var t=e.propertyName,i=t===void 0?"":t,a=vte.some(function(o){return!!~i.indexOf(o)});a&&this.refresh()},n.getInstance=function(){return this.instance_||(this.instance_=new n),this.instance_},n.instance_=null,n}(),LT=function(n,e){for(var t=0,i=Object.keys(e);t<i.length;t++){var a=i[t];Object.defineProperty(n,a,{value:e[a],enumerable:!1,writable:!1,configurable:!0})}return n},Wf=function(n){var e=n&&n.ownerDocument&&n.ownerDocument.defaultView;return e||YB},_T=qG(0,0,0,0);function zB(n){return parseFloat(n)||0}function LE(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];return e.reduce(function(i,a){var o=n["border-"+a+"-width"];return i+zB(o)},0)}function Gte(n){for(var e=["top","right","bottom","left"],t={},i=0,a=e;i<a.length;i++){var o=a[i],r=n["padding-"+o];t[o]=zB(r)}return t}function Ste(n){var e=n.getBBox();return qG(0,0,e.width,e.height)}function wte(n){var e=n.clientWidth,t=n.clientHeight;if(!e&&!t)return _T;var i=Wf(n).getComputedStyle(n),a=Gte(i),o=a.left+a.right,r=a.top+a.bottom,s=zB(i.width),l=zB(i.height);if(i.boxSizing==="border-box"&&(Math.round(s+o)!==e&&(s-=LE(i,"left","right")+o),Math.round(l+r)!==t&&(l-=LE(i,"top","bottom")+r)),!Zte(n)){var c=Math.round(s+o)-e,u=Math.round(l+r)-t;Math.abs(c)!==1&&(s-=c),Math.abs(u)!==1&&(l-=u)}return qG(a.left,a.top,s,l)}var Rte=function(){return typeof SVGGraphicsElement<"u"?function(n){return n instanceof Wf(n).SVGGraphicsElement}:function(n){return n instanceof Wf(n).SVGElement&&typeof n.getBBox=="function"}}();function Zte(n){return n===Wf(n).document.documentElement}function xte(n){return pR?Rte(n)?Ste(n):wte(n):_T}function Mte(n){var e=n.x,t=n.y,i=n.width,a=n.height,o=typeof DOMRectReadOnly<"u"?DOMRectReadOnly:Object,r=Object.create(o.prototype);return LT(r,{x:e,y:t,width:i,height:a,top:t,right:e+i,bottom:a+t,left:e}),r}function qG(n,e,t,i){return{x:n,y:e,width:t,height:i}}var Wte=function(){function n(e){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=qG(0,0,0,0),this.target=e}return n.prototype.isActive=function(){var e=xte(this.target);return this.contentRect_=e,e.width!==this.broadcastWidth||e.height!==this.broadcastHeight},n.prototype.broadcastRect=function(){var e=this.contentRect_;return this.broadcastWidth=e.width,this.broadcastHeight=e.height,e},n}(),Vte=function(){function n(e,t){var i=Mte(t);LT(this,{target:e,contentRect:i})}return n}(),Nte=function(){function n(e,t,i){if(this.activeObservations_=[],this.observations_=new KT,typeof e!="function")throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=e,this.controller_=t,this.callbackCtx_=i}return n.prototype.observe=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(e instanceof Wf(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)||(t.set(e,new Wte(e)),this.controller_.addObserver(this),this.controller_.refresh())}},n.prototype.unobserve=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(e instanceof Wf(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)&&(t.delete(e),t.size||this.controller_.removeObserver(this))}},n.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},n.prototype.gatherActive=function(){var e=this;this.clearActive(),this.observations_.forEach(function(t){t.isActive()&&e.activeObservations_.push(t)})},n.prototype.broadcastActive=function(){if(this.hasActive()){var e=this.callbackCtx_,t=this.activeObservations_.map(function(i){return new Vte(i.target,i.broadcastRect())});this.callback_.call(e,t,e),this.clearActive()}},n.prototype.clearActive=function(){this.activeObservations_.splice(0)},n.prototype.hasActive=function(){return this.activeObservations_.length>0},n}(),DT=typeof WeakMap<"u"?new WeakMap:new KT,OT=function(){function n(e){if(!(this instanceof n))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var t=Bte.getInstance(),i=new Nte(e,t,this);DT.set(this,i)}return n}();["observe","unobserve","disconnect"].forEach(function(n){OT.prototype[n]=function(){var e;return(e=DT.get(this))[n].apply(e,arguments)}});var Ete=function(){return typeof YB.ResizeObserver<"u"?YB.ResizeObserver:OT}(),Id=new Map;function Hte(n){n.forEach(function(e){var t,i=e.target;(t=Id.get(i))===null||t===void 0||t.forEach(function(a){return a(i)})})}var UT=new Ete(Hte);function Fte(n,e){Id.has(n)||(Id.set(n,new Set),UT.observe(n)),Id.get(n).add(e)}function Xte(n,e){Id.has(n)&&(Id.get(n).delete(e),Id.get(n).size||(UT.unobserve(n),Id.delete(n)))}function to(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function _E(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,YT(i.key),i)}}function no(n,e,t){return e&&_E(n.prototype,e),t&&_E(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}function Xp(n,e){return Xp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t},Xp(n,e)}function Iu(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),e&&Xp(n,e)}function Tp(n){return Tp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Tp(n)}function oM(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(oM=function(){return!!n})()}function si(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function Tte(n,e){if(e&&(Bn(e)=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return si(n)}function hu(n){var e=oM();return function(){var t,i=Tp(n);if(e){var a=Tp(this).constructor;t=Reflect.construct(i,arguments,a)}else t=i.apply(this,arguments);return Tte(this,t)}}var Yte=function(n){Iu(t,n);var e=hu(t);function t(){return to(this,t),e.apply(this,arguments)}return no(t,[{key:"render",value:function(){return this.props.children}}]),t}(v.Component);function zte(n,e){var t=n.children,i=n.disabled,a=v.useRef(null),o=v.useRef(null),r=v.useContext(mR),s=typeof t=="function",l=s?t(a):t,c=v.useRef({width:-1,height:-1,offsetWidth:-1,offsetHeight:-1}),u=!s&&v.isValidElement(l)&&BI(l),C=u?Qf(l):null,h=yI(C,a),m=function(){var y;return My(a.current)||(a.current&&Bn(a.current)==="object"?My((y=a.current)===null||y===void 0?void 0:y.nativeElement):null)||My(o.current)};v.useImperativeHandle(e,function(){return m()});var p=v.useRef(n);p.current=n;var B=v.useCallback(function(b){var y=p.current,S=y.onResize,R=y.data,Z=b.getBoundingClientRect(),x=Z.width,M=Z.height,E=b.offsetWidth,F=b.offsetHeight,N=Math.floor(x),H=Math.floor(M);if(c.current.width!==N||c.current.height!==H||c.current.offsetWidth!==E||c.current.offsetHeight!==F){var z={width:N,height:H,offsetWidth:E,offsetHeight:F};c.current=z;var _=E===Math.round(x)?x:E,D=F===Math.round(M)?M:F,P=Ke(Ke({},z),{},{offsetWidth:_,offsetHeight:D});r==null||r(P,b,R),S&&Promise.resolve().then(function(){S(P,b)})}},[]);return v.useEffect(function(){var b=m();return b&&!i&&Fte(b,B),function(){return Xte(b,B)}},[a.current,i]),v.createElement(Yte,{ref:o},u?v.cloneElement(l,{ref:h}):l)}var Kte=v.forwardRef(zte),Lte="rc-observer-key";function _te(n,e){var t=n.children,i=typeof t=="function"?[t]:Ic(t);return i.map(function(a,o){var r=(a==null?void 0:a.key)||"".concat(Lte,"-").concat(o);return v.createElement(Kte,$t({},n,{key:r,ref:o===0?e:void 0}),a)})}var vl=v.forwardRef(_te);vl.Collection=fte;function bR(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=Array(e);t<e;t++)i[t]=n[t];return i}function Dte(n){if(Array.isArray(n))return bR(n)}function kT(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function rM(n,e){if(n){if(typeof n=="string")return bR(n,e);var t={}.toString.call(n).slice(8,-1);return t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set"?Array.from(n):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?bR(n,e):void 0}}function Ote(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function an(n){return Dte(n)||kT(n)||rM(n)||Ote()}var PT=function(e){return+setTimeout(e,16)},JT=function(e){return clearTimeout(e)};typeof window<"u"&&"requestAnimationFrame"in window&&(PT=function(e){return window.requestAnimationFrame(e)},JT=function(e){return window.cancelAnimationFrame(e)});var DE=0,sM=new Map;function jT(n){sM.delete(n)}var mi=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;DE+=1;var i=DE;function a(o){if(o===0)jT(i),e();else{var r=PT(function(){a(o-1)});sM.set(i,r)}}return a(t),i};mi.cancel=function(n){var e=sM.get(n);return jT(n),JT(e)};function QT(n){if(Array.isArray(n))return n}function Ute(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var i,a,o,r,s=[],l=!0,c=!1;try{if(o=(t=t.call(n)).next,e===0){if(Object(t)!==t)return;l=!1}else for(;!(l=(i=o.call(t)).done)&&(s.push(i.value),s.length!==e);l=!0);}catch(u){c=!0,a=u}finally{try{if(!l&&t.return!=null&&(r=t.return(),Object(r)!==r))return}finally{if(c)throw a}}return s}}function qT(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rt(n,e){return QT(n)||Ute(n,e)||rM(n,e)||qT()}function Yp(n){for(var e=0,t,i=0,a=n.length;a>=4;++i,a-=4)t=n.charCodeAt(i)&255|(n.charCodeAt(++i)&255)<<8|(n.charCodeAt(++i)&255)<<16|(n.charCodeAt(++i)&255)<<24,t=(t&65535)*1540483477+((t>>>16)*59797<<16),t^=t>>>24,e=(t&65535)*1540483477+((t>>>16)*59797<<16)^(e&65535)*1540483477+((e>>>16)*59797<<16);switch(a){case 3:e^=(n.charCodeAt(i+2)&255)<<16;case 2:e^=(n.charCodeAt(i+1)&255)<<8;case 1:e^=n.charCodeAt(i)&255,e=(e&65535)*1540483477+((e>>>16)*59797<<16)}return e^=e>>>13,e=(e&65535)*1540483477+((e>>>16)*59797<<16),((e^e>>>15)>>>0).toString(36)}function kr(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}function kte(n,e){if(!n)return!1;if(n.contains)return n.contains(e);for(var t=e;t;){if(t===n)return!0;t=t.parentNode}return!1}var OE="data-rc-order",UE="data-rc-priority",Pte="rc-util-key",vR=new Map;function $T(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=n.mark;return e?e.startsWith("data-")?e:"data-".concat(e):Pte}function $G(n){if(n.attachTo)return n.attachTo;var e=document.querySelector("head");return e||document.body}function Jte(n){return n==="queue"?"prependQueue":n?"prepend":"append"}function lM(n){return Array.from((vR.get(n)||n).children).filter(function(e){return e.tagName==="STYLE"})}function eY(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!kr())return null;var t=e.csp,i=e.prepend,a=e.priority,o=a===void 0?0:a,r=Jte(i),s=r==="prependQueue",l=document.createElement("style");l.setAttribute(OE,r),s&&o&&l.setAttribute(UE,"".concat(o)),t!=null&&t.nonce&&(l.nonce=t==null?void 0:t.nonce),l.innerHTML=n;var c=$G(e),u=c.firstChild;if(i){if(s){var C=(e.styles||lM(c)).filter(function(h){if(!["prepend","prependQueue"].includes(h.getAttribute(OE)))return!1;var m=Number(h.getAttribute(UE)||0);return o>=m});if(C.length)return c.insertBefore(l,C[C.length-1].nextSibling),l}c.insertBefore(l,u)}else c.appendChild(l);return l}function tY(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=$G(e);return(e.styles||lM(t)).find(function(i){return i.getAttribute($T(e))===n})}function zp(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=tY(n,e);if(t){var i=$G(e);i.removeChild(t)}}function jte(n,e){var t=vR.get(n);if(!t||!kte(document,t)){var i=eY("",e),a=i.parentNode;vR.set(n,a),n.removeChild(i)}}function lu(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=$G(t),a=lM(i),o=Ke(Ke({},t),{},{styles:a});jte(i,o);var r=tY(e,o);if(r){var s,l;if((s=o.csp)!==null&&s!==void 0&&s.nonce&&r.nonce!==((l=o.csp)===null||l===void 0?void 0:l.nonce)){var c;r.nonce=(c=o.csp)===null||c===void 0?void 0:c.nonce}return r.innerHTML!==n&&(r.innerHTML=n),r}var u=eY(n,o);return u.setAttribute($T(o),e),u}function Qte(n,e){if(n==null)return{};var t={};for(var i in n)if({}.hasOwnProperty.call(n,i)){if(e.indexOf(i)!==-1)continue;t[i]=n[i]}return t}function _n(n,e){if(n==null)return{};var t,i,a=Qte(n,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(n);for(i=0;i<o.length;i++)t=o[i],e.indexOf(t)===-1&&{}.propertyIsEnumerable.call(n,t)&&(a[t]=n[t])}return a}function Vf(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=new Set;function a(o,r){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,l=i.has(o);if(No(!l,"Warning: There may be circular references"),l)return!1;if(o===r)return!0;if(t&&s>1)return!1;i.add(o);var c=s+1;if(Array.isArray(o)){if(!Array.isArray(r)||o.length!==r.length)return!1;for(var u=0;u<o.length;u++)if(!a(o[u],r[u],c))return!1;return!0}if(o&&r&&Bn(o)==="object"&&Bn(r)==="object"){var C=Object.keys(o);return C.length!==Object.keys(r).length?!1:C.every(function(h){return a(o[h],r[h],c)})}return!1}return a(n,e)}var qte="%";function yR(n){return n.join(qte)}var $te=function(){function n(e){to(this,n),Ve(this,"instanceId",void 0),Ve(this,"cache",new Map),this.instanceId=e}return no(n,[{key:"get",value:function(t){return this.opGet(yR(t))}},{key:"opGet",value:function(t){return this.cache.get(t)||null}},{key:"update",value:function(t,i){return this.opUpdate(yR(t),i)}},{key:"opUpdate",value:function(t,i){var a=this.cache.get(t),o=i(a);o===null?this.cache.delete(t):this.cache.set(t,o)}}]),n}(),Nf="data-token-hash",uc="data-css-hash",hd="__cssinjs_instance__";function ene(){var n=Math.random().toString(12).slice(2);if(typeof document<"u"&&document.head&&document.body){var e=document.body.querySelectorAll("style[".concat(uc,"]"))||[],t=document.head.firstChild;Array.from(e).forEach(function(a){a[hd]=a[hd]||n,a[hd]===n&&document.head.insertBefore(a,t)});var i={};Array.from(document.querySelectorAll("style[".concat(uc,"]"))).forEach(function(a){var o=a.getAttribute(uc);if(i[o]){if(a[hd]===n){var r;(r=a.parentNode)===null||r===void 0||r.removeChild(a)}}else i[o]=!0})}return new $te(n)}var pb=v.createContext({hashPriority:"low",cache:ene(),defaultCache:!0});function tne(n,e){if(n.length!==e.length)return!1;for(var t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}var cM=function(){function n(){to(this,n),Ve(this,"cache",void 0),Ve(this,"keys",void 0),Ve(this,"cacheCallTimes",void 0),this.cache=new Map,this.keys=[],this.cacheCallTimes=0}return no(n,[{key:"size",value:function(){return this.keys.length}},{key:"internalGet",value:function(t){var i,a,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r={map:this.cache};return t.forEach(function(s){if(!r)r=void 0;else{var l;r=(l=r)===null||l===void 0||(l=l.map)===null||l===void 0?void 0:l.get(s)}}),(i=r)!==null&&i!==void 0&&i.value&&o&&(r.value[1]=this.cacheCallTimes++),(a=r)===null||a===void 0?void 0:a.value}},{key:"get",value:function(t){var i;return(i=this.internalGet(t,!0))===null||i===void 0?void 0:i[0]}},{key:"has",value:function(t){return!!this.internalGet(t)}},{key:"set",value:function(t,i){var a=this;if(!this.has(t)){if(this.size()+1>n.MAX_CACHE_SIZE+n.MAX_CACHE_OFFSET){var o=this.keys.reduce(function(c,u){var C=rt(c,2),h=C[1];return a.internalGet(u)[1]<h?[u,a.internalGet(u)[1]]:c},[this.keys[0],this.cacheCallTimes]),r=rt(o,1),s=r[0];this.delete(s)}this.keys.push(t)}var l=this.cache;t.forEach(function(c,u){if(u===t.length-1)l.set(c,{value:[i,a.cacheCallTimes++]});else{var C=l.get(c);C?C.map||(C.map=new Map):l.set(c,{map:new Map}),l=l.get(c).map}})}},{key:"deleteByPath",value:function(t,i){var a=t.get(i[0]);if(i.length===1){var o;return a.map?t.set(i[0],{map:a.map}):t.delete(i[0]),(o=a.value)===null||o===void 0?void 0:o[0]}var r=this.deleteByPath(a.map,i.slice(1));return(!a.map||a.map.size===0)&&!a.value&&t.delete(i[0]),r}},{key:"delete",value:function(t){if(this.has(t))return this.keys=this.keys.filter(function(i){return!tne(i,t)}),this.deleteByPath(this.cache,t)}}]),n}();Ve(cM,"MAX_CACHE_SIZE",20);Ve(cM,"MAX_CACHE_OFFSET",5);var kE=0,nY=function(){function n(e){to(this,n),Ve(this,"derivatives",void 0),Ve(this,"id",void 0),this.derivatives=Array.isArray(e)?e:[e],this.id=kE,e.length===0&&(e.length>0,void 0),kE+=1}return no(n,[{key:"getDerivativeToken",value:function(t){return this.derivatives.reduce(function(i,a){return a(t,i)},void 0)}}]),n}(),Fw=new cM;function BR(n){var e=Array.isArray(n)?n:[n];return Fw.has(e)||Fw.set(e,new nY(e)),Fw.get(e)}var nne=new WeakMap,Xw={};function ine(n,e){for(var t=nne,i=0;i<e.length;i+=1){var a=e[i];t.has(a)||t.set(a,new WeakMap),t=t.get(a)}return t.has(Xw)||t.set(Xw,n()),t.get(Xw)}var PE=new WeakMap;function hp(n){var e=PE.get(n)||"";return e||(Object.keys(n).forEach(function(t){var i=n[t];e+=t,i instanceof nY?e+=i.id:i&&Bn(i)==="object"?e+=hp(i):e+=i}),e=Yp(e),PE.set(n,e)),e}function JE(n,e){return Yp("".concat(e,"_").concat(hp(n)))}var GR=kr();function st(n){return typeof n=="number"?"".concat(n,"px"):n}function KB(n,e,t){var i,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;if(o)return n;var r=Ke(Ke({},a),{},(i={},Ve(i,Nf,e),Ve(i,uc,t),i)),s=Object.keys(r).map(function(l){var c=r[l];return c?"".concat(l,'="').concat(c,'"'):null}).filter(function(l){return l}).join(" ");return"<style ".concat(s,">").concat(n,"</style>")}var Wy=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return"--".concat(t?"".concat(t,"-"):"").concat(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").replace(/([A-Z]+)([A-Z][a-z0-9]+)/g,"$1-$2").replace(/([a-z])([A-Z0-9])/g,"$1-$2").toLowerCase()},ane=function(e,t,i){return Object.keys(e).length?".".concat(t).concat(i!=null&&i.scope?".".concat(i.scope):"","{").concat(Object.entries(e).map(function(a){var o=rt(a,2),r=o[0],s=o[1];return"".concat(r,":").concat(s,";")}).join(""),"}"):""},iY=function(e,t,i){var a={},o={};return Object.entries(e).forEach(function(r){var s,l,c=rt(r,2),u=c[0],C=c[1];if(i!=null&&(s=i.preserve)!==null&&s!==void 0&&s[u])o[u]=C;else if((typeof C=="string"||typeof C=="number")&&!(i!=null&&(l=i.ignore)!==null&&l!==void 0&&l[u])){var h,m=Wy(u,i==null?void 0:i.prefix);a[m]=typeof C=="number"&&!(i!=null&&(h=i.unitless)!==null&&h!==void 0&&h[u])?"".concat(C,"px"):String(C),o[u]="var(".concat(m,")")}}),[o,ane(a,t,{scope:i==null?void 0:i.scope})]},jE=kr()?v.useLayoutEffect:v.useEffect,xi=function(e,t){var i=v.useRef(!0);jE(function(){return e(i.current)},t),jE(function(){return i.current=!1,function(){i.current=!0}},[])},SR=function(e,t){xi(function(i){if(!i)return e()},t)},one=Ke({},tG),QE=one.useInsertionEffect,rne=function(e,t,i){v.useMemo(e,i),xi(function(){return t(!0)},i)},sne=QE?function(n,e,t){return QE(function(){return n(),e()},t)}:rne,lne=Ke({},tG),cne=lne.useInsertionEffect,gne=function(e){var t=[],i=!1;function a(o){i||t.push(o)}return v.useEffect(function(){return i=!1,function(){i=!0,t.length&&t.forEach(function(o){return o()})}},e),a},une=function(){return function(e){e()}},dne=typeof cne<"u"?gne:une;function gM(n,e,t,i,a){var o=v.useContext(pb),r=o.cache,s=[n].concat(an(e)),l=yR(s),c=dne([l]),u=function(p){r.opUpdate(l,function(B){var b=B||[void 0,void 0],y=rt(b,2),S=y[0],R=S===void 0?0:S,Z=y[1],x=Z,M=x||t(),E=[R,M];return p?p(E):E})};v.useMemo(function(){u()},[l]);var C=r.opGet(l),h=C[1];return sne(function(){a==null||a(h)},function(m){return u(function(p){var B=rt(p,2),b=B[0],y=B[1];return m&&b===0&&(a==null||a(h)),[b+1,y]}),function(){r.opUpdate(l,function(p){var B=p||[],b=rt(B,2),y=b[0],S=y===void 0?0:y,R=b[1],Z=S-1;return Z===0?(c(function(){(m||!r.opGet(l))&&(i==null||i(R,!1))}),null):[S-1,R]})}},[l]),h}var Cne={},Ine="css",YC=new Map;function hne(n){YC.set(n,(YC.get(n)||0)+1)}function fne(n,e){if(typeof document<"u"){var t=document.querySelectorAll("style[".concat(Nf,'="').concat(n,'"]'));t.forEach(function(i){if(i[hd]===e){var a;(a=i.parentNode)===null||a===void 0||a.removeChild(i)}})}}var Ane=0;function mne(n,e){YC.set(n,(YC.get(n)||0)-1);var t=Array.from(YC.keys()),i=t.filter(function(a){var o=YC.get(a)||0;return o<=0});t.length-i.length>Ane&&i.forEach(function(a){fne(a,e),YC.delete(a)})}var pne=function(e,t,i,a){var o=i.getDerivativeToken(e),r=Ke(Ke({},o),t);return a&&(r=a(r)),r},aY="token";function bne(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=v.useContext(pb),a=i.cache.instanceId,o=i.container,r=t.salt,s=r===void 0?"":r,l=t.override,c=l===void 0?Cne:l,u=t.formatToken,C=t.getComputedToken,h=t.cssVar,m=ine(function(){return Object.assign.apply(Object,[{}].concat(an(e)))},e),p=hp(m),B=hp(c),b=h?hp(h):"",y=gM(aY,[s,n.id,p,B,b],function(){var S,R=C?C(m,c,n):pne(m,c,n,u),Z=Ke({},R),x="";if(h){var M=iY(R,h.key,{prefix:h.prefix,ignore:h.ignore,unitless:h.unitless,preserve:h.preserve}),E=rt(M,2);R=E[0],x=E[1]}var F=JE(R,s);R._tokenKey=F,Z._tokenKey=JE(Z,s);var N=(S=h==null?void 0:h.key)!==null&&S!==void 0?S:F;R._themeKey=N,hne(N);var H="".concat(Ine,"-").concat(Yp(F));return R._hashId=H,[R,H,Z,x,(h==null?void 0:h.key)||""]},function(S){mne(S[0]._themeKey,a)},function(S){var R=rt(S,4),Z=R[0],x=R[3];if(h&&x){var M=lu(x,Yp("css-variables-".concat(Z._themeKey)),{mark:uc,prepend:"queue",attachTo:o,priority:-999});M[hd]=a,M.setAttribute(Nf,Z._themeKey)}});return y}var vne=function(e,t,i){var a=rt(e,5),o=a[2],r=a[3],s=a[4],l=i||{},c=l.plain;if(!r)return null;var u=o._tokenKey,C=-999,h={"data-rc-order":"prependQueue","data-rc-priority":"".concat(C)},m=KB(r,s,u,h,c);return[C,u,m]},yne={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},oY="comm",rY="rule",sY="decl",Bne="@import",Gne="@namespace",Sne="@keyframes",wne="@layer",lY=Math.abs,uM=String.fromCharCode;function cY(n){return n.trim()}function Vy(n,e,t){return n.replace(e,t)}function Rne(n,e,t){return n.indexOf(e,t)}function Cf(n,e){return n.charCodeAt(e)|0}function Ef(n,e,t){return n.slice(e,t)}function ag(n){return n.length}function Zne(n){return n.length}function qv(n,e){return e.push(n),n}var eS=1,Hf=1,gY=0,yl=0,$a=0,qf="";function dM(n,e,t,i,a,o,r,s){return{value:n,root:e,parent:t,type:i,props:a,children:o,line:eS,column:Hf,length:r,return:"",siblings:s}}function xne(){return $a}function Mne(){return $a=yl>0?Cf(qf,--yl):0,Hf--,$a===10&&(Hf=1,eS--),$a}function dc(){return $a=yl<gY?Cf(qf,yl++):0,Hf++,$a===10&&(Hf=1,eS++),$a}function fd(){return Cf(qf,yl)}function Ny(){return yl}function tS(n,e){return Ef(qf,n,e)}function Kp(n){switch(n){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function Wne(n){return eS=Hf=1,gY=ag(qf=n),yl=0,[]}function Vne(n){return qf="",n}function Tw(n){return cY(tS(yl-1,wR(n===91?n+2:n===40?n+1:n)))}function Nne(n){for(;($a=fd())&&$a<33;)dc();return Kp(n)>2||Kp($a)>3?"":" "}function Ene(n,e){for(;--e&&dc()&&!($a<48||$a>102||$a>57&&$a<65||$a>70&&$a<97););return tS(n,Ny()+(e<6&&fd()==32&&dc()==32))}function wR(n){for(;dc();)switch($a){case n:return yl;case 34:case 39:n!==34&&n!==39&&wR($a);break;case 40:n===41&&wR(n);break;case 92:dc();break}return yl}function Hne(n,e){for(;dc()&&n+$a!==57;)if(n+$a===84&&fd()===47)break;return"/*"+tS(e,yl-1)+"*"+uM(n===47?n:dc())}function Fne(n){for(;!Kp(fd());)dc();return tS(n,yl)}function Xne(n){return Vne(Ey("",null,null,null,[""],n=Wne(n),0,[0],n))}function Ey(n,e,t,i,a,o,r,s,l){for(var c=0,u=0,C=r,h=0,m=0,p=0,B=1,b=1,y=1,S=0,R="",Z=a,x=o,M=i,E=R;b;)switch(p=S,S=dc()){case 40:if(p!=108&&Cf(E,C-1)==58){Rne(E+=Vy(Tw(S),"&","&\f"),"&\f",lY(c?s[c-1]:0))!=-1&&(y=-1);break}case 34:case 39:case 91:E+=Tw(S);break;case 9:case 10:case 13:case 32:E+=Nne(p);break;case 92:E+=Ene(Ny()-1,7);continue;case 47:switch(fd()){case 42:case 47:qv(Tne(Hne(dc(),Ny()),e,t,l),l),(Kp(p||1)==5||Kp(fd()||1)==5)&&ag(E)&&Ef(E,-1,void 0)!==" "&&(E+=" ");break;default:E+="/"}break;case 123*B:s[c++]=ag(E)*y;case 125*B:case 59:case 0:switch(S){case 0:case 125:b=0;case 59+u:y==-1&&(E=Vy(E,/\f/g,"")),m>0&&(ag(E)-C||B===0&&p===47)&&qv(m>32?$E(E+";",i,t,C-1,l):$E(Vy(E," ","")+";",i,t,C-2,l),l);break;case 59:E+=";";default:if(qv(M=qE(E,e,t,c,u,a,s,R,Z=[],x=[],C,o),o),S===123)if(u===0)Ey(E,e,M,M,Z,o,C,s,x);else{switch(h){case 99:if(Cf(E,3)===110)break;case 108:if(Cf(E,2)===97)break;default:u=0;case 100:case 109:case 115:}u?Ey(n,M,M,i&&qv(qE(n,M,M,0,0,a,s,R,a,Z=[],C,x),x),a,x,C,s,i?Z:x):Ey(E,M,M,M,[""],x,0,s,x)}}c=u=m=0,B=y=1,R=E="",C=r;break;case 58:C=1+ag(E),m=p;default:if(B<1){if(S==123)--B;else if(S==125&&B++==0&&Mne()==125)continue}switch(E+=uM(S),S*B){case 38:y=u>0?1:(E+="\f",-1);break;case 44:s[c++]=(ag(E)-1)*y,y=1;break;case 64:fd()===45&&(E+=Tw(dc())),h=fd(),u=C=ag(R=E+=Fne(Ny())),S++;break;case 45:p===45&&ag(E)==2&&(B=0)}}return o}function qE(n,e,t,i,a,o,r,s,l,c,u,C){for(var h=a-1,m=a===0?o:[""],p=Zne(m),B=0,b=0,y=0;B<i;++B)for(var S=0,R=Ef(n,h+1,h=lY(b=r[B])),Z=n;S<p;++S)(Z=cY(b>0?m[S]+" "+R:Vy(R,/&\f/g,m[S])))&&(l[y++]=Z);return dM(n,e,t,a===0?rY:s,l,c,u,C)}function Tne(n,e,t,i){return dM(n,e,t,oY,uM(xne()),Ef(n,2,-2),0,i)}function $E(n,e,t,i,a){return dM(n,e,t,sY,Ef(n,0,i),Ef(n,i+1,-1),i,a)}function RR(n,e){for(var t="",i=0;i<n.length;i++)t+=e(n[i],i,n,e)||"";return t}function Yne(n,e,t,i){switch(n.type){case wne:if(n.children.length)break;case Bne:case Gne:case sY:return n.return=n.return||n.value;case oY:return"";case Sne:return n.return=n.value+"{"+RR(n.children,i)+"}";case rY:if(!ag(n.value=n.props.join(",")))return""}return ag(t=RR(n.children,i))?n.return=n.value+"{"+t+"}":""}var eH="data-ant-cssinjs-cache-path",uY="_FILE_STYLE__",oI,dY=!0;function zne(){if(!oI&&(oI={},kr())){var n=document.createElement("div");n.className=eH,n.style.position="fixed",n.style.visibility="hidden",n.style.top="-9999px",document.body.appendChild(n);var e=getComputedStyle(n).content||"";e=e.replace(/^"/,"").replace(/"$/,""),e.split(";").forEach(function(a){var o=a.split(":"),r=rt(o,2),s=r[0],l=r[1];oI[s]=l});var t=document.querySelector("style[".concat(eH,"]"));if(t){var i;dY=!1,(i=t.parentNode)===null||i===void 0||i.removeChild(t)}document.body.removeChild(n)}}function Kne(n){return zne(),!!oI[n]}function Lne(n){var e=oI[n],t=null;if(e&&kr())if(dY)t=uY;else{var i=document.querySelector("style[".concat(uc,'="').concat(oI[n],'"]'));i?t=i.innerHTML:delete oI[n]}return[t,e]}var _ne="_skip_check_",CY="_multi_value_";function Hy(n){var e=RR(Xne(n),Yne);return e.replace(/\{%%%\:[^;];}/g,";")}function Dne(n){return Bn(n)==="object"&&n&&(_ne in n||CY in n)}function tH(n,e,t){if(!e)return n;var i=".".concat(e),a=t==="low"?":where(".concat(i,")"):i,o=n.split(",").map(function(r){var s,l=r.trim().split(/\s+/),c=l[0]||"",u=((s=c.match(/^\w+/))===null||s===void 0?void 0:s[0])||"";return c="".concat(u).concat(a).concat(c.slice(u.length)),[c].concat(an(l.slice(1))).join(" ")});return o.join(",")}var One=function n(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{root:!0,parentSelectors:[]},a=i.root,o=i.injectHash,r=i.parentSelectors,s=t.hashId,l=t.layer;t.path;var c=t.hashPriority,u=t.transformers,C=u===void 0?[]:u;t.linters;var h="",m={};function p(y){var S=y.getName(s);if(!m[S]){var R=n(y.style,t,{root:!1,parentSelectors:r}),Z=rt(R,1),x=Z[0];m[S]="@keyframes ".concat(y.getName(s)).concat(x)}}function B(y){var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return y.forEach(function(R){Array.isArray(R)?B(R,S):R&&S.push(R)}),S}var b=B(Array.isArray(e)?e:[e]);return b.forEach(function(y){var S=typeof y=="string"&&!a?{}:y;if(typeof S=="string")h+="".concat(S,`
`);else if(S._keyframe)p(S);else{var R=C.reduce(function(Z,x){var M;return(x==null||(M=x.visit)===null||M===void 0?void 0:M.call(x,Z))||Z},S);Object.keys(R).forEach(function(Z){var x=R[Z];if(Bn(x)==="object"&&x&&(Z!=="animationName"||!x._keyframe)&&!Dne(x)){var M=!1,E=Z.trim(),F=!1;(a||o)&&s?E.startsWith("@")?M=!0:E==="&"?E=tH("",s,c):E=tH(Z,s,c):a&&!s&&(E==="&"||E==="")&&(E="",F=!0);var N=n(x,t,{root:F,injectHash:M,parentSelectors:[].concat(an(r),[E])}),H=rt(N,2),z=H[0],_=H[1];m=Ke(Ke({},m),_),h+="".concat(E).concat(z)}else{let $=function(X,L){var U=X.replace(/[A-Z]/g,function(K){return"-".concat(K.toLowerCase())}),q=L;!yne[X]&&typeof q=="number"&&q!==0&&(q="".concat(q,"px")),X==="animationName"&&L!==null&&L!==void 0&&L._keyframe&&(p(L),q=L.getName(s)),h+="".concat(U,":").concat(q,";")};var D,P=(D=x==null?void 0:x.value)!==null&&D!==void 0?D:x;Bn(x)==="object"&&x!==null&&x!==void 0&&x[CY]&&Array.isArray(P)?P.forEach(function(X){$(Z,X)}):$(Z,P)}})}}),a?l&&(h&&(h="@layer ".concat(l.name," {").concat(h,"}")),l.dependencies&&(m["@layer ".concat(l.name)]=l.dependencies.map(function(y){return"@layer ".concat(y,", ").concat(l.name,";")}).join(`
`))):h="{".concat(h,"}"),[h,m]};function IY(n,e){return Yp("".concat(n.join("%")).concat(e))}function Une(){return null}var hY="style";function ZR(n,e){var t=n.token,i=n.path,a=n.hashId,o=n.layer,r=n.nonce,s=n.clientOnly,l=n.order,c=l===void 0?0:l,u=v.useContext(pb),C=u.autoClear;u.mock;var h=u.defaultCache,m=u.hashPriority,p=u.container,B=u.ssrInline,b=u.transformers,y=u.linters,S=u.cache,R=u.layer,Z=t._tokenKey,x=[Z];R&&x.push("layer"),x.push.apply(x,an(i));var M=GR,E=gM(hY,x,function(){var _=x.join("|");if(Kne(_)){var D=Lne(_),P=rt(D,2),$=P[0],X=P[1];if($)return[$,Z,X,{},s,c]}var L=e(),U=One(L,{hashId:a,hashPriority:m,layer:R?o:void 0,path:i.join("-"),transformers:b,linters:y}),q=rt(U,2),K=q[0],O=q[1],j=Hy(K),ne=IY(x,j);return[j,Z,ne,O,s,c]},function(_,D){var P=rt(_,3),$=P[2];(D||C)&&GR&&zp($,{mark:uc})},function(_){var D=rt(_,4),P=D[0];D[1];var $=D[2],X=D[3];if(M&&P!==uY){var L={mark:uc,prepend:R?!1:"queue",attachTo:p,priority:c},U=typeof r=="function"?r():r;U&&(L.csp={nonce:U});var q=[],K=[];Object.keys(X).forEach(function(j){j.startsWith("@layer")?q.push(j):K.push(j)}),q.forEach(function(j){lu(Hy(X[j]),"_layer-".concat(j),Ke(Ke({},L),{},{prepend:!0}))});var O=lu(P,$,L);O[hd]=S.instanceId,O.setAttribute(Nf,Z),K.forEach(function(j){lu(Hy(X[j]),"_effect-".concat(j),L)})}}),F=rt(E,3),N=F[0],H=F[1],z=F[2];return function(_){var D;if(!B||M||!h)D=v.createElement(Une,null);else{var P;D=v.createElement("style",$t({},(P={},Ve(P,Nf,H),Ve(P,uc,z),P),{dangerouslySetInnerHTML:{__html:N}}))}return v.createElement(v.Fragment,null,D,_)}}var kne=function(e,t,i){var a=rt(e,6),o=a[0],r=a[1],s=a[2],l=a[3],c=a[4],u=a[5],C=i||{},h=C.plain;if(c)return null;var m=o,p={"data-rc-order":"prependQueue","data-rc-priority":"".concat(u)};return m=KB(o,r,s,p,h),l&&Object.keys(l).forEach(function(B){if(!t[B]){t[B]=!0;var b=Hy(l[B]),y=KB(b,r,"_effect-".concat(B),p,h);B.startsWith("@layer")?m=y+m:m+=y}}),[u,s,m]},fY="cssVar",Pne=function(e,t){var i=e.key,a=e.prefix,o=e.unitless,r=e.ignore,s=e.token,l=e.scope,c=l===void 0?"":l,u=v.useContext(pb),C=u.cache.instanceId,h=u.container,m=s._tokenKey,p=[].concat(an(e.path),[i,c,m]),B=gM(fY,p,function(){var b=t(),y=iY(b,i,{prefix:a,unitless:o,ignore:r,scope:c}),S=rt(y,2),R=S[0],Z=S[1],x=IY(p,Z);return[R,Z,x,i]},function(b){var y=rt(b,3),S=y[2];GR&&zp(S,{mark:uc})},function(b){var y=rt(b,3),S=y[1],R=y[2];if(S){var Z=lu(S,R,{mark:uc,prepend:"queue",attachTo:h,priority:-999});Z[hd]=C,Z.setAttribute(Nf,i)}});return B},Jne=function(e,t,i){var a=rt(e,4),o=a[1],r=a[2],s=a[3],l=i||{},c=l.plain;if(!o)return null;var u=-999,C={"data-rc-order":"prependQueue","data-rc-priority":"".concat(u)},h=KB(o,s,r,C,c);return[u,r,h]},Hm;Hm={},Ve(Hm,hY,kne),Ve(Hm,aY,vne),Ve(Hm,fY,Jne);var Ti=function(){function n(e,t){to(this,n),Ve(this,"name",void 0),Ve(this,"style",void 0),Ve(this,"_keyframe",!0),this.name=e,this.style=t}return no(n,[{key:"getName",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return t?"".concat(t,"-").concat(this.name):this.name}}]),n}();function Oh(n){return n.notSplit=!0,n}Oh(["borderTop","borderBottom"]),Oh(["borderTop"]),Oh(["borderBottom"]),Oh(["borderLeft","borderRight"]),Oh(["borderLeft"]),Oh(["borderRight"]);var CM=v.createContext({});function AY(n){return QT(n)||kT(n)||rM(n)||qT()}function rg(n,e){for(var t=n,i=0;i<e.length;i+=1){if(t==null)return;t=t[e[i]]}return t}function mY(n,e,t,i){if(!e.length)return t;var a=AY(e),o=a[0],r=a.slice(1),s;return!n&&typeof o=="number"?s=[]:Array.isArray(n)?s=an(n):s=Ke({},n),i&&t===void 0&&r.length===1?delete s[o][r[0]]:s[o]=mY(s[o],r,t,i),s}function rc(n,e,t){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;return e.length&&i&&t===void 0&&!rg(n,e.slice(0,-1))?n:mY(n,e,t,i)}function jne(n){return Bn(n)==="object"&&n!==null&&Object.getPrototypeOf(n)===Object.prototype}function nH(n){return Array.isArray(n)?[]:{}}var Qne=typeof Reflect>"u"?Object.keys:Reflect.ownKeys;function of(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];var i=nH(e[0]);return e.forEach(function(a){function o(r,s){var l=new Set(s),c=rg(a,r),u=Array.isArray(c);if(u||jne(c)){if(!l.has(c)){l.add(c);var C=rg(i,r);u?i=rc(i,r,[]):(!C||Bn(C)!=="object")&&(i=rc(i,r,nH(c))),Qne(c).forEach(function(h){o([].concat(an(r),[h]),l)})}}else i=rc(i,r,c)}o([])}),i}function qne(){}const $ne=v.createContext({}),pY=()=>{const n=()=>{};return n.deprecated=qne,n},eie=v.createContext(void 0);var bY={items_per_page:"/ page",jump_to:"Go to",jump_to_confirm:"confirm",page:"Page",prev_page:"Previous Page",next_page:"Next Page",prev_5:"Previous 5 Pages",next_5:"Next 5 Pages",prev_3:"Previous 3 Pages",next_3:"Next 3 Pages",page_size:"Page Size"},tie={yearFormat:"YYYY",dayFormat:"D",cellMeridiemFormat:"A",monthBeforeYear:!0},nie=Ke(Ke({},tie),{},{locale:"en_US",today:"Today",now:"Now",backToToday:"Back to today",ok:"OK",clear:"Clear",week:"Week",month:"Month",year:"Year",timeSelect:"select time",dateSelect:"select date",weekSelect:"Choose a week",monthSelect:"Choose a month",yearSelect:"Choose a year",decadeSelect:"Choose a decade",dateFormat:"M/D/YYYY",dateTimeFormat:"M/D/YYYY HH:mm:ss",previousMonth:"Previous month (PageUp)",nextMonth:"Next month (PageDown)",previousYear:"Last year (Control + left)",nextYear:"Next year (Control + right)",previousDecade:"Last decade",nextDecade:"Next decade",previousCentury:"Last century",nextCentury:"Next century"});const vY={placeholder:"Select time",rangePlaceholder:["Start time","End time"]},iH={lang:Object.assign({placeholder:"Select date",yearPlaceholder:"Select year",quarterPlaceholder:"Select quarter",monthPlaceholder:"Select month",weekPlaceholder:"Select week",rangePlaceholder:["Start date","End date"],rangeYearPlaceholder:["Start year","End year"],rangeQuarterPlaceholder:["Start quarter","End quarter"],rangeMonthPlaceholder:["Start month","End month"],rangeWeekPlaceholder:["Start week","End week"]},nie),timePickerLocale:Object.assign({},vY)},zs="${label} is not a valid ${type}",Ff={locale:"en",Pagination:bY,DatePicker:iH,TimePicker:vY,Calendar:iH,global:{placeholder:"Please select"},Table:{filterTitle:"Filter menu",filterConfirm:"OK",filterReset:"Reset",filterEmptyText:"No filters",filterCheckAll:"Select all items",filterSearchPlaceholder:"Search in filters",emptyText:"No data",selectAll:"Select current page",selectInvert:"Invert current page",selectNone:"Clear all data",selectionAll:"Select all data",sortTitle:"Sort",expand:"Expand row",collapse:"Collapse row",triggerDesc:"Click to sort descending",triggerAsc:"Click to sort ascending",cancelSort:"Click to cancel sorting"},Tour:{Next:"Next",Previous:"Previous",Finish:"Finish"},Modal:{okText:"OK",cancelText:"Cancel",justOkText:"OK"},Popconfirm:{okText:"OK",cancelText:"Cancel"},Transfer:{titles:["",""],searchPlaceholder:"Search here",itemUnit:"item",itemsUnit:"items",remove:"Remove",selectCurrent:"Select current page",removeCurrent:"Remove current page",selectAll:"Select all data",deselectAll:"Deselect all data",removeAll:"Remove all data",selectInvert:"Invert current page"},Upload:{uploading:"Uploading...",removeFile:"Remove file",uploadError:"Upload error",previewFile:"Preview file",downloadFile:"Download file"},Empty:{description:"No data"},Icon:{icon:"icon"},Text:{edit:"Edit",copy:"Copy",copied:"Copied",expand:"Expand",collapse:"Collapse"},Form:{optional:"(optional)",defaultValidateMessages:{default:"Field validation error for ${label}",required:"Please enter ${label}",enum:"${label} must be one of [${enum}]",whitespace:"${label} cannot be a blank character",date:{format:"${label} date format is invalid",parse:"${label} cannot be converted to a date",invalid:"${label} is an invalid date"},types:{string:zs,method:zs,array:zs,object:zs,number:zs,date:zs,boolean:zs,integer:zs,float:zs,regexp:zs,email:zs,url:zs,hex:zs},string:{len:"${label} must be ${len} characters",min:"${label} must be at least ${min} characters",max:"${label} must be up to ${max} characters",range:"${label} must be between ${min}-${max} characters"},number:{len:"${label} must be equal to ${len}",min:"${label} must be minimum ${min}",max:"${label} must be maximum ${max}",range:"${label} must be between ${min}-${max}"},array:{len:"Must be ${len} ${label}",min:"At least ${min} ${label}",max:"At most ${max} ${label}",range:"The amount of ${label} must be between ${min}-${max}"},pattern:{mismatch:"${label} does not match the pattern ${pattern}"}}},Image:{preview:"Preview"},QRCode:{expired:"QR code expired",refresh:"Refresh",scanned:"Scanned"},ColorPicker:{presetEmpty:"Empty",transparent:"Transparent",singleColor:"Single",gradientColor:"Gradient"}};Object.assign({},Ff.Modal);let Fy=[];const aH=()=>Fy.reduce((n,e)=>Object.assign(Object.assign({},n),e),Ff.Modal);function iie(n){if(n){const e=Object.assign({},n);return Fy.push(e),aH(),()=>{Fy=Fy.filter(t=>t!==e),aH()}}Object.assign({},Ff.Modal)}const IM=v.createContext(void 0),bb=(n,e)=>{const t=v.useContext(IM),i=v.useMemo(()=>{var o;const r=e||Ff[n],s=(o=t==null?void 0:t[n])!==null&&o!==void 0?o:{};return Object.assign(Object.assign({},typeof r=="function"?r():r),s||{})},[n,e,t]),a=v.useMemo(()=>{const o=t==null?void 0:t.locale;return t!=null&&t.exist&&!o?Ff.locale:o},[t]);return[i,a]},aie="internalMark",oie=n=>{const{locale:e={},children:t,_ANT_MARK__:i}=n;v.useEffect(()=>iie(e==null?void 0:e.Modal),[e]);const a=v.useMemo(()=>Object.assign(Object.assign({},e),{exist:!0}),[e]);return v.createElement(IM.Provider,{value:a},t)},yY={blue:"#1677FF",purple:"#722ED1",cyan:"#13C2C2",green:"#52C41A",magenta:"#EB2F96",pink:"#EB2F96",red:"#F5222D",orange:"#FA8C16",yellow:"#FADB14",volcano:"#FA541C",geekblue:"#2F54EB",gold:"#FAAD14",lime:"#A0D911"},Lp=Object.assign(Object.assign({},yY),{colorPrimary:"#1677ff",colorSuccess:"#52c41a",colorWarning:"#faad14",colorError:"#ff4d4f",colorInfo:"#1677ff",colorLink:"",colorTextBase:"",colorBgBase:"",fontFamily:`-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial,
'Noto Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol',
'Noto Color Emoji'`,fontFamilyCode:"'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, Courier, monospace",fontSize:14,lineWidth:1,lineType:"solid",motionUnit:.1,motionBase:0,motionEaseOutCirc:"cubic-bezier(0.08, 0.82, 0.17, 1)",motionEaseInOutCirc:"cubic-bezier(0.78, 0.14, 0.15, 0.86)",motionEaseOut:"cubic-bezier(0.215, 0.61, 0.355, 1)",motionEaseInOut:"cubic-bezier(0.645, 0.045, 0.355, 1)",motionEaseOutBack:"cubic-bezier(0.12, 0.4, 0.29, 1.46)",motionEaseInBack:"cubic-bezier(0.71, -0.46, 0.88, 0.6)",motionEaseInQuint:"cubic-bezier(0.755, 0.05, 0.855, 0.06)",motionEaseOutQuint:"cubic-bezier(0.23, 1, 0.32, 1)",borderRadius:6,sizeUnit:4,sizeStep:4,sizePopupArrow:16,controlHeight:32,zIndexBase:0,zIndexPopupBase:1e3,opacityImage:1,wireframe:!1,motion:!0}),Ro=Math.round;function Yw(n,e){const t=n.replace(/^[^(]*\((.*)/,"$1").replace(/\).*/,"").match(/\d*\.?\d+%?/g)||[],i=t.map(a=>parseFloat(a));for(let a=0;a<3;a+=1)i[a]=e(i[a]||0,t[a]||"",a);return t[3]?i[3]=t[3].includes("%")?i[3]/100:i[3]:i[3]=1,i}const oH=(n,e,t)=>t===0?n:n/100;function Fm(n,e){const t=e||255;return n>t?t:n<0?0:n}let ia=class BY{constructor(e){Ve(this,"isValid",!0),Ve(this,"r",0),Ve(this,"g",0),Ve(this,"b",0),Ve(this,"a",1),Ve(this,"_h",void 0),Ve(this,"_s",void 0),Ve(this,"_l",void 0),Ve(this,"_v",void 0),Ve(this,"_max",void 0),Ve(this,"_min",void 0),Ve(this,"_brightness",void 0);function t(a){return a[0]in e&&a[1]in e&&a[2]in e}if(e)if(typeof e=="string"){let o=function(r){return a.startsWith(r)};var i=o;const a=e.trim();/^#?[A-F\d]{3,8}$/i.test(a)?this.fromHexString(a):o("rgb")?this.fromRgbString(a):o("hsl")?this.fromHslString(a):(o("hsv")||o("hsb"))&&this.fromHsvString(a)}else if(e instanceof BY)this.r=e.r,this.g=e.g,this.b=e.b,this.a=e.a,this._h=e._h,this._s=e._s,this._l=e._l,this._v=e._v;else if(t("rgb"))this.r=Fm(e.r),this.g=Fm(e.g),this.b=Fm(e.b),this.a=typeof e.a=="number"?Fm(e.a,1):1;else if(t("hsl"))this.fromHsl(e);else if(t("hsv"))this.fromHsv(e);else throw new Error("@ant-design/fast-color: unsupported input "+JSON.stringify(e))}setR(e){return this._sc("r",e)}setG(e){return this._sc("g",e)}setB(e){return this._sc("b",e)}setA(e){return this._sc("a",e,1)}setHue(e){const t=this.toHsv();return t.h=e,this._c(t)}getLuminance(){function e(o){const r=o/255;return r<=.03928?r/12.92:Math.pow((r+.055)/1.055,2.4)}const t=e(this.r),i=e(this.g),a=e(this.b);return .2126*t+.7152*i+.0722*a}getHue(){if(typeof this._h>"u"){const e=this.getMax()-this.getMin();e===0?this._h=0:this._h=Ro(60*(this.r===this.getMax()?(this.g-this.b)/e+(this.g<this.b?6:0):this.g===this.getMax()?(this.b-this.r)/e+2:(this.r-this.g)/e+4))}return this._h}getSaturation(){if(typeof this._s>"u"){const e=this.getMax()-this.getMin();e===0?this._s=0:this._s=e/this.getMax()}return this._s}getLightness(){return typeof this._l>"u"&&(this._l=(this.getMax()+this.getMin())/510),this._l}getValue(){return typeof this._v>"u"&&(this._v=this.getMax()/255),this._v}getBrightness(){return typeof this._brightness>"u"&&(this._brightness=(this.r*299+this.g*587+this.b*114)/1e3),this._brightness}darken(e=10){const t=this.getHue(),i=this.getSaturation();let a=this.getLightness()-e/100;return a<0&&(a=0),this._c({h:t,s:i,l:a,a:this.a})}lighten(e=10){const t=this.getHue(),i=this.getSaturation();let a=this.getLightness()+e/100;return a>1&&(a=1),this._c({h:t,s:i,l:a,a:this.a})}mix(e,t=50){const i=this._c(e),a=t/100,o=s=>(i[s]-this[s])*a+this[s],r={r:Ro(o("r")),g:Ro(o("g")),b:Ro(o("b")),a:Ro(o("a")*100)/100};return this._c(r)}tint(e=10){return this.mix({r:255,g:255,b:255,a:1},e)}shade(e=10){return this.mix({r:0,g:0,b:0,a:1},e)}onBackground(e){const t=this._c(e),i=this.a+t.a*(1-this.a),a=o=>Ro((this[o]*this.a+t[o]*t.a*(1-this.a))/i);return this._c({r:a("r"),g:a("g"),b:a("b"),a:i})}isDark(){return this.getBrightness()<128}isLight(){return this.getBrightness()>=128}equals(e){return this.r===e.r&&this.g===e.g&&this.b===e.b&&this.a===e.a}clone(){return this._c(this)}toHexString(){let e="#";const t=(this.r||0).toString(16);e+=t.length===2?t:"0"+t;const i=(this.g||0).toString(16);e+=i.length===2?i:"0"+i;const a=(this.b||0).toString(16);if(e+=a.length===2?a:"0"+a,typeof this.a=="number"&&this.a>=0&&this.a<1){const o=Ro(this.a*255).toString(16);e+=o.length===2?o:"0"+o}return e}toHsl(){return{h:this.getHue(),s:this.getSaturation(),l:this.getLightness(),a:this.a}}toHslString(){const e=this.getHue(),t=Ro(this.getSaturation()*100),i=Ro(this.getLightness()*100);return this.a!==1?`hsla(${e},${t}%,${i}%,${this.a})`:`hsl(${e},${t}%,${i}%)`}toHsv(){return{h:this.getHue(),s:this.getSaturation(),v:this.getValue(),a:this.a}}toRgb(){return{r:this.r,g:this.g,b:this.b,a:this.a}}toRgbString(){return this.a!==1?`rgba(${this.r},${this.g},${this.b},${this.a})`:`rgb(${this.r},${this.g},${this.b})`}toString(){return this.toRgbString()}_sc(e,t,i){const a=this.clone();return a[e]=Fm(t,i),a}_c(e){return new this.constructor(e)}getMax(){return typeof this._max>"u"&&(this._max=Math.max(this.r,this.g,this.b)),this._max}getMin(){return typeof this._min>"u"&&(this._min=Math.min(this.r,this.g,this.b)),this._min}fromHexString(e){const t=e.replace("#","");function i(a,o){return parseInt(t[a]+t[o||a],16)}t.length<6?(this.r=i(0),this.g=i(1),this.b=i(2),this.a=t[3]?i(3)/255:1):(this.r=i(0,1),this.g=i(2,3),this.b=i(4,5),this.a=t[6]?i(6,7)/255:1)}fromHsl({h:e,s:t,l:i,a}){if(this._h=e%360,this._s=t,this._l=i,this.a=typeof a=="number"?a:1,t<=0){const h=Ro(i*255);this.r=h,this.g=h,this.b=h}let o=0,r=0,s=0;const l=e/60,c=(1-Math.abs(2*i-1))*t,u=c*(1-Math.abs(l%2-1));l>=0&&l<1?(o=c,r=u):l>=1&&l<2?(o=u,r=c):l>=2&&l<3?(r=c,s=u):l>=3&&l<4?(r=u,s=c):l>=4&&l<5?(o=u,s=c):l>=5&&l<6&&(o=c,s=u);const C=i-c/2;this.r=Ro((o+C)*255),this.g=Ro((r+C)*255),this.b=Ro((s+C)*255)}fromHsv({h:e,s:t,v:i,a}){this._h=e%360,this._s=t,this._v=i,this.a=typeof a=="number"?a:1;const o=Ro(i*255);if(this.r=o,this.g=o,this.b=o,t<=0)return;const r=e/60,s=Math.floor(r),l=r-s,c=Ro(i*(1-t)*255),u=Ro(i*(1-t*l)*255),C=Ro(i*(1-t*(1-l))*255);switch(s){case 0:this.g=C,this.b=c;break;case 1:this.r=u,this.b=c;break;case 2:this.r=c,this.b=C;break;case 3:this.r=c,this.g=u;break;case 4:this.r=C,this.g=c;break;case 5:default:this.g=c,this.b=u;break}}fromHsvString(e){const t=Yw(e,oH);this.fromHsv({h:t[0],s:t[1],v:t[2],a:t[3]})}fromHslString(e){const t=Yw(e,oH);this.fromHsl({h:t[0],s:t[1],l:t[2],a:t[3]})}fromRgbString(e){const t=Yw(e,(i,a)=>a.includes("%")?Ro(i/100*255):i);this.r=t[0],this.g=t[1],this.b=t[2],this.a=t[3]}};var $v=2,rH=.16,rie=.05,sie=.05,lie=.15,GY=5,SY=4,cie=[{index:7,amount:15},{index:6,amount:25},{index:5,amount:30},{index:5,amount:45},{index:5,amount:65},{index:5,amount:85},{index:4,amount:90},{index:3,amount:95},{index:2,amount:97},{index:1,amount:98}];function sH(n,e,t){var i;return Math.round(n.h)>=60&&Math.round(n.h)<=240?i=t?Math.round(n.h)-$v*e:Math.round(n.h)+$v*e:i=t?Math.round(n.h)+$v*e:Math.round(n.h)-$v*e,i<0?i+=360:i>=360&&(i-=360),i}function lH(n,e,t){if(n.h===0&&n.s===0)return n.s;var i;return t?i=n.s-rH*e:e===SY?i=n.s+rH:i=n.s+rie*e,i>1&&(i=1),t&&e===GY&&i>.1&&(i=.1),i<.06&&(i=.06),Math.round(i*100)/100}function cH(n,e,t){var i;return t?i=n.v+sie*e:i=n.v-lie*e,i=Math.max(0,Math.min(1,i)),Math.round(i*100)/100}function _p(n){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=[],i=new ia(n),a=i.toHsv(),o=GY;o>0;o-=1){var r=new ia({h:sH(a,o,!0),s:lH(a,o,!0),v:cH(a,o,!0)});t.push(r)}t.push(i);for(var s=1;s<=SY;s+=1){var l=new ia({h:sH(a,s),s:lH(a,s),v:cH(a,s)});t.push(l)}return e.theme==="dark"?cie.map(function(c){var u=c.index,C=c.amount;return new ia(e.backgroundColor||"#141414").mix(t[u],C).toHexString()}):t.map(function(c){return c.toHexString()})}var zw={red:"#F5222D",volcano:"#FA541C",orange:"#FA8C16",gold:"#FAAD14",yellow:"#FADB14",lime:"#A0D911",green:"#52C41A",cyan:"#13C2C2",blue:"#1677FF",geekblue:"#2F54EB",purple:"#722ED1",magenta:"#EB2F96",grey:"#666666"},xR=["#fff1f0","#ffccc7","#ffa39e","#ff7875","#ff4d4f","#f5222d","#cf1322","#a8071a","#820014","#5c0011"];xR.primary=xR[5];var MR=["#fff2e8","#ffd8bf","#ffbb96","#ff9c6e","#ff7a45","#fa541c","#d4380d","#ad2102","#871400","#610b00"];MR.primary=MR[5];var WR=["#fff7e6","#ffe7ba","#ffd591","#ffc069","#ffa940","#fa8c16","#d46b08","#ad4e00","#873800","#612500"];WR.primary=WR[5];var LB=["#fffbe6","#fff1b8","#ffe58f","#ffd666","#ffc53d","#faad14","#d48806","#ad6800","#874d00","#613400"];LB.primary=LB[5];var VR=["#feffe6","#ffffb8","#fffb8f","#fff566","#ffec3d","#fadb14","#d4b106","#ad8b00","#876800","#614700"];VR.primary=VR[5];var NR=["#fcffe6","#f4ffb8","#eaff8f","#d3f261","#bae637","#a0d911","#7cb305","#5b8c00","#3f6600","#254000"];NR.primary=NR[5];var ER=["#f6ffed","#d9f7be","#b7eb8f","#95de64","#73d13d","#52c41a","#389e0d","#237804","#135200","#092b00"];ER.primary=ER[5];var HR=["#e6fffb","#b5f5ec","#87e8de","#5cdbd3","#36cfc9","#13c2c2","#08979c","#006d75","#00474f","#002329"];HR.primary=HR[5];var _B=["#e6f4ff","#bae0ff","#91caff","#69b1ff","#4096ff","#1677ff","#0958d9","#003eb3","#002c8c","#001d66"];_B.primary=_B[5];var FR=["#f0f5ff","#d6e4ff","#adc6ff","#85a5ff","#597ef7","#2f54eb","#1d39c4","#10239e","#061178","#030852"];FR.primary=FR[5];var XR=["#f9f0ff","#efdbff","#d3adf7","#b37feb","#9254de","#722ed1","#531dab","#391085","#22075e","#120338"];XR.primary=XR[5];var TR=["#fff0f6","#ffd6e7","#ffadd2","#ff85c0","#f759ab","#eb2f96","#c41d7f","#9e1068","#780650","#520339"];TR.primary=TR[5];var YR=["#a6a6a6","#999999","#8c8c8c","#808080","#737373","#666666","#404040","#1a1a1a","#000000","#000000"];YR.primary=YR[5];var Kw={red:xR,volcano:MR,orange:WR,gold:LB,yellow:VR,lime:NR,green:ER,cyan:HR,blue:_B,geekblue:FR,purple:XR,magenta:TR,grey:YR};function gie(n,e){let{generateColorPalettes:t,generateNeutralColorPalettes:i}=e;const{colorSuccess:a,colorWarning:o,colorError:r,colorInfo:s,colorPrimary:l,colorBgBase:c,colorTextBase:u}=n,C=t(l),h=t(a),m=t(o),p=t(r),B=t(s),b=i(c,u),y=n.colorLink||n.colorInfo,S=t(y),R=new ia(p[1]).mix(new ia(p[3]),50).toHexString();return Object.assign(Object.assign({},b),{colorPrimaryBg:C[1],colorPrimaryBgHover:C[2],colorPrimaryBorder:C[3],colorPrimaryBorderHover:C[4],colorPrimaryHover:C[5],colorPrimary:C[6],colorPrimaryActive:C[7],colorPrimaryTextHover:C[8],colorPrimaryText:C[9],colorPrimaryTextActive:C[10],colorSuccessBg:h[1],colorSuccessBgHover:h[2],colorSuccessBorder:h[3],colorSuccessBorderHover:h[4],colorSuccessHover:h[4],colorSuccess:h[6],colorSuccessActive:h[7],colorSuccessTextHover:h[8],colorSuccessText:h[9],colorSuccessTextActive:h[10],colorErrorBg:p[1],colorErrorBgHover:p[2],colorErrorBgFilledHover:R,colorErrorBgActive:p[3],colorErrorBorder:p[3],colorErrorBorderHover:p[4],colorErrorHover:p[5],colorError:p[6],colorErrorActive:p[7],colorErrorTextHover:p[8],colorErrorText:p[9],colorErrorTextActive:p[10],colorWarningBg:m[1],colorWarningBgHover:m[2],colorWarningBorder:m[3],colorWarningBorderHover:m[4],colorWarningHover:m[4],colorWarning:m[6],colorWarningActive:m[7],colorWarningTextHover:m[8],colorWarningText:m[9],colorWarningTextActive:m[10],colorInfoBg:B[1],colorInfoBgHover:B[2],colorInfoBorder:B[3],colorInfoBorderHover:B[4],colorInfoHover:B[4],colorInfo:B[6],colorInfoActive:B[7],colorInfoTextHover:B[8],colorInfoText:B[9],colorInfoTextActive:B[10],colorLinkHover:S[4],colorLink:S[6],colorLinkActive:S[7],colorBgMask:new ia("#000").setA(.45).toRgbString(),colorWhite:"#fff"})}const uie=n=>{let e=n,t=n,i=n,a=n;return n<6&&n>=5?e=n+1:n<16&&n>=6?e=n+2:n>=16&&(e=16),n<7&&n>=5?t=4:n<8&&n>=7?t=5:n<14&&n>=8?t=6:n<16&&n>=14?t=7:n>=16&&(t=8),n<6&&n>=2?i=1:n>=6&&(i=2),n>4&&n<8?a=4:n>=8&&(a=6),{borderRadius:n,borderRadiusXS:i,borderRadiusSM:t,borderRadiusLG:e,borderRadiusOuter:a}};function die(n){const{motionUnit:e,motionBase:t,borderRadius:i,lineWidth:a}=n;return Object.assign({motionDurationFast:`${(t+e).toFixed(1)}s`,motionDurationMid:`${(t+e*2).toFixed(1)}s`,motionDurationSlow:`${(t+e*3).toFixed(1)}s`,lineWidthBold:a+1},uie(i))}const Cie=n=>{const{controlHeight:e}=n;return{controlHeightSM:e*.75,controlHeightXS:e*.5,controlHeightLG:e*1.25}};function Xy(n){return(n+8)/n}function Iie(n){const e=Array.from({length:10}).map((t,i)=>{const a=i-1,o=n*Math.pow(Math.E,a/5),r=i>1?Math.floor(o):Math.ceil(o);return Math.floor(r/2)*2});return e[1]=n,e.map(t=>({size:t,lineHeight:Xy(t)}))}const hie=n=>{const e=Iie(n),t=e.map(u=>u.size),i=e.map(u=>u.lineHeight),a=t[1],o=t[0],r=t[2],s=i[1],l=i[0],c=i[2];return{fontSizeSM:o,fontSize:a,fontSizeLG:r,fontSizeXL:t[3],fontSizeHeading1:t[6],fontSizeHeading2:t[5],fontSizeHeading3:t[4],fontSizeHeading4:t[3],fontSizeHeading5:t[2],lineHeight:s,lineHeightLG:c,lineHeightSM:l,fontHeight:Math.round(s*a),fontHeightLG:Math.round(c*r),fontHeightSM:Math.round(l*o),lineHeightHeading1:i[6],lineHeightHeading2:i[5],lineHeightHeading3:i[4],lineHeightHeading4:i[3],lineHeightHeading5:i[2]}};function fie(n){const{sizeUnit:e,sizeStep:t}=n;return{sizeXXL:e*(t+8),sizeXL:e*(t+4),sizeLG:e*(t+2),sizeMD:e*(t+1),sizeMS:e*t,size:e*t,sizeSM:e*(t-1),sizeXS:e*(t-2),sizeXXS:e*(t-3)}}const Il=(n,e)=>new ia(n).setA(e).toRgbString(),Xm=(n,e)=>new ia(n).darken(e).toHexString(),Aie=n=>{const e=_p(n);return{1:e[0],2:e[1],3:e[2],4:e[3],5:e[4],6:e[5],7:e[6],8:e[4],9:e[5],10:e[6]}},mie=(n,e)=>{const t=n||"#fff",i=e||"#000";return{colorBgBase:t,colorTextBase:i,colorText:Il(i,.88),colorTextSecondary:Il(i,.65),colorTextTertiary:Il(i,.45),colorTextQuaternary:Il(i,.25),colorFill:Il(i,.15),colorFillSecondary:Il(i,.06),colorFillTertiary:Il(i,.04),colorFillQuaternary:Il(i,.02),colorBgSolid:Il(i,1),colorBgSolidHover:Il(i,.75),colorBgSolidActive:Il(i,.95),colorBgLayout:Xm(t,4),colorBgContainer:Xm(t,0),colorBgElevated:Xm(t,0),colorBgSpotlight:Il(i,.85),colorBgBlur:"transparent",colorBorder:Xm(t,15),colorBorderSecondary:Xm(t,6)}};function pie(n){zw.pink=zw.magenta,Kw.pink=Kw.magenta;const e=Object.keys(yY).map(t=>{const i=n[t]===zw[t]?Kw[t]:_p(n[t]);return Array.from({length:10},()=>1).reduce((a,o,r)=>(a[`${t}-${r+1}`]=i[r],a[`${t}${r+1}`]=i[r],a),{})}).reduce((t,i)=>(t=Object.assign(Object.assign({},t),i),t),{});return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},n),e),gie(n,{generateColorPalettes:Aie,generateNeutralColorPalettes:mie})),hie(n.fontSize)),fie(n)),Cie(n)),die(n))}const wY=BR(pie),zR={token:Lp,override:{override:Lp},hashed:!0},RY=Ct.createContext(zR),DB="ant",hM="anticon",bie=["outlined","borderless","filled","underlined"],vie=(n,e)=>e||(n?`${DB}-${n}`:DB),ui=v.createContext({getPrefixCls:vie,iconPrefixCls:hM}),{Consumer:Upe}=ui,gH={};function Gs(n){const e=v.useContext(ui),{getPrefixCls:t,direction:i,getPopupContainer:a}=e,o=e[n];return Object.assign(Object.assign({classNames:gH,styles:gH},o),{getPrefixCls:t,direction:i,getPopupContainer:a})}const yie=`-ant-${Date.now()}-${Math.random()}`;function Bie(n,e){const t={},i=(r,s)=>{let l=r.clone();return l=(s==null?void 0:s(l))||l,l.toRgbString()},a=(r,s)=>{const l=new ia(r),c=_p(l.toRgbString());t[`${s}-color`]=i(l),t[`${s}-color-disabled`]=c[1],t[`${s}-color-hover`]=c[4],t[`${s}-color-active`]=c[6],t[`${s}-color-outline`]=l.clone().setA(.2).toRgbString(),t[`${s}-color-deprecated-bg`]=c[0],t[`${s}-color-deprecated-border`]=c[2]};if(e.primaryColor){a(e.primaryColor,"primary");const r=new ia(e.primaryColor),s=_p(r.toRgbString());s.forEach((c,u)=>{t[`primary-${u+1}`]=c}),t["primary-color-deprecated-l-35"]=i(r,c=>c.lighten(35)),t["primary-color-deprecated-l-20"]=i(r,c=>c.lighten(20)),t["primary-color-deprecated-t-20"]=i(r,c=>c.tint(20)),t["primary-color-deprecated-t-50"]=i(r,c=>c.tint(50)),t["primary-color-deprecated-f-12"]=i(r,c=>c.setA(c.a*.12));const l=new ia(s[0]);t["primary-color-active-deprecated-f-30"]=i(l,c=>c.setA(c.a*.3)),t["primary-color-active-deprecated-d-02"]=i(l,c=>c.darken(2))}return e.successColor&&a(e.successColor,"success"),e.warningColor&&a(e.warningColor,"warning"),e.errorColor&&a(e.errorColor,"error"),e.infoColor&&a(e.infoColor,"info"),`
  :root {
    ${Object.keys(t).map(r=>`--${n}-${r}: ${t[r]};`).join(`
`)}
  }
  `.trim()}function Gie(n,e){const t=Bie(n,e);kr()&&lu(t,`${yie}-dynamic-theme`)}const hg=v.createContext(!1),Sie=n=>{let{children:e,disabled:t}=n;const i=v.useContext(hg);return v.createElement(hg.Provider,{value:t??i},e)},Xf=v.createContext(void 0),wie=n=>{let{children:e,size:t}=n;const i=v.useContext(Xf);return v.createElement(Xf.Provider,{value:t||i},e)};function Rie(){const n=v.useContext(hg),e=v.useContext(Xf);return{componentDisabled:n,componentSize:e}}var ZY=no(function n(){to(this,n)}),xY="CALC_UNIT",Zie=new RegExp(xY,"g");function Lw(n){return typeof n=="number"?"".concat(n).concat(xY):n}var xie=function(n){Iu(t,n);var e=hu(t);function t(i,a){var o;to(this,t),o=e.call(this),Ve(si(o),"result",""),Ve(si(o),"unitlessCssVar",void 0),Ve(si(o),"lowPriority",void 0);var r=Bn(i);return o.unitlessCssVar=a,i instanceof t?o.result="(".concat(i.result,")"):r==="number"?o.result=Lw(i):r==="string"&&(o.result=i),o}return no(t,[{key:"add",value:function(a){return a instanceof t?this.result="".concat(this.result," + ").concat(a.getResult()):(typeof a=="number"||typeof a=="string")&&(this.result="".concat(this.result," + ").concat(Lw(a))),this.lowPriority=!0,this}},{key:"sub",value:function(a){return a instanceof t?this.result="".concat(this.result," - ").concat(a.getResult()):(typeof a=="number"||typeof a=="string")&&(this.result="".concat(this.result," - ").concat(Lw(a))),this.lowPriority=!0,this}},{key:"mul",value:function(a){return this.lowPriority&&(this.result="(".concat(this.result,")")),a instanceof t?this.result="".concat(this.result," * ").concat(a.getResult(!0)):(typeof a=="number"||typeof a=="string")&&(this.result="".concat(this.result," * ").concat(a)),this.lowPriority=!1,this}},{key:"div",value:function(a){return this.lowPriority&&(this.result="(".concat(this.result,")")),a instanceof t?this.result="".concat(this.result," / ").concat(a.getResult(!0)):(typeof a=="number"||typeof a=="string")&&(this.result="".concat(this.result," / ").concat(a)),this.lowPriority=!1,this}},{key:"getResult",value:function(a){return this.lowPriority||a?"(".concat(this.result,")"):this.result}},{key:"equal",value:function(a){var o=this,r=a||{},s=r.unit,l=!0;return typeof s=="boolean"?l=s:Array.from(this.unitlessCssVar).some(function(c){return o.result.includes(c)})&&(l=!1),this.result=this.result.replace(Zie,l?"px":""),typeof this.lowPriority<"u"?"calc(".concat(this.result,")"):this.result}}]),t}(ZY),Mie=function(n){Iu(t,n);var e=hu(t);function t(i){var a;return to(this,t),a=e.call(this),Ve(si(a),"result",0),i instanceof t?a.result=i.result:typeof i=="number"&&(a.result=i),a}return no(t,[{key:"add",value:function(a){return a instanceof t?this.result+=a.result:typeof a=="number"&&(this.result+=a),this}},{key:"sub",value:function(a){return a instanceof t?this.result-=a.result:typeof a=="number"&&(this.result-=a),this}},{key:"mul",value:function(a){return a instanceof t?this.result*=a.result:typeof a=="number"&&(this.result*=a),this}},{key:"div",value:function(a){return a instanceof t?this.result/=a.result:typeof a=="number"&&(this.result/=a),this}},{key:"equal",value:function(){return this.result}}]),t}(ZY),Wie=function(e,t){var i=e==="css"?xie:Mie;return function(a){return new i(a,t)}},uH=function(e,t){return"".concat([t,e.replace(/([A-Z]+)([A-Z][a-z]+)/g,"$1-$2").replace(/([a-z])([A-Z])/g,"$1-$2")].filter(Boolean).join("-"))};function Aa(n){var e=v.useRef();e.current=n;var t=v.useCallback(function(){for(var i,a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(i=e.current)===null||i===void 0?void 0:i.call.apply(i,[e].concat(o))},[]);return t}function Dp(n){var e=v.useRef(!1),t=v.useState(n),i=rt(t,2),a=i[0],o=i[1];v.useEffect(function(){return e.current=!1,function(){e.current=!0}},[]);function r(s,l){l&&e.current||o(s)}return[a,r]}function _w(n){return n!==void 0}function _a(n,e){var t=e||{},i=t.defaultValue,a=t.value,o=t.onChange,r=t.postState,s=Dp(function(){return _w(a)?a:_w(i)?typeof i=="function"?i():i:typeof n=="function"?n():n}),l=rt(s,2),c=l[0],u=l[1],C=a!==void 0?a:c,h=r?r(C):C,m=Aa(o),p=Dp([C]),B=rt(p,2),b=B[0],y=B[1];SR(function(){var R=b[0];c!==R&&m(c,R)},[b]),SR(function(){_w(a)||u(a)},[a]);var S=Aa(function(R,Z){u(R,Z),y([C],Z)});return[h,S]}function dH(n,e,t,i){var a=Ke({},e[n]);if(i!=null&&i.deprecatedTokens){var o=i.deprecatedTokens;o.forEach(function(s){var l=rt(s,2),c=l[0],u=l[1];if(a!=null&&a[c]||a!=null&&a[u]){var C;(C=a[u])!==null&&C!==void 0||(a[u]=a==null?void 0:a[c])}})}var r=Ke(Ke({},t),a);return Object.keys(r).forEach(function(s){r[s]===e[s]&&delete r[s]}),r}var MY=typeof CSSINJS_STATISTIC<"u",KR=!0;function Xi(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];if(!MY)return Object.assign.apply(Object,[{}].concat(e));KR=!1;var i={};return e.forEach(function(a){if(Bn(a)==="object"){var o=Object.keys(a);o.forEach(function(r){Object.defineProperty(i,r,{configurable:!0,enumerable:!0,get:function(){return a[r]}})})}}),KR=!0,i}var CH={};function Vie(){}var Nie=function(e){var t,i=e,a=Vie;return MY&&typeof Proxy<"u"&&(t=new Set,i=new Proxy(e,{get:function(r,s){if(KR){var l;(l=t)===null||l===void 0||l.add(s)}return r[s]}}),a=function(r,s){var l;CH[r]={global:Array.from(t),component:Ke(Ke({},(l=CH[r])===null||l===void 0?void 0:l.component),s)}}),{token:i,keys:t,flush:a}};function IH(n,e,t){if(typeof t=="function"){var i;return t(Xi(e,(i=e[n])!==null&&i!==void 0?i:{}))}return t??{}}function Eie(n){return n==="js"?{max:Math.max,min:Math.min}:{max:function(){for(var t=arguments.length,i=new Array(t),a=0;a<t;a++)i[a]=arguments[a];return"max(".concat(i.map(function(o){return st(o)}).join(","),")")},min:function(){for(var t=arguments.length,i=new Array(t),a=0;a<t;a++)i[a]=arguments[a];return"min(".concat(i.map(function(o){return st(o)}).join(","),")")}}}var Hie=1e3*60*10,Fie=function(){function n(){to(this,n),Ve(this,"map",new Map),Ve(this,"objectIDMap",new WeakMap),Ve(this,"nextID",0),Ve(this,"lastAccessBeat",new Map),Ve(this,"accessBeat",0)}return no(n,[{key:"set",value:function(t,i){this.clear();var a=this.getCompositeKey(t);this.map.set(a,i),this.lastAccessBeat.set(a,Date.now())}},{key:"get",value:function(t){var i=this.getCompositeKey(t),a=this.map.get(i);return this.lastAccessBeat.set(i,Date.now()),this.accessBeat+=1,a}},{key:"getCompositeKey",value:function(t){var i=this,a=t.map(function(o){return o&&Bn(o)==="object"?"obj_".concat(i.getObjectID(o)):"".concat(Bn(o),"_").concat(o)});return a.join("|")}},{key:"getObjectID",value:function(t){if(this.objectIDMap.has(t))return this.objectIDMap.get(t);var i=this.nextID;return this.objectIDMap.set(t,i),this.nextID+=1,i}},{key:"clear",value:function(){var t=this;if(this.accessBeat>1e4){var i=Date.now();this.lastAccessBeat.forEach(function(a,o){i-a>Hie&&(t.map.delete(o),t.lastAccessBeat.delete(o))}),this.accessBeat=0}}}]),n}(),hH=new Fie;function Xie(n,e){return Ct.useMemo(function(){var t=hH.get(e);if(t)return t;var i=n();return hH.set(e,i),i},e)}var Tie=function(){return{}};function Yie(n){var e=n.useCSP,t=e===void 0?Tie:e,i=n.useToken,a=n.usePrefix,o=n.getResetStyles,r=n.getCommonStyle,s=n.getCompUnitless;function l(h,m,p,B){var b=Array.isArray(h)?h[0]:h;function y(F){return"".concat(String(b)).concat(F.slice(0,1).toUpperCase()).concat(F.slice(1))}var S=(B==null?void 0:B.unitless)||{},R=typeof s=="function"?s(h):{},Z=Ke(Ke({},R),{},Ve({},y("zIndexPopup"),!0));Object.keys(S).forEach(function(F){Z[y(F)]=S[F]});var x=Ke(Ke({},B),{},{unitless:Z,prefixToken:y}),M=u(h,m,p,x),E=c(b,p,x);return function(F){var N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:F,H=M(F,N),z=rt(H,2),_=z[1],D=E(N),P=rt(D,2),$=P[0],X=P[1];return[$,_,X]}}function c(h,m,p){var B=p.unitless,b=p.injectStyle,y=b===void 0?!0:b,S=p.prefixToken,R=p.ignore,Z=function(E){var F=E.rootCls,N=E.cssVar,H=N===void 0?{}:N,z=i(),_=z.realToken;return Pne({path:[h],prefix:H.prefix,key:H.key,unitless:B,ignore:R,token:_,scope:F},function(){var D=IH(h,_,m),P=dH(h,_,D,{deprecatedTokens:p==null?void 0:p.deprecatedTokens});return Object.keys(D).forEach(function($){P[S($)]=P[$],delete P[$]}),P}),null},x=function(E){var F=i(),N=F.cssVar;return[function(H){return y&&N?Ct.createElement(Ct.Fragment,null,Ct.createElement(Z,{rootCls:E,cssVar:N,component:h}),H):H},N==null?void 0:N.key]};return x}function u(h,m,p){var B=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},b=Array.isArray(h)?h:[h,h],y=rt(b,1),S=y[0],R=b.join("-"),Z=n.layer||{name:"antd"};return function(x){var M=arguments.length>1&&arguments[1]!==void 0?arguments[1]:x,E=i(),F=E.theme,N=E.realToken,H=E.hashId,z=E.token,_=E.cssVar,D=a(),P=D.rootPrefixCls,$=D.iconPrefixCls,X=t(),L=_?"css":"js",U=Xie(function(){var k=new Set;return _&&Object.keys(B.unitless||{}).forEach(function(ie){k.add(Wy(ie,_.prefix)),k.add(Wy(ie,uH(S,_.prefix)))}),Wie(L,k)},[L,S,_==null?void 0:_.prefix]),q=Eie(L),K=q.max,O=q.min,j={theme:F,token:z,hashId:H,nonce:function(){return X.nonce},clientOnly:B.clientOnly,layer:Z,order:B.order||-999};typeof o=="function"&&ZR(Ke(Ke({},j),{},{clientOnly:!1,path:["Shared",P]}),function(){return o(z,{prefix:{rootPrefixCls:P,iconPrefixCls:$},csp:X})});var ne=ZR(Ke(Ke({},j),{},{path:[R,x,$]}),function(){if(B.injectStyle===!1)return[];var k=Nie(z),ie=k.token,re=k.flush,ge=IH(S,N,p),de=".".concat(x),xe=dH(S,N,ge,{deprecatedTokens:B.deprecatedTokens});_&&ge&&Bn(ge)==="object"&&Object.keys(ge).forEach(function(Te){ge[Te]="var(".concat(Wy(Te,uH(S,_.prefix)),")")});var Ne=Xi(ie,{componentCls:de,prefixCls:x,iconCls:".".concat($),antCls:".".concat(P),calc:U,max:K,min:O},_?ge:xe),ye=m(Ne,{hashId:H,prefixCls:x,rootPrefixCls:P,iconPrefixCls:$});re(S,xe);var pe=typeof r=="function"?r(Ne,x,M,B.resetFont):null;return[B.resetStyle===!1?null:pe,ye]});return[ne,H]}}function C(h,m,p){var B=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},b=u(h,m,p,Ke({resetStyle:!1,order:-998},B)),y=function(R){var Z=R.prefixCls,x=R.rootCls,M=x===void 0?Z:x;return b(Z,M),null};return y}return{genStyleHooks:l,genSubStyleComponent:C,genComponentStyleHook:u}}const CI=["blue","purple","cyan","green","magenta","pink","red","orange","yellow","volcano","geekblue","lime","gold"],zie="5.24.6";function Dw(n){return n>=0&&n<=255}function qm(n,e){const{r:t,g:i,b:a,a:o}=new ia(n).toRgb();if(o<1)return n;const{r,g:s,b:l}=new ia(e).toRgb();for(let c=.01;c<=1;c+=.01){const u=Math.round((t-r*(1-c))/c),C=Math.round((i-s*(1-c))/c),h=Math.round((a-l*(1-c))/c);if(Dw(u)&&Dw(C)&&Dw(h))return new ia({r:u,g:C,b:h,a:Math.round(c*100)/100}).toRgbString()}return new ia({r:t,g:i,b:a,a:1}).toRgbString()}var Kie=function(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(n);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(n,i[a])&&(t[i[a]]=n[i[a]]);return t};function WY(n){const{override:e}=n,t=Kie(n,["override"]),i=Object.assign({},e);Object.keys(Lp).forEach(h=>{delete i[h]});const a=Object.assign(Object.assign({},t),i),o=480,r=576,s=768,l=992,c=1200,u=1600;if(a.motion===!1){const h="0s";a.motionDurationFast=h,a.motionDurationMid=h,a.motionDurationSlow=h}return Object.assign(Object.assign(Object.assign({},a),{colorFillContent:a.colorFillSecondary,colorFillContentHover:a.colorFill,colorFillAlter:a.colorFillQuaternary,colorBgContainerDisabled:a.colorFillTertiary,colorBorderBg:a.colorBgContainer,colorSplit:qm(a.colorBorderSecondary,a.colorBgContainer),colorTextPlaceholder:a.colorTextQuaternary,colorTextDisabled:a.colorTextQuaternary,colorTextHeading:a.colorText,colorTextLabel:a.colorTextSecondary,colorTextDescription:a.colorTextTertiary,colorTextLightSolid:a.colorWhite,colorHighlight:a.colorError,colorBgTextHover:a.colorFillSecondary,colorBgTextActive:a.colorFill,colorIcon:a.colorTextTertiary,colorIconHover:a.colorText,colorErrorOutline:qm(a.colorErrorBg,a.colorBgContainer),colorWarningOutline:qm(a.colorWarningBg,a.colorBgContainer),fontSizeIcon:a.fontSizeSM,lineWidthFocus:a.lineWidth*3,lineWidth:a.lineWidth,controlOutlineWidth:a.lineWidth*2,controlInteractiveSize:a.controlHeight/2,controlItemBgHover:a.colorFillTertiary,controlItemBgActive:a.colorPrimaryBg,controlItemBgActiveHover:a.colorPrimaryBgHover,controlItemBgActiveDisabled:a.colorFill,controlTmpOutline:a.colorFillQuaternary,controlOutline:qm(a.colorPrimaryBg,a.colorBgContainer),lineType:a.lineType,borderRadius:a.borderRadius,borderRadiusXS:a.borderRadiusXS,borderRadiusSM:a.borderRadiusSM,borderRadiusLG:a.borderRadiusLG,fontWeightStrong:600,opacityLoading:.65,linkDecoration:"none",linkHoverDecoration:"none",linkFocusDecoration:"none",controlPaddingHorizontal:12,controlPaddingHorizontalSM:8,paddingXXS:a.sizeXXS,paddingXS:a.sizeXS,paddingSM:a.sizeSM,padding:a.size,paddingMD:a.sizeMD,paddingLG:a.sizeLG,paddingXL:a.sizeXL,paddingContentHorizontalLG:a.sizeLG,paddingContentVerticalLG:a.sizeMS,paddingContentHorizontal:a.sizeMS,paddingContentVertical:a.sizeSM,paddingContentHorizontalSM:a.size,paddingContentVerticalSM:a.sizeXS,marginXXS:a.sizeXXS,marginXS:a.sizeXS,marginSM:a.sizeSM,margin:a.size,marginMD:a.sizeMD,marginLG:a.sizeLG,marginXL:a.sizeXL,marginXXL:a.sizeXXL,boxShadow:`
      0 6px 16px 0 rgba(0, 0, 0, 0.08),
      0 3px 6px -4px rgba(0, 0, 0, 0.12),
      0 9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowSecondary:`
      0 6px 16px 0 rgba(0, 0, 0, 0.08),
      0 3px 6px -4px rgba(0, 0, 0, 0.12),
      0 9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowTertiary:`
      0 1px 2px 0 rgba(0, 0, 0, 0.03),
      0 1px 6px -1px rgba(0, 0, 0, 0.02),
      0 2px 4px 0 rgba(0, 0, 0, 0.02)
    `,screenXS:o,screenXSMin:o,screenXSMax:r-1,screenSM:r,screenSMMin:r,screenSMMax:s-1,screenMD:s,screenMDMin:s,screenMDMax:l-1,screenLG:l,screenLGMin:l,screenLGMax:c-1,screenXL:c,screenXLMin:c,screenXLMax:u-1,screenXXL:u,screenXXLMin:u,boxShadowPopoverArrow:"2px 2px 5px rgba(0, 0, 0, 0.05)",boxShadowCard:`
      0 1px 2px -2px ${new ia("rgba(0, 0, 0, 0.16)").toRgbString()},
      0 3px 6px 0 ${new ia("rgba(0, 0, 0, 0.12)").toRgbString()},
      0 5px 12px 4px ${new ia("rgba(0, 0, 0, 0.09)").toRgbString()}
    `,boxShadowDrawerRight:`
      -6px 0 16px 0 rgba(0, 0, 0, 0.08),
      -3px 0 6px -4px rgba(0, 0, 0, 0.12),
      -9px 0 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowDrawerLeft:`
      6px 0 16px 0 rgba(0, 0, 0, 0.08),
      3px 0 6px -4px rgba(0, 0, 0, 0.12),
      9px 0 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowDrawerUp:`
      0 6px 16px 0 rgba(0, 0, 0, 0.08),
      0 3px 6px -4px rgba(0, 0, 0, 0.12),
      0 9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowDrawerDown:`
      0 -6px 16px 0 rgba(0, 0, 0, 0.08),
      0 -3px 6px -4px rgba(0, 0, 0, 0.12),
      0 -9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowTabsOverflowLeft:"inset 10px 0 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowRight:"inset -10px 0 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowTop:"inset 0 10px 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowBottom:"inset 0 -10px 8px -8px rgba(0, 0, 0, 0.08)"}),i)}var fH=function(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(n);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(n,i[a])&&(t[i[a]]=n[i[a]]);return t};const VY={lineHeight:!0,lineHeightSM:!0,lineHeightLG:!0,lineHeightHeading1:!0,lineHeightHeading2:!0,lineHeightHeading3:!0,lineHeightHeading4:!0,lineHeightHeading5:!0,opacityLoading:!0,fontWeightStrong:!0,zIndexPopupBase:!0,zIndexBase:!0,opacityImage:!0},Lie={size:!0,sizeSM:!0,sizeLG:!0,sizeMD:!0,sizeXS:!0,sizeXXS:!0,sizeMS:!0,sizeXL:!0,sizeXXL:!0,sizeUnit:!0,sizeStep:!0,motionBase:!0,motionUnit:!0},_ie={screenXS:!0,screenXSMin:!0,screenXSMax:!0,screenSM:!0,screenSMMin:!0,screenSMMax:!0,screenMD:!0,screenMDMin:!0,screenMDMax:!0,screenLG:!0,screenLGMin:!0,screenLGMax:!0,screenXL:!0,screenXLMin:!0,screenXLMax:!0,screenXXL:!0,screenXXLMin:!0},NY=(n,e,t)=>{const i=t.getDerivativeToken(n),{override:a}=e,o=fH(e,["override"]);let r=Object.assign(Object.assign({},i),{override:a});return r=WY(r),o&&Object.entries(o).forEach(s=>{let[l,c]=s;const{theme:u}=c,C=fH(c,["theme"]);let h=C;u&&(h=NY(Object.assign(Object.assign({},r),C),{override:C},u)),r[l]=h}),r};function ks(){const{token:n,hashed:e,theme:t,override:i,cssVar:a}=Ct.useContext(RY),o=`${zie}-${e||""}`,r=t||wY,[s,l,c]=bne(r,[Lp,n],{salt:o,override:i,getComputedToken:NY,formatToken:WY,cssVar:a&&{prefix:a.prefix,key:a.key,unitless:VY,ignore:Lie,preserve:_ie}});return[r,c,e?l:"",s,a]}const Tf={overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},Po=function(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return{boxSizing:"border-box",margin:0,padding:0,color:n.colorText,fontSize:n.fontSize,lineHeight:n.lineHeight,listStyle:"none",fontFamily:e?"inherit":n.fontFamily}},nS=()=>({display:"inline-flex",alignItems:"center",color:"inherit",fontStyle:"normal",lineHeight:0,textAlign:"center",textTransform:"none",verticalAlign:"-0.125em",textRendering:"optimizeLegibility","-webkit-font-smoothing":"antialiased","-moz-osx-font-smoothing":"grayscale","> *":{lineHeight:1},svg:{display:"inline-block"}}),vb=()=>({"&::before":{display:"table",content:'""'},"&::after":{display:"table",clear:"both",content:'""'}}),Die=n=>({a:{color:n.colorLink,textDecoration:n.linkDecoration,backgroundColor:"transparent",outline:"none",cursor:"pointer",transition:`color ${n.motionDurationSlow}`,"-webkit-text-decoration-skip":"objects","&:hover":{color:n.colorLinkHover},"&:active":{color:n.colorLinkActive},"&:active, &:hover":{textDecoration:n.linkHoverDecoration,outline:0},"&:focus":{textDecoration:n.linkFocusDecoration,outline:0},"&[disabled]":{color:n.colorTextDisabled,cursor:"not-allowed"}}}),Oie=(n,e,t,i)=>{const a=`[class^="${e}"], [class*=" ${e}"]`,o=t?`.${t}`:a,r={boxSizing:"border-box","&::before, &::after":{boxSizing:"border-box"}};let s={};return i!==!1&&(s={fontFamily:n.fontFamily,fontSize:n.fontSize}),{[o]:Object.assign(Object.assign(Object.assign({},s),r),{[a]:r})}},II=(n,e)=>({outline:`${st(n.lineWidthFocus)} solid ${n.colorPrimaryBorder}`,outlineOffset:e??1,transition:"outline-offset 0s, outline 0s"}),Yf=(n,e)=>({"&:focus-visible":Object.assign({},II(n,e))}),EY=n=>({[`.${n}`]:Object.assign(Object.assign({},nS()),{[`.${n} .${n}-icon`]:{display:"block"}})}),HY=n=>Object.assign(Object.assign({color:n.colorLink,textDecoration:n.linkDecoration,outline:"none",cursor:"pointer",transition:`all ${n.motionDurationSlow}`,border:0,padding:0,background:"none",userSelect:"none"},Yf(n)),{"&:focus, &:hover":{color:n.colorLinkHover},"&:active":{color:n.colorLinkActive}}),{genStyleHooks:Oa,genComponentStyleHook:Uie,genSubStyleComponent:FY}=Yie({usePrefix:()=>{const{getPrefixCls:n,iconPrefixCls:e}=v.useContext(ui);return{rootPrefixCls:n(),iconPrefixCls:e}},useToken:()=>{const[n,e,t,i,a]=ks();return{theme:n,realToken:e,hashId:t,token:i,cssVar:a}},useCSP:()=>{const{csp:n}=v.useContext(ui);return n??{}},getResetStyles:(n,e)=>{var t;const i=Die(n);return[i,{"&":i},EY((t=e==null?void 0:e.prefix.iconPrefixCls)!==null&&t!==void 0?t:hM)]},getCommonStyle:Oie,getCompUnitless:()=>VY});function kie(n,e){return CI.reduce((t,i)=>{const a=n[`${i}1`],o=n[`${i}3`],r=n[`${i}6`],s=n[`${i}7`];return Object.assign(Object.assign({},t),e(i,{lightColor:a,lightBorderColor:o,darkColor:r,textColor:s}))},{})}const Pie=(n,e)=>{const[t,i]=ks();return ZR({token:i,hashId:"",path:["ant-design-icons",n],nonce:()=>e==null?void 0:e.nonce,layer:{name:"antd"}},()=>[EY(n)])},Jie=Object.assign({},tG),{useId:AH}=Jie,jie=()=>"",Qie=typeof AH>"u"?jie:AH;function qie(n,e,t){var i;pY();const a=n||{},o=a.inherit===!1||!e?Object.assign(Object.assign({},zR),{hashed:(i=e==null?void 0:e.hashed)!==null&&i!==void 0?i:zR.hashed,cssVar:e==null?void 0:e.cssVar}):e,r=Qie();return mb(()=>{var s,l;if(!n)return e;const c=Object.assign({},o.components);Object.keys(n.components||{}).forEach(h=>{c[h]=Object.assign(Object.assign({},c[h]),n.components[h])});const u=`css-var-${r.replace(/:/g,"")}`,C=((s=a.cssVar)!==null&&s!==void 0?s:o.cssVar)&&Object.assign(Object.assign(Object.assign({prefix:t==null?void 0:t.prefixCls},typeof o.cssVar=="object"?o.cssVar:{}),typeof a.cssVar=="object"?a.cssVar:{}),{key:typeof a.cssVar=="object"&&((l=a.cssVar)===null||l===void 0?void 0:l.key)||u});return Object.assign(Object.assign(Object.assign({},o),a),{token:Object.assign(Object.assign({},o.token),a.token),components:c,cssVar:C})},[a,o],(s,l)=>s.some((c,u)=>{const C=l[u];return!Vf(c,C,!0)}))}var $ie=["children"],XY=v.createContext({});function eae(n){var e=n.children,t=_n(n,$ie);return v.createElement(XY.Provider,{value:t},e)}var tae=function(n){Iu(t,n);var e=hu(t);function t(){return to(this,t),e.apply(this,arguments)}return no(t,[{key:"render",value:function(){return this.props.children}}]),t}(v.Component);function nae(n){var e=v.useReducer(function(s){return s+1},0),t=rt(e,2),i=t[1],a=v.useRef(n),o=Aa(function(){return a.current}),r=Aa(function(s){a.current=typeof s=="function"?s(a.current):s,i()});return[o,r]}var gd="none",ey="appear",ty="enter",ny="leave",mH="none",sc="prepare",rf="start",sf="active",fM="end",TY="prepared";function pH(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit".concat(n)]="webkit".concat(e),t["Moz".concat(n)]="moz".concat(e),t["ms".concat(n)]="MS".concat(e),t["O".concat(n)]="o".concat(e.toLowerCase()),t}function iae(n,e){var t={animationend:pH("Animation","AnimationEnd"),transitionend:pH("Transition","TransitionEnd")};return n&&("AnimationEvent"in e||delete t.animationend.animation,"TransitionEvent"in e||delete t.transitionend.transition),t}var aae=iae(kr(),typeof window<"u"?window:{}),YY={};if(kr()){var oae=document.createElement("div");YY=oae.style}var iy={};function zY(n){if(iy[n])return iy[n];var e=aae[n];if(e)for(var t=Object.keys(e),i=t.length,a=0;a<i;a+=1){var o=t[a];if(Object.prototype.hasOwnProperty.call(e,o)&&o in YY)return iy[n]=e[o],iy[n]}return""}var KY=zY("animationend"),LY=zY("transitionend"),_Y=!!(KY&&LY),bH=KY||"animationend",vH=LY||"transitionend";function yH(n,e){if(!n)return null;if(Bn(n)==="object"){var t=e.replace(/-\w/g,function(i){return i[1].toUpperCase()});return n[t]}return"".concat(n,"-").concat(e)}const rae=function(n){var e=v.useRef();function t(a){a&&(a.removeEventListener(vH,n),a.removeEventListener(bH,n))}function i(a){e.current&&e.current!==a&&t(e.current),a&&a!==e.current&&(a.addEventListener(vH,n),a.addEventListener(bH,n),e.current=a)}return v.useEffect(function(){return function(){t(e.current)}},[]),[i,t]};var DY=kr()?v.useLayoutEffect:v.useEffect;const sae=function(){var n=v.useRef(null);function e(){mi.cancel(n.current)}function t(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2;e();var o=mi(function(){a<=1?i({isCanceled:function(){return o!==n.current}}):t(i,a-1)});n.current=o}return v.useEffect(function(){return function(){e()}},[]),[t,e]};var lae=[sc,rf,sf,fM],cae=[sc,TY],OY=!1,gae=!0;function UY(n){return n===sf||n===fM}const uae=function(n,e,t){var i=Dp(mH),a=rt(i,2),o=a[0],r=a[1],s=sae(),l=rt(s,2),c=l[0],u=l[1];function C(){r(sc,!0)}var h=e?cae:lae;return DY(function(){if(o!==mH&&o!==fM){var m=h.indexOf(o),p=h[m+1],B=t(o);B===OY?r(p,!0):p&&c(function(b){function y(){b.isCanceled()||r(p,!0)}B===!0?y():Promise.resolve(B).then(y)})}},[n,o]),v.useEffect(function(){return function(){u()}},[]),[C,o]};function dae(n,e,t,i){var a=i.motionEnter,o=a===void 0?!0:a,r=i.motionAppear,s=r===void 0?!0:r,l=i.motionLeave,c=l===void 0?!0:l,u=i.motionDeadline,C=i.motionLeaveImmediately,h=i.onAppearPrepare,m=i.onEnterPrepare,p=i.onLeavePrepare,B=i.onAppearStart,b=i.onEnterStart,y=i.onLeaveStart,S=i.onAppearActive,R=i.onEnterActive,Z=i.onLeaveActive,x=i.onAppearEnd,M=i.onEnterEnd,E=i.onLeaveEnd,F=i.onVisibleChanged,N=Dp(),H=rt(N,2),z=H[0],_=H[1],D=nae(gd),P=rt(D,2),$=P[0],X=P[1],L=Dp(null),U=rt(L,2),q=U[0],K=U[1],O=$(),j=v.useRef(!1),ne=v.useRef(null);function k(){return t()}var ie=v.useRef(!1);function re(){X(gd),K(null,!0)}var ge=Aa(function(ee){var Q=$();if(Q!==gd){var ce=k();if(!(ee&&!ee.deadline&&ee.target!==ce)){var me=ie.current,Ze;Q===ey&&me?Ze=x==null?void 0:x(ce,ee):Q===ty&&me?Ze=M==null?void 0:M(ce,ee):Q===ny&&me&&(Ze=E==null?void 0:E(ce,ee)),me&&Ze!==!1&&re()}}}),de=rae(ge),xe=rt(de,1),Ne=xe[0],ye=function(Q){switch(Q){case ey:return Ve(Ve(Ve({},sc,h),rf,B),sf,S);case ty:return Ve(Ve(Ve({},sc,m),rf,b),sf,R);case ny:return Ve(Ve(Ve({},sc,p),rf,y),sf,Z);default:return{}}},pe=v.useMemo(function(){return ye(O)},[O]),Te=uae(O,!n,function(ee){if(ee===sc){var Q=pe[sc];return Q?Q(k()):OY}if(he in pe){var ce;K(((ce=pe[he])===null||ce===void 0?void 0:ce.call(pe,k(),null))||null)}return he===sf&&O!==gd&&(Ne(k()),u>0&&(clearTimeout(ne.current),ne.current=setTimeout(function(){ge({deadline:!0})},u))),he===TY&&re(),gae}),le=rt(Te,2),Ye=le[0],he=le[1],Ge=UY(he);ie.current=Ge;var be=v.useRef(null);DY(function(){if(!(j.current&&be.current===e)){_(e);var ee=j.current;j.current=!0;var Q;!ee&&e&&s&&(Q=ey),ee&&e&&o&&(Q=ty),(ee&&!e&&c||!ee&&C&&!e&&c)&&(Q=ny);var ce=ye(Q);Q&&(n||ce[sc])?(X(Q),Ye()):X(gd),be.current=e}},[e]),v.useEffect(function(){(O===ey&&!s||O===ty&&!o||O===ny&&!c)&&X(gd)},[s,o,c]),v.useEffect(function(){return function(){j.current=!1,clearTimeout(ne.current)}},[]);var Ee=v.useRef(!1);v.useEffect(function(){z&&(Ee.current=!0),z!==void 0&&O===gd&&((Ee.current||z)&&(F==null||F(z)),Ee.current=!0)},[z,O]);var Se=q;return pe[sc]&&he===rf&&(Se=Ke({transition:"none"},Se)),[O,he,Se,z??e]}function Cae(n){var e=n;Bn(n)==="object"&&(e=n.transitionSupport);function t(a,o){return!!(a.motionName&&e&&o!==!1)}var i=v.forwardRef(function(a,o){var r=a.visible,s=r===void 0?!0:r,l=a.removeOnLeave,c=l===void 0?!0:l,u=a.forceRender,C=a.children,h=a.motionName,m=a.leavedClassName,p=a.eventProps,B=v.useContext(XY),b=B.motion,y=t(a,b),S=v.useRef(),R=v.useRef();function Z(){try{return S.current instanceof HTMLElement?S.current:My(R.current)}catch{return null}}var x=dae(y,s,Z,a),M=rt(x,4),E=M[0],F=M[1],N=M[2],H=M[3],z=v.useRef(H);H&&(z.current=!0);var _=v.useCallback(function(U){S.current=U,aM(o,U)},[o]),D,P=Ke(Ke({},p),{},{visible:s});if(!C)D=null;else if(E===gd)H?D=C(Ke({},P),_):!c&&z.current&&m?D=C(Ke(Ke({},P),{},{className:m}),_):u||!c&&!m?D=C(Ke(Ke({},P),{},{style:{display:"none"}}),_):D=null;else{var $;F===sc?$="prepare":UY(F)?$="active":F===rf&&($="start");var X=yH(h,"".concat(E,"-").concat($));D=C(Ke(Ke({},P),{},{className:gt(yH(h,E),Ve(Ve({},X,X&&$),h,typeof h=="string")),style:N}),_)}if(v.isValidElement(D)&&BI(D)){var L=Qf(D);L||(D=v.cloneElement(D,{ref:_}))}return v.createElement(tae,{ref:R},D)});return i.displayName="CSSMotion",i}const GI=Cae(_Y);var LR="add",_R="keep",DR="remove",Ow="removed";function Iae(n){var e;return n&&Bn(n)==="object"&&"key"in n?e=n:e={key:n},Ke(Ke({},e),{},{key:String(e.key)})}function OR(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return n.map(Iae)}function hae(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],t=[],i=0,a=e.length,o=OR(n),r=OR(e);o.forEach(function(c){for(var u=!1,C=i;C<a;C+=1){var h=r[C];if(h.key===c.key){i<C&&(t=t.concat(r.slice(i,C).map(function(m){return Ke(Ke({},m),{},{status:LR})})),i=C),t.push(Ke(Ke({},h),{},{status:_R})),i+=1,u=!0;break}}u||t.push(Ke(Ke({},c),{},{status:DR}))}),i<a&&(t=t.concat(r.slice(i).map(function(c){return Ke(Ke({},c),{},{status:LR})})));var s={};t.forEach(function(c){var u=c.key;s[u]=(s[u]||0)+1});var l=Object.keys(s).filter(function(c){return s[c]>1});return l.forEach(function(c){t=t.filter(function(u){var C=u.key,h=u.status;return C!==c||h!==DR}),t.forEach(function(u){u.key===c&&(u.status=_R)})}),t}var fae=["component","children","onVisibleChanged","onAllRemoved"],Aae=["status"],mae=["eventProps","visible","children","motionName","motionAppear","motionEnter","motionLeave","motionLeaveImmediately","motionDeadline","removeOnLeave","leavedClassName","onAppearPrepare","onAppearStart","onAppearActive","onAppearEnd","onEnterStart","onEnterActive","onEnterEnd","onLeaveStart","onLeaveActive","onLeaveEnd"];function pae(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:GI,t=function(i){Iu(o,i);var a=hu(o);function o(){var r;to(this,o);for(var s=arguments.length,l=new Array(s),c=0;c<s;c++)l[c]=arguments[c];return r=a.call.apply(a,[this].concat(l)),Ve(si(r),"state",{keyEntities:[]}),Ve(si(r),"removeKey",function(u){r.setState(function(C){var h=C.keyEntities.map(function(m){return m.key!==u?m:Ke(Ke({},m),{},{status:Ow})});return{keyEntities:h}},function(){var C=r.state.keyEntities,h=C.filter(function(m){var p=m.status;return p!==Ow}).length;h===0&&r.props.onAllRemoved&&r.props.onAllRemoved()})}),r}return no(o,[{key:"render",value:function(){var s=this,l=this.state.keyEntities,c=this.props,u=c.component,C=c.children,h=c.onVisibleChanged;c.onAllRemoved;var m=_n(c,fae),p=u||v.Fragment,B={};return mae.forEach(function(b){B[b]=m[b],delete m[b]}),delete m.keys,v.createElement(p,m,l.map(function(b,y){var S=b.status,R=_n(b,Aae),Z=S===LR||S===_R;return v.createElement(e,$t({},B,{key:R.key,visible:Z,eventProps:R,onVisibleChanged:function(M){h==null||h(M,{key:R.key}),M||s.removeKey(R.key)}}),function(x,M){return C(Ke(Ke({},x),{},{index:y}),M)})}))}}],[{key:"getDerivedStateFromProps",value:function(s,l){var c=s.keys,u=l.keyEntities,C=OR(c),h=hae(u,C);return{keyEntities:h.filter(function(m){var p=u.find(function(B){var b=B.key;return m.key===b});return!(p&&p.status===Ow&&m.status===DR)})}}}]),o}(v.Component);return Ve(t,"defaultProps",{component:"div"}),t}pae(_Y);function bae(n){const{children:e}=n,[,t]=ks(),{motion:i}=t,a=v.useRef(!1);return a.current=a.current||i===!1,a.current?v.createElement(eae,{motion:i},e):e}const vae=()=>null;var yae=function(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(n);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(n,i[a])&&(t[i[a]]=n[i[a]]);return t};const Bae=["getTargetContainer","getPopupContainer","renderEmpty","input","pagination","form","select","button"];let kY;function Gae(){return kY||DB}function Sae(n){return Object.keys(n).some(e=>e.endsWith("Color"))}const wae=n=>{const{prefixCls:e,iconPrefixCls:t,theme:i,holderRender:a}=n;e!==void 0&&(kY=e),i&&Sae(i)&&Gie(Gae(),i)},Rae=n=>{const{children:e,csp:t,autoInsertSpaceInButton:i,alert:a,anchor:o,form:r,locale:s,componentSize:l,direction:c,space:u,splitter:C,virtual:h,dropdownMatchSelectWidth:m,popupMatchSelectWidth:p,popupOverflow:B,legacyLocale:b,parentContext:y,iconPrefixCls:S,theme:R,componentDisabled:Z,segmented:x,statistic:M,spin:E,calendar:F,carousel:N,cascader:H,collapse:z,typography:_,checkbox:D,descriptions:P,divider:$,drawer:X,skeleton:L,steps:U,image:q,layout:K,list:O,mentions:j,modal:ne,progress:k,result:ie,slider:re,breadcrumb:ge,menu:de,pagination:xe,input:Ne,textArea:ye,empty:pe,badge:Te,radio:le,rate:Ye,switch:he,transfer:Ge,avatar:be,message:Ee,tag:Se,table:ee,card:Q,tabs:ce,timeline:me,timePicker:Ze,upload:Xe,notification:De,tree:Oe,colorPicker:Je,datePicker:At,rangePicker:qe,flex:lt,wave:$e,dropdown:je,warning:ke,tour:Ce,tooltip:He,popover:ht,popconfirm:we,floatButtonGroup:ze,variant:Qe,inputNumber:ut,treeSelect:Rt}=n,mt=v.useCallback((kt,Ft)=>{const{prefixCls:fn}=n;if(Ft)return Ft;const sn=fn||y.getPrefixCls("");return kt?`${sn}-${kt}`:sn},[y.getPrefixCls,n.prefixCls]),_t=S||y.iconPrefixCls||hM,Lt=t||y.csp;Pie(_t,Lt);const Zt=qie(R,y.theme,{prefixCls:mt("")}),yt={csp:Lt,autoInsertSpaceInButton:i,alert:a,anchor:o,locale:s||b,direction:c,space:u,splitter:C,virtual:h,popupMatchSelectWidth:p??m,popupOverflow:B,getPrefixCls:mt,iconPrefixCls:_t,theme:Zt,segmented:x,statistic:M,spin:E,calendar:F,carousel:N,cascader:H,collapse:z,typography:_,checkbox:D,descriptions:P,divider:$,drawer:X,skeleton:L,steps:U,image:q,input:Ne,textArea:ye,layout:K,list:O,mentions:j,modal:ne,progress:k,result:ie,slider:re,breadcrumb:ge,menu:de,pagination:xe,empty:pe,badge:Te,radio:le,rate:Ye,switch:he,transfer:Ge,avatar:be,message:Ee,tag:Se,table:ee,card:Q,tabs:ce,timeline:me,timePicker:Ze,upload:Xe,notification:De,tree:Oe,colorPicker:Je,datePicker:At,rangePicker:qe,flex:lt,wave:$e,dropdown:je,warning:ke,tour:Ce,tooltip:He,popover:ht,popconfirm:we,floatButtonGroup:ze,variant:Qe,inputNumber:ut,treeSelect:Rt},Ht=Object.assign({},y);Object.keys(yt).forEach(kt=>{yt[kt]!==void 0&&(Ht[kt]=yt[kt])}),Bae.forEach(kt=>{const Ft=n[kt];Ft&&(Ht[kt]=Ft)}),typeof i<"u"&&(Ht.button=Object.assign({autoInsertSpace:i},Ht.button));const jt=mb(()=>Ht,Ht,(kt,Ft)=>{const fn=Object.keys(kt),sn=Object.keys(Ft);return fn.length!==sn.length||fn.some(ae=>kt[ae]!==Ft[ae])}),{layer:Ut}=v.useContext(pb),Nt=v.useMemo(()=>({prefixCls:_t,csp:Lt,layer:Ut?"antd":void 0}),[_t,Lt,Ut]);let Tt=v.createElement(v.Fragment,null,v.createElement(vae,{dropdownMatchSelectWidth:m}),e);const Pt=v.useMemo(()=>{var kt,Ft,fn,sn;return of(((kt=Ff.Form)===null||kt===void 0?void 0:kt.defaultValidateMessages)||{},((fn=(Ft=jt.locale)===null||Ft===void 0?void 0:Ft.Form)===null||fn===void 0?void 0:fn.defaultValidateMessages)||{},((sn=jt.form)===null||sn===void 0?void 0:sn.validateMessages)||{},(r==null?void 0:r.validateMessages)||{})},[jt,r==null?void 0:r.validateMessages]);Object.keys(Pt).length>0&&(Tt=v.createElement(eie.Provider,{value:Pt},Tt)),s&&(Tt=v.createElement(oie,{locale:s,_ANT_MARK__:aie},Tt)),Tt=v.createElement(CM.Provider,{value:Nt},Tt),l&&(Tt=v.createElement(wie,{size:l},Tt)),Tt=v.createElement(bae,null,Tt);const qt=v.useMemo(()=>{const kt=Zt||{},{algorithm:Ft,token:fn,components:sn,cssVar:ae}=kt,ue=yae(kt,["algorithm","token","components","cssVar"]),Fe=Ft&&(!Array.isArray(Ft)||Ft.length>0)?BR(Ft):wY,ot={};Object.entries(sn||{}).forEach(It=>{let[Wt,xt]=It;const te=Object.assign({},xt);"algorithm"in te&&(te.algorithm===!0?te.theme=Fe:(Array.isArray(te.algorithm)||typeof te.algorithm=="function")&&(te.theme=BR(te.algorithm)),delete te.algorithm),ot[Wt]=te});const at=Object.assign(Object.assign({},Lp),fn);return Object.assign(Object.assign({},ue),{theme:Fe,token:at,components:ot,override:Object.assign({override:at},ot),cssVar:ae})},[Zt]);return R&&(Tt=v.createElement(RY.Provider,{value:qt},Tt)),jt.warning&&(Tt=v.createElement($ne.Provider,{value:jt.warning},Tt)),Z!==void 0&&(Tt=v.createElement(Sie,{disabled:Z},Tt)),v.createElement(ui.Provider,{value:jt},Tt)},$f=n=>{const e=v.useContext(ui),t=v.useContext(IM);return v.createElement(Rae,Object.assign({parentContext:e,legacyLocale:t},n))};$f.ConfigContext=ui;$f.SizeContext=Xf;$f.config=wae;$f.useConfig=Rie;Object.defineProperty($f,"SizeContext",{get:()=>Xf});function PY(n){var e;return n==null||(e=n.getRootNode)===null||e===void 0?void 0:e.call(n)}function Zae(n){return PY(n)instanceof ShadowRoot}function OB(n){return Zae(n)?PY(n):null}function xae(n){return n.replace(/-(.)/g,function(e,t){return t.toUpperCase()})}function Mae(n,e){No(n,"[@ant-design/icons] ".concat(e))}function BH(n){return Bn(n)==="object"&&typeof n.name=="string"&&typeof n.theme=="string"&&(Bn(n.icon)==="object"||typeof n.icon=="function")}function GH(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Object.keys(n).reduce(function(e,t){var i=n[t];switch(t){case"class":e.className=i,delete e.class;break;default:delete e[t],e[xae(t)]=i}return e},{})}function UR(n,e,t){return t?Ct.createElement(n.tag,Ke(Ke({key:e},GH(n.attrs)),t),(n.children||[]).map(function(i,a){return UR(i,"".concat(e,"-").concat(n.tag,"-").concat(a))})):Ct.createElement(n.tag,Ke({key:e},GH(n.attrs)),(n.children||[]).map(function(i,a){return UR(i,"".concat(e,"-").concat(n.tag,"-").concat(a))}))}function JY(n){return _p(n)[0]}function jY(n){return n?Array.isArray(n)?n:[n]:[]}var Wae=`
.anticon {
  display: inline-flex;
  align-items: center;
  color: inherit;
  font-style: normal;
  line-height: 0;
  text-align: center;
  text-transform: none;
  vertical-align: -0.125em;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

.anticon > * {
  line-height: 1;
}

.anticon svg {
  display: inline-block;
}

.anticon::before {
  display: none;
}

.anticon .anticon-icon {
  display: block;
}

.anticon[tabindex] {
  cursor: pointer;
}

.anticon-spin::before,
.anticon-spin {
  display: inline-block;
  -webkit-animation: loadingCircle 1s infinite linear;
  animation: loadingCircle 1s infinite linear;
}

@-webkit-keyframes loadingCircle {
  100% {
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}

@keyframes loadingCircle {
  100% {
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}
`,Vae=function(e){var t=v.useContext(CM),i=t.csp,a=t.prefixCls,o=t.layer,r=Wae;a&&(r=r.replace(/anticon/g,a)),o&&(r="@layer ".concat(o,` {
`).concat(r,`
}`)),v.useEffect(function(){var s=e.current,l=OB(s);lu(r,"@ant-design-icons",{prepend:!o,csp:i,attachTo:l})},[])},Nae=["icon","className","onClick","style","primaryColor","secondaryColor"],fp={primaryColor:"#333",secondaryColor:"#E6E6E6",calculated:!1};function Eae(n){var e=n.primaryColor,t=n.secondaryColor;fp.primaryColor=e,fp.secondaryColor=t||JY(e),fp.calculated=!!t}function Hae(){return Ke({},fp)}var eA=function(e){var t=e.icon,i=e.className,a=e.onClick,o=e.style,r=e.primaryColor,s=e.secondaryColor,l=_n(e,Nae),c=v.useRef(),u=fp;if(r&&(u={primaryColor:r,secondaryColor:s||JY(r)}),Vae(c),Mae(BH(t),"icon should be icon definiton, but got ".concat(t)),!BH(t))return null;var C=t;return C&&typeof C.icon=="function"&&(C=Ke(Ke({},C),{},{icon:C.icon(u.primaryColor,u.secondaryColor)})),UR(C.icon,"svg-".concat(C.name),Ke(Ke({className:i,onClick:a,style:o,"data-icon":C.name,width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true"},l),{},{ref:c}))};eA.displayName="IconReact";eA.getTwoToneColors=Hae;eA.setTwoToneColors=Eae;function QY(n){var e=jY(n),t=rt(e,2),i=t[0],a=t[1];return eA.setTwoToneColors({primaryColor:i,secondaryColor:a})}function Fae(){var n=eA.getTwoToneColors();return n.calculated?[n.primaryColor,n.secondaryColor]:n.primaryColor}var Xae=["className","icon","spin","rotate","tabIndex","onClick","twoToneColor"];QY(_B.primary);var io=v.forwardRef(function(n,e){var t=n.className,i=n.icon,a=n.spin,o=n.rotate,r=n.tabIndex,s=n.onClick,l=n.twoToneColor,c=_n(n,Xae),u=v.useContext(CM),C=u.prefixCls,h=C===void 0?"anticon":C,m=u.rootClassName,p=gt(m,h,Ve(Ve({},"".concat(h,"-").concat(i.name),!!i.name),"".concat(h,"-spin"),!!a||i.name==="loading"),t),B=r;B===void 0&&s&&(B=-1);var b=o?{msTransform:"rotate(".concat(o,"deg)"),transform:"rotate(".concat(o,"deg)")}:void 0,y=jY(l),S=rt(y,2),R=S[0],Z=S[1];return v.createElement("span",$t({role:"img","aria-label":i.name},c,{ref:e,tabIndex:B,onClick:s,className:p}),v.createElement(eA,{icon:i,primaryColor:R,secondaryColor:Z,style:b}))});io.displayName="AntdIcon";io.getTwoToneColor=Fae;io.setTwoToneColor=QY;var Tae={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64c247.4 0 448 200.6 448 448S759.4 960 512 960 64 759.4 64 512 264.6 64 512 64zm127.98 274.82h-.04l-.08.06L512 466.75 384.14 338.88c-.04-.05-.06-.06-.08-.06a.12.12 0 00-.07 0c-.03 0-.05.01-.09.05l-45.02 45.02a.2.2 0 00-.05.09.12.12 0 000 .07v.02a.27.27 0 00.06.06L466.75 512 338.88 639.86c-.05.04-.06.06-.06.08a.12.12 0 000 .07c0 .03.01.05.05.09l45.02 45.02a.2.2 0 00.09.05.12.12 0 00.07 0c.02 0 .04-.01.08-.05L512 557.25l127.86 127.87c.04.04.06.05.08.05a.12.12 0 00.07 0c.03 0 .05-.01.09-.05l45.02-45.02a.2.2 0 00.05-.09.12.12 0 000-.07v-.02a.27.27 0 00-.05-.06L557.25 512l127.87-127.86c.04-.04.05-.06.05-.08a.12.12 0 000-.07c0-.03-.01-.05-.05-.09l-45.02-45.02a.2.2 0 00-.09-.05.12.12 0 00-.07 0z"}}]},name:"close-circle",theme:"filled"},Yae=function(e,t){return v.createElement(io,$t({},e,{ref:t,icon:Tae}))},qY=v.forwardRef(Yae),zae={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M799.86 166.31c.02 0 .04.02.08.06l57.69 57.7c.04.03.05.05.06.08a.12.12 0 010 .06c0 .03-.02.05-.06.09L569.93 512l287.7 287.7c.04.04.05.06.06.09a.12.12 0 010 .07c0 .02-.02.04-.06.08l-57.7 57.69c-.03.04-.05.05-.07.06a.12.12 0 01-.07 0c-.03 0-.05-.02-.09-.06L512 569.93l-287.7 287.7c-.04.04-.06.05-.09.06a.12.12 0 01-.07 0c-.02 0-.04-.02-.08-.06l-57.69-57.7c-.04-.03-.05-.05-.06-.07a.12.12 0 010-.07c0-.03.02-.05.06-.09L454.07 512l-287.7-287.7c-.04-.04-.05-.06-.06-.09a.12.12 0 010-.07c0-.02.02-.04.06-.08l57.7-57.69c.03-.04.05-.05.07-.06a.12.12 0 01.07 0c.03 0 .05.02.09.06L512 454.07l287.7-287.7c.04-.04.06-.05.09-.06a.12.12 0 01.07 0z"}}]},name:"close",theme:"outlined"},Kae=function(e,t){return v.createElement(io,$t({},e,{ref:t,icon:zae}))},$Y=v.forwardRef(Kae),Lae=`accept acceptCharset accessKey action allowFullScreen allowTransparency
    alt async autoComplete autoFocus autoPlay capture cellPadding cellSpacing challenge
    charSet checked classID className colSpan cols content contentEditable contextMenu
    controls coords crossOrigin data dateTime default defer dir disabled download draggable
    encType form formAction formEncType formMethod formNoValidate formTarget frameBorder
    headers height hidden high href hrefLang htmlFor httpEquiv icon id inputMode integrity
    is keyParams keyType kind label lang list loop low manifest marginHeight marginWidth max maxLength media
    mediaGroup method min minLength multiple muted name noValidate nonce open
    optimum pattern placeholder poster preload radioGroup readOnly rel required
    reversed role rowSpan rows sandbox scope scoped scrolling seamless selected
    shape size sizes span spellCheck src srcDoc srcLang srcSet start step style
    summary tabIndex target title type useMap value width wmode wrap`,_ae=`onCopy onCut onPaste onCompositionEnd onCompositionStart onCompositionUpdate onKeyDown
    onKeyPress onKeyUp onFocus onBlur onChange onInput onSubmit onClick onContextMenu onDoubleClick
    onDrag onDragEnd onDragEnter onDragExit onDragLeave onDragOver onDragStart onDrop onMouseDown
    onMouseEnter onMouseLeave onMouseMove onMouseOut onMouseOver onMouseUp onSelect onTouchCancel
    onTouchEnd onTouchMove onTouchStart onScroll onWheel onAbort onCanPlay onCanPlayThrough
    onDurationChange onEmptied onEncrypted onEnded onError onLoadedData onLoadedMetadata
    onLoadStart onPause onPlay onPlaying onProgress onRateChange onSeeked onSeeking onStalled onSuspend onTimeUpdate onVolumeChange onWaiting onLoad onError`,Dae="".concat(Lae," ").concat(_ae).split(/[\s\n]+/),Oae="aria-",Uae="data-";function SH(n,e){return n.indexOf(e)===0}function hI(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,t;e===!1?t={aria:!0,data:!0,attr:!0}:e===!0?t={aria:!0}:t=Ke({},e);var i={};return Object.keys(n).forEach(function(a){(t.aria&&(a==="role"||SH(a,Oae))||t.data&&SH(a,Uae)||t.attr&&Dae.includes(a))&&(i[a]=n[a])}),i}function ez(n){return n&&Ct.isValidElement(n)&&n.type===Ct.Fragment}const kae=(n,e,t)=>Ct.isValidElement(n)?Ct.cloneElement(n,typeof t=="function"?t(n.props||{}):t):e;function Bd(n,e){return kae(n,n,e)}const tA=n=>{const[,,,,e]=ks();return e?`${n}-css-var`:""};var tn={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46,N:78,P:80,META:91,WIN_KEY_RIGHT:92,CONTEXT_MENU:93,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,SEMICOLON:186,EQUALS:187,WIN_KEY:224},Pae={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M988 548c-19.9 0-36-16.1-36-36 0-59.4-11.6-117-34.6-171.3a440.45 440.45 0 00-94.3-139.9 437.71 437.71 0 00-139.9-94.3C629 83.6 571.4 72 512 72c-19.9 0-36-16.1-36-36s16.1-36 36-36c69.1 0 136.2 13.5 199.3 40.3C772.3 66 827 103 874 150c47 47 83.9 101.8 109.7 162.7 26.7 63.1 40.2 130.2 40.2 199.3.1 19.9-16 36-35.9 36z"}}]},name:"loading",theme:"outlined"},Jae=function(e,t){return v.createElement(io,$t({},e,{ref:t,icon:Pae}))},AM=v.forwardRef(Jae);const tz=Ct.createContext(void 0),WC=100,nz={Modal:WC,Drawer:WC,Popover:WC,Popconfirm:WC,Tooltip:WC,Tour:WC,FloatButton:WC},jae={SelectLike:50,Dropdown:50,DatePicker:50,Menu:50,ImagePreview:1};function Qae(n){return n in nz}const iz=(n,e)=>{const[,t]=ks(),i=Ct.useContext(tz),a=Qae(n);let o;if(e!==void 0)o=[e,e];else{let r=i??0;a?r+=(i?0:t.zIndexPopupBase)+nz[n]:r+=jae[n],o=[i===void 0?e:r,r]}return o};function Pr(){Pr=function(){return e};var n,e={},t=Object.prototype,i=t.hasOwnProperty,a=Object.defineProperty||function(X,L,U){X[L]=U.value},o=typeof Symbol=="function"?Symbol:{},r=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function c(X,L,U){return Object.defineProperty(X,L,{value:U,enumerable:!0,configurable:!0,writable:!0}),X[L]}try{c({},"")}catch{c=function(U,q,K){return U[q]=K}}function u(X,L,U,q){var K=L&&L.prototype instanceof y?L:y,O=Object.create(K.prototype),j=new P(q||[]);return a(O,"_invoke",{value:H(X,U,j)}),O}function C(X,L,U){try{return{type:"normal",arg:X.call(L,U)}}catch(q){return{type:"throw",arg:q}}}e.wrap=u;var h="suspendedStart",m="suspendedYield",p="executing",B="completed",b={};function y(){}function S(){}function R(){}var Z={};c(Z,r,function(){return this});var x=Object.getPrototypeOf,M=x&&x(x($([])));M&&M!==t&&i.call(M,r)&&(Z=M);var E=R.prototype=y.prototype=Object.create(Z);function F(X){["next","throw","return"].forEach(function(L){c(X,L,function(U){return this._invoke(L,U)})})}function N(X,L){function U(K,O,j,ne){var k=C(X[K],X,O);if(k.type!=="throw"){var ie=k.arg,re=ie.value;return re&&Bn(re)=="object"&&i.call(re,"__await")?L.resolve(re.__await).then(function(ge){U("next",ge,j,ne)},function(ge){U("throw",ge,j,ne)}):L.resolve(re).then(function(ge){ie.value=ge,j(ie)},function(ge){return U("throw",ge,j,ne)})}ne(k.arg)}var q;a(this,"_invoke",{value:function(O,j){function ne(){return new L(function(k,ie){U(O,j,k,ie)})}return q=q?q.then(ne,ne):ne()}})}function H(X,L,U){var q=h;return function(K,O){if(q===p)throw Error("Generator is already running");if(q===B){if(K==="throw")throw O;return{value:n,done:!0}}for(U.method=K,U.arg=O;;){var j=U.delegate;if(j){var ne=z(j,U);if(ne){if(ne===b)continue;return ne}}if(U.method==="next")U.sent=U._sent=U.arg;else if(U.method==="throw"){if(q===h)throw q=B,U.arg;U.dispatchException(U.arg)}else U.method==="return"&&U.abrupt("return",U.arg);q=p;var k=C(X,L,U);if(k.type==="normal"){if(q=U.done?B:m,k.arg===b)continue;return{value:k.arg,done:U.done}}k.type==="throw"&&(q=B,U.method="throw",U.arg=k.arg)}}}function z(X,L){var U=L.method,q=X.iterator[U];if(q===n)return L.delegate=null,U==="throw"&&X.iterator.return&&(L.method="return",L.arg=n,z(X,L),L.method==="throw")||U!=="return"&&(L.method="throw",L.arg=new TypeError("The iterator does not provide a '"+U+"' method")),b;var K=C(q,X.iterator,L.arg);if(K.type==="throw")return L.method="throw",L.arg=K.arg,L.delegate=null,b;var O=K.arg;return O?O.done?(L[X.resultName]=O.value,L.next=X.nextLoc,L.method!=="return"&&(L.method="next",L.arg=n),L.delegate=null,b):O:(L.method="throw",L.arg=new TypeError("iterator result is not an object"),L.delegate=null,b)}function _(X){var L={tryLoc:X[0]};1 in X&&(L.catchLoc=X[1]),2 in X&&(L.finallyLoc=X[2],L.afterLoc=X[3]),this.tryEntries.push(L)}function D(X){var L=X.completion||{};L.type="normal",delete L.arg,X.completion=L}function P(X){this.tryEntries=[{tryLoc:"root"}],X.forEach(_,this),this.reset(!0)}function $(X){if(X||X===""){var L=X[r];if(L)return L.call(X);if(typeof X.next=="function")return X;if(!isNaN(X.length)){var U=-1,q=function K(){for(;++U<X.length;)if(i.call(X,U))return K.value=X[U],K.done=!1,K;return K.value=n,K.done=!0,K};return q.next=q}}throw new TypeError(Bn(X)+" is not iterable")}return S.prototype=R,a(E,"constructor",{value:R,configurable:!0}),a(R,"constructor",{value:S,configurable:!0}),S.displayName=c(R,l,"GeneratorFunction"),e.isGeneratorFunction=function(X){var L=typeof X=="function"&&X.constructor;return!!L&&(L===S||(L.displayName||L.name)==="GeneratorFunction")},e.mark=function(X){return Object.setPrototypeOf?Object.setPrototypeOf(X,R):(X.__proto__=R,c(X,l,"GeneratorFunction")),X.prototype=Object.create(E),X},e.awrap=function(X){return{__await:X}},F(N.prototype),c(N.prototype,s,function(){return this}),e.AsyncIterator=N,e.async=function(X,L,U,q,K){K===void 0&&(K=Promise);var O=new N(u(X,L,U,q),K);return e.isGeneratorFunction(L)?O:O.next().then(function(j){return j.done?j.value:O.next()})},F(E),c(E,l,"Generator"),c(E,r,function(){return this}),c(E,"toString",function(){return"[object Generator]"}),e.keys=function(X){var L=Object(X),U=[];for(var q in L)U.push(q);return U.reverse(),function K(){for(;U.length;){var O=U.pop();if(O in L)return K.value=O,K.done=!1,K}return K.done=!0,K}},e.values=$,P.prototype={constructor:P,reset:function(L){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(D),!L)for(var U in this)U.charAt(0)==="t"&&i.call(this,U)&&!isNaN(+U.slice(1))&&(this[U]=n)},stop:function(){this.done=!0;var L=this.tryEntries[0].completion;if(L.type==="throw")throw L.arg;return this.rval},dispatchException:function(L){if(this.done)throw L;var U=this;function q(ie,re){return j.type="throw",j.arg=L,U.next=ie,re&&(U.method="next",U.arg=n),!!re}for(var K=this.tryEntries.length-1;K>=0;--K){var O=this.tryEntries[K],j=O.completion;if(O.tryLoc==="root")return q("end");if(O.tryLoc<=this.prev){var ne=i.call(O,"catchLoc"),k=i.call(O,"finallyLoc");if(ne&&k){if(this.prev<O.catchLoc)return q(O.catchLoc,!0);if(this.prev<O.finallyLoc)return q(O.finallyLoc)}else if(ne){if(this.prev<O.catchLoc)return q(O.catchLoc,!0)}else{if(!k)throw Error("try statement without catch or finally");if(this.prev<O.finallyLoc)return q(O.finallyLoc)}}}},abrupt:function(L,U){for(var q=this.tryEntries.length-1;q>=0;--q){var K=this.tryEntries[q];if(K.tryLoc<=this.prev&&i.call(K,"finallyLoc")&&this.prev<K.finallyLoc){var O=K;break}}O&&(L==="break"||L==="continue")&&O.tryLoc<=U&&U<=O.finallyLoc&&(O=null);var j=O?O.completion:{};return j.type=L,j.arg=U,O?(this.method="next",this.next=O.finallyLoc,b):this.complete(j)},complete:function(L,U){if(L.type==="throw")throw L.arg;return L.type==="break"||L.type==="continue"?this.next=L.arg:L.type==="return"?(this.rval=this.arg=L.arg,this.method="return",this.next="end"):L.type==="normal"&&U&&(this.next=U),b},finish:function(L){for(var U=this.tryEntries.length-1;U>=0;--U){var q=this.tryEntries[U];if(q.finallyLoc===L)return this.complete(q.completion,q.afterLoc),D(q),b}},catch:function(L){for(var U=this.tryEntries.length-1;U>=0;--U){var q=this.tryEntries[U];if(q.tryLoc===L){var K=q.completion;if(K.type==="throw"){var O=K.arg;D(q)}return O}}throw Error("illegal catch attempt")},delegateYield:function(L,U,q){return this.delegate={iterator:$(L),resultName:U,nextLoc:q},this.method==="next"&&(this.arg=n),b}},e}function wH(n,e,t,i,a,o,r){try{var s=n[o](r),l=s.value}catch(c){return void t(c)}s.done?e(l):Promise.resolve(l).then(i,a)}function SI(n){return function(){var e=this,t=arguments;return new Promise(function(i,a){var o=n.apply(e,t);function r(l){wH(o,i,a,r,s,"next",l)}function s(l){wH(o,i,a,r,s,"throw",l)}r(void 0)})}}var yb=Ke({},PD),qae=yb.version,Uw=yb.render,$ae=yb.unmountComponentAtNode,iS;try{var eoe=Number((qae||"").split(".")[0]);eoe>=18&&(iS=yb.createRoot)}catch{}function RH(n){var e=yb.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;e&&Bn(e)==="object"&&(e.usingClientEntryPoint=n)}var UB="__rc_react_root__";function toe(n,e){RH(!0);var t=e[UB]||iS(e);RH(!1),t.render(n),e[UB]=t}function noe(n,e){Uw==null||Uw(n,e)}function ioe(n,e){if(iS){toe(n,e);return}noe(n,e)}function aoe(n){return kR.apply(this,arguments)}function kR(){return kR=SI(Pr().mark(function n(e){return Pr().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",Promise.resolve().then(function(){var a;(a=e[UB])===null||a===void 0||a.unmount(),delete e[UB]}));case 1:case"end":return i.stop()}},n)})),kR.apply(this,arguments)}function ooe(n){$ae(n)}function roe(n){return PR.apply(this,arguments)}function PR(){return PR=SI(Pr().mark(function n(e){return Pr().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(iS===void 0){i.next=2;break}return i.abrupt("return",aoe(e));case 2:ooe(e);case 3:case"end":return i.stop()}},n)})),PR.apply(this,arguments)}const soe=(n,e)=>(ioe(n,e),()=>roe(e));let loe=soe;function coe(){return loe}const mM=(n,e,t)=>t!==void 0?t:`${n}-${e}`;function Ss(n,e){var t=Object.assign({},n);return Array.isArray(e)&&e.forEach(function(i){delete t[i]}),t}const pM=function(n){if(!n)return!1;if(n instanceof Element){if(n.offsetParent)return!0;if(n.getBBox){var e=n.getBBox(),t=e.width,i=e.height;if(t||i)return!0}if(n.getBoundingClientRect){var a=n.getBoundingClientRect(),o=a.width,r=a.height;if(o||r)return!0}}return!1},goe=n=>{const{componentCls:e,colorPrimary:t}=n;return{[e]:{position:"absolute",background:"transparent",pointerEvents:"none",boxSizing:"border-box",color:`var(--wave-color, ${t})`,boxShadow:"0 0 0 0 currentcolor",opacity:.2,"&.wave-motion-appear":{transition:[`box-shadow 0.4s ${n.motionEaseOutCirc}`,`opacity 2s ${n.motionEaseOutCirc}`].join(","),"&-active":{boxShadow:"0 0 0 6px currentcolor",opacity:0},"&.wave-quick":{transition:[`box-shadow ${n.motionDurationSlow} ${n.motionEaseInOut}`,`opacity ${n.motionDurationSlow} ${n.motionEaseInOut}`].join(",")}}}}},uoe=Uie("Wave",n=>[goe(n)]),bM=`${DB}-wave-target`;function kw(n){return n&&n!=="#fff"&&n!=="#ffffff"&&n!=="rgb(255, 255, 255)"&&n!=="rgba(255, 255, 255, 1)"&&!/rgba\((?:\d*, ){3}0\)/.test(n)&&n!=="transparent"}function doe(n){const{borderTopColor:e,borderColor:t,backgroundColor:i}=getComputedStyle(n);return kw(e)?e:kw(t)?t:kw(i)?i:null}function Pw(n){return Number.isNaN(n)?0:n}const Coe=n=>{const{className:e,target:t,component:i,registerUnmount:a}=n,o=v.useRef(null),r=v.useRef(null);v.useEffect(()=>{r.current=a()},[]);const[s,l]=v.useState(null),[c,u]=v.useState([]),[C,h]=v.useState(0),[m,p]=v.useState(0),[B,b]=v.useState(0),[y,S]=v.useState(0),[R,Z]=v.useState(!1),x={left:C,top:m,width:B,height:y,borderRadius:c.map(F=>`${F}px`).join(" ")};s&&(x["--wave-color"]=s);function M(){const F=getComputedStyle(t);l(doe(t));const N=F.position==="static",{borderLeftWidth:H,borderTopWidth:z}=F;h(N?t.offsetLeft:Pw(-parseFloat(H))),p(N?t.offsetTop:Pw(-parseFloat(z))),b(t.offsetWidth),S(t.offsetHeight);const{borderTopLeftRadius:_,borderTopRightRadius:D,borderBottomLeftRadius:P,borderBottomRightRadius:$}=F;u([_,D,$,P].map(X=>Pw(parseFloat(X))))}if(v.useEffect(()=>{if(t){const F=mi(()=>{M(),Z(!0)});let N;return typeof ResizeObserver<"u"&&(N=new ResizeObserver(M),N.observe(t)),()=>{mi.cancel(F),N==null||N.disconnect()}}},[]),!R)return null;const E=(i==="Checkbox"||i==="Radio")&&(t==null?void 0:t.classList.contains(bM));return v.createElement(GI,{visible:!0,motionAppear:!0,motionName:"wave-motion",motionDeadline:5e3,onAppearEnd:(F,N)=>{var H,z;if(N.deadline||N.propertyName==="opacity"){const _=(H=o.current)===null||H===void 0?void 0:H.parentElement;(z=r.current)===null||z===void 0||z.call(r).then(()=>{_==null||_.remove()})}return!1}},(F,N)=>{let{className:H}=F;return v.createElement("div",{ref:Bs(o,N),className:gt(e,H,{"wave-quick":E}),style:x})})},Ioe=(n,e)=>{var t;const{component:i}=e;if(i==="Checkbox"&&!(!((t=n.querySelector("input"))===null||t===void 0)&&t.checked))return;const a=document.createElement("div");a.style.position="absolute",a.style.left="0px",a.style.top="0px",n==null||n.insertBefore(a,n==null?void 0:n.firstChild);const o=coe();let r=null;function s(){return r}r=o(v.createElement(Coe,Object.assign({},e,{target:n,registerUnmount:s})),a)},hoe=(n,e,t)=>{const{wave:i}=v.useContext(ui),[,a,o]=ks(),r=Aa(c=>{const u=n.current;if(i!=null&&i.disabled||!u)return;const C=u.querySelector(`.${bM}`)||u,{showEffect:h}=i||{};(h||Ioe)(C,{className:e,token:a,component:t,event:c,hashId:o})}),s=v.useRef(null);return c=>{mi.cancel(s.current),s.current=mi(()=>{r(c)})}},az=n=>{const{children:e,disabled:t,component:i}=n,{getPrefixCls:a}=v.useContext(ui),o=v.useRef(null),r=a("wave"),[,s]=uoe(r),l=hoe(o,gt(r,s),i);if(Ct.useEffect(()=>{const u=o.current;if(!u||u.nodeType!==1||t)return;const C=h=>{!pM(h.target)||!u.getAttribute||u.getAttribute("disabled")||u.disabled||u.className.includes("disabled")||u.className.includes("-leave")||l(h)};return u.addEventListener("click",C,!0),()=>{u.removeEventListener("click",C,!0)}},[t]),!Ct.isValidElement(e))return e??null;const c=BI(e)?Bs(Qf(e),o):o;return Bd(e,{ref:c})},Sl=n=>{const e=Ct.useContext(Xf);return Ct.useMemo(()=>n?typeof n=="string"?n??e:typeof n=="function"?n(e):e:e,[n,e])},foe=n=>{const{componentCls:e}=n;return{[e]:{"&-block":{display:"flex",width:"100%"},"&-vertical":{flexDirection:"column"}}}},Aoe=n=>{const{componentCls:e,antCls:t}=n;return{[e]:{display:"inline-flex","&-rtl":{direction:"rtl"},"&-vertical":{flexDirection:"column"},"&-align":{flexDirection:"column","&-center":{alignItems:"center"},"&-start":{alignItems:"flex-start"},"&-end":{alignItems:"flex-end"},"&-baseline":{alignItems:"baseline"}},[`${e}-item:empty`]:{display:"none"},[`${e}-item > ${t}-badge-not-a-wrapper:only-child`]:{display:"block"}}}},moe=n=>{const{componentCls:e}=n;return{[e]:{"&-gap-row-small":{rowGap:n.spaceGapSmallSize},"&-gap-row-middle":{rowGap:n.spaceGapMiddleSize},"&-gap-row-large":{rowGap:n.spaceGapLargeSize},"&-gap-col-small":{columnGap:n.spaceGapSmallSize},"&-gap-col-middle":{columnGap:n.spaceGapMiddleSize},"&-gap-col-large":{columnGap:n.spaceGapLargeSize}}}},oz=Oa("Space",n=>{const e=Xi(n,{spaceGapSmallSize:n.paddingXS,spaceGapMiddleSize:n.padding,spaceGapLargeSize:n.paddingLG});return[Aoe(e),moe(e),foe(e)]},()=>({}),{resetStyle:!1});var rz=function(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(n);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(n,i[a])&&(t[i[a]]=n[i[a]]);return t};const aS=v.createContext(null),Bb=(n,e)=>{const t=v.useContext(aS),i=v.useMemo(()=>{if(!t)return"";const{compactDirection:a,isFirstItem:o,isLastItem:r}=t,s=a==="vertical"?"-vertical-":"-";return gt(`${n}-compact${s}item`,{[`${n}-compact${s}first-item`]:o,[`${n}-compact${s}last-item`]:r,[`${n}-compact${s}item-rtl`]:e==="rtl"})},[n,e,t]);return{compactSize:t==null?void 0:t.compactSize,compactDirection:t==null?void 0:t.compactDirection,compactItemClassnames:i}},poe=n=>{const{children:e}=n;return v.createElement(aS.Provider,{value:null},e)},boe=n=>{const{children:e}=n,t=rz(n,["children"]);return v.createElement(aS.Provider,{value:v.useMemo(()=>t,[t])},e)},voe=n=>{const{getPrefixCls:e,direction:t}=v.useContext(ui),{size:i,direction:a,block:o,prefixCls:r,className:s,rootClassName:l,children:c}=n,u=rz(n,["size","direction","block","prefixCls","className","rootClassName","children"]),C=Sl(R=>i??R),h=e("space-compact",r),[m,p]=oz(h),B=gt(h,p,{[`${h}-rtl`]:t==="rtl",[`${h}-block`]:o,[`${h}-vertical`]:a==="vertical"},s,l),b=v.useContext(aS),y=Ic(c),S=v.useMemo(()=>y.map((R,Z)=>{const x=(R==null?void 0:R.key)||`${h}-item-${Z}`;return v.createElement(boe,{key:x,compactSize:C,compactDirection:a,isFirstItem:Z===0&&(!b||(b==null?void 0:b.isFirstItem)),isLastItem:Z===y.length-1&&(!b||(b==null?void 0:b.isLastItem))},R)}),[i,y,b]);return y.length===0?null:m(v.createElement("div",Object.assign({className:B},u),S))};var yoe=function(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(n);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(n,i[a])&&(t[i[a]]=n[i[a]]);return t};const sz=v.createContext(void 0),Boe=n=>{const{getPrefixCls:e,direction:t}=v.useContext(ui),{prefixCls:i,size:a,className:o}=n,r=yoe(n,["prefixCls","size","className"]),s=e("btn-group",i),[,,l]=ks(),c=v.useMemo(()=>{switch(a){case"large":return"lg";case"small":return"sm";default:return""}},[a]),u=gt(s,{[`${s}-${c}`]:c,[`${s}-rtl`]:t==="rtl"},o,l);return v.createElement(sz.Provider,{value:a},v.createElement("div",Object.assign({},r,{className:u})))},ZH=/^[\u4E00-\u9FA5]{2}$/,JR=ZH.test.bind(ZH);function xH(n){return typeof n=="string"}function Jw(n){return n==="text"||n==="link"}function Goe(n,e){if(n==null)return;const t=e?" ":"";return typeof n!="string"&&typeof n!="number"&&xH(n.type)&&JR(n.props.children)?Bd(n,{children:n.props.children.split("").join(t)}):xH(n)?JR(n)?Ct.createElement("span",null,n.split("").join(t)):Ct.createElement("span",null,n):ez(n)?Ct.createElement("span",null,n):n}function Soe(n,e){let t=!1;const i=[];return Ct.Children.forEach(n,a=>{const o=typeof a,r=o==="string"||o==="number";if(t&&r){const s=i.length-1,l=i[s];i[s]=`${l}${a}`}else i.push(a);t=r}),Ct.Children.map(i,a=>Goe(a,e))}["default","primary","danger"].concat(an(CI));const jR=v.forwardRef((n,e)=>{const{className:t,style:i,children:a,prefixCls:o}=n,r=gt(`${o}-icon`,t);return Ct.createElement("span",{ref:e,className:r,style:i},a)}),MH=v.forwardRef((n,e)=>{const{prefixCls:t,className:i,style:a,iconClassName:o}=n,r=gt(`${t}-loading-icon`,i);return Ct.createElement(jR,{prefixCls:t,className:r,style:a,ref:e},Ct.createElement(AM,{className:o}))}),jw=()=>({width:0,opacity:0,transform:"scale(0)"}),Qw=n=>({width:n.scrollWidth,opacity:1,transform:"scale(1)"}),woe=n=>{const{prefixCls:e,loading:t,existIcon:i,className:a,style:o,mount:r}=n,s=!!t;return i?Ct.createElement(MH,{prefixCls:e,className:a,style:o}):Ct.createElement(GI,{visible:s,motionName:`${e}-loading-icon-motion`,motionAppear:!r,motionEnter:!r,motionLeave:!r,removeOnLeave:!0,onAppearStart:jw,onAppearActive:Qw,onEnterStart:jw,onEnterActive:Qw,onLeaveStart:Qw,onLeaveActive:jw},(l,c)=>{let{className:u,style:C}=l;const h=Object.assign(Object.assign({},o),C);return Ct.createElement(MH,{prefixCls:e,className:gt(a,u),style:h,ref:c})})},WH=(n,e)=>({[`> span, > ${n}`]:{"&:not(:last-child)":{[`&, & > ${n}`]:{"&:not(:disabled)":{borderInlineEndColor:e}}},"&:not(:first-child)":{[`&, & > ${n}`]:{"&:not(:disabled)":{borderInlineStartColor:e}}}}}),Roe=n=>{const{componentCls:e,fontSize:t,lineWidth:i,groupBorderColor:a,colorErrorHover:o}=n;return{[`${e}-group`]:[{position:"relative",display:"inline-flex",[`> span, > ${e}`]:{"&:not(:last-child)":{[`&, & > ${e}`]:{borderStartEndRadius:0,borderEndEndRadius:0}},"&:not(:first-child)":{marginInlineStart:n.calc(i).mul(-1).equal(),[`&, & > ${e}`]:{borderStartStartRadius:0,borderEndStartRadius:0}}},[e]:{position:"relative",zIndex:1,"&:hover, &:focus, &:active":{zIndex:2},"&[disabled]":{zIndex:0}},[`${e}-icon-only`]:{fontSize:t}},WH(`${e}-primary`,a),WH(`${e}-danger`,o)]}};var Zoe=["b"],xoe=["v"],qw=function(e){return Math.round(Number(e||0))},Moe=function(e){if(e instanceof ia)return e;if(e&&Bn(e)==="object"&&"h"in e&&"b"in e){var t=e,i=t.b,a=_n(t,Zoe);return Ke(Ke({},a),{},{v:i})}return typeof e=="string"&&/hsb/.test(e)?e.replace(/hsb/,"hsv"):e},Op=function(n){Iu(t,n);var e=hu(t);function t(i){return to(this,t),e.call(this,Moe(i))}return no(t,[{key:"toHsbString",value:function(){var a=this.toHsb(),o=qw(a.s*100),r=qw(a.b*100),s=qw(a.h),l=a.a,c="hsb(".concat(s,", ").concat(o,"%, ").concat(r,"%)"),u="hsba(".concat(s,", ").concat(o,"%, ").concat(r,"%, ").concat(l.toFixed(l===0?0:2),")");return l===1?c:u}},{key:"toHsb",value:function(){var a=this.toHsv(),o=a.v,r=_n(a,xoe);return Ke(Ke({},r),{},{b:o,a:this.a})}}]),t}(ia),Woe=function(e){return e instanceof Op?e:new Op(e)};Woe("#1677ff");const Voe=(n,e)=>(n==null?void 0:n.replace(/[^\w/]/g,"").slice(0,e?8:6))||"",Noe=(n,e)=>n?Voe(n,e):"";let Eoe=function(){function n(e){to(this,n);var t;if(this.cleared=!1,e instanceof n){this.metaColor=e.metaColor.clone(),this.colors=(t=e.colors)===null||t===void 0?void 0:t.map(a=>({color:new n(a.color),percent:a.percent})),this.cleared=e.cleared;return}const i=Array.isArray(e);i&&e.length?(this.colors=e.map(a=>{let{color:o,percent:r}=a;return{color:new n(o),percent:r}}),this.metaColor=new Op(this.colors[0].color.metaColor)):this.metaColor=new Op(i?"":e),(!e||i&&!this.colors)&&(this.metaColor=this.metaColor.setA(0),this.cleared=!0)}return no(n,[{key:"toHsb",value:function(){return this.metaColor.toHsb()}},{key:"toHsbString",value:function(){return this.metaColor.toHsbString()}},{key:"toHex",value:function(){return Noe(this.toHexString(),this.metaColor.a<1)}},{key:"toHexString",value:function(){return this.metaColor.toHexString()}},{key:"toRgb",value:function(){return this.metaColor.toRgb()}},{key:"toRgbString",value:function(){return this.metaColor.toRgbString()}},{key:"isGradient",value:function(){return!!this.colors&&!this.cleared}},{key:"getColors",value:function(){return this.colors||[{color:this,percent:0}]}},{key:"toCssString",value:function(){const{colors:t}=this;return t?`linear-gradient(90deg, ${t.map(a=>`${a.color.toRgbString()} ${a.percent}%`).join(", ")})`:this.metaColor.toRgbString()}},{key:"equals",value:function(t){return!t||this.isGradient()!==t.isGradient()?!1:this.isGradient()?this.colors.length===t.colors.length&&this.colors.every((i,a)=>{const o=t.colors[a];return i.percent===o.percent&&i.color.equals(o.color)}):this.toHexString()===t.toHexString()}}])}();var Hoe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M765.7 486.8L314.9 134.7A7.97 7.97 0 00302 141v77.3c0 4.9 2.3 9.6 6.1 12.6l360 281.1-360 281.1c-3.9 3-6.1 7.7-6.1 12.6V883c0 6.7 7.7 10.4 12.9 6.3l450.8-352.1a31.96 31.96 0 000-50.4z"}}]},name:"right",theme:"outlined"},Foe=function(e,t){return v.createElement(io,$t({},e,{ref:t,icon:Hoe}))},VH=v.forwardRef(Foe);const Xoe=n=>({animationDuration:n,animationFillMode:"both"}),Toe=n=>({animationDuration:n,animationFillMode:"both"}),vM=function(n,e,t,i){const o=(arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1)?"&":"";return{[`
      ${o}${n}-enter,
      ${o}${n}-appear
    `]:Object.assign(Object.assign({},Xoe(i)),{animationPlayState:"paused"}),[`${o}${n}-leave`]:Object.assign(Object.assign({},Toe(i)),{animationPlayState:"paused"}),[`
      ${o}${n}-enter${n}-enter-active,
      ${o}${n}-appear${n}-appear-active
    `]:{animationName:e,animationPlayState:"running"},[`${o}${n}-leave${n}-leave-active`]:{animationName:t,animationPlayState:"running",pointerEvents:"none"}}},Yoe=new Ti("antMoveDownIn",{"0%":{transform:"translate3d(0, 100%, 0)",transformOrigin:"0 0",opacity:0},"100%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1}}),zoe=new Ti("antMoveDownOut",{"0%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1},"100%":{transform:"translate3d(0, 100%, 0)",transformOrigin:"0 0",opacity:0}}),Koe=new Ti("antMoveLeftIn",{"0%":{transform:"translate3d(-100%, 0, 0)",transformOrigin:"0 0",opacity:0},"100%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1}}),Loe=new Ti("antMoveLeftOut",{"0%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1},"100%":{transform:"translate3d(-100%, 0, 0)",transformOrigin:"0 0",opacity:0}}),_oe=new Ti("antMoveRightIn",{"0%":{transform:"translate3d(100%, 0, 0)",transformOrigin:"0 0",opacity:0},"100%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1}}),Doe=new Ti("antMoveRightOut",{"0%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1},"100%":{transform:"translate3d(100%, 0, 0)",transformOrigin:"0 0",opacity:0}}),Ooe=new Ti("antMoveUpIn",{"0%":{transform:"translate3d(0, -100%, 0)",transformOrigin:"0 0",opacity:0},"100%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1}}),Uoe=new Ti("antMoveUpOut",{"0%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1},"100%":{transform:"translate3d(0, -100%, 0)",transformOrigin:"0 0",opacity:0}}),koe={"move-up":{inKeyframes:Ooe,outKeyframes:Uoe},"move-down":{inKeyframes:Yoe,outKeyframes:zoe},"move-left":{inKeyframes:Koe,outKeyframes:Loe},"move-right":{inKeyframes:_oe,outKeyframes:Doe}},NH=(n,e)=>{const{antCls:t}=n,i=`${t}-${e}`,{inKeyframes:a,outKeyframes:o}=koe[e];return[vM(i,a,o,n.motionDurationMid),{[`
        ${i}-enter,
        ${i}-appear
      `]:{opacity:0,animationTimingFunction:n.motionEaseOutCirc},[`${i}-leave`]:{animationTimingFunction:n.motionEaseInOutCirc}}]},lz=new Ti("antSlideUpIn",{"0%":{transform:"scaleY(0.8)",transformOrigin:"0% 0%",opacity:0},"100%":{transform:"scaleY(1)",transformOrigin:"0% 0%",opacity:1}}),cz=new Ti("antSlideUpOut",{"0%":{transform:"scaleY(1)",transformOrigin:"0% 0%",opacity:1},"100%":{transform:"scaleY(0.8)",transformOrigin:"0% 0%",opacity:0}}),gz=new Ti("antSlideDownIn",{"0%":{transform:"scaleY(0.8)",transformOrigin:"100% 100%",opacity:0},"100%":{transform:"scaleY(1)",transformOrigin:"100% 100%",opacity:1}}),uz=new Ti("antSlideDownOut",{"0%":{transform:"scaleY(1)",transformOrigin:"100% 100%",opacity:1},"100%":{transform:"scaleY(0.8)",transformOrigin:"100% 100%",opacity:0}}),Poe=new Ti("antSlideLeftIn",{"0%":{transform:"scaleX(0.8)",transformOrigin:"0% 0%",opacity:0},"100%":{transform:"scaleX(1)",transformOrigin:"0% 0%",opacity:1}}),Joe=new Ti("antSlideLeftOut",{"0%":{transform:"scaleX(1)",transformOrigin:"0% 0%",opacity:1},"100%":{transform:"scaleX(0.8)",transformOrigin:"0% 0%",opacity:0}}),joe=new Ti("antSlideRightIn",{"0%":{transform:"scaleX(0.8)",transformOrigin:"100% 0%",opacity:0},"100%":{transform:"scaleX(1)",transformOrigin:"100% 0%",opacity:1}}),Qoe=new Ti("antSlideRightOut",{"0%":{transform:"scaleX(1)",transformOrigin:"100% 0%",opacity:1},"100%":{transform:"scaleX(0.8)",transformOrigin:"100% 0%",opacity:0}}),qoe={"slide-up":{inKeyframes:lz,outKeyframes:cz},"slide-down":{inKeyframes:gz,outKeyframes:uz},"slide-left":{inKeyframes:Poe,outKeyframes:Joe},"slide-right":{inKeyframes:joe,outKeyframes:Qoe}},kB=(n,e)=>{const{antCls:t}=n,i=`${t}-${e}`,{inKeyframes:a,outKeyframes:o}=qoe[e];return[vM(i,a,o,n.motionDurationMid),{[`
      ${i}-enter,
      ${i}-appear
    `]:{transform:"scale(0)",transformOrigin:"0% 0%",opacity:0,animationTimingFunction:n.motionEaseOutQuint,"&-prepare":{transform:"scale(1)"}},[`${i}-leave`]:{animationTimingFunction:n.motionEaseInQuint}}]},$oe=new Ti("antZoomIn",{"0%":{transform:"scale(0.2)",opacity:0},"100%":{transform:"scale(1)",opacity:1}}),ere=new Ti("antZoomOut",{"0%":{transform:"scale(1)"},"100%":{transform:"scale(0.2)",opacity:0}}),EH=new Ti("antZoomBigIn",{"0%":{transform:"scale(0.8)",opacity:0},"100%":{transform:"scale(1)",opacity:1}}),HH=new Ti("antZoomBigOut",{"0%":{transform:"scale(1)"},"100%":{transform:"scale(0.8)",opacity:0}}),tre=new Ti("antZoomUpIn",{"0%":{transform:"scale(0.8)",transformOrigin:"50% 0%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"50% 0%"}}),nre=new Ti("antZoomUpOut",{"0%":{transform:"scale(1)",transformOrigin:"50% 0%"},"100%":{transform:"scale(0.8)",transformOrigin:"50% 0%",opacity:0}}),ire=new Ti("antZoomLeftIn",{"0%":{transform:"scale(0.8)",transformOrigin:"0% 50%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"0% 50%"}}),are=new Ti("antZoomLeftOut",{"0%":{transform:"scale(1)",transformOrigin:"0% 50%"},"100%":{transform:"scale(0.8)",transformOrigin:"0% 50%",opacity:0}}),ore=new Ti("antZoomRightIn",{"0%":{transform:"scale(0.8)",transformOrigin:"100% 50%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"100% 50%"}}),rre=new Ti("antZoomRightOut",{"0%":{transform:"scale(1)",transformOrigin:"100% 50%"},"100%":{transform:"scale(0.8)",transformOrigin:"100% 50%",opacity:0}}),sre=new Ti("antZoomDownIn",{"0%":{transform:"scale(0.8)",transformOrigin:"50% 100%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"50% 100%"}}),lre=new Ti("antZoomDownOut",{"0%":{transform:"scale(1)",transformOrigin:"50% 100%"},"100%":{transform:"scale(0.8)",transformOrigin:"50% 100%",opacity:0}}),cre={zoom:{inKeyframes:$oe,outKeyframes:ere},"zoom-big":{inKeyframes:EH,outKeyframes:HH},"zoom-big-fast":{inKeyframes:EH,outKeyframes:HH},"zoom-left":{inKeyframes:ire,outKeyframes:are},"zoom-right":{inKeyframes:ore,outKeyframes:rre},"zoom-up":{inKeyframes:tre,outKeyframes:nre},"zoom-down":{inKeyframes:sre,outKeyframes:lre}},gre=(n,e)=>{const{antCls:t}=n,i=`${t}-${e}`,{inKeyframes:a,outKeyframes:o}=cre[e];return[vM(i,a,o,n.motionDurationFast),{[`
        ${i}-enter,
        ${i}-appear
      `]:{transform:"scale(0)",opacity:0,animationTimingFunction:n.motionEaseOutCirc,"&-prepare":{transform:"none"}},[`${i}-leave`]:{animationTimingFunction:n.motionEaseInOutCirc}}]},ure=(n,e)=>{const{r:t,g:i,b:a,a:o}=n.toRgb(),r=new Op(n.toRgbString()).onBackground(e).toHsv();return o<=.5?r.v>.5:t*.299+i*.587+a*.114>192},dz=n=>{const{paddingInline:e,onlyIconSize:t}=n;return Xi(n,{buttonPaddingHorizontal:e,buttonPaddingVertical:0,buttonIconOnlyFontSize:t})},Cz=n=>{var e,t,i,a,o,r;const s=(e=n.contentFontSize)!==null&&e!==void 0?e:n.fontSize,l=(t=n.contentFontSizeSM)!==null&&t!==void 0?t:n.fontSize,c=(i=n.contentFontSizeLG)!==null&&i!==void 0?i:n.fontSizeLG,u=(a=n.contentLineHeight)!==null&&a!==void 0?a:Xy(s),C=(o=n.contentLineHeightSM)!==null&&o!==void 0?o:Xy(l),h=(r=n.contentLineHeightLG)!==null&&r!==void 0?r:Xy(c),m=ure(new Eoe(n.colorBgSolid),"#fff")?"#000":"#fff",p=CI.reduce((B,b)=>Object.assign(Object.assign({},B),{[`${b}ShadowColor`]:`0 ${st(n.controlOutlineWidth)} 0 ${qm(n[`${b}1`],n.colorBgContainer)}`}),{});return Object.assign(Object.assign({},p),{fontWeight:400,defaultShadow:`0 ${n.controlOutlineWidth}px 0 ${n.controlTmpOutline}`,primaryShadow:`0 ${n.controlOutlineWidth}px 0 ${n.controlOutline}`,dangerShadow:`0 ${n.controlOutlineWidth}px 0 ${n.colorErrorOutline}`,primaryColor:n.colorTextLightSolid,dangerColor:n.colorTextLightSolid,borderColorDisabled:n.colorBorder,defaultGhostColor:n.colorBgContainer,ghostBg:"transparent",defaultGhostBorderColor:n.colorBgContainer,paddingInline:n.paddingContentHorizontal-n.lineWidth,paddingInlineLG:n.paddingContentHorizontal-n.lineWidth,paddingInlineSM:8-n.lineWidth,onlyIconSize:"inherit",onlyIconSizeSM:"inherit",onlyIconSizeLG:"inherit",groupBorderColor:n.colorPrimaryHover,linkHoverBg:"transparent",textTextColor:n.colorText,textTextHoverColor:n.colorText,textTextActiveColor:n.colorText,textHoverBg:n.colorFillTertiary,defaultColor:n.colorText,defaultBg:n.colorBgContainer,defaultBorderColor:n.colorBorder,defaultBorderColorDisabled:n.colorBorder,defaultHoverBg:n.colorBgContainer,defaultHoverColor:n.colorPrimaryHover,defaultHoverBorderColor:n.colorPrimaryHover,defaultActiveBg:n.colorBgContainer,defaultActiveColor:n.colorPrimaryActive,defaultActiveBorderColor:n.colorPrimaryActive,solidTextColor:m,contentFontSize:s,contentFontSizeSM:l,contentFontSizeLG:c,contentLineHeight:u,contentLineHeightSM:C,contentLineHeightLG:h,paddingBlock:Math.max((n.controlHeight-s*u)/2-n.lineWidth,0),paddingBlockSM:Math.max((n.controlHeightSM-l*C)/2-n.lineWidth,0),paddingBlockLG:Math.max((n.controlHeightLG-c*h)/2-n.lineWidth,0)})},dre=n=>{const{componentCls:e,iconCls:t,fontWeight:i,opacityLoading:a,motionDurationSlow:o,motionEaseInOut:r,marginXS:s,calc:l}=n;return{[e]:{outline:"none",position:"relative",display:"inline-flex",gap:n.marginXS,alignItems:"center",justifyContent:"center",fontWeight:i,whiteSpace:"nowrap",textAlign:"center",backgroundImage:"none",background:"transparent",border:`${st(n.lineWidth)} ${n.lineType} transparent`,cursor:"pointer",transition:`all ${n.motionDurationMid} ${n.motionEaseInOut}`,userSelect:"none",touchAction:"manipulation",color:n.colorText,"&:disabled > *":{pointerEvents:"none"},[`${e}-icon > svg`]:nS(),"> a":{color:"currentColor"},"&:not(:disabled)":Yf(n),[`&${e}-two-chinese-chars::first-letter`]:{letterSpacing:"0.34em"},[`&${e}-two-chinese-chars > *:not(${t})`]:{marginInlineEnd:"-0.34em",letterSpacing:"0.34em"},[`&${e}-icon-only`]:{paddingInline:0,[`&${e}-compact-item`]:{flex:"none"},[`&${e}-round`]:{width:"auto"}},[`&${e}-loading`]:{opacity:a,cursor:"default"},[`${e}-loading-icon`]:{transition:["width","opacity","margin"].map(c=>`${c} ${o} ${r}`).join(",")},[`&:not(${e}-icon-end)`]:{[`${e}-loading-icon-motion`]:{"&-appear-start, &-enter-start":{marginInlineEnd:l(s).mul(-1).equal()},"&-appear-active, &-enter-active":{marginInlineEnd:0},"&-leave-start":{marginInlineEnd:0},"&-leave-active":{marginInlineEnd:l(s).mul(-1).equal()}}},"&-icon-end":{flexDirection:"row-reverse",[`${e}-loading-icon-motion`]:{"&-appear-start, &-enter-start":{marginInlineStart:l(s).mul(-1).equal()},"&-appear-active, &-enter-active":{marginInlineStart:0},"&-leave-start":{marginInlineStart:0},"&-leave-active":{marginInlineStart:l(s).mul(-1).equal()}}}}}},Iz=(n,e,t)=>({[`&:not(:disabled):not(${n}-disabled)`]:{"&:hover":e,"&:active":t}}),Cre=n=>({minWidth:n.controlHeight,paddingInlineStart:0,paddingInlineEnd:0,borderRadius:"50%"}),Ire=n=>({borderRadius:n.controlHeight,paddingInlineStart:n.calc(n.controlHeight).div(2).equal(),paddingInlineEnd:n.calc(n.controlHeight).div(2).equal()}),hre=n=>({cursor:"not-allowed",borderColor:n.borderColorDisabled,color:n.colorTextDisabled,background:n.colorBgContainerDisabled,boxShadow:"none"}),oS=(n,e,t,i,a,o,r,s)=>({[`&${n}-background-ghost`]:Object.assign(Object.assign({color:t||void 0,background:e,borderColor:i||void 0,boxShadow:"none"},Iz(n,Object.assign({background:e},r),Object.assign({background:e},s))),{"&:disabled":{cursor:"not-allowed",color:a||void 0,borderColor:o||void 0}})}),fre=n=>({[`&:disabled, &${n.componentCls}-disabled`]:Object.assign({},hre(n))}),Are=n=>({[`&:disabled, &${n.componentCls}-disabled`]:{cursor:"not-allowed",color:n.colorTextDisabled}}),rS=(n,e,t,i)=>{const o=i&&["link","text"].includes(i)?Are:fre;return Object.assign(Object.assign({},o(n)),Iz(n.componentCls,e,t))},sS=(n,e,t,i,a)=>({[`&${n.componentCls}-variant-solid`]:Object.assign({color:e,background:t},rS(n,i,a))}),lS=(n,e,t,i,a)=>({[`&${n.componentCls}-variant-outlined, &${n.componentCls}-variant-dashed`]:Object.assign({borderColor:e,background:t},rS(n,i,a))}),cS=n=>({[`&${n.componentCls}-variant-dashed`]:{borderStyle:"dashed"}}),gS=(n,e,t,i)=>({[`&${n.componentCls}-variant-filled`]:Object.assign({boxShadow:"none",background:e},rS(n,t,i))}),fg=(n,e,t,i,a)=>({[`&${n.componentCls}-variant-${t}`]:Object.assign({color:e,boxShadow:"none"},rS(n,i,a,t))}),mre=n=>{const{componentCls:e}=n;return CI.reduce((t,i)=>{const a=n[`${i}6`],o=n[`${i}1`],r=n[`${i}5`],s=n[`${i}2`],l=n[`${i}3`],c=n[`${i}7`];return Object.assign(Object.assign({},t),{[`&${e}-color-${i}`]:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({color:a,boxShadow:n[`${i}ShadowColor`]},sS(n,n.colorTextLightSolid,a,{background:r},{background:c})),lS(n,a,n.colorBgContainer,{color:r,borderColor:r,background:n.colorBgContainer},{color:c,borderColor:c,background:n.colorBgContainer})),cS(n)),gS(n,o,{background:s},{background:l})),fg(n,a,"link",{color:r},{color:c})),fg(n,a,"text",{color:r,background:o},{color:c,background:l}))})},{})},pre=n=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({color:n.defaultColor,boxShadow:n.defaultShadow},sS(n,n.solidTextColor,n.colorBgSolid,{color:n.solidTextColor,background:n.colorBgSolidHover},{color:n.solidTextColor,background:n.colorBgSolidActive})),cS(n)),gS(n,n.colorFillTertiary,{background:n.colorFillSecondary},{background:n.colorFill})),oS(n.componentCls,n.ghostBg,n.defaultGhostColor,n.defaultGhostBorderColor,n.colorTextDisabled,n.colorBorder)),fg(n,n.textTextColor,"link",{color:n.colorLinkHover,background:n.linkHoverBg},{color:n.colorLinkActive})),bre=n=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({color:n.colorPrimary,boxShadow:n.primaryShadow},lS(n,n.colorPrimary,n.colorBgContainer,{color:n.colorPrimaryTextHover,borderColor:n.colorPrimaryHover,background:n.colorBgContainer},{color:n.colorPrimaryTextActive,borderColor:n.colorPrimaryActive,background:n.colorBgContainer})),cS(n)),gS(n,n.colorPrimaryBg,{background:n.colorPrimaryBgHover},{background:n.colorPrimaryBorder})),fg(n,n.colorPrimaryText,"text",{color:n.colorPrimaryTextHover,background:n.colorPrimaryBg},{color:n.colorPrimaryTextActive,background:n.colorPrimaryBorder})),fg(n,n.colorPrimaryText,"link",{color:n.colorPrimaryTextHover,background:n.linkHoverBg},{color:n.colorPrimaryTextActive})),oS(n.componentCls,n.ghostBg,n.colorPrimary,n.colorPrimary,n.colorTextDisabled,n.colorBorder,{color:n.colorPrimaryHover,borderColor:n.colorPrimaryHover},{color:n.colorPrimaryActive,borderColor:n.colorPrimaryActive})),vre=n=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({color:n.colorError,boxShadow:n.dangerShadow},sS(n,n.dangerColor,n.colorError,{background:n.colorErrorHover},{background:n.colorErrorActive})),lS(n,n.colorError,n.colorBgContainer,{color:n.colorErrorHover,borderColor:n.colorErrorBorderHover},{color:n.colorErrorActive,borderColor:n.colorErrorActive})),cS(n)),gS(n,n.colorErrorBg,{background:n.colorErrorBgFilledHover},{background:n.colorErrorBgActive})),fg(n,n.colorError,"text",{color:n.colorErrorHover,background:n.colorErrorBg},{color:n.colorErrorHover,background:n.colorErrorBgActive})),fg(n,n.colorError,"link",{color:n.colorErrorHover},{color:n.colorErrorActive})),oS(n.componentCls,n.ghostBg,n.colorError,n.colorError,n.colorTextDisabled,n.colorBorder,{color:n.colorErrorHover,borderColor:n.colorErrorHover},{color:n.colorErrorActive,borderColor:n.colorErrorActive})),yre=n=>Object.assign(Object.assign({},fg(n,n.colorLink,"link",{color:n.colorLinkHover},{color:n.colorLinkActive})),oS(n.componentCls,n.ghostBg,n.colorInfo,n.colorInfo,n.colorTextDisabled,n.colorBorder,{color:n.colorInfoHover,borderColor:n.colorInfoHover},{color:n.colorInfoActive,borderColor:n.colorInfoActive})),Bre=n=>{const{componentCls:e}=n;return Object.assign({[`${e}-color-default`]:pre(n),[`${e}-color-primary`]:bre(n),[`${e}-color-dangerous`]:vre(n),[`${e}-color-link`]:yre(n)},mre(n))},Gre=n=>Object.assign(Object.assign(Object.assign(Object.assign({},lS(n,n.defaultBorderColor,n.defaultBg,{color:n.defaultHoverColor,borderColor:n.defaultHoverBorderColor,background:n.defaultHoverBg},{color:n.defaultActiveColor,borderColor:n.defaultActiveBorderColor,background:n.defaultActiveBg})),fg(n,n.textTextColor,"text",{color:n.textTextHoverColor,background:n.textHoverBg},{color:n.textTextActiveColor,background:n.colorBgTextActive})),sS(n,n.primaryColor,n.colorPrimary,{background:n.colorPrimaryHover,color:n.primaryColor},{background:n.colorPrimaryActive,color:n.primaryColor})),fg(n,n.colorLink,"link",{color:n.colorLinkHover,background:n.linkHoverBg},{color:n.colorLinkActive})),yM=function(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const{componentCls:t,controlHeight:i,fontSize:a,borderRadius:o,buttonPaddingHorizontal:r,iconCls:s,buttonPaddingVertical:l,buttonIconOnlyFontSize:c}=n;return[{[e]:{fontSize:a,height:i,padding:`${st(l)} ${st(r)}`,borderRadius:o,[`&${t}-icon-only`]:{width:i,[s]:{fontSize:c}}}},{[`${t}${t}-circle${e}`]:Cre(n)},{[`${t}${t}-round${e}`]:Ire(n)}]},Sre=n=>{const e=Xi(n,{fontSize:n.contentFontSize});return yM(e,n.componentCls)},wre=n=>{const e=Xi(n,{controlHeight:n.controlHeightSM,fontSize:n.contentFontSizeSM,padding:n.paddingXS,buttonPaddingHorizontal:n.paddingInlineSM,buttonPaddingVertical:0,borderRadius:n.borderRadiusSM,buttonIconOnlyFontSize:n.onlyIconSizeSM});return yM(e,`${n.componentCls}-sm`)},Rre=n=>{const e=Xi(n,{controlHeight:n.controlHeightLG,fontSize:n.contentFontSizeLG,buttonPaddingHorizontal:n.paddingInlineLG,buttonPaddingVertical:0,borderRadius:n.borderRadiusLG,buttonIconOnlyFontSize:n.onlyIconSizeLG});return yM(e,`${n.componentCls}-lg`)},Zre=n=>{const{componentCls:e}=n;return{[e]:{[`&${e}-block`]:{width:"100%"}}}},xre=Oa("Button",n=>{const e=dz(n);return[dre(e),Sre(e),wre(e),Rre(e),Zre(e),Bre(e),Gre(e),Roe(e)]},Cz,{unitless:{fontWeight:!0,contentLineHeight:!0,contentLineHeightSM:!0,contentLineHeightLG:!0}});function Mre(n,e,t){const{focusElCls:i,focus:a,borderElCls:o}=t,r=o?"> *":"",s=["hover",a?"focus":null,"active"].filter(Boolean).map(l=>`&:${l} ${r}`).join(",");return{[`&-item:not(${e}-last-item)`]:{marginInlineEnd:n.calc(n.lineWidth).mul(-1).equal()},"&-item":Object.assign(Object.assign({[s]:{zIndex:2}},i?{[`&${i}`]:{zIndex:2}}:{}),{[`&[disabled] ${r}`]:{zIndex:0}})}}function Wre(n,e,t){const{borderElCls:i}=t,a=i?`> ${i}`:"";return{[`&-item:not(${e}-first-item):not(${e}-last-item) ${a}`]:{borderRadius:0},[`&-item:not(${e}-last-item)${e}-first-item`]:{[`& ${a}, &${n}-sm ${a}, &${n}-lg ${a}`]:{borderStartEndRadius:0,borderEndEndRadius:0}},[`&-item:not(${e}-first-item)${e}-last-item`]:{[`& ${a}, &${n}-sm ${a}, &${n}-lg ${a}`]:{borderStartStartRadius:0,borderEndStartRadius:0}}}}function BM(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{focus:!0};const{componentCls:t}=n,i=`${t}-compact`;return{[i]:Object.assign(Object.assign({},Mre(n,i,e)),Wre(t,i,e))}}function Vre(n,e){return{[`&-item:not(${e}-last-item)`]:{marginBottom:n.calc(n.lineWidth).mul(-1).equal()},"&-item":{"&:hover,&:focus,&:active":{zIndex:2},"&[disabled]":{zIndex:0}}}}function Nre(n,e){return{[`&-item:not(${e}-first-item):not(${e}-last-item)`]:{borderRadius:0},[`&-item${e}-first-item:not(${e}-last-item)`]:{[`&, &${n}-sm, &${n}-lg`]:{borderEndEndRadius:0,borderEndStartRadius:0}},[`&-item${e}-last-item:not(${e}-first-item)`]:{[`&, &${n}-sm, &${n}-lg`]:{borderStartStartRadius:0,borderStartEndRadius:0}}}}function Ere(n){const e=`${n.componentCls}-compact-vertical`;return{[e]:Object.assign(Object.assign({},Vre(n,e)),Nre(n.componentCls,e))}}const Hre=n=>{const{componentCls:e,colorPrimaryHover:t,lineWidth:i,calc:a}=n,o=a(i).mul(-1).equal(),r=s=>{const l=`${e}-compact${s?"-vertical":""}-item${e}-primary:not([disabled])`;return{[`${l} + ${l}::before`]:{position:"absolute",top:s?o:0,insetInlineStart:s?0:o,backgroundColor:t,content:'""',width:s?"100%":i,height:s?i:"100%"}}};return Object.assign(Object.assign({},r()),r(!0))},Fre=FY(["Button","compact"],n=>{const e=dz(n);return[BM(e),Ere(e),Hre(e)]},Cz);var Xre=function(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(n);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(n,i[a])&&(t[i[a]]=n[i[a]]);return t};function Tre(n){if(typeof n=="object"&&n){let e=n==null?void 0:n.delay;return e=!Number.isNaN(e)&&typeof e=="number"?e:0,{loading:e<=0,delay:e}}return{loading:!!n,delay:0}}const Yre={default:["default","outlined"],primary:["primary","solid"],dashed:["default","dashed"],link:["link","link"],text:["default","text"]},zre=Ct.forwardRef((n,e)=>{var t,i;const{loading:a=!1,prefixCls:o,color:r,variant:s,type:l,danger:c=!1,shape:u="default",size:C,styles:h,disabled:m,className:p,rootClassName:B,children:b,icon:y,iconPosition:S="start",ghost:R=!1,block:Z=!1,htmlType:x="button",classNames:M,style:E={},autoInsertSpace:F,autoFocus:N}=n,H=Xre(n,["loading","prefixCls","color","variant","type","danger","shape","size","styles","disabled","className","rootClassName","children","icon","iconPosition","ghost","block","htmlType","classNames","style","autoInsertSpace","autoFocus"]),z=l||"default",[_,D]=v.useMemo(()=>{if(r&&s)return[r,s];const ke=Yre[z]||[];return c?["danger",ke[1]]:ke},[l,r,s,c]),$=_==="danger"?"dangerous":_,{getPrefixCls:X,direction:L,autoInsertSpace:U,className:q,style:K,classNames:O,styles:j}=Gs("button"),ne=(t=F??U)!==null&&t!==void 0?t:!0,k=X("btn",o),[ie,re,ge]=xre(k),de=v.useContext(hg),xe=m??de,Ne=v.useContext(sz),ye=v.useMemo(()=>Tre(a),[a]),[pe,Te]=v.useState(ye.loading),[le,Ye]=v.useState(!1),he=v.useRef(null),Ge=yI(e,he),be=v.Children.count(b)===1&&!y&&!Jw(D),Ee=v.useRef(!0);Ct.useEffect(()=>(Ee.current=!1,()=>{Ee.current=!0}),[]),v.useEffect(()=>{let ke=null;ye.delay>0?ke=setTimeout(()=>{ke=null,Te(!0)},ye.delay):Te(ye.loading);function Ce(){ke&&(clearTimeout(ke),ke=null)}return Ce},[ye]),v.useEffect(()=>{if(!he.current||!ne)return;const ke=he.current.textContent||"";be&&JR(ke)?le||Ye(!0):le&&Ye(!1)}),v.useEffect(()=>{N&&he.current&&he.current.focus()},[]);const Se=Ct.useCallback(ke=>{var Ce;if(pe||xe){ke.preventDefault();return}(Ce=n.onClick)===null||Ce===void 0||Ce.call(n,("href"in n,ke))},[n.onClick,pe,xe]),{compactSize:ee,compactItemClassnames:Q}=Bb(k,L),ce={large:"lg",small:"sm",middle:void 0},me=Sl(ke=>{var Ce,He;return(He=(Ce=C??ee)!==null&&Ce!==void 0?Ce:Ne)!==null&&He!==void 0?He:ke}),Ze=me&&(i=ce[me])!==null&&i!==void 0?i:"",Xe=pe?"loading":y,De=Ss(H,["navigate"]),Oe=gt(k,re,ge,{[`${k}-${u}`]:u!=="default"&&u,[`${k}-${z}`]:z,[`${k}-dangerous`]:c,[`${k}-color-${$}`]:$,[`${k}-variant-${D}`]:D,[`${k}-${Ze}`]:Ze,[`${k}-icon-only`]:!b&&b!==0&&!!Xe,[`${k}-background-ghost`]:R&&!Jw(D),[`${k}-loading`]:pe,[`${k}-two-chinese-chars`]:le&&ne&&!pe,[`${k}-block`]:Z,[`${k}-rtl`]:L==="rtl",[`${k}-icon-end`]:S==="end"},Q,p,B,q),Je=Object.assign(Object.assign({},K),E),At=gt(M==null?void 0:M.icon,O.icon),qe=Object.assign(Object.assign({},(h==null?void 0:h.icon)||{}),j.icon||{}),lt=y&&!pe?Ct.createElement(jR,{prefixCls:k,className:At,style:qe},y):a&&typeof a=="object"&&a.icon?Ct.createElement(jR,{prefixCls:k,className:At,style:qe},a.icon):Ct.createElement(woe,{existIcon:!!y,prefixCls:k,loading:pe,mount:Ee.current}),$e=b||b===0?Soe(b,be&&ne):null;if(De.href!==void 0)return ie(Ct.createElement("a",Object.assign({},De,{className:gt(Oe,{[`${k}-disabled`]:xe}),href:xe?void 0:De.href,style:Je,onClick:Se,ref:Ge,tabIndex:xe?-1:0}),lt,$e));let je=Ct.createElement("button",Object.assign({},H,{type:x,className:Oe,style:Je,onClick:Se,disabled:xe,ref:Ge}),lt,$e,Q&&Ct.createElement(Fre,{prefixCls:k}));return Jw(D)||(je=Ct.createElement(az,{component:"Button",disabled:pe},je)),ie(je)}),xo=zre;xo.Group=Boe;xo.__ANT_BUTTON=!0;var hz=v.createContext(null),FH=[];function Kre(n,e){var t=v.useState(function(){if(!kr())return null;var p=document.createElement("div");return p}),i=rt(t,1),a=i[0],o=v.useRef(!1),r=v.useContext(hz),s=v.useState(FH),l=rt(s,2),c=l[0],u=l[1],C=r||(o.current?void 0:function(p){u(function(B){var b=[p].concat(an(B));return b})});function h(){a.parentElement||document.body.appendChild(a),o.current=!0}function m(){var p;(p=a.parentElement)===null||p===void 0||p.removeChild(a),o.current=!1}return xi(function(){return n?r?r(h):h():m(),m},[n]),xi(function(){c.length&&(c.forEach(function(p){return p()}),u(FH))},[c]),[a,C]}function Lre(n){var e="rc-scrollbar-measure-".concat(Math.random().toString(36).substring(7)),t=document.createElement("div");t.id=e;var i=t.style;i.position="absolute",i.left="0",i.top="0",i.width="100px",i.height="100px",i.overflow="scroll";var a,o;if(n){var r=getComputedStyle(n);i.scrollbarColor=r.scrollbarColor,i.scrollbarWidth=r.scrollbarWidth;var s=getComputedStyle(n,"::-webkit-scrollbar"),l=parseInt(s.width,10),c=parseInt(s.height,10);try{var u=l?"width: ".concat(s.width,";"):"",C=c?"height: ".concat(s.height,";"):"";lu(`
#`.concat(e,`::-webkit-scrollbar {
`).concat(u,`
`).concat(C,`
}`),e)}catch(p){console.error(p),a=l,o=c}}document.body.appendChild(t);var h=n&&a&&!isNaN(a)?a:t.offsetWidth-t.clientWidth,m=n&&o&&!isNaN(o)?o:t.offsetHeight-t.clientHeight;return document.body.removeChild(t),zp(e),{width:h,height:m}}function _re(n){return typeof document>"u"||!n||!(n instanceof Element)?{width:0,height:0}:Lre(n)}function Dre(){return document.body.scrollHeight>(window.innerHeight||document.documentElement.clientHeight)&&window.innerWidth>document.body.offsetWidth}var Ore="rc-util-locker-".concat(Date.now()),XH=0;function Ure(n){var e=!!n,t=v.useState(function(){return XH+=1,"".concat(Ore,"_").concat(XH)}),i=rt(t,1),a=i[0];xi(function(){if(e){var o=_re(document.body).width,r=Dre();lu(`
html body {
  overflow-y: hidden;
  `.concat(r?"width: calc(100% - ".concat(o,"px);"):"",`
}`),a)}else zp(a);return function(){zp(a)}},[e,a])}var kre=!1;function Pre(n){return kre}var TH=function(e){return e===!1?!1:!kr()||!e?null:typeof e=="string"?document.querySelector(e):typeof e=="function"?e():e},fz=v.forwardRef(function(n,e){var t=n.open,i=n.autoLock,a=n.getContainer;n.debug;var o=n.autoDestroy,r=o===void 0?!0:o,s=n.children,l=v.useState(t),c=rt(l,2),u=c[0],C=c[1],h=u||t;v.useEffect(function(){(r||t)&&C(t)},[t,r]);var m=v.useState(function(){return TH(a)}),p=rt(m,2),B=p[0],b=p[1];v.useEffect(function(){var z=TH(a);b(z??null)});var y=Kre(h&&!B),S=rt(y,2),R=S[0],Z=S[1],x=B??R;Ure(i&&t&&kr()&&(x===R||x===document.body));var M=null;if(s&&BI(s)&&e){var E=s;M=E.ref}var F=yI(M,e);if(!h||!kr()||B===void 0)return null;var N=x===!1||Pre(),H=s;return e&&(H=v.cloneElement(s,{ref:F})),v.createElement(hz.Provider,{value:Z},N?H:md.createPortal(H,x))});function Jre(){var n=Ke({},tG);return n.useId}var YH=0,zH=Jre();const GM=zH?function(e){var t=zH();return e||t}:function(e){var t=v.useState("ssr-id"),i=rt(t,2),a=i[0],o=i[1];return v.useEffect(function(){var r=YH;YH+=1,o("rc_unique_".concat(r))},[]),e||a};var qC="RC_FORM_INTERNAL_HOOKS",qi=function(){No(!1,"Can not find FormContext. Please make sure you wrap Field under Form.")},zf=v.createContext({getFieldValue:qi,getFieldsValue:qi,getFieldError:qi,getFieldWarning:qi,getFieldsError:qi,isFieldsTouched:qi,isFieldTouched:qi,isFieldValidating:qi,isFieldsValidating:qi,resetFields:qi,setFields:qi,setFieldValue:qi,setFieldsValue:qi,validateFields:qi,submit:qi,getInternalHooks:function(){return qi(),{dispatch:qi,initEntityValue:qi,registerField:qi,useSubscribe:qi,setInitialValues:qi,destroyForm:qi,setCallbacks:qi,registerWatch:qi,getFields:qi,setValidateMessages:qi,setPreserve:qi,getInitialValue:qi}}}),PB=v.createContext(null);function QR(n){return n==null?[]:Array.isArray(n)?n:[n]}function jre(n){return n&&!!n._init}function qR(){return{default:"Validation error on field %s",required:"%s is required",enum:"%s must be one of %s",whitespace:"%s cannot be empty",date:{format:"%s date %s is invalid for format %s",parse:"%s date could not be parsed, %s is invalid ",invalid:"%s date %s is invalid"},types:{string:"%s is not a %s",method:"%s is not a %s (function)",array:"%s is not an %s",object:"%s is not an %s",number:"%s is not a %s",date:"%s is not a %s",boolean:"%s is not a %s",integer:"%s is not an %s",float:"%s is not a %s",regexp:"%s is not a valid %s",email:"%s is not a valid %s",url:"%s is not a valid %s",hex:"%s is not a valid %s"},string:{len:"%s must be exactly %s characters",min:"%s must be at least %s characters",max:"%s cannot be longer than %s characters",range:"%s must be between %s and %s characters"},number:{len:"%s must equal %s",min:"%s cannot be less than %s",max:"%s cannot be greater than %s",range:"%s must be between %s and %s"},array:{len:"%s must be exactly %s in length",min:"%s cannot be less than %s in length",max:"%s cannot be greater than %s in length",range:"%s must be between %s and %s in length"},pattern:{mismatch:"%s value %s does not match pattern %s"},clone:function(){var e=JSON.parse(JSON.stringify(this));return e.clone=this.clone,e}}}var $R=qR();function Qre(n){try{return Function.toString.call(n).indexOf("[native code]")!==-1}catch{return typeof n=="function"}}function qre(n,e,t){if(oM())return Reflect.construct.apply(null,arguments);var i=[null];i.push.apply(i,e);var a=new(n.bind.apply(n,i));return t&&Xp(a,t.prototype),a}function eZ(n){var e=typeof Map=="function"?new Map:void 0;return eZ=function(i){if(i===null||!Qre(i))return i;if(typeof i!="function")throw new TypeError("Super expression must either be null or a function");if(e!==void 0){if(e.has(i))return e.get(i);e.set(i,a)}function a(){return qre(i,arguments,Tp(this).constructor)}return a.prototype=Object.create(i.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),Xp(a,i)},eZ(n)}var $re=/%[sdj%]/g,ese=function(){};function tZ(n){if(!n||!n.length)return null;var e={};return n.forEach(function(t){var i=t.field;e[i]=e[i]||[],e[i].push(t)}),e}function _s(n){for(var e=arguments.length,t=new Array(e>1?e-1:0),i=1;i<e;i++)t[i-1]=arguments[i];var a=0,o=t.length;if(typeof n=="function")return n.apply(null,t);if(typeof n=="string"){var r=n.replace($re,function(s){if(s==="%%")return"%";if(a>=o)return s;switch(s){case"%s":return String(t[a++]);case"%d":return Number(t[a++]);case"%j":try{return JSON.stringify(t[a++])}catch{return"[Circular]"}break;default:return s}});return r}return n}function tse(n){return n==="string"||n==="url"||n==="hex"||n==="email"||n==="date"||n==="pattern"}function mo(n,e){return!!(n==null||e==="array"&&Array.isArray(n)&&!n.length||tse(e)&&typeof n=="string"&&!n)}function nse(n,e,t){var i=[],a=0,o=n.length;function r(s){i.push.apply(i,an(s||[])),a++,a===o&&t(i)}n.forEach(function(s){e(s,r)})}function KH(n,e,t){var i=0,a=n.length;function o(r){if(r&&r.length){t(r);return}var s=i;i=i+1,s<a?e(n[s],o):t([])}o([])}function ise(n){var e=[];return Object.keys(n).forEach(function(t){e.push.apply(e,an(n[t]||[]))}),e}var LH=function(n){Iu(t,n);var e=hu(t);function t(i,a){var o;return to(this,t),o=e.call(this,"Async Validation Error"),Ve(si(o),"errors",void 0),Ve(si(o),"fields",void 0),o.errors=i,o.fields=a,o}return no(t)}(eZ(Error));function ase(n,e,t,i,a){if(e.first){var o=new Promise(function(h,m){var p=function(y){return i(y),y.length?m(new LH(y,tZ(y))):h(a)},B=ise(n);KH(B,t,p)});return o.catch(function(h){return h}),o}var r=e.firstFields===!0?Object.keys(n):e.firstFields||[],s=Object.keys(n),l=s.length,c=0,u=[],C=new Promise(function(h,m){var p=function(b){if(u.push.apply(u,b),c++,c===l)return i(u),u.length?m(new LH(u,tZ(u))):h(a)};s.length||(i(u),h(a)),s.forEach(function(B){var b=n[B];r.indexOf(B)!==-1?KH(b,t,p):nse(b,t,p)})});return C.catch(function(h){return h}),C}function ose(n){return!!(n&&n.message!==void 0)}function rse(n,e){for(var t=n,i=0;i<e.length;i++){if(t==null)return t;t=t[e[i]]}return t}function _H(n,e){return function(t){var i;return n.fullFields?i=rse(e,n.fullFields):i=e[t.field||n.fullField],ose(t)?(t.field=t.field||n.fullField,t.fieldValue=i,t):{message:typeof t=="function"?t():t,fieldValue:i,field:t.field||n.fullField}}}function DH(n,e){if(e){for(var t in e)if(e.hasOwnProperty(t)){var i=e[t];Bn(i)==="object"&&Bn(n[t])==="object"?n[t]=Ke(Ke({},n[t]),i):n[t]=i}}return n}var Uh="enum",sse=function(e,t,i,a,o){e[Uh]=Array.isArray(e[Uh])?e[Uh]:[],e[Uh].indexOf(t)===-1&&a.push(_s(o.messages[Uh],e.fullField,e[Uh].join(", ")))},lse=function(e,t,i,a,o){if(e.pattern){if(e.pattern instanceof RegExp)e.pattern.lastIndex=0,e.pattern.test(t)||a.push(_s(o.messages.pattern.mismatch,e.fullField,t,e.pattern));else if(typeof e.pattern=="string"){var r=new RegExp(e.pattern);r.test(t)||a.push(_s(o.messages.pattern.mismatch,e.fullField,t,e.pattern))}}},cse=function(e,t,i,a,o){var r=typeof e.len=="number",s=typeof e.min=="number",l=typeof e.max=="number",c=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,u=t,C=null,h=typeof t=="number",m=typeof t=="string",p=Array.isArray(t);if(h?C="number":m?C="string":p&&(C="array"),!C)return!1;p&&(u=t.length),m&&(u=t.replace(c,"_").length),r?u!==e.len&&a.push(_s(o.messages[C].len,e.fullField,e.len)):s&&!l&&u<e.min?a.push(_s(o.messages[C].min,e.fullField,e.min)):l&&!s&&u>e.max?a.push(_s(o.messages[C].max,e.fullField,e.max)):s&&l&&(u<e.min||u>e.max)&&a.push(_s(o.messages[C].range,e.fullField,e.min,e.max))},Az=function(e,t,i,a,o,r){e.required&&(!i.hasOwnProperty(e.field)||mo(t,r||e.type))&&a.push(_s(o.messages.required,e.fullField))},ay;const gse=function(){if(ay)return ay;var n="[a-fA-F\\d:]",e=function(M){return M&&M.includeBoundaries?"(?:(?<=\\s|^)(?=".concat(n,")|(?<=").concat(n,")(?=\\s|$))"):""},t="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",i="[a-fA-F\\d]{1,4}",a=["(?:".concat(i,":){7}(?:").concat(i,"|:)"),"(?:".concat(i,":){6}(?:").concat(t,"|:").concat(i,"|:)"),"(?:".concat(i,":){5}(?::").concat(t,"|(?::").concat(i,"){1,2}|:)"),"(?:".concat(i,":){4}(?:(?::").concat(i,"){0,1}:").concat(t,"|(?::").concat(i,"){1,3}|:)"),"(?:".concat(i,":){3}(?:(?::").concat(i,"){0,2}:").concat(t,"|(?::").concat(i,"){1,4}|:)"),"(?:".concat(i,":){2}(?:(?::").concat(i,"){0,3}:").concat(t,"|(?::").concat(i,"){1,5}|:)"),"(?:".concat(i,":){1}(?:(?::").concat(i,"){0,4}:").concat(t,"|(?::").concat(i,"){1,6}|:)"),"(?::(?:(?::".concat(i,"){0,5}:").concat(t,"|(?::").concat(i,"){1,7}|:))")],o="(?:%[0-9a-zA-Z]{1,})?",r="(?:".concat(a.join("|"),")").concat(o),s=new RegExp("(?:^".concat(t,"$)|(?:^").concat(r,"$)")),l=new RegExp("^".concat(t,"$")),c=new RegExp("^".concat(r,"$")),u=function(M){return M&&M.exact?s:new RegExp("(?:".concat(e(M)).concat(t).concat(e(M),")|(?:").concat(e(M)).concat(r).concat(e(M),")"),"g")};u.v4=function(x){return x&&x.exact?l:new RegExp("".concat(e(x)).concat(t).concat(e(x)),"g")},u.v6=function(x){return x&&x.exact?c:new RegExp("".concat(e(x)).concat(r).concat(e(x)),"g")};var C="(?:(?:[a-z]+:)?//)",h="(?:\\S+(?::\\S*)?@)?",m=u.v4().source,p=u.v6().source,B="(?:(?:[a-z\\u00a1-\\uffff0-9][-_]*)*[a-z\\u00a1-\\uffff0-9]+)",b="(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*",y="(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))",S="(?::\\d{2,5})?",R='(?:[/?#][^\\s"]*)?',Z="(?:".concat(C,"|www\\.)").concat(h,"(?:localhost|").concat(m,"|").concat(p,"|").concat(B).concat(b).concat(y,")").concat(S).concat(R);return ay=new RegExp("(?:^".concat(Z,"$)"),"i"),ay};var OH={email:/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+\.)+[a-zA-Z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]{2,}))$/,hex:/^#?([a-f0-9]{6}|[a-f0-9]{3})$/i},$m={integer:function(e){return $m.number(e)&&parseInt(e,10)===e},float:function(e){return $m.number(e)&&!$m.integer(e)},array:function(e){return Array.isArray(e)},regexp:function(e){if(e instanceof RegExp)return!0;try{return!!new RegExp(e)}catch{return!1}},date:function(e){return typeof e.getTime=="function"&&typeof e.getMonth=="function"&&typeof e.getYear=="function"&&!isNaN(e.getTime())},number:function(e){return isNaN(e)?!1:typeof e=="number"},object:function(e){return Bn(e)==="object"&&!$m.array(e)},method:function(e){return typeof e=="function"},email:function(e){return typeof e=="string"&&e.length<=320&&!!e.match(OH.email)},url:function(e){return typeof e=="string"&&e.length<=2048&&!!e.match(gse())},hex:function(e){return typeof e=="string"&&!!e.match(OH.hex)}},use=function(e,t,i,a,o){if(e.required&&t===void 0){Az(e,t,i,a,o);return}var r=["integer","float","array","regexp","object","method","email","number","date","url","hex"],s=e.type;r.indexOf(s)>-1?$m[s](t)||a.push(_s(o.messages.types[s],e.fullField,e.type)):s&&Bn(t)!==e.type&&a.push(_s(o.messages.types[s],e.fullField,e.type))},dse=function(e,t,i,a,o){(/^\s+$/.test(t)||t==="")&&a.push(_s(o.messages.whitespace,e.fullField))};const Ai={required:Az,whitespace:dse,type:use,range:cse,enum:sse,pattern:lse};var Cse=function(e,t,i,a,o){var r=[],s=e.required||!e.required&&a.hasOwnProperty(e.field);if(s){if(mo(t)&&!e.required)return i();Ai.required(e,t,a,r,o)}i(r)},Ise=function(e,t,i,a,o){var r=[],s=e.required||!e.required&&a.hasOwnProperty(e.field);if(s){if(t==null&&!e.required)return i();Ai.required(e,t,a,r,o,"array"),t!=null&&(Ai.type(e,t,a,r,o),Ai.range(e,t,a,r,o))}i(r)},hse=function(e,t,i,a,o){var r=[],s=e.required||!e.required&&a.hasOwnProperty(e.field);if(s){if(mo(t)&&!e.required)return i();Ai.required(e,t,a,r,o),t!==void 0&&Ai.type(e,t,a,r,o)}i(r)},fse=function(e,t,i,a,o){var r=[],s=e.required||!e.required&&a.hasOwnProperty(e.field);if(s){if(mo(t,"date")&&!e.required)return i();if(Ai.required(e,t,a,r,o),!mo(t,"date")){var l;t instanceof Date?l=t:l=new Date(t),Ai.type(e,l,a,r,o),l&&Ai.range(e,l.getTime(),a,r,o)}}i(r)},Ase="enum",mse=function(e,t,i,a,o){var r=[],s=e.required||!e.required&&a.hasOwnProperty(e.field);if(s){if(mo(t)&&!e.required)return i();Ai.required(e,t,a,r,o),t!==void 0&&Ai[Ase](e,t,a,r,o)}i(r)},pse=function(e,t,i,a,o){var r=[],s=e.required||!e.required&&a.hasOwnProperty(e.field);if(s){if(mo(t)&&!e.required)return i();Ai.required(e,t,a,r,o),t!==void 0&&(Ai.type(e,t,a,r,o),Ai.range(e,t,a,r,o))}i(r)},bse=function(e,t,i,a,o){var r=[],s=e.required||!e.required&&a.hasOwnProperty(e.field);if(s){if(mo(t)&&!e.required)return i();Ai.required(e,t,a,r,o),t!==void 0&&(Ai.type(e,t,a,r,o),Ai.range(e,t,a,r,o))}i(r)},vse=function(e,t,i,a,o){var r=[],s=e.required||!e.required&&a.hasOwnProperty(e.field);if(s){if(mo(t)&&!e.required)return i();Ai.required(e,t,a,r,o),t!==void 0&&Ai.type(e,t,a,r,o)}i(r)},yse=function(e,t,i,a,o){var r=[],s=e.required||!e.required&&a.hasOwnProperty(e.field);if(s){if(t===""&&(t=void 0),mo(t)&&!e.required)return i();Ai.required(e,t,a,r,o),t!==void 0&&(Ai.type(e,t,a,r,o),Ai.range(e,t,a,r,o))}i(r)},Bse=function(e,t,i,a,o){var r=[],s=e.required||!e.required&&a.hasOwnProperty(e.field);if(s){if(mo(t)&&!e.required)return i();Ai.required(e,t,a,r,o),t!==void 0&&Ai.type(e,t,a,r,o)}i(r)},Gse=function(e,t,i,a,o){var r=[],s=e.required||!e.required&&a.hasOwnProperty(e.field);if(s){if(mo(t,"string")&&!e.required)return i();Ai.required(e,t,a,r,o),mo(t,"string")||Ai.pattern(e,t,a,r,o)}i(r)},Sse=function(e,t,i,a,o){var r=[],s=e.required||!e.required&&a.hasOwnProperty(e.field);if(s){if(mo(t)&&!e.required)return i();Ai.required(e,t,a,r,o),mo(t)||Ai.type(e,t,a,r,o)}i(r)},wse=function(e,t,i,a,o){var r=[],s=Array.isArray(t)?"array":Bn(t);Ai.required(e,t,a,r,o,s),i(r)},Rse=function(e,t,i,a,o){var r=[],s=e.required||!e.required&&a.hasOwnProperty(e.field);if(s){if(mo(t,"string")&&!e.required)return i();Ai.required(e,t,a,r,o,"string"),mo(t,"string")||(Ai.type(e,t,a,r,o),Ai.range(e,t,a,r,o),Ai.pattern(e,t,a,r,o),e.whitespace===!0&&Ai.whitespace(e,t,a,r,o))}i(r)},$w=function(e,t,i,a,o){var r=e.type,s=[],l=e.required||!e.required&&a.hasOwnProperty(e.field);if(l){if(mo(t,r)&&!e.required)return i();Ai.required(e,t,a,s,o,r),mo(t,r)||Ai.type(e,t,a,s,o)}i(s)};const Ap={string:Rse,method:vse,number:yse,boolean:hse,regexp:Sse,integer:bse,float:pse,array:Ise,object:Bse,enum:mse,pattern:Gse,date:fse,url:$w,hex:$w,email:$w,required:wse,any:Cse};var Gb=function(){function n(e){to(this,n),Ve(this,"rules",null),Ve(this,"_messages",$R),this.define(e)}return no(n,[{key:"define",value:function(t){var i=this;if(!t)throw new Error("Cannot configure a schema with no rules");if(Bn(t)!=="object"||Array.isArray(t))throw new Error("Rules must be an object");this.rules={},Object.keys(t).forEach(function(a){var o=t[a];i.rules[a]=Array.isArray(o)?o:[o]})}},{key:"messages",value:function(t){return t&&(this._messages=DH(qR(),t)),this._messages}},{key:"validate",value:function(t){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(){},r=t,s=a,l=o;if(typeof s=="function"&&(l=s,s={}),!this.rules||Object.keys(this.rules).length===0)return l&&l(null,r),Promise.resolve(r);function c(p){var B=[],b={};function y(R){if(Array.isArray(R)){var Z;B=(Z=B).concat.apply(Z,an(R))}else B.push(R)}for(var S=0;S<p.length;S++)y(p[S]);B.length?(b=tZ(B),l(B,b)):l(null,r)}if(s.messages){var u=this.messages();u===$R&&(u=qR()),DH(u,s.messages),s.messages=u}else s.messages=this.messages();var C={},h=s.keys||Object.keys(this.rules);h.forEach(function(p){var B=i.rules[p],b=r[p];B.forEach(function(y){var S=y;typeof S.transform=="function"&&(r===t&&(r=Ke({},r)),b=r[p]=S.transform(b),b!=null&&(S.type=S.type||(Array.isArray(b)?"array":Bn(b)))),typeof S=="function"?S={validator:S}:S=Ke({},S),S.validator=i.getValidationMethod(S),S.validator&&(S.field=p,S.fullField=S.fullField||p,S.type=i.getType(S),C[p]=C[p]||[],C[p].push({rule:S,value:b,source:r,field:p}))})});var m={};return ase(C,s,function(p,B){var b=p.rule,y=(b.type==="object"||b.type==="array")&&(Bn(b.fields)==="object"||Bn(b.defaultField)==="object");y=y&&(b.required||!b.required&&p.value),b.field=p.field;function S(E,F){return Ke(Ke({},F),{},{fullField:"".concat(b.fullField,".").concat(E),fullFields:b.fullFields?[].concat(an(b.fullFields),[E]):[E]})}function R(){var E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],F=Array.isArray(E)?E:[E];!s.suppressWarning&&F.length&&n.warning("async-validator:",F),F.length&&b.message!==void 0&&(F=[].concat(b.message));var N=F.map(_H(b,r));if(s.first&&N.length)return m[b.field]=1,B(N);if(!y)B(N);else{if(b.required&&!p.value)return b.message!==void 0?N=[].concat(b.message).map(_H(b,r)):s.error&&(N=[s.error(b,_s(s.messages.required,b.field))]),B(N);var H={};b.defaultField&&Object.keys(p.value).map(function(D){H[D]=b.defaultField}),H=Ke(Ke({},H),p.rule.fields);var z={};Object.keys(H).forEach(function(D){var P=H[D],$=Array.isArray(P)?P:[P];z[D]=$.map(S.bind(null,D))});var _=new n(z);_.messages(s.messages),p.rule.options&&(p.rule.options.messages=s.messages,p.rule.options.error=s.error),_.validate(p.value,p.rule.options||s,function(D){var P=[];N&&N.length&&P.push.apply(P,an(N)),D&&D.length&&P.push.apply(P,an(D)),B(P.length?P:null)})}}var Z;if(b.asyncValidator)Z=b.asyncValidator(b,p.value,R,p.source,s);else if(b.validator){try{Z=b.validator(b,p.value,R,p.source,s)}catch(E){var x,M;(x=(M=console).error)===null||x===void 0||x.call(M,E),s.suppressValidatorError||setTimeout(function(){throw E},0),R(E.message)}Z===!0?R():Z===!1?R(typeof b.message=="function"?b.message(b.fullField||b.field):b.message||"".concat(b.fullField||b.field," fails")):Z instanceof Array?R(Z):Z instanceof Error&&R(Z.message)}Z&&Z.then&&Z.then(function(){return R()},function(E){return R(E)})},function(p){c(p)},r)}},{key:"getType",value:function(t){if(t.type===void 0&&t.pattern instanceof RegExp&&(t.type="pattern"),typeof t.validator!="function"&&t.type&&!Ap.hasOwnProperty(t.type))throw new Error(_s("Unknown rule type %s",t.type));return t.type||"string"}},{key:"getValidationMethod",value:function(t){if(typeof t.validator=="function")return t.validator;var i=Object.keys(t),a=i.indexOf("message");return a!==-1&&i.splice(a,1),i.length===1&&i[0]==="required"?Ap.required:Ap[this.getType(t)]||void 0}}]),n}();Ve(Gb,"register",function(e,t){if(typeof t!="function")throw new Error("Cannot register a validator by type, validator is not a function");Ap[e]=t});Ve(Gb,"warning",ese);Ve(Gb,"messages",$R);Ve(Gb,"validators",Ap);var Ks="'${name}' is not a valid ${type}",mz={default:"Validation error on field '${name}'",required:"'${name}' is required",enum:"'${name}' must be one of [${enum}]",whitespace:"'${name}' cannot be empty",date:{format:"'${name}' is invalid for format date",parse:"'${name}' could not be parsed as date",invalid:"'${name}' is invalid date"},types:{string:Ks,method:Ks,array:Ks,object:Ks,number:Ks,date:Ks,boolean:Ks,integer:Ks,float:Ks,regexp:Ks,email:Ks,url:Ks,hex:Ks},string:{len:"'${name}' must be exactly ${len} characters",min:"'${name}' must be at least ${min} characters",max:"'${name}' cannot be longer than ${max} characters",range:"'${name}' must be between ${min} and ${max} characters"},number:{len:"'${name}' must equal ${len}",min:"'${name}' cannot be less than ${min}",max:"'${name}' cannot be greater than ${max}",range:"'${name}' must be between ${min} and ${max}"},array:{len:"'${name}' must be exactly ${len} in length",min:"'${name}' cannot be less than ${min} in length",max:"'${name}' cannot be greater than ${max} in length",range:"'${name}' must be between ${min} and ${max} in length"},pattern:{mismatch:"'${name}' does not match pattern ${pattern}"}},UH=Gb;function Zse(n,e){return n.replace(/\\?\$\{\w+\}/g,function(t){if(t.startsWith("\\"))return t.slice(1);var i=t.slice(2,-1);return e[i]})}var kH="CODE_LOGIC_ERROR";function nZ(n,e,t,i,a){return iZ.apply(this,arguments)}function iZ(){return iZ=SI(Pr().mark(function n(e,t,i,a,o){var r,s,l,c,u,C,h,m,p;return Pr().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return r=Ke({},i),delete r.ruleIndex,UH.warning=function(){},r.validator&&(s=r.validator,r.validator=function(){try{return s.apply(void 0,arguments)}catch(y){return console.error(y),Promise.reject(kH)}}),l=null,r&&r.type==="array"&&r.defaultField&&(l=r.defaultField,delete r.defaultField),c=new UH(Ve({},e,[r])),u=of(mz,a.validateMessages),c.messages(u),C=[],b.prev=10,b.next=13,Promise.resolve(c.validate(Ve({},e,t),Ke({},a)));case 13:b.next=18;break;case 15:b.prev=15,b.t0=b.catch(10),b.t0.errors&&(C=b.t0.errors.map(function(y,S){var R=y.message,Z=R===kH?u.default:R;return v.isValidElement(Z)?v.cloneElement(Z,{key:"error_".concat(S)}):Z}));case 18:if(!(!C.length&&l)){b.next=23;break}return b.next=21,Promise.all(t.map(function(y,S){return nZ("".concat(e,".").concat(S),y,l,a,o)}));case 21:return h=b.sent,b.abrupt("return",h.reduce(function(y,S){return[].concat(an(y),an(S))},[]));case 23:return m=Ke(Ke({},i),{},{name:e,enum:(i.enum||[]).join(", ")},o),p=C.map(function(y){return typeof y=="string"?Zse(y,m):y}),b.abrupt("return",p);case 26:case"end":return b.stop()}},n,null,[[10,15]])})),iZ.apply(this,arguments)}function xse(n,e,t,i,a,o){var r=n.join("."),s=t.map(function(u,C){var h=u.validator,m=Ke(Ke({},u),{},{ruleIndex:C});return h&&(m.validator=function(p,B,b){var y=!1,S=function(){for(var x=arguments.length,M=new Array(x),E=0;E<x;E++)M[E]=arguments[E];Promise.resolve().then(function(){No(!y,"Your validator function has already return a promise. `callback` will be ignored."),y||b.apply(void 0,M)})},R=h(p,B,S);y=R&&typeof R.then=="function"&&typeof R.catch=="function",No(y,"`callback` is deprecated. Please return a promise instead."),y&&R.then(function(){b()}).catch(function(Z){b(Z||" ")})}),m}).sort(function(u,C){var h=u.warningOnly,m=u.ruleIndex,p=C.warningOnly,B=C.ruleIndex;return!!h==!!p?m-B:h?1:-1}),l;if(a===!0)l=new Promise(function(){var u=SI(Pr().mark(function C(h,m){var p,B,b;return Pr().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:p=0;case 1:if(!(p<s.length)){S.next=12;break}return B=s[p],S.next=5,nZ(r,e,B,i,o);case 5:if(b=S.sent,!b.length){S.next=9;break}return m([{errors:b,rule:B}]),S.abrupt("return");case 9:p+=1,S.next=1;break;case 12:h([]);case 13:case"end":return S.stop()}},C)}));return function(C,h){return u.apply(this,arguments)}}());else{var c=s.map(function(u){return nZ(r,e,u,i,o).then(function(C){return{errors:C,rule:u}})});l=(a?Wse(c):Mse(c)).then(function(u){return Promise.reject(u)})}return l.catch(function(u){return u}),l}function Mse(n){return aZ.apply(this,arguments)}function aZ(){return aZ=SI(Pr().mark(function n(e){return Pr().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",Promise.all(e).then(function(a){var o,r=(o=[]).concat.apply(o,an(a));return r}));case 1:case"end":return i.stop()}},n)})),aZ.apply(this,arguments)}function Wse(n){return oZ.apply(this,arguments)}function oZ(){return oZ=SI(Pr().mark(function n(e){var t;return Pr().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return t=0,a.abrupt("return",new Promise(function(o){e.forEach(function(r){r.then(function(s){s.errors.length&&o([s]),t+=1,t===e.length&&o([])})})}));case 2:case"end":return a.stop()}},n)})),oZ.apply(this,arguments)}function za(n){return QR(n)}function PH(n,e){var t={};return e.forEach(function(i){var a=rg(n,i);t=rc(t,i,a)}),t}function If(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return n&&n.some(function(i){return pz(e,i,t)})}function pz(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return!n||!e||!t&&n.length!==e.length?!1:e.every(function(i,a){return n[a]===i})}function Vse(n,e){if(n===e)return!0;if(!n&&e||n&&!e||!n||!e||Bn(n)!=="object"||Bn(e)!=="object")return!1;var t=Object.keys(n),i=Object.keys(e),a=new Set([].concat(t,i));return an(a).every(function(o){var r=n[o],s=e[o];return typeof r=="function"&&typeof s=="function"?!0:r===s})}function Nse(n){var e=arguments.length<=1?void 0:arguments[1];return e&&e.target&&Bn(e.target)==="object"&&n in e.target?e.target[n]:e}function JH(n,e,t){var i=n.length;if(e<0||e>=i||t<0||t>=i)return n;var a=n[e],o=e-t;return o>0?[].concat(an(n.slice(0,t)),[a],an(n.slice(t,e)),an(n.slice(e+1,i))):o<0?[].concat(an(n.slice(0,e)),an(n.slice(e+1,t+1)),[a],an(n.slice(t+1,i))):n}var Ese=["name"],hl=[];function e1(n,e,t,i,a,o){return typeof n=="function"?n(e,t,"source"in o?{source:o.source}:{}):i!==a}var SM=function(n){Iu(t,n);var e=hu(t);function t(i){var a;if(to(this,t),a=e.call(this,i),Ve(si(a),"state",{resetCount:0}),Ve(si(a),"cancelRegisterFunc",null),Ve(si(a),"mounted",!1),Ve(si(a),"touched",!1),Ve(si(a),"dirty",!1),Ve(si(a),"validatePromise",void 0),Ve(si(a),"prevValidating",void 0),Ve(si(a),"errors",hl),Ve(si(a),"warnings",hl),Ve(si(a),"cancelRegister",function(){var l=a.props,c=l.preserve,u=l.isListField,C=l.name;a.cancelRegisterFunc&&a.cancelRegisterFunc(u,c,za(C)),a.cancelRegisterFunc=null}),Ve(si(a),"getNamePath",function(){var l=a.props,c=l.name,u=l.fieldContext,C=u.prefixName,h=C===void 0?[]:C;return c!==void 0?[].concat(an(h),an(c)):[]}),Ve(si(a),"getRules",function(){var l=a.props,c=l.rules,u=c===void 0?[]:c,C=l.fieldContext;return u.map(function(h){return typeof h=="function"?h(C):h})}),Ve(si(a),"refresh",function(){a.mounted&&a.setState(function(l){var c=l.resetCount;return{resetCount:c+1}})}),Ve(si(a),"metaCache",null),Ve(si(a),"triggerMetaEvent",function(l){var c=a.props.onMetaChange;if(c){var u=Ke(Ke({},a.getMeta()),{},{destroy:l});Vf(a.metaCache,u)||c(u),a.metaCache=u}else a.metaCache=null}),Ve(si(a),"onStoreChange",function(l,c,u){var C=a.props,h=C.shouldUpdate,m=C.dependencies,p=m===void 0?[]:m,B=C.onReset,b=u.store,y=a.getNamePath(),S=a.getValue(l),R=a.getValue(b),Z=c&&If(c,y);switch(u.type==="valueUpdate"&&u.source==="external"&&!Vf(S,R)&&(a.touched=!0,a.dirty=!0,a.validatePromise=null,a.errors=hl,a.warnings=hl,a.triggerMetaEvent()),u.type){case"reset":if(!c||Z){a.touched=!1,a.dirty=!1,a.validatePromise=void 0,a.errors=hl,a.warnings=hl,a.triggerMetaEvent(),B==null||B(),a.refresh();return}break;case"remove":{if(h&&e1(h,l,b,S,R,u)){a.reRender();return}break}case"setField":{var x=u.data;if(Z){"touched"in x&&(a.touched=x.touched),"validating"in x&&!("originRCField"in x)&&(a.validatePromise=x.validating?Promise.resolve([]):null),"errors"in x&&(a.errors=x.errors||hl),"warnings"in x&&(a.warnings=x.warnings||hl),a.dirty=!0,a.triggerMetaEvent(),a.reRender();return}else if("value"in x&&If(c,y,!0)){a.reRender();return}if(h&&!y.length&&e1(h,l,b,S,R,u)){a.reRender();return}break}case"dependenciesUpdate":{var M=p.map(za);if(M.some(function(E){return If(u.relatedFields,E)})){a.reRender();return}break}default:if(Z||(!p.length||y.length||h)&&e1(h,l,b,S,R,u)){a.reRender();return}break}h===!0&&a.reRender()}),Ve(si(a),"validateRules",function(l){var c=a.getNamePath(),u=a.getValue(),C=l||{},h=C.triggerName,m=C.validateOnly,p=m===void 0?!1:m,B=Promise.resolve().then(SI(Pr().mark(function b(){var y,S,R,Z,x,M,E;return Pr().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:if(a.mounted){N.next=2;break}return N.abrupt("return",[]);case 2:if(y=a.props,S=y.validateFirst,R=S===void 0?!1:S,Z=y.messageVariables,x=y.validateDebounce,M=a.getRules(),h&&(M=M.filter(function(H){return H}).filter(function(H){var z=H.validateTrigger;if(!z)return!0;var _=QR(z);return _.includes(h)})),!(x&&h)){N.next=10;break}return N.next=8,new Promise(function(H){setTimeout(H,x)});case 8:if(a.validatePromise===B){N.next=10;break}return N.abrupt("return",[]);case 10:return E=xse(c,u,M,l,R,Z),E.catch(function(H){return H}).then(function(){var H=arguments.length>0&&arguments[0]!==void 0?arguments[0]:hl;if(a.validatePromise===B){var z;a.validatePromise=null;var _=[],D=[];(z=H.forEach)===null||z===void 0||z.call(H,function(P){var $=P.rule.warningOnly,X=P.errors,L=X===void 0?hl:X;$?D.push.apply(D,an(L)):_.push.apply(_,an(L))}),a.errors=_,a.warnings=D,a.triggerMetaEvent(),a.reRender()}}),N.abrupt("return",E);case 13:case"end":return N.stop()}},b)})));return p||(a.validatePromise=B,a.dirty=!0,a.errors=hl,a.warnings=hl,a.triggerMetaEvent(),a.reRender()),B}),Ve(si(a),"isFieldValidating",function(){return!!a.validatePromise}),Ve(si(a),"isFieldTouched",function(){return a.touched}),Ve(si(a),"isFieldDirty",function(){if(a.dirty||a.props.initialValue!==void 0)return!0;var l=a.props.fieldContext,c=l.getInternalHooks(qC),u=c.getInitialValue;return u(a.getNamePath())!==void 0}),Ve(si(a),"getErrors",function(){return a.errors}),Ve(si(a),"getWarnings",function(){return a.warnings}),Ve(si(a),"isListField",function(){return a.props.isListField}),Ve(si(a),"isList",function(){return a.props.isList}),Ve(si(a),"isPreserve",function(){return a.props.preserve}),Ve(si(a),"getMeta",function(){a.prevValidating=a.isFieldValidating();var l={touched:a.isFieldTouched(),validating:a.prevValidating,errors:a.errors,warnings:a.warnings,name:a.getNamePath(),validated:a.validatePromise===null};return l}),Ve(si(a),"getOnlyChild",function(l){if(typeof l=="function"){var c=a.getMeta();return Ke(Ke({},a.getOnlyChild(l(a.getControlled(),c,a.props.fieldContext))),{},{isFunction:!0})}var u=Ic(l);return u.length!==1||!v.isValidElement(u[0])?{child:u,isFunction:!1}:{child:u[0],isFunction:!1}}),Ve(si(a),"getValue",function(l){var c=a.props.fieldContext.getFieldsValue,u=a.getNamePath();return rg(l||c(!0),u)}),Ve(si(a),"getControlled",function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},c=a.props,u=c.name,C=c.trigger,h=c.validateTrigger,m=c.getValueFromEvent,p=c.normalize,B=c.valuePropName,b=c.getValueProps,y=c.fieldContext,S=h!==void 0?h:y.validateTrigger,R=a.getNamePath(),Z=y.getInternalHooks,x=y.getFieldsValue,M=Z(qC),E=M.dispatch,F=a.getValue(),N=b||function(P){return Ve({},B,P)},H=l[C],z=u!==void 0?N(F):{},_=Ke(Ke({},l),z);_[C]=function(){a.touched=!0,a.dirty=!0,a.triggerMetaEvent();for(var P,$=arguments.length,X=new Array($),L=0;L<$;L++)X[L]=arguments[L];m?P=m.apply(void 0,X):P=Nse.apply(void 0,[B].concat(X)),p&&(P=p(P,F,x(!0))),P!==F&&E({type:"updateValue",namePath:R,value:P}),H&&H.apply(void 0,X)};var D=QR(S||[]);return D.forEach(function(P){var $=_[P];_[P]=function(){$&&$.apply(void 0,arguments);var X=a.props.rules;X&&X.length&&E({type:"validateField",namePath:R,triggerName:P})}}),_}),i.fieldContext){var o=i.fieldContext.getInternalHooks,r=o(qC),s=r.initEntityValue;s(si(a))}return a}return no(t,[{key:"componentDidMount",value:function(){var a=this.props,o=a.shouldUpdate,r=a.fieldContext;if(this.mounted=!0,r){var s=r.getInternalHooks,l=s(qC),c=l.registerField;this.cancelRegisterFunc=c(this)}o===!0&&this.reRender()}},{key:"componentWillUnmount",value:function(){this.cancelRegister(),this.triggerMetaEvent(!0),this.mounted=!1}},{key:"reRender",value:function(){this.mounted&&this.forceUpdate()}},{key:"render",value:function(){var a=this.state.resetCount,o=this.props.children,r=this.getOnlyChild(o),s=r.child,l=r.isFunction,c;return l?c=s:v.isValidElement(s)?c=v.cloneElement(s,this.getControlled(s.props)):(No(!s,"`children` of Field is not validate ReactElement."),c=s),v.createElement(v.Fragment,{key:a},c)}}]),t}(v.Component);Ve(SM,"contextType",zf);Ve(SM,"defaultProps",{trigger:"onChange",valuePropName:"value"});function bz(n){var e,t=n.name,i=_n(n,Ese),a=v.useContext(zf),o=v.useContext(PB),r=t!==void 0?za(t):void 0,s=(e=i.isListField)!==null&&e!==void 0?e:!!o,l="keep";return s||(l="_".concat((r||[]).join("_"))),v.createElement(SM,$t({key:l,name:r,isListField:s},i,{fieldContext:a}))}function Hse(n){var e=n.name,t=n.initialValue,i=n.children,a=n.rules,o=n.validateTrigger,r=n.isListField,s=v.useContext(zf),l=v.useContext(PB),c=v.useRef({keys:[],id:0}),u=c.current,C=v.useMemo(function(){var B=za(s.prefixName)||[];return[].concat(an(B),an(za(e)))},[s.prefixName,e]),h=v.useMemo(function(){return Ke(Ke({},s),{},{prefixName:C})},[s,C]),m=v.useMemo(function(){return{getKey:function(b){var y=C.length,S=b[y];return[u.keys[S],b.slice(y+1)]}}},[C]);if(typeof i!="function")return No(!1,"Form.List only accepts function as children."),null;var p=function(b,y,S){var R=S.source;return R==="internal"?!1:b!==y};return v.createElement(PB.Provider,{value:m},v.createElement(zf.Provider,{value:h},v.createElement(bz,{name:[],shouldUpdate:p,rules:a,validateTrigger:o,initialValue:t,isList:!0,isListField:r??!!l},function(B,b){var y=B.value,S=y===void 0?[]:y,R=B.onChange,Z=s.getFieldValue,x=function(){var N=Z(C||[]);return N||[]},M={add:function(N,H){var z=x();H>=0&&H<=z.length?(u.keys=[].concat(an(u.keys.slice(0,H)),[u.id],an(u.keys.slice(H))),R([].concat(an(z.slice(0,H)),[N],an(z.slice(H))))):(u.keys=[].concat(an(u.keys),[u.id]),R([].concat(an(z),[N]))),u.id+=1},remove:function(N){var H=x(),z=new Set(Array.isArray(N)?N:[N]);z.size<=0||(u.keys=u.keys.filter(function(_,D){return!z.has(D)}),R(H.filter(function(_,D){return!z.has(D)})))},move:function(N,H){if(N!==H){var z=x();N<0||N>=z.length||H<0||H>=z.length||(u.keys=JH(u.keys,N,H),R(JH(z,N,H)))}}},E=S||[];return Array.isArray(E)||(E=[]),i(E.map(function(F,N){var H=u.keys[N];return H===void 0&&(u.keys[N]=u.id,H=u.keys[N],u.id+=1),{name:N,key:H,isListField:!0}}),M,b)})))}function Fse(n){var e=!1,t=n.length,i=[];return n.length?new Promise(function(a,o){n.forEach(function(r,s){r.catch(function(l){return e=!0,l}).then(function(l){t-=1,i[s]=l,!(t>0)&&(e&&o(i),a(i))})})}):Promise.resolve([])}var vz="__@field_split__";function t1(n){return n.map(function(e){return"".concat(Bn(e),":").concat(e)}).join(vz)}var kh=function(){function n(){to(this,n),Ve(this,"kvs",new Map)}return no(n,[{key:"set",value:function(t,i){this.kvs.set(t1(t),i)}},{key:"get",value:function(t){return this.kvs.get(t1(t))}},{key:"update",value:function(t,i){var a=this.get(t),o=i(a);o?this.set(t,o):this.delete(t)}},{key:"delete",value:function(t){this.kvs.delete(t1(t))}},{key:"map",value:function(t){return an(this.kvs.entries()).map(function(i){var a=rt(i,2),o=a[0],r=a[1],s=o.split(vz);return t({key:s.map(function(l){var c=l.match(/^([^:]*):(.*)$/),u=rt(c,3),C=u[1],h=u[2];return C==="number"?Number(h):h}),value:r})})}},{key:"toJSON",value:function(){var t={};return this.map(function(i){var a=i.key,o=i.value;return t[a.join(".")]=o,null}),t}}]),n}(),Xse=["name"],Tse=no(function n(e){var t=this;to(this,n),Ve(this,"formHooked",!1),Ve(this,"forceRootUpdate",void 0),Ve(this,"subscribable",!0),Ve(this,"store",{}),Ve(this,"fieldEntities",[]),Ve(this,"initialValues",{}),Ve(this,"callbacks",{}),Ve(this,"validateMessages",null),Ve(this,"preserve",null),Ve(this,"lastValidatePromise",null),Ve(this,"getForm",function(){return{getFieldValue:t.getFieldValue,getFieldsValue:t.getFieldsValue,getFieldError:t.getFieldError,getFieldWarning:t.getFieldWarning,getFieldsError:t.getFieldsError,isFieldsTouched:t.isFieldsTouched,isFieldTouched:t.isFieldTouched,isFieldValidating:t.isFieldValidating,isFieldsValidating:t.isFieldsValidating,resetFields:t.resetFields,setFields:t.setFields,setFieldValue:t.setFieldValue,setFieldsValue:t.setFieldsValue,validateFields:t.validateFields,submit:t.submit,_init:!0,getInternalHooks:t.getInternalHooks}}),Ve(this,"getInternalHooks",function(i){return i===qC?(t.formHooked=!0,{dispatch:t.dispatch,initEntityValue:t.initEntityValue,registerField:t.registerField,useSubscribe:t.useSubscribe,setInitialValues:t.setInitialValues,destroyForm:t.destroyForm,setCallbacks:t.setCallbacks,setValidateMessages:t.setValidateMessages,getFields:t.getFields,setPreserve:t.setPreserve,getInitialValue:t.getInitialValue,registerWatch:t.registerWatch}):(No(!1,"`getInternalHooks` is internal usage. Should not call directly."),null)}),Ve(this,"useSubscribe",function(i){t.subscribable=i}),Ve(this,"prevWithoutPreserves",null),Ve(this,"setInitialValues",function(i,a){if(t.initialValues=i||{},a){var o,r=of(i,t.store);(o=t.prevWithoutPreserves)===null||o===void 0||o.map(function(s){var l=s.key;r=rc(r,l,rg(i,l))}),t.prevWithoutPreserves=null,t.updateStore(r)}}),Ve(this,"destroyForm",function(i){if(i)t.updateStore({});else{var a=new kh;t.getFieldEntities(!0).forEach(function(o){t.isMergedPreserve(o.isPreserve())||a.set(o.getNamePath(),!0)}),t.prevWithoutPreserves=a}}),Ve(this,"getInitialValue",function(i){var a=rg(t.initialValues,i);return i.length?of(a):a}),Ve(this,"setCallbacks",function(i){t.callbacks=i}),Ve(this,"setValidateMessages",function(i){t.validateMessages=i}),Ve(this,"setPreserve",function(i){t.preserve=i}),Ve(this,"watchList",[]),Ve(this,"registerWatch",function(i){return t.watchList.push(i),function(){t.watchList=t.watchList.filter(function(a){return a!==i})}}),Ve(this,"notifyWatch",function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];if(t.watchList.length){var a=t.getFieldsValue(),o=t.getFieldsValue(!0);t.watchList.forEach(function(r){r(a,o,i)})}}),Ve(this,"timeoutId",null),Ve(this,"warningUnhooked",function(){}),Ve(this,"updateStore",function(i){t.store=i}),Ve(this,"getFieldEntities",function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return i?t.fieldEntities.filter(function(a){return a.getNamePath().length}):t.fieldEntities}),Ve(this,"getFieldsMap",function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,a=new kh;return t.getFieldEntities(i).forEach(function(o){var r=o.getNamePath();a.set(r,o)}),a}),Ve(this,"getFieldEntitiesForNamePathList",function(i){if(!i)return t.getFieldEntities(!0);var a=t.getFieldsMap(!0);return i.map(function(o){var r=za(o);return a.get(r)||{INVALIDATE_NAME_PATH:za(o)}})}),Ve(this,"getFieldsValue",function(i,a){t.warningUnhooked();var o,r,s;if(i===!0||Array.isArray(i)?(o=i,r=a):i&&Bn(i)==="object"&&(s=i.strict,r=i.filter),o===!0&&!r)return t.store;var l=t.getFieldEntitiesForNamePathList(Array.isArray(o)?o:null),c=[];return l.forEach(function(u){var C,h,m="INVALIDATE_NAME_PATH"in u?u.INVALIDATE_NAME_PATH:u.getNamePath();if(s){var p,B;if((p=(B=u).isList)!==null&&p!==void 0&&p.call(B))return}else if(!o&&(C=(h=u).isListField)!==null&&C!==void 0&&C.call(h))return;if(!r)c.push(m);else{var b="getMeta"in u?u.getMeta():null;r(b)&&c.push(m)}}),PH(t.store,c.map(za))}),Ve(this,"getFieldValue",function(i){t.warningUnhooked();var a=za(i);return rg(t.store,a)}),Ve(this,"getFieldsError",function(i){t.warningUnhooked();var a=t.getFieldEntitiesForNamePathList(i);return a.map(function(o,r){return o&&!("INVALIDATE_NAME_PATH"in o)?{name:o.getNamePath(),errors:o.getErrors(),warnings:o.getWarnings()}:{name:za(i[r]),errors:[],warnings:[]}})}),Ve(this,"getFieldError",function(i){t.warningUnhooked();var a=za(i),o=t.getFieldsError([a])[0];return o.errors}),Ve(this,"getFieldWarning",function(i){t.warningUnhooked();var a=za(i),o=t.getFieldsError([a])[0];return o.warnings}),Ve(this,"isFieldsTouched",function(){t.warningUnhooked();for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];var r=a[0],s=a[1],l,c=!1;a.length===0?l=null:a.length===1?Array.isArray(r)?(l=r.map(za),c=!1):(l=null,c=r):(l=r.map(za),c=s);var u=t.getFieldEntities(!0),C=function(b){return b.isFieldTouched()};if(!l)return c?u.every(function(B){return C(B)||B.isList()}):u.some(C);var h=new kh;l.forEach(function(B){h.set(B,[])}),u.forEach(function(B){var b=B.getNamePath();l.forEach(function(y){y.every(function(S,R){return b[R]===S})&&h.update(y,function(S){return[].concat(an(S),[B])})})});var m=function(b){return b.some(C)},p=h.map(function(B){var b=B.value;return b});return c?p.every(m):p.some(m)}),Ve(this,"isFieldTouched",function(i){return t.warningUnhooked(),t.isFieldsTouched([i])}),Ve(this,"isFieldsValidating",function(i){t.warningUnhooked();var a=t.getFieldEntities();if(!i)return a.some(function(r){return r.isFieldValidating()});var o=i.map(za);return a.some(function(r){var s=r.getNamePath();return If(o,s)&&r.isFieldValidating()})}),Ve(this,"isFieldValidating",function(i){return t.warningUnhooked(),t.isFieldsValidating([i])}),Ve(this,"resetWithFieldInitialValue",function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},a=new kh,o=t.getFieldEntities(!0);o.forEach(function(l){var c=l.props.initialValue,u=l.getNamePath();if(c!==void 0){var C=a.get(u)||new Set;C.add({entity:l,value:c}),a.set(u,C)}});var r=function(c){c.forEach(function(u){var C=u.props.initialValue;if(C!==void 0){var h=u.getNamePath(),m=t.getInitialValue(h);if(m!==void 0)No(!1,"Form already set 'initialValues' with path '".concat(h.join("."),"'. Field can not overwrite it."));else{var p=a.get(h);if(p&&p.size>1)No(!1,"Multiple Field with path '".concat(h.join("."),"' set 'initialValue'. Can not decide which one to pick."));else if(p){var B=t.getFieldValue(h),b=u.isListField();!b&&(!i.skipExist||B===void 0)&&t.updateStore(rc(t.store,h,an(p)[0].value))}}}})},s;i.entities?s=i.entities:i.namePathList?(s=[],i.namePathList.forEach(function(l){var c=a.get(l);if(c){var u;(u=s).push.apply(u,an(an(c).map(function(C){return C.entity})))}})):s=o,r(s)}),Ve(this,"resetFields",function(i){t.warningUnhooked();var a=t.store;if(!i){t.updateStore(of(t.initialValues)),t.resetWithFieldInitialValue(),t.notifyObservers(a,null,{type:"reset"}),t.notifyWatch();return}var o=i.map(za);o.forEach(function(r){var s=t.getInitialValue(r);t.updateStore(rc(t.store,r,s))}),t.resetWithFieldInitialValue({namePathList:o}),t.notifyObservers(a,o,{type:"reset"}),t.notifyWatch(o)}),Ve(this,"setFields",function(i){t.warningUnhooked();var a=t.store,o=[];i.forEach(function(r){var s=r.name,l=_n(r,Xse),c=za(s);o.push(c),"value"in l&&t.updateStore(rc(t.store,c,l.value)),t.notifyObservers(a,[c],{type:"setField",data:r})}),t.notifyWatch(o)}),Ve(this,"getFields",function(){var i=t.getFieldEntities(!0),a=i.map(function(o){var r=o.getNamePath(),s=o.getMeta(),l=Ke(Ke({},s),{},{name:r,value:t.getFieldValue(r)});return Object.defineProperty(l,"originRCField",{value:!0}),l});return a}),Ve(this,"initEntityValue",function(i){var a=i.props.initialValue;if(a!==void 0){var o=i.getNamePath(),r=rg(t.store,o);r===void 0&&t.updateStore(rc(t.store,o,a))}}),Ve(this,"isMergedPreserve",function(i){var a=i!==void 0?i:t.preserve;return a??!0}),Ve(this,"registerField",function(i){t.fieldEntities.push(i);var a=i.getNamePath();if(t.notifyWatch([a]),i.props.initialValue!==void 0){var o=t.store;t.resetWithFieldInitialValue({entities:[i],skipExist:!0}),t.notifyObservers(o,[i.getNamePath()],{type:"valueUpdate",source:"internal"})}return function(r,s){var l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];if(t.fieldEntities=t.fieldEntities.filter(function(C){return C!==i}),!t.isMergedPreserve(s)&&(!r||l.length>1)){var c=r?void 0:t.getInitialValue(a);if(a.length&&t.getFieldValue(a)!==c&&t.fieldEntities.every(function(C){return!pz(C.getNamePath(),a)})){var u=t.store;t.updateStore(rc(u,a,c,!0)),t.notifyObservers(u,[a],{type:"remove"}),t.triggerDependenciesUpdate(u,a)}}t.notifyWatch([a])}}),Ve(this,"dispatch",function(i){switch(i.type){case"updateValue":{var a=i.namePath,o=i.value;t.updateValue(a,o);break}case"validateField":{var r=i.namePath,s=i.triggerName;t.validateFields([r],{triggerName:s});break}}}),Ve(this,"notifyObservers",function(i,a,o){if(t.subscribable){var r=Ke(Ke({},o),{},{store:t.getFieldsValue(!0)});t.getFieldEntities().forEach(function(s){var l=s.onStoreChange;l(i,a,r)})}else t.forceRootUpdate()}),Ve(this,"triggerDependenciesUpdate",function(i,a){var o=t.getDependencyChildrenFields(a);return o.length&&t.validateFields(o),t.notifyObservers(i,o,{type:"dependenciesUpdate",relatedFields:[a].concat(an(o))}),o}),Ve(this,"updateValue",function(i,a){var o=za(i),r=t.store;t.updateStore(rc(t.store,o,a)),t.notifyObservers(r,[o],{type:"valueUpdate",source:"internal"}),t.notifyWatch([o]);var s=t.triggerDependenciesUpdate(r,o),l=t.callbacks.onValuesChange;if(l){var c=PH(t.store,[o]);l(c,t.getFieldsValue())}t.triggerOnFieldsChange([o].concat(an(s)))}),Ve(this,"setFieldsValue",function(i){t.warningUnhooked();var a=t.store;if(i){var o=of(t.store,i);t.updateStore(o)}t.notifyObservers(a,null,{type:"valueUpdate",source:"external"}),t.notifyWatch()}),Ve(this,"setFieldValue",function(i,a){t.setFields([{name:i,value:a,errors:[],warnings:[]}])}),Ve(this,"getDependencyChildrenFields",function(i){var a=new Set,o=[],r=new kh;t.getFieldEntities().forEach(function(l){var c=l.props.dependencies;(c||[]).forEach(function(u){var C=za(u);r.update(C,function(){var h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new Set;return h.add(l),h})})});var s=function l(c){var u=r.get(c)||new Set;u.forEach(function(C){if(!a.has(C)){a.add(C);var h=C.getNamePath();C.isFieldDirty()&&h.length&&(o.push(h),l(h))}})};return s(i),o}),Ve(this,"triggerOnFieldsChange",function(i,a){var o=t.callbacks.onFieldsChange;if(o){var r=t.getFields();if(a){var s=new kh;a.forEach(function(c){var u=c.name,C=c.errors;s.set(u,C)}),r.forEach(function(c){c.errors=s.get(c.name)||c.errors})}var l=r.filter(function(c){var u=c.name;return If(i,u)});l.length&&o(l,r)}}),Ve(this,"validateFields",function(i,a){t.warningUnhooked();var o,r;Array.isArray(i)||typeof i=="string"||typeof a=="string"?(o=i,r=a):r=i;var s=!!o,l=s?o.map(za):[],c=[],u=String(Date.now()),C=new Set,h=r||{},m=h.recursive,p=h.dirty;t.getFieldEntities(!0).forEach(function(S){if(s||l.push(S.getNamePath()),!(!S.props.rules||!S.props.rules.length)&&!(p&&!S.isFieldDirty())){var R=S.getNamePath();if(C.add(R.join(u)),!s||If(l,R,m)){var Z=S.validateRules(Ke({validateMessages:Ke(Ke({},mz),t.validateMessages)},r));c.push(Z.then(function(){return{name:R,errors:[],warnings:[]}}).catch(function(x){var M,E=[],F=[];return(M=x.forEach)===null||M===void 0||M.call(x,function(N){var H=N.rule.warningOnly,z=N.errors;H?F.push.apply(F,an(z)):E.push.apply(E,an(z))}),E.length?Promise.reject({name:R,errors:E,warnings:F}):{name:R,errors:E,warnings:F}}))}}});var B=Fse(c);t.lastValidatePromise=B,B.catch(function(S){return S}).then(function(S){var R=S.map(function(Z){var x=Z.name;return x});t.notifyObservers(t.store,R,{type:"validateFinish"}),t.triggerOnFieldsChange(R,S)});var b=B.then(function(){return t.lastValidatePromise===B?Promise.resolve(t.getFieldsValue(l)):Promise.reject([])}).catch(function(S){var R=S.filter(function(Z){return Z&&Z.errors.length});return Promise.reject({values:t.getFieldsValue(l),errorFields:R,outOfDate:t.lastValidatePromise!==B})});b.catch(function(S){return S});var y=l.filter(function(S){return C.has(S.join(u))});return t.triggerOnFieldsChange(y),b}),Ve(this,"submit",function(){t.warningUnhooked(),t.validateFields().then(function(i){var a=t.callbacks.onFinish;if(a)try{a(i)}catch(o){console.error(o)}}).catch(function(i){var a=t.callbacks.onFinishFailed;a&&a(i)})}),this.forceRootUpdate=e});function yz(n){var e=v.useRef(),t=v.useState({}),i=rt(t,2),a=i[1];if(!e.current)if(n)e.current=n;else{var o=function(){a({})},r=new Tse(o);e.current=r.getForm()}return[e.current]}var rZ=v.createContext({triggerFormChange:function(){},triggerFormFinish:function(){},registerForm:function(){},unregisterForm:function(){}}),Yse=function(e){var t=e.validateMessages,i=e.onFormChange,a=e.onFormFinish,o=e.children,r=v.useContext(rZ),s=v.useRef({});return v.createElement(rZ.Provider,{value:Ke(Ke({},r),{},{validateMessages:Ke(Ke({},r.validateMessages),t),triggerFormChange:function(c,u){i&&i(c,{changedFields:u,forms:s.current}),r.triggerFormChange(c,u)},triggerFormFinish:function(c,u){a&&a(c,{values:u,forms:s.current}),r.triggerFormFinish(c,u)},registerForm:function(c,u){c&&(s.current=Ke(Ke({},s.current),{},Ve({},c,u))),r.registerForm(c,u)},unregisterForm:function(c){var u=Ke({},s.current);delete u[c],s.current=u,r.unregisterForm(c)}})},o)},zse=["name","initialValues","fields","form","preserve","children","component","validateMessages","validateTrigger","onValuesChange","onFieldsChange","onFinish","onFinishFailed","clearOnDestroy"],Kse=function(e,t){var i=e.name,a=e.initialValues,o=e.fields,r=e.form,s=e.preserve,l=e.children,c=e.component,u=c===void 0?"form":c,C=e.validateMessages,h=e.validateTrigger,m=h===void 0?"onChange":h,p=e.onValuesChange,B=e.onFieldsChange,b=e.onFinish,y=e.onFinishFailed,S=e.clearOnDestroy,R=_n(e,zse),Z=v.useRef(null),x=v.useContext(rZ),M=yz(r),E=rt(M,1),F=E[0],N=F.getInternalHooks(qC),H=N.useSubscribe,z=N.setInitialValues,_=N.setCallbacks,D=N.setValidateMessages,P=N.setPreserve,$=N.destroyForm;v.useImperativeHandle(t,function(){return Ke(Ke({},F),{},{nativeElement:Z.current})}),v.useEffect(function(){return x.registerForm(i,F),function(){x.unregisterForm(i)}},[x,F,i]),D(Ke(Ke({},x.validateMessages),C)),_({onValuesChange:p,onFieldsChange:function(k){if(x.triggerFormChange(i,k),B){for(var ie=arguments.length,re=new Array(ie>1?ie-1:0),ge=1;ge<ie;ge++)re[ge-1]=arguments[ge];B.apply(void 0,[k].concat(re))}},onFinish:function(k){x.triggerFormFinish(i,k),b&&b(k)},onFinishFailed:y}),P(s);var X=v.useRef(null);z(a,!X.current),X.current||(X.current=!0),v.useEffect(function(){return function(){return $(S)}},[]);var L,U=typeof l=="function";if(U){var q=F.getFieldsValue(!0);L=l(q,F)}else L=l;H(!U);var K=v.useRef();v.useEffect(function(){Vse(K.current||[],o||[])||F.setFields(o||[]),K.current=o},[o,F]);var O=v.useMemo(function(){return Ke(Ke({},F),{},{validateTrigger:m})},[F,m]),j=v.createElement(PB.Provider,{value:null},v.createElement(zf.Provider,{value:O},L));return u===!1?j:v.createElement(u,$t({},R,{ref:Z,onSubmit:function(k){k.preventDefault(),k.stopPropagation(),F.submit()},onReset:function(k){var ie;k.preventDefault(),F.resetFields(),(ie=R.onReset)===null||ie===void 0||ie.call(R,k)}}),j)};function jH(n){try{return JSON.stringify(n)}catch{return Math.random()}}function Lse(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];var i=e[0],a=e[1],o=a===void 0?{}:a,r=jre(o)?{form:o}:o,s=r.form,l=v.useState(),c=rt(l,2),u=c[0],C=c[1],h=v.useMemo(function(){return jH(u)},[u]),m=v.useRef(h);m.current=h;var p=v.useContext(zf),B=s||p,b=B&&B._init,y=za(i),S=v.useRef(y);return S.current=y,v.useEffect(function(){if(b){var R=B.getFieldsValue,Z=B.getInternalHooks,x=Z(qC),M=x.registerWatch,E=function(z,_){var D=r.preserve?_:z;return typeof i=="function"?i(D):rg(D,S.current)},F=M(function(H,z){var _=E(H,z),D=jH(_);m.current!==D&&(m.current=D,C(_))}),N=E(R(),R(!0));return u!==N&&C(N),F}},[b]),u}var _se=v.forwardRef(Kse),Sb=_se;Sb.FormProvider=Yse;Sb.Field=bz;Sb.List=Hse;Sb.useForm=yz;Sb.useWatch=Lse;const Ag=v.createContext({}),Dse=n=>{let{children:e,status:t,override:i}=n;const a=v.useContext(Ag),o=v.useMemo(()=>{const r=Object.assign({},a);return i&&delete r.isFormItemInput,t&&(delete r.status,delete r.hasFeedback,delete r.feedbackIcon),r},[t,i,a]);return v.createElement(Ag.Provider,{value:o},e)},Ose=v.createContext(void 0),sZ=n=>{const{space:e,form:t,children:i}=n;if(i==null)return null;let a=i;return t&&(a=Ct.createElement(Dse,{override:!0,status:!0},a)),e&&(a=Ct.createElement(poe,null,a)),a};var Use=function(e){if(kr()&&window.document.documentElement){var t=Array.isArray(e)?e:[e],i=window.document.documentElement;return t.some(function(a){return a in i.style})}return!1};function QH(n,e){return Use(n)}const uS=n=>{const{prefixCls:e,className:t,style:i,size:a,shape:o}=n,r=gt({[`${e}-lg`]:a==="large",[`${e}-sm`]:a==="small"}),s=gt({[`${e}-circle`]:o==="circle",[`${e}-square`]:o==="square",[`${e}-round`]:o==="round"}),l=v.useMemo(()=>typeof a=="number"?{width:a,height:a,lineHeight:`${a}px`}:{},[a]);return v.createElement("span",{className:gt(e,r,s,t),style:Object.assign(Object.assign({},l),i)})},kse=new Ti("ant-skeleton-loading",{"0%":{backgroundPosition:"100% 50%"},"100%":{backgroundPosition:"0 50%"}}),dS=n=>({height:n,lineHeight:st(n)}),hf=n=>Object.assign({width:n},dS(n)),Pse=n=>({background:n.skeletonLoadingBackground,backgroundSize:"400% 100%",animationName:kse,animationDuration:n.skeletonLoadingMotionDuration,animationTimingFunction:"ease",animationIterationCount:"infinite"}),n1=(n,e)=>Object.assign({width:e(n).mul(5).equal(),minWidth:e(n).mul(5).equal()},dS(n)),Jse=n=>{const{skeletonAvatarCls:e,gradientFromColor:t,controlHeight:i,controlHeightLG:a,controlHeightSM:o}=n;return{[e]:Object.assign({display:"inline-block",verticalAlign:"top",background:t},hf(i)),[`${e}${e}-circle`]:{borderRadius:"50%"},[`${e}${e}-lg`]:Object.assign({},hf(a)),[`${e}${e}-sm`]:Object.assign({},hf(o))}},jse=n=>{const{controlHeight:e,borderRadiusSM:t,skeletonInputCls:i,controlHeightLG:a,controlHeightSM:o,gradientFromColor:r,calc:s}=n;return{[i]:Object.assign({display:"inline-block",verticalAlign:"top",background:r,borderRadius:t},n1(e,s)),[`${i}-lg`]:Object.assign({},n1(a,s)),[`${i}-sm`]:Object.assign({},n1(o,s))}},qH=n=>Object.assign({width:n},dS(n)),Qse=n=>{const{skeletonImageCls:e,imageSizeBase:t,gradientFromColor:i,borderRadiusSM:a,calc:o}=n;return{[e]:Object.assign(Object.assign({display:"inline-flex",alignItems:"center",justifyContent:"center",verticalAlign:"middle",background:i,borderRadius:a},qH(o(t).mul(2).equal())),{[`${e}-path`]:{fill:"#bfbfbf"},[`${e}-svg`]:Object.assign(Object.assign({},qH(t)),{maxWidth:o(t).mul(4).equal(),maxHeight:o(t).mul(4).equal()}),[`${e}-svg${e}-svg-circle`]:{borderRadius:"50%"}}),[`${e}${e}-circle`]:{borderRadius:"50%"}}},i1=(n,e,t)=>{const{skeletonButtonCls:i}=n;return{[`${t}${i}-circle`]:{width:e,minWidth:e,borderRadius:"50%"},[`${t}${i}-round`]:{borderRadius:e}}},a1=(n,e)=>Object.assign({width:e(n).mul(2).equal(),minWidth:e(n).mul(2).equal()},dS(n)),qse=n=>{const{borderRadiusSM:e,skeletonButtonCls:t,controlHeight:i,controlHeightLG:a,controlHeightSM:o,gradientFromColor:r,calc:s}=n;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({[t]:Object.assign({display:"inline-block",verticalAlign:"top",background:r,borderRadius:e,width:s(i).mul(2).equal(),minWidth:s(i).mul(2).equal()},a1(i,s))},i1(n,i,t)),{[`${t}-lg`]:Object.assign({},a1(a,s))}),i1(n,a,`${t}-lg`)),{[`${t}-sm`]:Object.assign({},a1(o,s))}),i1(n,o,`${t}-sm`))},$se=n=>{const{componentCls:e,skeletonAvatarCls:t,skeletonTitleCls:i,skeletonParagraphCls:a,skeletonButtonCls:o,skeletonInputCls:r,skeletonImageCls:s,controlHeight:l,controlHeightLG:c,controlHeightSM:u,gradientFromColor:C,padding:h,marginSM:m,borderRadius:p,titleHeight:B,blockRadius:b,paragraphLiHeight:y,controlHeightXS:S,paragraphMarginTop:R}=n;return{[e]:{display:"table",width:"100%",[`${e}-header`]:{display:"table-cell",paddingInlineEnd:h,verticalAlign:"top",[t]:Object.assign({display:"inline-block",verticalAlign:"top",background:C},hf(l)),[`${t}-circle`]:{borderRadius:"50%"},[`${t}-lg`]:Object.assign({},hf(c)),[`${t}-sm`]:Object.assign({},hf(u))},[`${e}-content`]:{display:"table-cell",width:"100%",verticalAlign:"top",[i]:{width:"100%",height:B,background:C,borderRadius:b,[`+ ${a}`]:{marginBlockStart:u}},[a]:{padding:0,"> li":{width:"100%",height:y,listStyle:"none",background:C,borderRadius:b,"+ li":{marginBlockStart:S}}},[`${a}> li:last-child:not(:first-child):not(:nth-child(2))`]:{width:"61%"}},[`&-round ${e}-content`]:{[`${i}, ${a} > li`]:{borderRadius:p}}},[`${e}-with-avatar ${e}-content`]:{[i]:{marginBlockStart:m,[`+ ${a}`]:{marginBlockStart:R}}},[`${e}${e}-element`]:Object.assign(Object.assign(Object.assign(Object.assign({display:"inline-block",width:"auto"},qse(n)),Jse(n)),jse(n)),Qse(n)),[`${e}${e}-block`]:{width:"100%",[o]:{width:"100%"},[r]:{width:"100%"}},[`${e}${e}-active`]:{[`
        ${i},
        ${a} > li,
        ${t},
        ${o},
        ${r},
        ${s}
      `]:Object.assign({},Pse(n))}}},ele=n=>{const{colorFillContent:e,colorFill:t}=n,i=e,a=t;return{color:i,colorGradientEnd:a,gradientFromColor:i,gradientToColor:a,titleHeight:n.controlHeight/2,blockRadius:n.borderRadiusSM,paragraphMarginTop:n.marginLG+n.marginXXS,paragraphLiHeight:n.controlHeight/2}},nA=Oa("Skeleton",n=>{const{componentCls:e,calc:t}=n,i=Xi(n,{skeletonAvatarCls:`${e}-avatar`,skeletonTitleCls:`${e}-title`,skeletonParagraphCls:`${e}-paragraph`,skeletonButtonCls:`${e}-button`,skeletonInputCls:`${e}-input`,skeletonImageCls:`${e}-image`,imageSizeBase:t(n.controlHeight).mul(1.5).equal(),borderRadius:100,skeletonLoadingBackground:`linear-gradient(90deg, ${n.gradientFromColor} 25%, ${n.gradientToColor} 37%, ${n.gradientFromColor} 63%)`,skeletonLoadingMotionDuration:"1.4s"});return[$se(i)]},ele,{deprecatedTokens:[["color","gradientFromColor"],["colorGradientEnd","gradientToColor"]]}),tle=n=>{const{prefixCls:e,className:t,rootClassName:i,active:a,shape:o="circle",size:r="default"}=n,{getPrefixCls:s}=v.useContext(ui),l=s("skeleton",e),[c,u,C]=nA(l),h=Ss(n,["prefixCls","className"]),m=gt(l,`${l}-element`,{[`${l}-active`]:a},t,i,u,C);return c(v.createElement("div",{className:m},v.createElement(uS,Object.assign({prefixCls:`${l}-avatar`,shape:o,size:r},h))))},nle=n=>{const{prefixCls:e,className:t,rootClassName:i,active:a,block:o=!1,size:r="default"}=n,{getPrefixCls:s}=v.useContext(ui),l=s("skeleton",e),[c,u,C]=nA(l),h=Ss(n,["prefixCls"]),m=gt(l,`${l}-element`,{[`${l}-active`]:a,[`${l}-block`]:o},t,i,u,C);return c(v.createElement("div",{className:m},v.createElement(uS,Object.assign({prefixCls:`${l}-button`,size:r},h))))},ile="M365.714286 329.142857q0 45.714286-32.036571 77.677714t-77.677714 32.036571-77.677714-32.036571-32.036571-77.677714 32.036571-77.677714 77.677714-32.036571 77.677714 32.036571 32.036571 77.677714zM950.857143 548.571429l0 256-804.571429 0 0-109.714286 182.857143-182.857143 91.428571 91.428571 292.571429-292.571429zM1005.714286 146.285714l-914.285714 0q-7.460571 0-12.873143 5.412571t-5.412571 12.873143l0 694.857143q0 7.460571 5.412571 12.873143t12.873143 5.412571l914.285714 0q7.460571 0 12.873143-5.412571t5.412571-12.873143l0-694.857143q0-7.460571-5.412571-12.873143t-12.873143-5.412571zM1097.142857 164.571429l0 694.857143q0 37.741714-26.843429 64.585143t-64.585143 26.843429l-914.285714 0q-37.741714 0-64.585143-26.843429t-26.843429-64.585143l0-694.857143q0-37.741714 26.843429-64.585143t64.585143-26.843429l914.285714 0q37.741714 0 64.585143 26.843429t26.843429 64.585143z",ale=n=>{const{prefixCls:e,className:t,rootClassName:i,style:a,active:o}=n,{getPrefixCls:r}=v.useContext(ui),s=r("skeleton",e),[l,c,u]=nA(s),C=gt(s,`${s}-element`,{[`${s}-active`]:o},t,i,c,u);return l(v.createElement("div",{className:C},v.createElement("div",{className:gt(`${s}-image`,t),style:a},v.createElement("svg",{viewBox:"0 0 1098 1024",xmlns:"http://www.w3.org/2000/svg",className:`${s}-image-svg`},v.createElement("title",null,"Image placeholder"),v.createElement("path",{d:ile,className:`${s}-image-path`})))))},ole=n=>{const{prefixCls:e,className:t,rootClassName:i,active:a,block:o,size:r="default"}=n,{getPrefixCls:s}=v.useContext(ui),l=s("skeleton",e),[c,u,C]=nA(l),h=Ss(n,["prefixCls"]),m=gt(l,`${l}-element`,{[`${l}-active`]:a,[`${l}-block`]:o},t,i,u,C);return c(v.createElement("div",{className:m},v.createElement(uS,Object.assign({prefixCls:`${l}-input`,size:r},h))))},rle=n=>{const{prefixCls:e,className:t,rootClassName:i,style:a,active:o,children:r}=n,{getPrefixCls:s}=v.useContext(ui),l=s("skeleton",e),[c,u,C]=nA(l),h=gt(l,`${l}-element`,{[`${l}-active`]:o},u,t,i,C);return c(v.createElement("div",{className:h},v.createElement("div",{className:gt(`${l}-image`,t),style:a},r)))},sle=(n,e)=>{const{width:t,rows:i=2}=e;if(Array.isArray(t))return t[n];if(i-1===n)return t},lle=n=>{const{prefixCls:e,className:t,style:i,rows:a=0}=n,o=Array.from({length:a}).map((r,s)=>v.createElement("li",{key:s,style:{width:sle(s,n)}}));return v.createElement("ul",{className:gt(e,t),style:i},o)},cle=n=>{let{prefixCls:e,className:t,width:i,style:a}=n;return v.createElement("h3",{className:gt(e,t),style:Object.assign({width:i},a)})};function o1(n){return n&&typeof n=="object"?n:{}}function gle(n,e){return n&&!e?{size:"large",shape:"square"}:{size:"large",shape:"circle"}}function ule(n,e){return!n&&e?{width:"38%"}:n&&e?{width:"50%"}:{}}function dle(n,e){const t={};return(!n||!e)&&(t.width="61%"),!n&&e?t.rows=3:t.rows=2,t}const iA=n=>{const{prefixCls:e,loading:t,className:i,rootClassName:a,style:o,children:r,avatar:s=!1,title:l=!0,paragraph:c=!0,active:u,round:C}=n,{getPrefixCls:h,direction:m,className:p,style:B}=Gs("skeleton"),b=h("skeleton",e),[y,S,R]=nA(b);if(t||!("loading"in n)){const Z=!!s,x=!!l,M=!!c;let E;if(Z){const H=Object.assign(Object.assign({prefixCls:`${b}-avatar`},gle(x,M)),o1(s));E=v.createElement("div",{className:`${b}-header`},v.createElement(uS,Object.assign({},H)))}let F;if(x||M){let H;if(x){const _=Object.assign(Object.assign({prefixCls:`${b}-title`},ule(Z,M)),o1(l));H=v.createElement(cle,Object.assign({},_))}let z;if(M){const _=Object.assign(Object.assign({prefixCls:`${b}-paragraph`},dle(Z,x)),o1(c));z=v.createElement(lle,Object.assign({},_))}F=v.createElement("div",{className:`${b}-content`},H,z)}const N=gt(b,{[`${b}-with-avatar`]:Z,[`${b}-active`]:u,[`${b}-rtl`]:m==="rtl",[`${b}-round`]:C},p,i,a,S,R);return y(v.createElement("div",{className:N,style:Object.assign(Object.assign({},B),o)},E,F))}return r??null};iA.Button=nle;iA.Avatar=tle;iA.Input=ole;iA.Image=ale;iA.Node=rle;const Cle=n=>{const{componentCls:e}=n;return{[e]:{display:"flex",flexFlow:"row wrap",minWidth:0,"&::before, &::after":{display:"flex"},"&-no-wrap":{flexWrap:"nowrap"},"&-start":{justifyContent:"flex-start"},"&-center":{justifyContent:"center"},"&-end":{justifyContent:"flex-end"},"&-space-between":{justifyContent:"space-between"},"&-space-around":{justifyContent:"space-around"},"&-space-evenly":{justifyContent:"space-evenly"},"&-top":{alignItems:"flex-start"},"&-middle":{alignItems:"center"},"&-bottom":{alignItems:"flex-end"}}}},Ile=n=>{const{componentCls:e}=n;return{[e]:{position:"relative",maxWidth:"100%",minHeight:1}}},hle=(n,e)=>{const{prefixCls:t,componentCls:i,gridColumns:a}=n,o={};for(let r=a;r>=0;r--)r===0?(o[`${i}${e}-${r}`]={display:"none"},o[`${i}-push-${r}`]={insetInlineStart:"auto"},o[`${i}-pull-${r}`]={insetInlineEnd:"auto"},o[`${i}${e}-push-${r}`]={insetInlineStart:"auto"},o[`${i}${e}-pull-${r}`]={insetInlineEnd:"auto"},o[`${i}${e}-offset-${r}`]={marginInlineStart:0},o[`${i}${e}-order-${r}`]={order:0}):(o[`${i}${e}-${r}`]=[{"--ant-display":"block",display:"block"},{display:"var(--ant-display)",flex:`0 0 ${r/a*100}%`,maxWidth:`${r/a*100}%`}],o[`${i}${e}-push-${r}`]={insetInlineStart:`${r/a*100}%`},o[`${i}${e}-pull-${r}`]={insetInlineEnd:`${r/a*100}%`},o[`${i}${e}-offset-${r}`]={marginInlineStart:`${r/a*100}%`},o[`${i}${e}-order-${r}`]={order:r});return o[`${i}${e}-flex`]={flex:`var(--${t}${e}-flex)`},o},lZ=(n,e)=>hle(n,e),fle=(n,e,t)=>({[`@media (min-width: ${st(e)})`]:Object.assign({},lZ(n,t))}),Ale=()=>({}),mle=()=>({}),ple=Oa("Grid",Cle,Ale),ble=n=>({xs:n.screenXSMin,sm:n.screenSMMin,md:n.screenMDMin,lg:n.screenLGMin,xl:n.screenXLMin,xxl:n.screenXXLMin}),vle=Oa("Grid",n=>{const e=Xi(n,{gridColumns:24}),t=ble(e);return delete t.xs,[Ile(e),lZ(e,""),lZ(e,"-xs"),Object.keys(t).map(i=>fle(e,t[i],`-${i}`)).reduce((i,a)=>Object.assign(Object.assign({},i),a),{})]},mle);function yle(n){return e=>v.createElement($f,{theme:{token:{motion:!1,zIndexPopupBase:0}}},v.createElement(n,Object.assign({},e)))}const Ble=(n,e,t,i,a)=>yle(r=>{const{prefixCls:s,style:l}=r,c=v.useRef(null),[u,C]=v.useState(0),[h,m]=v.useState(0),[p,B]=_a(!1,{value:r.open}),{getPrefixCls:b}=v.useContext(ui),y=b("select",s);v.useEffect(()=>{if(B(!0),typeof ResizeObserver<"u"){const Z=new ResizeObserver(M=>{const E=M[0].target;C(E.offsetHeight+8),m(E.offsetWidth)}),x=setInterval(()=>{var M;const E=`.${y}-dropdown`,F=(M=c.current)===null||M===void 0?void 0:M.querySelector(E);F&&(clearInterval(x),Z.observe(F))},10);return()=>{clearInterval(x),Z.disconnect()}}},[]);let S=Object.assign(Object.assign({},r),{style:Object.assign(Object.assign({},l),{margin:0}),open:p,visible:p,getPopupContainer:()=>c.current});Object.assign(S,{[e]:{overflow:{adjustX:!1,adjustY:!1}}});const R={paddingBottom:u,position:"relative",minWidth:h};return v.createElement("div",{ref:c,style:R},v.createElement(n,Object.assign({},S)))}),wM=function(){if(typeof navigator>"u"||typeof window>"u")return!1;var n=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(n)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(n==null?void 0:n.substr(0,4))};var CS=function(e){var t=e.className,i=e.customizeIcon,a=e.customizeIconProps,o=e.children,r=e.onMouseDown,s=e.onClick,l=typeof i=="function"?i(a):i;return v.createElement("span",{className:t,onMouseDown:function(u){u.preventDefault(),r==null||r(u)},style:{userSelect:"none",WebkitUserSelect:"none"},unselectable:"on",onClick:s,"aria-hidden":!0},l!==void 0?l:v.createElement("span",{className:gt(t.split(/\s+/).map(function(c){return"".concat(c,"-icon")}))},o))},Gle=function(e,t,i,a,o){var r=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!1,s=arguments.length>6?arguments[6]:void 0,l=arguments.length>7?arguments[7]:void 0,c=Ct.useMemo(function(){if(Bn(a)==="object")return a.clearIcon;if(o)return o},[a,o]),u=Ct.useMemo(function(){return!!(!r&&a&&(i.length||s)&&!(l==="combobox"&&s===""))},[a,r,i.length,s,l]);return{allowClear:u,clearIcon:Ct.createElement(CS,{className:"".concat(e,"-clear"),onMouseDown:t,customizeIcon:c},"")}},Bz=v.createContext(null);function Sle(){return v.useContext(Bz)}function wle(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:10,e=v.useState(!1),t=rt(e,2),i=t[0],a=t[1],o=v.useRef(null),r=function(){window.clearTimeout(o.current)};v.useEffect(function(){return r},[]);var s=function(c,u){r(),o.current=window.setTimeout(function(){a(c),u&&u()},n)};return[i,s,r]}function Gz(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:250,e=v.useRef(null),t=v.useRef(null);v.useEffect(function(){return function(){window.clearTimeout(t.current)}},[]);function i(a){(a||e.current===null)&&(e.current=a),window.clearTimeout(t.current),t.current=window.setTimeout(function(){e.current=null},n)}return[function(){return e.current},i]}function Rle(n,e,t,i){var a=v.useRef(null);a.current={open:e,triggerOpen:t,customizedTrigger:i},v.useEffect(function(){function o(r){var s;if(!((s=a.current)!==null&&s!==void 0&&s.customizedTrigger)){var l=r.target;l.shadowRoot&&r.composed&&(l=r.composedPath()[0]||l),a.current.open&&n().filter(function(c){return c}).every(function(c){return!c.contains(l)&&c!==l})&&a.current.triggerOpen(!1)}}return window.addEventListener("mousedown",o),function(){return window.removeEventListener("mousedown",o)}},[])}function Zle(n){return n&&![tn.ESC,tn.SHIFT,tn.BACKSPACE,tn.TAB,tn.WIN_KEY,tn.ALT,tn.META,tn.WIN_KEY_RIGHT,tn.CTRL,tn.SEMICOLON,tn.EQUALS,tn.CAPS_LOCK,tn.CONTEXT_MENU,tn.F1,tn.F2,tn.F3,tn.F4,tn.F5,tn.F6,tn.F7,tn.F8,tn.F9,tn.F10,tn.F11,tn.F12].includes(n)}var xle=["prefixCls","invalidate","item","renderItem","responsive","responsiveDisabled","registerSize","itemKey","className","style","children","display","order","component"],Ph=void 0;function Mle(n,e){var t=n.prefixCls,i=n.invalidate,a=n.item,o=n.renderItem,r=n.responsive,s=n.responsiveDisabled,l=n.registerSize,c=n.itemKey,u=n.className,C=n.style,h=n.children,m=n.display,p=n.order,B=n.component,b=B===void 0?"div":B,y=_n(n,xle),S=r&&!m;function R(F){l(c,F)}v.useEffect(function(){return function(){R(null)}},[]);var Z=o&&a!==Ph?o(a,{index:p}):h,x;i||(x={opacity:S?0:1,height:S?0:Ph,overflowY:S?"hidden":Ph,order:r?p:Ph,pointerEvents:S?"none":Ph,position:S?"absolute":Ph});var M={};S&&(M["aria-hidden"]=!0);var E=v.createElement(b,$t({className:gt(!i&&t,u),style:Ke(Ke({},x),C)},M,y,{ref:e}),Z);return r&&(E=v.createElement(vl,{onResize:function(N){var H=N.offsetWidth;R(H)},disabled:s},E)),E}var mp=v.forwardRef(Mle);mp.displayName="Item";function Wle(n){if(typeof MessageChannel>"u")mi(n);else{var e=new MessageChannel;e.port1.onmessage=function(){return n()},e.port2.postMessage(void 0)}}function Vle(){var n=v.useRef(null),e=function(i){n.current||(n.current=[],Wle(function(){md.unstable_batchedUpdates(function(){n.current.forEach(function(a){a()}),n.current=null})})),n.current.push(i)};return e}function Tm(n,e){var t=v.useState(e),i=rt(t,2),a=i[0],o=i[1],r=Aa(function(s){n(function(){o(s)})});return[a,r]}var JB=Ct.createContext(null),Nle=["component"],Ele=["className"],Hle=["className"],Fle=function(e,t){var i=v.useContext(JB);if(!i){var a=e.component,o=a===void 0?"div":a,r=_n(e,Nle);return v.createElement(o,$t({},r,{ref:t}))}var s=i.className,l=_n(i,Ele),c=e.className,u=_n(e,Hle);return v.createElement(JB.Provider,{value:null},v.createElement(mp,$t({ref:t,className:gt(s,c)},l,u)))},Sz=v.forwardRef(Fle);Sz.displayName="RawItem";var Xle=["prefixCls","data","renderItem","renderRawItem","itemKey","itemWidth","ssr","style","className","maxCount","renderRest","renderRawRest","suffix","component","itemComponent","onVisibleChange"],wz="responsive",Rz="invalidate";function Tle(n){return"+ ".concat(n.length," ...")}function Yle(n,e){var t=n.prefixCls,i=t===void 0?"rc-overflow":t,a=n.data,o=a===void 0?[]:a,r=n.renderItem,s=n.renderRawItem,l=n.itemKey,c=n.itemWidth,u=c===void 0?10:c,C=n.ssr,h=n.style,m=n.className,p=n.maxCount,B=n.renderRest,b=n.renderRawRest,y=n.suffix,S=n.component,R=S===void 0?"div":S,Z=n.itemComponent,x=n.onVisibleChange,M=_n(n,Xle),E=C==="full",F=Vle(),N=Tm(F,null),H=rt(N,2),z=H[0],_=H[1],D=z||0,P=Tm(F,new Map),$=rt(P,2),X=$[0],L=$[1],U=Tm(F,0),q=rt(U,2),K=q[0],O=q[1],j=Tm(F,0),ne=rt(j,2),k=ne[0],ie=ne[1],re=Tm(F,0),ge=rt(re,2),de=ge[0],xe=ge[1],Ne=v.useState(null),ye=rt(Ne,2),pe=ye[0],Te=ye[1],le=v.useState(null),Ye=rt(le,2),he=Ye[0],Ge=Ye[1],be=v.useMemo(function(){return he===null&&E?Number.MAX_SAFE_INTEGER:he||0},[he,z]),Ee=v.useState(!1),Se=rt(Ee,2),ee=Se[0],Q=Se[1],ce="".concat(i,"-item"),me=Math.max(K,k),Ze=p===wz,Xe=o.length&&Ze,De=p===Rz,Oe=Xe||typeof p=="number"&&o.length>p,Je=v.useMemo(function(){var Zt=o;return Xe?z===null&&E?Zt=o:Zt=o.slice(0,Math.min(o.length,D/u)):typeof p=="number"&&(Zt=o.slice(0,p)),Zt},[o,u,z,p,Xe]),At=v.useMemo(function(){return Xe?o.slice(be+1):o.slice(Je.length)},[o,Je,Xe,be]),qe=v.useCallback(function(Zt,yt){var Ht;return typeof l=="function"?l(Zt):(Ht=l&&(Zt==null?void 0:Zt[l]))!==null&&Ht!==void 0?Ht:yt},[l]),lt=v.useCallback(r||function(Zt){return Zt},[r]);function $e(Zt,yt,Ht){he===Zt&&(yt===void 0||yt===pe)||(Ge(Zt),Ht||(Q(Zt<o.length-1),x==null||x(Zt)),yt!==void 0&&Te(yt))}function je(Zt,yt){_(yt.clientWidth)}function ke(Zt,yt){L(function(Ht){var jt=new Map(Ht);return yt===null?jt.delete(Zt):jt.set(Zt,yt),jt})}function Ce(Zt,yt){ie(yt),O(k)}function He(Zt,yt){xe(yt)}function ht(Zt){return X.get(qe(Je[Zt],Zt))}xi(function(){if(D&&typeof me=="number"&&Je){var Zt=de,yt=Je.length,Ht=yt-1;if(!yt){$e(0,null);return}for(var jt=0;jt<yt;jt+=1){var Ut=ht(jt);if(E&&(Ut=Ut||0),Ut===void 0){$e(jt-1,void 0,!0);break}if(Zt+=Ut,Ht===0&&Zt<=D||jt===Ht-1&&Zt+ht(Ht)<=D){$e(Ht,null);break}else if(Zt+me>D){$e(jt-1,Zt-Ut-de+k);break}}y&&ht(0)+de>D&&Te(null)}},[D,X,k,de,qe,Je]);var we=ee&&!!At.length,ze={};pe!==null&&Xe&&(ze={position:"absolute",left:pe,top:0});var Qe={prefixCls:ce,responsive:Xe,component:Z,invalidate:De},ut=s?function(Zt,yt){var Ht=qe(Zt,yt);return v.createElement(JB.Provider,{key:Ht,value:Ke(Ke({},Qe),{},{order:yt,item:Zt,itemKey:Ht,registerSize:ke,display:yt<=be})},s(Zt,yt))}:function(Zt,yt){var Ht=qe(Zt,yt);return v.createElement(mp,$t({},Qe,{order:yt,key:Ht,item:Zt,renderItem:lt,itemKey:Ht,registerSize:ke,display:yt<=be}))},Rt={order:we?be:Number.MAX_SAFE_INTEGER,className:"".concat(ce,"-rest"),registerSize:Ce,display:we},mt=B||Tle,_t=b?v.createElement(JB.Provider,{value:Ke(Ke({},Qe),Rt)},b(At)):v.createElement(mp,$t({},Qe,Rt),typeof mt=="function"?mt(At):mt),Lt=v.createElement(R,$t({className:gt(!De&&i,m),style:h,ref:e},M),Je.map(ut),Oe?_t:null,y&&v.createElement(mp,$t({},Qe,{responsive:Ze,responsiveDisabled:!Xe,order:be,className:"".concat(ce,"-suffix"),registerSize:He,display:!0,style:ze}),y));return Ze?v.createElement(vl,{onResize:je,disabled:!Xe},Lt):Lt}var gg=v.forwardRef(Yle);gg.displayName="Overflow";gg.Item=Sz;gg.RESPONSIVE=wz;gg.INVALIDATE=Rz;var zle=function(e,t){var i,a=e.prefixCls,o=e.id,r=e.inputElement,s=e.disabled,l=e.tabIndex,c=e.autoFocus,u=e.autoComplete,C=e.editable,h=e.activeDescendantId,m=e.value,p=e.maxLength,B=e.onKeyDown,b=e.onMouseDown,y=e.onChange,S=e.onPaste,R=e.onCompositionStart,Z=e.onCompositionEnd,x=e.onBlur,M=e.open,E=e.attrs,F=r||v.createElement("input",null),N=F,H=N.ref,z=N.props,_=z.onKeyDown,D=z.onChange,P=z.onMouseDown,$=z.onCompositionStart,X=z.onCompositionEnd,L=z.onBlur,U=z.style;return"maxLength"in F.props,F=v.cloneElement(F,Ke(Ke(Ke({type:"search"},z),{},{id:o,ref:Bs(t,H),disabled:s,tabIndex:l,autoComplete:u||"off",autoFocus:c,className:gt("".concat(a,"-selection-search-input"),(i=F)===null||i===void 0||(i=i.props)===null||i===void 0?void 0:i.className),role:"combobox","aria-expanded":M||!1,"aria-haspopup":"listbox","aria-owns":"".concat(o,"_list"),"aria-autocomplete":"list","aria-controls":"".concat(o,"_list"),"aria-activedescendant":M?h:void 0},E),{},{value:C?m:"",maxLength:p,readOnly:!C,unselectable:C?null:"on",style:Ke(Ke({},U),{},{opacity:C?null:0}),onKeyDown:function(K){B(K),_&&_(K)},onMouseDown:function(K){b(K),P&&P(K)},onChange:function(K){y(K),D&&D(K)},onCompositionStart:function(K){R(K),$&&$(K)},onCompositionEnd:function(K){Z(K),X&&X(K)},onPaste:S,onBlur:function(K){x(K),L&&L(K)}})),F},Zz=v.forwardRef(zle);function xz(n){return Array.isArray(n)?n:n!==void 0?[n]:[]}var Kle=typeof window<"u"&&window.document&&window.document.documentElement,Lle=Kle;function _le(n){return n!=null}function Dle(n){return!n&&n!==0}function $H(n){return["string","number"].includes(Bn(n))}function Mz(n){var e=void 0;return n&&($H(n.title)?e=n.title.toString():$H(n.label)&&(e=n.label.toString())),e}function Ole(n,e){Lle?v.useLayoutEffect(n,e):v.useEffect(n,e)}function Ule(n){var e;return(e=n.key)!==null&&e!==void 0?e:n.value}var e3=function(e){e.preventDefault(),e.stopPropagation()},kle=function(e){var t=e.id,i=e.prefixCls,a=e.values,o=e.open,r=e.searchValue,s=e.autoClearSearchValue,l=e.inputRef,c=e.placeholder,u=e.disabled,C=e.mode,h=e.showSearch,m=e.autoFocus,p=e.autoComplete,B=e.activeDescendantId,b=e.tabIndex,y=e.removeIcon,S=e.maxTagCount,R=e.maxTagTextLength,Z=e.maxTagPlaceholder,x=Z===void 0?function(le){return"+ ".concat(le.length," ...")}:Z,M=e.tagRender,E=e.onToggleOpen,F=e.onRemove,N=e.onInputChange,H=e.onInputPaste,z=e.onInputKeyDown,_=e.onInputMouseDown,D=e.onInputCompositionStart,P=e.onInputCompositionEnd,$=e.onInputBlur,X=v.useRef(null),L=v.useState(0),U=rt(L,2),q=U[0],K=U[1],O=v.useState(!1),j=rt(O,2),ne=j[0],k=j[1],ie="".concat(i,"-selection"),re=o||C==="multiple"&&s===!1||C==="tags"?r:"",ge=C==="tags"||C==="multiple"&&s===!1||h&&(o||ne);Ole(function(){K(X.current.scrollWidth)},[re]);var de=function(Ye,he,Ge,be,Ee){return v.createElement("span",{title:Mz(Ye),className:gt("".concat(ie,"-item"),Ve({},"".concat(ie,"-item-disabled"),Ge))},v.createElement("span",{className:"".concat(ie,"-item-content")},he),be&&v.createElement(CS,{className:"".concat(ie,"-item-remove"),onMouseDown:e3,onClick:Ee,customizeIcon:y},""))},xe=function(Ye,he,Ge,be,Ee,Se){var ee=function(ce){e3(ce),E(!o)};return v.createElement("span",{onMouseDown:ee},M({label:he,value:Ye,disabled:Ge,closable:be,onClose:Ee,isMaxTag:!!Se}))},Ne=function(Ye){var he=Ye.disabled,Ge=Ye.label,be=Ye.value,Ee=!u&&!he,Se=Ge;if(typeof R=="number"&&(typeof Ge=="string"||typeof Ge=="number")){var ee=String(Se);ee.length>R&&(Se="".concat(ee.slice(0,R),"..."))}var Q=function(me){me&&me.stopPropagation(),F(Ye)};return typeof M=="function"?xe(be,Se,he,Ee,Q):de(Ye,Se,he,Ee,Q)},ye=function(Ye){if(!a.length)return null;var he=typeof x=="function"?x(Ye):x;return typeof M=="function"?xe(void 0,he,!1,!1,void 0,!0):de({title:he},he,!1)},pe=v.createElement("div",{className:"".concat(ie,"-search"),style:{width:q},onFocus:function(){k(!0)},onBlur:function(){k(!1)}},v.createElement(Zz,{ref:l,open:o,prefixCls:i,id:t,inputElement:null,disabled:u,autoFocus:m,autoComplete:p,editable:ge,activeDescendantId:B,value:re,onKeyDown:z,onMouseDown:_,onChange:N,onPaste:H,onCompositionStart:D,onCompositionEnd:P,onBlur:$,tabIndex:b,attrs:hI(e,!0)}),v.createElement("span",{ref:X,className:"".concat(ie,"-search-mirror"),"aria-hidden":!0},re,"")),Te=v.createElement(gg,{prefixCls:"".concat(ie,"-overflow"),data:a,renderItem:Ne,renderRest:ye,suffix:pe,itemKey:Ule,maxCount:S});return v.createElement("span",{className:"".concat(ie,"-wrap")},Te,!a.length&&!re&&v.createElement("span",{className:"".concat(ie,"-placeholder")},c))},Ple=function(e){var t=e.inputElement,i=e.prefixCls,a=e.id,o=e.inputRef,r=e.disabled,s=e.autoFocus,l=e.autoComplete,c=e.activeDescendantId,u=e.mode,C=e.open,h=e.values,m=e.placeholder,p=e.tabIndex,B=e.showSearch,b=e.searchValue,y=e.activeValue,S=e.maxLength,R=e.onInputKeyDown,Z=e.onInputMouseDown,x=e.onInputChange,M=e.onInputPaste,E=e.onInputCompositionStart,F=e.onInputCompositionEnd,N=e.onInputBlur,H=e.title,z=v.useState(!1),_=rt(z,2),D=_[0],P=_[1],$=u==="combobox",X=$||B,L=h[0],U=b||"";$&&y&&!D&&(U=y),v.useEffect(function(){$&&P(!1)},[$,y]);var q=u!=="combobox"&&!C&&!B?!1:!!U,K=H===void 0?Mz(L):H,O=v.useMemo(function(){return L?null:v.createElement("span",{className:"".concat(i,"-selection-placeholder"),style:q?{visibility:"hidden"}:void 0},m)},[L,q,m,i]);return v.createElement("span",{className:"".concat(i,"-selection-wrap")},v.createElement("span",{className:"".concat(i,"-selection-search")},v.createElement(Zz,{ref:o,prefixCls:i,id:a,open:C,inputElement:t,disabled:r,autoFocus:s,autoComplete:l,editable:X,activeDescendantId:c,value:U,onKeyDown:R,onMouseDown:Z,onChange:function(ne){P(!0),x(ne)},onPaste:M,onCompositionStart:E,onCompositionEnd:F,onBlur:N,tabIndex:p,attrs:hI(e,!0),maxLength:$?S:void 0})),!$&&L?v.createElement("span",{className:"".concat(i,"-selection-item"),title:K,style:q?{visibility:"hidden"}:void 0},L.label):null,O)},Jle=function(e,t){var i=v.useRef(null),a=v.useRef(!1),o=e.prefixCls,r=e.open,s=e.mode,l=e.showSearch,c=e.tokenWithEnter,u=e.disabled,C=e.prefix,h=e.autoClearSearchValue,m=e.onSearch,p=e.onSearchSubmit,B=e.onToggleOpen,b=e.onInputKeyDown,y=e.onInputBlur,S=e.domRef;v.useImperativeHandle(t,function(){return{focus:function(K){i.current.focus(K)},blur:function(){i.current.blur()}}});var R=Gz(0),Z=rt(R,2),x=Z[0],M=Z[1],E=function(K){var O=K.which,j=i.current instanceof HTMLTextAreaElement;!j&&r&&(O===tn.UP||O===tn.DOWN)&&K.preventDefault(),b&&b(K),O===tn.ENTER&&s==="tags"&&!a.current&&!r&&(p==null||p(K.target.value)),!(j&&!r&&~[tn.UP,tn.DOWN,tn.LEFT,tn.RIGHT].indexOf(O))&&Zle(O)&&B(!0)},F=function(){M(!0)},N=v.useRef(null),H=function(K){m(K,!0,a.current)!==!1&&B(!0)},z=function(){a.current=!0},_=function(K){a.current=!1,s!=="combobox"&&H(K.target.value)},D=function(K){var O=K.target.value;if(c&&N.current&&/[\r\n]/.test(N.current)){var j=N.current.replace(/[\r\n]+$/,"").replace(/\r\n/g," ").replace(/[\r\n]/g," ");O=O.replace(j,N.current)}N.current=null,H(O)},P=function(K){var O=K.clipboardData,j=O==null?void 0:O.getData("text");N.current=j||""},$=function(K){var O=K.target;if(O!==i.current){var j=document.body.style.msTouchAction!==void 0;j?setTimeout(function(){i.current.focus()}):i.current.focus()}},X=function(K){var O=x();K.target!==i.current&&!O&&!(s==="combobox"&&u)&&K.preventDefault(),(s!=="combobox"&&(!l||!O)||!r)&&(r&&h!==!1&&m("",!0,!1),B())},L={inputRef:i,onInputKeyDown:E,onInputMouseDown:F,onInputChange:D,onInputPaste:P,onInputCompositionStart:z,onInputCompositionEnd:_,onInputBlur:y},U=s==="multiple"||s==="tags"?v.createElement(kle,$t({},e,L)):v.createElement(Ple,$t({},e,L));return v.createElement("div",{ref:S,className:"".concat(o,"-selector"),onClick:$,onMouseDown:X},C&&v.createElement("div",{className:"".concat(o,"-prefix")},C),U)},jle=v.forwardRef(Jle);function Qle(n){var e=n.prefixCls,t=n.align,i=n.arrow,a=n.arrowPos,o=i||{},r=o.className,s=o.content,l=a.x,c=l===void 0?0:l,u=a.y,C=u===void 0?0:u,h=v.useRef();if(!t||!t.points)return null;var m={position:"absolute"};if(t.autoArrow!==!1){var p=t.points[0],B=t.points[1],b=p[0],y=p[1],S=B[0],R=B[1];b===S||!["t","b"].includes(b)?m.top=C:b==="t"?m.top=0:m.bottom=0,y===R||!["l","r"].includes(y)?m.left=c:y==="l"?m.left=0:m.right=0}return v.createElement("div",{ref:h,className:gt("".concat(e,"-arrow"),r),style:m},s)}function qle(n){var e=n.prefixCls,t=n.open,i=n.zIndex,a=n.mask,o=n.motion;return a?v.createElement(GI,$t({},o,{motionAppear:!0,visible:t,removeOnLeave:!0}),function(r){var s=r.className;return v.createElement("div",{style:{zIndex:i},className:gt("".concat(e,"-mask"),s)})}):null}var $le=v.memo(function(n){var e=n.children;return e},function(n,e){return e.cache}),ece=v.forwardRef(function(n,e){var t=n.popup,i=n.className,a=n.prefixCls,o=n.style,r=n.target,s=n.onVisibleChanged,l=n.open,c=n.keepDom,u=n.fresh,C=n.onClick,h=n.mask,m=n.arrow,p=n.arrowPos,B=n.align,b=n.motion,y=n.maskMotion,S=n.forceRender,R=n.getPopupContainer,Z=n.autoDestroy,x=n.portal,M=n.zIndex,E=n.onMouseEnter,F=n.onMouseLeave,N=n.onPointerEnter,H=n.onPointerDownCapture,z=n.ready,_=n.offsetX,D=n.offsetY,P=n.offsetR,$=n.offsetB,X=n.onAlign,L=n.onPrepare,U=n.stretch,q=n.targetWidth,K=n.targetHeight,O=typeof t=="function"?t():t,j=l||c,ne=(R==null?void 0:R.length)>0,k=v.useState(!R||!ne),ie=rt(k,2),re=ie[0],ge=ie[1];if(xi(function(){!re&&ne&&r&&ge(!0)},[re,ne,r]),!re)return null;var de="auto",xe={left:"-1000vw",top:"-1000vh",right:de,bottom:de};if(z||!l){var Ne,ye=B.points,pe=B.dynamicInset||((Ne=B._experimental)===null||Ne===void 0?void 0:Ne.dynamicInset),Te=pe&&ye[0][1]==="r",le=pe&&ye[0][0]==="b";Te?(xe.right=P,xe.left=de):(xe.left=_,xe.right=de),le?(xe.bottom=$,xe.top=de):(xe.top=D,xe.bottom=de)}var Ye={};return U&&(U.includes("height")&&K?Ye.height=K:U.includes("minHeight")&&K&&(Ye.minHeight=K),U.includes("width")&&q?Ye.width=q:U.includes("minWidth")&&q&&(Ye.minWidth=q)),l||(Ye.pointerEvents="none"),v.createElement(x,{open:S||j,getContainer:R&&function(){return R(r)},autoDestroy:Z},v.createElement(qle,{prefixCls:a,open:l,zIndex:M,mask:h,motion:y}),v.createElement(vl,{onResize:X,disabled:!l},function(he){return v.createElement(GI,$t({motionAppear:!0,motionEnter:!0,motionLeave:!0,removeOnLeave:!1,forceRender:S,leavedClassName:"".concat(a,"-hidden")},b,{onAppearPrepare:L,onEnterPrepare:L,visible:l,onVisibleChanged:function(be){var Ee;b==null||(Ee=b.onVisibleChanged)===null||Ee===void 0||Ee.call(b,be),s(be)}}),function(Ge,be){var Ee=Ge.className,Se=Ge.style,ee=gt(a,Ee,i);return v.createElement("div",{ref:Bs(he,e,be),className:ee,style:Ke(Ke(Ke(Ke({"--arrow-x":"".concat(p.x||0,"px"),"--arrow-y":"".concat(p.y||0,"px")},xe),Ye),Se),{},{boxSizing:"border-box",zIndex:M},o),onMouseEnter:E,onMouseLeave:F,onPointerEnter:N,onClick:C,onPointerDownCapture:H},m&&v.createElement(Qle,{prefixCls:a,arrow:m,arrowPos:p,align:B}),v.createElement($le,{cache:!l&&!u},O))})}))}),tce=v.forwardRef(function(n,e){var t=n.children,i=n.getTriggerDOMNode,a=BI(t),o=v.useCallback(function(s){aM(e,i?i(s):s)},[i]),r=yI(o,Qf(t));return a?v.cloneElement(t,{ref:r}):t}),t3=v.createContext(null);function n3(n){return n?Array.isArray(n)?n:[n]:[]}function nce(n,e,t,i){return v.useMemo(function(){var a=n3(t??e),o=n3(i??e),r=new Set(a),s=new Set(o);return n&&(r.has("hover")&&(r.delete("hover"),r.add("click")),s.has("hover")&&(s.delete("hover"),s.add("click"))),[r,s]},[n,e,t,i])}function ice(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],t=arguments.length>2?arguments[2]:void 0;return t?n[0]===e[0]:n[0]===e[0]&&n[1]===e[1]}function ace(n,e,t,i){for(var a=t.points,o=Object.keys(n),r=0;r<o.length;r+=1){var s,l=o[r];if(ice((s=n[l])===null||s===void 0?void 0:s.points,a,i))return"".concat(e,"-placement-").concat(l)}return""}function i3(n,e,t,i){return e||(t?{motionName:"".concat(n,"-").concat(t)}:i?{motionName:i}:null)}function wb(n){return n.ownerDocument.defaultView}function cZ(n){for(var e=[],t=n==null?void 0:n.parentElement,i=["hidden","scroll","clip","auto"];t;){var a=wb(t).getComputedStyle(t),o=a.overflowX,r=a.overflowY,s=a.overflow;[o,r,s].some(function(l){return i.includes(l)})&&e.push(t),t=t.parentElement}return e}function Up(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return Number.isNaN(n)?e:n}function Ym(n){return Up(parseFloat(n),0)}function a3(n,e){var t=Ke({},n);return(e||[]).forEach(function(i){if(!(i instanceof HTMLBodyElement||i instanceof HTMLHtmlElement)){var a=wb(i).getComputedStyle(i),o=a.overflow,r=a.overflowClipMargin,s=a.borderTopWidth,l=a.borderBottomWidth,c=a.borderLeftWidth,u=a.borderRightWidth,C=i.getBoundingClientRect(),h=i.offsetHeight,m=i.clientHeight,p=i.offsetWidth,B=i.clientWidth,b=Ym(s),y=Ym(l),S=Ym(c),R=Ym(u),Z=Up(Math.round(C.width/p*1e3)/1e3),x=Up(Math.round(C.height/h*1e3)/1e3),M=(p-B-S-R)*Z,E=(h-m-b-y)*x,F=b*x,N=y*x,H=S*Z,z=R*Z,_=0,D=0;if(o==="clip"){var P=Ym(r);_=P*Z,D=P*x}var $=C.x+H-_,X=C.y+F-D,L=$+C.width+2*_-H-z-M,U=X+C.height+2*D-F-N-E;t.left=Math.max(t.left,$),t.top=Math.max(t.top,X),t.right=Math.min(t.right,L),t.bottom=Math.min(t.bottom,U)}}),t}function o3(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t="".concat(e),i=t.match(/^(.*)\%$/);return i?n*(parseFloat(i[1])/100):parseFloat(t)}function r3(n,e){var t=e||[],i=rt(t,2),a=i[0],o=i[1];return[o3(n.width,a),o3(n.height,o)]}function s3(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return[n[0],n[1]]}function Jh(n,e){var t=e[0],i=e[1],a,o;return t==="t"?o=n.y:t==="b"?o=n.y+n.height:o=n.y+n.height/2,i==="l"?a=n.x:i==="r"?a=n.x+n.width:a=n.x+n.width/2,{x:a,y:o}}function cd(n,e){var t={t:"b",b:"t",l:"r",r:"l"};return n.map(function(i,a){return a===e?t[i]||"c":i}).join("")}function oce(n,e,t,i,a,o,r){var s=v.useState({ready:!1,offsetX:0,offsetY:0,offsetR:0,offsetB:0,arrowX:0,arrowY:0,scaleX:1,scaleY:1,align:a[i]||{}}),l=rt(s,2),c=l[0],u=l[1],C=v.useRef(0),h=v.useMemo(function(){return e?cZ(e):[]},[e]),m=v.useRef({}),p=function(){m.current={}};n||p();var B=Aa(function(){if(e&&t&&n){let Ki=function(ba,Ea){var po=arguments.length>2&&arguments[2]!==void 0?arguments[2]:me,jo=k.x+ba,Jr=k.y+Ea,br=jo+Te,un=Jr+pe,wn=Math.max(jo,po.left),hi=Math.max(Jr,po.top),Dn=Math.min(br,po.right),Gi=Math.min(un,po.bottom);return Math.max(0,(Dn-wn)*(Gi-hi))},Ua=function(){Fe=k.y+Ht,ot=Fe+pe,at=k.x+yt,It=at+Te};var bc=Ki,pr=Ua,S,R,Z,x,M=e,E=M.ownerDocument,F=wb(M),N=F.getComputedStyle(M),H=N.width,z=N.height,_=N.position,D=M.style.left,P=M.style.top,$=M.style.right,X=M.style.bottom,L=M.style.overflow,U=Ke(Ke({},a[i]),o),q=E.createElement("div");(S=M.parentElement)===null||S===void 0||S.appendChild(q),q.style.left="".concat(M.offsetLeft,"px"),q.style.top="".concat(M.offsetTop,"px"),q.style.position=_,q.style.height="".concat(M.offsetHeight,"px"),q.style.width="".concat(M.offsetWidth,"px"),M.style.left="0",M.style.top="0",M.style.right="auto",M.style.bottom="auto",M.style.overflow="hidden";var K;if(Array.isArray(t))K={x:t[0],y:t[1],width:0,height:0};else{var O,j,ne=t.getBoundingClientRect();ne.x=(O=ne.x)!==null&&O!==void 0?O:ne.left,ne.y=(j=ne.y)!==null&&j!==void 0?j:ne.top,K={x:ne.x,y:ne.y,width:ne.width,height:ne.height}}var k=M.getBoundingClientRect();k.x=(R=k.x)!==null&&R!==void 0?R:k.left,k.y=(Z=k.y)!==null&&Z!==void 0?Z:k.top;var ie=E.documentElement,re=ie.clientWidth,ge=ie.clientHeight,de=ie.scrollWidth,xe=ie.scrollHeight,Ne=ie.scrollTop,ye=ie.scrollLeft,pe=k.height,Te=k.width,le=K.height,Ye=K.width,he={left:0,top:0,right:re,bottom:ge},Ge={left:-ye,top:-Ne,right:de-ye,bottom:xe-Ne},be=U.htmlRegion,Ee="visible",Se="visibleFirst";be!=="scroll"&&be!==Se&&(be=Ee);var ee=be===Se,Q=a3(Ge,h),ce=a3(he,h),me=be===Ee?ce:Q,Ze=ee?ce:me;M.style.left="auto",M.style.top="auto",M.style.right="0",M.style.bottom="0";var Xe=M.getBoundingClientRect();M.style.left=D,M.style.top=P,M.style.right=$,M.style.bottom=X,M.style.overflow=L,(x=M.parentElement)===null||x===void 0||x.removeChild(q);var De=Up(Math.round(Te/parseFloat(H)*1e3)/1e3),Oe=Up(Math.round(pe/parseFloat(z)*1e3)/1e3);if(De===0||Oe===0||Fp(t)&&!pM(t))return;var Je=U.offset,At=U.targetOffset,qe=r3(k,Je),lt=rt(qe,2),$e=lt[0],je=lt[1],ke=r3(K,At),Ce=rt(ke,2),He=Ce[0],ht=Ce[1];K.x-=He,K.y-=ht;var we=U.points||[],ze=rt(we,2),Qe=ze[0],ut=ze[1],Rt=s3(ut),mt=s3(Qe),_t=Jh(K,Rt),Lt=Jh(k,mt),Zt=Ke({},U),yt=_t.x-Lt.x+$e,Ht=_t.y-Lt.y+je,jt=Ki(yt,Ht),Ut=Ki(yt,Ht,ce),Nt=Jh(K,["t","l"]),Tt=Jh(k,["t","l"]),Pt=Jh(K,["b","r"]),qt=Jh(k,["b","r"]),kt=U.overflow||{},Ft=kt.adjustX,fn=kt.adjustY,sn=kt.shiftX,ae=kt.shiftY,ue=function(Ea){return typeof Ea=="boolean"?Ea:Ea>=0},Fe,ot,at,It;Ua();var Wt=ue(fn),xt=mt[0]===Rt[0];if(Wt&&mt[0]==="t"&&(ot>Ze.bottom||m.current.bt)){var te=Ht;xt?te-=pe-le:te=Nt.y-qt.y-je;var Ie=Ki(yt,te),Ae=Ki(yt,te,ce);Ie>jt||Ie===jt&&(!ee||Ae>=Ut)?(m.current.bt=!0,Ht=te,je=-je,Zt.points=[cd(mt,0),cd(Rt,0)]):m.current.bt=!1}if(Wt&&mt[0]==="b"&&(Fe<Ze.top||m.current.tb)){var se=Ht;xt?se+=pe-le:se=Pt.y-Tt.y-je;var Re=Ki(yt,se),Ue=Ki(yt,se,ce);Re>jt||Re===jt&&(!ee||Ue>=Ut)?(m.current.tb=!0,Ht=se,je=-je,Zt.points=[cd(mt,0),cd(Rt,0)]):m.current.tb=!1}var nt=ue(Ft),pt=mt[1]===Rt[1];if(nt&&mt[1]==="l"&&(It>Ze.right||m.current.rl)){var it=yt;pt?it-=Te-Ye:it=Nt.x-qt.x-$e;var Bt=Ki(it,Ht),Mt=Ki(it,Ht,ce);Bt>jt||Bt===jt&&(!ee||Mt>=Ut)?(m.current.rl=!0,yt=it,$e=-$e,Zt.points=[cd(mt,1),cd(Rt,1)]):m.current.rl=!1}if(nt&&mt[1]==="r"&&(at<Ze.left||m.current.lr)){var Yt=yt;pt?Yt+=Te-Ye:Yt=Pt.x-Tt.x-$e;var ln=Ki(Yt,Ht),on=Ki(Yt,Ht,ce);ln>jt||ln===jt&&(!ee||on>=Ut)?(m.current.lr=!0,yt=Yt,$e=-$e,Zt.points=[cd(mt,1),cd(Rt,1)]):m.current.lr=!1}Ua();var vn=sn===!0?0:sn;typeof vn=="number"&&(at<ce.left&&(yt-=at-ce.left-$e,K.x+Ye<ce.left+vn&&(yt+=K.x-ce.left+Ye-vn)),It>ce.right&&(yt-=It-ce.right-$e,K.x>ce.right-vn&&(yt+=K.x-ce.right+vn)));var nn=ae===!0?0:ae;typeof nn=="number"&&(Fe<ce.top&&(Ht-=Fe-ce.top-je,K.y+le<ce.top+nn&&(Ht+=K.y-ce.top+le-nn)),ot>ce.bottom&&(Ht-=ot-ce.bottom-je,K.y>ce.bottom-nn&&(Ht+=K.y-ce.bottom+nn)));var mn=k.x+yt,gn=mn+Te,Xn=k.y+Ht,bn=Xn+pe,cn=K.x,Jt=cn+Ye,Et=K.y,rn=Et+le,Cn=Math.max(mn,cn),Gn=Math.min(gn,Jt),pn=(Cn+Gn)/2,Kn=pn-mn,Qn=Math.max(Xn,Et),li=Math.min(bn,rn),Zi=(Qn+li)/2,aa=Zi-Xn;r==null||r(e,Zt);var pa=Xe.right-k.x-(yt+k.width),oa=Xe.bottom-k.y-(Ht+k.height);De===1&&(yt=Math.round(yt),pa=Math.round(pa)),Oe===1&&(Ht=Math.round(Ht),oa=Math.round(oa));var mr={ready:!0,offsetX:yt/De,offsetY:Ht/Oe,offsetR:pa/De,offsetB:oa/Oe,arrowX:Kn/De,arrowY:aa/Oe,scaleX:De,scaleY:Oe,align:Zt};u(mr)}}),b=function(){C.current+=1;var R=C.current;Promise.resolve().then(function(){C.current===R&&B()})},y=function(){u(function(R){return Ke(Ke({},R),{},{ready:!1})})};return xi(y,[i]),xi(function(){n||y()},[n]),[c.ready,c.offsetX,c.offsetY,c.offsetR,c.offsetB,c.arrowX,c.arrowY,c.scaleX,c.scaleY,c.align,b]}function rce(n,e,t,i,a){xi(function(){if(n&&e&&t){let h=function(){i(),a()};var C=h,o=e,r=t,s=cZ(o),l=cZ(r),c=wb(r),u=new Set([c].concat(an(s),an(l)));return u.forEach(function(m){m.addEventListener("scroll",h,{passive:!0})}),c.addEventListener("resize",h,{passive:!0}),i(),function(){u.forEach(function(m){m.removeEventListener("scroll",h),c.removeEventListener("resize",h)})}}},[n,e,t])}function sce(n,e,t,i,a,o,r,s){var l=v.useRef(n);l.current=n;var c=v.useRef(!1);v.useEffect(function(){if(e&&i&&(!a||o)){var C=function(){c.current=!1},h=function(b){var y;l.current&&!r(((y=b.composedPath)===null||y===void 0||(y=y.call(b))===null||y===void 0?void 0:y[0])||b.target)&&!c.current&&s(!1)},m=wb(i);m.addEventListener("pointerdown",C,!0),m.addEventListener("mousedown",h,!0),m.addEventListener("contextmenu",h,!0);var p=OB(t);return p&&(p.addEventListener("mousedown",h,!0),p.addEventListener("contextmenu",h,!0)),function(){m.removeEventListener("pointerdown",C,!0),m.removeEventListener("mousedown",h,!0),m.removeEventListener("contextmenu",h,!0),p&&(p.removeEventListener("mousedown",h,!0),p.removeEventListener("contextmenu",h,!0))}}},[e,t,i,a,o]);function u(){c.current=!0}return u}var lce=["prefixCls","children","action","showAction","hideAction","popupVisible","defaultPopupVisible","onPopupVisibleChange","afterPopupVisibleChange","mouseEnterDelay","mouseLeaveDelay","focusDelay","blurDelay","mask","maskClosable","getPopupContainer","forceRender","autoDestroy","destroyPopupOnHide","popup","popupClassName","popupStyle","popupPlacement","builtinPlacements","popupAlign","zIndex","stretch","getPopupClassNameFromAlign","fresh","alignPoint","onPopupClick","onPopupAlign","arrow","popupMotion","maskMotion","popupTransitionName","popupAnimation","maskTransitionName","maskAnimation","className","getTriggerDOMNode"];function cce(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:fz,e=v.forwardRef(function(t,i){var a=t.prefixCls,o=a===void 0?"rc-trigger-popup":a,r=t.children,s=t.action,l=s===void 0?"hover":s,c=t.showAction,u=t.hideAction,C=t.popupVisible,h=t.defaultPopupVisible,m=t.onPopupVisibleChange,p=t.afterPopupVisibleChange,B=t.mouseEnterDelay,b=t.mouseLeaveDelay,y=b===void 0?.1:b,S=t.focusDelay,R=t.blurDelay,Z=t.mask,x=t.maskClosable,M=x===void 0?!0:x,E=t.getPopupContainer,F=t.forceRender,N=t.autoDestroy,H=t.destroyPopupOnHide,z=t.popup,_=t.popupClassName,D=t.popupStyle,P=t.popupPlacement,$=t.builtinPlacements,X=$===void 0?{}:$,L=t.popupAlign,U=t.zIndex,q=t.stretch,K=t.getPopupClassNameFromAlign,O=t.fresh,j=t.alignPoint,ne=t.onPopupClick,k=t.onPopupAlign,ie=t.arrow,re=t.popupMotion,ge=t.maskMotion,de=t.popupTransitionName,xe=t.popupAnimation,Ne=t.maskTransitionName,ye=t.maskAnimation,pe=t.className,Te=t.getTriggerDOMNode,le=_n(t,lce),Ye=N||H||!1,he=v.useState(!1),Ge=rt(he,2),be=Ge[0],Ee=Ge[1];xi(function(){Ee(wM())},[]);var Se=v.useRef({}),ee=v.useContext(t3),Q=v.useMemo(function(){return{registerSubPopup:function(wn,hi){Se.current[wn]=hi,ee==null||ee.registerSubPopup(wn,hi)}}},[ee]),ce=GM(),me=v.useState(null),Ze=rt(me,2),Xe=Ze[0],De=Ze[1],Oe=v.useRef(null),Je=Aa(function(un){Oe.current=un,Fp(un)&&Xe!==un&&De(un),ee==null||ee.registerSubPopup(ce,un)}),At=v.useState(null),qe=rt(At,2),lt=qe[0],$e=qe[1],je=v.useRef(null),ke=Aa(function(un){Fp(un)&&lt!==un&&($e(un),je.current=un)}),Ce=v.Children.only(r),He=(Ce==null?void 0:Ce.props)||{},ht={},we=Aa(function(un){var wn,hi,Dn=lt;return(Dn==null?void 0:Dn.contains(un))||((wn=OB(Dn))===null||wn===void 0?void 0:wn.host)===un||un===Dn||(Xe==null?void 0:Xe.contains(un))||((hi=OB(Xe))===null||hi===void 0?void 0:hi.host)===un||un===Xe||Object.values(Se.current).some(function(Gi){return(Gi==null?void 0:Gi.contains(un))||un===Gi})}),ze=i3(o,re,xe,de),Qe=i3(o,ge,ye,Ne),ut=v.useState(h||!1),Rt=rt(ut,2),mt=Rt[0],_t=Rt[1],Lt=C??mt,Zt=Aa(function(un){C===void 0&&_t(un)});xi(function(){_t(C||!1)},[C]);var yt=v.useRef(Lt);yt.current=Lt;var Ht=v.useRef([]);Ht.current=[];var jt=Aa(function(un){var wn;Zt(un),((wn=Ht.current[Ht.current.length-1])!==null&&wn!==void 0?wn:Lt)!==un&&(Ht.current.push(un),m==null||m(un))}),Ut=v.useRef(),Nt=function(){clearTimeout(Ut.current)},Tt=function(wn){var hi=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;Nt(),hi===0?jt(wn):Ut.current=setTimeout(function(){jt(wn)},hi*1e3)};v.useEffect(function(){return Nt},[]);var Pt=v.useState(!1),qt=rt(Pt,2),kt=qt[0],Ft=qt[1];xi(function(un){(!un||Lt)&&Ft(!0)},[Lt]);var fn=v.useState(null),sn=rt(fn,2),ae=sn[0],ue=sn[1],Fe=v.useState(null),ot=rt(Fe,2),at=ot[0],It=ot[1],Wt=function(wn){It([wn.clientX,wn.clientY])},xt=oce(Lt,Xe,j&&at!==null?at:lt,P,X,L,k),te=rt(xt,11),Ie=te[0],Ae=te[1],se=te[2],Re=te[3],Ue=te[4],nt=te[5],pt=te[6],it=te[7],Bt=te[8],Mt=te[9],Yt=te[10],ln=nce(be,l,c,u),on=rt(ln,2),vn=on[0],nn=on[1],mn=vn.has("click"),gn=nn.has("click")||nn.has("contextMenu"),Xn=Aa(function(){kt||Yt()}),bn=function(){yt.current&&j&&gn&&Tt(!1)};rce(Lt,lt,Xe,Xn,bn),xi(function(){Xn()},[at,P]),xi(function(){Lt&&!(X!=null&&X[P])&&Xn()},[JSON.stringify(L)]);var cn=v.useMemo(function(){var un=ace(X,o,Mt,j);return gt(un,K==null?void 0:K(Mt))},[Mt,K,X,o,j]);v.useImperativeHandle(i,function(){return{nativeElement:je.current,popupElement:Oe.current,forceAlign:Xn}});var Jt=v.useState(0),Et=rt(Jt,2),rn=Et[0],Cn=Et[1],Gn=v.useState(0),pn=rt(Gn,2),Kn=pn[0],Qn=pn[1],li=function(){if(q&&lt){var wn=lt.getBoundingClientRect();Cn(wn.width),Qn(wn.height)}},Zi=function(){li(),Xn()},aa=function(wn){Ft(!1),Yt(),p==null||p(wn)},pa=function(){return new Promise(function(wn){li(),ue(function(){return wn})})};xi(function(){ae&&(Yt(),ae(),ue(null))},[ae]);function oa(un,wn,hi,Dn){ht[un]=function(Gi){var jr;Dn==null||Dn(Gi),Tt(wn,hi);for(var Js=arguments.length,Eo=new Array(Js>1?Js-1:0),Qo=1;Qo<Js;Qo++)Eo[Qo-1]=arguments[Qo];(jr=He[un])===null||jr===void 0||jr.call.apply(jr,[He,Gi].concat(Eo))}}(mn||gn)&&(ht.onClick=function(un){var wn;yt.current&&gn?Tt(!1):!yt.current&&mn&&(Wt(un),Tt(!0));for(var hi=arguments.length,Dn=new Array(hi>1?hi-1:0),Gi=1;Gi<hi;Gi++)Dn[Gi-1]=arguments[Gi];(wn=He.onClick)===null||wn===void 0||wn.call.apply(wn,[He,un].concat(Dn))});var mr=sce(Lt,gn,lt,Xe,Z,M,we,Tt),bc=vn.has("hover"),pr=nn.has("hover"),Ki,Ua;bc&&(oa("onMouseEnter",!0,B,function(un){Wt(un)}),oa("onPointerEnter",!0,B,function(un){Wt(un)}),Ki=function(wn){(Lt||kt)&&Xe!==null&&Xe!==void 0&&Xe.contains(wn.target)&&Tt(!0,B)},j&&(ht.onMouseMove=function(un){var wn;(wn=He.onMouseMove)===null||wn===void 0||wn.call(He,un)})),pr&&(oa("onMouseLeave",!1,y),oa("onPointerLeave",!1,y),Ua=function(){Tt(!1,y)}),vn.has("focus")&&oa("onFocus",!0,S),nn.has("focus")&&oa("onBlur",!1,R),vn.has("contextMenu")&&(ht.onContextMenu=function(un){var wn;yt.current&&nn.has("contextMenu")?Tt(!1):(Wt(un),Tt(!0)),un.preventDefault();for(var hi=arguments.length,Dn=new Array(hi>1?hi-1:0),Gi=1;Gi<hi;Gi++)Dn[Gi-1]=arguments[Gi];(wn=He.onContextMenu)===null||wn===void 0||wn.call.apply(wn,[He,un].concat(Dn))}),pe&&(ht.className=gt(He.className,pe));var ba=Ke(Ke({},He),ht),Ea={},po=["onContextMenu","onClick","onMouseDown","onTouchStart","onMouseEnter","onMouseLeave","onFocus","onBlur"];po.forEach(function(un){le[un]&&(Ea[un]=function(){for(var wn,hi=arguments.length,Dn=new Array(hi),Gi=0;Gi<hi;Gi++)Dn[Gi]=arguments[Gi];(wn=ba[un])===null||wn===void 0||wn.call.apply(wn,[ba].concat(Dn)),le[un].apply(le,Dn)})});var jo=v.cloneElement(Ce,Ke(Ke({},ba),Ea)),Jr={x:nt,y:pt},br=ie?Ke({},ie!==!0?ie:{}):null;return v.createElement(v.Fragment,null,v.createElement(vl,{disabled:!Lt,ref:ke,onResize:Zi},v.createElement(tce,{getTriggerDOMNode:Te},jo)),v.createElement(t3.Provider,{value:Q},v.createElement(ece,{portal:n,ref:Je,prefixCls:o,popup:z,className:gt(_,cn),style:D,target:lt,onMouseEnter:Ki,onMouseLeave:Ua,onPointerEnter:Ki,zIndex:U,open:Lt,keepDom:kt,fresh:O,onClick:ne,onPointerDownCapture:mr,mask:Z,motion:ze,maskMotion:Qe,onVisibleChanged:aa,onPrepare:pa,forceRender:F,autoDestroy:Ye,getPopupContainer:E,align:Mt,arrow:br,arrowPos:Jr,ready:Ie,offsetX:Ae,offsetY:se,offsetR:Re,offsetB:Ue,onAlign:Xn,stretch:q,targetWidth:rn/it,targetHeight:Kn/Bt})))});return e}const IS=cce(fz);var gce=["prefixCls","disabled","visible","children","popupElement","animation","transitionName","dropdownStyle","dropdownClassName","direction","placement","builtinPlacements","dropdownMatchSelectWidth","dropdownRender","dropdownAlign","getPopupContainer","empty","getTriggerDOMNode","onPopupVisibleChange","onPopupMouseEnter"],uce=function(e){var t=e===!0?0:1;return{bottomLeft:{points:["tl","bl"],offset:[0,4],overflow:{adjustX:t,adjustY:1},htmlRegion:"scroll"},bottomRight:{points:["tr","br"],offset:[0,4],overflow:{adjustX:t,adjustY:1},htmlRegion:"scroll"},topLeft:{points:["bl","tl"],offset:[0,-4],overflow:{adjustX:t,adjustY:1},htmlRegion:"scroll"},topRight:{points:["br","tr"],offset:[0,-4],overflow:{adjustX:t,adjustY:1},htmlRegion:"scroll"}}},dce=function(e,t){var i=e.prefixCls;e.disabled;var a=e.visible,o=e.children,r=e.popupElement,s=e.animation,l=e.transitionName,c=e.dropdownStyle,u=e.dropdownClassName,C=e.direction,h=C===void 0?"ltr":C,m=e.placement,p=e.builtinPlacements,B=e.dropdownMatchSelectWidth,b=e.dropdownRender,y=e.dropdownAlign,S=e.getPopupContainer,R=e.empty,Z=e.getTriggerDOMNode,x=e.onPopupVisibleChange,M=e.onPopupMouseEnter,E=_n(e,gce),F="".concat(i,"-dropdown"),N=r;b&&(N=b(r));var H=v.useMemo(function(){return p||uce(B)},[p,B]),z=s?"".concat(F,"-").concat(s):l,_=typeof B=="number",D=v.useMemo(function(){return _?null:B===!1?"minWidth":"width"},[B,_]),P=c;_&&(P=Ke(Ke({},P),{},{width:B}));var $=v.useRef(null);return v.useImperativeHandle(t,function(){return{getPopupElement:function(){var L;return(L=$.current)===null||L===void 0?void 0:L.popupElement}}}),v.createElement(IS,$t({},E,{showAction:x?["click"]:[],hideAction:x?["click"]:[],popupPlacement:m||(h==="rtl"?"bottomRight":"bottomLeft"),builtinPlacements:H,prefixCls:F,popupTransitionName:z,popup:v.createElement("div",{onMouseEnter:M},N),ref:$,stretch:D,popupAlign:y,popupVisible:a,getPopupContainer:S,popupClassName:gt(u,Ve({},"".concat(F,"-empty"),R)),popupStyle:P,getTriggerDOMNode:Z,onPopupVisibleChange:x}),o)},Cce=v.forwardRef(dce);function l3(n,e){var t=n.key,i;return"value"in n&&(i=n.value),t??(i!==void 0?i:"rc-index-key-".concat(e))}function gZ(n){return typeof n<"u"&&!Number.isNaN(n)}function Wz(n,e){var t=n||{},i=t.label,a=t.value,o=t.options,r=t.groupLabel,s=i||(e?"children":"label");return{label:s,value:a||"value",options:o||"options",groupLabel:r||s}}function Ice(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=e.fieldNames,i=e.childrenAsData,a=[],o=Wz(t,!1),r=o.label,s=o.value,l=o.options,c=o.groupLabel;function u(C,h){Array.isArray(C)&&C.forEach(function(m){if(h||!(l in m)){var p=m[s];a.push({key:l3(m,a.length),groupOption:h,data:m,label:m[r],value:p})}else{var B=m[c];B===void 0&&i&&(B=m.label),a.push({key:l3(m,a.length),group:!0,data:m,label:B}),u(m[l],!0)}})}return u(n,!1),a}function uZ(n){var e=Ke({},n);return"props"in e||Object.defineProperty(e,"props",{get:function(){return No(!1,"Return type is option instead of Option instance. Please read value directly instead of reading from `props`."),e}}),e}var hce=function(e,t,i){if(!t||!t.length)return null;var a=!1,o=function s(l,c){var u=AY(c),C=u[0],h=u.slice(1);if(!C)return[l];var m=l.split(C);return a=a||m.length>1,m.reduce(function(p,B){return[].concat(an(p),an(s(B,h)))},[]).filter(Boolean)},r=o(e,t);return a?typeof i<"u"?r.slice(0,i):r:null},RM=v.createContext(null);function fce(n){var e=n.visible,t=n.values;if(!e)return null;var i=50;return v.createElement("span",{"aria-live":"polite",style:{width:0,height:0,position:"absolute",overflow:"hidden",opacity:0}},"".concat(t.slice(0,i).map(function(a){var o=a.label,r=a.value;return["number","string"].includes(Bn(o))?o:r}).join(", ")),t.length>i?", ...":null)}var Ace=["id","prefixCls","className","showSearch","tagRender","direction","omitDomProps","displayValues","onDisplayValuesChange","emptyOptions","notFoundContent","onClear","mode","disabled","loading","getInputElement","getRawInputElement","open","defaultOpen","onDropdownVisibleChange","activeValue","onActiveValueChange","activeDescendantId","searchValue","autoClearSearchValue","onSearch","onSearchSplit","tokenSeparators","allowClear","prefix","suffixIcon","clearIcon","OptionList","animation","transitionName","dropdownStyle","dropdownClassName","dropdownMatchSelectWidth","dropdownRender","dropdownAlign","placement","builtinPlacements","getPopupContainer","showAction","onFocus","onBlur","onKeyUp","onKeyDown","onMouseDown"],mce=["value","onChange","removeIcon","placeholder","autoFocus","maxTagCount","maxTagTextLength","maxTagPlaceholder","choiceTransitionName","onInputKeyDown","onPopupScroll","tabIndex"],dZ=function(e){return e==="tags"||e==="multiple"},pce=v.forwardRef(function(n,e){var t,i=n.id,a=n.prefixCls,o=n.className,r=n.showSearch,s=n.tagRender,l=n.direction,c=n.omitDomProps,u=n.displayValues,C=n.onDisplayValuesChange,h=n.emptyOptions,m=n.notFoundContent,p=m===void 0?"Not Found":m,B=n.onClear,b=n.mode,y=n.disabled,S=n.loading,R=n.getInputElement,Z=n.getRawInputElement,x=n.open,M=n.defaultOpen,E=n.onDropdownVisibleChange,F=n.activeValue,N=n.onActiveValueChange,H=n.activeDescendantId,z=n.searchValue,_=n.autoClearSearchValue,D=n.onSearch,P=n.onSearchSplit,$=n.tokenSeparators,X=n.allowClear,L=n.prefix,U=n.suffixIcon,q=n.clearIcon,K=n.OptionList,O=n.animation,j=n.transitionName,ne=n.dropdownStyle,k=n.dropdownClassName,ie=n.dropdownMatchSelectWidth,re=n.dropdownRender,ge=n.dropdownAlign,de=n.placement,xe=n.builtinPlacements,Ne=n.getPopupContainer,ye=n.showAction,pe=ye===void 0?[]:ye,Te=n.onFocus,le=n.onBlur,Ye=n.onKeyUp,he=n.onKeyDown,Ge=n.onMouseDown,be=_n(n,Ace),Ee=dZ(b),Se=(r!==void 0?r:Ee)||b==="combobox",ee=Ke({},be);mce.forEach(function(Jt){delete ee[Jt]}),c==null||c.forEach(function(Jt){delete ee[Jt]});var Q=v.useState(!1),ce=rt(Q,2),me=ce[0],Ze=ce[1];v.useEffect(function(){Ze(wM())},[]);var Xe=v.useRef(null),De=v.useRef(null),Oe=v.useRef(null),Je=v.useRef(null),At=v.useRef(null),qe=v.useRef(!1),lt=wle(),$e=rt(lt,3),je=$e[0],ke=$e[1],Ce=$e[2];v.useImperativeHandle(e,function(){var Jt,Et;return{focus:(Jt=Je.current)===null||Jt===void 0?void 0:Jt.focus,blur:(Et=Je.current)===null||Et===void 0?void 0:Et.blur,scrollTo:function(Cn){var Gn;return(Gn=At.current)===null||Gn===void 0?void 0:Gn.scrollTo(Cn)},nativeElement:Xe.current||De.current}});var He=v.useMemo(function(){var Jt;if(b!=="combobox")return z;var Et=(Jt=u[0])===null||Jt===void 0?void 0:Jt.value;return typeof Et=="string"||typeof Et=="number"?String(Et):""},[z,b,u]),ht=b==="combobox"&&typeof R=="function"&&R()||null,we=typeof Z=="function"&&Z(),ze=yI(De,we==null||(t=we.props)===null||t===void 0?void 0:t.ref),Qe=v.useState(!1),ut=rt(Qe,2),Rt=ut[0],mt=ut[1];xi(function(){mt(!0)},[]);var _t=_a(!1,{defaultValue:M,value:x}),Lt=rt(_t,2),Zt=Lt[0],yt=Lt[1],Ht=Rt?Zt:!1,jt=!p&&h;(y||jt&&Ht&&b==="combobox")&&(Ht=!1);var Ut=jt?!1:Ht,Nt=v.useCallback(function(Jt){var Et=Jt!==void 0?Jt:!Ht;y||(yt(Et),Ht!==Et&&(E==null||E(Et)))},[y,Ht,yt,E]),Tt=v.useMemo(function(){return($||[]).some(function(Jt){return[`
`,`\r
`].includes(Jt)})},[$]),Pt=v.useContext(RM)||{},qt=Pt.maxCount,kt=Pt.rawValues,Ft=function(Et,rn,Cn){if(!(Ee&&gZ(qt)&&(kt==null?void 0:kt.size)>=qt)){var Gn=!0,pn=Et;N==null||N(null);var Kn=hce(Et,$,gZ(qt)?qt-kt.size:void 0),Qn=Cn?null:Kn;return b!=="combobox"&&Qn&&(pn="",P==null||P(Qn),Nt(!1),Gn=!1),D&&He!==pn&&D(pn,{source:rn?"typing":"effect"}),Gn}},fn=function(Et){!Et||!Et.trim()||D(Et,{source:"submit"})};v.useEffect(function(){!Ht&&!Ee&&b!=="combobox"&&Ft("",!1,!1)},[Ht]),v.useEffect(function(){Zt&&y&&yt(!1),y&&!qe.current&&ke(!1)},[y]);var sn=Gz(),ae=rt(sn,2),ue=ae[0],Fe=ae[1],ot=v.useRef(!1),at=function(Et){var rn=ue(),Cn=Et.key,Gn=Cn==="Enter";if(Gn&&(b!=="combobox"&&Et.preventDefault(),Ht||Nt(!0)),Fe(!!He),Cn==="Backspace"&&!rn&&Ee&&!He&&u.length){for(var pn=an(u),Kn=null,Qn=pn.length-1;Qn>=0;Qn-=1){var li=pn[Qn];if(!li.disabled){pn.splice(Qn,1),Kn=li;break}}Kn&&C(pn,{type:"remove",values:[Kn]})}for(var Zi=arguments.length,aa=new Array(Zi>1?Zi-1:0),pa=1;pa<Zi;pa++)aa[pa-1]=arguments[pa];if(Ht&&(!Gn||!ot.current)){var oa;Gn&&(ot.current=!0),(oa=At.current)===null||oa===void 0||oa.onKeyDown.apply(oa,[Et].concat(aa))}he==null||he.apply(void 0,[Et].concat(aa))},It=function(Et){for(var rn=arguments.length,Cn=new Array(rn>1?rn-1:0),Gn=1;Gn<rn;Gn++)Cn[Gn-1]=arguments[Gn];if(Ht){var pn;(pn=At.current)===null||pn===void 0||pn.onKeyUp.apply(pn,[Et].concat(Cn))}Et.key==="Enter"&&(ot.current=!1),Ye==null||Ye.apply(void 0,[Et].concat(Cn))},Wt=function(Et){var rn=u.filter(function(Cn){return Cn!==Et});C(rn,{type:"remove",values:[Et]})},xt=function(){ot.current=!1},te=v.useRef(!1),Ie=function(){ke(!0),y||(Te&&!te.current&&Te.apply(void 0,arguments),pe.includes("focus")&&Nt(!0)),te.current=!0},Ae=function(){qe.current=!0,ke(!1,function(){te.current=!1,qe.current=!1,Nt(!1)}),!y&&(He&&(b==="tags"?D(He,{source:"submit"}):b==="multiple"&&D("",{source:"blur"})),le&&le.apply(void 0,arguments))},se=[];v.useEffect(function(){return function(){se.forEach(function(Jt){return clearTimeout(Jt)}),se.splice(0,se.length)}},[]);var Re=function(Et){var rn,Cn=Et.target,Gn=(rn=Oe.current)===null||rn===void 0?void 0:rn.getPopupElement();if(Gn&&Gn.contains(Cn)){var pn=setTimeout(function(){var Zi=se.indexOf(pn);if(Zi!==-1&&se.splice(Zi,1),Ce(),!me&&!Gn.contains(document.activeElement)){var aa;(aa=Je.current)===null||aa===void 0||aa.focus()}});se.push(pn)}for(var Kn=arguments.length,Qn=new Array(Kn>1?Kn-1:0),li=1;li<Kn;li++)Qn[li-1]=arguments[li];Ge==null||Ge.apply(void 0,[Et].concat(Qn))},Ue=v.useState({}),nt=rt(Ue,2),pt=nt[1];function it(){pt({})}var Bt;we&&(Bt=function(Et){Nt(Et)}),Rle(function(){var Jt;return[Xe.current,(Jt=Oe.current)===null||Jt===void 0?void 0:Jt.getPopupElement()]},Ut,Nt,!!we);var Mt=v.useMemo(function(){return Ke(Ke({},n),{},{notFoundContent:p,open:Ht,triggerOpen:Ut,id:i,showSearch:Se,multiple:Ee,toggleOpen:Nt})},[n,p,Ut,Ht,i,Se,Ee,Nt]),Yt=!!U||S,ln;Yt&&(ln=v.createElement(CS,{className:gt("".concat(a,"-arrow"),Ve({},"".concat(a,"-arrow-loading"),S)),customizeIcon:U,customizeIconProps:{loading:S,searchValue:He,open:Ht,focused:je,showSearch:Se}}));var on=function(){var Et;B==null||B(),(Et=Je.current)===null||Et===void 0||Et.focus(),C([],{type:"clear",values:u}),Ft("",!1,!1)},vn=Gle(a,on,u,X,q,y,He,b),nn=vn.allowClear,mn=vn.clearIcon,gn=v.createElement(K,{ref:At}),Xn=gt(a,o,Ve(Ve(Ve(Ve(Ve(Ve(Ve(Ve(Ve(Ve({},"".concat(a,"-focused"),je),"".concat(a,"-multiple"),Ee),"".concat(a,"-single"),!Ee),"".concat(a,"-allow-clear"),X),"".concat(a,"-show-arrow"),Yt),"".concat(a,"-disabled"),y),"".concat(a,"-loading"),S),"".concat(a,"-open"),Ht),"".concat(a,"-customize-input"),ht),"".concat(a,"-show-search"),Se)),bn=v.createElement(Cce,{ref:Oe,disabled:y,prefixCls:a,visible:Ut,popupElement:gn,animation:O,transitionName:j,dropdownStyle:ne,dropdownClassName:k,direction:l,dropdownMatchSelectWidth:ie,dropdownRender:re,dropdownAlign:ge,placement:de,builtinPlacements:xe,getPopupContainer:Ne,empty:h,getTriggerDOMNode:function(Et){return De.current||Et},onPopupVisibleChange:Bt,onPopupMouseEnter:it},we?v.cloneElement(we,{ref:ze}):v.createElement(jle,$t({},n,{domRef:De,prefixCls:a,inputElement:ht,ref:Je,id:i,prefix:L,showSearch:Se,autoClearSearchValue:_,mode:b,activeDescendantId:H,tagRender:s,values:u,open:Ht,onToggleOpen:Nt,activeValue:F,searchValue:He,onSearch:Ft,onSearchSubmit:fn,onRemove:Wt,tokenWithEnter:Tt,onInputBlur:xt}))),cn;return we?cn=bn:cn=v.createElement("div",$t({className:Xn},ee,{ref:Xe,onMouseDown:Re,onKeyDown:at,onKeyUp:It,onFocus:Ie,onBlur:Ae}),v.createElement(fce,{visible:je&&!Ht,values:u}),bn,ln,nn&&mn),v.createElement(Bz.Provider,{value:Mt},cn)}),ZM=function(){return null};ZM.isSelectOptGroup=!0;var xM=function(){return null};xM.isSelectOption=!0;var Vz=v.forwardRef(function(n,e){var t=n.height,i=n.offsetY,a=n.offsetX,o=n.children,r=n.prefixCls,s=n.onInnerResize,l=n.innerProps,c=n.rtl,u=n.extra,C={},h={display:"flex",flexDirection:"column"};return i!==void 0&&(C={height:t,position:"relative",overflow:"hidden"},h=Ke(Ke({},h),{},Ve(Ve(Ve(Ve(Ve({transform:"translateY(".concat(i,"px)")},c?"marginRight":"marginLeft",-a),"position","absolute"),"left",0),"right",0),"top",0))),v.createElement("div",{style:C},v.createElement(vl,{onResize:function(p){var B=p.offsetHeight;B&&s&&s()}},v.createElement("div",$t({style:h,className:gt(Ve({},"".concat(r,"-holder-inner"),r)),ref:e},l),o,u)))});Vz.displayName="Filler";function bce(n){var e=n.children,t=n.setRef,i=v.useCallback(function(a){t(a)},[]);return v.cloneElement(e,{ref:i})}function vce(n,e,t,i,a,o,r,s){var l=s.getKey;return n.slice(e,t+1).map(function(c,u){var C=e+u,h=r(c,C,{style:{width:i},offsetX:a}),m=l(c);return v.createElement(bce,{key:m,setRef:function(B){return o(c,B)}},h)})}function yce(n,e,t){var i=n.length,a=e.length,o,r;if(i===0&&a===0)return null;i<a?(o=n,r=e):(o=e,r=n);var s={__EMPTY_ITEM__:!0};function l(p){return p!==void 0?t(p):s}for(var c=null,u=Math.abs(i-a)!==1,C=0;C<r.length;C+=1){var h=l(o[C]),m=l(r[C]);if(h!==m){c=C,u=u||h!==l(r[C+1]);break}}return c===null?null:{index:c,multiple:u}}function Bce(n,e,t){var i=v.useState(n),a=rt(i,2),o=a[0],r=a[1],s=v.useState(null),l=rt(s,2),c=l[0],u=l[1];return v.useEffect(function(){var C=yce(o||[],n||[],e);(C==null?void 0:C.index)!==void 0&&u(n[C.index]),r(n)},[n]),[c]}var c3=(typeof navigator>"u"?"undefined":Bn(navigator))==="object"&&/Firefox/i.test(navigator.userAgent);const Nz=function(n,e,t,i){var a=v.useRef(!1),o=v.useRef(null);function r(){clearTimeout(o.current),a.current=!0,o.current=setTimeout(function(){a.current=!1},50)}var s=v.useRef({top:n,bottom:e,left:t,right:i});return s.current.top=n,s.current.bottom=e,s.current.left=t,s.current.right=i,function(l,c){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,C=l?c<0&&s.current.left||c>0&&s.current.right:c<0&&s.current.top||c>0&&s.current.bottom;return u&&C?(clearTimeout(o.current),a.current=!1):(!C||a.current)&&r(),!a.current&&C}};function Gce(n,e,t,i,a,o,r){var s=v.useRef(0),l=v.useRef(null),c=v.useRef(null),u=v.useRef(!1),C=Nz(e,t,i,a);function h(S,R){if(mi.cancel(l.current),!C(!1,R)){var Z=S;if(!Z._virtualHandled)Z._virtualHandled=!0;else return;s.current+=R,c.current=R,c3||Z.preventDefault(),l.current=mi(function(){var x=u.current?10:1;r(s.current*x,!1),s.current=0})}}function m(S,R){r(R,!0),c3||S.preventDefault()}var p=v.useRef(null),B=v.useRef(null);function b(S){if(n){mi.cancel(B.current),B.current=mi(function(){p.current=null},2);var R=S.deltaX,Z=S.deltaY,x=S.shiftKey,M=R,E=Z;(p.current==="sx"||!p.current&&x&&Z&&!R)&&(M=Z,E=0,p.current="sx");var F=Math.abs(M),N=Math.abs(E);p.current===null&&(p.current=o&&F>N?"x":"y"),p.current==="y"?h(S,E):m(S,M)}}function y(S){n&&(u.current=S.detail===c.current)}return[b,y]}function Sce(n,e,t,i){var a=v.useMemo(function(){return[new Map,[]]},[n,t.id,i]),o=rt(a,2),r=o[0],s=o[1],l=function(u){var C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:u,h=r.get(u),m=r.get(C);if(h===void 0||m===void 0)for(var p=n.length,B=s.length;B<p;B+=1){var b,y=n[B],S=e(y);r.set(S,B);var R=(b=t.get(S))!==null&&b!==void 0?b:i;if(s[B]=(s[B-1]||0)+R,S===u&&(h=B),S===C&&(m=B),h!==void 0&&m!==void 0)break}return{top:s[h-1]||0,bottom:s[m]}};return l}var wce=function(){function n(){to(this,n),Ve(this,"maps",void 0),Ve(this,"id",0),Ve(this,"diffKeys",new Set),this.maps=Object.create(null)}return no(n,[{key:"set",value:function(t,i){this.maps[t]=i,this.id+=1,this.diffKeys.add(t)}},{key:"get",value:function(t){return this.maps[t]}},{key:"resetRecord",value:function(){this.diffKeys.clear()}},{key:"getRecord",value:function(){return this.diffKeys}}]),n}();function g3(n){var e=parseFloat(n);return isNaN(e)?0:e}function Rce(n,e,t){var i=v.useState(0),a=rt(i,2),o=a[0],r=a[1],s=v.useRef(new Map),l=v.useRef(new wce),c=v.useRef(0);function u(){c.current+=1}function C(){var m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;u();var p=function(){var y=!1;s.current.forEach(function(S,R){if(S&&S.offsetParent){var Z=S.offsetHeight,x=getComputedStyle(S),M=x.marginTop,E=x.marginBottom,F=g3(M),N=g3(E),H=Z+F+N;l.current.get(R)!==H&&(l.current.set(R,H),y=!0)}}),y&&r(function(S){return S+1})};if(m)p();else{c.current+=1;var B=c.current;Promise.resolve().then(function(){B===c.current&&p()})}}function h(m,p){var B=n(m);s.current.get(B),p?(s.current.set(B,p),C()):s.current.delete(B)}return v.useEffect(function(){return u},[]),[h,C,l.current,o]}var u3=14/15;function Zce(n,e,t){var i=v.useRef(!1),a=v.useRef(0),o=v.useRef(0),r=v.useRef(null),s=v.useRef(null),l,c=function(m){if(i.current){var p=Math.ceil(m.touches[0].pageX),B=Math.ceil(m.touches[0].pageY),b=a.current-p,y=o.current-B,S=Math.abs(b)>Math.abs(y);S?a.current=p:o.current=B;var R=t(S,S?b:y,!1,m);R&&m.preventDefault(),clearInterval(s.current),R&&(s.current=setInterval(function(){S?b*=u3:y*=u3;var Z=Math.floor(S?b:y);(!t(S,Z,!0)||Math.abs(Z)<=.1)&&clearInterval(s.current)},16))}},u=function(){i.current=!1,l()},C=function(m){l(),m.touches.length===1&&!i.current&&(i.current=!0,a.current=Math.ceil(m.touches[0].pageX),o.current=Math.ceil(m.touches[0].pageY),r.current=m.target,r.current.addEventListener("touchmove",c,{passive:!1}),r.current.addEventListener("touchend",u,{passive:!0}))};l=function(){r.current&&(r.current.removeEventListener("touchmove",c),r.current.removeEventListener("touchend",u))},xi(function(){return n&&e.current.addEventListener("touchstart",C,{passive:!0}),function(){var h;(h=e.current)===null||h===void 0||h.removeEventListener("touchstart",C),l(),clearInterval(s.current)}},[n])}function d3(n){return Math.floor(Math.pow(n,.5))}function CZ(n,e){var t="touches"in n?n.touches[0]:n;return t[e?"pageX":"pageY"]-window[e?"scrollX":"scrollY"]}function xce(n,e,t){v.useEffect(function(){var i=e.current;if(n&&i){var a=!1,o,r,s=function(){mi.cancel(o)},l=function h(){s(),o=mi(function(){t(r),h()})},c=function(m){if(!(m.target.draggable||m.button!==0)){var p=m;p._virtualHandled||(p._virtualHandled=!0,a=!0)}},u=function(){a=!1,s()},C=function(m){if(a){var p=CZ(m,!1),B=i.getBoundingClientRect(),b=B.top,y=B.bottom;if(p<=b){var S=b-p;r=-d3(S),l()}else if(p>=y){var R=p-y;r=d3(R),l()}else s()}};return i.addEventListener("mousedown",c),i.ownerDocument.addEventListener("mouseup",u),i.ownerDocument.addEventListener("mousemove",C),function(){i.removeEventListener("mousedown",c),i.ownerDocument.removeEventListener("mouseup",u),i.ownerDocument.removeEventListener("mousemove",C),s()}}},[n])}var Mce=10;function Wce(n,e,t,i,a,o,r,s){var l=v.useRef(),c=v.useState(null),u=rt(c,2),C=u[0],h=u[1];return xi(function(){if(C&&C.times<Mce){if(!n.current){h(function(q){return Ke({},q)});return}o();var m=C.targetAlign,p=C.originAlign,B=C.index,b=C.offset,y=n.current.clientHeight,S=!1,R=m,Z=null;if(y){for(var x=m||p,M=0,E=0,F=0,N=Math.min(e.length-1,B),H=0;H<=N;H+=1){var z=a(e[H]);E=M;var _=t.get(z);F=E+(_===void 0?i:_),M=F}for(var D=x==="top"?b:y-b,P=N;P>=0;P-=1){var $=a(e[P]),X=t.get($);if(X===void 0){S=!0;break}if(D-=X,D<=0)break}switch(x){case"top":Z=E-b;break;case"bottom":Z=F-y+b;break;default:{var L=n.current.scrollTop,U=L+y;E<L?R="top":F>U&&(R="bottom")}}Z!==null&&r(Z),Z!==C.lastTop&&(S=!0)}S&&h(Ke(Ke({},C),{},{times:C.times+1,targetAlign:R,lastTop:Z}))}},[C,n.current]),function(m){if(m==null){s();return}if(mi.cancel(l.current),typeof m=="number")r(m);else if(m&&Bn(m)==="object"){var p,B=m.align;"index"in m?p=m.index:p=e.findIndex(function(S){return a(S)===m.key});var b=m.offset,y=b===void 0?0:b;h({times:0,index:p,offset:y,originAlign:B})}}}var C3=v.forwardRef(function(n,e){var t=n.prefixCls,i=n.rtl,a=n.scrollOffset,o=n.scrollRange,r=n.onStartMove,s=n.onStopMove,l=n.onScroll,c=n.horizontal,u=n.spinSize,C=n.containerSize,h=n.style,m=n.thumbStyle,p=n.showScrollBar,B=v.useState(!1),b=rt(B,2),y=b[0],S=b[1],R=v.useState(null),Z=rt(R,2),x=Z[0],M=Z[1],E=v.useState(null),F=rt(E,2),N=F[0],H=F[1],z=!i,_=v.useRef(),D=v.useRef(),P=v.useState(p),$=rt(P,2),X=$[0],L=$[1],U=v.useRef(),q=function(){p===!0||p===!1||(clearTimeout(U.current),L(!0),U.current=setTimeout(function(){L(!1)},3e3))},K=o-C||0,O=C-u||0,j=v.useMemo(function(){if(a===0||K===0)return 0;var ye=a/K;return ye*O},[a,K,O]),ne=function(pe){pe.stopPropagation(),pe.preventDefault()},k=v.useRef({top:j,dragging:y,pageY:x,startTop:N});k.current={top:j,dragging:y,pageY:x,startTop:N};var ie=function(pe){S(!0),M(CZ(pe,c)),H(k.current.top),r(),pe.stopPropagation(),pe.preventDefault()};v.useEffect(function(){var ye=function(Ye){Ye.preventDefault()},pe=_.current,Te=D.current;return pe.addEventListener("touchstart",ye,{passive:!1}),Te.addEventListener("touchstart",ie,{passive:!1}),function(){pe.removeEventListener("touchstart",ye),Te.removeEventListener("touchstart",ie)}},[]);var re=v.useRef();re.current=K;var ge=v.useRef();ge.current=O,v.useEffect(function(){if(y){var ye,pe=function(Ye){var he=k.current,Ge=he.dragging,be=he.pageY,Ee=he.startTop;mi.cancel(ye);var Se=_.current.getBoundingClientRect(),ee=C/(c?Se.width:Se.height);if(Ge){var Q=(CZ(Ye,c)-be)*ee,ce=Ee;!z&&c?ce-=Q:ce+=Q;var me=re.current,Ze=ge.current,Xe=Ze?ce/Ze:0,De=Math.ceil(Xe*me);De=Math.max(De,0),De=Math.min(De,me),ye=mi(function(){l(De,c)})}},Te=function(){S(!1),s()};return window.addEventListener("mousemove",pe,{passive:!0}),window.addEventListener("touchmove",pe,{passive:!0}),window.addEventListener("mouseup",Te,{passive:!0}),window.addEventListener("touchend",Te,{passive:!0}),function(){window.removeEventListener("mousemove",pe),window.removeEventListener("touchmove",pe),window.removeEventListener("mouseup",Te),window.removeEventListener("touchend",Te),mi.cancel(ye)}}},[y]),v.useEffect(function(){return q(),function(){clearTimeout(U.current)}},[a]),v.useImperativeHandle(e,function(){return{delayHidden:q}});var de="".concat(t,"-scrollbar"),xe={position:"absolute",visibility:X?null:"hidden"},Ne={position:"absolute",background:"rgba(0, 0, 0, 0.5)",borderRadius:99,cursor:"pointer",userSelect:"none"};return c?(xe.height=8,xe.left=0,xe.right=0,xe.bottom=0,Ne.height="100%",Ne.width=u,z?Ne.left=j:Ne.right=j):(xe.width=8,xe.top=0,xe.bottom=0,z?xe.right=0:xe.left=0,Ne.width="100%",Ne.height=u,Ne.top=j),v.createElement("div",{ref:_,className:gt(de,Ve(Ve(Ve({},"".concat(de,"-horizontal"),c),"".concat(de,"-vertical"),!c),"".concat(de,"-visible"),X)),style:Ke(Ke({},xe),h),onMouseDown:ne,onMouseMove:q},v.createElement("div",{ref:D,className:gt("".concat(de,"-thumb"),Ve({},"".concat(de,"-thumb-moving"),y)),style:Ke(Ke({},Ne),m),onMouseDown:ie}))}),Vce=20;function I3(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=n/e*n;return isNaN(t)&&(t=0),t=Math.max(t,Vce),Math.floor(t)}var Nce=["prefixCls","className","height","itemHeight","fullHeight","style","data","children","itemKey","virtual","direction","scrollWidth","component","onScroll","onVirtualScroll","onVisibleChange","innerProps","extraRender","styles","showScrollBar"],Ece=[],Hce={overflowY:"auto",overflowAnchor:"none"};function Fce(n,e){var t=n.prefixCls,i=t===void 0?"rc-virtual-list":t,a=n.className,o=n.height,r=n.itemHeight,s=n.fullHeight,l=s===void 0?!0:s,c=n.style,u=n.data,C=n.children,h=n.itemKey,m=n.virtual,p=n.direction,B=n.scrollWidth,b=n.component,y=b===void 0?"div":b,S=n.onScroll,R=n.onVirtualScroll,Z=n.onVisibleChange,x=n.innerProps,M=n.extraRender,E=n.styles,F=n.showScrollBar,N=F===void 0?"optional":F,H=_n(n,Nce),z=v.useCallback(function(te){return typeof h=="function"?h(te):te==null?void 0:te[h]},[h]),_=Rce(z),D=rt(_,4),P=D[0],$=D[1],X=D[2],L=D[3],U=!!(m!==!1&&o&&r),q=v.useMemo(function(){return Object.values(X.maps).reduce(function(te,Ie){return te+Ie},0)},[X.id,X.maps]),K=U&&u&&(Math.max(r*u.length,q)>o||!!B),O=p==="rtl",j=gt(i,Ve({},"".concat(i,"-rtl"),O),a),ne=u||Ece,k=v.useRef(),ie=v.useRef(),re=v.useRef(),ge=v.useState(0),de=rt(ge,2),xe=de[0],Ne=de[1],ye=v.useState(0),pe=rt(ye,2),Te=pe[0],le=pe[1],Ye=v.useState(!1),he=rt(Ye,2),Ge=he[0],be=he[1],Ee=function(){be(!0)},Se=function(){be(!1)},ee={getKey:z};function Q(te){Ne(function(Ie){var Ae;typeof te=="function"?Ae=te(Ie):Ae=te;var se=mt(Ae);return k.current.scrollTop=se,se})}var ce=v.useRef({start:0,end:ne.length}),me=v.useRef(),Ze=Bce(ne,z),Xe=rt(Ze,1),De=Xe[0];me.current=De;var Oe=v.useMemo(function(){if(!U)return{scrollHeight:void 0,start:0,end:ne.length-1,offset:void 0};if(!K){var te;return{scrollHeight:((te=ie.current)===null||te===void 0?void 0:te.offsetHeight)||0,start:0,end:ne.length-1,offset:void 0}}for(var Ie=0,Ae,se,Re,Ue=ne.length,nt=0;nt<Ue;nt+=1){var pt=ne[nt],it=z(pt),Bt=X.get(it),Mt=Ie+(Bt===void 0?r:Bt);Mt>=xe&&Ae===void 0&&(Ae=nt,se=Ie),Mt>xe+o&&Re===void 0&&(Re=nt),Ie=Mt}return Ae===void 0&&(Ae=0,se=0,Re=Math.ceil(o/r)),Re===void 0&&(Re=ne.length-1),Re=Math.min(Re+1,ne.length-1),{scrollHeight:Ie,start:Ae,end:Re,offset:se}},[K,U,xe,ne,L,o]),Je=Oe.scrollHeight,At=Oe.start,qe=Oe.end,lt=Oe.offset;ce.current.start=At,ce.current.end=qe,v.useLayoutEffect(function(){var te=X.getRecord();if(te.size===1){var Ie=Array.from(te)[0],Ae=ne[At];if(Ae){var se=z(Ae);if(se===Ie){var Re=X.get(Ie),Ue=Re-r;Q(function(nt){return nt+Ue})}}}X.resetRecord()},[Je]);var $e=v.useState({width:0,height:o}),je=rt($e,2),ke=je[0],Ce=je[1],He=function(Ie){Ce({width:Ie.offsetWidth,height:Ie.offsetHeight})},ht=v.useRef(),we=v.useRef(),ze=v.useMemo(function(){return I3(ke.width,B)},[ke.width,B]),Qe=v.useMemo(function(){return I3(ke.height,Je)},[ke.height,Je]),ut=Je-o,Rt=v.useRef(ut);Rt.current=ut;function mt(te){var Ie=te;return Number.isNaN(Rt.current)||(Ie=Math.min(Ie,Rt.current)),Ie=Math.max(Ie,0),Ie}var _t=xe<=0,Lt=xe>=ut,Zt=Te<=0,yt=Te>=B,Ht=Nz(_t,Lt,Zt,yt),jt=function(){return{x:O?-Te:Te,y:xe}},Ut=v.useRef(jt()),Nt=Aa(function(te){if(R){var Ie=Ke(Ke({},jt()),te);(Ut.current.x!==Ie.x||Ut.current.y!==Ie.y)&&(R(Ie),Ut.current=Ie)}});function Tt(te,Ie){var Ae=te;Ie?(md.flushSync(function(){le(Ae)}),Nt()):Q(Ae)}function Pt(te){var Ie=te.currentTarget.scrollTop;Ie!==xe&&Q(Ie),S==null||S(te),Nt()}var qt=function(Ie){var Ae=Ie,se=B?B-ke.width:0;return Ae=Math.max(Ae,0),Ae=Math.min(Ae,se),Ae},kt=Aa(function(te,Ie){Ie?(md.flushSync(function(){le(function(Ae){var se=Ae+(O?-te:te);return qt(se)})}),Nt()):Q(function(Ae){var se=Ae+te;return se})}),Ft=Gce(U,_t,Lt,Zt,yt,!!B,kt),fn=rt(Ft,2),sn=fn[0],ae=fn[1];Zce(U,k,function(te,Ie,Ae,se){var Re=se;return Ht(te,Ie,Ae)?!1:!Re||!Re._virtualHandled?(Re&&(Re._virtualHandled=!0),sn({preventDefault:function(){},deltaX:te?Ie:0,deltaY:te?0:Ie}),!0):!1}),xce(K,k,function(te){Q(function(Ie){return Ie+te})}),xi(function(){function te(Ae){var se=_t&&Ae.detail<0,Re=Lt&&Ae.detail>0;U&&!se&&!Re&&Ae.preventDefault()}var Ie=k.current;return Ie.addEventListener("wheel",sn,{passive:!1}),Ie.addEventListener("DOMMouseScroll",ae,{passive:!0}),Ie.addEventListener("MozMousePixelScroll",te,{passive:!1}),function(){Ie.removeEventListener("wheel",sn),Ie.removeEventListener("DOMMouseScroll",ae),Ie.removeEventListener("MozMousePixelScroll",te)}},[U,_t,Lt]),xi(function(){if(B){var te=qt(Te);le(te),Nt({x:te})}},[ke.width,B]);var ue=function(){var Ie,Ae;(Ie=ht.current)===null||Ie===void 0||Ie.delayHidden(),(Ae=we.current)===null||Ae===void 0||Ae.delayHidden()},Fe=Wce(k,ne,X,r,z,function(){return $(!0)},Q,ue);v.useImperativeHandle(e,function(){return{nativeElement:re.current,getScrollInfo:jt,scrollTo:function(Ie){function Ae(se){return se&&Bn(se)==="object"&&("left"in se||"top"in se)}Ae(Ie)?(Ie.left!==void 0&&le(qt(Ie.left)),Fe(Ie.top)):Fe(Ie)}}}),xi(function(){if(Z){var te=ne.slice(At,qe+1);Z(te,ne)}},[At,qe,ne]);var ot=Sce(ne,z,X,r),at=M==null?void 0:M({start:At,end:qe,virtual:K,offsetX:Te,offsetY:lt,rtl:O,getSize:ot}),It=vce(ne,At,qe,B,Te,P,C,ee),Wt=null;o&&(Wt=Ke(Ve({},l?"height":"maxHeight",o),Hce),U&&(Wt.overflowY="hidden",B&&(Wt.overflowX="hidden"),Ge&&(Wt.pointerEvents="none")));var xt={};return O&&(xt.dir="rtl"),v.createElement("div",$t({ref:re,style:Ke(Ke({},c),{},{position:"relative"}),className:j},xt,H),v.createElement(vl,{onResize:He},v.createElement(y,{className:"".concat(i,"-holder"),style:Wt,ref:k,onScroll:Pt,onMouseEnter:ue},v.createElement(Vz,{prefixCls:i,height:Je,offsetX:Te,offsetY:lt,scrollWidth:B,onInnerResize:$,ref:ie,innerProps:x,rtl:O,extra:at},It))),K&&Je>o&&v.createElement(C3,{ref:ht,prefixCls:i,scrollOffset:xe,scrollRange:Je,rtl:O,onScroll:Tt,onStartMove:Ee,onStopMove:Se,spinSize:Qe,containerSize:ke.height,style:E==null?void 0:E.verticalScrollBar,thumbStyle:E==null?void 0:E.verticalScrollBarThumb,showScrollBar:N}),K&&B>ke.width&&v.createElement(C3,{ref:we,prefixCls:i,scrollOffset:Te,scrollRange:B,rtl:O,onScroll:Tt,onStartMove:Ee,onStopMove:Se,spinSize:ze,containerSize:ke.width,horizontal:!0,style:E==null?void 0:E.horizontalScrollBar,thumbStyle:E==null?void 0:E.horizontalScrollBarThumb,showScrollBar:N}))}var Ez=v.forwardRef(Fce);Ez.displayName="List";function Xce(){return/(mac\sos|macintosh)/i.test(navigator.appVersion)}var Tce=["disabled","title","children","style","className"];function h3(n){return typeof n=="string"||typeof n=="number"}var Yce=function(e,t){var i=Sle(),a=i.prefixCls,o=i.id,r=i.open,s=i.multiple,l=i.mode,c=i.searchValue,u=i.toggleOpen,C=i.notFoundContent,h=i.onPopupScroll,m=v.useContext(RM),p=m.maxCount,B=m.flattenOptions,b=m.onActiveValue,y=m.defaultActiveFirstOption,S=m.onSelect,R=m.menuItemSelectedIcon,Z=m.rawValues,x=m.fieldNames,M=m.virtual,E=m.direction,F=m.listHeight,N=m.listItemHeight,H=m.optionRender,z="".concat(a,"-item"),_=mb(function(){return B},[r,B],function(ye,pe){return pe[0]&&ye[1]!==pe[1]}),D=v.useRef(null),P=v.useMemo(function(){return s&&gZ(p)&&(Z==null?void 0:Z.size)>=p},[s,p,Z==null?void 0:Z.size]),$=function(pe){pe.preventDefault()},X=function(pe){var Te;(Te=D.current)===null||Te===void 0||Te.scrollTo(typeof pe=="number"?{index:pe}:pe)},L=v.useCallback(function(ye){return l==="combobox"?!1:Z.has(ye)},[l,an(Z).toString(),Z.size]),U=function(pe){for(var Te=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,le=_.length,Ye=0;Ye<le;Ye+=1){var he=(pe+Ye*Te+le)%le,Ge=_[he]||{},be=Ge.group,Ee=Ge.data;if(!be&&!(Ee!=null&&Ee.disabled)&&(L(Ee.value)||!P))return he}return-1},q=v.useState(function(){return U(0)}),K=rt(q,2),O=K[0],j=K[1],ne=function(pe){var Te=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;j(pe);var le={source:Te?"keyboard":"mouse"},Ye=_[pe];if(!Ye){b(null,-1,le);return}b(Ye.value,pe,le)};v.useEffect(function(){ne(y!==!1?U(0):-1)},[_.length,c]);var k=v.useCallback(function(ye){return l==="combobox"?String(ye).toLowerCase()===c.toLowerCase():Z.has(ye)},[l,c,an(Z).toString(),Z.size]);v.useEffect(function(){var ye=setTimeout(function(){if(!s&&r&&Z.size===1){var Te=Array.from(Z)[0],le=_.findIndex(function(Ye){var he=Ye.data;return he.value===Te});le!==-1&&(ne(le),X(le))}});if(r){var pe;(pe=D.current)===null||pe===void 0||pe.scrollTo(void 0)}return function(){return clearTimeout(ye)}},[r,c]);var ie=function(pe){pe!==void 0&&S(pe,{selected:!Z.has(pe)}),s||u(!1)};if(v.useImperativeHandle(t,function(){return{onKeyDown:function(pe){var Te=pe.which,le=pe.ctrlKey;switch(Te){case tn.N:case tn.P:case tn.UP:case tn.DOWN:{var Ye=0;if(Te===tn.UP?Ye=-1:Te===tn.DOWN?Ye=1:Xce()&&le&&(Te===tn.N?Ye=1:Te===tn.P&&(Ye=-1)),Ye!==0){var he=U(O+Ye,Ye);X(he),ne(he,!0)}break}case tn.TAB:case tn.ENTER:{var Ge,be=_[O];be&&!(be!=null&&(Ge=be.data)!==null&&Ge!==void 0&&Ge.disabled)&&!P?ie(be.value):ie(void 0),r&&pe.preventDefault();break}case tn.ESC:u(!1),r&&pe.stopPropagation()}},onKeyUp:function(){},scrollTo:function(pe){X(pe)}}}),_.length===0)return v.createElement("div",{role:"listbox",id:"".concat(o,"_list"),className:"".concat(z,"-empty"),onMouseDown:$},C);var re=Object.keys(x).map(function(ye){return x[ye]}),ge=function(pe){return pe.label};function de(ye,pe){var Te=ye.group;return{role:Te?"presentation":"option",id:"".concat(o,"_list_").concat(pe)}}var xe=function(pe){var Te=_[pe];if(!Te)return null;var le=Te.data||{},Ye=le.value,he=Te.group,Ge=hI(le,!0),be=ge(Te);return Te?v.createElement("div",$t({"aria-label":typeof be=="string"&&!he?be:null},Ge,{key:pe},de(Te,pe),{"aria-selected":k(Ye)}),Ye):null},Ne={role:"listbox",id:"".concat(o,"_list")};return v.createElement(v.Fragment,null,M&&v.createElement("div",$t({},Ne,{style:{height:0,width:0,overflow:"hidden"}}),xe(O-1),xe(O),xe(O+1)),v.createElement(Ez,{itemKey:"key",ref:D,data:_,height:F,itemHeight:N,fullHeight:!1,onMouseDown:$,onScroll:h,virtual:M,direction:E,innerProps:M?null:Ne},function(ye,pe){var Te=ye.group,le=ye.groupOption,Ye=ye.data,he=ye.label,Ge=ye.value,be=Ye.key;if(Te){var Ee,Se=(Ee=Ye.title)!==null&&Ee!==void 0?Ee:h3(he)?he.toString():void 0;return v.createElement("div",{className:gt(z,"".concat(z,"-group"),Ye.className),title:Se},he!==void 0?he:be)}var ee=Ye.disabled,Q=Ye.title;Ye.children;var ce=Ye.style,me=Ye.className,Ze=_n(Ye,Tce),Xe=Ss(Ze,re),De=L(Ge),Oe=ee||!De&&P,Je="".concat(z,"-option"),At=gt(z,Je,me,Ve(Ve(Ve(Ve({},"".concat(Je,"-grouped"),le),"".concat(Je,"-active"),O===pe&&!Oe),"".concat(Je,"-disabled"),Oe),"".concat(Je,"-selected"),De)),qe=ge(ye),lt=!R||typeof R=="function"||De,$e=typeof qe=="number"?qe:qe||Ge,je=h3($e)?$e.toString():void 0;return Q!==void 0&&(je=Q),v.createElement("div",$t({},hI(Xe),M?{}:de(ye,pe),{"aria-selected":k(Ge),className:At,title:je,onMouseMove:function(){O===pe||Oe||ne(pe)},onClick:function(){Oe||ie(Ge)},style:ce}),v.createElement("div",{className:"".concat(Je,"-content")},typeof H=="function"?H(ye,{index:pe}):$e),v.isValidElement(R)||De,lt&&v.createElement(CS,{className:"".concat(z,"-option-state"),customizeIcon:R,customizeIconProps:{value:Ge,disabled:Oe,isSelected:De}},De?"":null))}))},zce=v.forwardRef(Yce);const Kce=function(n,e){var t=v.useRef({values:new Map,options:new Map}),i=v.useMemo(function(){var o=t.current,r=o.values,s=o.options,l=n.map(function(C){if(C.label===void 0){var h;return Ke(Ke({},C),{},{label:(h=r.get(C.value))===null||h===void 0?void 0:h.label})}return C}),c=new Map,u=new Map;return l.forEach(function(C){c.set(C.value,C),u.set(C.value,e.get(C.value)||s.get(C.value))}),t.current.values=c,t.current.options=u,l},[n,e]),a=v.useCallback(function(o){return e.get(o)||t.current.options.get(o)},[e]);return[i,a]};function r1(n,e){return xz(n).join("").toUpperCase().includes(e)}const Lce=function(n,e,t,i,a){return v.useMemo(function(){if(!t||i===!1)return n;var o=e.options,r=e.label,s=e.value,l=[],c=typeof i=="function",u=t.toUpperCase(),C=c?i:function(m,p){return a?r1(p[a],u):p[o]?r1(p[r!=="children"?r:"label"],u):r1(p[s],u)},h=c?function(m){return uZ(m)}:function(m){return m};return n.forEach(function(m){if(m[o]){var p=C(t,h(m));if(p)l.push(m);else{var B=m[o].filter(function(b){return C(t,h(b))});B.length&&l.push(Ke(Ke({},m),{},Ve({},o,B)))}return}C(t,h(m))&&l.push(m)}),l},[n,i,a,t,e])};var f3=0,_ce=kr();function Dce(){var n;return _ce?(n=f3,f3+=1):n="TEST_OR_SSR",n}function Oce(n){var e=v.useState(),t=rt(e,2),i=t[0],a=t[1];return v.useEffect(function(){a("rc_select_".concat(Dce()))},[]),n||i}var Uce=["children","value"],kce=["children"];function Pce(n){var e=n,t=e.key,i=e.props,a=i.children,o=i.value,r=_n(i,Uce);return Ke({key:t,value:o!==void 0?o:t,children:a},r)}function Hz(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return Ic(n).map(function(t,i){if(!v.isValidElement(t)||!t.type)return null;var a=t,o=a.type.isSelectOptGroup,r=a.key,s=a.props,l=s.children,c=_n(s,kce);return e||!o?Pce(t):Ke(Ke({key:"__RC_SELECT_GRP__".concat(r===null?i:r,"__"),label:r},c),{},{options:Hz(l)})}).filter(function(t){return t})}var Jce=function(e,t,i,a,o){return v.useMemo(function(){var r=e,s=!e;s&&(r=Hz(t));var l=new Map,c=new Map,u=function(m,p,B){B&&typeof B=="string"&&m.set(p[B],p)},C=function h(m){for(var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,B=0;B<m.length;B+=1){var b=m[B];!b[i.options]||p?(l.set(b[i.value],b),u(c,b,i.label),u(c,b,a),u(c,b,o)):h(b[i.options],!0)}};return C(r),{options:r,valueOptions:l,labelOptions:c}},[e,t,i,a,o])};function A3(n){var e=v.useRef();e.current=n;var t=v.useCallback(function(){return e.current.apply(e,arguments)},[]);return t}var jce=["id","mode","prefixCls","backfill","fieldNames","inputValue","searchValue","onSearch","autoClearSearchValue","onSelect","onDeselect","dropdownMatchSelectWidth","filterOption","filterSort","optionFilterProp","optionLabelProp","options","optionRender","children","defaultActiveFirstOption","menuItemSelectedIcon","virtual","direction","listHeight","listItemHeight","labelRender","value","defaultValue","labelInValue","onChange","maxCount"],Qce=["inputValue"];function qce(n){return!n||Bn(n)!=="object"}var $ce=v.forwardRef(function(n,e){var t=n.id,i=n.mode,a=n.prefixCls,o=a===void 0?"rc-select":a,r=n.backfill,s=n.fieldNames,l=n.inputValue,c=n.searchValue,u=n.onSearch,C=n.autoClearSearchValue,h=C===void 0?!0:C,m=n.onSelect,p=n.onDeselect,B=n.dropdownMatchSelectWidth,b=B===void 0?!0:B,y=n.filterOption,S=n.filterSort,R=n.optionFilterProp,Z=n.optionLabelProp,x=n.options,M=n.optionRender,E=n.children,F=n.defaultActiveFirstOption,N=n.menuItemSelectedIcon,H=n.virtual,z=n.direction,_=n.listHeight,D=_===void 0?200:_,P=n.listItemHeight,$=P===void 0?20:P,X=n.labelRender,L=n.value,U=n.defaultValue,q=n.labelInValue,K=n.onChange,O=n.maxCount,j=_n(n,jce),ne=Oce(t),k=dZ(i),ie=!!(!x&&E),re=v.useMemo(function(){return y===void 0&&i==="combobox"?!1:y},[y,i]),ge=v.useMemo(function(){return Wz(s,ie)},[JSON.stringify(s),ie]),de=_a("",{value:c!==void 0?c:l,postState:function(Tt){return Tt||""}}),xe=rt(de,2),Ne=xe[0],ye=xe[1],pe=Jce(x,E,ge,R,Z),Te=pe.valueOptions,le=pe.labelOptions,Ye=pe.options,he=v.useCallback(function(Nt){var Tt=xz(Nt);return Tt.map(function(Pt){var qt,kt,Ft,fn,sn;if(qce(Pt))qt=Pt;else{var ae;Ft=Pt.key,kt=Pt.label,qt=(ae=Pt.value)!==null&&ae!==void 0?ae:Ft}var ue=Te.get(qt);if(ue){var Fe;kt===void 0&&(kt=ue==null?void 0:ue[Z||ge.label]),Ft===void 0&&(Ft=(Fe=ue==null?void 0:ue.key)!==null&&Fe!==void 0?Fe:qt),fn=ue==null?void 0:ue.disabled,sn=ue==null?void 0:ue.title}return{label:kt,value:qt,key:Ft,disabled:fn,title:sn}})},[ge,Z,Te]),Ge=_a(U,{value:L}),be=rt(Ge,2),Ee=be[0],Se=be[1],ee=v.useMemo(function(){var Nt,Tt=k&&Ee===null?[]:Ee,Pt=he(Tt);return i==="combobox"&&Dle((Nt=Pt[0])===null||Nt===void 0?void 0:Nt.value)?[]:Pt},[Ee,he,i,k]),Q=Kce(ee,Te),ce=rt(Q,2),me=ce[0],Ze=ce[1],Xe=v.useMemo(function(){if(!i&&me.length===1){var Nt=me[0];if(Nt.value===null&&(Nt.label===null||Nt.label===void 0))return[]}return me.map(function(Tt){var Pt;return Ke(Ke({},Tt),{},{label:(Pt=typeof X=="function"?X(Tt):Tt.label)!==null&&Pt!==void 0?Pt:Tt.value})})},[i,me,X]),De=v.useMemo(function(){return new Set(me.map(function(Nt){return Nt.value}))},[me]);v.useEffect(function(){if(i==="combobox"){var Nt,Tt=(Nt=me[0])===null||Nt===void 0?void 0:Nt.value;ye(_le(Tt)?String(Tt):"")}},[me]);var Oe=A3(function(Nt,Tt){var Pt=Tt??Nt;return Ve(Ve({},ge.value,Nt),ge.label,Pt)}),Je=v.useMemo(function(){if(i!=="tags")return Ye;var Nt=an(Ye),Tt=function(qt){return Te.has(qt)};return an(me).sort(function(Pt,qt){return Pt.value<qt.value?-1:1}).forEach(function(Pt){var qt=Pt.value;Tt(qt)||Nt.push(Oe(qt,Pt.label))}),Nt},[Oe,Ye,Te,me,i]),At=Lce(Je,ge,Ne,re,R),qe=v.useMemo(function(){return i!=="tags"||!Ne||At.some(function(Nt){return Nt[R||"value"]===Ne})||At.some(function(Nt){return Nt[ge.value]===Ne})?At:[Oe(Ne)].concat(an(At))},[Oe,R,i,At,Ne,ge]),lt=function Nt(Tt){var Pt=an(Tt).sort(function(qt,kt){return S(qt,kt,{searchValue:Ne})});return Pt.map(function(qt){return Array.isArray(qt.options)?Ke(Ke({},qt),{},{options:qt.options.length>0?Nt(qt.options):qt.options}):qt})},$e=v.useMemo(function(){return S?lt(qe):qe},[qe,S,Ne]),je=v.useMemo(function(){return Ice($e,{fieldNames:ge,childrenAsData:ie})},[$e,ge,ie]),ke=function(Tt){var Pt=he(Tt);if(Se(Pt),K&&(Pt.length!==me.length||Pt.some(function(Ft,fn){var sn;return((sn=me[fn])===null||sn===void 0?void 0:sn.value)!==(Ft==null?void 0:Ft.value)}))){var qt=q?Pt:Pt.map(function(Ft){return Ft.value}),kt=Pt.map(function(Ft){return uZ(Ze(Ft.value))});K(k?qt:qt[0],k?kt:kt[0])}},Ce=v.useState(null),He=rt(Ce,2),ht=He[0],we=He[1],ze=v.useState(0),Qe=rt(ze,2),ut=Qe[0],Rt=Qe[1],mt=F!==void 0?F:i!=="combobox",_t=v.useCallback(function(Nt,Tt){var Pt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},qt=Pt.source,kt=qt===void 0?"keyboard":qt;Rt(Tt),r&&i==="combobox"&&Nt!==null&&kt==="keyboard"&&we(String(Nt))},[r,i]),Lt=function(Tt,Pt,qt){var kt=function(){var Wt,xt=Ze(Tt);return[q?{label:xt==null?void 0:xt[ge.label],value:Tt,key:(Wt=xt==null?void 0:xt.key)!==null&&Wt!==void 0?Wt:Tt}:Tt,uZ(xt)]};if(Pt&&m){var Ft=kt(),fn=rt(Ft,2),sn=fn[0],ae=fn[1];m(sn,ae)}else if(!Pt&&p&&qt!=="clear"){var ue=kt(),Fe=rt(ue,2),ot=Fe[0],at=Fe[1];p(ot,at)}},Zt=A3(function(Nt,Tt){var Pt,qt=k?Tt.selected:!0;qt?Pt=k?[].concat(an(me),[Nt]):[Nt]:Pt=me.filter(function(kt){return kt.value!==Nt}),ke(Pt),Lt(Nt,qt),i==="combobox"?we(""):(!dZ||h)&&(ye(""),we(""))}),yt=function(Tt,Pt){ke(Tt);var qt=Pt.type,kt=Pt.values;(qt==="remove"||qt==="clear")&&kt.forEach(function(Ft){Lt(Ft.value,!1,qt)})},Ht=function(Tt,Pt){if(ye(Tt),we(null),Pt.source==="submit"){var qt=(Tt||"").trim();if(qt){var kt=Array.from(new Set([].concat(an(De),[qt])));ke(kt),Lt(qt,!0),ye("")}return}Pt.source!=="blur"&&(i==="combobox"&&ke(Tt),u==null||u(Tt))},jt=function(Tt){var Pt=Tt;i!=="tags"&&(Pt=Tt.map(function(kt){var Ft=le.get(kt);return Ft==null?void 0:Ft.value}).filter(function(kt){return kt!==void 0}));var qt=Array.from(new Set([].concat(an(De),an(Pt))));ke(qt),qt.forEach(function(kt){Lt(kt,!0)})},Ut=v.useMemo(function(){var Nt=H!==!1&&b!==!1;return Ke(Ke({},pe),{},{flattenOptions:je,onActiveValue:_t,defaultActiveFirstOption:mt,onSelect:Zt,menuItemSelectedIcon:N,rawValues:De,fieldNames:ge,virtual:Nt,direction:z,listHeight:D,listItemHeight:$,childrenAsData:ie,maxCount:O,optionRender:M})},[O,pe,je,_t,mt,Zt,N,De,ge,H,b,z,D,$,ie,M]);return v.createElement(RM.Provider,{value:Ut},v.createElement(pce,$t({},j,{id:ne,prefixCls:o,ref:e,omitDomProps:Qce,mode:i,displayValues:Xe,onDisplayValuesChange:yt,direction:z,searchValue:Ne,onSearch:Ht,autoClearSearchValue:h,onSearchSplit:jt,dropdownMatchSelectWidth:b,OptionList:zce,emptyOptions:!je.length,activeValue:ht,activeDescendantId:"".concat(ne,"_list_").concat(ut)})))}),MM=$ce;MM.Option=xM;MM.OptGroup=ZM;function jB(n,e,t){return gt({[`${n}-status-success`]:e==="success",[`${n}-status-warning`]:e==="warning",[`${n}-status-error`]:e==="error",[`${n}-status-validating`]:e==="validating",[`${n}-has-feedback`]:t})}const hS=(n,e)=>e||n,ege=()=>{const[,n]=ks(),[e]=bb("Empty"),i=new ia(n.colorBgBase).toHsl().l<.5?{opacity:.65}:{};return v.createElement("svg",{style:i,width:"184",height:"152",viewBox:"0 0 184 152",xmlns:"http://www.w3.org/2000/svg"},v.createElement("title",null,(e==null?void 0:e.description)||"Empty"),v.createElement("g",{fill:"none",fillRule:"evenodd"},v.createElement("g",{transform:"translate(24 31.67)"},v.createElement("ellipse",{fillOpacity:".8",fill:"#F5F5F7",cx:"67.797",cy:"106.89",rx:"67.797",ry:"12.668"}),v.createElement("path",{d:"M122.034 69.674L98.109 40.229c-1.148-1.386-2.826-2.225-4.593-2.225h-51.44c-1.766 0-3.444.839-4.592 2.225L13.56 69.674v15.383h108.475V69.674z",fill:"#AEB8C2"}),v.createElement("path",{d:"M101.537 86.214L80.63 61.102c-1.001-1.207-2.507-1.867-4.048-1.867H31.724c-1.54 0-3.047.66-4.048 1.867L6.769 86.214v13.792h94.768V86.214z",fill:"url(#linearGradient-1)",transform:"translate(13.56)"}),v.createElement("path",{d:"M33.83 0h67.933a4 4 0 0 1 4 4v93.344a4 4 0 0 1-4 4H33.83a4 4 0 0 1-4-4V4a4 4 0 0 1 4-4z",fill:"#F5F5F7"}),v.createElement("path",{d:"M42.678 9.953h50.237a2 2 0 0 1 2 2V36.91a2 2 0 0 1-2 2H42.678a2 2 0 0 1-2-2V11.953a2 2 0 0 1 2-2zM42.94 49.767h49.713a2.262 2.262 0 1 1 0 4.524H42.94a2.262 2.262 0 0 1 0-4.524zM42.94 61.53h49.713a2.262 2.262 0 1 1 0 4.525H42.94a2.262 2.262 0 0 1 0-4.525zM121.813 105.032c-.775 3.071-3.497 5.36-6.735 5.36H20.515c-3.238 0-5.96-2.29-6.734-5.36a7.309 7.309 0 0 1-.222-1.79V69.675h26.318c2.907 0 5.25 2.448 5.25 5.42v.04c0 2.971 2.37 5.37 5.277 5.37h34.785c2.907 0 5.277-2.421 5.277-5.393V75.1c0-2.972 2.343-5.426 5.25-5.426h26.318v33.569c0 .617-.077 1.216-.221 1.789z",fill:"#DCE0E6"})),v.createElement("path",{d:"M149.121 33.292l-6.83 2.65a1 1 0 0 1-1.317-1.23l1.937-6.207c-2.589-2.944-4.109-6.534-4.109-10.408C138.802 8.102 148.92 0 161.402 0 173.881 0 184 8.102 184 18.097c0 9.995-10.118 18.097-22.599 18.097-4.528 0-8.744-1.066-12.28-2.902z",fill:"#DCE0E6"}),v.createElement("g",{transform:"translate(149.65 15.383)",fill:"#FFF"},v.createElement("ellipse",{cx:"20.654",cy:"3.167",rx:"2.849",ry:"2.815"}),v.createElement("path",{d:"M5.698 5.63H0L2.898.704zM9.259.704h4.985V5.63H9.259z"}))))},tge=()=>{const[,n]=ks(),[e]=bb("Empty"),{colorFill:t,colorFillTertiary:i,colorFillQuaternary:a,colorBgContainer:o}=n,{borderColor:r,shadowColor:s,contentColor:l}=v.useMemo(()=>({borderColor:new ia(t).onBackground(o).toHexString(),shadowColor:new ia(i).onBackground(o).toHexString(),contentColor:new ia(a).onBackground(o).toHexString()}),[t,i,a,o]);return v.createElement("svg",{width:"64",height:"41",viewBox:"0 0 64 41",xmlns:"http://www.w3.org/2000/svg"},v.createElement("title",null,(e==null?void 0:e.description)||"Empty"),v.createElement("g",{transform:"translate(0 1)",fill:"none",fillRule:"evenodd"},v.createElement("ellipse",{fill:s,cx:"32",cy:"33",rx:"32",ry:"7"}),v.createElement("g",{fillRule:"nonzero",stroke:r},v.createElement("path",{d:"M55 12.76L44.854 1.258C44.367.474 43.656 0 42.907 0H21.093c-.749 0-1.46.474-1.947 1.257L9 12.761V22h46v-9.24z"}),v.createElement("path",{d:"M41.613 15.931c0-1.605.994-2.93 2.227-2.931H55v18.137C55 33.26 53.68 35 52.05 35h-40.1C10.32 35 9 33.259 9 31.137V13h11.16c1.233 0 2.227 1.323 2.227 2.928v.022c0 1.605 1.005 2.901 2.237 2.901h14.752c1.232 0 2.237-1.308 2.237-2.913v-.007z",fill:l}))))},nge=n=>{const{componentCls:e,margin:t,marginXS:i,marginXL:a,fontSize:o,lineHeight:r}=n;return{[e]:{marginInline:i,fontSize:o,lineHeight:r,textAlign:"center",[`${e}-image`]:{height:n.emptyImgHeight,marginBottom:i,opacity:n.opacityImage,img:{height:"100%"},svg:{maxWidth:"100%",height:"100%",margin:"auto"}},[`${e}-description`]:{color:n.colorTextDescription},[`${e}-footer`]:{marginTop:t},"&-normal":{marginBlock:a,color:n.colorTextDescription,[`${e}-description`]:{color:n.colorTextDescription},[`${e}-image`]:{height:n.emptyImgHeightMD}},"&-small":{marginBlock:i,color:n.colorTextDescription,[`${e}-image`]:{height:n.emptyImgHeightSM}}}}},ige=Oa("Empty",n=>{const{componentCls:e,controlHeightLG:t,calc:i}=n,a=Xi(n,{emptyImgCls:`${e}-img`,emptyImgHeight:i(t).mul(2.5).equal(),emptyImgHeightMD:t,emptyImgHeightSM:i(t).mul(.875).equal()});return[nge(a)]});var age=function(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(n);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(n,i[a])&&(t[i[a]]=n[i[a]]);return t};const Fz=v.createElement(ege,null),Xz=v.createElement(tge,null),zC=n=>{const{className:e,rootClassName:t,prefixCls:i,image:a=Fz,description:o,children:r,imageStyle:s,style:l,classNames:c,styles:u}=n,C=age(n,["className","rootClassName","prefixCls","image","description","children","imageStyle","style","classNames","styles"]),{getPrefixCls:h,direction:m,className:p,style:B,classNames:b,styles:y}=Gs("empty"),S=h("empty",i),[R,Z,x]=ige(S),[M]=bb("Empty"),E=typeof o<"u"?o:M==null?void 0:M.description,F=typeof E=="string"?E:"empty";let N=null;return typeof a=="string"?N=v.createElement("img",{alt:F,src:a}):N=a,R(v.createElement("div",Object.assign({className:gt(Z,x,S,p,{[`${S}-normal`]:a===Xz,[`${S}-rtl`]:m==="rtl"},e,t,b.root,c==null?void 0:c.root),style:Object.assign(Object.assign(Object.assign(Object.assign({},y.root),B),u==null?void 0:u.root),l)},C),v.createElement("div",{className:gt(`${S}-image`,b.image,c==null?void 0:c.image),style:Object.assign(Object.assign(Object.assign({},s),y.image),u==null?void 0:u.image)},N),E&&v.createElement("div",{className:gt(`${S}-description`,b.description,c==null?void 0:c.description),style:Object.assign(Object.assign({},y.description),u==null?void 0:u.description)},E),r&&v.createElement("div",{className:gt(`${S}-footer`,b.footer,c==null?void 0:c.footer),style:Object.assign(Object.assign({},y.footer),u==null?void 0:u.footer)},r)))};zC.PRESENTED_IMAGE_DEFAULT=Fz;zC.PRESENTED_IMAGE_SIMPLE=Xz;const Tz=n=>{const{componentName:e}=n,{getPrefixCls:t}=v.useContext(ui),i=t("empty");switch(e){case"Table":case"List":return Ct.createElement(zC,{image:zC.PRESENTED_IMAGE_SIMPLE});case"Select":case"TreeSelect":case"Cascader":case"Transfer":case"Mentions":return Ct.createElement(zC,{image:zC.PRESENTED_IMAGE_SIMPLE,className:`${i}-small`});case"Table.filter":return null;default:return Ct.createElement(zC,null)}},fS=function(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0;var i,a;const{variant:o,[n]:r}=v.useContext(ui),s=v.useContext(Ose),l=r==null?void 0:r.variant;let c;typeof e<"u"?c=e:t===!1?c="borderless":c=(a=(i=s??l)!==null&&i!==void 0?i:o)!==null&&a!==void 0?a:"outlined";const u=bie.includes(c);return[c,u]},oge=n=>{const t={overflow:{adjustX:!0,adjustY:!0,shiftY:!0},htmlRegion:n==="scroll"?"scroll":"visible",dynamicInset:!0};return{bottomLeft:Object.assign(Object.assign({},t),{points:["tl","bl"],offset:[0,4]}),bottomRight:Object.assign(Object.assign({},t),{points:["tr","br"],offset:[0,4]}),topLeft:Object.assign(Object.assign({},t),{points:["bl","tl"],offset:[0,-4]}),topRight:Object.assign(Object.assign({},t),{points:["br","tr"],offset:[0,-4]})}};function rge(n,e){return n||oge(e)}const m3=n=>{const{optionHeight:e,optionFontSize:t,optionLineHeight:i,optionPadding:a}=n;return{position:"relative",display:"block",minHeight:e,padding:a,color:n.colorText,fontWeight:"normal",fontSize:t,lineHeight:i,boxSizing:"border-box"}},sge=n=>{const{antCls:e,componentCls:t}=n,i=`${t}-item`,a=`&${e}-slide-up-enter${e}-slide-up-enter-active`,o=`&${e}-slide-up-appear${e}-slide-up-appear-active`,r=`&${e}-slide-up-leave${e}-slide-up-leave-active`,s=`${t}-dropdown-placement-`,l=`${i}-option-selected`;return[{[`${t}-dropdown`]:Object.assign(Object.assign({},Po(n)),{position:"absolute",top:-9999,zIndex:n.zIndexPopup,boxSizing:"border-box",padding:n.paddingXXS,overflow:"hidden",fontSize:n.fontSize,fontVariant:"initial",backgroundColor:n.colorBgElevated,borderRadius:n.borderRadiusLG,outline:"none",boxShadow:n.boxShadowSecondary,[`
          ${a}${s}bottomLeft,
          ${o}${s}bottomLeft
        `]:{animationName:lz},[`
          ${a}${s}topLeft,
          ${o}${s}topLeft,
          ${a}${s}topRight,
          ${o}${s}topRight
        `]:{animationName:gz},[`${r}${s}bottomLeft`]:{animationName:cz},[`
          ${r}${s}topLeft,
          ${r}${s}topRight
        `]:{animationName:uz},"&-hidden":{display:"none"},[i]:Object.assign(Object.assign({},m3(n)),{cursor:"pointer",transition:`background ${n.motionDurationSlow} ease`,borderRadius:n.borderRadiusSM,"&-group":{color:n.colorTextDescription,fontSize:n.fontSizeSM,cursor:"default"},"&-option":{display:"flex","&-content":Object.assign({flex:"auto"},Tf),"&-state":{flex:"none",display:"flex",alignItems:"center"},[`&-active:not(${i}-option-disabled)`]:{backgroundColor:n.optionActiveBg},[`&-selected:not(${i}-option-disabled)`]:{color:n.optionSelectedColor,fontWeight:n.optionSelectedFontWeight,backgroundColor:n.optionSelectedBg,[`${i}-option-state`]:{color:n.colorPrimary}},"&-disabled":{[`&${i}-option-selected`]:{backgroundColor:n.colorBgContainerDisabled},color:n.colorTextDisabled,cursor:"not-allowed"},"&-grouped":{paddingInlineStart:n.calc(n.controlPaddingHorizontal).mul(2).equal()}},"&-empty":Object.assign(Object.assign({},m3(n)),{color:n.colorTextDisabled})}),[`${l}:has(+ ${l})`]:{borderEndStartRadius:0,borderEndEndRadius:0,[`& + ${l}`]:{borderStartStartRadius:0,borderStartEndRadius:0}},"&-rtl":{direction:"rtl"}})},kB(n,"slide-up"),kB(n,"slide-down"),NH(n,"move-up"),NH(n,"move-down")]},lge=n=>{const{multipleSelectItemHeight:e,paddingXXS:t,lineWidth:i,INTERNAL_FIXED_ITEM_MARGIN:a}=n,o=n.max(n.calc(t).sub(i).equal(),0),r=n.max(n.calc(o).sub(a).equal(),0);return{basePadding:o,containerPadding:r,itemHeight:st(e),itemLineHeight:st(n.calc(e).sub(n.calc(n.lineWidth).mul(2)).equal())}},cge=n=>{const{multipleSelectItemHeight:e,selectHeight:t,lineWidth:i}=n;return n.calc(t).sub(e).div(2).sub(i).equal()},gge=n=>{const{componentCls:e,iconCls:t,borderRadiusSM:i,motionDurationSlow:a,paddingXS:o,multipleItemColorDisabled:r,multipleItemBorderColorDisabled:s,colorIcon:l,colorIconHover:c,INTERNAL_FIXED_ITEM_MARGIN:u}=n;return{[`${e}-selection-overflow`]:{position:"relative",display:"flex",flex:"auto",flexWrap:"wrap",maxWidth:"100%","&-item":{flex:"none",alignSelf:"center",maxWidth:"100%",display:"inline-flex"},[`${e}-selection-item`]:{display:"flex",alignSelf:"center",flex:"none",boxSizing:"border-box",maxWidth:"100%",marginBlock:u,borderRadius:i,cursor:"default",transition:`font-size ${a}, line-height ${a}, height ${a}`,marginInlineEnd:n.calc(u).mul(2).equal(),paddingInlineStart:o,paddingInlineEnd:n.calc(o).div(2).equal(),[`${e}-disabled&`]:{color:r,borderColor:s,cursor:"not-allowed"},"&-content":{display:"inline-block",marginInlineEnd:n.calc(o).div(2).equal(),overflow:"hidden",whiteSpace:"pre",textOverflow:"ellipsis"},"&-remove":Object.assign(Object.assign({},nS()),{display:"inline-flex",alignItems:"center",color:l,fontWeight:"bold",fontSize:10,lineHeight:"inherit",cursor:"pointer",[`> ${t}`]:{verticalAlign:"-0.2em"},"&:hover":{color:c}})}}}},uge=(n,e)=>{const{componentCls:t,INTERNAL_FIXED_ITEM_MARGIN:i}=n,a=`${t}-selection-overflow`,o=n.multipleSelectItemHeight,r=cge(n),s=e?`${t}-${e}`:"",l=lge(n);return{[`${t}-multiple${s}`]:Object.assign(Object.assign({},gge(n)),{[`${t}-selector`]:{display:"flex",alignItems:"center",width:"100%",height:"100%",paddingInline:l.basePadding,paddingBlock:l.containerPadding,borderRadius:n.borderRadius,[`${t}-disabled&`]:{background:n.multipleSelectorBgDisabled,cursor:"not-allowed"},"&:after":{display:"inline-block",width:0,margin:`${st(i)} 0`,lineHeight:st(o),visibility:"hidden",content:'"\\a0"'}},[`${t}-selection-item`]:{height:l.itemHeight,lineHeight:st(l.itemLineHeight)},[`${t}-selection-wrap`]:{alignSelf:"flex-start","&:after":{lineHeight:st(o),marginBlock:i}},[`${t}-prefix`]:{marginInlineStart:n.calc(n.inputPaddingHorizontalBase).sub(l.basePadding).equal()},[`${a}-item + ${a}-item,
        ${t}-prefix + ${t}-selection-wrap
      `]:{[`${t}-selection-search`]:{marginInlineStart:0},[`${t}-selection-placeholder`]:{insetInlineStart:0}},[`${a}-item-suffix`]:{minHeight:l.itemHeight,marginBlock:i},[`${t}-selection-search`]:{display:"inline-flex",position:"relative",maxWidth:"100%",marginInlineStart:n.calc(n.inputPaddingHorizontalBase).sub(r).equal(),"\n          &-input,\n          &-mirror\n        ":{height:o,fontFamily:n.fontFamily,lineHeight:st(o),transition:`all ${n.motionDurationSlow}`},"&-input":{width:"100%",minWidth:4.1},"&-mirror":{position:"absolute",top:0,insetInlineStart:0,insetInlineEnd:"auto",zIndex:999,whiteSpace:"pre",visibility:"hidden"}},[`${t}-selection-placeholder`]:{position:"absolute",top:"50%",insetInlineStart:n.calc(n.inputPaddingHorizontalBase).sub(l.basePadding).equal(),insetInlineEnd:n.inputPaddingHorizontalBase,transform:"translateY(-50%)",transition:`all ${n.motionDurationSlow}`}})}};function s1(n,e){const{componentCls:t}=n,i=e?`${t}-${e}`:"",a={[`${t}-multiple${i}`]:{fontSize:n.fontSize,[`${t}-selector`]:{[`${t}-show-search&`]:{cursor:"text"}},[`
        &${t}-show-arrow ${t}-selector,
        &${t}-allow-clear ${t}-selector
      `]:{paddingInlineEnd:n.calc(n.fontSizeIcon).add(n.controlPaddingHorizontal).equal()}}};return[uge(n,e),a]}const dge=n=>{const{componentCls:e}=n,t=Xi(n,{selectHeight:n.controlHeightSM,multipleSelectItemHeight:n.multipleItemHeightSM,borderRadius:n.borderRadiusSM,borderRadiusSM:n.borderRadiusXS}),i=Xi(n,{fontSize:n.fontSizeLG,selectHeight:n.controlHeightLG,multipleSelectItemHeight:n.multipleItemHeightLG,borderRadius:n.borderRadiusLG,borderRadiusSM:n.borderRadius});return[s1(n),s1(t,"sm"),{[`${e}-multiple${e}-sm`]:{[`${e}-selection-placeholder`]:{insetInline:n.calc(n.controlPaddingHorizontalSM).sub(n.lineWidth).equal()},[`${e}-selection-search`]:{marginInlineStart:2}}},s1(i,"lg")]};function l1(n,e){const{componentCls:t,inputPaddingHorizontalBase:i,borderRadius:a}=n,o=n.calc(n.controlHeight).sub(n.calc(n.lineWidth).mul(2)).equal(),r=e?`${t}-${e}`:"";return{[`${t}-single${r}`]:{fontSize:n.fontSize,height:n.controlHeight,[`${t}-selector`]:Object.assign(Object.assign({},Po(n,!0)),{display:"flex",borderRadius:a,flex:"1 1 auto",[`${t}-selection-wrap:after`]:{lineHeight:st(o)},[`${t}-selection-search`]:{position:"absolute",inset:0,width:"100%","&-input":{width:"100%",WebkitAppearance:"textfield"}},[`
          ${t}-selection-item,
          ${t}-selection-placeholder
        `]:{display:"block",padding:0,lineHeight:st(o),transition:`all ${n.motionDurationSlow}, visibility 0s`,alignSelf:"center"},[`${t}-selection-placeholder`]:{transition:"none",pointerEvents:"none"},[["&:after",`${t}-selection-item:empty:after`,`${t}-selection-placeholder:empty:after`].join(",")]:{display:"inline-block",width:0,visibility:"hidden",content:'"\\a0"'}}),[`
        &${t}-show-arrow ${t}-selection-item,
        &${t}-show-arrow ${t}-selection-search,
        &${t}-show-arrow ${t}-selection-placeholder
      `]:{paddingInlineEnd:n.showArrowPaddingInlineEnd},[`&${t}-open ${t}-selection-item`]:{color:n.colorTextPlaceholder},[`&:not(${t}-customize-input)`]:{[`${t}-selector`]:{width:"100%",height:"100%",alignItems:"center",padding:`0 ${st(i)}`,[`${t}-selection-search-input`]:{height:o,fontSize:n.fontSize},"&:after":{lineHeight:st(o)}}},[`&${t}-customize-input`]:{[`${t}-selector`]:{"&:after":{display:"none"},[`${t}-selection-search`]:{position:"static",width:"100%"},[`${t}-selection-placeholder`]:{position:"absolute",insetInlineStart:0,insetInlineEnd:0,padding:`0 ${st(i)}`,"&:after":{display:"none"}}}}}}}function Cge(n){const{componentCls:e}=n,t=n.calc(n.controlPaddingHorizontalSM).sub(n.lineWidth).equal();return[l1(n),l1(Xi(n,{controlHeight:n.controlHeightSM,borderRadius:n.borderRadiusSM}),"sm"),{[`${e}-single${e}-sm`]:{[`&:not(${e}-customize-input)`]:{[`${e}-selector`]:{padding:`0 ${st(t)}`},[`&${e}-show-arrow ${e}-selection-search`]:{insetInlineEnd:n.calc(t).add(n.calc(n.fontSize).mul(1.5)).equal()},[`
            &${e}-show-arrow ${e}-selection-item,
            &${e}-show-arrow ${e}-selection-placeholder
          `]:{paddingInlineEnd:n.calc(n.fontSize).mul(1.5).equal()}}}},l1(Xi(n,{controlHeight:n.singleItemHeightLG,fontSize:n.fontSizeLG,borderRadius:n.borderRadiusLG}),"lg")]}const Ige=n=>{const{fontSize:e,lineHeight:t,lineWidth:i,controlHeight:a,controlHeightSM:o,controlHeightLG:r,paddingXXS:s,controlPaddingHorizontal:l,zIndexPopupBase:c,colorText:u,fontWeightStrong:C,controlItemBgActive:h,controlItemBgHover:m,colorBgContainer:p,colorFillSecondary:B,colorBgContainerDisabled:b,colorTextDisabled:y,colorPrimaryHover:S,colorPrimary:R,controlOutline:Z}=n,x=s*2,M=i*2,E=Math.min(a-x,a-M),F=Math.min(o-x,o-M),N=Math.min(r-x,r-M);return{INTERNAL_FIXED_ITEM_MARGIN:Math.floor(s/2),zIndexPopup:c+50,optionSelectedColor:u,optionSelectedFontWeight:C,optionSelectedBg:h,optionActiveBg:m,optionPadding:`${(a-e*t)/2}px ${l}px`,optionFontSize:e,optionLineHeight:t,optionHeight:a,selectorBg:p,clearBg:p,singleItemHeightLG:r,multipleItemBg:B,multipleItemBorderColor:"transparent",multipleItemHeight:E,multipleItemHeightSM:F,multipleItemHeightLG:N,multipleSelectorBgDisabled:b,multipleItemColorDisabled:y,multipleItemBorderColorDisabled:"transparent",showArrowPaddingInlineEnd:Math.ceil(n.fontSize*1.25),hoverBorderColor:S,activeBorderColor:R,activeOutlineColor:Z,selectAffixPadding:s}},Yz=(n,e)=>{const{componentCls:t,antCls:i,controlOutlineWidth:a}=n;return{[`&:not(${t}-customize-input) ${t}-selector`]:{border:`${st(n.lineWidth)} ${n.lineType} ${e.borderColor}`,background:n.selectorBg},[`&:not(${t}-disabled):not(${t}-customize-input):not(${i}-pagination-size-changer)`]:{[`&:hover ${t}-selector`]:{borderColor:e.hoverBorderHover},[`${t}-focused& ${t}-selector`]:{borderColor:e.activeBorderColor,boxShadow:`0 0 0 ${st(a)} ${e.activeOutlineColor}`,outline:0},[`${t}-prefix`]:{color:e.color}}}},p3=(n,e)=>({[`&${n.componentCls}-status-${e.status}`]:Object.assign({},Yz(n,e))}),hge=n=>({"&-outlined":Object.assign(Object.assign(Object.assign(Object.assign({},Yz(n,{borderColor:n.colorBorder,hoverBorderHover:n.hoverBorderColor,activeBorderColor:n.activeBorderColor,activeOutlineColor:n.activeOutlineColor,color:n.colorText})),p3(n,{status:"error",borderColor:n.colorError,hoverBorderHover:n.colorErrorHover,activeBorderColor:n.colorError,activeOutlineColor:n.colorErrorOutline,color:n.colorError})),p3(n,{status:"warning",borderColor:n.colorWarning,hoverBorderHover:n.colorWarningHover,activeBorderColor:n.colorWarning,activeOutlineColor:n.colorWarningOutline,color:n.colorWarning})),{[`&${n.componentCls}-disabled`]:{[`&:not(${n.componentCls}-customize-input) ${n.componentCls}-selector`]:{background:n.colorBgContainerDisabled,color:n.colorTextDisabled}},[`&${n.componentCls}-multiple ${n.componentCls}-selection-item`]:{background:n.multipleItemBg,border:`${st(n.lineWidth)} ${n.lineType} ${n.multipleItemBorderColor}`}})}),zz=(n,e)=>{const{componentCls:t,antCls:i}=n;return{[`&:not(${t}-customize-input) ${t}-selector`]:{background:e.bg,border:`${st(n.lineWidth)} ${n.lineType} transparent`,color:e.color},[`&:not(${t}-disabled):not(${t}-customize-input):not(${i}-pagination-size-changer)`]:{[`&:hover ${t}-selector`]:{background:e.hoverBg},[`${t}-focused& ${t}-selector`]:{background:n.selectorBg,borderColor:e.activeBorderColor,outline:0}}}},b3=(n,e)=>({[`&${n.componentCls}-status-${e.status}`]:Object.assign({},zz(n,e))}),fge=n=>({"&-filled":Object.assign(Object.assign(Object.assign(Object.assign({},zz(n,{bg:n.colorFillTertiary,hoverBg:n.colorFillSecondary,activeBorderColor:n.activeBorderColor,color:n.colorText})),b3(n,{status:"error",bg:n.colorErrorBg,hoverBg:n.colorErrorBgHover,activeBorderColor:n.colorError,color:n.colorError})),b3(n,{status:"warning",bg:n.colorWarningBg,hoverBg:n.colorWarningBgHover,activeBorderColor:n.colorWarning,color:n.colorWarning})),{[`&${n.componentCls}-disabled`]:{[`&:not(${n.componentCls}-customize-input) ${n.componentCls}-selector`]:{borderColor:n.colorBorder,background:n.colorBgContainerDisabled,color:n.colorTextDisabled}},[`&${n.componentCls}-multiple ${n.componentCls}-selection-item`]:{background:n.colorBgContainer,border:`${st(n.lineWidth)} ${n.lineType} ${n.colorSplit}`}})}),Age=n=>({"&-borderless":{[`${n.componentCls}-selector`]:{background:"transparent",border:`${st(n.lineWidth)} ${n.lineType} transparent`},[`&${n.componentCls}-disabled`]:{[`&:not(${n.componentCls}-customize-input) ${n.componentCls}-selector`]:{color:n.colorTextDisabled}},[`&${n.componentCls}-multiple ${n.componentCls}-selection-item`]:{background:n.multipleItemBg,border:`${st(n.lineWidth)} ${n.lineType} ${n.multipleItemBorderColor}`},[`&${n.componentCls}-status-error`]:{[`${n.componentCls}-prefix, ${n.componentCls}-selection-item`]:{color:n.colorError}},[`&${n.componentCls}-status-warning`]:{[`${n.componentCls}-prefix, ${n.componentCls}-selection-item`]:{color:n.colorWarning}}}}),Kz=(n,e)=>{const{componentCls:t,antCls:i}=n;return{[`&:not(${t}-customize-input) ${t}-selector`]:{borderWidth:`0 0 ${st(n.lineWidth)} 0`,borderStyle:`none none ${n.lineType} none`,borderColor:e.borderColor,background:n.selectorBg,borderRadius:0},[`&:not(${t}-disabled):not(${t}-customize-input):not(${i}-pagination-size-changer)`]:{[`&:hover ${t}-selector`]:{borderColor:e.hoverBorderHover},[`${t}-focused& ${t}-selector`]:{borderColor:e.activeBorderColor,outline:0},[`${t}-prefix`]:{color:e.color}}}},v3=(n,e)=>({[`&${n.componentCls}-status-${e.status}`]:Object.assign({},Kz(n,e))}),mge=n=>({"&-underlined":Object.assign(Object.assign(Object.assign(Object.assign({},Kz(n,{borderColor:n.colorBorder,hoverBorderHover:n.hoverBorderColor,activeBorderColor:n.activeBorderColor,activeOutlineColor:n.activeOutlineColor,color:n.colorText})),v3(n,{status:"error",borderColor:n.colorError,hoverBorderHover:n.colorErrorHover,activeBorderColor:n.colorError,activeOutlineColor:n.colorErrorOutline,color:n.colorError})),v3(n,{status:"warning",borderColor:n.colorWarning,hoverBorderHover:n.colorWarningHover,activeBorderColor:n.colorWarning,activeOutlineColor:n.colorWarningOutline,color:n.colorWarning})),{[`&${n.componentCls}-disabled`]:{[`&:not(${n.componentCls}-customize-input) ${n.componentCls}-selector`]:{color:n.colorTextDisabled}},[`&${n.componentCls}-multiple ${n.componentCls}-selection-item`]:{background:n.multipleItemBg,border:`${st(n.lineWidth)} ${n.lineType} ${n.multipleItemBorderColor}`}})}),pge=n=>({[n.componentCls]:Object.assign(Object.assign(Object.assign(Object.assign({},hge(n)),fge(n)),Age(n)),mge(n))}),bge=n=>{const{componentCls:e}=n;return{position:"relative",transition:`all ${n.motionDurationMid} ${n.motionEaseInOut}`,input:{cursor:"pointer"},[`${e}-show-search&`]:{cursor:"text",input:{cursor:"auto",color:"inherit",height:"100%"}},[`${e}-disabled&`]:{cursor:"not-allowed",input:{cursor:"not-allowed"}}}},vge=n=>{const{componentCls:e}=n;return{[`${e}-selection-search-input`]:{margin:0,padding:0,background:"transparent",border:"none",outline:"none",appearance:"none",fontFamily:"inherit","&::-webkit-search-cancel-button":{display:"none",appearance:"none"}}}},yge=n=>{const{antCls:e,componentCls:t,inputPaddingHorizontalBase:i,iconCls:a}=n;return{[t]:Object.assign(Object.assign({},Po(n)),{position:"relative",display:"inline-flex",cursor:"pointer",[`&:not(${t}-customize-input) ${t}-selector`]:Object.assign(Object.assign({},bge(n)),vge(n)),[`${t}-selection-item`]:Object.assign(Object.assign({flex:1,fontWeight:"normal",position:"relative",userSelect:"none"},Tf),{[`> ${e}-typography`]:{display:"inline"}}),[`${t}-selection-placeholder`]:Object.assign(Object.assign({},Tf),{flex:1,color:n.colorTextPlaceholder,pointerEvents:"none"}),[`${t}-arrow`]:Object.assign(Object.assign({},nS()),{position:"absolute",top:"50%",insetInlineStart:"auto",insetInlineEnd:i,height:n.fontSizeIcon,marginTop:n.calc(n.fontSizeIcon).mul(-1).div(2).equal(),color:n.colorTextQuaternary,fontSize:n.fontSizeIcon,lineHeight:1,textAlign:"center",pointerEvents:"none",display:"flex",alignItems:"center",transition:`opacity ${n.motionDurationSlow} ease`,[a]:{verticalAlign:"top",transition:`transform ${n.motionDurationSlow}`,"> svg":{verticalAlign:"top"},[`&:not(${t}-suffix)`]:{pointerEvents:"auto"}},[`${t}-disabled &`]:{cursor:"not-allowed"},"> *:not(:last-child)":{marginInlineEnd:8}}),[`${t}-selection-wrap`]:{display:"flex",width:"100%",position:"relative",minWidth:0,"&:after":{content:'"\\a0"',width:0,overflow:"hidden"}},[`${t}-prefix`]:{flex:"none",marginInlineEnd:n.selectAffixPadding},[`${t}-clear`]:{position:"absolute",top:"50%",insetInlineStart:"auto",insetInlineEnd:i,zIndex:1,display:"inline-block",width:n.fontSizeIcon,height:n.fontSizeIcon,marginTop:n.calc(n.fontSizeIcon).mul(-1).div(2).equal(),color:n.colorTextQuaternary,fontSize:n.fontSizeIcon,fontStyle:"normal",lineHeight:1,textAlign:"center",textTransform:"none",cursor:"pointer",opacity:0,transition:`color ${n.motionDurationMid} ease, opacity ${n.motionDurationSlow} ease`,textRendering:"auto","&:before":{display:"block"},"&:hover":{color:n.colorTextTertiary}},[`&:hover ${t}-clear`]:{opacity:1,background:n.colorBgBase,borderRadius:"50%"}}),[`${t}-status`]:{"&-error, &-warning, &-success, &-validating":{[`&${t}-has-feedback`]:{[`${t}-clear`]:{insetInlineEnd:n.calc(i).add(n.fontSize).add(n.paddingXS).equal()}}}}}},Bge=n=>{const{componentCls:e}=n;return[{[e]:{[`&${e}-in-form-item`]:{width:"100%"}}},yge(n),Cge(n),dge(n),sge(n),{[`${e}-rtl`]:{direction:"rtl"}},BM(n,{borderElCls:`${e}-selector`,focusElCls:`${e}-focused`})]},Gge=Oa("Select",(n,e)=>{let{rootPrefixCls:t}=e;const i=Xi(n,{rootPrefixCls:t,inputPaddingHorizontalBase:n.calc(n.paddingSM).sub(1).equal(),multipleSelectItemHeight:n.multipleItemHeight,selectHeight:n.controlHeight});return[Bge(i),pge(i)]},Ige,{unitless:{optionLineHeight:!0,optionSelectedFontWeight:!0}});var Sge={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M912 190h-69.9c-9.8 0-19.1 4.5-25.1 12.2L404.7 724.5 207 474a32 32 0 00-25.1-12.2H112c-6.7 0-10.4 7.7-6.3 12.9l273.9 347c12.8 16.2 37.4 16.2 50.3 0l488.4-618.9c4.1-5.1.4-12.8-6.3-12.8z"}}]},name:"check",theme:"outlined"},wge=function(e,t){return v.createElement(io,$t({},e,{ref:t,icon:Sge}))},Lz=v.forwardRef(wge),Rge={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2 227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z"}}]},name:"down",theme:"outlined"},Zge=function(e,t){return v.createElement(io,$t({},e,{ref:t,icon:Rge}))},xge=v.forwardRef(Zge),_z={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M909.6 854.5L649.9 594.8C690.2 542.7 712 479 712 412c0-80.2-31.3-155.4-87.9-212.1-56.6-56.7-132-87.9-212.1-87.9s-155.5 31.3-212.1 87.9C143.2 256.5 112 331.8 112 412c0 80.1 31.3 155.5 87.9 212.1C256.5 680.8 331.8 712 412 712c67 0 130.6-21.8 182.7-62l259.7 259.6a8.2 8.2 0 0011.6 0l43.6-43.5a8.2 8.2 0 000-11.6zM570.4 570.4C528 612.7 471.8 636 412 636s-116-23.3-158.4-65.6C211.3 528 188 471.8 188 412s23.3-116.1 65.6-158.4C296 211.3 352.2 188 412 188s116.1 23.2 158.4 65.6S636 352.2 636 412s-23.3 116.1-65.6 158.4z"}}]},name:"search",theme:"outlined"},Mge=function(e,t){return v.createElement(io,$t({},e,{ref:t,icon:_z}))},Dz=v.forwardRef(Mge);function Wge(n){let{suffixIcon:e,clearIcon:t,menuItemSelectedIcon:i,removeIcon:a,loading:o,multiple:r,hasFeedback:s,prefixCls:l,showSuffixIcon:c,feedbackIcon:u,showArrow:C,componentName:h}=n;const m=t??v.createElement(qY,null),p=S=>e===null&&!s&&!C?null:v.createElement(v.Fragment,null,c!==!1&&S,s&&u);let B=null;if(e!==void 0)B=p(e);else if(o)B=p(v.createElement(AM,{spin:!0}));else{const S=`${l}-suffix`;B=R=>{let{open:Z,showSearch:x}=R;return p(Z&&x?v.createElement(Dz,{className:S}):v.createElement(xge,{className:S}))}}let b=null;i!==void 0?b=i:r?b=v.createElement(Lz,null):b=null;let y=null;return a!==void 0?y=a:y=v.createElement($Y,null),{clearIcon:m,suffixIcon:B,itemIcon:b,removeIcon:y}}function Vge(n,e){return e!==void 0?e:n!==null}var Nge=function(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(n);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(n,i[a])&&(t[i[a]]=n[i[a]]);return t};const Oz="SECRET_COMBOBOX_MODE_DO_NOT_USE",Ege=(n,e)=>{var t;const{prefixCls:i,bordered:a,className:o,rootClassName:r,getPopupContainer:s,popupClassName:l,dropdownClassName:c,listHeight:u=256,placement:C,listItemHeight:h,size:m,disabled:p,notFoundContent:B,status:b,builtinPlacements:y,dropdownMatchSelectWidth:S,popupMatchSelectWidth:R,direction:Z,style:x,allowClear:M,variant:E,dropdownStyle:F,transitionName:N,tagRender:H,maxCount:z,prefix:_}=n,D=Nge(n,["prefixCls","bordered","className","rootClassName","getPopupContainer","popupClassName","dropdownClassName","listHeight","placement","listItemHeight","size","disabled","notFoundContent","status","builtinPlacements","dropdownMatchSelectWidth","popupMatchSelectWidth","direction","style","allowClear","variant","dropdownStyle","transitionName","tagRender","maxCount","prefix"]),{getPopupContainer:P,getPrefixCls:$,renderEmpty:X,direction:L,virtual:U,popupMatchSelectWidth:q,popupOverflow:K}=v.useContext(ui),O=Gs("select"),[,j]=ks(),ne=h??(j==null?void 0:j.controlHeight),k=$("select",i),ie=$(),re=Z??L,{compactSize:ge,compactItemClassnames:de}=Bb(k,re),[xe,Ne]=fS("select",E,a),ye=tA(k),[pe,Te,le]=Gge(k,ye),Ye=v.useMemo(()=>{const{mode:ht}=n;if(ht!=="combobox")return ht===Oz?"combobox":ht},[n.mode]),he=Ye==="multiple"||Ye==="tags",Ge=Vge(n.suffixIcon,n.showArrow),be=(t=R??S)!==null&&t!==void 0?t:q,{status:Ee,hasFeedback:Se,isFormItemInput:ee,feedbackIcon:Q}=v.useContext(Ag),ce=hS(Ee,b);let me;B!==void 0?me=B:Ye==="combobox"?me=null:me=(X==null?void 0:X("Select"))||v.createElement(Tz,{componentName:"Select"});const{suffixIcon:Ze,itemIcon:Xe,removeIcon:De,clearIcon:Oe}=Wge(Object.assign(Object.assign({},D),{multiple:he,hasFeedback:Se,feedbackIcon:Q,showSuffixIcon:Ge,prefixCls:k,componentName:"Select"})),Je=M===!0?{clearIcon:Oe}:M,At=Ss(D,["suffixIcon","itemIcon"]),qe=gt(l||c,{[`${k}-dropdown-${re}`]:re==="rtl"},r,le,ye,Te),lt=Sl(ht=>{var we;return(we=m??ge)!==null&&we!==void 0?we:ht}),$e=v.useContext(hg),je=p??$e,ke=gt({[`${k}-lg`]:lt==="large",[`${k}-sm`]:lt==="small",[`${k}-rtl`]:re==="rtl",[`${k}-${xe}`]:Ne,[`${k}-in-form-item`]:ee},jB(k,ce,Se),de,O.className,o,r,le,ye,Te),Ce=v.useMemo(()=>C!==void 0?C:re==="rtl"?"bottomRight":"bottomLeft",[C,re]),[He]=iz("SelectLike",F==null?void 0:F.zIndex);return pe(v.createElement(MM,Object.assign({ref:e,virtual:U,showSearch:O.showSearch},At,{style:Object.assign(Object.assign({},O.style),x),dropdownMatchSelectWidth:be,transitionName:mM(ie,"slide-up",N),builtinPlacements:rge(y,K),listHeight:u,listItemHeight:ne,mode:Ye,prefixCls:k,placement:Ce,direction:re,prefix:_,suffixIcon:Ze,menuItemSelectedIcon:Xe,removeIcon:De,allowClear:Je,notFoundContent:me,className:ke,getPopupContainer:s||P,dropdownClassName:qe,disabled:je,dropdownStyle:Object.assign(Object.assign({},F),{zIndex:He}),maxCount:he?z:void 0,tagRender:he?H:void 0})))},xd=v.forwardRef(Ege),Hge=Ble(xd,"dropdownAlign");xd.SECRET_COMBOBOX_MODE_DO_NOT_USE=Oz;xd.Option=xM;xd.OptGroup=ZM;xd._InternalPanelDoNotUseOrYouWillBeFired=Hge;const fI=["xxl","xl","lg","md","sm","xs"],Fge=n=>({xs:`(max-width: ${n.screenXSMax}px)`,sm:`(min-width: ${n.screenSM}px)`,md:`(min-width: ${n.screenMD}px)`,lg:`(min-width: ${n.screenLG}px)`,xl:`(min-width: ${n.screenXL}px)`,xxl:`(min-width: ${n.screenXXL}px)`}),Xge=n=>{const e=n,t=[].concat(fI).reverse();return t.forEach((i,a)=>{const o=i.toUpperCase(),r=`screen${o}Min`,s=`screen${o}`;if(!(e[r]<=e[s]))throw new Error(`${r}<=${s} fails : !(${e[r]}<=${e[s]})`);if(a<t.length-1){const l=`screen${o}Max`;if(!(e[s]<=e[l]))throw new Error(`${s}<=${l} fails : !(${e[s]}<=${e[l]})`);const u=`screen${t[a+1].toUpperCase()}Min`;if(!(e[l]<=e[u]))throw new Error(`${l}<=${u} fails : !(${e[l]}<=${e[u]})`)}}),n},Tge=()=>{const[,n]=ks(),e=Fge(Xge(n));return Ct.useMemo(()=>{const t=new Map;let i=-1,a={};return{responsiveMap:e,matchHandlers:{},dispatch(o){return a=o,t.forEach(r=>r(a)),t.size>=1},subscribe(o){return t.size||this.register(),i+=1,t.set(i,o),o(a),i},unsubscribe(o){t.delete(o),t.size||this.unregister()},register(){Object.keys(e).forEach(o=>{const r=e[o],s=c=>{let{matches:u}=c;this.dispatch(Object.assign(Object.assign({},a),{[o]:u}))},l=window.matchMedia(r);l.addListener(s),this.matchHandlers[r]={mql:l,listener:s},s(l)})},unregister(){Object.keys(e).forEach(o=>{const r=e[o],s=this.matchHandlers[r];s==null||s.mql.removeListener(s==null?void 0:s.listener)}),t.clear()}}},[n])};function Yge(){const[,n]=v.useReducer(e=>e+1,0);return n}function WM(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const t=v.useRef(e),i=Yge(),a=Tge();return xi(()=>{const o=a.subscribe(r=>{t.current=r,n&&i()});return()=>a.unsubscribe(o)},[]),t.current}function Uz(n){var e=n.children,t=n.prefixCls,i=n.id,a=n.overlayInnerStyle,o=n.bodyClassName,r=n.className,s=n.style;return v.createElement("div",{className:gt("".concat(t,"-content"),r),style:s},v.createElement("div",{className:gt("".concat(t,"-inner"),o),id:i,role:"tooltip",style:a},typeof e=="function"?e():e))}var jh={shiftX:64,adjustY:1},Qh={adjustX:1,shiftY:!0},fl=[0,0],zge={left:{points:["cr","cl"],overflow:Qh,offset:[-4,0],targetOffset:fl},right:{points:["cl","cr"],overflow:Qh,offset:[4,0],targetOffset:fl},top:{points:["bc","tc"],overflow:jh,offset:[0,-4],targetOffset:fl},bottom:{points:["tc","bc"],overflow:jh,offset:[0,4],targetOffset:fl},topLeft:{points:["bl","tl"],overflow:jh,offset:[0,-4],targetOffset:fl},leftTop:{points:["tr","tl"],overflow:Qh,offset:[-4,0],targetOffset:fl},topRight:{points:["br","tr"],overflow:jh,offset:[0,-4],targetOffset:fl},rightTop:{points:["tl","tr"],overflow:Qh,offset:[4,0],targetOffset:fl},bottomRight:{points:["tr","br"],overflow:jh,offset:[0,4],targetOffset:fl},rightBottom:{points:["bl","br"],overflow:Qh,offset:[4,0],targetOffset:fl},bottomLeft:{points:["tl","bl"],overflow:jh,offset:[0,4],targetOffset:fl},leftBottom:{points:["br","bl"],overflow:Qh,offset:[-4,0],targetOffset:fl}},Kge=["overlayClassName","trigger","mouseEnterDelay","mouseLeaveDelay","overlayStyle","prefixCls","children","onVisibleChange","afterVisibleChange","transitionName","animation","motion","placement","align","destroyTooltipOnHide","defaultVisible","getTooltipContainer","overlayInnerStyle","arrowContent","overlay","id","showArrow","classNames","styles"],Lge=function(e,t){var i=e.overlayClassName,a=e.trigger,o=a===void 0?["hover"]:a,r=e.mouseEnterDelay,s=r===void 0?0:r,l=e.mouseLeaveDelay,c=l===void 0?.1:l,u=e.overlayStyle,C=e.prefixCls,h=C===void 0?"rc-tooltip":C,m=e.children,p=e.onVisibleChange,B=e.afterVisibleChange,b=e.transitionName,y=e.animation,S=e.motion,R=e.placement,Z=R===void 0?"right":R,x=e.align,M=x===void 0?{}:x,E=e.destroyTooltipOnHide,F=E===void 0?!1:E,N=e.defaultVisible,H=e.getTooltipContainer,z=e.overlayInnerStyle;e.arrowContent;var _=e.overlay,D=e.id,P=e.showArrow,$=P===void 0?!0:P,X=e.classNames,L=e.styles,U=_n(e,Kge),q=GM(D),K=v.useRef(null);v.useImperativeHandle(t,function(){return K.current});var O=Ke({},U);"visible"in e&&(O.popupVisible=e.visible);var j=function(){return v.createElement(Uz,{key:"content",prefixCls:h,id:q,bodyClassName:X==null?void 0:X.body,overlayInnerStyle:Ke(Ke({},z),L==null?void 0:L.body)},_)},ne=function(){var ie=v.Children.only(m),re=(ie==null?void 0:ie.props)||{},ge=Ke(Ke({},re),{},{"aria-describedby":_?q:null});return v.cloneElement(m,ge)};return v.createElement(IS,$t({popupClassName:gt(i,X==null?void 0:X.root),prefixCls:h,popup:j,action:o,builtinPlacements:zge,popupPlacement:Z,ref:K,popupAlign:M,getPopupContainer:H,onPopupVisibleChange:p,afterPopupVisibleChange:B,popupTransitionName:b,popupAnimation:y,popupMotion:S,defaultPopupVisible:N,autoDestroy:F,mouseLeaveDelay:c,popupStyle:Ke(Ke({},u),L==null?void 0:L.root),mouseEnterDelay:s,arrow:$},O),ne())};const _ge=v.forwardRef(Lge);function Dge(n){const{sizePopupArrow:e,borderRadiusXS:t,borderRadiusOuter:i}=n,a=e/2,o=0,r=a,s=i*1/Math.sqrt(2),l=a-i*(1-1/Math.sqrt(2)),c=a-t*(1/Math.sqrt(2)),u=i*(Math.sqrt(2)-1)+t*(1/Math.sqrt(2)),C=2*a-c,h=u,m=2*a-s,p=l,B=2*a-o,b=r,y=a*Math.sqrt(2)+i*(Math.sqrt(2)-2),S=i*(Math.sqrt(2)-1),R=`polygon(${S}px 100%, 50% ${S}px, ${2*a-S}px 100%, ${S}px 100%)`,Z=`path('M ${o} ${r} A ${i} ${i} 0 0 0 ${s} ${l} L ${c} ${u} A ${t} ${t} 0 0 1 ${C} ${h} L ${m} ${p} A ${i} ${i} 0 0 0 ${B} ${b} Z')`;return{arrowShadowWidth:y,arrowPath:Z,arrowPolygon:R}}const Oge=(n,e,t)=>{const{sizePopupArrow:i,arrowPolygon:a,arrowPath:o,arrowShadowWidth:r,borderRadiusXS:s,calc:l}=n;return{pointerEvents:"none",width:i,height:i,overflow:"hidden","&::before":{position:"absolute",bottom:0,insetInlineStart:0,width:i,height:l(i).div(2).equal(),background:e,clipPath:{_multi_value_:!0,value:[a,o]},content:'""'},"&::after":{content:'""',position:"absolute",width:r,height:r,bottom:0,insetInline:0,margin:"auto",borderRadius:{_skip_check_:!0,value:`0 0 ${st(s)} 0`},transform:"translateY(50%) rotate(-135deg)",boxShadow:t,zIndex:0,background:"transparent"}}},kz=8;function Pz(n){const{contentRadius:e,limitVerticalRadius:t}=n,i=e>12?e+2:12;return{arrowOffsetHorizontal:i,arrowOffsetVertical:t?kz:i}}function oy(n,e){return n?e:{}}function Uge(n,e,t){const{componentCls:i,boxShadowPopoverArrow:a,arrowOffsetVertical:o,arrowOffsetHorizontal:r}=n,{arrowDistance:s=0,arrowPlacement:l={left:!0,right:!0,top:!0,bottom:!0}}={};return{[i]:Object.assign(Object.assign(Object.assign(Object.assign({[`${i}-arrow`]:[Object.assign(Object.assign({position:"absolute",zIndex:1,display:"block"},Oge(n,e,a)),{"&:before":{background:e}})]},oy(!!l.top,{[[`&-placement-top > ${i}-arrow`,`&-placement-topLeft > ${i}-arrow`,`&-placement-topRight > ${i}-arrow`].join(",")]:{bottom:s,transform:"translateY(100%) rotate(180deg)"},[`&-placement-top > ${i}-arrow`]:{left:{_skip_check_:!0,value:"50%"},transform:"translateX(-50%) translateY(100%) rotate(180deg)"},"&-placement-topLeft":{"--arrow-offset-horizontal":r,[`> ${i}-arrow`]:{left:{_skip_check_:!0,value:r}}},"&-placement-topRight":{"--arrow-offset-horizontal":`calc(100% - ${st(r)})`,[`> ${i}-arrow`]:{right:{_skip_check_:!0,value:r}}}})),oy(!!l.bottom,{[[`&-placement-bottom > ${i}-arrow`,`&-placement-bottomLeft > ${i}-arrow`,`&-placement-bottomRight > ${i}-arrow`].join(",")]:{top:s,transform:"translateY(-100%)"},[`&-placement-bottom > ${i}-arrow`]:{left:{_skip_check_:!0,value:"50%"},transform:"translateX(-50%) translateY(-100%)"},"&-placement-bottomLeft":{"--arrow-offset-horizontal":r,[`> ${i}-arrow`]:{left:{_skip_check_:!0,value:r}}},"&-placement-bottomRight":{"--arrow-offset-horizontal":`calc(100% - ${st(r)})`,[`> ${i}-arrow`]:{right:{_skip_check_:!0,value:r}}}})),oy(!!l.left,{[[`&-placement-left > ${i}-arrow`,`&-placement-leftTop > ${i}-arrow`,`&-placement-leftBottom > ${i}-arrow`].join(",")]:{right:{_skip_check_:!0,value:s},transform:"translateX(100%) rotate(90deg)"},[`&-placement-left > ${i}-arrow`]:{top:{_skip_check_:!0,value:"50%"},transform:"translateY(-50%) translateX(100%) rotate(90deg)"},[`&-placement-leftTop > ${i}-arrow`]:{top:o},[`&-placement-leftBottom > ${i}-arrow`]:{bottom:o}})),oy(!!l.right,{[[`&-placement-right > ${i}-arrow`,`&-placement-rightTop > ${i}-arrow`,`&-placement-rightBottom > ${i}-arrow`].join(",")]:{left:{_skip_check_:!0,value:s},transform:"translateX(-100%) rotate(-90deg)"},[`&-placement-right > ${i}-arrow`]:{top:{_skip_check_:!0,value:"50%"},transform:"translateY(-50%) translateX(-100%) rotate(-90deg)"},[`&-placement-rightTop > ${i}-arrow`]:{top:o},[`&-placement-rightBottom > ${i}-arrow`]:{bottom:o}}))}}function kge(n,e,t,i){if(i===!1)return{adjustX:!1,adjustY:!1};const a=i&&typeof i=="object"?i:{},o={};switch(n){case"top":case"bottom":o.shiftX=e.arrowOffsetHorizontal*2+t,o.shiftY=!0,o.adjustY=!0;break;case"left":case"right":o.shiftY=e.arrowOffsetVertical*2+t,o.shiftX=!0,o.adjustX=!0;break}const r=Object.assign(Object.assign({},o),a);return r.shiftX||(r.adjustX=!0),r.shiftY||(r.adjustY=!0),r}const y3={left:{points:["cr","cl"]},right:{points:["cl","cr"]},top:{points:["bc","tc"]},bottom:{points:["tc","bc"]},topLeft:{points:["bl","tl"]},leftTop:{points:["tr","tl"]},topRight:{points:["br","tr"]},rightTop:{points:["tl","tr"]},bottomRight:{points:["tr","br"]},rightBottom:{points:["bl","br"]},bottomLeft:{points:["tl","bl"]},leftBottom:{points:["br","bl"]}},Pge={topLeft:{points:["bl","tc"]},leftTop:{points:["tr","cl"]},topRight:{points:["br","tc"]},rightTop:{points:["tl","cr"]},bottomRight:{points:["tr","bc"]},rightBottom:{points:["bl","cr"]},bottomLeft:{points:["tl","bc"]},leftBottom:{points:["br","cl"]}},Jge=new Set(["topLeft","topRight","bottomLeft","bottomRight","leftTop","leftBottom","rightTop","rightBottom"]);function jge(n){const{arrowWidth:e,autoAdjustOverflow:t,arrowPointAtCenter:i,offset:a,borderRadius:o}=n,r=e/2,s={};return Object.keys(y3).forEach(l=>{const c=i&&Pge[l]||y3[l],u=Object.assign(Object.assign({},c),{offset:[0,0],dynamicInset:!0});switch(s[l]=u,Jge.has(l)&&(u.autoArrow=!1),l){case"top":case"topLeft":case"topRight":u.offset[1]=-r-a;break;case"bottom":case"bottomLeft":case"bottomRight":u.offset[1]=r+a;break;case"left":case"leftTop":case"leftBottom":u.offset[0]=-r-a;break;case"right":case"rightTop":case"rightBottom":u.offset[0]=r+a;break}const C=Pz({contentRadius:o,limitVerticalRadius:!0});if(i)switch(l){case"topLeft":case"bottomLeft":u.offset[0]=-C.arrowOffsetHorizontal-r;break;case"topRight":case"bottomRight":u.offset[0]=C.arrowOffsetHorizontal+r;break;case"leftTop":case"rightTop":u.offset[1]=-C.arrowOffsetHorizontal*2+r;break;case"leftBottom":case"rightBottom":u.offset[1]=C.arrowOffsetHorizontal*2-r;break}u.overflow=kge(l,C,e,t),u.htmlRegion="visibleFirst"}),s}const Qge=n=>{const{calc:e,componentCls:t,tooltipMaxWidth:i,tooltipColor:a,tooltipBg:o,tooltipBorderRadius:r,zIndexPopup:s,controlHeight:l,boxShadowSecondary:c,paddingSM:u,paddingXS:C,arrowOffsetHorizontal:h,sizePopupArrow:m}=n,p=e(r).add(m).add(h).equal(),B=e(r).mul(2).add(m).equal();return[{[t]:Object.assign(Object.assign(Object.assign(Object.assign({},Po(n)),{position:"absolute",zIndex:s,display:"block",width:"max-content",maxWidth:i,visibility:"visible","--valid-offset-x":"var(--arrow-offset-horizontal, var(--arrow-x))",transformOrigin:["var(--valid-offset-x, 50%)","var(--arrow-y, 50%)"].join(" "),"&-hidden":{display:"none"},"--antd-arrow-background-color":o,[`${t}-inner`]:{minWidth:B,minHeight:l,padding:`${st(n.calc(u).div(2).equal())} ${st(C)}`,color:a,textAlign:"start",textDecoration:"none",wordWrap:"break-word",backgroundColor:o,borderRadius:r,boxShadow:c,boxSizing:"border-box"},[["&-placement-topLeft","&-placement-topRight","&-placement-bottomLeft","&-placement-bottomRight"].join(",")]:{minWidth:p},[["&-placement-left","&-placement-leftTop","&-placement-leftBottom","&-placement-right","&-placement-rightTop","&-placement-rightBottom"].join(",")]:{[`${t}-inner`]:{borderRadius:n.min(r,kz)}},[`${t}-content`]:{position:"relative"}}),kie(n,(b,y)=>{let{darkColor:S}=y;return{[`&${t}-${b}`]:{[`${t}-inner`]:{backgroundColor:S},[`${t}-arrow`]:{"--antd-arrow-background-color":S}}}})),{"&-rtl":{direction:"rtl"}})},Uge(n,"var(--antd-arrow-background-color)"),{[`${t}-pure`]:{position:"relative",maxWidth:"none",margin:n.sizePopupArrow}}]},qge=n=>Object.assign(Object.assign({zIndexPopup:n.zIndexPopupBase+70},Pz({contentRadius:n.borderRadius,limitVerticalRadius:!0})),Dge(Xi(n,{borderRadiusOuter:Math.min(n.borderRadiusOuter,4)}))),Jz=function(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return Oa("Tooltip",i=>{const{borderRadius:a,colorTextLightSolid:o,colorBgSpotlight:r}=i,s=Xi(i,{tooltipMaxWidth:250,tooltipColor:o,tooltipBorderRadius:a,tooltipBg:r});return[Qge(s),gre(i,"zoom-big-fast")]},qge,{resetStyle:!1,injectStyle:e})(n)},$ge=CI.map(n=>`${n}-inverse`);function eue(n){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)?[].concat(an($ge),an(CI)).includes(n):CI.includes(n)}function jz(n,e){const t=eue(e),i=gt({[`${n}-${e}`]:e&&t}),a={},o={};return e&&!t&&(a.background=e,o["--antd-arrow-background-color"]=e),{className:i,overlayStyle:a,arrowStyle:o}}const tue=n=>{const{prefixCls:e,className:t,placement:i="top",title:a,color:o,overlayInnerStyle:r}=n,{getPrefixCls:s}=v.useContext(ui),l=s("tooltip",e),[c,u,C]=Jz(l),h=jz(l,o),m=h.arrowStyle,p=Object.assign(Object.assign({},r),h.overlayStyle),B=gt(u,C,l,`${l}-pure`,`${l}-placement-${i}`,t,h.className);return c(v.createElement("div",{className:B,style:m},v.createElement("div",{className:`${l}-arrow`}),v.createElement(Uz,Object.assign({},n,{className:u,prefixCls:l,overlayInnerStyle:p}),a)))};var nue=function(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(n);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(n,i[a])&&(t[i[a]]=n[i[a]]);return t};const iue=v.forwardRef((n,e)=>{var t,i;const{prefixCls:a,openClassName:o,getTooltipContainer:r,color:s,overlayInnerStyle:l,children:c,afterOpenChange:u,afterVisibleChange:C,destroyTooltipOnHide:h,arrow:m=!0,title:p,overlay:B,builtinPlacements:b,arrowPointAtCenter:y=!1,autoAdjustOverflow:S=!0,motion:R,getPopupContainer:Z,placement:x="top",mouseEnterDelay:M=.1,mouseLeaveDelay:E=.1,overlayStyle:F,rootClassName:N,overlayClassName:H,styles:z,classNames:_}=n,D=nue(n,["prefixCls","openClassName","getTooltipContainer","color","overlayInnerStyle","children","afterOpenChange","afterVisibleChange","destroyTooltipOnHide","arrow","title","overlay","builtinPlacements","arrowPointAtCenter","autoAdjustOverflow","motion","getPopupContainer","placement","mouseEnterDelay","mouseLeaveDelay","overlayStyle","rootClassName","overlayClassName","styles","classNames"]),P=!!m,[,$]=ks(),{getPopupContainer:X,getPrefixCls:L,direction:U,className:q,style:K,classNames:O,styles:j}=Gs("tooltip"),ne=pY(),k=v.useRef(null),ie=()=>{var At;(At=k.current)===null||At===void 0||At.forceAlign()};v.useImperativeHandle(e,()=>{var At,qe;return{forceAlign:ie,forcePopupAlign:()=>{ne.deprecated(!1,"forcePopupAlign","forceAlign"),ie()},nativeElement:(At=k.current)===null||At===void 0?void 0:At.nativeElement,popupElement:(qe=k.current)===null||qe===void 0?void 0:qe.popupElement}});const[re,ge]=_a(!1,{value:(t=n.open)!==null&&t!==void 0?t:n.visible,defaultValue:(i=n.defaultOpen)!==null&&i!==void 0?i:n.defaultVisible}),de=!p&&!B&&p!==0,xe=At=>{var qe,lt;ge(de?!1:At),de||((qe=n.onOpenChange)===null||qe===void 0||qe.call(n,At),(lt=n.onVisibleChange)===null||lt===void 0||lt.call(n,At))},Ne=v.useMemo(()=>{var At,qe;let lt=y;return typeof m=="object"&&(lt=(qe=(At=m.pointAtCenter)!==null&&At!==void 0?At:m.arrowPointAtCenter)!==null&&qe!==void 0?qe:y),b||jge({arrowPointAtCenter:lt,autoAdjustOverflow:S,arrowWidth:P?$.sizePopupArrow:0,borderRadius:$.borderRadius,offset:$.marginXXS})},[y,m,b,$]),ye=v.useMemo(()=>p===0?p:B||p||"",[B,p]),pe=v.createElement(sZ,{space:!0},typeof ye=="function"?ye():ye),Te=L("tooltip",a),le=L(),Ye=n["data-popover-inject"];let he=re;!("open"in n)&&!("visible"in n)&&de&&(he=!1);const Ge=v.isValidElement(c)&&!ez(c)?c:v.createElement("span",null,c),be=Ge.props,Ee=!be.className||typeof be.className=="string"?gt(be.className,o||`${Te}-open`):be.className,[Se,ee,Q]=Jz(Te,!Ye),ce=jz(Te,s),me=ce.arrowStyle,Ze=gt(H,{[`${Te}-rtl`]:U==="rtl"},ce.className,N,ee,Q,q,O.root,_==null?void 0:_.root),Xe=gt(O.body,_==null?void 0:_.body),[De,Oe]=iz("Tooltip",D.zIndex),Je=v.createElement(_ge,Object.assign({},D,{zIndex:De,showArrow:P,placement:x,mouseEnterDelay:M,mouseLeaveDelay:E,prefixCls:Te,classNames:{root:Ze,body:Xe},styles:{root:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},me),j.root),K),F),z==null?void 0:z.root),body:Object.assign(Object.assign(Object.assign(Object.assign({},j.body),l),z==null?void 0:z.body),ce.overlayStyle)},getTooltipContainer:Z||r||X,ref:k,builtinPlacements:Ne,overlay:pe,visible:he,onVisibleChange:xe,afterVisibleChange:u??C,arrowContent:v.createElement("span",{className:`${Te}-arrow-content`}),motion:{motionName:mM(le,"zoom-big-fast",n.transitionName),motionDeadline:1e3},destroyTooltipOnHide:!!h}),he?Bd(Ge,{className:Ee}):Ge);return Se(v.createElement(tz.Provider,{value:Oe},Je))}),AI=iue;AI._InternalPanelDoNotUseOrYouWillBeFired=tue;var aue={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M724 218.3V141c0-6.7-7.7-10.4-12.9-6.3L260.3 486.8a31.86 31.86 0 000 50.3l450.8 352.1c5.3 4.1 12.9.4 12.9-6.3v-77.3c0-4.9-2.3-9.6-6.1-12.6l-360-281 360-281.1c3.8-3 6.1-7.7 6.1-12.6z"}}]},name:"left",theme:"outlined"},oue=function(e,t){return v.createElement(io,$t({},e,{ref:t,icon:aue}))},B3=v.forwardRef(oue),rue=tn.ESC,sue=tn.TAB;function lue(n){var e=n.visible,t=n.triggerRef,i=n.onVisibleChange,a=n.autoFocus,o=n.overlayRef,r=v.useRef(!1),s=function(){if(e){var C,h;(C=t.current)===null||C===void 0||(h=C.focus)===null||h===void 0||h.call(C),i==null||i(!1)}},l=function(){var C;return(C=o.current)!==null&&C!==void 0&&C.focus?(o.current.focus(),r.current=!0,!0):!1},c=function(C){switch(C.keyCode){case rue:s();break;case sue:{var h=!1;r.current||(h=l()),h?C.preventDefault():s();break}}};v.useEffect(function(){return e?(window.addEventListener("keydown",c),a&&mi(l,3),function(){window.removeEventListener("keydown",c),r.current=!1}):function(){r.current=!1}},[e])}var cue=v.forwardRef(function(n,e){var t=n.overlay,i=n.arrow,a=n.prefixCls,o=v.useMemo(function(){var s;return typeof t=="function"?s=t():s=t,s},[t]),r=Bs(e,Qf(o));return Ct.createElement(Ct.Fragment,null,i&&Ct.createElement("div",{className:"".concat(a,"-arrow")}),Ct.cloneElement(o,{ref:BI(o)?r:void 0}))}),qh={adjustX:1,adjustY:1},$h=[0,0],gue={topLeft:{points:["bl","tl"],overflow:qh,offset:[0,-4],targetOffset:$h},top:{points:["bc","tc"],overflow:qh,offset:[0,-4],targetOffset:$h},topRight:{points:["br","tr"],overflow:qh,offset:[0,-4],targetOffset:$h},bottomLeft:{points:["tl","bl"],overflow:qh,offset:[0,4],targetOffset:$h},bottom:{points:["tc","bc"],overflow:qh,offset:[0,4],targetOffset:$h},bottomRight:{points:["tr","br"],overflow:qh,offset:[0,4],targetOffset:$h}},uue=["arrow","prefixCls","transitionName","animation","align","placement","placements","getPopupContainer","showAction","hideAction","overlayClassName","overlayStyle","visible","trigger","autoFocus","overlay","children","onVisibleChange"];function due(n,e){var t,i=n.arrow,a=i===void 0?!1:i,o=n.prefixCls,r=o===void 0?"rc-dropdown":o,s=n.transitionName,l=n.animation,c=n.align,u=n.placement,C=u===void 0?"bottomLeft":u,h=n.placements,m=h===void 0?gue:h,p=n.getPopupContainer,B=n.showAction,b=n.hideAction,y=n.overlayClassName,S=n.overlayStyle,R=n.visible,Z=n.trigger,x=Z===void 0?["hover"]:Z,M=n.autoFocus,E=n.overlay,F=n.children,N=n.onVisibleChange,H=_n(n,uue),z=Ct.useState(),_=rt(z,2),D=_[0],P=_[1],$="visible"in n?R:D,X=Ct.useRef(null),L=Ct.useRef(null),U=Ct.useRef(null);Ct.useImperativeHandle(e,function(){return X.current});var q=function(de){P(de),N==null||N(de)};lue({visible:$,triggerRef:U,onVisibleChange:q,autoFocus:M,overlayRef:L});var K=function(de){var xe=n.onOverlayClick;P(!1),xe&&xe(de)},O=function(){return Ct.createElement(cue,{ref:L,overlay:E,prefixCls:r,arrow:a})},j=function(){return typeof E=="function"?O:O()},ne=function(){var de=n.minOverlayWidthMatchTrigger,xe=n.alignPoint;return"minOverlayWidthMatchTrigger"in n?de:!xe},k=function(){var de=n.openClassName;return de!==void 0?de:"".concat(r,"-open")},ie=Ct.cloneElement(F,{className:gt((t=F.props)===null||t===void 0?void 0:t.className,$&&k()),ref:BI(F)?Bs(U,Qf(F)):void 0}),re=b;return!re&&x.indexOf("contextMenu")!==-1&&(re=["click"]),Ct.createElement(IS,$t({builtinPlacements:m},H,{prefixCls:r,ref:X,popupClassName:gt(y,Ve({},"".concat(r,"-show-arrow"),a)),popupStyle:S,action:x,showAction:B,hideAction:re,popupPlacement:C,popupAlign:c,popupTransitionName:s,popupAnimation:l,popupVisible:$,stretch:ne()?"minWidth":"",popup:j(),onPopupVisibleChange:q,onPopupClick:K,getPopupContainer:p}),ie)}const Cue=Ct.forwardRef(due);var Qz=v.createContext(null);function qz(n,e){return n===void 0?null:"".concat(n,"-").concat(e)}function $z(n){var e=v.useContext(Qz);return qz(e,n)}var Iue=["children","locked"],hc=v.createContext(null);function hue(n,e){var t=Ke({},n);return Object.keys(e).forEach(function(i){var a=e[i];a!==void 0&&(t[i]=a)}),t}function kp(n){var e=n.children,t=n.locked,i=_n(n,Iue),a=v.useContext(hc),o=mb(function(){return hue(a,i)},[a,i],function(r,s){return!t&&(r[0]!==s[0]||!Vf(r[1],s[1],!0))});return v.createElement(hc.Provider,{value:o},e)}var fue=[],eK=v.createContext(null);function AS(){return v.useContext(eK)}var tK=v.createContext(fue);function Rb(n){var e=v.useContext(tK);return v.useMemo(function(){return n!==void 0?[].concat(an(e),[n]):e},[e,n])}var nK=v.createContext(null),VM=v.createContext({});function G3(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(pM(n)){var t=n.nodeName.toLowerCase(),i=["input","select","textarea","button"].includes(t)||n.isContentEditable||t==="a"&&!!n.getAttribute("href"),a=n.getAttribute("tabindex"),o=Number(a),r=null;return a&&!Number.isNaN(o)?r=o:i&&r===null&&(r=0),i&&n.disabled&&(r=null),r!==null&&(r>=0||e&&r<0)}return!1}function Aue(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,t=an(n.querySelectorAll("*")).filter(function(i){return G3(i,e)});return G3(n,e)&&t.unshift(n),t}var IZ=tn.LEFT,hZ=tn.RIGHT,fZ=tn.UP,Ty=tn.DOWN,Yy=tn.ENTER,iK=tn.ESC,zm=tn.HOME,Km=tn.END,S3=[fZ,Ty,IZ,hZ];function mue(n,e,t,i){var a,o="prev",r="next",s="children",l="parent";if(n==="inline"&&i===Yy)return{inlineTrigger:!0};var c=Ve(Ve({},fZ,o),Ty,r),u=Ve(Ve(Ve(Ve({},IZ,t?r:o),hZ,t?o:r),Ty,s),Yy,s),C=Ve(Ve(Ve(Ve(Ve(Ve({},fZ,o),Ty,r),Yy,s),iK,l),IZ,t?s:l),hZ,t?l:s),h={inline:c,horizontal:u,vertical:C,inlineSub:c,horizontalSub:C,verticalSub:C},m=(a=h["".concat(n).concat(e?"":"Sub")])===null||a===void 0?void 0:a[i];switch(m){case o:return{offset:-1,sibling:!0};case r:return{offset:1,sibling:!0};case l:return{offset:-1,sibling:!1};case s:return{offset:1,sibling:!1};default:return null}}function pue(n){for(var e=n;e;){if(e.getAttribute("data-menu-list"))return e;e=e.parentElement}return null}function bue(n,e){for(var t=n||document.activeElement;t;){if(e.has(t))return t;t=t.parentElement}return null}function NM(n,e){var t=Aue(n,!0);return t.filter(function(i){return e.has(i)})}function w3(n,e,t){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;if(!n)return null;var a=NM(n,e),o=a.length,r=a.findIndex(function(s){return t===s});return i<0?r===-1?r=o-1:r-=1:i>0&&(r+=1),r=(r+o)%o,a[r]}var AZ=function(e,t){var i=new Set,a=new Map,o=new Map;return e.forEach(function(r){var s=document.querySelector("[data-menu-id='".concat(qz(t,r),"']"));s&&(i.add(s),o.set(s,r),a.set(r,s))}),{elements:i,key2element:a,element2key:o}};function vue(n,e,t,i,a,o,r,s,l,c){var u=v.useRef(),C=v.useRef();C.current=e;var h=function(){mi.cancel(u.current)};return v.useEffect(function(){return function(){h()}},[]),function(m){var p=m.which;if([].concat(S3,[Yy,iK,zm,Km]).includes(p)){var B=o(),b=AZ(B,i),y=b,S=y.elements,R=y.key2element,Z=y.element2key,x=R.get(e),M=bue(x,S),E=Z.get(M),F=mue(n,r(E,!0).length===1,t,p);if(!F&&p!==zm&&p!==Km)return;(S3.includes(p)||[zm,Km].includes(p))&&m.preventDefault();var N=function(L){if(L){var U=L,q=L.querySelector("a");q!=null&&q.getAttribute("href")&&(U=q);var K=Z.get(L);s(K),h(),u.current=mi(function(){C.current===K&&U.focus()})}};if([zm,Km].includes(p)||F.sibling||!M){var H;!M||n==="inline"?H=a.current:H=pue(M);var z,_=NM(H,S);p===zm?z=_[0]:p===Km?z=_[_.length-1]:z=w3(H,S,M,F.offset),N(z)}else if(F.inlineTrigger)l(E);else if(F.offset>0)l(E,!0),h(),u.current=mi(function(){b=AZ(B,i);var X=M.getAttribute("aria-controls"),L=document.getElementById(X),U=w3(L,b.elements);N(U)},5);else if(F.offset<0){var D=r(E,!0),P=D[D.length-2],$=R.get(P);l(P,!1),N($)}}c==null||c(m)}}function yue(n){Promise.resolve().then(n)}var EM="__RC_UTIL_PATH_SPLIT__",R3=function(e){return e.join(EM)},Bue=function(e){return e.split(EM)},mZ="rc-menu-more";function Gue(){var n=v.useState({}),e=rt(n,2),t=e[1],i=v.useRef(new Map),a=v.useRef(new Map),o=v.useState([]),r=rt(o,2),s=r[0],l=r[1],c=v.useRef(0),u=v.useRef(!1),C=function(){u.current||t({})},h=v.useCallback(function(R,Z){var x=R3(Z);a.current.set(x,R),i.current.set(R,x),c.current+=1;var M=c.current;yue(function(){M===c.current&&C()})},[]),m=v.useCallback(function(R,Z){var x=R3(Z);a.current.delete(x),i.current.delete(R)},[]),p=v.useCallback(function(R){l(R)},[]),B=v.useCallback(function(R,Z){var x=i.current.get(R)||"",M=Bue(x);return Z&&s.includes(M[0])&&M.unshift(mZ),M},[s]),b=v.useCallback(function(R,Z){return R.filter(function(x){return x!==void 0}).some(function(x){var M=B(x,!0);return M.includes(Z)})},[B]),y=function(){var Z=an(i.current.keys());return s.length&&Z.push(mZ),Z},S=v.useCallback(function(R){var Z="".concat(i.current.get(R)).concat(EM),x=new Set;return an(a.current.keys()).forEach(function(M){M.startsWith(Z)&&x.add(a.current.get(M))}),x},[]);return v.useEffect(function(){return function(){u.current=!0}},[]),{registerPath:h,unregisterPath:m,refreshOverflowKeys:p,isSubPathKey:b,getKeyPath:B,getKeys:y,getSubPathKeys:S}}function ep(n){var e=v.useRef(n);e.current=n;var t=v.useCallback(function(){for(var i,a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(i=e.current)===null||i===void 0?void 0:i.call.apply(i,[e].concat(o))},[]);return n?t:void 0}var Sue=Math.random().toFixed(5).toString().slice(2),Z3=0;function wue(n){var e=_a(n,{value:n}),t=rt(e,2),i=t[0],a=t[1];return v.useEffect(function(){Z3+=1;var o="".concat(Sue,"-").concat(Z3);a("rc-menu-uuid-".concat(o))},[]),i}function aK(n,e,t,i){var a=v.useContext(hc),o=a.activeKey,r=a.onActive,s=a.onInactive,l={active:o===n};return e||(l.onMouseEnter=function(c){t==null||t({key:n,domEvent:c}),r(n)},l.onMouseLeave=function(c){i==null||i({key:n,domEvent:c}),s(n)}),l}function oK(n){var e=v.useContext(hc),t=e.mode,i=e.rtl,a=e.inlineIndent;if(t!=="inline")return null;var o=n;return i?{paddingRight:o*a}:{paddingLeft:o*a}}function rK(n){var e=n.icon,t=n.props,i=n.children,a;return e===null||e===!1?null:(typeof e=="function"?a=v.createElement(e,Ke({},t)):typeof e!="boolean"&&(a=e),a||i||null)}var Rue=["item"];function QB(n){var e=n.item,t=_n(n,Rue);return Object.defineProperty(t,"item",{get:function(){return No(!1,"`info.item` is deprecated since we will move to function component that not provides React Node instance in future."),e}}),t}var Zue=["title","attribute","elementRef"],xue=["style","className","eventKey","warnKey","disabled","itemIcon","children","role","onMouseEnter","onMouseLeave","onClick","onKeyDown","onFocus"],Mue=["active"],Wue=function(n){Iu(t,n);var e=hu(t);function t(){return to(this,t),e.apply(this,arguments)}return no(t,[{key:"render",value:function(){var a=this.props,o=a.title,r=a.attribute,s=a.elementRef,l=_n(a,Zue),c=Ss(l,["eventKey","popupClassName","popupOffset","onTitleClick"]);return No(!r,"`attribute` of Menu.Item is deprecated. Please pass attribute directly."),v.createElement(gg.Item,$t({},r,{title:typeof o=="string"?o:void 0},c,{ref:s}))}}]),t}(v.Component),Vue=v.forwardRef(function(n,e){var t=n.style,i=n.className,a=n.eventKey;n.warnKey;var o=n.disabled,r=n.itemIcon,s=n.children,l=n.role,c=n.onMouseEnter,u=n.onMouseLeave,C=n.onClick,h=n.onKeyDown,m=n.onFocus,p=_n(n,xue),B=$z(a),b=v.useContext(hc),y=b.prefixCls,S=b.onItemClick,R=b.disabled,Z=b.overflowDisabled,x=b.itemIcon,M=b.selectedKeys,E=b.onActive,F=v.useContext(VM),N=F._internalRenderMenuItem,H="".concat(y,"-item"),z=v.useRef(),_=v.useRef(),D=R||o,P=yI(e,_),$=Rb(a),X=function(xe){return{key:a,keyPath:an($).reverse(),item:z.current,domEvent:xe}},L=r||x,U=aK(a,D,c,u),q=U.active,K=_n(U,Mue),O=M.includes(a),j=oK($.length),ne=function(xe){if(!D){var Ne=X(xe);C==null||C(QB(Ne)),S(Ne)}},k=function(xe){if(h==null||h(xe),xe.which===tn.ENTER){var Ne=X(xe);C==null||C(QB(Ne)),S(Ne)}},ie=function(xe){E(a),m==null||m(xe)},re={};n.role==="option"&&(re["aria-selected"]=O);var ge=v.createElement(Wue,$t({ref:z,elementRef:P,role:l===null?"none":l||"menuitem",tabIndex:o?null:-1,"data-menu-id":Z&&B?null:B},Ss(p,["extra"]),K,re,{component:"li","aria-disabled":o,style:Ke(Ke({},j),t),className:gt(H,Ve(Ve(Ve({},"".concat(H,"-active"),q),"".concat(H,"-selected"),O),"".concat(H,"-disabled"),D),i),onClick:ne,onKeyDown:k,onFocus:ie}),s,v.createElement(rK,{props:Ke(Ke({},n),{},{isSelected:O}),icon:L}));return N&&(ge=N(ge,n,{selected:O})),ge});function Nue(n,e){var t=n.eventKey,i=AS(),a=Rb(t);return v.useEffect(function(){if(i)return i.registerPath(t,a),function(){i.unregisterPath(t,a)}},[a]),i?null:v.createElement(Vue,$t({},n,{ref:e}))}const mS=v.forwardRef(Nue);var Eue=["className","children"],Hue=function(e,t){var i=e.className,a=e.children,o=_n(e,Eue),r=v.useContext(hc),s=r.prefixCls,l=r.mode,c=r.rtl;return v.createElement("ul",$t({className:gt(s,c&&"".concat(s,"-rtl"),"".concat(s,"-sub"),"".concat(s,"-").concat(l==="inline"?"inline":"vertical"),i),role:"menu"},o,{"data-menu-list":!0,ref:t}),a)},HM=v.forwardRef(Hue);HM.displayName="SubMenuList";function FM(n,e){return Ic(n).map(function(t,i){if(v.isValidElement(t)){var a,o,r=t.key,s=(a=(o=t.props)===null||o===void 0?void 0:o.eventKey)!==null&&a!==void 0?a:r,l=s==null;l&&(s="tmp_key-".concat([].concat(an(e),[i]).join("-")));var c={key:s,eventKey:s};return v.cloneElement(t,c)}return t})}var Ir={adjustX:1,adjustY:1},Fue={topLeft:{points:["bl","tl"],overflow:Ir},topRight:{points:["br","tr"],overflow:Ir},bottomLeft:{points:["tl","bl"],overflow:Ir},bottomRight:{points:["tr","br"],overflow:Ir},leftTop:{points:["tr","tl"],overflow:Ir},leftBottom:{points:["br","bl"],overflow:Ir},rightTop:{points:["tl","tr"],overflow:Ir},rightBottom:{points:["bl","br"],overflow:Ir}},Xue={topLeft:{points:["bl","tl"],overflow:Ir},topRight:{points:["br","tr"],overflow:Ir},bottomLeft:{points:["tl","bl"],overflow:Ir},bottomRight:{points:["tr","br"],overflow:Ir},rightTop:{points:["tr","tl"],overflow:Ir},rightBottom:{points:["br","bl"],overflow:Ir},leftTop:{points:["tl","tr"],overflow:Ir},leftBottom:{points:["bl","br"],overflow:Ir}};function sK(n,e,t){if(e)return e;if(t)return t[n]||t.other}var Tue={horizontal:"bottomLeft",vertical:"rightTop","vertical-left":"rightTop","vertical-right":"leftTop"};function Yue(n){var e=n.prefixCls,t=n.visible,i=n.children,a=n.popup,o=n.popupStyle,r=n.popupClassName,s=n.popupOffset,l=n.disabled,c=n.mode,u=n.onVisibleChange,C=v.useContext(hc),h=C.getPopupContainer,m=C.rtl,p=C.subMenuOpenDelay,B=C.subMenuCloseDelay,b=C.builtinPlacements,y=C.triggerSubMenuAction,S=C.forceSubMenuRender,R=C.rootClassName,Z=C.motion,x=C.defaultMotions,M=v.useState(!1),E=rt(M,2),F=E[0],N=E[1],H=Ke(m?Ke({},Xue):Ke({},Fue),b),z=Tue[c],_=sK(c,Z,x),D=v.useRef(_);c!=="inline"&&(D.current=_);var P=Ke(Ke({},D.current),{},{leavedClassName:"".concat(e,"-hidden"),removeOnLeave:!1,motionAppear:!0}),$=v.useRef();return v.useEffect(function(){return $.current=mi(function(){N(t)}),function(){mi.cancel($.current)}},[t]),v.createElement(IS,{prefixCls:e,popupClassName:gt("".concat(e,"-popup"),Ve({},"".concat(e,"-rtl"),m),r,R),stretch:c==="horizontal"?"minWidth":null,getPopupContainer:h,builtinPlacements:H,popupPlacement:z,popupVisible:F,popup:a,popupStyle:o,popupAlign:s&&{offset:s},action:l?[]:[y],mouseEnterDelay:p,mouseLeaveDelay:B,onPopupVisibleChange:u,forceRender:S,popupMotion:P,fresh:!0},i)}function zue(n){var e=n.id,t=n.open,i=n.keyPath,a=n.children,o="inline",r=v.useContext(hc),s=r.prefixCls,l=r.forceSubMenuRender,c=r.motion,u=r.defaultMotions,C=r.mode,h=v.useRef(!1);h.current=C===o;var m=v.useState(!h.current),p=rt(m,2),B=p[0],b=p[1],y=h.current?t:!1;v.useEffect(function(){h.current&&b(!1)},[C]);var S=Ke({},sK(o,c,u));i.length>1&&(S.motionAppear=!1);var R=S.onVisibleChanged;return S.onVisibleChanged=function(Z){return!h.current&&!Z&&b(!0),R==null?void 0:R(Z)},B?null:v.createElement(kp,{mode:o,locked:!h.current},v.createElement(GI,$t({visible:y},S,{forceRender:l,removeOnLeave:!1,leavedClassName:"".concat(s,"-hidden")}),function(Z){var x=Z.className,M=Z.style;return v.createElement(HM,{id:e,className:x,style:M},a)}))}var Kue=["style","className","title","eventKey","warnKey","disabled","internalPopupClose","children","itemIcon","expandIcon","popupClassName","popupOffset","popupStyle","onClick","onMouseEnter","onMouseLeave","onTitleClick","onTitleMouseEnter","onTitleMouseLeave"],Lue=["active"],_ue=v.forwardRef(function(n,e){var t=n.style,i=n.className,a=n.title,o=n.eventKey;n.warnKey;var r=n.disabled,s=n.internalPopupClose,l=n.children,c=n.itemIcon,u=n.expandIcon,C=n.popupClassName,h=n.popupOffset,m=n.popupStyle,p=n.onClick,B=n.onMouseEnter,b=n.onMouseLeave,y=n.onTitleClick,S=n.onTitleMouseEnter,R=n.onTitleMouseLeave,Z=_n(n,Kue),x=$z(o),M=v.useContext(hc),E=M.prefixCls,F=M.mode,N=M.openKeys,H=M.disabled,z=M.overflowDisabled,_=M.activeKey,D=M.selectedKeys,P=M.itemIcon,$=M.expandIcon,X=M.onItemClick,L=M.onOpenChange,U=M.onActive,q=v.useContext(VM),K=q._internalRenderSubMenuItem,O=v.useContext(nK),j=O.isSubPathKey,ne=Rb(),k="".concat(E,"-submenu"),ie=H||r,re=v.useRef(),ge=v.useRef(),de=c??P,xe=u??$,Ne=N.includes(o),ye=!z&&Ne,pe=j(D,o),Te=aK(o,ie,S,R),le=Te.active,Ye=_n(Te,Lue),he=v.useState(!1),Ge=rt(he,2),be=Ge[0],Ee=Ge[1],Se=function(Ce){ie||Ee(Ce)},ee=function(Ce){Se(!0),B==null||B({key:o,domEvent:Ce})},Q=function(Ce){Se(!1),b==null||b({key:o,domEvent:Ce})},ce=v.useMemo(function(){return le||(F!=="inline"?be||j([_],o):!1)},[F,le,_,be,o,j]),me=oK(ne.length),Ze=function(Ce){ie||(y==null||y({key:o,domEvent:Ce}),F==="inline"&&L(o,!Ne))},Xe=ep(function(ke){p==null||p(QB(ke)),X(ke)}),De=function(Ce){F!=="inline"&&L(o,Ce)},Oe=function(){U(o)},Je=x&&"".concat(x,"-popup"),At=v.useMemo(function(){return v.createElement(rK,{icon:F!=="horizontal"?xe:void 0,props:Ke(Ke({},n),{},{isOpen:ye,isSubMenu:!0})},v.createElement("i",{className:"".concat(k,"-arrow")}))},[F,xe,n,ye,k]),qe=v.createElement("div",$t({role:"menuitem",style:me,className:"".concat(k,"-title"),tabIndex:ie?null:-1,ref:re,title:typeof a=="string"?a:null,"data-menu-id":z&&x?null:x,"aria-expanded":ye,"aria-haspopup":!0,"aria-controls":Je,"aria-disabled":ie,onClick:Ze,onFocus:Oe},Ye),a,At),lt=v.useRef(F);if(F!=="inline"&&ne.length>1?lt.current="vertical":lt.current=F,!z){var $e=lt.current;qe=v.createElement(Yue,{mode:$e,prefixCls:k,visible:!s&&ye&&F!=="inline",popupClassName:C,popupOffset:h,popupStyle:m,popup:v.createElement(kp,{mode:$e==="horizontal"?"vertical":$e},v.createElement(HM,{id:Je,ref:ge},l)),disabled:ie,onVisibleChange:De},qe)}var je=v.createElement(gg.Item,$t({ref:e,role:"none"},Z,{component:"li",style:t,className:gt(k,"".concat(k,"-").concat(F),i,Ve(Ve(Ve(Ve({},"".concat(k,"-open"),ye),"".concat(k,"-active"),ce),"".concat(k,"-selected"),pe),"".concat(k,"-disabled"),ie)),onMouseEnter:ee,onMouseLeave:Q}),qe,!z&&v.createElement(zue,{id:Je,open:ye,keyPath:ne},l));return K&&(je=K(je,n,{selected:pe,active:ce,open:ye,disabled:ie})),v.createElement(kp,{onItemClick:Xe,mode:F==="horizontal"?"vertical":F,itemIcon:de,expandIcon:xe},je)}),XM=v.forwardRef(function(n,e){var t=n.eventKey,i=n.children,a=Rb(t),o=FM(i,a),r=AS();v.useEffect(function(){if(r)return r.registerPath(t,a),function(){r.unregisterPath(t,a)}},[a]);var s;return r?s=o:s=v.createElement(_ue,$t({ref:e},n),o),v.createElement(tK.Provider,{value:a},s)});function lK(n){var e=n.className,t=n.style,i=v.useContext(hc),a=i.prefixCls,o=AS();return o?null:v.createElement("li",{role:"separator",className:gt("".concat(a,"-item-divider"),e),style:t})}var Due=["className","title","eventKey","children"],Oue=v.forwardRef(function(n,e){var t=n.className,i=n.title;n.eventKey;var a=n.children,o=_n(n,Due),r=v.useContext(hc),s=r.prefixCls,l="".concat(s,"-item-group");return v.createElement("li",$t({ref:e,role:"presentation"},o,{onClick:function(u){return u.stopPropagation()},className:gt(l,t)}),v.createElement("div",{role:"presentation",className:"".concat(l,"-title"),title:typeof i=="string"?i:void 0},i),v.createElement("ul",{role:"group",className:"".concat(l,"-list")},a))}),cK=v.forwardRef(function(n,e){var t=n.eventKey,i=n.children,a=Rb(t),o=FM(i,a),r=AS();return r?o:v.createElement(Oue,$t({ref:e},Ss(n,["warnKey"])),o)}),Uue=["label","children","key","type","extra"];function pZ(n,e,t){var i=e.item,a=e.group,o=e.submenu,r=e.divider;return(n||[]).map(function(s,l){if(s&&Bn(s)==="object"){var c=s,u=c.label,C=c.children,h=c.key,m=c.type,p=c.extra,B=_n(c,Uue),b=h??"tmp-".concat(l);return C||m==="group"?m==="group"?v.createElement(a,$t({key:b},B,{title:u}),pZ(C,e,t)):v.createElement(o,$t({key:b},B,{title:u}),pZ(C,e,t)):m==="divider"?v.createElement(r,$t({key:b},B)):v.createElement(i,$t({key:b},B,{extra:p}),u,(!!p||p===0)&&v.createElement("span",{className:"".concat(t,"-item-extra")},p))}return null}).filter(function(s){return s})}function x3(n,e,t,i,a){var o=n,r=Ke({divider:lK,item:mS,group:cK,submenu:XM},i);return e&&(o=pZ(e,r,a)),FM(o,t)}var kue=["prefixCls","rootClassName","style","className","tabIndex","items","children","direction","id","mode","inlineCollapsed","disabled","disabledOverflow","subMenuOpenDelay","subMenuCloseDelay","forceSubMenuRender","defaultOpenKeys","openKeys","activeKey","defaultActiveFirst","selectable","multiple","defaultSelectedKeys","selectedKeys","onSelect","onDeselect","inlineIndent","motion","defaultMotions","triggerSubMenuAction","builtinPlacements","itemIcon","expandIcon","overflowedIndicator","overflowedIndicatorPopupClassName","getPopupContainer","onClick","onOpenChange","onKeyDown","openAnimation","openTransitionName","_internalRenderMenuItem","_internalRenderSubMenuItem","_internalComponents"],VC=[],Pue=v.forwardRef(function(n,e){var t,i=n,a=i.prefixCls,o=a===void 0?"rc-menu":a,r=i.rootClassName,s=i.style,l=i.className,c=i.tabIndex,u=c===void 0?0:c,C=i.items,h=i.children,m=i.direction,p=i.id,B=i.mode,b=B===void 0?"vertical":B,y=i.inlineCollapsed,S=i.disabled,R=i.disabledOverflow,Z=i.subMenuOpenDelay,x=Z===void 0?.1:Z,M=i.subMenuCloseDelay,E=M===void 0?.1:M,F=i.forceSubMenuRender,N=i.defaultOpenKeys,H=i.openKeys,z=i.activeKey,_=i.defaultActiveFirst,D=i.selectable,P=D===void 0?!0:D,$=i.multiple,X=$===void 0?!1:$,L=i.defaultSelectedKeys,U=i.selectedKeys,q=i.onSelect,K=i.onDeselect,O=i.inlineIndent,j=O===void 0?24:O,ne=i.motion,k=i.defaultMotions,ie=i.triggerSubMenuAction,re=ie===void 0?"hover":ie,ge=i.builtinPlacements,de=i.itemIcon,xe=i.expandIcon,Ne=i.overflowedIndicator,ye=Ne===void 0?"...":Ne,pe=i.overflowedIndicatorPopupClassName,Te=i.getPopupContainer,le=i.onClick,Ye=i.onOpenChange,he=i.onKeyDown;i.openAnimation,i.openTransitionName;var Ge=i._internalRenderMenuItem,be=i._internalRenderSubMenuItem,Ee=i._internalComponents,Se=_n(i,kue),ee=v.useMemo(function(){return[x3(h,C,VC,Ee,o),x3(h,C,VC,{},o)]},[h,C,Ee]),Q=rt(ee,2),ce=Q[0],me=Q[1],Ze=v.useState(!1),Xe=rt(Ze,2),De=Xe[0],Oe=Xe[1],Je=v.useRef(),At=wue(p),qe=m==="rtl",lt=_a(N,{value:H,postState:function(Jt){return Jt||VC}}),$e=rt(lt,2),je=$e[0],ke=$e[1],Ce=function(Jt){var Et=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;function rn(){ke(Jt),Ye==null||Ye(Jt)}Et?md.flushSync(rn):rn()},He=v.useState(je),ht=rt(He,2),we=ht[0],ze=ht[1],Qe=v.useRef(!1),ut=v.useMemo(function(){return(b==="inline"||b==="vertical")&&y?["vertical",y]:[b,!1]},[b,y]),Rt=rt(ut,2),mt=Rt[0],_t=Rt[1],Lt=mt==="inline",Zt=v.useState(mt),yt=rt(Zt,2),Ht=yt[0],jt=yt[1],Ut=v.useState(_t),Nt=rt(Ut,2),Tt=Nt[0],Pt=Nt[1];v.useEffect(function(){jt(mt),Pt(_t),Qe.current&&(Lt?ke(we):Ce(VC))},[mt,_t]);var qt=v.useState(0),kt=rt(qt,2),Ft=kt[0],fn=kt[1],sn=Ft>=ce.length-1||Ht!=="horizontal"||R;v.useEffect(function(){Lt&&ze(je)},[je]),v.useEffect(function(){return Qe.current=!0,function(){Qe.current=!1}},[]);var ae=Gue(),ue=ae.registerPath,Fe=ae.unregisterPath,ot=ae.refreshOverflowKeys,at=ae.isSubPathKey,It=ae.getKeyPath,Wt=ae.getKeys,xt=ae.getSubPathKeys,te=v.useMemo(function(){return{registerPath:ue,unregisterPath:Fe}},[ue,Fe]),Ie=v.useMemo(function(){return{isSubPathKey:at}},[at]);v.useEffect(function(){ot(sn?VC:ce.slice(Ft+1).map(function(cn){return cn.key}))},[Ft,sn]);var Ae=_a(z||_&&((t=ce[0])===null||t===void 0?void 0:t.key),{value:z}),se=rt(Ae,2),Re=se[0],Ue=se[1],nt=ep(function(cn){Ue(cn)}),pt=ep(function(){Ue(void 0)});v.useImperativeHandle(e,function(){return{list:Je.current,focus:function(Jt){var Et,rn=Wt(),Cn=AZ(rn,At),Gn=Cn.elements,pn=Cn.key2element,Kn=Cn.element2key,Qn=NM(Je.current,Gn),li=Re??(Qn[0]?Kn.get(Qn[0]):(Et=ce.find(function(pa){return!pa.props.disabled}))===null||Et===void 0?void 0:Et.key),Zi=pn.get(li);if(li&&Zi){var aa;Zi==null||(aa=Zi.focus)===null||aa===void 0||aa.call(Zi,Jt)}}}});var it=_a(L||[],{value:U,postState:function(Jt){return Array.isArray(Jt)?Jt:Jt==null?VC:[Jt]}}),Bt=rt(it,2),Mt=Bt[0],Yt=Bt[1],ln=function(Jt){if(P){var Et=Jt.key,rn=Mt.includes(Et),Cn;X?rn?Cn=Mt.filter(function(pn){return pn!==Et}):Cn=[].concat(an(Mt),[Et]):Cn=[Et],Yt(Cn);var Gn=Ke(Ke({},Jt),{},{selectedKeys:Cn});rn?K==null||K(Gn):q==null||q(Gn)}!X&&je.length&&Ht!=="inline"&&Ce(VC)},on=ep(function(cn){le==null||le(QB(cn)),ln(cn)}),vn=ep(function(cn,Jt){var Et=je.filter(function(Cn){return Cn!==cn});if(Jt)Et.push(cn);else if(Ht!=="inline"){var rn=xt(cn);Et=Et.filter(function(Cn){return!rn.has(Cn)})}Vf(je,Et,!0)||Ce(Et,!0)}),nn=function(Jt,Et){var rn=Et??!je.includes(Jt);vn(Jt,rn)},mn=vue(Ht,Re,qe,At,Je,Wt,It,Ue,nn,he);v.useEffect(function(){Oe(!0)},[]);var gn=v.useMemo(function(){return{_internalRenderMenuItem:Ge,_internalRenderSubMenuItem:be}},[Ge,be]),Xn=Ht!=="horizontal"||R?ce:ce.map(function(cn,Jt){return v.createElement(kp,{key:cn.key,overflowDisabled:Jt>Ft},cn)}),bn=v.createElement(gg,$t({id:p,ref:Je,prefixCls:"".concat(o,"-overflow"),component:"ul",itemComponent:mS,className:gt(o,"".concat(o,"-root"),"".concat(o,"-").concat(Ht),l,Ve(Ve({},"".concat(o,"-inline-collapsed"),Tt),"".concat(o,"-rtl"),qe),r),dir:m,style:s,role:"menu",tabIndex:u,data:Xn,renderRawItem:function(Jt){return Jt},renderRawRest:function(Jt){var Et=Jt.length,rn=Et?ce.slice(-Et):null;return v.createElement(XM,{eventKey:mZ,title:ye,disabled:sn,internalPopupClose:Et===0,popupClassName:pe},rn)},maxCount:Ht!=="horizontal"||R?gg.INVALIDATE:gg.RESPONSIVE,ssr:"full","data-menu-list":!0,onVisibleChange:function(Jt){fn(Jt)},onKeyDown:mn},Se));return v.createElement(VM.Provider,{value:gn},v.createElement(Qz.Provider,{value:At},v.createElement(kp,{prefixCls:o,rootClassName:r,mode:Ht,openKeys:je,rtl:qe,disabled:S,motion:De?ne:null,defaultMotions:De?k:null,activeKey:Re,onActive:nt,onInactive:pt,selectedKeys:Mt,inlineIndent:j,subMenuOpenDelay:x,subMenuCloseDelay:E,forceSubMenuRender:F,builtinPlacements:ge,triggerSubMenuAction:re,getPopupContainer:Te,itemIcon:de,expandIcon:xe,onItemClick:on,onOpenChange:vn},v.createElement(nK.Provider,{value:Ie},bn),v.createElement("div",{style:{display:"none"},"aria-hidden":!0},v.createElement(eK.Provider,{value:te},me)))))}),Zb=Pue;Zb.Item=mS;Zb.SubMenu=XM;Zb.ItemGroup=cK;Zb.Divider=lK;var gK={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M176 511a56 56 0 10112 0 56 56 0 10-112 0zm280 0a56 56 0 10112 0 56 56 0 10-112 0zm280 0a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"ellipsis",theme:"outlined"},Jue=function(e,t){return v.createElement(io,$t({},e,{ref:t,icon:gK}))},jue=v.forwardRef(Jue);const uK=v.createContext(null),Que=uK.Provider,dK=v.createContext(null),que=dK.Provider;var $ue=["prefixCls","className","style","checked","disabled","defaultChecked","type","title","onChange"],ede=v.forwardRef(function(n,e){var t=n.prefixCls,i=t===void 0?"rc-checkbox":t,a=n.className,o=n.style,r=n.checked,s=n.disabled,l=n.defaultChecked,c=l===void 0?!1:l,u=n.type,C=u===void 0?"checkbox":u,h=n.title,m=n.onChange,p=_n(n,$ue),B=v.useRef(null),b=v.useRef(null),y=_a(c,{value:r}),S=rt(y,2),R=S[0],Z=S[1];v.useImperativeHandle(e,function(){return{focus:function(F){var N;(N=B.current)===null||N===void 0||N.focus(F)},blur:function(){var F;(F=B.current)===null||F===void 0||F.blur()},input:B.current,nativeElement:b.current}});var x=gt(i,a,Ve(Ve({},"".concat(i,"-checked"),R),"".concat(i,"-disabled"),s)),M=function(F){s||("checked"in n||Z(F.target.checked),m==null||m({target:Ke(Ke({},n),{},{type:C,checked:F.target.checked}),stopPropagation:function(){F.stopPropagation()},preventDefault:function(){F.preventDefault()},nativeEvent:F.nativeEvent}))};return v.createElement("span",{className:x,title:h,style:o,ref:b},v.createElement("input",$t({},p,{className:"".concat(i,"-input"),ref:B,onChange:M,disabled:s,checked:!!R,type:C})),v.createElement("span",{className:"".concat(i,"-inner")}))});function tde(n){const e=Ct.useRef(null),t=()=>{mi.cancel(e.current),e.current=null};return[()=>{t(),e.current=mi(()=>{e.current=null})},o=>{e.current&&(o.stopPropagation(),t()),n==null||n(o)}]}const nde=n=>{const{componentCls:e,antCls:t}=n,i=`${e}-group`;return{[i]:Object.assign(Object.assign({},Po(n)),{display:"inline-block",fontSize:0,[`&${i}-rtl`]:{direction:"rtl"},[`&${i}-block`]:{display:"flex"},[`${t}-badge ${t}-badge-count`]:{zIndex:1},[`> ${t}-badge:not(:first-child) > ${t}-button-wrapper`]:{borderInlineStart:"none"}})}},ide=n=>{const{componentCls:e,wrapperMarginInlineEnd:t,colorPrimary:i,radioSize:a,motionDurationSlow:o,motionDurationMid:r,motionEaseInOutCirc:s,colorBgContainer:l,colorBorder:c,lineWidth:u,colorBgContainerDisabled:C,colorTextDisabled:h,paddingXS:m,dotColorDisabled:p,lineType:B,radioColor:b,radioBgColor:y,calc:S}=n,R=`${e}-inner`,x=S(a).sub(S(4).mul(2)),M=S(1).mul(a).equal({unit:!0});return{[`${e}-wrapper`]:Object.assign(Object.assign({},Po(n)),{display:"inline-flex",alignItems:"baseline",marginInlineStart:0,marginInlineEnd:t,cursor:"pointer","&:last-child":{marginInlineEnd:0},[`&${e}-wrapper-rtl`]:{direction:"rtl"},"&-disabled":{cursor:"not-allowed",color:n.colorTextDisabled},"&::after":{display:"inline-block",width:0,overflow:"hidden",content:'"\\a0"'},"&-block":{flex:1,justifyContent:"center"},[`${e}-checked::after`]:{position:"absolute",insetBlockStart:0,insetInlineStart:0,width:"100%",height:"100%",border:`${st(u)} ${B} ${i}`,borderRadius:"50%",visibility:"hidden",opacity:0,content:'""'},[e]:Object.assign(Object.assign({},Po(n)),{position:"relative",display:"inline-block",outline:"none",cursor:"pointer",alignSelf:"center",borderRadius:"50%"}),[`${e}-wrapper:hover &,
        &:hover ${R}`]:{borderColor:i},[`${e}-input:focus-visible + ${R}`]:Object.assign({},II(n)),[`${e}:hover::after, ${e}-wrapper:hover &::after`]:{visibility:"visible"},[`${e}-inner`]:{"&::after":{boxSizing:"border-box",position:"absolute",insetBlockStart:"50%",insetInlineStart:"50%",display:"block",width:M,height:M,marginBlockStart:S(1).mul(a).div(-2).equal({unit:!0}),marginInlineStart:S(1).mul(a).div(-2).equal({unit:!0}),backgroundColor:b,borderBlockStart:0,borderInlineStart:0,borderRadius:M,transform:"scale(0)",opacity:0,transition:`all ${o} ${s}`,content:'""'},boxSizing:"border-box",position:"relative",insetBlockStart:0,insetInlineStart:0,display:"block",width:M,height:M,backgroundColor:l,borderColor:c,borderStyle:"solid",borderWidth:u,borderRadius:"50%",transition:`all ${r}`},[`${e}-input`]:{position:"absolute",inset:0,zIndex:1,cursor:"pointer",opacity:0},[`${e}-checked`]:{[R]:{borderColor:i,backgroundColor:y,"&::after":{transform:`scale(${n.calc(n.dotSize).div(a).equal()})`,opacity:1,transition:`all ${o} ${s}`}}},[`${e}-disabled`]:{cursor:"not-allowed",[R]:{backgroundColor:C,borderColor:c,cursor:"not-allowed","&::after":{backgroundColor:p}},[`${e}-input`]:{cursor:"not-allowed"},[`${e}-disabled + span`]:{color:h,cursor:"not-allowed"},[`&${e}-checked`]:{[R]:{"&::after":{transform:`scale(${S(x).div(a).equal()})`}}}},[`span${e} + *`]:{paddingInlineStart:m,paddingInlineEnd:m}})}},ade=n=>{const{buttonColor:e,controlHeight:t,componentCls:i,lineWidth:a,lineType:o,colorBorder:r,motionDurationSlow:s,motionDurationMid:l,buttonPaddingInline:c,fontSize:u,buttonBg:C,fontSizeLG:h,controlHeightLG:m,controlHeightSM:p,paddingXS:B,borderRadius:b,borderRadiusSM:y,borderRadiusLG:S,buttonCheckedBg:R,buttonSolidCheckedColor:Z,colorTextDisabled:x,colorBgContainerDisabled:M,buttonCheckedBgDisabled:E,buttonCheckedColorDisabled:F,colorPrimary:N,colorPrimaryHover:H,colorPrimaryActive:z,buttonSolidCheckedBg:_,buttonSolidCheckedHoverBg:D,buttonSolidCheckedActiveBg:P,calc:$}=n;return{[`${i}-button-wrapper`]:{position:"relative",display:"inline-block",height:t,margin:0,paddingInline:c,paddingBlock:0,color:e,fontSize:u,lineHeight:st($(t).sub($(a).mul(2)).equal()),background:C,border:`${st(a)} ${o} ${r}`,borderBlockStartWidth:$(a).add(.02).equal(),borderInlineStartWidth:0,borderInlineEndWidth:a,cursor:"pointer",transition:[`color ${l}`,`background ${l}`,`box-shadow ${l}`].join(","),a:{color:e},[`> ${i}-button`]:{position:"absolute",insetBlockStart:0,insetInlineStart:0,zIndex:-1,width:"100%",height:"100%"},"&:not(:first-child)":{"&::before":{position:"absolute",insetBlockStart:$(a).mul(-1).equal(),insetInlineStart:$(a).mul(-1).equal(),display:"block",boxSizing:"content-box",width:1,height:"100%",paddingBlock:a,paddingInline:0,backgroundColor:r,transition:`background-color ${s}`,content:'""'}},"&:first-child":{borderInlineStart:`${st(a)} ${o} ${r}`,borderStartStartRadius:b,borderEndStartRadius:b},"&:last-child":{borderStartEndRadius:b,borderEndEndRadius:b},"&:first-child:last-child":{borderRadius:b},[`${i}-group-large &`]:{height:m,fontSize:h,lineHeight:st($(m).sub($(a).mul(2)).equal()),"&:first-child":{borderStartStartRadius:S,borderEndStartRadius:S},"&:last-child":{borderStartEndRadius:S,borderEndEndRadius:S}},[`${i}-group-small &`]:{height:p,paddingInline:$(B).sub(a).equal(),paddingBlock:0,lineHeight:st($(p).sub($(a).mul(2)).equal()),"&:first-child":{borderStartStartRadius:y,borderEndStartRadius:y},"&:last-child":{borderStartEndRadius:y,borderEndEndRadius:y}},"&:hover":{position:"relative",color:N},"&:has(:focus-visible)":Object.assign({},II(n)),[`${i}-inner, input[type='checkbox'], input[type='radio']`]:{width:0,height:0,opacity:0,pointerEvents:"none"},[`&-checked:not(${i}-button-wrapper-disabled)`]:{zIndex:1,color:N,background:R,borderColor:N,"&::before":{backgroundColor:N},"&:first-child":{borderColor:N},"&:hover":{color:H,borderColor:H,"&::before":{backgroundColor:H}},"&:active":{color:z,borderColor:z,"&::before":{backgroundColor:z}}},[`${i}-group-solid &-checked:not(${i}-button-wrapper-disabled)`]:{color:Z,background:_,borderColor:_,"&:hover":{color:Z,background:D,borderColor:D},"&:active":{color:Z,background:P,borderColor:P}},"&-disabled":{color:x,backgroundColor:M,borderColor:r,cursor:"not-allowed","&:first-child, &:hover":{color:x,backgroundColor:M,borderColor:r}},[`&-disabled${i}-button-wrapper-checked`]:{color:F,backgroundColor:E,borderColor:r,boxShadow:"none"},"&-block":{flex:1,textAlign:"center"}}}},ode=n=>{const{wireframe:e,padding:t,marginXS:i,lineWidth:a,fontSizeLG:o,colorText:r,colorBgContainer:s,colorTextDisabled:l,controlItemBgActiveDisabled:c,colorTextLightSolid:u,colorPrimary:C,colorPrimaryHover:h,colorPrimaryActive:m,colorWhite:p}=n,B=4,b=o,y=e?b-B*2:b-(B+a)*2;return{radioSize:b,dotSize:y,dotColorDisabled:l,buttonSolidCheckedColor:u,buttonSolidCheckedBg:C,buttonSolidCheckedHoverBg:h,buttonSolidCheckedActiveBg:m,buttonBg:s,buttonCheckedBg:s,buttonColor:r,buttonCheckedBgDisabled:c,buttonCheckedColorDisabled:l,buttonPaddingInline:t-a,wrapperMarginInlineEnd:i,radioColor:e?C:p,radioBgColor:e?s:C}},CK=Oa("Radio",n=>{const{controlOutline:e,controlOutlineWidth:t}=n,i=`0 0 0 ${st(t)} ${e}`,o=Xi(n,{radioFocusShadow:i,radioButtonFocusShadow:i});return[nde(o),ide(o),ade(o)]},ode,{unitless:{radioSize:!0,dotSize:!0}});var rde=function(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(n);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(n,i[a])&&(t[i[a]]=n[i[a]]);return t};const sde=(n,e)=>{var t,i;const a=v.useContext(uK),o=v.useContext(dK),{getPrefixCls:r,direction:s,radio:l}=v.useContext(ui),c=v.useRef(null),u=Bs(e,c),{isFormItemInput:C}=v.useContext(Ag),h=X=>{var L,U;(L=n.onChange)===null||L===void 0||L.call(n,X),(U=a==null?void 0:a.onChange)===null||U===void 0||U.call(a,X)},{prefixCls:m,className:p,rootClassName:B,children:b,style:y,title:S}=n,R=rde(n,["prefixCls","className","rootClassName","children","style","title"]),Z=r("radio",m),x=((a==null?void 0:a.optionType)||o)==="button",M=x?`${Z}-button`:Z,E=tA(Z),[F,N,H]=CK(Z,E),z=Object.assign({},R),_=v.useContext(hg);a&&(z.name=a.name,z.onChange=h,z.checked=n.value===a.value,z.disabled=(t=z.disabled)!==null&&t!==void 0?t:a.disabled),z.disabled=(i=z.disabled)!==null&&i!==void 0?i:_;const D=gt(`${M}-wrapper`,{[`${M}-wrapper-checked`]:z.checked,[`${M}-wrapper-disabled`]:z.disabled,[`${M}-wrapper-rtl`]:s==="rtl",[`${M}-wrapper-in-form-item`]:C,[`${M}-wrapper-block`]:!!(a!=null&&a.block)},l==null?void 0:l.className,p,B,N,H,E),[P,$]=tde(z.onClick);return F(v.createElement(az,{component:"Radio",disabled:z.disabled},v.createElement("label",{className:D,style:Object.assign(Object.assign({},l==null?void 0:l.style),y),onMouseEnter:n.onMouseEnter,onMouseLeave:n.onMouseLeave,title:S,onClick:P},v.createElement(ede,Object.assign({},z,{className:gt(z.className,{[bM]:!x}),type:"radio",prefixCls:M,ref:u,onClick:$})),b!==void 0?v.createElement("span",{className:`${M}-label`},b):null)))},qB=v.forwardRef(sde),lde=v.forwardRef((n,e)=>{const{getPrefixCls:t,direction:i}=v.useContext(ui),a=GM(),{prefixCls:o,className:r,rootClassName:s,options:l,buttonStyle:c="outline",disabled:u,children:C,size:h,style:m,id:p,optionType:B,name:b=a,defaultValue:y,value:S,block:R=!1,onChange:Z,onMouseEnter:x,onMouseLeave:M,onFocus:E,onBlur:F}=n,[N,H]=_a(y,{value:S}),z=v.useCallback(j=>{const ne=N,k=j.target.value;"value"in n||H(k),k!==ne&&(Z==null||Z(j))},[N,H,Z]),_=t("radio",o),D=`${_}-group`,P=tA(_),[$,X,L]=CK(_,P);let U=C;l&&l.length>0&&(U=l.map(j=>typeof j=="string"||typeof j=="number"?v.createElement(qB,{key:j.toString(),prefixCls:_,disabled:u,value:j,checked:N===j},j):v.createElement(qB,{key:`radio-group-value-options-${j.value}`,prefixCls:_,disabled:j.disabled||u,value:j.value,checked:N===j.value,title:j.title,style:j.style,id:j.id,required:j.required},j.label)));const q=Sl(h),K=gt(D,`${D}-${c}`,{[`${D}-${q}`]:q,[`${D}-rtl`]:i==="rtl",[`${D}-block`]:R},r,s,X,L,P),O=v.useMemo(()=>({onChange:z,value:N,disabled:u,name:b,optionType:B,block:R}),[z,N,u,b,B,R]);return $(v.createElement("div",Object.assign({},hI(n,{aria:!0,data:!0}),{className:K,style:m,onMouseEnter:x,onMouseLeave:M,onFocus:E,onBlur:F,id:p,ref:e}),v.createElement(Que,{value:O},U)))}),cde=v.memo(lde);var gde=function(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(n);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(n,i[a])&&(t[i[a]]=n[i[a]]);return t};const ude=(n,e)=>{const{getPrefixCls:t}=v.useContext(ui),{prefixCls:i}=n,a=gde(n,["prefixCls"]),o=t("radio",i);return v.createElement(que,{value:"button"},v.createElement(qB,Object.assign({prefixCls:o},a,{type:"radio",ref:e})))},dde=v.forwardRef(ude),Pp=qB;Pp.Button=dde;Pp.Group=cde;Pp.__ANT_RADIO=!0;function xb(n){return Xi(n,{inputAffixPadding:n.paddingXXS})}const Mb=n=>{const{controlHeight:e,fontSize:t,lineHeight:i,lineWidth:a,controlHeightSM:o,controlHeightLG:r,fontSizeLG:s,lineHeightLG:l,paddingSM:c,controlPaddingHorizontalSM:u,controlPaddingHorizontal:C,colorFillAlter:h,colorPrimaryHover:m,colorPrimary:p,controlOutlineWidth:B,controlOutline:b,colorErrorOutline:y,colorWarningOutline:S,colorBgContainer:R,inputFontSize:Z,inputFontSizeLG:x,inputFontSizeSM:M}=n,E=Z||t,F=M||E,N=x||s,H=Math.round((e-E*i)/2*10)/10-a,z=Math.round((o-F*i)/2*10)/10-a,_=Math.ceil((r-N*l)/2*10)/10-a;return{paddingBlock:Math.max(H,0),paddingBlockSM:Math.max(z,0),paddingBlockLG:Math.max(_,0),paddingInline:c-a,paddingInlineSM:u-a,paddingInlineLG:C-a,addonBg:h,activeBorderColor:p,hoverBorderColor:m,activeShadow:`0 0 0 ${B}px ${b}`,errorActiveShadow:`0 0 0 ${B}px ${y}`,warningActiveShadow:`0 0 0 ${B}px ${S}`,hoverBg:R,activeBg:R,inputFontSize:E,inputFontSizeLG:N,inputFontSizeSM:F}},Cde=n=>({borderColor:n.hoverBorderColor,backgroundColor:n.hoverBg}),pS=n=>({color:n.colorTextDisabled,backgroundColor:n.colorBgContainerDisabled,borderColor:n.colorBorder,boxShadow:"none",cursor:"not-allowed",opacity:1,"input[disabled], textarea[disabled]":{cursor:"not-allowed"},"&:hover:not([disabled])":Object.assign({},Cde(Xi(n,{hoverBorderColor:n.colorBorder,hoverBg:n.colorBgContainerDisabled})))}),TM=(n,e)=>({background:n.colorBgContainer,borderWidth:n.lineWidth,borderStyle:n.lineType,borderColor:e.borderColor,"&:hover":{borderColor:e.hoverBorderColor,backgroundColor:n.hoverBg},"&:focus, &:focus-within":{borderColor:e.activeBorderColor,boxShadow:e.activeShadow,outline:0,backgroundColor:n.activeBg}}),M3=(n,e)=>({[`&${n.componentCls}-status-${e.status}:not(${n.componentCls}-disabled)`]:Object.assign(Object.assign({},TM(n,e)),{[`${n.componentCls}-prefix, ${n.componentCls}-suffix`]:{color:e.affixColor}}),[`&${n.componentCls}-status-${e.status}${n.componentCls}-disabled`]:{borderColor:e.borderColor}}),Ide=(n,e)=>({"&-outlined":Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},TM(n,{borderColor:n.colorBorder,hoverBorderColor:n.hoverBorderColor,activeBorderColor:n.activeBorderColor,activeShadow:n.activeShadow})),{[`&${n.componentCls}-disabled, &[disabled]`]:Object.assign({},pS(n))}),M3(n,{status:"error",borderColor:n.colorError,hoverBorderColor:n.colorErrorBorderHover,activeBorderColor:n.colorError,activeShadow:n.errorActiveShadow,affixColor:n.colorError})),M3(n,{status:"warning",borderColor:n.colorWarning,hoverBorderColor:n.colorWarningBorderHover,activeBorderColor:n.colorWarning,activeShadow:n.warningActiveShadow,affixColor:n.colorWarning})),e)}),W3=(n,e)=>({[`&${n.componentCls}-group-wrapper-status-${e.status}`]:{[`${n.componentCls}-group-addon`]:{borderColor:e.addonBorderColor,color:e.addonColor}}}),hde=n=>({"&-outlined":Object.assign(Object.assign(Object.assign({[`${n.componentCls}-group`]:{"&-addon":{background:n.addonBg,border:`${st(n.lineWidth)} ${n.lineType} ${n.colorBorder}`},"&-addon:first-child":{borderInlineEnd:0},"&-addon:last-child":{borderInlineStart:0}}},W3(n,{status:"error",addonBorderColor:n.colorError,addonColor:n.colorErrorText})),W3(n,{status:"warning",addonBorderColor:n.colorWarning,addonColor:n.colorWarningText})),{[`&${n.componentCls}-group-wrapper-disabled`]:{[`${n.componentCls}-group-addon`]:Object.assign({},pS(n))}})}),fde=(n,e)=>{const{componentCls:t}=n;return{"&-borderless":Object.assign({background:"transparent",border:"none","&:focus, &:focus-within":{outline:"none"},[`&${t}-disabled, &[disabled]`]:{color:n.colorTextDisabled,cursor:"not-allowed"},[`&${t}-status-error`]:{"&, & input, & textarea":{color:n.colorError}},[`&${t}-status-warning`]:{"&, & input, & textarea":{color:n.colorWarning}}},e)}},IK=(n,e)=>{var t;return{background:e.bg,borderWidth:n.lineWidth,borderStyle:n.lineType,borderColor:"transparent","input&, & input, textarea&, & textarea":{color:(t=e==null?void 0:e.inputColor)!==null&&t!==void 0?t:"unset"},"&:hover":{background:e.hoverBg},"&:focus, &:focus-within":{outline:0,borderColor:e.activeBorderColor,backgroundColor:n.activeBg}}},V3=(n,e)=>({[`&${n.componentCls}-status-${e.status}:not(${n.componentCls}-disabled)`]:Object.assign(Object.assign({},IK(n,e)),{[`${n.componentCls}-prefix, ${n.componentCls}-suffix`]:{color:e.affixColor}})}),Ade=(n,e)=>({"&-filled":Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},IK(n,{bg:n.colorFillTertiary,hoverBg:n.colorFillSecondary,activeBorderColor:n.activeBorderColor})),{[`&${n.componentCls}-disabled, &[disabled]`]:Object.assign({},pS(n))}),V3(n,{status:"error",bg:n.colorErrorBg,hoverBg:n.colorErrorBgHover,activeBorderColor:n.colorError,inputColor:n.colorErrorText,affixColor:n.colorError})),V3(n,{status:"warning",bg:n.colorWarningBg,hoverBg:n.colorWarningBgHover,activeBorderColor:n.colorWarning,inputColor:n.colorWarningText,affixColor:n.colorWarning})),e)}),N3=(n,e)=>({[`&${n.componentCls}-group-wrapper-status-${e.status}`]:{[`${n.componentCls}-group-addon`]:{background:e.addonBg,color:e.addonColor}}}),mde=n=>({"&-filled":Object.assign(Object.assign(Object.assign({[`${n.componentCls}-group`]:{"&-addon":{background:n.colorFillTertiary},[`${n.componentCls}-filled:not(:focus):not(:focus-within)`]:{"&:not(:first-child)":{borderInlineStart:`${st(n.lineWidth)} ${n.lineType} ${n.colorSplit}`},"&:not(:last-child)":{borderInlineEnd:`${st(n.lineWidth)} ${n.lineType} ${n.colorSplit}`}}}},N3(n,{status:"error",addonBg:n.colorErrorBg,addonColor:n.colorErrorText})),N3(n,{status:"warning",addonBg:n.colorWarningBg,addonColor:n.colorWarningText})),{[`&${n.componentCls}-group-wrapper-disabled`]:{[`${n.componentCls}-group`]:{"&-addon":{background:n.colorFillTertiary,color:n.colorTextDisabled},"&-addon:first-child":{borderInlineStart:`${st(n.lineWidth)} ${n.lineType} ${n.colorBorder}`,borderTop:`${st(n.lineWidth)} ${n.lineType} ${n.colorBorder}`,borderBottom:`${st(n.lineWidth)} ${n.lineType} ${n.colorBorder}`},"&-addon:last-child":{borderInlineEnd:`${st(n.lineWidth)} ${n.lineType} ${n.colorBorder}`,borderTop:`${st(n.lineWidth)} ${n.lineType} ${n.colorBorder}`,borderBottom:`${st(n.lineWidth)} ${n.lineType} ${n.colorBorder}`}}}})}),hK=(n,e)=>({background:n.colorBgContainer,borderWidth:`${st(n.lineWidth)} 0`,borderStyle:`${n.lineType} none`,borderColor:`transparent transparent ${e.borderColor} transparent`,borderRadius:0,"&:hover":{borderColor:`transparent transparent ${e.borderColor} transparent`,backgroundColor:n.hoverBg},"&:focus, &:focus-within":{borderColor:`transparent transparent ${e.borderColor} transparent`,outline:0,backgroundColor:n.activeBg}}),E3=(n,e)=>({[`&${n.componentCls}-status-${e.status}:not(${n.componentCls}-disabled)`]:Object.assign(Object.assign({},hK(n,e)),{[`${n.componentCls}-prefix, ${n.componentCls}-suffix`]:{color:e.affixColor}}),[`&${n.componentCls}-status-${e.status}${n.componentCls}-disabled`]:{borderColor:`transparent transparent ${e.borderColor} transparent`}}),pde=(n,e)=>({"&-underlined":Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},hK(n,{borderColor:n.colorBorder,hoverBorderColor:n.hoverBorderColor,activeBorderColor:n.activeBorderColor,activeShadow:n.activeShadow})),{[`&${n.componentCls}-disabled, &[disabled]`]:{color:n.colorTextDisabled,boxShadow:"none",cursor:"not-allowed","&:hover":{borderColor:`transparent transparent ${n.colorBorder} transparent`}},"input[disabled], textarea[disabled]":{cursor:"not-allowed"}}),E3(n,{status:"error",borderColor:n.colorError,hoverBorderColor:n.colorErrorBorderHover,activeBorderColor:n.colorError,activeShadow:n.errorActiveShadow,affixColor:n.colorError})),E3(n,{status:"warning",borderColor:n.colorWarning,hoverBorderColor:n.colorWarningBorderHover,activeBorderColor:n.colorWarning,activeShadow:n.warningActiveShadow,affixColor:n.colorWarning})),e)}),bde=n=>({"&::-moz-placeholder":{opacity:1},"&::placeholder":{color:n,userSelect:"none"},"&:placeholder-shown":{textOverflow:"ellipsis"}}),fK=n=>{const{paddingBlockLG:e,lineHeightLG:t,borderRadiusLG:i,paddingInlineLG:a}=n;return{padding:`${st(e)} ${st(a)}`,fontSize:n.inputFontSizeLG,lineHeight:t,borderRadius:i}},YM=n=>({padding:`${st(n.paddingBlockSM)} ${st(n.paddingInlineSM)}`,fontSize:n.inputFontSizeSM,borderRadius:n.borderRadiusSM}),zM=n=>Object.assign(Object.assign({position:"relative",display:"inline-block",width:"100%",minWidth:0,padding:`${st(n.paddingBlock)} ${st(n.paddingInline)}`,color:n.colorText,fontSize:n.inputFontSize,lineHeight:n.lineHeight,borderRadius:n.borderRadius,transition:`all ${n.motionDurationMid}`},bde(n.colorTextPlaceholder)),{"&-lg":Object.assign({},fK(n)),"&-sm":Object.assign({},YM(n)),"&-rtl, &-textarea-rtl":{direction:"rtl"}}),vde=n=>{const{componentCls:e,antCls:t}=n;return{position:"relative",display:"table",width:"100%",borderCollapse:"separate",borderSpacing:0,"&[class*='col-']":{paddingInlineEnd:n.paddingXS,"&:last-child":{paddingInlineEnd:0}},[`&-lg ${e}, &-lg > ${e}-group-addon`]:Object.assign({},fK(n)),[`&-sm ${e}, &-sm > ${e}-group-addon`]:Object.assign({},YM(n)),[`&-lg ${t}-select-single ${t}-select-selector`]:{height:n.controlHeightLG},[`&-sm ${t}-select-single ${t}-select-selector`]:{height:n.controlHeightSM},[`> ${e}`]:{display:"table-cell","&:not(:first-child):not(:last-child)":{borderRadius:0}},[`${e}-group`]:{"&-addon, &-wrap":{display:"table-cell",width:1,whiteSpace:"nowrap",verticalAlign:"middle","&:not(:first-child):not(:last-child)":{borderRadius:0}},"&-wrap > *":{display:"block !important"},"&-addon":{position:"relative",padding:`0 ${st(n.paddingInline)}`,color:n.colorText,fontWeight:"normal",fontSize:n.inputFontSize,textAlign:"center",borderRadius:n.borderRadius,transition:`all ${n.motionDurationSlow}`,lineHeight:1,[`${t}-select`]:{margin:`${st(n.calc(n.paddingBlock).add(1).mul(-1).equal())} ${st(n.calc(n.paddingInline).mul(-1).equal())}`,[`&${t}-select-single:not(${t}-select-customize-input):not(${t}-pagination-size-changer)`]:{[`${t}-select-selector`]:{backgroundColor:"inherit",border:`${st(n.lineWidth)} ${n.lineType} transparent`,boxShadow:"none"}}},[`${t}-cascader-picker`]:{margin:`-9px ${st(n.calc(n.paddingInline).mul(-1).equal())}`,backgroundColor:"transparent",[`${t}-cascader-input`]:{textAlign:"start",border:0,boxShadow:"none"}}}},[e]:{width:"100%",marginBottom:0,textAlign:"inherit","&:focus":{zIndex:1,borderInlineEndWidth:1},"&:hover":{zIndex:1,borderInlineEndWidth:1,[`${e}-search-with-button &`]:{zIndex:0}}},[`> ${e}:first-child, ${e}-group-addon:first-child`]:{borderStartEndRadius:0,borderEndEndRadius:0,[`${t}-select ${t}-select-selector`]:{borderStartEndRadius:0,borderEndEndRadius:0}},[`> ${e}-affix-wrapper`]:{[`&:not(:first-child) ${e}`]:{borderStartStartRadius:0,borderEndStartRadius:0},[`&:not(:last-child) ${e}`]:{borderStartEndRadius:0,borderEndEndRadius:0}},[`> ${e}:last-child, ${e}-group-addon:last-child`]:{borderStartStartRadius:0,borderEndStartRadius:0,[`${t}-select ${t}-select-selector`]:{borderStartStartRadius:0,borderEndStartRadius:0}},[`${e}-affix-wrapper`]:{"&:not(:last-child)":{borderStartEndRadius:0,borderEndEndRadius:0,[`${e}-search &`]:{borderStartStartRadius:n.borderRadius,borderEndStartRadius:n.borderRadius}},[`&:not(:first-child), ${e}-search &:not(:first-child)`]:{borderStartStartRadius:0,borderEndStartRadius:0}},[`&${e}-group-compact`]:Object.assign(Object.assign({display:"block"},vb()),{[`${e}-group-addon, ${e}-group-wrap, > ${e}`]:{"&:not(:first-child):not(:last-child)":{borderInlineEndWidth:n.lineWidth,"&:hover, &:focus":{zIndex:1}}},"& > *":{display:"inline-flex",float:"none",verticalAlign:"top",borderRadius:0},[`
        & > ${e}-affix-wrapper,
        & > ${e}-number-affix-wrapper,
        & > ${t}-picker-range
      `]:{display:"inline-flex"},"& > *:not(:last-child)":{marginInlineEnd:n.calc(n.lineWidth).mul(-1).equal(),borderInlineEndWidth:n.lineWidth},[e]:{float:"none"},[`& > ${t}-select > ${t}-select-selector,
      & > ${t}-select-auto-complete ${e},
      & > ${t}-cascader-picker ${e},
      & > ${e}-group-wrapper ${e}`]:{borderInlineEndWidth:n.lineWidth,borderRadius:0,"&:hover, &:focus":{zIndex:1}},[`& > ${t}-select-focused`]:{zIndex:1},[`& > ${t}-select > ${t}-select-arrow`]:{zIndex:1},[`& > *:first-child,
      & > ${t}-select:first-child > ${t}-select-selector,
      & > ${t}-select-auto-complete:first-child ${e},
      & > ${t}-cascader-picker:first-child ${e}`]:{borderStartStartRadius:n.borderRadius,borderEndStartRadius:n.borderRadius},[`& > *:last-child,
      & > ${t}-select:last-child > ${t}-select-selector,
      & > ${t}-cascader-picker:last-child ${e},
      & > ${t}-cascader-picker-focused:last-child ${e}`]:{borderInlineEndWidth:n.lineWidth,borderStartEndRadius:n.borderRadius,borderEndEndRadius:n.borderRadius},[`& > ${t}-select-auto-complete ${e}`]:{verticalAlign:"top"},[`${e}-group-wrapper + ${e}-group-wrapper`]:{marginInlineStart:n.calc(n.lineWidth).mul(-1).equal(),[`${e}-affix-wrapper`]:{borderRadius:0}},[`${e}-group-wrapper:not(:last-child)`]:{[`&${e}-search > ${e}-group`]:{[`& > ${e}-group-addon > ${e}-search-button`]:{borderRadius:0},[`& > ${e}`]:{borderStartStartRadius:n.borderRadius,borderStartEndRadius:0,borderEndEndRadius:0,borderEndStartRadius:n.borderRadius}}}})}},yde=n=>{const{componentCls:e,controlHeightSM:t,lineWidth:i,calc:a}=n,r=a(t).sub(a(i).mul(2)).sub(16).div(2).equal();return{[e]:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Po(n)),zM(n)),Ide(n)),Ade(n)),fde(n)),pde(n)),{'&[type="color"]':{height:n.controlHeight,[`&${e}-lg`]:{height:n.controlHeightLG},[`&${e}-sm`]:{height:t,paddingTop:r,paddingBottom:r}},'&[type="search"]::-webkit-search-cancel-button, &[type="search"]::-webkit-search-decoration':{appearance:"none"}})}},Bde=n=>{const{componentCls:e}=n;return{[`${e}-clear-icon`]:{margin:0,padding:0,lineHeight:0,color:n.colorTextQuaternary,fontSize:n.fontSizeIcon,verticalAlign:-1,cursor:"pointer",transition:`color ${n.motionDurationSlow}`,border:"none",outline:"none",backgroundColor:"transparent","&:hover":{color:n.colorTextTertiary},"&:active":{color:n.colorText},"&-hidden":{visibility:"hidden"},"&-has-suffix":{margin:`0 ${st(n.inputAffixPadding)}`}}}},Gde=n=>{const{componentCls:e,inputAffixPadding:t,colorTextDescription:i,motionDurationSlow:a,colorIcon:o,colorIconHover:r,iconCls:s}=n,l=`${e}-affix-wrapper`,c=`${e}-affix-wrapper-disabled`;return{[l]:Object.assign(Object.assign(Object.assign(Object.assign({},zM(n)),{display:"inline-flex",[`&:not(${e}-disabled):hover`]:{zIndex:1,[`${e}-search-with-button &`]:{zIndex:0}},"&-focused, &:focus":{zIndex:1},[`> input${e}`]:{padding:0},[`> input${e}, > textarea${e}`]:{fontSize:"inherit",border:"none",borderRadius:0,outline:"none",background:"transparent",color:"inherit","&::-ms-reveal":{display:"none"},"&:focus":{boxShadow:"none !important"}},"&::before":{display:"inline-block",width:0,visibility:"hidden",content:'"\\a0"'},[e]:{"&-prefix, &-suffix":{display:"flex",flex:"none",alignItems:"center","> *:not(:last-child)":{marginInlineEnd:n.paddingXS}},"&-show-count-suffix":{color:i},"&-show-count-has-suffix":{marginInlineEnd:n.paddingXXS},"&-prefix":{marginInlineEnd:t},"&-suffix":{marginInlineStart:t}}}),Bde(n)),{[`${s}${e}-password-icon`]:{color:o,cursor:"pointer",transition:`all ${a}`,"&:hover":{color:r}}}),[`${e}-underlined`]:{borderRadius:0},[c]:{[`${s}${e}-password-icon`]:{color:o,cursor:"not-allowed","&:hover":{color:o}}}}},Sde=n=>{const{componentCls:e,borderRadiusLG:t,borderRadiusSM:i}=n;return{[`${e}-group`]:Object.assign(Object.assign(Object.assign({},Po(n)),vde(n)),{"&-rtl":{direction:"rtl"},"&-wrapper":Object.assign(Object.assign(Object.assign({display:"inline-block",width:"100%",textAlign:"start",verticalAlign:"top","&-rtl":{direction:"rtl"},"&-lg":{[`${e}-group-addon`]:{borderRadius:t,fontSize:n.inputFontSizeLG}},"&-sm":{[`${e}-group-addon`]:{borderRadius:i}}},hde(n)),mde(n)),{[`&:not(${e}-compact-first-item):not(${e}-compact-last-item)${e}-compact-item`]:{[`${e}, ${e}-group-addon`]:{borderRadius:0}},[`&:not(${e}-compact-last-item)${e}-compact-first-item`]:{[`${e}, ${e}-group-addon`]:{borderStartEndRadius:0,borderEndEndRadius:0}},[`&:not(${e}-compact-first-item)${e}-compact-last-item`]:{[`${e}, ${e}-group-addon`]:{borderStartStartRadius:0,borderEndStartRadius:0}},[`&:not(${e}-compact-last-item)${e}-compact-item`]:{[`${e}-affix-wrapper`]:{borderStartEndRadius:0,borderEndEndRadius:0}},[`&:not(${e}-compact-first-item)${e}-compact-item`]:{[`${e}-affix-wrapper`]:{borderStartStartRadius:0,borderEndStartRadius:0}}})})}},wde=n=>{const{componentCls:e,antCls:t}=n,i=`${e}-search`;return{[i]:{[e]:{"&:hover, &:focus":{[`+ ${e}-group-addon ${i}-button:not(${t}-btn-primary)`]:{borderInlineStartColor:n.colorPrimaryHover}}},[`${e}-affix-wrapper`]:{height:n.controlHeight,borderRadius:0},[`${e}-lg`]:{lineHeight:n.calc(n.lineHeightLG).sub(2e-4).equal()},[`> ${e}-group`]:{[`> ${e}-group-addon:last-child`]:{insetInlineStart:-1,padding:0,border:0,[`${i}-button`]:{marginInlineEnd:-1,borderStartStartRadius:0,borderEndStartRadius:0,boxShadow:"none"},[`${i}-button:not(${t}-btn-primary)`]:{color:n.colorTextDescription,"&:hover":{color:n.colorPrimaryHover},"&:active":{color:n.colorPrimaryActive},[`&${t}-btn-loading::before`]:{insetInlineStart:0,insetInlineEnd:0,insetBlockStart:0,insetBlockEnd:0}}}},[`${i}-button`]:{height:n.controlHeight,"&:hover, &:focus":{zIndex:1}},"&-large":{[`${e}-affix-wrapper, ${i}-button`]:{height:n.controlHeightLG}},"&-small":{[`${e}-affix-wrapper, ${i}-button`]:{height:n.controlHeightSM}},"&-rtl":{direction:"rtl"},[`&${e}-compact-item`]:{[`&:not(${e}-compact-last-item)`]:{[`${e}-group-addon`]:{[`${e}-search-button`]:{marginInlineEnd:n.calc(n.lineWidth).mul(-1).equal(),borderRadius:0}}},[`&:not(${e}-compact-first-item)`]:{[`${e},${e}-affix-wrapper`]:{borderRadius:0}},[`> ${e}-group-addon ${e}-search-button,
        > ${e},
        ${e}-affix-wrapper`]:{"&:hover, &:focus, &:active":{zIndex:2}},[`> ${e}-affix-wrapper-focused`]:{zIndex:2}}}}},Rde=n=>{const{componentCls:e}=n;return{[`${e}-out-of-range`]:{[`&, & input, & textarea, ${e}-show-count-suffix, ${e}-data-count`]:{color:n.colorError}}}},AK=Oa(["Input","Shared"],n=>{const e=Xi(n,xb(n));return[yde(e),Gde(e)]},Mb,{resetFont:!1}),mK=Oa(["Input","Component"],n=>{const e=Xi(n,xb(n));return[Sde(e),wde(e),Rde(e),BM(e)]},Mb,{resetFont:!1});var pK={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M482 152h60q8 0 8 8v704q0 8-8 8h-60q-8 0-8-8V160q0-8 8-8z"}},{tag:"path",attrs:{d:"M192 474h672q8 0 8 8v60q0 8-8 8H160q-8 0-8-8v-60q0-8 8-8z"}}]},name:"plus",theme:"outlined"},Zde=function(e,t){return v.createElement(io,$t({},e,{ref:t,icon:pK}))},xde=v.forwardRef(Zde);const bS=v.createContext(null);var Mde=function(e){var t=e.activeTabOffset,i=e.horizontal,a=e.rtl,o=e.indicator,r=o===void 0?{}:o,s=r.size,l=r.align,c=l===void 0?"center":l,u=v.useState(),C=rt(u,2),h=C[0],m=C[1],p=v.useRef(),B=Ct.useCallback(function(y){return typeof s=="function"?s(y):typeof s=="number"?s:y},[s]);function b(){mi.cancel(p.current)}return v.useEffect(function(){var y={};if(t)if(i){y.width=B(t.width);var S=a?"right":"left";c==="start"&&(y[S]=t[S]),c==="center"&&(y[S]=t[S]+t.width/2,y.transform=a?"translateX(50%)":"translateX(-50%)"),c==="end"&&(y[S]=t[S]+t.width,y.transform="translateX(-100%)")}else y.height=B(t.height),c==="start"&&(y.top=t.top),c==="center"&&(y.top=t.top+t.height/2,y.transform="translateY(-50%)"),c==="end"&&(y.top=t.top+t.height,y.transform="translateY(-100%)");return b(),p.current=mi(function(){m(y)}),b},[t,i,a,c,B]),{style:h}},H3={width:0,height:0,left:0,top:0};function Wde(n,e,t){return v.useMemo(function(){for(var i,a=new Map,o=e.get((i=n[0])===null||i===void 0?void 0:i.key)||H3,r=o.left+o.width,s=0;s<n.length;s+=1){var l=n[s].key,c=e.get(l);if(!c){var u;c=e.get((u=n[s-1])===null||u===void 0?void 0:u.key)||H3}var C=a.get(l)||Ke({},c);C.right=r-C.left-C.width,a.set(l,C)}return a},[n.map(function(i){return i.key}).join("_"),e,t])}function F3(n,e){var t=v.useRef(n),i=v.useState({}),a=rt(i,2),o=a[1];function r(s){var l=typeof s=="function"?s(t.current):s;l!==t.current&&e(l,t.current),t.current=l,o({})}return[t.current,r]}var Vde=.1,X3=.01,zy=20,T3=Math.pow(.995,zy);function Nde(n,e){var t=v.useState(),i=rt(t,2),a=i[0],o=i[1],r=v.useState(0),s=rt(r,2),l=s[0],c=s[1],u=v.useState(0),C=rt(u,2),h=C[0],m=C[1],p=v.useState(),B=rt(p,2),b=B[0],y=B[1],S=v.useRef();function R(N){var H=N.touches[0],z=H.screenX,_=H.screenY;o({x:z,y:_}),window.clearInterval(S.current)}function Z(N){if(a){var H=N.touches[0],z=H.screenX,_=H.screenY;o({x:z,y:_});var D=z-a.x,P=_-a.y;e(D,P);var $=Date.now();c($),m($-l),y({x:D,y:P})}}function x(){if(a&&(o(null),y(null),b)){var N=b.x/h,H=b.y/h,z=Math.abs(N),_=Math.abs(H);if(Math.max(z,_)<Vde)return;var D=N,P=H;S.current=window.setInterval(function(){if(Math.abs(D)<X3&&Math.abs(P)<X3){window.clearInterval(S.current);return}D*=T3,P*=T3,e(D*zy,P*zy)},zy)}}var M=v.useRef();function E(N){var H=N.deltaX,z=N.deltaY,_=0,D=Math.abs(H),P=Math.abs(z);D===P?_=M.current==="x"?H:z:D>P?(_=H,M.current="x"):(_=z,M.current="y"),e(-_,-_)&&N.preventDefault()}var F=v.useRef(null);F.current={onTouchStart:R,onTouchMove:Z,onTouchEnd:x,onWheel:E},v.useEffect(function(){function N(D){F.current.onTouchStart(D)}function H(D){F.current.onTouchMove(D)}function z(D){F.current.onTouchEnd(D)}function _(D){F.current.onWheel(D)}return document.addEventListener("touchmove",H,{passive:!1}),document.addEventListener("touchend",z,{passive:!0}),n.current.addEventListener("touchstart",N,{passive:!0}),n.current.addEventListener("wheel",_,{passive:!1}),function(){document.removeEventListener("touchmove",H),document.removeEventListener("touchend",z)}},[])}function bK(n){var e=v.useState(0),t=rt(e,2),i=t[0],a=t[1],o=v.useRef(0),r=v.useRef();return r.current=n,SR(function(){var s;(s=r.current)===null||s===void 0||s.call(r)},[i]),function(){o.current===i&&(o.current+=1,a(o.current))}}function Ede(n){var e=v.useRef([]),t=v.useState({}),i=rt(t,2),a=i[1],o=v.useRef(typeof n=="function"?n():n),r=bK(function(){var l=o.current;e.current.forEach(function(c){l=c(l)}),e.current=[],o.current=l,a({})});function s(l){e.current.push(l),r()}return[o.current,s]}var Y3={width:0,height:0,left:0,top:0,right:0};function Hde(n,e,t,i,a,o,r){var s=r.tabs,l=r.tabPosition,c=r.rtl,u,C,h;return["top","bottom"].includes(l)?(u="width",C=c?"right":"left",h=Math.abs(t)):(u="height",C="top",h=-t),v.useMemo(function(){if(!s.length)return[0,0];for(var m=s.length,p=m,B=0;B<m;B+=1){var b=n.get(s[B].key)||Y3;if(Math.floor(b[C]+b[u])>Math.floor(h+e)){p=B-1;break}}for(var y=0,S=m-1;S>=0;S-=1){var R=n.get(s[S].key)||Y3;if(R[C]<h){y=S+1;break}}return y>=p?[0,0]:[y,p]},[n,e,i,a,o,h,l,s.map(function(m){return m.key}).join("_"),c])}function z3(n){var e;return n instanceof Map?(e={},n.forEach(function(t,i){e[i]=t})):e=n,JSON.stringify(e)}var Fde="TABS_DQ";function vK(n){return String(n).replace(/"/g,Fde)}function KM(n,e,t,i){return!(!t||i||n===!1||n===void 0&&(e===!1||e===null))}var yK=v.forwardRef(function(n,e){var t=n.prefixCls,i=n.editable,a=n.locale,o=n.style;return!i||i.showAdd===!1?null:v.createElement("button",{ref:e,type:"button",className:"".concat(t,"-nav-add"),style:o,"aria-label":(a==null?void 0:a.addAriaLabel)||"Add tab",onClick:function(s){i.onEdit("add",{event:s})}},i.addIcon||"+")}),K3=v.forwardRef(function(n,e){var t=n.position,i=n.prefixCls,a=n.extra;if(!a)return null;var o,r={};return Bn(a)==="object"&&!v.isValidElement(a)?r=a:r.right=a,t==="right"&&(o=r.right),t==="left"&&(o=r.left),o?v.createElement("div",{className:"".concat(i,"-extra-content"),ref:e},o):null}),Xde=v.forwardRef(function(n,e){var t=n.prefixCls,i=n.id,a=n.tabs,o=n.locale,r=n.mobile,s=n.more,l=s===void 0?{}:s,c=n.style,u=n.className,C=n.editable,h=n.tabBarGutter,m=n.rtl,p=n.removeAriaLabel,B=n.onTabClick,b=n.getPopupContainer,y=n.popupClassName,S=v.useState(!1),R=rt(S,2),Z=R[0],x=R[1],M=v.useState(null),E=rt(M,2),F=E[0],N=E[1],H=l.icon,z=H===void 0?"More":H,_="".concat(i,"-more-popup"),D="".concat(t,"-dropdown"),P=F!==null?"".concat(_,"-").concat(F):null,$=o==null?void 0:o.dropdownAriaLabel;function X(ne,k){ne.preventDefault(),ne.stopPropagation(),C.onEdit("remove",{key:k,event:ne})}var L=v.createElement(Zb,{onClick:function(k){var ie=k.key,re=k.domEvent;B(ie,re),x(!1)},prefixCls:"".concat(D,"-menu"),id:_,tabIndex:-1,role:"listbox","aria-activedescendant":P,selectedKeys:[F],"aria-label":$!==void 0?$:"expanded dropdown"},a.map(function(ne){var k=ne.closable,ie=ne.disabled,re=ne.closeIcon,ge=ne.key,de=ne.label,xe=KM(k,re,C,ie);return v.createElement(mS,{key:ge,id:"".concat(_,"-").concat(ge),role:"option","aria-controls":i&&"".concat(i,"-panel-").concat(ge),disabled:ie},v.createElement("span",null,de),xe&&v.createElement("button",{type:"button","aria-label":p||"remove",tabIndex:0,className:"".concat(D,"-menu-item-remove"),onClick:function(ye){ye.stopPropagation(),X(ye,ge)}},re||C.removeIcon||""))}));function U(ne){for(var k=a.filter(function(xe){return!xe.disabled}),ie=k.findIndex(function(xe){return xe.key===F})||0,re=k.length,ge=0;ge<re;ge+=1){ie=(ie+ne+re)%re;var de=k[ie];if(!de.disabled){N(de.key);return}}}function q(ne){var k=ne.which;if(!Z){[tn.DOWN,tn.SPACE,tn.ENTER].includes(k)&&(x(!0),ne.preventDefault());return}switch(k){case tn.UP:U(-1),ne.preventDefault();break;case tn.DOWN:U(1),ne.preventDefault();break;case tn.ESC:x(!1);break;case tn.SPACE:case tn.ENTER:F!==null&&B(F,ne);break}}v.useEffect(function(){var ne=document.getElementById(P);ne&&ne.scrollIntoView&&ne.scrollIntoView(!1)},[F]),v.useEffect(function(){Z||N(null)},[Z]);var K=Ve({},m?"marginRight":"marginLeft",h);a.length||(K.visibility="hidden",K.order=1);var O=gt(Ve({},"".concat(D,"-rtl"),m)),j=r?null:v.createElement(Cue,$t({prefixCls:D,overlay:L,visible:a.length?Z:!1,onVisibleChange:x,overlayClassName:gt(O,y),mouseEnterDelay:.1,mouseLeaveDelay:.1,getPopupContainer:b},l),v.createElement("button",{type:"button",className:"".concat(t,"-nav-more"),style:K,"aria-haspopup":"listbox","aria-controls":_,id:"".concat(i,"-more"),"aria-expanded":Z,onKeyDown:q},z));return v.createElement("div",{className:gt("".concat(t,"-nav-operations"),u),style:c,ref:e},j,v.createElement(yK,{prefixCls:t,locale:o,editable:C}))});const Tde=v.memo(Xde,function(n,e){return e.tabMoving});var Yde=function(e){var t=e.prefixCls,i=e.id,a=e.active,o=e.focus,r=e.tab,s=r.key,l=r.label,c=r.disabled,u=r.closeIcon,C=r.icon,h=e.closable,m=e.renderWrapper,p=e.removeAriaLabel,B=e.editable,b=e.onClick,y=e.onFocus,S=e.onBlur,R=e.onKeyDown,Z=e.onMouseDown,x=e.onMouseUp,M=e.style,E=e.tabCount,F=e.currentPosition,N="".concat(t,"-tab"),H=KM(h,u,B,c);function z(X){c||b(X)}function _(X){X.preventDefault(),X.stopPropagation(),B.onEdit("remove",{key:s,event:X})}var D=v.useMemo(function(){return C&&typeof l=="string"?v.createElement("span",null,l):l},[l,C]),P=v.useRef(null);v.useEffect(function(){o&&P.current&&P.current.focus()},[o]);var $=v.createElement("div",{key:s,"data-node-key":vK(s),className:gt(N,Ve(Ve(Ve(Ve({},"".concat(N,"-with-remove"),H),"".concat(N,"-active"),a),"".concat(N,"-disabled"),c),"".concat(N,"-focus"),o)),style:M,onClick:z},v.createElement("div",{ref:P,role:"tab","aria-selected":a,id:i&&"".concat(i,"-tab-").concat(s),className:"".concat(N,"-btn"),"aria-controls":i&&"".concat(i,"-panel-").concat(s),"aria-disabled":c,tabIndex:c?null:a?0:-1,onClick:function(L){L.stopPropagation(),z(L)},onKeyDown:R,onMouseDown:Z,onMouseUp:x,onFocus:y,onBlur:S},o&&v.createElement("div",{"aria-live":"polite",style:{width:0,height:0,position:"absolute",overflow:"hidden",opacity:0}},"Tab ".concat(F," of ").concat(E)),C&&v.createElement("span",{className:"".concat(N,"-icon")},C),l&&D),H&&v.createElement("button",{type:"button",role:"tab","aria-label":p||"remove",tabIndex:a?0:-1,className:"".concat(N,"-remove"),onClick:function(L){L.stopPropagation(),_(L)}},u||B.removeIcon||""));return m?m($):$},zde=function(e,t){var i=e.offsetWidth,a=e.offsetHeight,o=e.offsetTop,r=e.offsetLeft,s=e.getBoundingClientRect(),l=s.width,c=s.height,u=s.left,C=s.top;return Math.abs(l-i)<1?[l,c,u-t.left,C-t.top]:[i,a,r,o]},ef=function(e){var t=e.current||{},i=t.offsetWidth,a=i===void 0?0:i,o=t.offsetHeight,r=o===void 0?0:o;if(e.current){var s=e.current.getBoundingClientRect(),l=s.width,c=s.height;if(Math.abs(l-a)<1)return[l,c]}return[a,r]},ry=function(e,t){return e[t?0:1]},L3=v.forwardRef(function(n,e){var t=n.className,i=n.style,a=n.id,o=n.animated,r=n.activeKey,s=n.rtl,l=n.extra,c=n.editable,u=n.locale,C=n.tabPosition,h=n.tabBarGutter,m=n.children,p=n.onTabClick,B=n.onTabScroll,b=n.indicator,y=v.useContext(bS),S=y.prefixCls,R=y.tabs,Z=v.useRef(null),x=v.useRef(null),M=v.useRef(null),E=v.useRef(null),F=v.useRef(null),N=v.useRef(null),H=v.useRef(null),z=C==="top"||C==="bottom",_=F3(0,function(Ae,se){z&&B&&B({direction:Ae>se?"left":"right"})}),D=rt(_,2),P=D[0],$=D[1],X=F3(0,function(Ae,se){!z&&B&&B({direction:Ae>se?"top":"bottom"})}),L=rt(X,2),U=L[0],q=L[1],K=v.useState([0,0]),O=rt(K,2),j=O[0],ne=O[1],k=v.useState([0,0]),ie=rt(k,2),re=ie[0],ge=ie[1],de=v.useState([0,0]),xe=rt(de,2),Ne=xe[0],ye=xe[1],pe=v.useState([0,0]),Te=rt(pe,2),le=Te[0],Ye=Te[1],he=Ede(new Map),Ge=rt(he,2),be=Ge[0],Ee=Ge[1],Se=Wde(R,be,re[0]),ee=ry(j,z),Q=ry(re,z),ce=ry(Ne,z),me=ry(le,z),Ze=Math.floor(ee)<Math.floor(Q+ce),Xe=Ze?ee-me:ee-ce,De="".concat(S,"-nav-operations-hidden"),Oe=0,Je=0;z&&s?(Oe=0,Je=Math.max(0,Q-Xe)):(Oe=Math.min(0,Xe-Q),Je=0);function At(Ae){return Ae<Oe?Oe:Ae>Je?Je:Ae}var qe=v.useRef(null),lt=v.useState(),$e=rt(lt,2),je=$e[0],ke=$e[1];function Ce(){ke(Date.now())}function He(){qe.current&&clearTimeout(qe.current)}Nde(E,function(Ae,se){function Re(Ue,nt){Ue(function(pt){var it=At(pt+nt);return it})}return Ze?(z?Re($,Ae):Re(q,se),He(),Ce(),!0):!1}),v.useEffect(function(){return He(),je&&(qe.current=setTimeout(function(){ke(0)},100)),He},[je]);var ht=Hde(Se,Xe,z?P:U,Q,ce,me,Ke(Ke({},n),{},{tabs:R})),we=rt(ht,2),ze=we[0],Qe=we[1],ut=Aa(function(){var Ae=arguments.length>0&&arguments[0]!==void 0?arguments[0]:r,se=Se.get(Ae)||{width:0,height:0,left:0,right:0,top:0};if(z){var Re=P;s?se.right<P?Re=se.right:se.right+se.width>P+Xe&&(Re=se.right+se.width-Xe):se.left<-P?Re=-se.left:se.left+se.width>-P+Xe&&(Re=-(se.left+se.width-Xe)),q(0),$(At(Re))}else{var Ue=U;se.top<-U?Ue=-se.top:se.top+se.height>-U+Xe&&(Ue=-(se.top+se.height-Xe)),$(0),q(At(Ue))}}),Rt=v.useState(),mt=rt(Rt,2),_t=mt[0],Lt=mt[1],Zt=v.useState(!1),yt=rt(Zt,2),Ht=yt[0],jt=yt[1],Ut=R.filter(function(Ae){return!Ae.disabled}).map(function(Ae){return Ae.key}),Nt=function(se){var Re=Ut.indexOf(_t||r),Ue=Ut.length,nt=(Re+se+Ue)%Ue,pt=Ut[nt];Lt(pt)},Tt=function(se){var Re=se.code,Ue=s&&z,nt=Ut[0],pt=Ut[Ut.length-1];switch(Re){case"ArrowLeft":{z&&Nt(Ue?1:-1);break}case"ArrowRight":{z&&Nt(Ue?-1:1);break}case"ArrowUp":{se.preventDefault(),z||Nt(-1);break}case"ArrowDown":{se.preventDefault(),z||Nt(1);break}case"Home":{se.preventDefault(),Lt(nt);break}case"End":{se.preventDefault(),Lt(pt);break}case"Enter":case"Space":{se.preventDefault(),p(r,se);break}case"Backspace":case"Delete":{var it=Ut.indexOf(_t),Bt=R.find(function(Yt){return Yt.key===_t}),Mt=KM(Bt==null?void 0:Bt.closable,Bt==null?void 0:Bt.closeIcon,c,Bt==null?void 0:Bt.disabled);Mt&&(se.preventDefault(),se.stopPropagation(),c.onEdit("remove",{key:_t,event:se}),it===Ut.length-1?Nt(-1):Nt(1));break}}},Pt={};z?Pt[s?"marginRight":"marginLeft"]=h:Pt.marginTop=h;var qt=R.map(function(Ae,se){var Re=Ae.key;return v.createElement(Yde,{id:a,prefixCls:S,key:Re,tab:Ae,style:se===0?void 0:Pt,closable:Ae.closable,editable:c,active:Re===r,focus:Re===_t,renderWrapper:m,removeAriaLabel:u==null?void 0:u.removeAriaLabel,tabCount:Ut.length,currentPosition:se+1,onClick:function(nt){p(Re,nt)},onKeyDown:Tt,onFocus:function(){Ht||Lt(Re),ut(Re),Ce(),E.current&&(s||(E.current.scrollLeft=0),E.current.scrollTop=0)},onBlur:function(){Lt(void 0)},onMouseDown:function(){jt(!0)},onMouseUp:function(){jt(!1)}})}),kt=function(){return Ee(function(){var se,Re=new Map,Ue=(se=F.current)===null||se===void 0?void 0:se.getBoundingClientRect();return R.forEach(function(nt){var pt,it=nt.key,Bt=(pt=F.current)===null||pt===void 0?void 0:pt.querySelector('[data-node-key="'.concat(vK(it),'"]'));if(Bt){var Mt=zde(Bt,Ue),Yt=rt(Mt,4),ln=Yt[0],on=Yt[1],vn=Yt[2],nn=Yt[3];Re.set(it,{width:ln,height:on,left:vn,top:nn})}}),Re})};v.useEffect(function(){kt()},[R.map(function(Ae){return Ae.key}).join("_")]);var Ft=bK(function(){var Ae=ef(Z),se=ef(x),Re=ef(M);ne([Ae[0]-se[0]-Re[0],Ae[1]-se[1]-Re[1]]);var Ue=ef(H);ye(Ue);var nt=ef(N);Ye(nt);var pt=ef(F);ge([pt[0]-Ue[0],pt[1]-Ue[1]]),kt()}),fn=R.slice(0,ze),sn=R.slice(Qe+1),ae=[].concat(an(fn),an(sn)),ue=Se.get(r),Fe=Mde({activeTabOffset:ue,horizontal:z,indicator:b,rtl:s}),ot=Fe.style;v.useEffect(function(){ut()},[r,Oe,Je,z3(ue),z3(Se),z]),v.useEffect(function(){Ft()},[s]);var at=!!ae.length,It="".concat(S,"-nav-wrap"),Wt,xt,te,Ie;return z?s?(xt=P>0,Wt=P!==Je):(Wt=P<0,xt=P!==Oe):(te=U<0,Ie=U!==Oe),v.createElement(vl,{onResize:Ft},v.createElement("div",{ref:yI(e,Z),role:"tablist","aria-orientation":z?"horizontal":"vertical",className:gt("".concat(S,"-nav"),t),style:i,onKeyDown:function(){Ce()}},v.createElement(K3,{ref:x,position:"left",extra:l,prefixCls:S}),v.createElement(vl,{onResize:Ft},v.createElement("div",{className:gt(It,Ve(Ve(Ve(Ve({},"".concat(It,"-ping-left"),Wt),"".concat(It,"-ping-right"),xt),"".concat(It,"-ping-top"),te),"".concat(It,"-ping-bottom"),Ie)),ref:E},v.createElement(vl,{onResize:Ft},v.createElement("div",{ref:F,className:"".concat(S,"-nav-list"),style:{transform:"translate(".concat(P,"px, ").concat(U,"px)"),transition:je?"none":void 0}},qt,v.createElement(yK,{ref:H,prefixCls:S,locale:u,editable:c,style:Ke(Ke({},qt.length===0?void 0:Pt),{},{visibility:at?"hidden":null})}),v.createElement("div",{className:gt("".concat(S,"-ink-bar"),Ve({},"".concat(S,"-ink-bar-animated"),o.inkBar)),style:ot}))))),v.createElement(Tde,$t({},n,{removeAriaLabel:u==null?void 0:u.removeAriaLabel,ref:N,prefixCls:S,tabs:ae,className:!at&&De,tabMoving:!!je})),v.createElement(K3,{ref:M,position:"right",extra:l,prefixCls:S})))}),BK=v.forwardRef(function(n,e){var t=n.prefixCls,i=n.className,a=n.style,o=n.id,r=n.active,s=n.tabKey,l=n.children;return v.createElement("div",{id:o&&"".concat(o,"-panel-").concat(s),role:"tabpanel",tabIndex:r?0:-1,"aria-labelledby":o&&"".concat(o,"-tab-").concat(s),"aria-hidden":!r,style:a,className:gt(t,r&&"".concat(t,"-active"),i),ref:e},l)}),Kde=["renderTabBar"],Lde=["label","key"],_de=function(e){var t=e.renderTabBar,i=_n(e,Kde),a=v.useContext(bS),o=a.tabs;if(t){var r=Ke(Ke({},i),{},{panes:o.map(function(s){var l=s.label,c=s.key,u=_n(s,Lde);return v.createElement(BK,$t({tab:l,key:c,tabKey:c},u))})});return t(r,L3)}return v.createElement(L3,i)},Dde=["key","forceRender","style","className","destroyInactiveTabPane"],Ode=function(e){var t=e.id,i=e.activeKey,a=e.animated,o=e.tabPosition,r=e.destroyInactiveTabPane,s=v.useContext(bS),l=s.prefixCls,c=s.tabs,u=a.tabPane,C="".concat(l,"-tabpane");return v.createElement("div",{className:gt("".concat(l,"-content-holder"))},v.createElement("div",{className:gt("".concat(l,"-content"),"".concat(l,"-content-").concat(o),Ve({},"".concat(l,"-content-animated"),u))},c.map(function(h){var m=h.key,p=h.forceRender,B=h.style,b=h.className,y=h.destroyInactiveTabPane,S=_n(h,Dde),R=m===i;return v.createElement(GI,$t({key:m,visible:R,forceRender:p,removeOnLeave:!!(r||y),leavedClassName:"".concat(C,"-hidden")},a.tabPaneMotion),function(Z,x){var M=Z.style,E=Z.className;return v.createElement(BK,$t({},S,{prefixCls:C,id:t,tabKey:m,animated:u,active:R,style:Ke(Ke({},B),M),className:gt(b,E),ref:x}))})})))};function Ude(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{inkBar:!0,tabPane:!1},e;return n===!1?e={inkBar:!1,tabPane:!1}:n===!0?e={inkBar:!0,tabPane:!1}:e=Ke({inkBar:!0},Bn(n)==="object"?n:{}),e.tabPaneMotion&&e.tabPane===void 0&&(e.tabPane=!0),!e.tabPaneMotion&&e.tabPane&&(e.tabPane=!1),e}var kde=["id","prefixCls","className","items","direction","activeKey","defaultActiveKey","editable","animated","tabPosition","tabBarGutter","tabBarStyle","tabBarExtraContent","locale","more","destroyInactiveTabPane","renderTabBar","onChange","onTabClick","onTabScroll","getPopupContainer","popupClassName","indicator"],_3=0,Pde=v.forwardRef(function(n,e){var t=n.id,i=n.prefixCls,a=i===void 0?"rc-tabs":i,o=n.className,r=n.items,s=n.direction,l=n.activeKey,c=n.defaultActiveKey,u=n.editable,C=n.animated,h=n.tabPosition,m=h===void 0?"top":h,p=n.tabBarGutter,B=n.tabBarStyle,b=n.tabBarExtraContent,y=n.locale,S=n.more,R=n.destroyInactiveTabPane,Z=n.renderTabBar,x=n.onChange,M=n.onTabClick,E=n.onTabScroll,F=n.getPopupContainer,N=n.popupClassName,H=n.indicator,z=_n(n,kde),_=v.useMemo(function(){return(r||[]).filter(function(le){return le&&Bn(le)==="object"&&"key"in le})},[r]),D=s==="rtl",P=Ude(C),$=v.useState(!1),X=rt($,2),L=X[0],U=X[1];v.useEffect(function(){U(wM())},[]);var q=_a(function(){var le;return(le=_[0])===null||le===void 0?void 0:le.key},{value:l,defaultValue:c}),K=rt(q,2),O=K[0],j=K[1],ne=v.useState(function(){return _.findIndex(function(le){return le.key===O})}),k=rt(ne,2),ie=k[0],re=k[1];v.useEffect(function(){var le=_.findIndex(function(he){return he.key===O});if(le===-1){var Ye;le=Math.max(0,Math.min(ie,_.length-1)),j((Ye=_[le])===null||Ye===void 0?void 0:Ye.key)}re(le)},[_.map(function(le){return le.key}).join("_"),O,ie]);var ge=_a(null,{value:t}),de=rt(ge,2),xe=de[0],Ne=de[1];v.useEffect(function(){t||(Ne("rc-tabs-".concat(_3)),_3+=1)},[]);function ye(le,Ye){M==null||M(le,Ye);var he=le!==O;j(le),he&&(x==null||x(le))}var pe={id:xe,activeKey:O,animated:P,tabPosition:m,rtl:D,mobile:L},Te=Ke(Ke({},pe),{},{editable:u,locale:y,more:S,tabBarGutter:p,onTabClick:ye,onTabScroll:E,extra:b,style:B,panes:null,getPopupContainer:F,popupClassName:N,indicator:H});return v.createElement(bS.Provider,{value:{tabs:_,prefixCls:a}},v.createElement("div",$t({ref:e,id:t,className:gt(a,"".concat(a,"-").concat(m),Ve(Ve(Ve({},"".concat(a,"-mobile"),L),"".concat(a,"-editable"),u),"".concat(a,"-rtl"),D),o)},z),v.createElement(_de,$t({},Te,{renderTabBar:Z})),v.createElement(Ode,$t({destroyInactiveTabPane:R},pe,{animated:P}))))});const Jde={motionAppear:!1,motionEnter:!0,motionLeave:!0};function jde(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{inkBar:!0,tabPane:!1},t;return e===!1?t={inkBar:!1,tabPane:!1}:e===!0?t={inkBar:!0,tabPane:!0}:t=Object.assign({inkBar:!0},typeof e=="object"?e:{}),t.tabPane&&(t.tabPaneMotion=Object.assign(Object.assign({},Jde),{motionName:mM(n,"switch")})),t}var Qde=function(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(n);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(n,i[a])&&(t[i[a]]=n[i[a]]);return t};function qde(n){return n.filter(e=>e)}function $de(n,e){if(n)return n;const t=Ic(e).map(i=>{if(v.isValidElement(i)){const{key:a,props:o}=i,r=o||{},{tab:s}=r,l=Qde(r,["tab"]);return Object.assign(Object.assign({key:String(a)},l),{label:s})}return null});return qde(t)}const eCe=n=>{const{componentCls:e,motionDurationSlow:t}=n;return[{[e]:{[`${e}-switch`]:{"&-appear, &-enter":{transition:"none","&-start":{opacity:0},"&-active":{opacity:1,transition:`opacity ${t}`}},"&-leave":{position:"absolute",transition:"none",inset:0,"&-start":{opacity:1},"&-active":{opacity:0,transition:`opacity ${t}`}}}}},[kB(n,"slide-up"),kB(n,"slide-down")]]},tCe=n=>{const{componentCls:e,tabsCardPadding:t,cardBg:i,cardGutter:a,colorBorderSecondary:o,itemSelectedColor:r}=n;return{[`${e}-card`]:{[`> ${e}-nav, > div > ${e}-nav`]:{[`${e}-tab`]:{margin:0,padding:t,background:i,border:`${st(n.lineWidth)} ${n.lineType} ${o}`,transition:`all ${n.motionDurationSlow} ${n.motionEaseInOut}`},[`${e}-tab-active`]:{color:r,background:n.colorBgContainer},[`${e}-tab-focus`]:Object.assign({},II(n,-3)),[`${e}-ink-bar`]:{visibility:"hidden"},[`& ${e}-tab${e}-tab-focus ${e}-tab-btn`]:{outline:"none"}},[`&${e}-top, &${e}-bottom`]:{[`> ${e}-nav, > div > ${e}-nav`]:{[`${e}-tab + ${e}-tab`]:{marginLeft:{_skip_check_:!0,value:st(a)}}}},[`&${e}-top`]:{[`> ${e}-nav, > div > ${e}-nav`]:{[`${e}-tab`]:{borderRadius:`${st(n.borderRadiusLG)} ${st(n.borderRadiusLG)} 0 0`},[`${e}-tab-active`]:{borderBottomColor:n.colorBgContainer}}},[`&${e}-bottom`]:{[`> ${e}-nav, > div > ${e}-nav`]:{[`${e}-tab`]:{borderRadius:`0 0 ${st(n.borderRadiusLG)} ${st(n.borderRadiusLG)}`},[`${e}-tab-active`]:{borderTopColor:n.colorBgContainer}}},[`&${e}-left, &${e}-right`]:{[`> ${e}-nav, > div > ${e}-nav`]:{[`${e}-tab + ${e}-tab`]:{marginTop:st(a)}}},[`&${e}-left`]:{[`> ${e}-nav, > div > ${e}-nav`]:{[`${e}-tab`]:{borderRadius:{_skip_check_:!0,value:`${st(n.borderRadiusLG)} 0 0 ${st(n.borderRadiusLG)}`}},[`${e}-tab-active`]:{borderRightColor:{_skip_check_:!0,value:n.colorBgContainer}}}},[`&${e}-right`]:{[`> ${e}-nav, > div > ${e}-nav`]:{[`${e}-tab`]:{borderRadius:{_skip_check_:!0,value:`0 ${st(n.borderRadiusLG)} ${st(n.borderRadiusLG)} 0`}},[`${e}-tab-active`]:{borderLeftColor:{_skip_check_:!0,value:n.colorBgContainer}}}}}}},nCe=n=>{const{componentCls:e,itemHoverColor:t,dropdownEdgeChildVerticalPadding:i}=n;return{[`${e}-dropdown`]:Object.assign(Object.assign({},Po(n)),{position:"absolute",top:-9999,left:{_skip_check_:!0,value:-9999},zIndex:n.zIndexPopup,display:"block","&-hidden":{display:"none"},[`${e}-dropdown-menu`]:{maxHeight:n.tabsDropdownHeight,margin:0,padding:`${st(i)} 0`,overflowX:"hidden",overflowY:"auto",textAlign:{_skip_check_:!0,value:"left"},listStyleType:"none",backgroundColor:n.colorBgContainer,backgroundClip:"padding-box",borderRadius:n.borderRadiusLG,outline:"none",boxShadow:n.boxShadowSecondary,"&-item":Object.assign(Object.assign({},Tf),{display:"flex",alignItems:"center",minWidth:n.tabsDropdownWidth,margin:0,padding:`${st(n.paddingXXS)} ${st(n.paddingSM)}`,color:n.colorText,fontWeight:"normal",fontSize:n.fontSize,lineHeight:n.lineHeight,cursor:"pointer",transition:`all ${n.motionDurationSlow}`,"> span":{flex:1,whiteSpace:"nowrap"},"&-remove":{flex:"none",marginLeft:{_skip_check_:!0,value:n.marginSM},color:n.colorTextDescription,fontSize:n.fontSizeSM,background:"transparent",border:0,cursor:"pointer","&:hover":{color:t}},"&:hover":{background:n.controlItemBgHover},"&-disabled":{"&, &:hover":{color:n.colorTextDisabled,background:"transparent",cursor:"not-allowed"}}})}})}},iCe=n=>{const{componentCls:e,margin:t,colorBorderSecondary:i,horizontalMargin:a,verticalItemPadding:o,verticalItemMargin:r,calc:s}=n;return{[`${e}-top, ${e}-bottom`]:{flexDirection:"column",[`> ${e}-nav, > div > ${e}-nav`]:{margin:a,"&::before":{position:"absolute",right:{_skip_check_:!0,value:0},left:{_skip_check_:!0,value:0},borderBottom:`${st(n.lineWidth)} ${n.lineType} ${i}`,content:"''"},[`${e}-ink-bar`]:{height:n.lineWidthBold,"&-animated":{transition:`width ${n.motionDurationSlow}, left ${n.motionDurationSlow},
            right ${n.motionDurationSlow}`}},[`${e}-nav-wrap`]:{"&::before, &::after":{top:0,bottom:0,width:n.controlHeight},"&::before":{left:{_skip_check_:!0,value:0},boxShadow:n.boxShadowTabsOverflowLeft},"&::after":{right:{_skip_check_:!0,value:0},boxShadow:n.boxShadowTabsOverflowRight},[`&${e}-nav-wrap-ping-left::before`]:{opacity:1},[`&${e}-nav-wrap-ping-right::after`]:{opacity:1}}}},[`${e}-top`]:{[`> ${e}-nav,
        > div > ${e}-nav`]:{"&::before":{bottom:0},[`${e}-ink-bar`]:{bottom:0}}},[`${e}-bottom`]:{[`> ${e}-nav, > div > ${e}-nav`]:{order:1,marginTop:t,marginBottom:0,"&::before":{top:0},[`${e}-ink-bar`]:{top:0}},[`> ${e}-content-holder, > div > ${e}-content-holder`]:{order:0}},[`${e}-left, ${e}-right`]:{[`> ${e}-nav, > div > ${e}-nav`]:{flexDirection:"column",minWidth:s(n.controlHeight).mul(1.25).equal(),[`${e}-tab`]:{padding:o,textAlign:"center"},[`${e}-tab + ${e}-tab`]:{margin:r},[`${e}-nav-wrap`]:{flexDirection:"column","&::before, &::after":{right:{_skip_check_:!0,value:0},left:{_skip_check_:!0,value:0},height:n.controlHeight},"&::before":{top:0,boxShadow:n.boxShadowTabsOverflowTop},"&::after":{bottom:0,boxShadow:n.boxShadowTabsOverflowBottom},[`&${e}-nav-wrap-ping-top::before`]:{opacity:1},[`&${e}-nav-wrap-ping-bottom::after`]:{opacity:1}},[`${e}-ink-bar`]:{width:n.lineWidthBold,"&-animated":{transition:`height ${n.motionDurationSlow}, top ${n.motionDurationSlow}`}},[`${e}-nav-list, ${e}-nav-operations`]:{flex:"1 0 auto",flexDirection:"column"}}},[`${e}-left`]:{[`> ${e}-nav, > div > ${e}-nav`]:{[`${e}-ink-bar`]:{right:{_skip_check_:!0,value:0}}},[`> ${e}-content-holder, > div > ${e}-content-holder`]:{marginLeft:{_skip_check_:!0,value:st(s(n.lineWidth).mul(-1).equal())},borderLeft:{_skip_check_:!0,value:`${st(n.lineWidth)} ${n.lineType} ${n.colorBorder}`},[`> ${e}-content > ${e}-tabpane`]:{paddingLeft:{_skip_check_:!0,value:n.paddingLG}}}},[`${e}-right`]:{[`> ${e}-nav, > div > ${e}-nav`]:{order:1,[`${e}-ink-bar`]:{left:{_skip_check_:!0,value:0}}},[`> ${e}-content-holder, > div > ${e}-content-holder`]:{order:0,marginRight:{_skip_check_:!0,value:s(n.lineWidth).mul(-1).equal()},borderRight:{_skip_check_:!0,value:`${st(n.lineWidth)} ${n.lineType} ${n.colorBorder}`},[`> ${e}-content > ${e}-tabpane`]:{paddingRight:{_skip_check_:!0,value:n.paddingLG}}}}}},aCe=n=>{const{componentCls:e,cardPaddingSM:t,cardPaddingLG:i,horizontalItemPaddingSM:a,horizontalItemPaddingLG:o}=n;return{[e]:{"&-small":{[`> ${e}-nav`]:{[`${e}-tab`]:{padding:a,fontSize:n.titleFontSizeSM}}},"&-large":{[`> ${e}-nav`]:{[`${e}-tab`]:{padding:o,fontSize:n.titleFontSizeLG}}}},[`${e}-card`]:{[`&${e}-small`]:{[`> ${e}-nav`]:{[`${e}-tab`]:{padding:t}},[`&${e}-bottom`]:{[`> ${e}-nav ${e}-tab`]:{borderRadius:`0 0 ${st(n.borderRadius)} ${st(n.borderRadius)}`}},[`&${e}-top`]:{[`> ${e}-nav ${e}-tab`]:{borderRadius:`${st(n.borderRadius)} ${st(n.borderRadius)} 0 0`}},[`&${e}-right`]:{[`> ${e}-nav ${e}-tab`]:{borderRadius:{_skip_check_:!0,value:`0 ${st(n.borderRadius)} ${st(n.borderRadius)} 0`}}},[`&${e}-left`]:{[`> ${e}-nav ${e}-tab`]:{borderRadius:{_skip_check_:!0,value:`${st(n.borderRadius)} 0 0 ${st(n.borderRadius)}`}}}},[`&${e}-large`]:{[`> ${e}-nav`]:{[`${e}-tab`]:{padding:i}}}}}},oCe=n=>{const{componentCls:e,itemActiveColor:t,itemHoverColor:i,iconCls:a,tabsHorizontalItemMargin:o,horizontalItemPadding:r,itemSelectedColor:s,itemColor:l}=n,c=`${e}-tab`;return{[c]:{position:"relative",WebkitTouchCallout:"none",WebkitTapHighlightColor:"transparent",display:"inline-flex",alignItems:"center",padding:r,fontSize:n.titleFontSize,background:"transparent",border:0,outline:"none",cursor:"pointer",color:l,"&-btn, &-remove":{"&:focus:not(:focus-visible), &:active":{color:t}},"&-btn":{outline:"none",transition:`all ${n.motionDurationSlow}`,[`${c}-icon:not(:last-child)`]:{marginInlineEnd:n.marginSM}},"&-remove":Object.assign({flex:"none",marginRight:{_skip_check_:!0,value:n.calc(n.marginXXS).mul(-1).equal()},marginLeft:{_skip_check_:!0,value:n.marginXS},color:n.colorTextDescription,fontSize:n.fontSizeSM,background:"transparent",border:"none",outline:"none",cursor:"pointer",transition:`all ${n.motionDurationSlow}`,"&:hover":{color:n.colorTextHeading}},Yf(n)),"&:hover":{color:i},[`&${c}-active ${c}-btn`]:{color:s,textShadow:n.tabsActiveTextShadow},[`&${c}-focus ${c}-btn`]:Object.assign({},II(n)),[`&${c}-disabled`]:{color:n.colorTextDisabled,cursor:"not-allowed"},[`&${c}-disabled ${c}-btn, &${c}-disabled ${e}-remove`]:{"&:focus, &:active":{color:n.colorTextDisabled}},[`& ${c}-remove ${a}`]:{margin:0},[`${a}:not(:last-child)`]:{marginRight:{_skip_check_:!0,value:n.marginSM}}},[`${c} + ${c}`]:{margin:{_skip_check_:!0,value:o}}}},rCe=n=>{const{componentCls:e,tabsHorizontalItemMarginRTL:t,iconCls:i,cardGutter:a,calc:o}=n;return{[`${e}-rtl`]:{direction:"rtl",[`${e}-nav`]:{[`${e}-tab`]:{margin:{_skip_check_:!0,value:t},[`${e}-tab:last-of-type`]:{marginLeft:{_skip_check_:!0,value:0}},[i]:{marginRight:{_skip_check_:!0,value:0},marginLeft:{_skip_check_:!0,value:st(n.marginSM)}},[`${e}-tab-remove`]:{marginRight:{_skip_check_:!0,value:st(n.marginXS)},marginLeft:{_skip_check_:!0,value:st(o(n.marginXXS).mul(-1).equal())},[i]:{margin:0}}}},[`&${e}-left`]:{[`> ${e}-nav`]:{order:1},[`> ${e}-content-holder`]:{order:0}},[`&${e}-right`]:{[`> ${e}-nav`]:{order:0},[`> ${e}-content-holder`]:{order:1}},[`&${e}-card${e}-top, &${e}-card${e}-bottom`]:{[`> ${e}-nav, > div > ${e}-nav`]:{[`${e}-tab + ${e}-tab`]:{marginRight:{_skip_check_:!0,value:a},marginLeft:{_skip_check_:!0,value:0}}}}},[`${e}-dropdown-rtl`]:{direction:"rtl"},[`${e}-menu-item`]:{[`${e}-dropdown-rtl`]:{textAlign:{_skip_check_:!0,value:"right"}}}}},sCe=n=>{const{componentCls:e,tabsCardPadding:t,cardHeight:i,cardGutter:a,itemHoverColor:o,itemActiveColor:r,colorBorderSecondary:s}=n;return{[e]:Object.assign(Object.assign(Object.assign(Object.assign({},Po(n)),{display:"flex",[`> ${e}-nav, > div > ${e}-nav`]:{position:"relative",display:"flex",flex:"none",alignItems:"center",[`${e}-nav-wrap`]:{position:"relative",display:"flex",flex:"auto",alignSelf:"stretch",overflow:"hidden",whiteSpace:"nowrap",transform:"translate(0)","&::before, &::after":{position:"absolute",zIndex:1,opacity:0,transition:`opacity ${n.motionDurationSlow}`,content:"''",pointerEvents:"none"}},[`${e}-nav-list`]:{position:"relative",display:"flex",transition:`opacity ${n.motionDurationSlow}`},[`${e}-nav-operations`]:{display:"flex",alignSelf:"stretch"},[`${e}-nav-operations-hidden`]:{position:"absolute",visibility:"hidden",pointerEvents:"none"},[`${e}-nav-more`]:{position:"relative",padding:t,background:"transparent",border:0,color:n.colorText,"&::after":{position:"absolute",right:{_skip_check_:!0,value:0},bottom:0,left:{_skip_check_:!0,value:0},height:n.calc(n.controlHeightLG).div(8).equal(),transform:"translateY(100%)",content:"''"}},[`${e}-nav-add`]:Object.assign({minWidth:i,marginLeft:{_skip_check_:!0,value:a},padding:st(n.paddingXS),background:"transparent",border:`${st(n.lineWidth)} ${n.lineType} ${s}`,borderRadius:`${st(n.borderRadiusLG)} ${st(n.borderRadiusLG)} 0 0`,outline:"none",cursor:"pointer",color:n.colorText,transition:`all ${n.motionDurationSlow} ${n.motionEaseInOut}`,"&:hover":{color:o},"&:active, &:focus:not(:focus-visible)":{color:r}},Yf(n,-3))},[`${e}-extra-content`]:{flex:"none"},[`${e}-ink-bar`]:{position:"absolute",background:n.inkBarColor,pointerEvents:"none"}}),oCe(n)),{[`${e}-content`]:{position:"relative",width:"100%"},[`${e}-content-holder`]:{flex:"auto",minWidth:0,minHeight:0},[`${e}-tabpane`]:Object.assign(Object.assign({},Yf(n)),{"&-hidden":{display:"none"}})}),[`${e}-centered`]:{[`> ${e}-nav, > div > ${e}-nav`]:{[`${e}-nav-wrap`]:{[`&:not([class*='${e}-nav-wrap-ping']) > ${e}-nav-list`]:{margin:"auto"}}}}}},lCe=n=>{const e=n.controlHeightLG;return{zIndexPopup:n.zIndexPopupBase+50,cardBg:n.colorFillAlter,cardHeight:e,cardPadding:`${(e-Math.round(n.fontSize*n.lineHeight))/2-n.lineWidth}px ${n.padding}px`,cardPaddingSM:`${n.paddingXXS*1.5}px ${n.padding}px`,cardPaddingLG:`${n.paddingXS}px ${n.padding}px ${n.paddingXXS*1.5}px`,titleFontSize:n.fontSize,titleFontSizeLG:n.fontSizeLG,titleFontSizeSM:n.fontSize,inkBarColor:n.colorPrimary,horizontalMargin:`0 0 ${n.margin}px 0`,horizontalItemGutter:32,horizontalItemMargin:"",horizontalItemMarginRTL:"",horizontalItemPadding:`${n.paddingSM}px 0`,horizontalItemPaddingSM:`${n.paddingXS}px 0`,horizontalItemPaddingLG:`${n.padding}px 0`,verticalItemPadding:`${n.paddingXS}px ${n.paddingLG}px`,verticalItemMargin:`${n.margin}px 0 0 0`,itemColor:n.colorText,itemSelectedColor:n.colorPrimary,itemHoverColor:n.colorPrimaryHover,itemActiveColor:n.colorPrimaryActive,cardGutter:n.marginXXS/2}},cCe=Oa("Tabs",n=>{const e=Xi(n,{tabsCardPadding:n.cardPadding,dropdownEdgeChildVerticalPadding:n.paddingXXS,tabsActiveTextShadow:"0 0 0.25px currentcolor",tabsDropdownHeight:200,tabsDropdownWidth:120,tabsHorizontalItemMargin:`0 0 0 ${st(n.horizontalItemGutter)}`,tabsHorizontalItemMarginRTL:`0 0 0 ${st(n.horizontalItemGutter)}`});return[aCe(e),rCe(e),iCe(e),nCe(e),tCe(e),sCe(e),eCe(e)]},lCe),gCe=()=>null;var uCe=function(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(n);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(n,i[a])&&(t[i[a]]=n[i[a]]);return t};const GK=n=>{var e,t,i,a,o,r,s,l,c,u,C;const{type:h,className:m,rootClassName:p,size:B,onEdit:b,hideAdd:y,centered:S,addIcon:R,removeIcon:Z,moreIcon:x,more:M,popupClassName:E,children:F,items:N,animated:H,style:z,indicatorSize:_,indicator:D}=n,P=uCe(n,["type","className","rootClassName","size","onEdit","hideAdd","centered","addIcon","removeIcon","moreIcon","more","popupClassName","children","items","animated","style","indicatorSize","indicator"]),{prefixCls:$}=P,{direction:X,tabs:L,getPrefixCls:U,getPopupContainer:q}=v.useContext(ui),K=U("tabs",$),O=tA(K),[j,ne,k]=cCe(K,O);let ie;h==="editable-card"&&(ie={onEdit:(pe,Te)=>{let{key:le,event:Ye}=Te;b==null||b(pe==="add"?Ye:le,pe)},removeIcon:(e=Z??(L==null?void 0:L.removeIcon))!==null&&e!==void 0?e:v.createElement($Y,null),addIcon:(R??(L==null?void 0:L.addIcon))||v.createElement(xde,null),showAdd:y!==!0});const re=U(),ge=Sl(B),de=$de(N,F),xe=jde(K,H),Ne=Object.assign(Object.assign({},L==null?void 0:L.style),z),ye={align:(t=D==null?void 0:D.align)!==null&&t!==void 0?t:(i=L==null?void 0:L.indicator)===null||i===void 0?void 0:i.align,size:(s=(o=(a=D==null?void 0:D.size)!==null&&a!==void 0?a:_)!==null&&o!==void 0?o:(r=L==null?void 0:L.indicator)===null||r===void 0?void 0:r.size)!==null&&s!==void 0?s:L==null?void 0:L.indicatorSize};return j(v.createElement(Pde,Object.assign({direction:X,getPopupContainer:q},P,{items:de,className:gt({[`${K}-${ge}`]:ge,[`${K}-card`]:["card","editable-card"].includes(h),[`${K}-editable-card`]:h==="editable-card",[`${K}-centered`]:S},L==null?void 0:L.className,m,p,ne,k,O),popupClassName:gt(E,ne,k,O),style:Ne,editable:ie,more:Object.assign({icon:(C=(u=(c=(l=L==null?void 0:L.more)===null||l===void 0?void 0:l.icon)!==null&&c!==void 0?c:L==null?void 0:L.moreIcon)!==null&&u!==void 0?u:x)!==null&&C!==void 0?C:v.createElement(jue,null),transitionName:`${re}-slide-up`},M),prefixCls:K,animated:xe,indicator:ye})))};GK.TabPane=gCe;var dCe=function(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(n);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(n,i[a])&&(t[i[a]]=n[i[a]]);return t};const SK=n=>{var{prefixCls:e,className:t,hoverable:i=!0}=n,a=dCe(n,["prefixCls","className","hoverable"]);const{getPrefixCls:o}=v.useContext(ui),r=o("card",e),s=gt(`${r}-grid`,t,{[`${r}-grid-hoverable`]:i});return v.createElement("div",Object.assign({},a,{className:s}))},CCe=n=>{const{antCls:e,componentCls:t,headerHeight:i,headerPadding:a,tabsMarginBottom:o}=n;return Object.assign(Object.assign({display:"flex",justifyContent:"center",flexDirection:"column",minHeight:i,marginBottom:-1,padding:`0 ${st(a)}`,color:n.colorTextHeading,fontWeight:n.fontWeightStrong,fontSize:n.headerFontSize,background:n.headerBg,borderBottom:`${st(n.lineWidth)} ${n.lineType} ${n.colorBorderSecondary}`,borderRadius:`${st(n.borderRadiusLG)} ${st(n.borderRadiusLG)} 0 0`},vb()),{"&-wrapper":{width:"100%",display:"flex",alignItems:"center"},"&-title":Object.assign(Object.assign({display:"inline-block",flex:1},Tf),{[`
          > ${t}-typography,
          > ${t}-typography-edit-content
        `]:{insetInlineStart:0,marginTop:0,marginBottom:0}}),[`${e}-tabs-top`]:{clear:"both",marginBottom:o,color:n.colorText,fontWeight:"normal",fontSize:n.fontSize,"&-bar":{borderBottom:`${st(n.lineWidth)} ${n.lineType} ${n.colorBorderSecondary}`}}})},ICe=n=>{const{cardPaddingBase:e,colorBorderSecondary:t,cardShadow:i,lineWidth:a}=n;return{width:"33.33%",padding:e,border:0,borderRadius:0,boxShadow:`
      ${st(a)} 0 0 0 ${t},
      0 ${st(a)} 0 0 ${t},
      ${st(a)} ${st(a)} 0 0 ${t},
      ${st(a)} 0 0 0 ${t} inset,
      0 ${st(a)} 0 0 ${t} inset;
    `,transition:`all ${n.motionDurationMid}`,"&-hoverable:hover":{position:"relative",zIndex:1,boxShadow:i}}},hCe=n=>{const{componentCls:e,iconCls:t,actionsLiMargin:i,cardActionsIconSize:a,colorBorderSecondary:o,actionsBg:r}=n;return Object.assign(Object.assign({margin:0,padding:0,listStyle:"none",background:r,borderTop:`${st(n.lineWidth)} ${n.lineType} ${o}`,display:"flex",borderRadius:`0 0 ${st(n.borderRadiusLG)} ${st(n.borderRadiusLG)}`},vb()),{"& > li":{margin:i,color:n.colorTextDescription,textAlign:"center","> span":{position:"relative",display:"block",minWidth:n.calc(n.cardActionsIconSize).mul(2).equal(),fontSize:n.fontSize,lineHeight:n.lineHeight,cursor:"pointer","&:hover":{color:n.colorPrimary,transition:`color ${n.motionDurationMid}`},[`a:not(${e}-btn), > ${t}`]:{display:"inline-block",width:"100%",color:n.colorTextDescription,lineHeight:st(n.fontHeight),transition:`color ${n.motionDurationMid}`,"&:hover":{color:n.colorPrimary}},[`> ${t}`]:{fontSize:a,lineHeight:st(n.calc(a).mul(n.lineHeight).equal())}},"&:not(:last-child)":{borderInlineEnd:`${st(n.lineWidth)} ${n.lineType} ${o}`}}})},fCe=n=>Object.assign(Object.assign({margin:`${st(n.calc(n.marginXXS).mul(-1).equal())} 0`,display:"flex"},vb()),{"&-avatar":{paddingInlineEnd:n.padding},"&-detail":{overflow:"hidden",flex:1,"> div:not(:last-child)":{marginBottom:n.marginXS}},"&-title":Object.assign({color:n.colorTextHeading,fontWeight:n.fontWeightStrong,fontSize:n.fontSizeLG},Tf),"&-description":{color:n.colorTextDescription}}),ACe=n=>{const{componentCls:e,colorFillAlter:t,headerPadding:i,bodyPadding:a}=n;return{[`${e}-head`]:{padding:`0 ${st(i)}`,background:t,"&-title":{fontSize:n.fontSize}},[`${e}-body`]:{padding:`${st(n.padding)} ${st(a)}`}}},mCe=n=>{const{componentCls:e}=n;return{overflow:"hidden",[`${e}-body`]:{userSelect:"none"}}},pCe=n=>{const{componentCls:e,cardShadow:t,cardHeadPadding:i,colorBorderSecondary:a,boxShadowTertiary:o,bodyPadding:r,extraColor:s}=n;return{[e]:Object.assign(Object.assign({},Po(n)),{position:"relative",background:n.colorBgContainer,borderRadius:n.borderRadiusLG,[`&:not(${e}-bordered)`]:{boxShadow:o},[`${e}-head`]:CCe(n),[`${e}-extra`]:{marginInlineStart:"auto",color:s,fontWeight:"normal",fontSize:n.fontSize},[`${e}-body`]:Object.assign({padding:r,borderRadius:`0 0 ${st(n.borderRadiusLG)} ${st(n.borderRadiusLG)}`},vb()),[`${e}-grid`]:ICe(n),[`${e}-cover`]:{"> *":{display:"block",width:"100%",borderRadius:`${st(n.borderRadiusLG)} ${st(n.borderRadiusLG)} 0 0`}},[`${e}-actions`]:hCe(n),[`${e}-meta`]:fCe(n)}),[`${e}-bordered`]:{border:`${st(n.lineWidth)} ${n.lineType} ${a}`,[`${e}-cover`]:{marginTop:-1,marginInlineStart:-1,marginInlineEnd:-1}},[`${e}-hoverable`]:{cursor:"pointer",transition:`box-shadow ${n.motionDurationMid}, border-color ${n.motionDurationMid}`,"&:hover":{borderColor:"transparent",boxShadow:t}},[`${e}-contain-grid`]:{borderRadius:`${st(n.borderRadiusLG)} ${st(n.borderRadiusLG)} 0 0 `,[`${e}-body`]:{display:"flex",flexWrap:"wrap"},[`&:not(${e}-loading) ${e}-body`]:{marginBlockStart:n.calc(n.lineWidth).mul(-1).equal(),marginInlineStart:n.calc(n.lineWidth).mul(-1).equal(),padding:0}},[`${e}-contain-tabs`]:{[`> div${e}-head`]:{minHeight:0,[`${e}-head-title, ${e}-extra`]:{paddingTop:i}}},[`${e}-type-inner`]:ACe(n),[`${e}-loading`]:mCe(n),[`${e}-rtl`]:{direction:"rtl"}}},bCe=n=>{const{componentCls:e,bodyPaddingSM:t,headerPaddingSM:i,headerHeightSM:a,headerFontSizeSM:o}=n;return{[`${e}-small`]:{[`> ${e}-head`]:{minHeight:a,padding:`0 ${st(i)}`,fontSize:o,[`> ${e}-head-wrapper`]:{[`> ${e}-extra`]:{fontSize:n.fontSize}}},[`> ${e}-body`]:{padding:t}},[`${e}-small${e}-contain-tabs`]:{[`> ${e}-head`]:{[`${e}-head-title, ${e}-extra`]:{paddingTop:0,display:"flex",alignItems:"center"}}}}},vCe=n=>{var e,t;return{headerBg:"transparent",headerFontSize:n.fontSizeLG,headerFontSizeSM:n.fontSize,headerHeight:n.fontSizeLG*n.lineHeightLG+n.padding*2,headerHeightSM:n.fontSize*n.lineHeight+n.paddingXS*2,actionsBg:n.colorBgContainer,actionsLiMargin:`${n.paddingSM}px 0`,tabsMarginBottom:-n.padding-n.lineWidth,extraColor:n.colorText,bodyPaddingSM:12,headerPaddingSM:12,bodyPadding:(e=n.bodyPadding)!==null&&e!==void 0?e:n.paddingLG,headerPadding:(t=n.headerPadding)!==null&&t!==void 0?t:n.paddingLG}},yCe=Oa("Card",n=>{const e=Xi(n,{cardShadow:n.boxShadowCard,cardHeadPadding:n.padding,cardPaddingBase:n.paddingLG,cardActionsIconSize:n.fontSize});return[pCe(e),bCe(e)]},vCe);var D3=function(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(n);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(n,i[a])&&(t[i[a]]=n[i[a]]);return t};const BCe=n=>{const{actionClasses:e,actions:t=[],actionStyle:i}=n;return v.createElement("ul",{className:e,style:i},t.map((a,o)=>{const r=`action-${o}`;return v.createElement("li",{style:{width:`${100/t.length}%`},key:r},v.createElement("span",null,a))}))},GCe=v.forwardRef((n,e)=>{const{prefixCls:t,className:i,rootClassName:a,style:o,extra:r,headStyle:s={},bodyStyle:l={},title:c,loading:u,bordered:C,variant:h,size:m,type:p,cover:B,actions:b,tabList:y,children:S,activeTabKey:R,defaultActiveTabKey:Z,tabBarExtraContent:x,hoverable:M,tabProps:E={},classNames:F,styles:N}=n,H=D3(n,["prefixCls","className","rootClassName","style","extra","headStyle","bodyStyle","title","loading","bordered","variant","size","type","cover","actions","tabList","children","activeTabKey","defaultActiveTabKey","tabBarExtraContent","hoverable","tabProps","classNames","styles"]),{getPrefixCls:z,direction:_,card:D}=v.useContext(ui),[P]=fS("card",h,C),$=Se=>{var ee;(ee=n.onTabChange)===null||ee===void 0||ee.call(n,Se)},X=Se=>{var ee;return gt((ee=D==null?void 0:D.classNames)===null||ee===void 0?void 0:ee[Se],F==null?void 0:F[Se])},L=Se=>{var ee;return Object.assign(Object.assign({},(ee=D==null?void 0:D.styles)===null||ee===void 0?void 0:ee[Se]),N==null?void 0:N[Se])},U=v.useMemo(()=>{let Se=!1;return v.Children.forEach(S,ee=>{(ee==null?void 0:ee.type)===SK&&(Se=!0)}),Se},[S]),q=z("card",t),[K,O,j]=yCe(q),ne=v.createElement(iA,{loading:!0,active:!0,paragraph:{rows:4},title:!1},S),k=R!==void 0,ie=Object.assign(Object.assign({},E),{[k?"activeKey":"defaultActiveKey"]:k?R:Z,tabBarExtraContent:x});let re;const ge=Sl(m),de=!ge||ge==="default"?"large":ge,xe=y?v.createElement(GK,Object.assign({size:de},ie,{className:`${q}-head-tabs`,onChange:$,items:y.map(Se=>{var{tab:ee}=Se,Q=D3(Se,["tab"]);return Object.assign({label:ee},Q)})})):null;if(c||r||xe){const Se=gt(`${q}-head`,X("header")),ee=gt(`${q}-head-title`,X("title")),Q=gt(`${q}-extra`,X("extra")),ce=Object.assign(Object.assign({},s),L("header"));re=v.createElement("div",{className:Se,style:ce},v.createElement("div",{className:`${q}-head-wrapper`},c&&v.createElement("div",{className:ee,style:L("title")},c),r&&v.createElement("div",{className:Q,style:L("extra")},r)),xe)}const Ne=gt(`${q}-cover`,X("cover")),ye=B?v.createElement("div",{className:Ne,style:L("cover")},B):null,pe=gt(`${q}-body`,X("body")),Te=Object.assign(Object.assign({},l),L("body")),le=v.createElement("div",{className:pe,style:Te},u?ne:S),Ye=gt(`${q}-actions`,X("actions")),he=b!=null&&b.length?v.createElement(BCe,{actionClasses:Ye,actionStyle:L("actions"),actions:b}):null,Ge=Ss(H,["onTabChange"]),be=gt(q,D==null?void 0:D.className,{[`${q}-loading`]:u,[`${q}-bordered`]:P!=="borderless",[`${q}-hoverable`]:M,[`${q}-contain-grid`]:U,[`${q}-contain-tabs`]:y==null?void 0:y.length,[`${q}-${ge}`]:ge,[`${q}-type-${p}`]:!!p,[`${q}-rtl`]:_==="rtl"},i,a,O,j),Ee=Object.assign(Object.assign({},D==null?void 0:D.style),o);return K(v.createElement("div",Object.assign({ref:e},Ge,{className:be,style:Ee}),re,ye,le,he))});var SCe=function(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(n);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(n,i[a])&&(t[i[a]]=n[i[a]]);return t};const wCe=n=>{const{prefixCls:e,className:t,avatar:i,title:a,description:o}=n,r=SCe(n,["prefixCls","className","avatar","title","description"]),{getPrefixCls:s}=v.useContext(ui),l=s("card",e),c=gt(`${l}-meta`,t),u=i?v.createElement("div",{className:`${l}-meta-avatar`},i):null,C=a?v.createElement("div",{className:`${l}-meta-title`},a):null,h=o?v.createElement("div",{className:`${l}-meta-description`},o):null,m=C||h?v.createElement("div",{className:`${l}-meta-detail`},C,h):null;return v.createElement("div",Object.assign({},r,{className:c}),u,m)},LM=GCe;LM.Grid=SK;LM.Meta=wCe;function RCe(n,e,t){var i=t||{},a=i.noTrailing,o=a===void 0?!1:a,r=i.noLeading,s=r===void 0?!1:r,l=i.debounceMode,c=l===void 0?void 0:l,u,C=!1,h=0;function m(){u&&clearTimeout(u)}function p(b){var y=b||{},S=y.upcomingOnly,R=S===void 0?!1:S;m(),C=!R}function B(){for(var b=arguments.length,y=new Array(b),S=0;S<b;S++)y[S]=arguments[S];var R=this,Z=Date.now()-h;if(C)return;function x(){h=Date.now(),e.apply(R,y)}function M(){u=void 0}!s&&c&&!u&&x(),m(),c===void 0&&Z>n?s?(h=Date.now(),o||(u=setTimeout(c?M:x,n))):x():o!==!0&&(u=setTimeout(c?M:x,c===void 0?n-Z:n))}return B.cancel=p,B}function ZCe(n,e,t){var i={},a=i.atBegin,o=a===void 0?!1:a;return RCe(n,e,{debounceMode:o!==!1})}const wK=v.createContext({});var xCe=function(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(n);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(n,i[a])&&(t[i[a]]=n[i[a]]);return t};function O3(n){return typeof n=="number"?`${n} ${n} auto`:/^\d+(\.\d+)?(px|em|rem|%)$/.test(n)?`0 0 ${n}`:n}const MCe=["xs","sm","md","lg","xl","xxl"],WCe=v.forwardRef((n,e)=>{const{getPrefixCls:t,direction:i}=v.useContext(ui),{gutter:a,wrap:o}=v.useContext(wK),{prefixCls:r,span:s,order:l,offset:c,push:u,pull:C,className:h,children:m,flex:p,style:B}=n,b=xCe(n,["prefixCls","span","order","offset","push","pull","className","children","flex","style"]),y=t("col",r),[S,R,Z]=vle(y),x={};let M={};MCe.forEach(N=>{let H={};const z=n[N];typeof z=="number"?H.span=z:typeof z=="object"&&(H=z||{}),delete b[N],M=Object.assign(Object.assign({},M),{[`${y}-${N}-${H.span}`]:H.span!==void 0,[`${y}-${N}-order-${H.order}`]:H.order||H.order===0,[`${y}-${N}-offset-${H.offset}`]:H.offset||H.offset===0,[`${y}-${N}-push-${H.push}`]:H.push||H.push===0,[`${y}-${N}-pull-${H.pull}`]:H.pull||H.pull===0,[`${y}-rtl`]:i==="rtl"}),H.flex&&(M[`${y}-${N}-flex`]=!0,x[`--${y}-${N}-flex`]=O3(H.flex))});const E=gt(y,{[`${y}-${s}`]:s!==void 0,[`${y}-order-${l}`]:l,[`${y}-offset-${c}`]:c,[`${y}-push-${u}`]:u,[`${y}-pull-${C}`]:C},h,M,R,Z),F={};if(a&&a[0]>0){const N=a[0]/2;F.paddingLeft=N,F.paddingRight=N}return p&&(F.flex=O3(p),o===!1&&!F.minWidth&&(F.minWidth=0)),S(v.createElement("div",Object.assign({},b,{style:Object.assign(Object.assign(Object.assign({},F),B),x),className:E,ref:e}),m))});function VCe(n,e){const t=[void 0,void 0],i=Array.isArray(n)?n:[n,void 0],a=e||{xs:!0,sm:!0,md:!0,lg:!0,xl:!0,xxl:!0};return i.forEach((o,r)=>{if(typeof o=="object"&&o!==null)for(let s=0;s<fI.length;s++){const l=fI[s];if(a[l]&&o[l]!==void 0){t[r]=o[l];break}}else t[r]=o}),t}var NCe=function(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(n);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(n,i[a])&&(t[i[a]]=n[i[a]]);return t};function U3(n,e){const[t,i]=v.useState(typeof n=="string"?n:""),a=()=>{if(typeof n=="string"&&i(n),typeof n=="object")for(let o=0;o<fI.length;o++){const r=fI[o];if(!e||!e[r])continue;const s=n[r];if(s!==void 0){i(s);return}}};return v.useEffect(()=>{a()},[JSON.stringify(n),e]),t}const ECe=v.forwardRef((n,e)=>{const{prefixCls:t,justify:i,align:a,className:o,style:r,children:s,gutter:l=0,wrap:c}=n,u=NCe(n,["prefixCls","justify","align","className","style","children","gutter","wrap"]),{getPrefixCls:C,direction:h}=v.useContext(ui),m=WM(!0,null),p=U3(a,m),B=U3(i,m),b=C("row",t),[y,S,R]=ple(b),Z=VCe(l,m),x=gt(b,{[`${b}-no-wrap`]:c===!1,[`${b}-${B}`]:B,[`${b}-${p}`]:p,[`${b}-rtl`]:h==="rtl"},o,S,R),M={},E=Z[0]!=null&&Z[0]>0?Z[0]/-2:void 0;E&&(M.marginLeft=E,M.marginRight=E);const[F,N]=Z;M.rowGap=N;const H=v.useMemo(()=>({gutter:[F,N],wrap:c}),[F,N,c]);return y(v.createElement(wK.Provider,{value:H},v.createElement("div",Object.assign({},u,{className:x,style:Object.assign(Object.assign({},M),r),ref:e}),s)))}),HCe=n=>{const{componentCls:e,sizePaddingEdgeHorizontal:t,colorSplit:i,lineWidth:a,textPaddingInline:o,orientationMargin:r,verticalMarginInline:s}=n;return{[e]:Object.assign(Object.assign({},Po(n)),{borderBlockStart:`${st(a)} solid ${i}`,"&-vertical":{position:"relative",top:"-0.06em",display:"inline-block",height:"0.9em",marginInline:s,marginBlock:0,verticalAlign:"middle",borderTop:0,borderInlineStart:`${st(a)} solid ${i}`},"&-horizontal":{display:"flex",clear:"both",width:"100%",minWidth:"100%",margin:`${st(n.dividerHorizontalGutterMargin)} 0`},[`&-horizontal${e}-with-text`]:{display:"flex",alignItems:"center",margin:`${st(n.dividerHorizontalWithTextGutterMargin)} 0`,color:n.colorTextHeading,fontWeight:500,fontSize:n.fontSizeLG,whiteSpace:"nowrap",textAlign:"center",borderBlockStart:`0 ${i}`,"&::before, &::after":{position:"relative",width:"50%",borderBlockStart:`${st(a)} solid transparent`,borderBlockStartColor:"inherit",borderBlockEnd:0,transform:"translateY(50%)",content:"''"}},[`&-horizontal${e}-with-text-start`]:{"&::before":{width:`calc(${r} * 100%)`},"&::after":{width:`calc(100% - ${r} * 100%)`}},[`&-horizontal${e}-with-text-end`]:{"&::before":{width:`calc(100% - ${r} * 100%)`},"&::after":{width:`calc(${r} * 100%)`}},[`${e}-inner-text`]:{display:"inline-block",paddingBlock:0,paddingInline:o},"&-dashed":{background:"none",borderColor:i,borderStyle:"dashed",borderWidth:`${st(a)} 0 0`},[`&-horizontal${e}-with-text${e}-dashed`]:{"&::before, &::after":{borderStyle:"dashed none none"}},[`&-vertical${e}-dashed`]:{borderInlineStartWidth:a,borderInlineEnd:0,borderBlockStart:0,borderBlockEnd:0},"&-dotted":{background:"none",borderColor:i,borderStyle:"dotted",borderWidth:`${st(a)} 0 0`},[`&-horizontal${e}-with-text${e}-dotted`]:{"&::before, &::after":{borderStyle:"dotted none none"}},[`&-vertical${e}-dotted`]:{borderInlineStartWidth:a,borderInlineEnd:0,borderBlockStart:0,borderBlockEnd:0},[`&-plain${e}-with-text`]:{color:n.colorText,fontWeight:"normal",fontSize:n.fontSize},[`&-horizontal${e}-with-text-start${e}-no-default-orientation-margin-start`]:{"&::before":{width:0},"&::after":{width:"100%"},[`${e}-inner-text`]:{paddingInlineStart:t}},[`&-horizontal${e}-with-text-end${e}-no-default-orientation-margin-end`]:{"&::before":{width:"100%"},"&::after":{width:0},[`${e}-inner-text`]:{paddingInlineEnd:t}}})}},FCe=n=>({textPaddingInline:"1em",orientationMargin:.05,verticalMarginInline:n.marginXS}),XCe=Oa("Divider",n=>{const e=Xi(n,{dividerHorizontalWithTextGutterMargin:n.margin,dividerHorizontalGutterMargin:n.marginLG,sizePaddingEdgeHorizontal:0});return[HCe(e)]},FCe,{unitless:{orientationMargin:!0}});var TCe=function(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(n);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(n,i[a])&&(t[i[a]]=n[i[a]]);return t};const YCe=n=>{const{getPrefixCls:e,direction:t,className:i,style:a}=Gs("divider"),{prefixCls:o,type:r="horizontal",orientation:s="center",orientationMargin:l,className:c,rootClassName:u,children:C,dashed:h,variant:m="solid",plain:p,style:B}=n,b=TCe(n,["prefixCls","type","orientation","orientationMargin","className","rootClassName","children","dashed","variant","plain","style"]),y=e("divider",o),[S,R,Z]=XCe(y),x=!!C,M=v.useMemo(()=>s==="left"?t==="rtl"?"end":"start":s==="right"?t==="rtl"?"start":"end":s,[t,s]),E=M==="start"&&l!=null,F=M==="end"&&l!=null,N=gt(y,i,R,Z,`${y}-${r}`,{[`${y}-with-text`]:x,[`${y}-with-text-${M}`]:x,[`${y}-dashed`]:!!h,[`${y}-${m}`]:m!=="solid",[`${y}-plain`]:!!p,[`${y}-rtl`]:t==="rtl",[`${y}-no-default-orientation-margin-start`]:E,[`${y}-no-default-orientation-margin-end`]:F},c,u),H=v.useMemo(()=>typeof l=="number"?l:/^\d+$/.test(l)?Number(l):l,[l]),z={marginInlineStart:E?H:void 0,marginInlineEnd:F?H:void 0};return S(v.createElement("div",Object.assign({className:N,style:Object.assign(Object.assign({},a),B)},b,{role:"separator"}),C&&r!=="vertical"&&v.createElement("span",{className:`${y}-inner-text`,style:z},C)))};function zCe(n){return!!(n.addonBefore||n.addonAfter)}function KCe(n){return!!(n.prefix||n.suffix||n.allowClear)}function k3(n,e,t){var i=e.cloneNode(!0),a=Object.create(n,{target:{value:i},currentTarget:{value:i}});return i.value=t,typeof e.selectionStart=="number"&&typeof e.selectionEnd=="number"&&(i.selectionStart=e.selectionStart,i.selectionEnd=e.selectionEnd),i.setSelectionRange=function(){e.setSelectionRange.apply(e,arguments)},a}function $B(n,e,t,i){if(t){var a=e;if(e.type==="click"){a=k3(e,n,""),t(a);return}if(n.type!=="file"&&i!==void 0){a=k3(e,n,i),t(a);return}t(a)}}function RK(n,e){if(n){n.focus(e);var t=e||{},i=t.cursor;if(i){var a=n.value.length;switch(i){case"start":n.setSelectionRange(0,0);break;case"end":n.setSelectionRange(a,a);break;default:n.setSelectionRange(0,a)}}}}var ZK=Ct.forwardRef(function(n,e){var t,i,a,o=n.inputElement,r=n.children,s=n.prefixCls,l=n.prefix,c=n.suffix,u=n.addonBefore,C=n.addonAfter,h=n.className,m=n.style,p=n.disabled,B=n.readOnly,b=n.focused,y=n.triggerFocus,S=n.allowClear,R=n.value,Z=n.handleReset,x=n.hidden,M=n.classes,E=n.classNames,F=n.dataAttrs,N=n.styles,H=n.components,z=n.onClear,_=r??o,D=(H==null?void 0:H.affixWrapper)||"span",P=(H==null?void 0:H.groupWrapper)||"span",$=(H==null?void 0:H.wrapper)||"span",X=(H==null?void 0:H.groupAddon)||"span",L=v.useRef(null),U=function(Ye){var he;(he=L.current)!==null&&he!==void 0&&he.contains(Ye.target)&&(y==null||y())},q=KCe(n),K=v.cloneElement(_,{value:R,className:gt((t=_.props)===null||t===void 0?void 0:t.className,!q&&(E==null?void 0:E.variant))||null}),O=v.useRef(null);if(Ct.useImperativeHandle(e,function(){return{nativeElement:O.current||L.current}}),q){var j=null;if(S){var ne=!p&&!B&&R,k="".concat(s,"-clear-icon"),ie=Bn(S)==="object"&&S!==null&&S!==void 0&&S.clearIcon?S.clearIcon:"";j=Ct.createElement("button",{type:"button",tabIndex:-1,onClick:function(Ye){Z==null||Z(Ye),z==null||z()},onMouseDown:function(Ye){return Ye.preventDefault()},className:gt(k,Ve(Ve({},"".concat(k,"-hidden"),!ne),"".concat(k,"-has-suffix"),!!c))},ie)}var re="".concat(s,"-affix-wrapper"),ge=gt(re,Ve(Ve(Ve(Ve(Ve({},"".concat(s,"-disabled"),p),"".concat(re,"-disabled"),p),"".concat(re,"-focused"),b),"".concat(re,"-readonly"),B),"".concat(re,"-input-with-clear-btn"),c&&S&&R),M==null?void 0:M.affixWrapper,E==null?void 0:E.affixWrapper,E==null?void 0:E.variant),de=(c||S)&&Ct.createElement("span",{className:gt("".concat(s,"-suffix"),E==null?void 0:E.suffix),style:N==null?void 0:N.suffix},j,c);K=Ct.createElement(D,$t({className:ge,style:N==null?void 0:N.affixWrapper,onClick:U},F==null?void 0:F.affixWrapper,{ref:L}),l&&Ct.createElement("span",{className:gt("".concat(s,"-prefix"),E==null?void 0:E.prefix),style:N==null?void 0:N.prefix},l),K,de)}if(zCe(n)){var xe="".concat(s,"-group"),Ne="".concat(xe,"-addon"),ye="".concat(xe,"-wrapper"),pe=gt("".concat(s,"-wrapper"),xe,M==null?void 0:M.wrapper,E==null?void 0:E.wrapper),Te=gt(ye,Ve({},"".concat(ye,"-disabled"),p),M==null?void 0:M.group,E==null?void 0:E.groupWrapper);K=Ct.createElement(P,{className:Te,ref:O},Ct.createElement($,{className:pe},u&&Ct.createElement(X,{className:Ne},u),K,C&&Ct.createElement(X,{className:Ne},C)))}return Ct.cloneElement(K,{className:gt((i=K.props)===null||i===void 0?void 0:i.className,h)||null,style:Ke(Ke({},(a=K.props)===null||a===void 0?void 0:a.style),m),hidden:x})}),LCe=["show"];function xK(n,e){return v.useMemo(function(){var t={};e&&(t.show=Bn(e)==="object"&&e.formatter?e.formatter:!!e),t=Ke(Ke({},t),n);var i=t,a=i.show,o=_n(i,LCe);return Ke(Ke({},o),{},{show:!!a,showFormatter:typeof a=="function"?a:void 0,strategy:o.strategy||function(r){return r.length}})},[n,e])}var _Ce=["autoComplete","onChange","onFocus","onBlur","onPressEnter","onKeyDown","onKeyUp","prefixCls","disabled","htmlSize","className","maxLength","suffix","showCount","count","type","classes","classNames","styles","onCompositionStart","onCompositionEnd"],DCe=v.forwardRef(function(n,e){var t=n.autoComplete,i=n.onChange,a=n.onFocus,o=n.onBlur,r=n.onPressEnter,s=n.onKeyDown,l=n.onKeyUp,c=n.prefixCls,u=c===void 0?"rc-input":c,C=n.disabled,h=n.htmlSize,m=n.className,p=n.maxLength,B=n.suffix,b=n.showCount,y=n.count,S=n.type,R=S===void 0?"text":S,Z=n.classes,x=n.classNames,M=n.styles,E=n.onCompositionStart,F=n.onCompositionEnd,N=_n(n,_Ce),H=v.useState(!1),z=rt(H,2),_=z[0],D=z[1],P=v.useRef(!1),$=v.useRef(!1),X=v.useRef(null),L=v.useRef(null),U=function(me){X.current&&RK(X.current,me)},q=_a(n.defaultValue,{value:n.value}),K=rt(q,2),O=K[0],j=K[1],ne=O==null?"":String(O),k=v.useState(null),ie=rt(k,2),re=ie[0],ge=ie[1],de=xK(y,b),xe=de.max||p,Ne=de.strategy(ne),ye=!!xe&&Ne>xe;v.useImperativeHandle(e,function(){var ce;return{focus:U,blur:function(){var Ze;(Ze=X.current)===null||Ze===void 0||Ze.blur()},setSelectionRange:function(Ze,Xe,De){var Oe;(Oe=X.current)===null||Oe===void 0||Oe.setSelectionRange(Ze,Xe,De)},select:function(){var Ze;(Ze=X.current)===null||Ze===void 0||Ze.select()},input:X.current,nativeElement:((ce=L.current)===null||ce===void 0?void 0:ce.nativeElement)||X.current}}),v.useEffect(function(){$.current&&($.current=!1),D(function(ce){return ce&&C?!1:ce})},[C]);var pe=function(me,Ze,Xe){var De=Ze;if(!P.current&&de.exceedFormatter&&de.max&&de.strategy(Ze)>de.max){if(De=de.exceedFormatter(Ze,{max:de.max}),Ze!==De){var Oe,Je;ge([((Oe=X.current)===null||Oe===void 0?void 0:Oe.selectionStart)||0,((Je=X.current)===null||Je===void 0?void 0:Je.selectionEnd)||0])}}else if(Xe.source==="compositionEnd")return;j(De),X.current&&$B(X.current,me,i,De)};v.useEffect(function(){if(re){var ce;(ce=X.current)===null||ce===void 0||ce.setSelectionRange.apply(ce,an(re))}},[re]);var Te=function(me){pe(me,me.target.value,{source:"change"})},le=function(me){P.current=!1,pe(me,me.currentTarget.value,{source:"compositionEnd"}),F==null||F(me)},Ye=function(me){r&&me.key==="Enter"&&!$.current&&($.current=!0,r(me)),s==null||s(me)},he=function(me){me.key==="Enter"&&($.current=!1),l==null||l(me)},Ge=function(me){D(!0),a==null||a(me)},be=function(me){$.current&&($.current=!1),D(!1),o==null||o(me)},Ee=function(me){j(""),U(),X.current&&$B(X.current,me,i)},Se=ye&&"".concat(u,"-out-of-range"),ee=function(){var me=Ss(n,["prefixCls","onPressEnter","addonBefore","addonAfter","prefix","suffix","allowClear","defaultValue","showCount","count","classes","htmlSize","styles","classNames","onClear"]);return Ct.createElement("input",$t({autoComplete:t},me,{onChange:Te,onFocus:Ge,onBlur:be,onKeyDown:Ye,onKeyUp:he,className:gt(u,Ve({},"".concat(u,"-disabled"),C),x==null?void 0:x.input),style:M==null?void 0:M.input,ref:X,size:h,type:R,onCompositionStart:function(Xe){P.current=!0,E==null||E(Xe)},onCompositionEnd:le}))},Q=function(){var me=Number(xe)>0;if(B||de.show){var Ze=de.showFormatter?de.showFormatter({value:ne,count:Ne,maxLength:xe}):"".concat(Ne).concat(me?" / ".concat(xe):"");return Ct.createElement(Ct.Fragment,null,de.show&&Ct.createElement("span",{className:gt("".concat(u,"-show-count-suffix"),Ve({},"".concat(u,"-show-count-has-suffix"),!!B),x==null?void 0:x.count),style:Ke({},M==null?void 0:M.count)},Ze),B)}return null};return Ct.createElement(ZK,$t({},N,{prefixCls:u,className:gt(m,Se),handleReset:Ee,value:ne,focused:_,triggerFocus:U,suffix:Q(),disabled:C,classes:Z,classNames:x,styles:M}),ee())});const MK=n=>{let e;return typeof n=="object"&&(n!=null&&n.clearIcon)?e=n:n&&(e={clearIcon:Ct.createElement(qY,null)}),e};function WK(n,e){const t=v.useRef([]),i=()=>{t.current.push(setTimeout(()=>{var a,o,r,s;!((a=n.current)===null||a===void 0)&&a.input&&((o=n.current)===null||o===void 0?void 0:o.input.getAttribute("type"))==="password"&&(!((r=n.current)===null||r===void 0)&&r.input.hasAttribute("value"))&&((s=n.current)===null||s===void 0||s.input.removeAttribute("value"))}))};return v.useEffect(()=>(e&&i(),()=>t.current.forEach(a=>{a&&clearTimeout(a)})),[]),i}function OCe(n){return!!(n.prefix||n.suffix||n.allowClear||n.showCount)}var UCe=function(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(n);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(n,i[a])&&(t[i[a]]=n[i[a]]);return t};const vS=v.forwardRef((n,e)=>{const{prefixCls:t,bordered:i=!0,status:a,size:o,disabled:r,onBlur:s,onFocus:l,suffix:c,allowClear:u,addonAfter:C,addonBefore:h,className:m,style:p,styles:B,rootClassName:b,onChange:y,classNames:S,variant:R}=n,Z=UCe(n,["prefixCls","bordered","status","size","disabled","onBlur","onFocus","suffix","allowClear","addonAfter","addonBefore","className","style","styles","rootClassName","onChange","classNames","variant"]),{getPrefixCls:x,direction:M,allowClear:E,autoComplete:F,className:N,style:H,classNames:z,styles:_}=Gs("input"),D=x("input",t),P=v.useRef(null),$=tA(D),[X,L,U]=AK(D,b),[q]=mK(D,$),{compactSize:K,compactItemClassnames:O}=Bb(D,M),j=Sl(be=>{var Ee;return(Ee=o??K)!==null&&Ee!==void 0?Ee:be}),ne=Ct.useContext(hg),k=r??ne,{status:ie,hasFeedback:re,feedbackIcon:ge}=v.useContext(Ag),de=hS(ie,a),xe=OCe(n)||!!re;v.useRef(xe);const Ne=WK(P,!0),ye=be=>{Ne(),s==null||s(be)},pe=be=>{Ne(),l==null||l(be)},Te=be=>{Ne(),y==null||y(be)},le=(re||c)&&Ct.createElement(Ct.Fragment,null,c,re&&ge),Ye=MK(u??E),[he,Ge]=fS("input",R,i);return X(q(Ct.createElement(DCe,Object.assign({ref:Bs(e,P),prefixCls:D,autoComplete:F},Z,{disabled:k,onBlur:ye,onFocus:pe,style:Object.assign(Object.assign({},H),p),styles:Object.assign(Object.assign({},_),B),suffix:le,allowClear:Ye,className:gt(m,b,U,$,O,N),onChange:Te,addonBefore:h&&Ct.createElement(sZ,{form:!0,space:!0},h),addonAfter:C&&Ct.createElement(sZ,{form:!0,space:!0},C),classNames:Object.assign(Object.assign(Object.assign({},S),z),{input:gt({[`${D}-sm`]:j==="small",[`${D}-lg`]:j==="large",[`${D}-rtl`]:M==="rtl"},S==null?void 0:S.input,z.input,L),variant:gt({[`${D}-${he}`]:Ge},jB(D,de)),affixWrapper:gt({[`${D}-affix-wrapper-sm`]:j==="small",[`${D}-affix-wrapper-lg`]:j==="large",[`${D}-affix-wrapper-rtl`]:M==="rtl"},L),wrapper:gt({[`${D}-group-rtl`]:M==="rtl"},L),groupWrapper:gt({[`${D}-group-wrapper-sm`]:j==="small",[`${D}-group-wrapper-lg`]:j==="large",[`${D}-group-wrapper-rtl`]:M==="rtl",[`${D}-group-wrapper-${he}`]:Ge},jB(`${D}-group-wrapper`,de,re),L)})}))))});function bZ(n,e,t){return(n-e)/(t-e)}function _M(n,e,t,i){var a=bZ(e,t,i),o={};switch(n){case"rtl":o.right="".concat(a*100,"%"),o.transform="translateX(50%)";break;case"btt":o.bottom="".concat(a*100,"%"),o.transform="translateY(50%)";break;case"ttb":o.top="".concat(a*100,"%"),o.transform="translateY(-50%)";break;default:o.left="".concat(a*100,"%"),o.transform="translateX(-50%)";break}return o}function KC(n,e){return Array.isArray(n)?n[e]:n}var wI=v.createContext({min:0,max:0,direction:"ltr",step:1,includedStart:0,includedEnd:0,tabIndex:0,keyboard:!0,styles:{},classNames:{}}),kCe=v.createContext({}),PCe=["prefixCls","value","valueIndex","onStartMove","onDelete","style","render","dragging","draggingDelete","onOffsetChange","onChangeComplete","onFocus","onMouseEnter"],P3=v.forwardRef(function(n,e){var t=n.prefixCls,i=n.value,a=n.valueIndex,o=n.onStartMove,r=n.onDelete,s=n.style,l=n.render,c=n.dragging,u=n.draggingDelete,C=n.onOffsetChange,h=n.onChangeComplete,m=n.onFocus,p=n.onMouseEnter,B=_n(n,PCe),b=v.useContext(wI),y=b.min,S=b.max,R=b.direction,Z=b.disabled,x=b.keyboard,M=b.range,E=b.tabIndex,F=b.ariaLabelForHandle,N=b.ariaLabelledByForHandle,H=b.ariaRequired,z=b.ariaValueTextFormatterForHandle,_=b.styles,D=b.classNames,P="".concat(t,"-handle"),$=function(ie){Z||o(ie,a)},X=function(ie){m==null||m(ie,a)},L=function(ie){p(ie,a)},U=function(ie){if(!Z&&x){var re=null;switch(ie.which||ie.keyCode){case tn.LEFT:re=R==="ltr"||R==="btt"?-1:1;break;case tn.RIGHT:re=R==="ltr"||R==="btt"?1:-1;break;case tn.UP:re=R!=="ttb"?1:-1;break;case tn.DOWN:re=R!=="ttb"?-1:1;break;case tn.HOME:re="min";break;case tn.END:re="max";break;case tn.PAGE_UP:re=2;break;case tn.PAGE_DOWN:re=-2;break;case tn.BACKSPACE:case tn.DELETE:r(a);break}re!==null&&(ie.preventDefault(),C(re,a))}},q=function(ie){switch(ie.which||ie.keyCode){case tn.LEFT:case tn.RIGHT:case tn.UP:case tn.DOWN:case tn.HOME:case tn.END:case tn.PAGE_UP:case tn.PAGE_DOWN:h==null||h();break}},K=_M(R,i,y,S),O={};if(a!==null){var j;O={tabIndex:Z?null:KC(E,a),role:"slider","aria-valuemin":y,"aria-valuemax":S,"aria-valuenow":i,"aria-disabled":Z,"aria-label":KC(F,a),"aria-labelledby":KC(N,a),"aria-required":KC(H,a),"aria-valuetext":(j=KC(z,a))===null||j===void 0?void 0:j(i),"aria-orientation":R==="ltr"||R==="rtl"?"horizontal":"vertical",onMouseDown:$,onTouchStart:$,onFocus:X,onMouseEnter:L,onKeyDown:U,onKeyUp:q}}var ne=v.createElement("div",$t({ref:e,className:gt(P,Ve(Ve(Ve({},"".concat(P,"-").concat(a+1),a!==null&&M),"".concat(P,"-dragging"),c),"".concat(P,"-dragging-delete"),u),D.handle),style:Ke(Ke(Ke({},K),s),_.handle)},O,B));return l&&(ne=l(ne,{index:a,prefixCls:t,value:i,dragging:c,draggingDelete:u})),ne}),JCe=["prefixCls","style","onStartMove","onOffsetChange","values","handleRender","activeHandleRender","draggingIndex","draggingDelete","onFocus"],jCe=v.forwardRef(function(n,e){var t=n.prefixCls,i=n.style,a=n.onStartMove,o=n.onOffsetChange,r=n.values,s=n.handleRender,l=n.activeHandleRender,c=n.draggingIndex,u=n.draggingDelete,C=n.onFocus,h=_n(n,JCe),m=v.useRef({}),p=v.useState(!1),B=rt(p,2),b=B[0],y=B[1],S=v.useState(-1),R=rt(S,2),Z=R[0],x=R[1],M=function(z){x(z),y(!0)},E=function(z,_){M(_),C==null||C(z)},F=function(z,_){M(_)};v.useImperativeHandle(e,function(){return{focus:function(z){var _;(_=m.current[z])===null||_===void 0||_.focus()},hideHelp:function(){md.flushSync(function(){y(!1)})}}});var N=Ke({prefixCls:t,onStartMove:a,onOffsetChange:o,render:s,onFocus:E,onMouseEnter:F},h);return v.createElement(v.Fragment,null,r.map(function(H,z){var _=c===z;return v.createElement(P3,$t({ref:function(P){P?m.current[z]=P:delete m.current[z]},dragging:_,draggingDelete:_&&u,style:KC(i,z),key:z,value:H,valueIndex:z},N))}),l&&b&&v.createElement(P3,$t({key:"a11y"},N,{value:r[Z],valueIndex:null,dragging:c!==-1,draggingDelete:u,render:l,style:{pointerEvents:"none"},tabIndex:null,"aria-hidden":!0})))}),QCe=function(e){var t=e.prefixCls,i=e.style,a=e.children,o=e.value,r=e.onClick,s=v.useContext(wI),l=s.min,c=s.max,u=s.direction,C=s.includedStart,h=s.includedEnd,m=s.included,p="".concat(t,"-text"),B=_M(u,o,l,c);return v.createElement("span",{className:gt(p,Ve({},"".concat(p,"-active"),m&&C<=o&&o<=h)),style:Ke(Ke({},B),i),onMouseDown:function(y){y.stopPropagation()},onClick:function(){r(o)}},a)},qCe=function(e){var t=e.prefixCls,i=e.marks,a=e.onClick,o="".concat(t,"-mark");return i.length?v.createElement("div",{className:o},i.map(function(r){var s=r.value,l=r.style,c=r.label;return v.createElement(QCe,{key:s,prefixCls:o,style:l,value:s,onClick:a},c)})):null},$Ce=function(e){var t=e.prefixCls,i=e.value,a=e.style,o=e.activeStyle,r=v.useContext(wI),s=r.min,l=r.max,c=r.direction,u=r.included,C=r.includedStart,h=r.includedEnd,m="".concat(t,"-dot"),p=u&&C<=i&&i<=h,B=Ke(Ke({},_M(c,i,s,l)),typeof a=="function"?a(i):a);return p&&(B=Ke(Ke({},B),typeof o=="function"?o(i):o)),v.createElement("span",{className:gt(m,Ve({},"".concat(m,"-active"),p)),style:B})},eIe=function(e){var t=e.prefixCls,i=e.marks,a=e.dots,o=e.style,r=e.activeStyle,s=v.useContext(wI),l=s.min,c=s.max,u=s.step,C=v.useMemo(function(){var h=new Set;if(i.forEach(function(p){h.add(p.value)}),a&&u!==null)for(var m=l;m<=c;)h.add(m),m+=u;return Array.from(h)},[l,c,u,a,i]);return v.createElement("div",{className:"".concat(t,"-step")},C.map(function(h){return v.createElement($Ce,{prefixCls:t,key:h,value:h,style:o,activeStyle:r})}))},J3=function(e){var t=e.prefixCls,i=e.style,a=e.start,o=e.end,r=e.index,s=e.onStartMove,l=e.replaceCls,c=v.useContext(wI),u=c.direction,C=c.min,h=c.max,m=c.disabled,p=c.range,B=c.classNames,b="".concat(t,"-track"),y=bZ(a,C,h),S=bZ(o,C,h),R=function(E){!m&&s&&s(E,-1)},Z={};switch(u){case"rtl":Z.right="".concat(y*100,"%"),Z.width="".concat(S*100-y*100,"%");break;case"btt":Z.bottom="".concat(y*100,"%"),Z.height="".concat(S*100-y*100,"%");break;case"ttb":Z.top="".concat(y*100,"%"),Z.height="".concat(S*100-y*100,"%");break;default:Z.left="".concat(y*100,"%"),Z.width="".concat(S*100-y*100,"%")}var x=l||gt(b,Ve(Ve({},"".concat(b,"-").concat(r+1),r!==null&&p),"".concat(t,"-track-draggable"),s),B.track);return v.createElement("div",{className:x,style:Ke(Ke({},Z),i),onMouseDown:R,onTouchStart:R})},tIe=function(e){var t=e.prefixCls,i=e.style,a=e.values,o=e.startPoint,r=e.onStartMove,s=v.useContext(wI),l=s.included,c=s.range,u=s.min,C=s.styles,h=s.classNames,m=v.useMemo(function(){if(!c){if(a.length===0)return[];var B=o??u,b=a[0];return[{start:Math.min(B,b),end:Math.max(B,b)}]}for(var y=[],S=0;S<a.length-1;S+=1)y.push({start:a[S],end:a[S+1]});return y},[a,c,o,u]);if(!l)return null;var p=m!=null&&m.length&&(h.tracks||C.tracks)?v.createElement(J3,{index:null,prefixCls:t,start:m[0].start,end:m[m.length-1].end,replaceCls:gt(h.tracks,"".concat(t,"-tracks")),style:C.tracks}):null;return v.createElement(v.Fragment,null,p,m.map(function(B,b){var y=B.start,S=B.end;return v.createElement(J3,{index:b,prefixCls:t,style:Ke(Ke({},KC(i,b)),C.track),start:y,end:S,key:b,onStartMove:r})}))},nIe=130;function j3(n){var e="targetTouches"in n?n.targetTouches[0]:n;return{pageX:e.pageX,pageY:e.pageY}}function iIe(n,e,t,i,a,o,r,s,l,c,u){var C=v.useState(null),h=rt(C,2),m=h[0],p=h[1],B=v.useState(-1),b=rt(B,2),y=b[0],S=b[1],R=v.useState(!1),Z=rt(R,2),x=Z[0],M=Z[1],E=v.useState(t),F=rt(E,2),N=F[0],H=F[1],z=v.useState(t),_=rt(z,2),D=_[0],P=_[1],$=v.useRef(null),X=v.useRef(null),L=v.useRef(null),U=v.useContext(kCe),q=U.onDragStart,K=U.onDragChange;xi(function(){y===-1&&H(t)},[t,y]),v.useEffect(function(){return function(){document.removeEventListener("mousemove",$.current),document.removeEventListener("mouseup",X.current),L.current&&(L.current.removeEventListener("touchmove",$.current),L.current.removeEventListener("touchend",X.current))}},[]);var O=function(re,ge,de){ge!==void 0&&p(ge),H(re);var xe=re;de&&(xe=re.filter(function(Ne,ye){return ye!==y})),r(xe),K&&K({rawValues:re,deleteIndex:de?y:-1,draggingIndex:y,draggingValue:ge})},j=Aa(function(ie,re,ge){if(ie===-1){var de=D[0],xe=D[D.length-1],Ne=i-de,ye=a-xe,pe=re*(a-i);pe=Math.max(pe,Ne),pe=Math.min(pe,ye);var Te=o(de+pe);pe=Te-de;var le=D.map(function(be){return be+pe});O(le)}else{var Ye=(a-i)*re,he=an(N);he[ie]=D[ie];var Ge=l(he,Ye,ie,"dist");O(Ge.values,Ge.value,ge)}}),ne=function(re,ge,de){re.stopPropagation();var xe=de||t,Ne=xe[ge];S(ge),p(Ne),P(xe),H(xe),M(!1);var ye=j3(re),pe=ye.pageX,Te=ye.pageY,le=!1;q&&q({rawValues:xe,draggingIndex:ge,draggingValue:Ne});var Ye=function(be){be.preventDefault();var Ee=j3(be),Se=Ee.pageX,ee=Ee.pageY,Q=Se-pe,ce=ee-Te,me=n.current.getBoundingClientRect(),Ze=me.width,Xe=me.height,De,Oe;switch(e){case"btt":De=-ce/Xe,Oe=Q;break;case"ttb":De=ce/Xe,Oe=Q;break;case"rtl":De=-Q/Ze,Oe=ce;break;default:De=Q/Ze,Oe=ce}le=c?Math.abs(Oe)>nIe&&u<N.length:!1,M(le),j(ge,De,le)},he=function Ge(be){be.preventDefault(),document.removeEventListener("mouseup",Ge),document.removeEventListener("mousemove",Ye),L.current&&(L.current.removeEventListener("touchmove",$.current),L.current.removeEventListener("touchend",X.current)),$.current=null,X.current=null,L.current=null,s(le),S(-1),M(!1)};document.addEventListener("mouseup",he),document.addEventListener("mousemove",Ye),re.currentTarget.addEventListener("touchend",he),re.currentTarget.addEventListener("touchmove",Ye),$.current=Ye,X.current=he,L.current=re.currentTarget},k=v.useMemo(function(){var ie=an(t).sort(function(Ne,ye){return Ne-ye}),re=an(N).sort(function(Ne,ye){return Ne-ye}),ge={};re.forEach(function(Ne){ge[Ne]=(ge[Ne]||0)+1}),ie.forEach(function(Ne){ge[Ne]=(ge[Ne]||0)-1});var de=c?1:0,xe=Object.values(ge).reduce(function(Ne,ye){return Ne+Math.abs(ye)},0);return xe<=de?N:t},[t,N,c]);return[y,m,x,k,ne]}function aIe(n,e,t,i,a,o){var r=v.useCallback(function(m){return Math.max(n,Math.min(e,m))},[n,e]),s=v.useCallback(function(m){if(t!==null){var p=n+Math.round((r(m)-n)/t)*t,B=function(R){return(String(R).split(".")[1]||"").length},b=Math.max(B(t),B(e),B(n)),y=Number(p.toFixed(b));return n<=y&&y<=e?y:null}return null},[t,n,e,r]),l=v.useCallback(function(m){var p=r(m),B=i.map(function(S){return S.value});t!==null&&B.push(s(m)),B.push(n,e);var b=B[0],y=e-n;return B.forEach(function(S){var R=Math.abs(p-S);R<=y&&(b=S,y=R)}),b},[n,e,i,t,r,s]),c=function m(p,B,b){var y=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"unit";if(typeof B=="number"){var S,R=p[b],Z=R+B,x=[];i.forEach(function(H){x.push(H.value)}),x.push(n,e),x.push(s(R));var M=B>0?1:-1;y==="unit"?x.push(s(R+M*t)):x.push(s(Z)),x=x.filter(function(H){return H!==null}).filter(function(H){return B<0?H<=R:H>=R}),y==="unit"&&(x=x.filter(function(H){return H!==R}));var E=y==="unit"?R:Z;S=x[0];var F=Math.abs(S-E);if(x.forEach(function(H){var z=Math.abs(H-E);z<F&&(S=H,F=z)}),S===void 0)return B<0?n:e;if(y==="dist")return S;if(Math.abs(B)>1){var N=an(p);return N[b]=S,m(N,B-M,b,y)}return S}else{if(B==="min")return n;if(B==="max")return e}},u=function(p,B,b){var y=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"unit",S=p[b],R=c(p,B,b,y);return{value:R,changed:R!==S}},C=function(p){return o===null&&p===0||typeof o=="number"&&p<o},h=function(p,B,b){var y=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"unit",S=p.map(l),R=S[b],Z=c(S,B,b,y);if(S[b]=Z,a===!1){var x=o||0;b>0&&S[b-1]!==R&&(S[b]=Math.max(S[b],S[b-1]+x)),b<S.length-1&&S[b+1]!==R&&(S[b]=Math.min(S[b],S[b+1]-x))}else if(typeof o=="number"||o===null){for(var M=b+1;M<S.length;M+=1)for(var E=!0;C(S[M]-S[M-1])&&E;){var F=u(S,1,M);S[M]=F.value,E=F.changed}for(var N=b;N>0;N-=1)for(var H=!0;C(S[N]-S[N-1])&&H;){var z=u(S,-1,N-1);S[N-1]=z.value,H=z.changed}for(var _=S.length-1;_>0;_-=1)for(var D=!0;C(S[_]-S[_-1])&&D;){var P=u(S,-1,_-1);S[_-1]=P.value,D=P.changed}for(var $=0;$<S.length-1;$+=1)for(var X=!0;C(S[$+1]-S[$])&&X;){var L=u(S,1,$+1);S[$+1]=L.value,X=L.changed}}return{value:S[b],values:S}};return[l,h]}function oIe(n){return v.useMemo(function(){if(n===!0||!n)return[!!n,!1,!1,0];var e=n.editable,t=n.draggableTrack,i=n.minCount,a=n.maxCount;return[!0,e,!e&&t,i||0,a]},[n])}var rIe=v.forwardRef(function(n,e){var t=n.prefixCls,i=t===void 0?"rc-slider":t,a=n.className,o=n.style,r=n.classNames,s=n.styles,l=n.id,c=n.disabled,u=c===void 0?!1:c,C=n.keyboard,h=C===void 0?!0:C,m=n.autoFocus,p=n.onFocus,B=n.onBlur,b=n.min,y=b===void 0?0:b,S=n.max,R=S===void 0?100:S,Z=n.step,x=Z===void 0?1:Z,M=n.value,E=n.defaultValue,F=n.range,N=n.count,H=n.onChange,z=n.onBeforeChange,_=n.onAfterChange,D=n.onChangeComplete,P=n.allowCross,$=P===void 0?!0:P,X=n.pushable,L=X===void 0?!1:X,U=n.reverse,q=n.vertical,K=n.included,O=K===void 0?!0:K,j=n.startPoint,ne=n.trackStyle,k=n.handleStyle,ie=n.railStyle,re=n.dotStyle,ge=n.activeDotStyle,de=n.marks,xe=n.dots,Ne=n.handleRender,ye=n.activeHandleRender,pe=n.track,Te=n.tabIndex,le=Te===void 0?0:Te,Ye=n.ariaLabelForHandle,he=n.ariaLabelledByForHandle,Ge=n.ariaRequired,be=n.ariaValueTextFormatterForHandle,Ee=v.useRef(null),Se=v.useRef(null),ee=v.useMemo(function(){return q?U?"ttb":"btt":U?"rtl":"ltr"},[U,q]),Q=oIe(F),ce=rt(Q,5),me=ce[0],Ze=ce[1],Xe=ce[2],De=ce[3],Oe=ce[4],Je=v.useMemo(function(){return isFinite(y)?y:0},[y]),At=v.useMemo(function(){return isFinite(R)?R:100},[R]),qe=v.useMemo(function(){return x!==null&&x<=0?1:x},[x]),lt=v.useMemo(function(){return typeof L=="boolean"?L?qe:!1:L>=0?L:!1},[L,qe]),$e=v.useMemo(function(){return Object.keys(de||{}).map(function(Ae){var se=de[Ae],Re={value:Number(Ae)};return se&&Bn(se)==="object"&&!v.isValidElement(se)&&("label"in se||"style"in se)?(Re.style=se.style,Re.label=se.label):Re.label=se,Re}).filter(function(Ae){var se=Ae.label;return se||typeof se=="number"}).sort(function(Ae,se){return Ae.value-se.value})},[de]),je=aIe(Je,At,qe,$e,$,lt),ke=rt(je,2),Ce=ke[0],He=ke[1],ht=_a(E,{value:M}),we=rt(ht,2),ze=we[0],Qe=we[1],ut=v.useMemo(function(){var Ae=ze==null?[]:Array.isArray(ze)?ze:[ze],se=rt(Ae,1),Re=se[0],Ue=Re===void 0?Je:Re,nt=ze===null?[]:[Ue];if(me){if(nt=an(Ae),N||ze===void 0){var pt=N>=0?N+1:2;for(nt=nt.slice(0,pt);nt.length<pt;){var it;nt.push((it=nt[nt.length-1])!==null&&it!==void 0?it:Je)}}nt.sort(function(Bt,Mt){return Bt-Mt})}return nt.forEach(function(Bt,Mt){nt[Mt]=Ce(Bt)}),nt},[ze,me,Je,N,Ce]),Rt=function(se){return me?se:se[0]},mt=Aa(function(Ae){var se=an(Ae).sort(function(Re,Ue){return Re-Ue});H&&!Vf(se,ut,!0)&&H(Rt(se)),Qe(se)}),_t=Aa(function(Ae){Ae&&Ee.current.hideHelp();var se=Rt(ut);_==null||_(se),No(!_,"[rc-slider] `onAfterChange` is deprecated. Please use `onChangeComplete` instead."),D==null||D(se)}),Lt=function(se){if(!(u||!Ze||ut.length<=De)){var Re=an(ut);Re.splice(se,1),z==null||z(Rt(Re)),mt(Re);var Ue=Math.max(0,se-1);Ee.current.hideHelp(),Ee.current.focus(Ue)}},Zt=iIe(Se,ee,ut,Je,At,Ce,mt,_t,He,Ze,De),yt=rt(Zt,5),Ht=yt[0],jt=yt[1],Ut=yt[2],Nt=yt[3],Tt=yt[4],Pt=function(se,Re){if(!u){var Ue=an(ut),nt=0,pt=0,it=At-Je;ut.forEach(function(on,vn){var nn=Math.abs(se-on);nn<=it&&(it=nn,nt=vn),on<se&&(pt=vn)});var Bt=nt;Ze&&it!==0&&(!Oe||ut.length<Oe)?(Ue.splice(pt+1,0,se),Bt=pt+1):Ue[nt]=se,me&&!ut.length&&N===void 0&&Ue.push(se);var Mt=Rt(Ue);if(z==null||z(Mt),mt(Ue),Re){var Yt,ln;(Yt=document.activeElement)===null||Yt===void 0||(ln=Yt.blur)===null||ln===void 0||ln.call(Yt),Ee.current.focus(Bt),Tt(Re,Bt,Ue)}else _==null||_(Mt),No(!_,"[rc-slider] `onAfterChange` is deprecated. Please use `onChangeComplete` instead."),D==null||D(Mt)}},qt=function(se){se.preventDefault();var Re=Se.current.getBoundingClientRect(),Ue=Re.width,nt=Re.height,pt=Re.left,it=Re.top,Bt=Re.bottom,Mt=Re.right,Yt=se.clientX,ln=se.clientY,on;switch(ee){case"btt":on=(Bt-ln)/nt;break;case"ttb":on=(ln-it)/nt;break;case"rtl":on=(Mt-Yt)/Ue;break;default:on=(Yt-pt)/Ue}var vn=Je+on*(At-Je);Pt(Ce(vn),se)},kt=v.useState(null),Ft=rt(kt,2),fn=Ft[0],sn=Ft[1],ae=function(se,Re){if(!u){var Ue=He(ut,se,Re);z==null||z(Rt(ut)),mt(Ue.values),sn(Ue.value)}};v.useEffect(function(){if(fn!==null){var Ae=ut.indexOf(fn);Ae>=0&&Ee.current.focus(Ae)}sn(null)},[fn]);var ue=v.useMemo(function(){return Xe&&qe===null?!1:Xe},[Xe,qe]),Fe=Aa(function(Ae,se){Tt(Ae,se),z==null||z(Rt(ut))}),ot=Ht!==-1;v.useEffect(function(){if(!ot){var Ae=ut.lastIndexOf(jt);Ee.current.focus(Ae)}},[ot]);var at=v.useMemo(function(){return an(Nt).sort(function(Ae,se){return Ae-se})},[Nt]),It=v.useMemo(function(){return me?[at[0],at[at.length-1]]:[Je,at[0]]},[at,me,Je]),Wt=rt(It,2),xt=Wt[0],te=Wt[1];v.useImperativeHandle(e,function(){return{focus:function(){Ee.current.focus(0)},blur:function(){var se,Re=document,Ue=Re.activeElement;(se=Se.current)!==null&&se!==void 0&&se.contains(Ue)&&(Ue==null||Ue.blur())}}}),v.useEffect(function(){m&&Ee.current.focus(0)},[]);var Ie=v.useMemo(function(){return{min:Je,max:At,direction:ee,disabled:u,keyboard:h,step:qe,included:O,includedStart:xt,includedEnd:te,range:me,tabIndex:le,ariaLabelForHandle:Ye,ariaLabelledByForHandle:he,ariaRequired:Ge,ariaValueTextFormatterForHandle:be,styles:s||{},classNames:r||{}}},[Je,At,ee,u,h,qe,O,xt,te,me,le,Ye,he,Ge,be,s,r]);return v.createElement(wI.Provider,{value:Ie},v.createElement("div",{ref:Se,className:gt(i,a,Ve(Ve(Ve(Ve({},"".concat(i,"-disabled"),u),"".concat(i,"-vertical"),q),"".concat(i,"-horizontal"),!q),"".concat(i,"-with-marks"),$e.length)),style:o,onMouseDown:qt,id:l},v.createElement("div",{className:gt("".concat(i,"-rail"),r==null?void 0:r.rail),style:Ke(Ke({},ie),s==null?void 0:s.rail)}),pe!==!1&&v.createElement(tIe,{prefixCls:i,style:ne,values:ut,startPoint:j,onStartMove:ue?Fe:void 0}),v.createElement(eIe,{prefixCls:i,marks:$e,dots:xe,style:re,activeStyle:ge}),v.createElement(jCe,{ref:Ee,prefixCls:i,style:k,values:Nt,draggingIndex:Ht,draggingDelete:Ut,onStartMove:Fe,onOffsetChange:ae,onFocus:p,onBlur:B,handleRender:Ne,activeHandleRender:ye,onChangeComplete:_t,onDelete:Ze?Lt:void 0}),v.createElement(qCe,{prefixCls:i,marks:$e,onClick:Pt})))});const sIe=v.createContext({}),Q3=v.forwardRef((n,e)=>{const{open:t,draggingDelete:i}=n,a=v.useRef(null),o=t&&!i,r=v.useRef(null);function s(){mi.cancel(r.current),r.current=null}function l(){r.current=mi(()=>{var c;(c=a.current)===null||c===void 0||c.forceAlign(),r.current=null})}return v.useEffect(()=>(o?l():s(),s),[o,n.title]),v.createElement(AI,Object.assign({ref:Bs(a,e)},n,{open:o}))}),lIe=n=>{const{componentCls:e,antCls:t,controlSize:i,dotSize:a,marginFull:o,marginPart:r,colorFillContentHover:s,handleColorDisabled:l,calc:c,handleSize:u,handleSizeHover:C,handleActiveColor:h,handleActiveOutlineColor:m,handleLineWidth:p,handleLineWidthHover:B,motionDurationMid:b}=n;return{[e]:Object.assign(Object.assign({},Po(n)),{position:"relative",height:i,margin:`${st(r)} ${st(o)}`,padding:0,cursor:"pointer",touchAction:"none","&-vertical":{margin:`${st(o)} ${st(r)}`},[`${e}-rail`]:{position:"absolute",backgroundColor:n.railBg,borderRadius:n.borderRadiusXS,transition:`background-color ${b}`},[`${e}-track,${e}-tracks`]:{position:"absolute",transition:`background-color ${b}`},[`${e}-track`]:{backgroundColor:n.trackBg,borderRadius:n.borderRadiusXS},[`${e}-track-draggable`]:{boxSizing:"content-box",backgroundClip:"content-box",border:"solid rgba(0,0,0,0)"},"&:hover":{[`${e}-rail`]:{backgroundColor:n.railHoverBg},[`${e}-track`]:{backgroundColor:n.trackHoverBg},[`${e}-dot`]:{borderColor:s},[`${e}-handle::after`]:{boxShadow:`0 0 0 ${st(p)} ${n.colorPrimaryBorderHover}`},[`${e}-dot-active`]:{borderColor:n.dotActiveBorderColor}},[`${e}-handle`]:{position:"absolute",width:u,height:u,outline:"none",userSelect:"none","&-dragging-delete":{opacity:0},"&::before":{content:'""',position:"absolute",insetInlineStart:c(p).mul(-1).equal(),insetBlockStart:c(p).mul(-1).equal(),width:c(u).add(c(p).mul(2)).equal(),height:c(u).add(c(p).mul(2)).equal(),backgroundColor:"transparent"},"&::after":{content:'""',position:"absolute",insetBlockStart:0,insetInlineStart:0,width:u,height:u,backgroundColor:n.colorBgElevated,boxShadow:`0 0 0 ${st(p)} ${n.handleColor}`,outline:"0px solid transparent",borderRadius:"50%",cursor:"pointer",transition:`
            inset-inline-start ${b},
            inset-block-start ${b},
            width ${b},
            height ${b},
            box-shadow ${b},
            outline ${b}
          `},"&:hover, &:active, &:focus":{"&::before":{insetInlineStart:c(C).sub(u).div(2).add(B).mul(-1).equal(),insetBlockStart:c(C).sub(u).div(2).add(B).mul(-1).equal(),width:c(C).add(c(B).mul(2)).equal(),height:c(C).add(c(B).mul(2)).equal()},"&::after":{boxShadow:`0 0 0 ${st(B)} ${h}`,outline:`6px solid ${m}`,width:C,height:C,insetInlineStart:n.calc(u).sub(C).div(2).equal(),insetBlockStart:n.calc(u).sub(C).div(2).equal()}}},[`&-lock ${e}-handle`]:{"&::before, &::after":{transition:"none"}},[`${e}-mark`]:{position:"absolute",fontSize:n.fontSize},[`${e}-mark-text`]:{position:"absolute",display:"inline-block",color:n.colorTextDescription,textAlign:"center",wordBreak:"keep-all",cursor:"pointer",userSelect:"none","&-active":{color:n.colorText}},[`${e}-step`]:{position:"absolute",background:"transparent",pointerEvents:"none"},[`${e}-dot`]:{position:"absolute",width:a,height:a,backgroundColor:n.colorBgElevated,border:`${st(p)} solid ${n.dotBorderColor}`,borderRadius:"50%",cursor:"pointer",transition:`border-color ${n.motionDurationSlow}`,pointerEvents:"auto","&-active":{borderColor:n.dotActiveBorderColor}},[`&${e}-disabled`]:{cursor:"not-allowed",[`${e}-rail`]:{backgroundColor:`${n.railBg} !important`},[`${e}-track`]:{backgroundColor:`${n.trackBgDisabled} !important`},[`
          ${e}-dot
        `]:{backgroundColor:n.colorBgElevated,borderColor:n.trackBgDisabled,boxShadow:"none",cursor:"not-allowed"},[`${e}-handle::after`]:{backgroundColor:n.colorBgElevated,cursor:"not-allowed",width:u,height:u,boxShadow:`0 0 0 ${st(p)} ${l}`,insetInlineStart:0,insetBlockStart:0},[`
          ${e}-mark-text,
          ${e}-dot
        `]:{cursor:"not-allowed !important"}},[`&-tooltip ${t}-tooltip-inner`]:{minWidth:"unset"}})}},VK=(n,e)=>{const{componentCls:t,railSize:i,handleSize:a,dotSize:o,marginFull:r,calc:s}=n,l=e?"paddingBlock":"paddingInline",c=e?"width":"height",u=e?"height":"width",C=e?"insetBlockStart":"insetInlineStart",h=e?"top":"insetInlineStart",m=s(i).mul(3).sub(a).div(2).equal(),p=s(a).sub(i).div(2).equal(),B=e?{borderWidth:`${st(p)} 0`,transform:`translateY(${st(s(p).mul(-1).equal())})`}:{borderWidth:`0 ${st(p)}`,transform:`translateX(${st(n.calc(p).mul(-1).equal())})`};return{[l]:i,[u]:s(i).mul(3).equal(),[`${t}-rail`]:{[c]:"100%",[u]:i},[`${t}-track,${t}-tracks`]:{[u]:i},[`${t}-track-draggable`]:Object.assign({},B),[`${t}-handle`]:{[C]:m},[`${t}-mark`]:{insetInlineStart:0,top:0,[h]:s(i).mul(3).add(e?0:r).equal(),[c]:"100%"},[`${t}-step`]:{insetInlineStart:0,top:0,[h]:i,[c]:"100%",[u]:i},[`${t}-dot`]:{position:"absolute",[C]:s(i).sub(o).div(2).equal()}}},cIe=n=>{const{componentCls:e,marginPartWithMark:t}=n;return{[`${e}-horizontal`]:Object.assign(Object.assign({},VK(n,!0)),{[`&${e}-with-marks`]:{marginBottom:t}})}},gIe=n=>{const{componentCls:e}=n;return{[`${e}-vertical`]:Object.assign(Object.assign({},VK(n,!1)),{height:"100%"})}},uIe=n=>{const t=n.controlHeightLG/4,i=n.controlHeightSM/2,a=n.lineWidth+1,o=n.lineWidth+1*1.5,r=n.colorPrimary,s=new ia(r).setA(.2).toRgbString();return{controlSize:t,railSize:4,handleSize:t,handleSizeHover:i,dotSize:8,handleLineWidth:a,handleLineWidthHover:o,railBg:n.colorFillTertiary,railHoverBg:n.colorFillSecondary,trackBg:n.colorPrimaryBorder,trackHoverBg:n.colorPrimaryBorderHover,handleColor:n.colorPrimaryBorder,handleActiveColor:r,handleActiveOutlineColor:s,handleColorDisabled:new ia(n.colorTextDisabled).onBackground(n.colorBgContainer).toHexString(),dotBorderColor:n.colorBorderSecondary,dotActiveBorderColor:n.colorPrimaryBorder,trackBgDisabled:n.colorBgContainerDisabled}},dIe=Oa("Slider",n=>{const e=Xi(n,{marginPart:n.calc(n.controlHeight).sub(n.controlSize).div(2).equal(),marginFull:n.calc(n.controlSize).div(2).equal(),marginPartWithMark:n.calc(n.controlHeightLG).sub(n.controlSize).equal()});return[lIe(e),cIe(e),gIe(e)]},uIe);function c1(){const[n,e]=v.useState(!1),t=v.useRef(null),i=()=>{mi.cancel(t.current)},a=o=>{i(),o?e(o):t.current=mi(()=>{e(o)})};return v.useEffect(()=>i,[]),[n,a]}var CIe=function(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(n);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(n,i[a])&&(t[i[a]]=n[i[a]]);return t};function IIe(n,e){return n||n===null?n:e||e===null?e:t=>typeof t=="number"?t.toString():""}const hIe=Ct.forwardRef((n,e)=>{const{prefixCls:t,range:i,className:a,rootClassName:o,style:r,disabled:s,tooltipPrefixCls:l,tipFormatter:c,tooltipVisible:u,getTooltipPopupContainer:C,tooltipPlacement:h,tooltip:m={},onChangeComplete:p,classNames:B,styles:b}=n,y=CIe(n,["prefixCls","range","className","rootClassName","style","disabled","tooltipPrefixCls","tipFormatter","tooltipVisible","getTooltipPopupContainer","tooltipPlacement","tooltip","onChangeComplete","classNames","styles"]),{vertical:S}=n,{getPrefixCls:R,direction:Z,className:x,style:M,classNames:E,styles:F,getPopupContainer:N}=Gs("slider"),H=Ct.useContext(hg),z=s??H,{handleRender:_,direction:D}=Ct.useContext(sIe),$=(D||Z)==="rtl",[X,L]=c1(),[U,q]=c1(),K=Object.assign({},m),{open:O,placement:j,getPopupContainer:ne,prefixCls:k,formatter:ie}=K,re=O??u,ge=(X||U)&&re!==!1,de=IIe(ie,c),[xe,Ne]=c1(),ye=me=>{p==null||p(me),Ne(!1)},pe=(me,Ze)=>me||(Ze?$?"left":"right":"top"),Te=R("slider",t),[le,Ye,he]=dIe(Te),Ge=gt(a,x,E.root,B==null?void 0:B.root,o,{[`${Te}-rtl`]:$,[`${Te}-lock`]:xe},Ye,he);$&&!y.vertical&&(y.reverse=!y.reverse),Ct.useEffect(()=>{const me=()=>{mi(()=>{q(!1)},1)};return document.addEventListener("mouseup",me),()=>{document.removeEventListener("mouseup",me)}},[]);const be=i&&!re,Ee=_||((me,Ze)=>{const{index:Xe}=Ze,De=me.props;function Oe(lt,$e,je){var ke,Ce,He,ht;je&&((Ce=(ke=y)[lt])===null||Ce===void 0||Ce.call(ke,$e)),(ht=(He=De)[lt])===null||ht===void 0||ht.call(He,$e)}const Je=Object.assign(Object.assign({},De),{onMouseEnter:lt=>{L(!0),Oe("onMouseEnter",lt)},onMouseLeave:lt=>{L(!1),Oe("onMouseLeave",lt)},onMouseDown:lt=>{q(!0),Ne(!0),Oe("onMouseDown",lt)},onFocus:lt=>{var $e;q(!0),($e=y.onFocus)===null||$e===void 0||$e.call(y,lt),Oe("onFocus",lt,!0)},onBlur:lt=>{var $e;q(!1),($e=y.onBlur)===null||$e===void 0||$e.call(y,lt),Oe("onBlur",lt,!0)}}),At=Ct.cloneElement(me,Je),qe=(!!re||ge)&&de!==null;return be?At:Ct.createElement(Q3,Object.assign({},K,{prefixCls:R("tooltip",k??l),title:de?de(Ze.value):"",open:qe,placement:pe(j??h,S),key:Xe,classNames:{root:`${Te}-tooltip`},getPopupContainer:ne||C||N}),At)}),Se=be?(me,Ze)=>{const Xe=Ct.cloneElement(me,{style:Object.assign(Object.assign({},me.props.style),{visibility:"hidden"})});return Ct.createElement(Q3,Object.assign({},K,{prefixCls:R("tooltip",k??l),title:de?de(Ze.value):"",open:de!==null&&ge,placement:pe(j??h,S),key:"tooltip",classNames:{root:`${Te}-tooltip`},getPopupContainer:ne||C||N,draggingDelete:Ze.draggingDelete}),Xe)}:void 0,ee=Object.assign(Object.assign(Object.assign(Object.assign({},F.root),M),b==null?void 0:b.root),r),Q=Object.assign(Object.assign({},F.tracks),b==null?void 0:b.tracks),ce=gt(E.tracks,B==null?void 0:B.tracks);return le(Ct.createElement(rIe,Object.assign({},y,{classNames:Object.assign({handle:gt(E.handle,B==null?void 0:B.handle),rail:gt(E.rail,B==null?void 0:B.rail),track:gt(E.track,B==null?void 0:B.track)},ce?{tracks:ce}:{}),styles:Object.assign({handle:Object.assign(Object.assign({},F.handle),b==null?void 0:b.handle),rail:Object.assign(Object.assign({},F.rail),b==null?void 0:b.rail),track:Object.assign(Object.assign({},F.track),b==null?void 0:b.track)},Object.keys(Q).length?{tracks:Q}:{}),step:y.step,range:i,className:Ge,style:ee,disabled:z,ref:e,prefixCls:Te,handleRender:Ee,activeHandleRender:Se,onChangeComplete:ye})))});function q3(n){return["small","middle","large"].includes(n)}function $3(n){return n?typeof n=="number"&&!Number.isNaN(n):!1}const NK=Ct.createContext({latestIndex:0}),fIe=NK.Provider,AIe=n=>{let{className:e,index:t,children:i,split:a,style:o}=n;const{latestIndex:r}=v.useContext(NK);return i==null?null:v.createElement(v.Fragment,null,v.createElement("div",{className:e,style:o},i),t<r&&a&&v.createElement("span",{className:`${e}-split`},a))};var mIe=function(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(n);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(n,i[a])&&(t[i[a]]=n[i[a]]);return t};const pIe=v.forwardRef((n,e)=>{var t;const{getPrefixCls:i,direction:a,size:o,className:r,style:s,classNames:l,styles:c}=Gs("space"),{size:u=o??"small",align:C,className:h,rootClassName:m,children:p,direction:B="horizontal",prefixCls:b,split:y,style:S,wrap:R=!1,classNames:Z,styles:x}=n,M=mIe(n,["size","align","className","rootClassName","children","direction","prefixCls","split","style","wrap","classNames","styles"]),[E,F]=Array.isArray(u)?u:[u,u],N=q3(F),H=q3(E),z=$3(F),_=$3(E),D=Ic(p,{keepEmpty:!0}),P=C===void 0&&B==="horizontal"?"center":C,$=i("space",b),[X,L,U]=oz($),q=gt($,r,L,`${$}-${B}`,{[`${$}-rtl`]:a==="rtl",[`${$}-align-${P}`]:P,[`${$}-gap-row-${F}`]:N,[`${$}-gap-col-${E}`]:H},h,m,U),K=gt(`${$}-item`,(t=Z==null?void 0:Z.item)!==null&&t!==void 0?t:l.item);let O=0;const j=D.map((ie,re)=>{var ge;ie!=null&&(O=re);const de=(ie==null?void 0:ie.key)||`${K}-${re}`;return v.createElement(AIe,{className:K,key:de,index:re,split:y,style:(ge=x==null?void 0:x.item)!==null&&ge!==void 0?ge:c.item},ie)}),ne=v.useMemo(()=>({latestIndex:O}),[O]);if(D.length===0)return null;const k={};return R&&(k.flexWrap="wrap"),!H&&_&&(k.columnGap=E),!N&&z&&(k.rowGap=F),X(v.createElement("div",Object.assign({ref:e,className:q,style:Object.assign(Object.assign(Object.assign({},k),s),S)},M),v.createElement(fIe,{value:ne},j)))}),pp=pIe;pp.Compact=voe;var bIe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M942.2 486.2C847.4 286.5 704.1 186 512 186c-192.2 0-335.4 100.5-430.2 300.3a60.3 60.3 0 000 51.5C176.6 737.5 319.9 838 512 838c192.2 0 335.4-100.5 430.2-300.3 7.7-16.2 7.7-35 0-51.5zM512 766c-161.3 0-279.4-81.8-362.7-254C232.6 339.8 350.7 258 512 258c161.3 0 279.4 81.8 362.7 254C791.5 684.2 673.4 766 512 766zm-4-430c-97.2 0-176 78.8-176 176s78.8 176 176 176 176-78.8 176-176-78.8-176-176-176zm0 288c-61.9 0-112-50.1-112-112s50.1-112 112-112 112 50.1 112 112-50.1 112-112 112z"}}]},name:"eye",theme:"outlined"},vIe=function(e,t){return v.createElement(io,$t({},e,{ref:t,icon:bIe}))},yIe=v.forwardRef(vIe),BIe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M637 443H519V309c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v134H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h118v134c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V519h118c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm284 424L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z"}}]},name:"zoom-in",theme:"outlined"},GIe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M637 443H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h312c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm284 424L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z"}}]},name:"zoom-out",theme:"outlined"};const SIe=n=>{const{getPrefixCls:e,direction:t}=v.useContext(ui),{prefixCls:i,className:a}=n,o=e("input-group",i),r=e("input"),[s,l,c]=mK(r),u=gt(o,c,{[`${o}-lg`]:n.size==="large",[`${o}-sm`]:n.size==="small",[`${o}-compact`]:n.compact,[`${o}-rtl`]:t==="rtl"},l,a),C=v.useContext(Ag),h=v.useMemo(()=>Object.assign(Object.assign({},C),{isFormItemInput:!1}),[C]);return s(v.createElement("span",{className:u,style:n.style,onMouseEnter:n.onMouseEnter,onMouseLeave:n.onMouseLeave,onFocus:n.onFocus,onBlur:n.onBlur},v.createElement(Ag.Provider,{value:h},n.children)))},wIe=n=>{const{componentCls:e,paddingXS:t}=n;return{[e]:{display:"inline-flex",alignItems:"center",flexWrap:"nowrap",columnGap:t,"&-rtl":{direction:"rtl"},[`${e}-input`]:{textAlign:"center",paddingInline:n.paddingXXS},[`&${e}-sm ${e}-input`]:{paddingInline:n.calc(n.paddingXXS).div(2).equal()},[`&${e}-lg ${e}-input`]:{paddingInline:n.paddingXS}}}},RIe=Oa(["Input","OTP"],n=>{const e=Xi(n,xb(n));return[wIe(e)]},Mb);var ZIe=function(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(n);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(n,i[a])&&(t[i[a]]=n[i[a]]);return t};const xIe=v.forwardRef((n,e)=>{const{value:t,onChange:i,onActiveChange:a,index:o,mask:r}=n,s=ZIe(n,["value","onChange","onActiveChange","index","mask"]),l=t&&typeof r=="string"?r:t,c=p=>{i(o,p.target.value)},u=v.useRef(null);v.useImperativeHandle(e,()=>u.current);const C=()=>{mi(()=>{var p;const B=(p=u.current)===null||p===void 0?void 0:p.input;document.activeElement===B&&B&&B.select()})},h=p=>{const{key:B,ctrlKey:b,metaKey:y}=p;B==="ArrowLeft"?a(o-1):B==="ArrowRight"?a(o+1):B==="z"&&(b||y)&&p.preventDefault(),C()},m=p=>{p.key==="Backspace"&&!t&&a(o-1),C()};return v.createElement(vS,Object.assign({type:r===!0?"password":"text"},s,{ref:u,value:l,onInput:c,onFocus:C,onKeyDown:h,onKeyUp:m,onMouseDown:C,onMouseUp:C}))});var MIe=function(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(n);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(n,i[a])&&(t[i[a]]=n[i[a]]);return t};function sy(n){return(n||"").split("")}const WIe=n=>{const{index:e,prefixCls:t,separator:i}=n,a=typeof i=="function"?i(e):i;return a?v.createElement("span",{className:`${t}-separator`},a):null},VIe=v.forwardRef((n,e)=>{const{prefixCls:t,length:i=6,size:a,defaultValue:o,value:r,onChange:s,formatter:l,separator:c,variant:u,disabled:C,status:h,autoFocus:m,mask:p,type:B,onInput:b,inputMode:y}=n,S=MIe(n,["prefixCls","length","size","defaultValue","value","onChange","formatter","separator","variant","disabled","status","autoFocus","mask","type","onInput","inputMode"]),{getPrefixCls:R,direction:Z}=v.useContext(ui),x=R("otp",t),M=hI(S,{aria:!0,data:!0,attr:!0}),[E,F,N]=RIe(x),H=Sl(k=>a??k),z=v.useContext(Ag),_=hS(z.status,h),D=v.useMemo(()=>Object.assign(Object.assign({},z),{status:_,hasFeedback:!1,feedbackIcon:null}),[z,_]),P=v.useRef(null),$=v.useRef({});v.useImperativeHandle(e,()=>({focus:()=>{var k;(k=$.current[0])===null||k===void 0||k.focus()},blur:()=>{var k;for(let ie=0;ie<i;ie+=1)(k=$.current[ie])===null||k===void 0||k.blur()},nativeElement:P.current}));const X=k=>l?l(k):k,[L,U]=v.useState(()=>sy(X(o||"")));v.useEffect(()=>{r!==void 0&&U(sy(r))},[r]);const q=Aa(k=>{U(k),b&&b(k),s&&k.length===i&&k.every(ie=>ie)&&k.some((ie,re)=>L[re]!==ie)&&s(k.join(""))}),K=Aa((k,ie)=>{let re=an(L);for(let de=0;de<k;de+=1)re[de]||(re[de]="");ie.length<=1?re[k]=ie:re=re.slice(0,k).concat(sy(ie)),re=re.slice(0,i);for(let de=re.length-1;de>=0&&!re[de];de-=1)re.pop();const ge=X(re.map(de=>de||" ").join(""));return re=sy(ge).map((de,xe)=>de===" "&&!re[xe]?re[xe]:de),re}),O=(k,ie)=>{var re;const ge=K(k,ie),de=Math.min(k+ie.length,i-1);de!==k&&ge[k]!==void 0&&((re=$.current[de])===null||re===void 0||re.focus()),q(ge)},j=k=>{var ie;(ie=$.current[k])===null||ie===void 0||ie.focus()},ne={variant:u,disabled:C,status:_,mask:p,type:B,inputMode:y};return E(v.createElement("div",Object.assign({},M,{ref:P,className:gt(x,{[`${x}-sm`]:H==="small",[`${x}-lg`]:H==="large",[`${x}-rtl`]:Z==="rtl"},N,F)}),v.createElement(Ag.Provider,{value:D},Array.from({length:i}).map((k,ie)=>{const re=`otp-${ie}`,ge=L[ie]||"";return v.createElement(v.Fragment,{key:re},v.createElement(xIe,Object.assign({ref:de=>{$.current[ie]=de},index:ie,size:H,htmlSize:1,className:`${x}-input`,onChange:O,value:ge,onActiveChange:j,autoFocus:ie===0&&m},ne)),ie<i-1&&v.createElement(WIe,{separator:c,index:ie,prefixCls:x}))}))))});var NIe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M942.2 486.2Q889.47 375.11 816.7 305l-50.88 50.88C807.31 395.53 843.45 447.4 874.7 512 791.5 684.2 673.4 766 512 766q-72.67 0-133.87-22.38L323 798.75Q408 838 512 838q288.3 0 430.2-300.3a60.29 60.29 0 000-51.5zm-63.57-320.64L836 122.88a8 8 0 00-11.32 0L715.31 232.2Q624.86 186 512 186q-288.3 0-430.2 300.3a60.3 60.3 0 000 51.5q56.69 119.4 136.5 191.41L112.48 835a8 8 0 000 11.31L155.17 889a8 8 0 0011.31 0l712.15-712.12a8 8 0 000-11.32zM149.3 512C232.6 339.8 350.7 258 512 258c54.54 0 104.13 9.36 149.12 28.39l-70.3 70.3a176 176 0 00-238.13 238.13l-83.42 83.42C223.1 637.49 183.3 582.28 149.3 512zm246.7 0a112.11 112.11 0 01146.2-106.69L401.31 546.2A112 112 0 01396 512z"}},{tag:"path",attrs:{d:"M508 624c-3.46 0-6.87-.16-10.25-.47l-52.82 52.82a176.09 176.09 0 00227.42-227.42l-52.82 52.82c.31 3.38.47 6.79.47 10.25a111.94 111.94 0 01-112 112z"}}]},name:"eye-invisible",theme:"outlined"},EIe=function(e,t){return v.createElement(io,$t({},e,{ref:t,icon:NIe}))},HIe=v.forwardRef(EIe),FIe=function(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(n);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(n,i[a])&&(t[i[a]]=n[i[a]]);return t};const XIe=n=>n?v.createElement(yIe,null):v.createElement(HIe,null),TIe={click:"onClick",hover:"onMouseOver"},YIe=v.forwardRef((n,e)=>{const{disabled:t,action:i="click",visibilityToggle:a=!0,iconRender:o=XIe}=n,r=v.useContext(hg),s=t??r,l=typeof a=="object"&&a.visible!==void 0,[c,u]=v.useState(()=>l?a.visible:!1),C=v.useRef(null);v.useEffect(()=>{l&&u(a.visible)},[l,a]);const h=WK(C),m=()=>{var H;if(s)return;c&&h();const z=!c;u(z),typeof a=="object"&&((H=a.onVisibleChange)===null||H===void 0||H.call(a,z))},p=H=>{const z=TIe[i]||"",_=o(c),D={[z]:m,className:`${H}-icon`,key:"passwordIcon",onMouseDown:P=>{P.preventDefault()},onMouseUp:P=>{P.preventDefault()}};return v.cloneElement(v.isValidElement(_)?_:v.createElement("span",null,_),D)},{className:B,prefixCls:b,inputPrefixCls:y,size:S}=n,R=FIe(n,["className","prefixCls","inputPrefixCls","size"]),{getPrefixCls:Z}=v.useContext(ui),x=Z("input",y),M=Z("input-password",b),E=a&&p(M),F=gt(M,B,{[`${M}-${S}`]:!!S}),N=Object.assign(Object.assign({},Ss(R,["suffix","iconRender","visibilityToggle"])),{type:c?"text":"password",className:F,prefixCls:x,suffix:E});return S&&(N.size=S),v.createElement(vS,Object.assign({ref:Bs(e,C)},N))});var zIe=function(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(n);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(n,i[a])&&(t[i[a]]=n[i[a]]);return t};const KIe=v.forwardRef((n,e)=>{const{prefixCls:t,inputPrefixCls:i,className:a,size:o,suffix:r,enterButton:s=!1,addonAfter:l,loading:c,disabled:u,onSearch:C,onChange:h,onCompositionStart:m,onCompositionEnd:p}=n,B=zIe(n,["prefixCls","inputPrefixCls","className","size","suffix","enterButton","addonAfter","loading","disabled","onSearch","onChange","onCompositionStart","onCompositionEnd"]),{getPrefixCls:b,direction:y}=v.useContext(ui),S=v.useRef(!1),R=b("input-search",t),Z=b("input",i),{compactSize:x}=Bb(R,y),M=Sl(O=>{var j;return(j=o??x)!==null&&j!==void 0?j:O}),E=v.useRef(null),F=O=>{O!=null&&O.target&&O.type==="click"&&C&&C(O.target.value,O,{source:"clear"}),h==null||h(O)},N=O=>{var j;document.activeElement===((j=E.current)===null||j===void 0?void 0:j.input)&&O.preventDefault()},H=O=>{var j,ne;C&&C((ne=(j=E.current)===null||j===void 0?void 0:j.input)===null||ne===void 0?void 0:ne.value,O,{source:"input"})},z=O=>{S.current||c||H(O)},_=typeof s=="boolean"?v.createElement(Dz,null):null,D=`${R}-button`;let P;const $=s||{},X=$.type&&$.type.__ANT_BUTTON===!0;X||$.type==="button"?P=Bd($,Object.assign({onMouseDown:N,onClick:O=>{var j,ne;(ne=(j=$==null?void 0:$.props)===null||j===void 0?void 0:j.onClick)===null||ne===void 0||ne.call(j,O),H(O)},key:"enterButton"},X?{className:D,size:M}:{})):P=v.createElement(xo,{className:D,type:s?"primary":void 0,size:M,disabled:u,key:"enterButton",onMouseDown:N,onClick:H,loading:c,icon:_},s),l&&(P=[P,Bd(l,{key:"addonAfter"})]);const L=gt(R,{[`${R}-rtl`]:y==="rtl",[`${R}-${M}`]:!!M,[`${R}-with-button`]:!!s},a),U=Object.assign(Object.assign({},B),{className:L,prefixCls:Z,type:"search"}),q=O=>{S.current=!0,m==null||m(O)},K=O=>{S.current=!1,p==null||p(O)};return v.createElement(vS,Object.assign({ref:Bs(E,e),onPressEnter:z},U,{size:M,onCompositionStart:q,onCompositionEnd:K,addonAfter:P,suffix:r,onChange:F,disabled:u}))});var LIe=`
  min-height:0 !important;
  max-height:none !important;
  height:0 !important;
  visibility:hidden !important;
  overflow:hidden !important;
  position:absolute !important;
  z-index:-1000 !important;
  top:0 !important;
  right:0 !important;
  pointer-events: none !important;
`,_Ie=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","font-variant","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing","word-break","white-space"],g1={},Ls;function DIe(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,t=n.getAttribute("id")||n.getAttribute("data-reactid")||n.getAttribute("name");if(e&&g1[t])return g1[t];var i=window.getComputedStyle(n),a=i.getPropertyValue("box-sizing")||i.getPropertyValue("-moz-box-sizing")||i.getPropertyValue("-webkit-box-sizing"),o=parseFloat(i.getPropertyValue("padding-bottom"))+parseFloat(i.getPropertyValue("padding-top")),r=parseFloat(i.getPropertyValue("border-bottom-width"))+parseFloat(i.getPropertyValue("border-top-width")),s=_Ie.map(function(c){return"".concat(c,":").concat(i.getPropertyValue(c))}).join(";"),l={sizingStyle:s,paddingSize:o,borderSize:r,boxSizing:a};return e&&t&&(g1[t]=l),l}function OIe(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;Ls||(Ls=document.createElement("textarea"),Ls.setAttribute("tab-index","-1"),Ls.setAttribute("aria-hidden","true"),Ls.setAttribute("name","hiddenTextarea"),document.body.appendChild(Ls)),n.getAttribute("wrap")?Ls.setAttribute("wrap",n.getAttribute("wrap")):Ls.removeAttribute("wrap");var a=DIe(n,e),o=a.paddingSize,r=a.borderSize,s=a.boxSizing,l=a.sizingStyle;Ls.setAttribute("style","".concat(l,";").concat(LIe)),Ls.value=n.value||n.placeholder||"";var c=void 0,u=void 0,C,h=Ls.scrollHeight;if(s==="border-box"?h+=r:s==="content-box"&&(h-=o),t!==null||i!==null){Ls.value=" ";var m=Ls.scrollHeight-o;t!==null&&(c=m*t,s==="border-box"&&(c=c+o+r),h=Math.max(c,h)),i!==null&&(u=m*i,s==="border-box"&&(u=u+o+r),C=h>u?"":"hidden",h=Math.min(u,h))}var p={height:h,overflowY:C,resize:"none"};return c&&(p.minHeight=c),u&&(p.maxHeight=u),p}var UIe=["prefixCls","defaultValue","value","autoSize","onResize","className","style","disabled","onChange","onInternalAutoSize"],u1=0,d1=1,C1=2,kIe=v.forwardRef(function(n,e){var t=n,i=t.prefixCls,a=t.defaultValue,o=t.value,r=t.autoSize,s=t.onResize,l=t.className,c=t.style,u=t.disabled,C=t.onChange;t.onInternalAutoSize;var h=_n(t,UIe),m=_a(a,{value:o,postState:function(k){return k??""}}),p=rt(m,2),B=p[0],b=p[1],y=function(k){b(k.target.value),C==null||C(k)},S=v.useRef();v.useImperativeHandle(e,function(){return{textArea:S.current}});var R=v.useMemo(function(){return r&&Bn(r)==="object"?[r.minRows,r.maxRows]:[]},[r]),Z=rt(R,2),x=Z[0],M=Z[1],E=!!r,F=function(){try{if(document.activeElement===S.current){var k=S.current,ie=k.selectionStart,re=k.selectionEnd,ge=k.scrollTop;S.current.setSelectionRange(ie,re),S.current.scrollTop=ge}}catch{}},N=v.useState(C1),H=rt(N,2),z=H[0],_=H[1],D=v.useState(),P=rt(D,2),$=P[0],X=P[1],L=function(){_(u1)};xi(function(){E&&L()},[o,x,M,E]),xi(function(){if(z===u1)_(d1);else if(z===d1){var ne=OIe(S.current,!1,x,M);_(C1),X(ne)}else F()},[z]);var U=v.useRef(),q=function(){mi.cancel(U.current)},K=function(k){z===C1&&(s==null||s(k),r&&(q(),U.current=mi(function(){L()})))};v.useEffect(function(){return q},[]);var O=E?$:null,j=Ke(Ke({},c),O);return(z===u1||z===d1)&&(j.overflowY="hidden",j.overflowX="hidden"),v.createElement(vl,{onResize:K,disabled:!(r||s)},v.createElement("textarea",$t({},h,{ref:S,style:j,className:gt(i,l,Ve({},"".concat(i,"-disabled"),u)),disabled:u,value:B,onChange:y})))}),PIe=["defaultValue","value","onFocus","onBlur","onChange","allowClear","maxLength","onCompositionStart","onCompositionEnd","suffix","prefixCls","showCount","count","className","style","disabled","hidden","classNames","styles","onResize","onClear","onPressEnter","readOnly","autoSize","onKeyDown"],JIe=Ct.forwardRef(function(n,e){var t,i=n.defaultValue,a=n.value,o=n.onFocus,r=n.onBlur,s=n.onChange,l=n.allowClear,c=n.maxLength,u=n.onCompositionStart,C=n.onCompositionEnd,h=n.suffix,m=n.prefixCls,p=m===void 0?"rc-textarea":m,B=n.showCount,b=n.count,y=n.className,S=n.style,R=n.disabled,Z=n.hidden,x=n.classNames,M=n.styles,E=n.onResize,F=n.onClear,N=n.onPressEnter,H=n.readOnly,z=n.autoSize,_=n.onKeyDown,D=_n(n,PIe),P=_a(i,{value:a,defaultValue:i}),$=rt(P,2),X=$[0],L=$[1],U=X==null?"":String(X),q=Ct.useState(!1),K=rt(q,2),O=K[0],j=K[1],ne=Ct.useRef(!1),k=Ct.useState(null),ie=rt(k,2),re=ie[0],ge=ie[1],de=v.useRef(null),xe=v.useRef(null),Ne=function(){var je;return(je=xe.current)===null||je===void 0?void 0:je.textArea},ye=function(){Ne().focus()};v.useImperativeHandle(e,function(){var $e;return{resizableTextArea:xe.current,focus:ye,blur:function(){Ne().blur()},nativeElement:(($e=de.current)===null||$e===void 0?void 0:$e.nativeElement)||Ne()}}),v.useEffect(function(){j(function($e){return!R&&$e})},[R]);var pe=Ct.useState(null),Te=rt(pe,2),le=Te[0],Ye=Te[1];Ct.useEffect(function(){if(le){var $e;($e=Ne()).setSelectionRange.apply($e,an(le))}},[le]);var he=xK(b,B),Ge=(t=he.max)!==null&&t!==void 0?t:c,be=Number(Ge)>0,Ee=he.strategy(U),Se=!!Ge&&Ee>Ge,ee=function(je,ke){var Ce=ke;!ne.current&&he.exceedFormatter&&he.max&&he.strategy(ke)>he.max&&(Ce=he.exceedFormatter(ke,{max:he.max}),ke!==Ce&&Ye([Ne().selectionStart||0,Ne().selectionEnd||0])),L(Ce),$B(je.currentTarget,je,s,Ce)},Q=function(je){ne.current=!0,u==null||u(je)},ce=function(je){ne.current=!1,ee(je,je.currentTarget.value),C==null||C(je)},me=function(je){ee(je,je.target.value)},Ze=function(je){je.key==="Enter"&&N&&N(je),_==null||_(je)},Xe=function(je){j(!0),o==null||o(je)},De=function(je){j(!1),r==null||r(je)},Oe=function(je){L(""),ye(),$B(Ne(),je,s)},Je=h,At;he.show&&(he.showFormatter?At=he.showFormatter({value:U,count:Ee,maxLength:Ge}):At="".concat(Ee).concat(be?" / ".concat(Ge):""),Je=Ct.createElement(Ct.Fragment,null,Je,Ct.createElement("span",{className:gt("".concat(p,"-data-count"),x==null?void 0:x.count),style:M==null?void 0:M.count},At)));var qe=function(je){var ke;E==null||E(je),(ke=Ne())!==null&&ke!==void 0&&ke.style.height&&ge(!0)},lt=!z&&!B&&!l;return Ct.createElement(ZK,{ref:de,value:U,allowClear:l,handleReset:Oe,suffix:Je,prefixCls:p,classNames:Ke(Ke({},x),{},{affixWrapper:gt(x==null?void 0:x.affixWrapper,Ve(Ve({},"".concat(p,"-show-count"),B),"".concat(p,"-textarea-allow-clear"),l))}),disabled:R,focused:O,className:gt(y,Se&&"".concat(p,"-out-of-range")),style:Ke(Ke({},S),re&&!lt?{height:"auto"}:{}),dataAttrs:{affixWrapper:{"data-count":typeof At=="string"?At:void 0}},hidden:Z,readOnly:H,onClear:F},Ct.createElement(kIe,$t({},D,{autoSize:z,maxLength:c,onKeyDown:Ze,onChange:me,onFocus:Xe,onBlur:De,onCompositionStart:Q,onCompositionEnd:ce,className:gt(x==null?void 0:x.textarea),style:Ke(Ke({},M==null?void 0:M.textarea),{},{resize:S==null?void 0:S.resize}),disabled:R,prefixCls:p,onResize:qe,ref:xe,readOnly:H})))});const jIe=n=>{const{componentCls:e,paddingLG:t}=n,i=`${e}-textarea`;return{[`textarea${e}`]:{maxWidth:"100%",height:"auto",minHeight:n.controlHeight,lineHeight:n.lineHeight,verticalAlign:"bottom",transition:`all ${n.motionDurationSlow}`,resize:"vertical",[`&${e}-mouse-active`]:{transition:`all ${n.motionDurationSlow}, height 0s, width 0s`}},[`${e}-textarea-affix-wrapper-resize-dirty`]:{width:"auto"},[i]:{position:"relative","&-show-count":{[`> ${e}`]:{height:"100%"},[`${e}-data-count`]:{position:"absolute",bottom:n.calc(n.fontSize).mul(n.lineHeight).mul(-1).equal(),insetInlineEnd:0,color:n.colorTextDescription,whiteSpace:"nowrap",pointerEvents:"none"}},[`
        &-allow-clear > ${e},
        &-affix-wrapper${i}-has-feedback ${e}
      `]:{paddingInlineEnd:t},[`&-affix-wrapper${e}-affix-wrapper`]:{padding:0,[`> textarea${e}`]:{fontSize:"inherit",border:"none",outline:"none",background:"transparent",minHeight:n.calc(n.controlHeight).sub(n.calc(n.lineWidth).mul(2)).equal(),"&:focus":{boxShadow:"none !important"}},[`${e}-suffix`]:{margin:0,"> *:not(:last-child)":{marginInline:0},[`${e}-clear-icon`]:{position:"absolute",insetInlineEnd:n.paddingInline,insetBlockStart:n.paddingXS},[`${i}-suffix`]:{position:"absolute",top:0,insetInlineEnd:n.paddingInline,bottom:0,zIndex:1,display:"inline-flex",alignItems:"center",margin:"auto",pointerEvents:"none"}}},[`&-affix-wrapper${e}-affix-wrapper-sm`]:{[`${e}-suffix`]:{[`${e}-clear-icon`]:{insetInlineEnd:n.paddingInlineSM}}}}}},QIe=Oa(["Input","TextArea"],n=>{const e=Xi(n,xb(n));return[jIe(e)]},Mb,{resetFont:!1});var qIe=function(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(n);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(n,i[a])&&(t[i[a]]=n[i[a]]);return t};const EK=v.forwardRef((n,e)=>{var t;const{prefixCls:i,bordered:a=!0,size:o,disabled:r,status:s,allowClear:l,classNames:c,rootClassName:u,className:C,style:h,styles:m,variant:p,showCount:B,onMouseDown:b,onResize:y}=n,S=qIe(n,["prefixCls","bordered","size","disabled","status","allowClear","classNames","rootClassName","className","style","styles","variant","showCount","onMouseDown","onResize"]),{getPrefixCls:R,direction:Z,allowClear:x,autoComplete:M,className:E,style:F,classNames:N,styles:H}=Gs("textArea"),z=v.useContext(hg),_=r??z,{status:D,hasFeedback:P,feedbackIcon:$}=v.useContext(Ag),X=hS(D,s),L=v.useRef(null);v.useImperativeHandle(e,()=>{var he;return{resizableTextArea:(he=L.current)===null||he===void 0?void 0:he.resizableTextArea,focus:Ge=>{var be,Ee;RK((Ee=(be=L.current)===null||be===void 0?void 0:be.resizableTextArea)===null||Ee===void 0?void 0:Ee.textArea,Ge)},blur:()=>{var Ge;return(Ge=L.current)===null||Ge===void 0?void 0:Ge.blur()}}});const U=R("input",i),q=tA(U),[K,O,j]=AK(U,u),[ne]=QIe(U,q),{compactSize:k,compactItemClassnames:ie}=Bb(U,Z),re=Sl(he=>{var Ge;return(Ge=o??k)!==null&&Ge!==void 0?Ge:he}),[ge,de]=fS("textArea",p,a),xe=MK(l??x),[Ne,ye]=v.useState(!1),[pe,Te]=v.useState(!1),le=he=>{ye(!0),b==null||b(he);const Ge=()=>{ye(!1),document.removeEventListener("mouseup",Ge)};document.addEventListener("mouseup",Ge)},Ye=he=>{var Ge,be;if(y==null||y(he),Ne&&typeof getComputedStyle=="function"){const Ee=(be=(Ge=L.current)===null||Ge===void 0?void 0:Ge.nativeElement)===null||be===void 0?void 0:be.querySelector("textarea");Ee&&getComputedStyle(Ee).resize==="both"&&Te(!0)}};return K(ne(v.createElement(JIe,Object.assign({autoComplete:M},S,{style:Object.assign(Object.assign({},F),h),styles:Object.assign(Object.assign({},H),m),disabled:_,allowClear:xe,className:gt(j,q,C,u,ie,E,pe&&`${U}-textarea-affix-wrapper-resize-dirty`),classNames:Object.assign(Object.assign(Object.assign({},c),N),{textarea:gt({[`${U}-sm`]:re==="small",[`${U}-lg`]:re==="large"},O,c==null?void 0:c.textarea,N.textarea,Ne&&`${U}-mouse-active`),variant:gt({[`${U}-${ge}`]:de},jB(U,X)),affixWrapper:gt(`${U}-textarea-affix-wrapper`,{[`${U}-affix-wrapper-rtl`]:Z==="rtl",[`${U}-affix-wrapper-sm`]:re==="small",[`${U}-affix-wrapper-lg`]:re==="large",[`${U}-textarea-show-count`]:B||((t=n.count)===null||t===void 0?void 0:t.show)},O)}),prefixCls:U,suffix:P&&v.createElement("span",{className:`${U}-textarea-suffix`},$),showCount:B,ref:L,onResize:Ye,onMouseDown:le}))))}),aA=vS;aA.Group=SIe;aA.Search=KIe;aA.TextArea=EK;aA.Password=YIe;aA.OTP=VIe;const $Ie=function(){const n=Object.assign({},arguments.length<=0?void 0:arguments[0]);for(let e=1;e<arguments.length;e++){const t=e<0||arguments.length<=e?void 0:arguments[e];t&&Object.keys(t).forEach(i=>{const a=t[i];a!==void 0&&(n[i]=a)})}return n};var ehe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M272.9 512l265.4-339.1c4.1-5.2.4-12.9-6.3-12.9h-77.3c-4.9 0-9.6 2.3-12.6 6.1L186.8 492.3a31.99 31.99 0 000 39.5l255.3 326.1c3 3.9 7.7 6.1 12.6 6.1H532c6.7 0 10.4-7.7 6.3-12.9L272.9 512zm304 0l265.4-339.1c4.1-5.2.4-12.9-6.3-12.9h-77.3c-4.9 0-9.6 2.3-12.6 6.1L490.8 492.3a31.99 31.99 0 000 39.5l255.3 326.1c3 3.9 7.7 6.1 12.6 6.1H836c6.7 0 10.4-7.7 6.3-12.9L576.9 512z"}}]},name:"double-left",theme:"outlined"},the=function(e,t){return v.createElement(io,$t({},e,{ref:t,icon:ehe}))},eF=v.forwardRef(the),nhe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M533.2 492.3L277.9 166.1c-3-3.9-7.7-6.1-12.6-6.1H188c-6.7 0-10.4 7.7-6.3 12.9L447.1 512 181.7 851.1A7.98 7.98 0 00188 864h77.3c4.9 0 9.6-2.3 12.6-6.1l255.3-326.1c9.1-11.7 9.1-27.9 0-39.5zm304 0L581.9 166.1c-3-3.9-7.7-6.1-12.6-6.1H492c-6.7 0-10.4 7.7-6.3 12.9L751.1 512 485.7 851.1A7.98 7.98 0 00492 864h77.3c4.9 0 9.6-2.3 12.6-6.1l255.3-326.1c9.1-11.7 9.1-27.9 0-39.5z"}}]},name:"double-right",theme:"outlined"},ihe=function(e,t){return v.createElement(io,$t({},e,{ref:t,icon:nhe}))},tF=v.forwardRef(ihe),ahe={items_per_page:"/",jump_to:"",jump_to_confirm:"",page:"",prev_page:"",next_page:"",prev_5:" 5 ",next_5:" 5 ",prev_3:" 3 ",next_3:" 3 ",page_size:""},ohe=[10,20,50,100],rhe=function(e){var t=e.pageSizeOptions,i=t===void 0?ohe:t,a=e.locale,o=e.changeSize,r=e.pageSize,s=e.goButton,l=e.quickGo,c=e.rootPrefixCls,u=e.disabled,C=e.buildOptionText,h=e.showSizeChanger,m=e.sizeChangerRender,p=Ct.useState(""),B=rt(p,2),b=B[0],y=B[1],S=function(){return!b||Number.isNaN(b)?void 0:Number(b)},R=typeof C=="function"?C:function(_){return"".concat(_," ").concat(a.items_per_page)},Z=function(D){y(D.target.value)},x=function(D){s||b===""||(y(""),!(D.relatedTarget&&(D.relatedTarget.className.indexOf("".concat(c,"-item-link"))>=0||D.relatedTarget.className.indexOf("".concat(c,"-item"))>=0))&&(l==null||l(S())))},M=function(D){b!==""&&(D.keyCode===tn.ENTER||D.type==="click")&&(y(""),l==null||l(S()))},E=function(){return i.some(function(D){return D.toString()===r.toString()})?i:i.concat([r]).sort(function(D,P){var $=Number.isNaN(Number(D))?0:Number(D),X=Number.isNaN(Number(P))?0:Number(P);return $-X})},F="".concat(c,"-options");if(!h&&!l)return null;var N=null,H=null,z=null;return h&&m&&(N=m({disabled:u,size:r,onSizeChange:function(D){o==null||o(Number(D))},"aria-label":a.page_size,className:"".concat(F,"-size-changer"),options:E().map(function(_){return{label:R(_),value:_}})})),l&&(s&&(z=typeof s=="boolean"?Ct.createElement("button",{type:"button",onClick:M,onKeyUp:M,disabled:u,className:"".concat(F,"-quick-jumper-button")},a.jump_to_confirm):Ct.createElement("span",{onClick:M,onKeyUp:M},s)),H=Ct.createElement("div",{className:"".concat(F,"-quick-jumper")},a.jump_to,Ct.createElement("input",{disabled:u,type:"text",value:b,onChange:Z,onKeyUp:M,onBlur:x,"aria-label":a.page}),a.page,z)),Ct.createElement("li",{className:F},N,H)},Lm=function(e){var t=e.rootPrefixCls,i=e.page,a=e.active,o=e.className,r=e.showTitle,s=e.onClick,l=e.onKeyPress,c=e.itemRender,u="".concat(t,"-item"),C=gt(u,"".concat(u,"-").concat(i),Ve(Ve({},"".concat(u,"-active"),a),"".concat(u,"-disabled"),!i),o),h=function(){s(i)},m=function(b){l(b,s,i)},p=c(i,"page",Ct.createElement("a",{rel:"nofollow"},i));return p?Ct.createElement("li",{title:r?String(i):null,className:C,onClick:h,onKeyDown:m,tabIndex:0},p):null},she=function(e,t,i){return i};function nF(){}function iF(n){var e=Number(n);return typeof e=="number"&&!Number.isNaN(e)&&isFinite(e)&&Math.floor(e)===e}function NC(n,e,t){var i=typeof n>"u"?e:n;return Math.floor((t-1)/i)+1}var lhe=function(e){var t=e.prefixCls,i=t===void 0?"rc-pagination":t,a=e.selectPrefixCls,o=a===void 0?"rc-select":a,r=e.className,s=e.current,l=e.defaultCurrent,c=l===void 0?1:l,u=e.total,C=u===void 0?0:u,h=e.pageSize,m=e.defaultPageSize,p=m===void 0?10:m,B=e.onChange,b=B===void 0?nF:B,y=e.hideOnSinglePage,S=e.align,R=e.showPrevNextJumpers,Z=R===void 0?!0:R,x=e.showQuickJumper,M=e.showLessItems,E=e.showTitle,F=E===void 0?!0:E,N=e.onShowSizeChange,H=N===void 0?nF:N,z=e.locale,_=z===void 0?ahe:z,D=e.style,P=e.totalBoundaryShowSizeChanger,$=P===void 0?50:P,X=e.disabled,L=e.simple,U=e.showTotal,q=e.showSizeChanger,K=q===void 0?C>$:q,O=e.sizeChangerRender,j=e.pageSizeOptions,ne=e.itemRender,k=ne===void 0?she:ne,ie=e.jumpPrevIcon,re=e.jumpNextIcon,ge=e.prevIcon,de=e.nextIcon,xe=Ct.useRef(null),Ne=_a(10,{value:h,defaultValue:p}),ye=rt(Ne,2),pe=ye[0],Te=ye[1],le=_a(1,{value:s,defaultValue:c,postState:function(Bt){return Math.max(1,Math.min(Bt,NC(void 0,pe,C)))}}),Ye=rt(le,2),he=Ye[0],Ge=Ye[1],be=Ct.useState(he),Ee=rt(be,2),Se=Ee[0],ee=Ee[1];v.useEffect(function(){ee(he)},[he]);var Q=Math.max(1,he-(M?3:5)),ce=Math.min(NC(void 0,pe,C),he+(M?3:5));function me(it,Bt){var Mt=it||Ct.createElement("button",{type:"button","aria-label":Bt,className:"".concat(i,"-item-link")});return typeof it=="function"&&(Mt=Ct.createElement(it,Ke({},e))),Mt}function Ze(it){var Bt=it.target.value,Mt=NC(void 0,pe,C),Yt;return Bt===""?Yt=Bt:Number.isNaN(Number(Bt))?Yt=Se:Bt>=Mt?Yt=Mt:Yt=Number(Bt),Yt}function Xe(it){return iF(it)&&it!==he&&iF(C)&&C>0}var De=C>pe?x:!1;function Oe(it){(it.keyCode===tn.UP||it.keyCode===tn.DOWN)&&it.preventDefault()}function Je(it){var Bt=Ze(it);switch(Bt!==Se&&ee(Bt),it.keyCode){case tn.ENTER:lt(Bt);break;case tn.UP:lt(Bt-1);break;case tn.DOWN:lt(Bt+1);break}}function At(it){lt(Ze(it))}function qe(it){var Bt=NC(it,pe,C),Mt=he>Bt&&Bt!==0?Bt:he;Te(it),ee(Mt),H==null||H(he,it),Ge(Mt),b==null||b(Mt,it)}function lt(it){if(Xe(it)&&!X){var Bt=NC(void 0,pe,C),Mt=it;return it>Bt?Mt=Bt:it<1&&(Mt=1),Mt!==Se&&ee(Mt),Ge(Mt),b==null||b(Mt,pe),Mt}return he}var $e=he>1,je=he<NC(void 0,pe,C);function ke(){$e&&lt(he-1)}function Ce(){je&&lt(he+1)}function He(){lt(Q)}function ht(){lt(ce)}function we(it,Bt){if(it.key==="Enter"||it.charCode===tn.ENTER||it.keyCode===tn.ENTER){for(var Mt=arguments.length,Yt=new Array(Mt>2?Mt-2:0),ln=2;ln<Mt;ln++)Yt[ln-2]=arguments[ln];Bt.apply(void 0,Yt)}}function ze(it){we(it,ke)}function Qe(it){we(it,Ce)}function ut(it){we(it,He)}function Rt(it){we(it,ht)}function mt(it){var Bt=k(it,"prev",me(ge,"prev page"));return Ct.isValidElement(Bt)?Ct.cloneElement(Bt,{disabled:!$e}):Bt}function _t(it){var Bt=k(it,"next",me(de,"next page"));return Ct.isValidElement(Bt)?Ct.cloneElement(Bt,{disabled:!je}):Bt}function Lt(it){(it.type==="click"||it.keyCode===tn.ENTER)&&lt(Se)}var Zt=null,yt=hI(e,{aria:!0,data:!0}),Ht=U&&Ct.createElement("li",{className:"".concat(i,"-total-text")},U(C,[C===0?0:(he-1)*pe+1,he*pe>C?C:he*pe])),jt=null,Ut=NC(void 0,pe,C);if(y&&C<=pe)return null;var Nt=[],Tt={rootPrefixCls:i,onClick:lt,onKeyPress:we,showTitle:F,itemRender:k,page:-1},Pt=he-1>0?he-1:0,qt=he+1<Ut?he+1:Ut,kt=x&&x.goButton,Ft=Bn(L)==="object"?L.readOnly:!L,fn=kt,sn=null;L&&(kt&&(typeof kt=="boolean"?fn=Ct.createElement("button",{type:"button",onClick:Lt,onKeyUp:Lt},_.jump_to_confirm):fn=Ct.createElement("span",{onClick:Lt,onKeyUp:Lt},kt),fn=Ct.createElement("li",{title:F?"".concat(_.jump_to).concat(he,"/").concat(Ut):null,className:"".concat(i,"-simple-pager")},fn)),sn=Ct.createElement("li",{title:F?"".concat(he,"/").concat(Ut):null,className:"".concat(i,"-simple-pager")},Ft?Se:Ct.createElement("input",{type:"text","aria-label":_.jump_to,value:Se,disabled:X,onKeyDown:Oe,onKeyUp:Je,onChange:Je,onBlur:At,size:3}),Ct.createElement("span",{className:"".concat(i,"-slash")},"/"),Ut));var ae=M?1:2;if(Ut<=3+ae*2){Ut||Nt.push(Ct.createElement(Lm,$t({},Tt,{key:"noPager",page:1,className:"".concat(i,"-item-disabled")})));for(var ue=1;ue<=Ut;ue+=1)Nt.push(Ct.createElement(Lm,$t({},Tt,{key:ue,page:ue,active:he===ue})))}else{var Fe=M?_.prev_3:_.prev_5,ot=M?_.next_3:_.next_5,at=k(Q,"jump-prev",me(ie,"prev page")),It=k(ce,"jump-next",me(re,"next page"));Z&&(Zt=at?Ct.createElement("li",{title:F?Fe:null,key:"prev",onClick:He,tabIndex:0,onKeyDown:ut,className:gt("".concat(i,"-jump-prev"),Ve({},"".concat(i,"-jump-prev-custom-icon"),!!ie))},at):null,jt=It?Ct.createElement("li",{title:F?ot:null,key:"next",onClick:ht,tabIndex:0,onKeyDown:Rt,className:gt("".concat(i,"-jump-next"),Ve({},"".concat(i,"-jump-next-custom-icon"),!!re))},It):null);var Wt=Math.max(1,he-ae),xt=Math.min(he+ae,Ut);he-1<=ae&&(xt=1+ae*2),Ut-he<=ae&&(Wt=Ut-ae*2);for(var te=Wt;te<=xt;te+=1)Nt.push(Ct.createElement(Lm,$t({},Tt,{key:te,page:te,active:he===te})));if(he-1>=ae*2&&he!==3&&(Nt[0]=Ct.cloneElement(Nt[0],{className:gt("".concat(i,"-item-after-jump-prev"),Nt[0].props.className)}),Nt.unshift(Zt)),Ut-he>=ae*2&&he!==Ut-2){var Ie=Nt[Nt.length-1];Nt[Nt.length-1]=Ct.cloneElement(Ie,{className:gt("".concat(i,"-item-before-jump-next"),Ie.props.className)}),Nt.push(jt)}Wt!==1&&Nt.unshift(Ct.createElement(Lm,$t({},Tt,{key:1,page:1}))),xt!==Ut&&Nt.push(Ct.createElement(Lm,$t({},Tt,{key:Ut,page:Ut})))}var Ae=mt(Pt);if(Ae){var se=!$e||!Ut;Ae=Ct.createElement("li",{title:F?_.prev_page:null,onClick:ke,tabIndex:se?null:0,onKeyDown:ze,className:gt("".concat(i,"-prev"),Ve({},"".concat(i,"-disabled"),se)),"aria-disabled":se},Ae)}var Re=_t(qt);if(Re){var Ue,nt;L?(Ue=!je,nt=$e?0:null):(Ue=!je||!Ut,nt=Ue?null:0),Re=Ct.createElement("li",{title:F?_.next_page:null,onClick:Ce,tabIndex:nt,onKeyDown:Qe,className:gt("".concat(i,"-next"),Ve({},"".concat(i,"-disabled"),Ue)),"aria-disabled":Ue},Re)}var pt=gt(i,r,Ve(Ve(Ve(Ve(Ve({},"".concat(i,"-start"),S==="start"),"".concat(i,"-center"),S==="center"),"".concat(i,"-end"),S==="end"),"".concat(i,"-simple"),L),"".concat(i,"-disabled"),X));return Ct.createElement("ul",$t({className:pt,style:D,ref:xe},yt),Ht,Ae,L?sn:Nt,Re,Ct.createElement(rhe,{locale:_,rootPrefixCls:i,disabled:X,selectPrefixCls:o,changeSize:qe,pageSize:pe,pageSizeOptions:j,quickGo:De?lt:null,goButton:fn,showSizeChanger:K,sizeChangerRender:O}))};const che=n=>{const{componentCls:e}=n;return{[`${e}-disabled`]:{"&, &:hover":{cursor:"not-allowed",[`${e}-item-link`]:{color:n.colorTextDisabled,cursor:"not-allowed"}},"&:focus-visible":{cursor:"not-allowed",[`${e}-item-link`]:{color:n.colorTextDisabled,cursor:"not-allowed"}}},[`&${e}-disabled`]:{cursor:"not-allowed",[`${e}-item`]:{cursor:"not-allowed",backgroundColor:"transparent","&:hover, &:active":{backgroundColor:"transparent"},a:{color:n.colorTextDisabled,backgroundColor:"transparent",border:"none",cursor:"not-allowed"},"&-active":{borderColor:n.colorBorder,backgroundColor:n.itemActiveBgDisabled,"&:hover, &:active":{backgroundColor:n.itemActiveBgDisabled},a:{color:n.itemActiveColorDisabled}}},[`${e}-item-link`]:{color:n.colorTextDisabled,cursor:"not-allowed","&:hover, &:active":{backgroundColor:"transparent"},[`${e}-simple&`]:{backgroundColor:"transparent","&:hover, &:active":{backgroundColor:"transparent"}}},[`${e}-simple-pager`]:{color:n.colorTextDisabled},[`${e}-jump-prev, ${e}-jump-next`]:{[`${e}-item-link-icon`]:{opacity:0},[`${e}-item-ellipsis`]:{opacity:1}}},[`&${e}-simple`]:{[`${e}-prev, ${e}-next`]:{[`&${e}-disabled ${e}-item-link`]:{"&:hover, &:active":{backgroundColor:"transparent"}}}}}},ghe=n=>{const{componentCls:e}=n;return{[`&${e}-mini ${e}-total-text, &${e}-mini ${e}-simple-pager`]:{height:n.itemSizeSM,lineHeight:st(n.itemSizeSM)},[`&${e}-mini ${e}-item`]:{minWidth:n.itemSizeSM,height:n.itemSizeSM,margin:0,lineHeight:st(n.calc(n.itemSizeSM).sub(2).equal())},[`&${e}-mini ${e}-prev, &${e}-mini ${e}-next`]:{minWidth:n.itemSizeSM,height:n.itemSizeSM,margin:0,lineHeight:st(n.itemSizeSM)},[`&${e}-mini:not(${e}-disabled)`]:{[`${e}-prev, ${e}-next`]:{[`&:hover ${e}-item-link`]:{backgroundColor:n.colorBgTextHover},[`&:active ${e}-item-link`]:{backgroundColor:n.colorBgTextActive},[`&${e}-disabled:hover ${e}-item-link`]:{backgroundColor:"transparent"}}},[`
    &${e}-mini ${e}-prev ${e}-item-link,
    &${e}-mini ${e}-next ${e}-item-link
    `]:{backgroundColor:"transparent",borderColor:"transparent","&::after":{height:n.itemSizeSM,lineHeight:st(n.itemSizeSM)}},[`&${e}-mini ${e}-jump-prev, &${e}-mini ${e}-jump-next`]:{height:n.itemSizeSM,marginInlineEnd:0,lineHeight:st(n.itemSizeSM)},[`&${e}-mini ${e}-options`]:{marginInlineStart:n.paginationMiniOptionsMarginInlineStart,"&-size-changer":{top:n.miniOptionsSizeChangerTop},"&-quick-jumper":{height:n.itemSizeSM,lineHeight:st(n.itemSizeSM),input:Object.assign(Object.assign({},YM(n)),{width:n.paginationMiniQuickJumperInputWidth,height:n.controlHeightSM})}}}},uhe=n=>{const{componentCls:e}=n;return{[`
    &${e}-simple ${e}-prev,
    &${e}-simple ${e}-next
    `]:{height:n.itemSizeSM,lineHeight:st(n.itemSizeSM),verticalAlign:"top",[`${e}-item-link`]:{height:n.itemSizeSM,backgroundColor:"transparent",border:0,"&:hover":{backgroundColor:n.colorBgTextHover},"&:active":{backgroundColor:n.colorBgTextActive},"&::after":{height:n.itemSizeSM,lineHeight:st(n.itemSizeSM)}}},[`&${e}-simple ${e}-simple-pager`]:{display:"inline-block",height:n.itemSizeSM,marginInlineEnd:n.marginXS,input:{boxSizing:"border-box",height:"100%",padding:`0 ${st(n.paginationItemPaddingInline)}`,textAlign:"center",backgroundColor:n.itemInputBg,border:`${st(n.lineWidth)} ${n.lineType} ${n.colorBorder}`,borderRadius:n.borderRadius,outline:"none",transition:`border-color ${n.motionDurationMid}`,color:"inherit","&:hover":{borderColor:n.colorPrimary},"&:focus":{borderColor:n.colorPrimaryHover,boxShadow:`${st(n.inputOutlineOffset)} 0 ${st(n.controlOutlineWidth)} ${n.controlOutline}`},"&[disabled]":{color:n.colorTextDisabled,backgroundColor:n.colorBgContainerDisabled,borderColor:n.colorBorder,cursor:"not-allowed"}}}}},dhe=n=>{const{componentCls:e}=n;return{[`${e}-jump-prev, ${e}-jump-next`]:{outline:0,[`${e}-item-container`]:{position:"relative",[`${e}-item-link-icon`]:{color:n.colorPrimary,fontSize:n.fontSizeSM,opacity:0,transition:`all ${n.motionDurationMid}`,"&-svg":{top:0,insetInlineEnd:0,bottom:0,insetInlineStart:0,margin:"auto"}},[`${e}-item-ellipsis`]:{position:"absolute",top:0,insetInlineEnd:0,bottom:0,insetInlineStart:0,display:"block",margin:"auto",color:n.colorTextDisabled,letterSpacing:n.paginationEllipsisLetterSpacing,textAlign:"center",textIndent:n.paginationEllipsisTextIndent,opacity:1,transition:`all ${n.motionDurationMid}`}},"&:hover":{[`${e}-item-link-icon`]:{opacity:1},[`${e}-item-ellipsis`]:{opacity:0}}},[`
    ${e}-prev,
    ${e}-jump-prev,
    ${e}-jump-next
    `]:{marginInlineEnd:n.marginXS},[`
    ${e}-prev,
    ${e}-next,
    ${e}-jump-prev,
    ${e}-jump-next
    `]:{display:"inline-block",minWidth:n.itemSize,height:n.itemSize,color:n.colorText,fontFamily:n.fontFamily,lineHeight:st(n.itemSize),textAlign:"center",verticalAlign:"middle",listStyle:"none",borderRadius:n.borderRadius,cursor:"pointer",transition:`all ${n.motionDurationMid}`},[`${e}-prev, ${e}-next`]:{outline:0,button:{color:n.colorText,cursor:"pointer",userSelect:"none"},[`${e}-item-link`]:{display:"block",width:"100%",height:"100%",padding:0,fontSize:n.fontSizeSM,textAlign:"center",backgroundColor:"transparent",border:`${st(n.lineWidth)} ${n.lineType} transparent`,borderRadius:n.borderRadius,outline:"none",transition:`all ${n.motionDurationMid}`},[`&:hover ${e}-item-link`]:{backgroundColor:n.colorBgTextHover},[`&:active ${e}-item-link`]:{backgroundColor:n.colorBgTextActive},[`&${e}-disabled:hover`]:{[`${e}-item-link`]:{backgroundColor:"transparent"}}},[`${e}-slash`]:{marginInlineEnd:n.paginationSlashMarginInlineEnd,marginInlineStart:n.paginationSlashMarginInlineStart},[`${e}-options`]:{display:"inline-block",marginInlineStart:n.margin,verticalAlign:"middle","&-size-changer":{display:"inline-block",width:"auto"},"&-quick-jumper":{display:"inline-block",height:n.controlHeight,marginInlineStart:n.marginXS,lineHeight:st(n.controlHeight),verticalAlign:"top",input:Object.assign(Object.assign(Object.assign({},zM(n)),TM(n,{borderColor:n.colorBorder,hoverBorderColor:n.colorPrimaryHover,activeBorderColor:n.colorPrimary,activeShadow:n.activeShadow})),{"&[disabled]":Object.assign({},pS(n)),width:n.calc(n.controlHeightLG).mul(1.25).equal(),height:n.controlHeight,boxSizing:"border-box",margin:0,marginInlineStart:n.marginXS,marginInlineEnd:n.marginXS})}}}},Che=n=>{const{componentCls:e}=n;return{[`${e}-item`]:{display:"inline-block",minWidth:n.itemSize,height:n.itemSize,marginInlineEnd:n.marginXS,fontFamily:n.fontFamily,lineHeight:st(n.calc(n.itemSize).sub(2).equal()),textAlign:"center",verticalAlign:"middle",listStyle:"none",backgroundColor:n.itemBg,border:`${st(n.lineWidth)} ${n.lineType} transparent`,borderRadius:n.borderRadius,outline:0,cursor:"pointer",userSelect:"none",a:{display:"block",padding:`0 ${st(n.paginationItemPaddingInline)}`,color:n.colorText,"&:hover":{textDecoration:"none"}},[`&:not(${e}-item-active)`]:{"&:hover":{transition:`all ${n.motionDurationMid}`,backgroundColor:n.colorBgTextHover},"&:active":{backgroundColor:n.colorBgTextActive}},"&-active":{fontWeight:n.fontWeightStrong,backgroundColor:n.itemActiveBg,borderColor:n.colorPrimary,a:{color:n.colorPrimary},"&:hover":{borderColor:n.colorPrimaryHover},"&:hover a":{color:n.colorPrimaryHover}}}}},Ihe=n=>{const{componentCls:e}=n;return{[e]:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Po(n)),{display:"flex","&-start":{justifyContent:"start"},"&-center":{justifyContent:"center"},"&-end":{justifyContent:"end"},"ul, ol":{margin:0,padding:0,listStyle:"none"},"&::after":{display:"block",clear:"both",height:0,overflow:"hidden",visibility:"hidden",content:'""'},[`${e}-total-text`]:{display:"inline-block",height:n.itemSize,marginInlineEnd:n.marginXS,lineHeight:st(n.calc(n.itemSize).sub(2).equal()),verticalAlign:"middle"}}),Che(n)),dhe(n)),uhe(n)),ghe(n)),che(n)),{[`@media only screen and (max-width: ${n.screenLG}px)`]:{[`${e}-item`]:{"&-after-jump-prev, &-before-jump-next":{display:"none"}}},[`@media only screen and (max-width: ${n.screenSM}px)`]:{[`${e}-options`]:{display:"none"}}}),[`&${n.componentCls}-rtl`]:{direction:"rtl"}}},hhe=n=>{const{componentCls:e}=n;return{[`${e}:not(${e}-disabled)`]:{[`${e}-item`]:Object.assign({},Yf(n)),[`${e}-jump-prev, ${e}-jump-next`]:{"&:focus-visible":Object.assign({[`${e}-item-link-icon`]:{opacity:1},[`${e}-item-ellipsis`]:{opacity:0}},II(n))},[`${e}-prev, ${e}-next`]:{[`&:focus-visible ${e}-item-link`]:Object.assign({},II(n))}}}},HK=n=>Object.assign({itemBg:n.colorBgContainer,itemSize:n.controlHeight,itemSizeSM:n.controlHeightSM,itemActiveBg:n.colorBgContainer,itemLinkBg:n.colorBgContainer,itemActiveColorDisabled:n.colorTextDisabled,itemActiveBgDisabled:n.controlItemBgActiveDisabled,itemInputBg:n.colorBgContainer,miniOptionsSizeChangerTop:0},Mb(n)),FK=n=>Xi(n,{inputOutlineOffset:0,paginationMiniOptionsMarginInlineStart:n.calc(n.marginXXS).div(2).equal(),paginationMiniQuickJumperInputWidth:n.calc(n.controlHeightLG).mul(1.1).equal(),paginationItemPaddingInline:n.calc(n.marginXXS).mul(1.5).equal(),paginationEllipsisLetterSpacing:n.calc(n.marginXXS).div(2).equal(),paginationSlashMarginInlineStart:n.marginSM,paginationSlashMarginInlineEnd:n.marginSM,paginationEllipsisTextIndent:"0.13em"},xb(n)),fhe=Oa("Pagination",n=>{const e=FK(n);return[Ihe(e),hhe(e)]},HK),Ahe=n=>{const{componentCls:e}=n;return{[`${e}${e}-bordered${e}-disabled:not(${e}-mini)`]:{"&, &:hover":{[`${e}-item-link`]:{borderColor:n.colorBorder}},"&:focus-visible":{[`${e}-item-link`]:{borderColor:n.colorBorder}},[`${e}-item, ${e}-item-link`]:{backgroundColor:n.colorBgContainerDisabled,borderColor:n.colorBorder,[`&:hover:not(${e}-item-active)`]:{backgroundColor:n.colorBgContainerDisabled,borderColor:n.colorBorder,a:{color:n.colorTextDisabled}},[`&${e}-item-active`]:{backgroundColor:n.itemActiveBgDisabled}},[`${e}-prev, ${e}-next`]:{"&:hover button":{backgroundColor:n.colorBgContainerDisabled,borderColor:n.colorBorder,color:n.colorTextDisabled},[`${e}-item-link`]:{backgroundColor:n.colorBgContainerDisabled,borderColor:n.colorBorder}}},[`${e}${e}-bordered:not(${e}-mini)`]:{[`${e}-prev, ${e}-next`]:{"&:hover button":{borderColor:n.colorPrimaryHover,backgroundColor:n.itemBg},[`${e}-item-link`]:{backgroundColor:n.itemLinkBg,borderColor:n.colorBorder},[`&:hover ${e}-item-link`]:{borderColor:n.colorPrimary,backgroundColor:n.itemBg,color:n.colorPrimary},[`&${e}-disabled`]:{[`${e}-item-link`]:{borderColor:n.colorBorder,color:n.colorTextDisabled}}},[`${e}-item`]:{backgroundColor:n.itemBg,border:`${st(n.lineWidth)} ${n.lineType} ${n.colorBorder}`,[`&:hover:not(${e}-item-active)`]:{borderColor:n.colorPrimary,backgroundColor:n.itemBg,a:{color:n.colorPrimary}},"&-active":{borderColor:n.colorPrimary}}}}},mhe=FY(["Pagination","bordered"],n=>{const e=FK(n);return[Ahe(e)]},HK);function aF(n){return v.useMemo(()=>typeof n=="boolean"?[n,{}]:n&&typeof n=="object"?[!0,n]:[void 0,void 0],[n])}var phe=function(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(n);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(n,i[a])&&(t[i[a]]=n[i[a]]);return t};const bhe=n=>{const{align:e,prefixCls:t,selectPrefixCls:i,className:a,rootClassName:o,style:r,size:s,locale:l,responsive:c,showSizeChanger:u,selectComponentClass:C,pageSizeOptions:h}=n,m=phe(n,["align","prefixCls","selectPrefixCls","className","rootClassName","style","size","locale","responsive","showSizeChanger","selectComponentClass","pageSizeOptions"]),{xs:p}=WM(c),[,B]=ks(),{getPrefixCls:b,direction:y,showSizeChanger:S,className:R,style:Z}=Gs("pagination"),x=b("pagination",t),[M,E,F]=fhe(x),N=Sl(s),H=N==="small"||!!(p&&!N&&c),[z]=bb("Pagination",bY),_=Object.assign(Object.assign({},z),l),[D,P]=aF(u),[$,X]=aF(S),L=D??$,U=P??X,q=C||xd,K=v.useMemo(()=>h?h.map(re=>Number(re)):void 0,[h]),O=re=>{var ge;const{disabled:de,size:xe,onSizeChange:Ne,"aria-label":ye,className:pe,options:Te}=re,{className:le,onChange:Ye}=U||{},he=(ge=Te.find(Ge=>String(Ge.value)===String(xe)))===null||ge===void 0?void 0:ge.value;return v.createElement(q,Object.assign({disabled:de,showSearch:!0,popupMatchSelectWidth:!1,getPopupContainer:Ge=>Ge.parentNode,"aria-label":ye,options:Te},U,{value:he,onChange:(Ge,be)=>{Ne==null||Ne(Ge),Ye==null||Ye(Ge,be)},size:H?"small":"middle",className:gt(pe,le)}))},j=v.useMemo(()=>{const re=v.createElement("span",{className:`${x}-item-ellipsis`},""),ge=v.createElement("button",{className:`${x}-item-link`,type:"button",tabIndex:-1},y==="rtl"?v.createElement(VH,null):v.createElement(B3,null)),de=v.createElement("button",{className:`${x}-item-link`,type:"button",tabIndex:-1},y==="rtl"?v.createElement(B3,null):v.createElement(VH,null)),xe=v.createElement("a",{className:`${x}-item-link`},v.createElement("div",{className:`${x}-item-container`},y==="rtl"?v.createElement(tF,{className:`${x}-item-link-icon`}):v.createElement(eF,{className:`${x}-item-link-icon`}),re)),Ne=v.createElement("a",{className:`${x}-item-link`},v.createElement("div",{className:`${x}-item-container`},y==="rtl"?v.createElement(eF,{className:`${x}-item-link-icon`}):v.createElement(tF,{className:`${x}-item-link-icon`}),re));return{prevIcon:ge,nextIcon:de,jumpPrevIcon:xe,jumpNextIcon:Ne}},[y,x]),ne=b("select",i),k=gt({[`${x}-${e}`]:!!e,[`${x}-mini`]:H,[`${x}-rtl`]:y==="rtl",[`${x}-bordered`]:B.wireframe},R,a,o,E,F),ie=Object.assign(Object.assign({},Z),r);return M(v.createElement(v.Fragment,null,B.wireframe&&v.createElement(mhe,{prefixCls:x}),v.createElement(lhe,Object.assign({},j,m,{style:ie,prefixCls:x,selectPrefixCls:ne,className:k,locale:_,pageSizeOptions:K,showSizeChanger:L,sizeChangerRender:O}))))},eG=100,XK=eG/5,TK=eG/2-XK/2,I1=TK*2*Math.PI,oF=50,rF=n=>{const{dotClassName:e,style:t,hasCircleCls:i}=n;return v.createElement("circle",{className:gt(`${e}-circle`,{[`${e}-circle-bg`]:i}),r:TK,cx:oF,cy:oF,strokeWidth:XK,style:t})},vhe=n=>{let{percent:e,prefixCls:t}=n;const i=`${t}-dot`,a=`${i}-holder`,o=`${a}-hidden`,[r,s]=v.useState(!1);xi(()=>{e!==0&&s(!0)},[e!==0]);const l=Math.max(Math.min(e,100),0);if(!r)return null;const c={strokeDashoffset:`${I1/4}`,strokeDasharray:`${I1*l/100} ${I1*(100-l)/100}`};return v.createElement("span",{className:gt(a,`${i}-progress`,l<=0&&o)},v.createElement("svg",{viewBox:`0 0 ${eG} ${eG}`,role:"progressbar","aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":l},v.createElement(rF,{dotClassName:i,hasCircleCls:!0}),v.createElement(rF,{dotClassName:i,style:c})))};function yhe(n){const{prefixCls:e,percent:t=0}=n,i=`${e}-dot`,a=`${i}-holder`,o=`${a}-hidden`;return v.createElement(v.Fragment,null,v.createElement("span",{className:gt(a,t>0&&o)},v.createElement("span",{className:gt(i,`${e}-dot-spin`)},[1,2,3,4].map(r=>v.createElement("i",{className:`${e}-dot-item`,key:r})))),v.createElement(vhe,{prefixCls:e,percent:t}))}function Bhe(n){const{prefixCls:e,indicator:t,percent:i}=n,a=`${e}-dot`;return t&&v.isValidElement(t)?Bd(t,{className:gt(t.props.className,a),percent:i}):v.createElement(yhe,{prefixCls:e,percent:i})}const Ghe=new Ti("antSpinMove",{to:{opacity:1}}),She=new Ti("antRotate",{to:{transform:"rotate(405deg)"}}),whe=n=>{const{componentCls:e,calc:t}=n;return{[e]:Object.assign(Object.assign({},Po(n)),{position:"absolute",display:"none",color:n.colorPrimary,fontSize:0,textAlign:"center",verticalAlign:"middle",opacity:0,transition:`transform ${n.motionDurationSlow} ${n.motionEaseInOutCirc}`,"&-spinning":{position:"relative",display:"inline-block",opacity:1},[`${e}-text`]:{fontSize:n.fontSize,paddingTop:t(t(n.dotSize).sub(n.fontSize)).div(2).add(2).equal()},"&-fullscreen":{position:"fixed",width:"100vw",height:"100vh",backgroundColor:n.colorBgMask,zIndex:n.zIndexPopupBase,inset:0,display:"flex",alignItems:"center",flexDirection:"column",justifyContent:"center",opacity:0,visibility:"hidden",transition:`all ${n.motionDurationMid}`,"&-show":{opacity:1,visibility:"visible"},[e]:{[`${e}-dot-holder`]:{color:n.colorWhite},[`${e}-text`]:{color:n.colorTextLightSolid}}},"&-nested-loading":{position:"relative",[`> div > ${e}`]:{position:"absolute",top:0,insetInlineStart:0,zIndex:4,display:"block",width:"100%",height:"100%",maxHeight:n.contentHeight,[`${e}-dot`]:{position:"absolute",top:"50%",insetInlineStart:"50%",margin:t(n.dotSize).mul(-1).div(2).equal()},[`${e}-text`]:{position:"absolute",top:"50%",width:"100%",textShadow:`0 1px 2px ${n.colorBgContainer}`},[`&${e}-show-text ${e}-dot`]:{marginTop:t(n.dotSize).div(2).mul(-1).sub(10).equal()},"&-sm":{[`${e}-dot`]:{margin:t(n.dotSizeSM).mul(-1).div(2).equal()},[`${e}-text`]:{paddingTop:t(t(n.dotSizeSM).sub(n.fontSize)).div(2).add(2).equal()},[`&${e}-show-text ${e}-dot`]:{marginTop:t(n.dotSizeSM).div(2).mul(-1).sub(10).equal()}},"&-lg":{[`${e}-dot`]:{margin:t(n.dotSizeLG).mul(-1).div(2).equal()},[`${e}-text`]:{paddingTop:t(t(n.dotSizeLG).sub(n.fontSize)).div(2).add(2).equal()},[`&${e}-show-text ${e}-dot`]:{marginTop:t(n.dotSizeLG).div(2).mul(-1).sub(10).equal()}}},[`${e}-container`]:{position:"relative",transition:`opacity ${n.motionDurationSlow}`,"&::after":{position:"absolute",top:0,insetInlineEnd:0,bottom:0,insetInlineStart:0,zIndex:10,width:"100%",height:"100%",background:n.colorBgContainer,opacity:0,transition:`all ${n.motionDurationSlow}`,content:'""',pointerEvents:"none"}},[`${e}-blur`]:{clear:"both",opacity:.5,userSelect:"none",pointerEvents:"none","&::after":{opacity:.4,pointerEvents:"auto"}}},"&-tip":{color:n.spinDotDefault},[`${e}-dot-holder`]:{width:"1em",height:"1em",fontSize:n.dotSize,display:"inline-block",transition:`transform ${n.motionDurationSlow} ease, opacity ${n.motionDurationSlow} ease`,transformOrigin:"50% 50%",lineHeight:1,color:n.colorPrimary,"&-hidden":{transform:"scale(0.3)",opacity:0}},[`${e}-dot-progress`]:{position:"absolute",inset:0},[`${e}-dot`]:{position:"relative",display:"inline-block",fontSize:n.dotSize,width:"1em",height:"1em","&-item":{position:"absolute",display:"block",width:t(n.dotSize).sub(t(n.marginXXS).div(2)).div(2).equal(),height:t(n.dotSize).sub(t(n.marginXXS).div(2)).div(2).equal(),background:"currentColor",borderRadius:"100%",transform:"scale(0.75)",transformOrigin:"50% 50%",opacity:.3,animationName:Ghe,animationDuration:"1s",animationIterationCount:"infinite",animationTimingFunction:"linear",animationDirection:"alternate","&:nth-child(1)":{top:0,insetInlineStart:0,animationDelay:"0s"},"&:nth-child(2)":{top:0,insetInlineEnd:0,animationDelay:"0.4s"},"&:nth-child(3)":{insetInlineEnd:0,bottom:0,animationDelay:"0.8s"},"&:nth-child(4)":{bottom:0,insetInlineStart:0,animationDelay:"1.2s"}},"&-spin":{transform:"rotate(45deg)",animationName:She,animationDuration:"1.2s",animationIterationCount:"infinite",animationTimingFunction:"linear"},"&-circle":{strokeLinecap:"round",transition:["stroke-dashoffset","stroke-dasharray","stroke","stroke-width","opacity"].map(i=>`${i} ${n.motionDurationSlow} ease`).join(","),fillOpacity:0,stroke:"currentcolor"},"&-circle-bg":{stroke:n.colorFillSecondary}},[`&-sm ${e}-dot`]:{"&, &-holder":{fontSize:n.dotSizeSM}},[`&-sm ${e}-dot-holder`]:{i:{width:t(t(n.dotSizeSM).sub(t(n.marginXXS).div(2))).div(2).equal(),height:t(t(n.dotSizeSM).sub(t(n.marginXXS).div(2))).div(2).equal()}},[`&-lg ${e}-dot`]:{"&, &-holder":{fontSize:n.dotSizeLG}},[`&-lg ${e}-dot-holder`]:{i:{width:t(t(n.dotSizeLG).sub(n.marginXXS)).div(2).equal(),height:t(t(n.dotSizeLG).sub(n.marginXXS)).div(2).equal()}},[`&${e}-show-text ${e}-text`]:{display:"block"}})}},Rhe=n=>{const{controlHeightLG:e,controlHeight:t}=n;return{contentHeight:400,dotSize:e/2,dotSizeSM:e*.35,dotSizeLG:t}},Zhe=Oa("Spin",n=>{const e=Xi(n,{spinDotDefault:n.colorTextDescription});return[whe(e)]},Rhe),xhe=200,sF=[[30,.05],[70,.03],[96,.01]];function Mhe(n,e){const[t,i]=v.useState(0),a=v.useRef(null),o=e==="auto";return v.useEffect(()=>(o&&n&&(i(0),a.current=setInterval(()=>{i(r=>{const s=100-r;for(let l=0;l<sF.length;l+=1){const[c,u]=sF[l];if(r<=c)return r+s*u}return r})},xhe)),()=>{clearInterval(a.current)}),[o,n]),o?t:e}var Whe=function(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(n);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(n,i[a])&&(t[i[a]]=n[i[a]]);return t};let YK;function Vhe(n,e){return!!n&&!!e&&!Number.isNaN(Number(e))}const zK=n=>{var e;const{prefixCls:t,spinning:i=!0,delay:a=0,className:o,rootClassName:r,size:s="default",tip:l,wrapperClassName:c,style:u,children:C,fullscreen:h=!1,indicator:m,percent:p}=n,B=Whe(n,["prefixCls","spinning","delay","className","rootClassName","size","tip","wrapperClassName","style","children","fullscreen","indicator","percent"]),{getPrefixCls:b,direction:y,className:S,style:R,indicator:Z}=Gs("spin"),x=b("spin",t),[M,E,F]=Zhe(x),[N,H]=v.useState(()=>i&&!Vhe(i,a)),z=Mhe(N,p);v.useEffect(()=>{if(i){const U=ZCe(a,()=>{H(!0)});return U(),()=>{var q;(q=U==null?void 0:U.cancel)===null||q===void 0||q.call(U)}}H(!1)},[a,i]);const _=v.useMemo(()=>typeof C<"u"&&!h,[C,h]),D=gt(x,S,{[`${x}-sm`]:s==="small",[`${x}-lg`]:s==="large",[`${x}-spinning`]:N,[`${x}-show-text`]:!!l,[`${x}-rtl`]:y==="rtl"},o,!h&&r,E,F),P=gt(`${x}-container`,{[`${x}-blur`]:N}),$=(e=m??Z)!==null&&e!==void 0?e:YK,X=Object.assign(Object.assign({},R),u),L=v.createElement("div",Object.assign({},B,{style:X,className:D,"aria-live":"polite","aria-busy":N}),v.createElement(Bhe,{prefixCls:x,indicator:$,percent:z}),l&&(_||h)?v.createElement("div",{className:`${x}-text`},l):null);return M(_?v.createElement("div",Object.assign({},B,{className:gt(`${x}-nested-loading`,c,E,F)}),N&&v.createElement("div",{key:"loading"},L),v.createElement("div",{className:P,key:"container"},C)):h?v.createElement("div",{className:gt(`${x}-fullscreen`,{[`${x}-fullscreen-show`]:N},r,E,F)},L):L)};zK.setDefaultIndicator=n=>{YK=n};const DM=Ct.createContext({});DM.Consumer;var KK=function(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(n);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(n,i[a])&&(t[i[a]]=n[i[a]]);return t};const Nhe=n=>{var{prefixCls:e,className:t,avatar:i,title:a,description:o}=n,r=KK(n,["prefixCls","className","avatar","title","description"]);const{getPrefixCls:s}=v.useContext(ui),l=s("list",e),c=gt(`${l}-item-meta`,t),u=Ct.createElement("div",{className:`${l}-item-meta-content`},a&&Ct.createElement("h4",{className:`${l}-item-meta-title`},a),o&&Ct.createElement("div",{className:`${l}-item-meta-description`},o));return Ct.createElement("div",Object.assign({},r,{className:c}),i&&Ct.createElement("div",{className:`${l}-item-meta-avatar`},i),(a||o)&&u)},Ehe=Ct.forwardRef((n,e)=>{const{prefixCls:t,children:i,actions:a,extra:o,styles:r,className:s,classNames:l,colStyle:c}=n,u=KK(n,["prefixCls","children","actions","extra","styles","className","classNames","colStyle"]),{grid:C,itemLayout:h}=v.useContext(DM),{getPrefixCls:m,list:p}=v.useContext(ui),B=E=>{var F,N;return gt((N=(F=p==null?void 0:p.item)===null||F===void 0?void 0:F.classNames)===null||N===void 0?void 0:N[E],l==null?void 0:l[E])},b=E=>{var F,N;return Object.assign(Object.assign({},(N=(F=p==null?void 0:p.item)===null||F===void 0?void 0:F.styles)===null||N===void 0?void 0:N[E]),r==null?void 0:r[E])},y=()=>{let E=!1;return v.Children.forEach(i,F=>{typeof F=="string"&&(E=!0)}),E&&v.Children.count(i)>1},S=()=>h==="vertical"?!!o:!y(),R=m("list",t),Z=a&&a.length>0&&Ct.createElement("ul",{className:gt(`${R}-item-action`,B("actions")),key:"actions",style:b("actions")},a.map((E,F)=>Ct.createElement("li",{key:`${R}-item-action-${F}`},E,F!==a.length-1&&Ct.createElement("em",{className:`${R}-item-action-split`})))),x=C?"div":"li",M=Ct.createElement(x,Object.assign({},u,C?{}:{ref:e},{className:gt(`${R}-item`,{[`${R}-item-no-flex`]:!S()},s)}),h==="vertical"&&o?[Ct.createElement("div",{className:`${R}-item-main`,key:"content"},i,Z),Ct.createElement("div",{className:gt(`${R}-item-extra`,B("extra")),key:"extra",style:b("extra")},o)]:[i,Z,Bd(o,{key:"extra"})]);return C?Ct.createElement(WCe,{ref:e,flex:1,style:c},M):M}),LK=Ehe;LK.Meta=Nhe;const Hhe=n=>{const{listBorderedCls:e,componentCls:t,paddingLG:i,margin:a,itemPaddingSM:o,itemPaddingLG:r,marginLG:s,borderRadiusLG:l}=n;return{[e]:{border:`${st(n.lineWidth)} ${n.lineType} ${n.colorBorder}`,borderRadius:l,[`${t}-header,${t}-footer,${t}-item`]:{paddingInline:i},[`${t}-pagination`]:{margin:`${st(a)} ${st(s)}`}},[`${e}${t}-sm`]:{[`${t}-item,${t}-header,${t}-footer`]:{padding:o}},[`${e}${t}-lg`]:{[`${t}-item,${t}-header,${t}-footer`]:{padding:r}}}},Fhe=n=>{const{componentCls:e,screenSM:t,screenMD:i,marginLG:a,marginSM:o,margin:r}=n;return{[`@media screen and (max-width:${i}px)`]:{[e]:{[`${e}-item`]:{[`${e}-item-action`]:{marginInlineStart:a}}},[`${e}-vertical`]:{[`${e}-item`]:{[`${e}-item-extra`]:{marginInlineStart:a}}}},[`@media screen and (max-width: ${t}px)`]:{[e]:{[`${e}-item`]:{flexWrap:"wrap",[`${e}-action`]:{marginInlineStart:o}}},[`${e}-vertical`]:{[`${e}-item`]:{flexWrap:"wrap-reverse",[`${e}-item-main`]:{minWidth:n.contentWidth},[`${e}-item-extra`]:{margin:`auto auto ${st(r)}`}}}}}},Xhe=n=>{const{componentCls:e,antCls:t,controlHeight:i,minHeight:a,paddingSM:o,marginLG:r,padding:s,itemPadding:l,colorPrimary:c,itemPaddingSM:u,itemPaddingLG:C,paddingXS:h,margin:m,colorText:p,colorTextDescription:B,motionDurationSlow:b,lineWidth:y,headerBg:S,footerBg:R,emptyTextPadding:Z,metaMarginBottom:x,avatarMarginRight:M,titleMarginBottom:E,descriptionFontSize:F}=n;return{[e]:Object.assign(Object.assign({},Po(n)),{position:"relative","*":{outline:"none"},[`${e}-header`]:{background:S},[`${e}-footer`]:{background:R},[`${e}-header, ${e}-footer`]:{paddingBlock:o},[`${e}-pagination`]:{marginBlockStart:r,[`${t}-pagination-options`]:{textAlign:"start"}},[`${e}-spin`]:{minHeight:a,textAlign:"center"},[`${e}-items`]:{margin:0,padding:0,listStyle:"none"},[`${e}-item`]:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:l,color:p,[`${e}-item-meta`]:{display:"flex",flex:1,alignItems:"flex-start",maxWidth:"100%",[`${e}-item-meta-avatar`]:{marginInlineEnd:M},[`${e}-item-meta-content`]:{flex:"1 0",width:0,color:p},[`${e}-item-meta-title`]:{margin:`0 0 ${st(n.marginXXS)} 0`,color:p,fontSize:n.fontSize,lineHeight:n.lineHeight,"> a":{color:p,transition:`all ${b}`,"&:hover":{color:c}}},[`${e}-item-meta-description`]:{color:B,fontSize:F,lineHeight:n.lineHeight}},[`${e}-item-action`]:{flex:"0 0 auto",marginInlineStart:n.marginXXL,padding:0,fontSize:0,listStyle:"none","& > li":{position:"relative",display:"inline-block",padding:`0 ${st(h)}`,color:B,fontSize:n.fontSize,lineHeight:n.lineHeight,textAlign:"center","&:first-child":{paddingInlineStart:0}},[`${e}-item-action-split`]:{position:"absolute",insetBlockStart:"50%",insetInlineEnd:0,width:y,height:n.calc(n.fontHeight).sub(n.calc(n.marginXXS).mul(2)).equal(),transform:"translateY(-50%)",backgroundColor:n.colorSplit}}},[`${e}-empty`]:{padding:`${st(s)} 0`,color:B,fontSize:n.fontSizeSM,textAlign:"center"},[`${e}-empty-text`]:{padding:Z,color:n.colorTextDisabled,fontSize:n.fontSize,textAlign:"center"},[`${e}-item-no-flex`]:{display:"block"}}),[`${e}-grid ${t}-col > ${e}-item`]:{display:"block",maxWidth:"100%",marginBlockEnd:m,paddingBlock:0,borderBlockEnd:"none"},[`${e}-vertical ${e}-item`]:{alignItems:"initial",[`${e}-item-main`]:{display:"block",flex:1},[`${e}-item-extra`]:{marginInlineStart:r},[`${e}-item-meta`]:{marginBlockEnd:x,[`${e}-item-meta-title`]:{marginBlockStart:0,marginBlockEnd:E,color:p,fontSize:n.fontSizeLG,lineHeight:n.lineHeightLG}},[`${e}-item-action`]:{marginBlockStart:s,marginInlineStart:"auto","> li":{padding:`0 ${st(s)}`,"&:first-child":{paddingInlineStart:0}}}},[`${e}-split ${e}-item`]:{borderBlockEnd:`${st(n.lineWidth)} ${n.lineType} ${n.colorSplit}`,"&:last-child":{borderBlockEnd:"none"}},[`${e}-split ${e}-header`]:{borderBlockEnd:`${st(n.lineWidth)} ${n.lineType} ${n.colorSplit}`},[`${e}-split${e}-empty ${e}-footer`]:{borderTop:`${st(n.lineWidth)} ${n.lineType} ${n.colorSplit}`},[`${e}-loading ${e}-spin-nested-loading`]:{minHeight:i},[`${e}-split${e}-something-after-last-item ${t}-spin-container > ${e}-items > ${e}-item:last-child`]:{borderBlockEnd:`${st(n.lineWidth)} ${n.lineType} ${n.colorSplit}`},[`${e}-lg ${e}-item`]:{padding:C},[`${e}-sm ${e}-item`]:{padding:u},[`${e}:not(${e}-vertical)`]:{[`${e}-item-no-flex`]:{[`${e}-item-action`]:{float:"right"}}}}},The=n=>({contentWidth:220,itemPadding:`${st(n.paddingContentVertical)} 0`,itemPaddingSM:`${st(n.paddingContentVerticalSM)} ${st(n.paddingContentHorizontal)}`,itemPaddingLG:`${st(n.paddingContentVerticalLG)} ${st(n.paddingContentHorizontalLG)}`,headerBg:"transparent",footerBg:"transparent",emptyTextPadding:n.padding,metaMarginBottom:n.padding,avatarMarginRight:n.padding,titleMarginBottom:n.paddingSM,descriptionFontSize:n.fontSize}),Yhe=Oa("List",n=>{const e=Xi(n,{listBorderedCls:`${n.componentCls}-bordered`,minHeight:n.controlHeightLG});return[Xhe(e),Hhe(e),Fhe(e)]},The);var zhe=function(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(n);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(n,i[a])&&(t[i[a]]=n[i[a]]);return t};function Khe(n,e){var{pagination:t=!1,prefixCls:i,bordered:a=!1,split:o=!0,className:r,rootClassName:s,style:l,children:c,itemLayout:u,loadMore:C,grid:h,dataSource:m=[],size:p,header:B,footer:b,loading:y=!1,rowKey:S,renderItem:R,locale:Z}=n,x=zhe(n,["pagination","prefixCls","bordered","split","className","rootClassName","style","children","itemLayout","loadMore","grid","dataSource","size","header","footer","loading","rowKey","renderItem","locale"]);const M=t&&typeof t=="object"?t:{},[E,F]=v.useState(M.defaultCurrent||1),[N,H]=v.useState(M.defaultPageSize||10),{getPrefixCls:z,direction:_,className:D,style:P}=Gs("list"),{renderEmpty:$}=v.useContext(ui),X={current:1,total:0},L=Q=>(ce,me)=>{var Ze;F(ce),H(me),t&&((Ze=t==null?void 0:t[Q])===null||Ze===void 0||Ze.call(t,ce,me))},U=L("onChange"),q=L("onShowSizeChange"),K=(Q,ce)=>{if(!R)return null;let me;return typeof S=="function"?me=S(Q):S?me=Q[S]:me=Q.key,me||(me=`list-item-${ce}`),v.createElement(v.Fragment,{key:me},R(Q,ce))},O=()=>!!(C||t||b),j=z("list",i),[ne,k,ie]=Yhe(j);let re=y;typeof re=="boolean"&&(re={spinning:re});const ge=!!(re!=null&&re.spinning),de=Sl(p);let xe="";switch(de){case"large":xe="lg";break;case"small":xe="sm";break}const Ne=gt(j,{[`${j}-vertical`]:u==="vertical",[`${j}-${xe}`]:xe,[`${j}-split`]:o,[`${j}-bordered`]:a,[`${j}-loading`]:ge,[`${j}-grid`]:!!h,[`${j}-something-after-last-item`]:O(),[`${j}-rtl`]:_==="rtl"},D,r,s,k,ie),ye=$Ie(X,{total:m.length,current:E,pageSize:N},t||{}),pe=Math.ceil(ye.total/ye.pageSize);ye.current>pe&&(ye.current=pe);const Te=t&&v.createElement("div",{className:gt(`${j}-pagination`)},v.createElement(bhe,Object.assign({align:"end"},ye,{onChange:U,onShowSizeChange:q})));let le=an(m);t&&m.length>(ye.current-1)*ye.pageSize&&(le=an(m).splice((ye.current-1)*ye.pageSize,ye.pageSize));const Ye=Object.keys(h||{}).some(Q=>["xs","sm","md","lg","xl","xxl"].includes(Q)),he=WM(Ye),Ge=v.useMemo(()=>{for(let Q=0;Q<fI.length;Q+=1){const ce=fI[Q];if(he[ce])return ce}},[he]),be=v.useMemo(()=>{if(!h)return;const Q=Ge&&h[Ge]?h[Ge]:h.column;if(Q)return{width:`${100/Q}%`,maxWidth:`${100/Q}%`}},[JSON.stringify(h),Ge]);let Ee=ge&&v.createElement("div",{style:{minHeight:53}});if(le.length>0){const Q=le.map((ce,me)=>K(ce,me));Ee=h?v.createElement(ECe,{gutter:h.gutter},v.Children.map(Q,ce=>v.createElement("div",{key:ce==null?void 0:ce.key,style:be},ce))):v.createElement("ul",{className:`${j}-items`},Q)}else!c&&!ge&&(Ee=v.createElement("div",{className:`${j}-empty-text`},(Z==null?void 0:Z.emptyText)||($==null?void 0:$("List"))||v.createElement(Tz,{componentName:"List"})));const Se=ye.position||"bottom",ee=v.useMemo(()=>({grid:h,itemLayout:u}),[JSON.stringify(h),u]);return ne(v.createElement(DM.Provider,{value:ee},v.createElement("div",Object.assign({ref:e,style:Object.assign(Object.assign({},P),l),className:Ne},x),(Se==="top"||Se==="both")&&Te,B&&v.createElement("div",{className:`${j}-header`},B),v.createElement(zK,Object.assign({},re),Ee,c),b&&v.createElement("div",{className:`${j}-footer`},b),C||(Se==="bottom"||Se==="both")&&Te)))}const Lhe=v.forwardRef(Khe),Ky=Lhe;Ky.Item=LK;const _he=function(n){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)&&n==null?[]:Array.isArray(n)?n:[n]};var Dhe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 64H296c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h496v688c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V96c0-17.7-14.3-32-32-32zM704 192H192c-17.7 0-32 14.3-32 32v530.7c0 8.5 3.4 16.6 9.4 22.6l173.3 173.3c2.2 2.2 4.7 4 7.4 5.5v1.9h4.2c3.5 1.3 7.2 2 11 2H704c17.7 0 32-14.3 32-32V224c0-17.7-14.3-32-32-32zM350 856.2L263.9 770H350v86.2zM664 888H414V746c0-22.1-17.9-40-40-40H232V264h432v624z"}}]},name:"copy",theme:"outlined"},Ohe=function(e,t){return v.createElement(io,$t({},e,{ref:t,icon:Dhe}))},Uhe=v.forwardRef(Ohe),khe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M257.7 752c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 000-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 009.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9zm67.4-174.4L687.8 215l73.3 73.3-362.7 362.6-88.9 15.7 15.6-89zM880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32z"}}]},name:"edit",theme:"outlined"},Phe=function(e,t){return v.createElement(io,$t({},e,{ref:t,icon:khe}))},Jhe=v.forwardRef(Phe),jhe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M864 170h-60c-4.4 0-8 3.6-8 8v518H310v-73c0-6.7-7.8-10.5-13-6.3l-141.9 112a8 8 0 000 12.6l141.9 112c5.3 4.2 13 .4 13-6.3v-75h498c35.3 0 64-28.7 64-64V178c0-4.4-3.6-8-8-8z"}}]},name:"enter",theme:"outlined"},Qhe=function(e,t){return v.createElement(io,$t({},e,{ref:t,icon:jhe}))},qhe=v.forwardRef(Qhe),$he={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M946.5 505L560.1 118.8l-25.9-25.9a31.5 31.5 0 00-44.4 0L77.5 505a63.9 63.9 0 00-18.8 46c.4 35.2 29.7 63.3 64.9 63.3h42.5V940h691.8V614.3h43.4c17.1 0 33.2-6.7 45.3-18.8a63.6 63.6 0 0018.7-45.3c0-17-6.7-33.1-18.8-45.2zM568 868H456V664h112v204zm217.9-325.7V868H632V640c0-22.1-17.9-40-40-40H432c-22.1 0-40 17.9-40 40v228H238.1V542.3h-96l370-369.7 23.1 23.1L882 542.3h-96.1z"}}]},name:"home",theme:"outlined"},efe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M464 336a48 48 0 1096 0 48 48 0 10-96 0zm72 112h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V456c0-4.4-3.6-8-8-8z"}}]},name:"info-circle",theme:"outlined"},tfe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M909.1 209.3l-56.4 44.1C775.8 155.1 656.2 92 521.9 92 290 92 102.3 279.5 102 511.5 101.7 743.7 289.8 932 521.9 932c181.3 0 335.8-115 394.6-276.1 1.5-4.2-.7-8.9-4.9-10.3l-56.7-19.5a8 8 0 00-10.1 4.8c-1.8 5-3.8 10-5.9 14.9-17.3 41-42.1 77.8-73.7 109.4A344.77 344.77 0 01655.9 829c-42.3 17.9-87.4 27-133.8 27-46.5 0-91.5-9.1-133.8-27A341.5 341.5 0 01279 755.2a342.16 342.16 0 01-73.7-109.4c-17.9-42.4-27-87.4-27-133.9s9.1-91.5 27-133.9c17.3-41 42.1-77.8 73.7-109.4 31.6-31.6 68.4-56.4 109.3-73.8 42.3-17.9 87.4-27 133.8-27 46.5 0 91.5 9.1 133.8 27a341.5 341.5 0 01109.3 73.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.6 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c-.1-6.6-7.8-10.3-13-6.2z"}}]},name:"reload",theme:"outlined"},nfe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M839.6 433.8L749 150.5a9.24 9.24 0 00-8.9-6.5h-77.4c-4.1 0-7.6 2.6-8.9 6.5l-91.3 283.3c-.3.9-.5 1.9-.5 2.9 0 5.1 4.2 9.3 9.3 9.3h56.4c4.2 0 7.8-2.8 9-6.8l17.5-61.6h89l17.3 61.5c1.1 4 4.8 6.8 9 6.8h61.2c1 0 1.9-.1 2.8-.4 2.4-.8 4.3-2.4 5.5-4.6 1.1-2.2 1.3-4.7.6-7.1zM663.3 325.5l32.8-116.9h6.3l32.1 116.9h-71.2zm143.5 492.9H677.2v-.4l132.6-188.9c1.1-1.6 1.7-3.4 1.7-5.4v-36.4c0-5.1-4.2-9.3-9.3-9.3h-204c-5.1 0-9.3 4.2-9.3 9.3v43c0 5.1 4.2 9.3 9.3 9.3h122.6v.4L587.7 828.9a9.35 9.35 0 00-1.7 5.4v36.4c0 5.1 4.2 9.3 9.3 9.3h211.4c5.1 0 9.3-4.2 9.3-9.3v-43a9.2 9.2 0 00-9.2-9.3zM416 702h-76V172c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v530h-76c-6.7 0-10.5 7.8-6.3 13l112 141.9a8 8 0 0012.6 0l112-141.9c4.1-5.2.4-13-6.3-13z"}}]},name:"sort-ascending",theme:"outlined"},ife={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M876.6 239.5c-.5-.9-1.2-1.8-2-2.5-5-5-13.1-5-18.1 0L684.2 409.3l-67.9-67.9L788.7 169c.8-.8 1.4-1.6 2-2.5 3.6-6.1 1.6-13.9-4.5-17.5-98.2-58-226.8-44.7-311.3 39.7-67 67-89.2 162-66.5 247.4l-293 293c-3 3-2.8 7.9.3 11l169.7 169.7c3.1 3.1 8.1 3.3 11 .3l292.9-292.9c85.5 22.8 180.5.7 247.6-66.4 84.4-84.5 97.7-213.1 39.7-311.3zM786 499.8c-58.1 58.1-145.3 69.3-214.6 33.6l-8.8 8.8-.1-.1-274 274.1-79.2-79.2 230.1-230.1s0 .1.1.1l52.8-52.8c-35.7-69.3-24.5-156.5 33.6-214.6a184.2 184.2 0 01144-53.5L537 318.9a32.05 32.05 0 000 45.3l124.5 124.5a32.05 32.05 0 0045.3 0l132.8-132.8c3.7 51.8-14.4 104.8-53.6 143.9z"}}]},name:"tool",theme:"outlined"};const afe=(n,e,t,i)=>{const{titleMarginBottom:a,fontWeightStrong:o}=i;return{marginBottom:a,color:t,fontWeight:o,fontSize:n,lineHeight:e}},ofe=n=>{const e=[1,2,3,4,5],t={};return e.forEach(i=>{t[`
      h${i}&,
      div&-h${i},
      div&-h${i} > textarea,
      h${i}
    `]=afe(n[`fontSizeHeading${i}`],n[`lineHeightHeading${i}`],n.colorTextHeading,n)}),t},rfe=n=>{const{componentCls:e}=n;return{"a&, a":Object.assign(Object.assign({},HY(n)),{userSelect:"text",[`&[disabled], &${e}-disabled`]:{color:n.colorTextDisabled,cursor:"not-allowed","&:active, &:hover":{color:n.colorTextDisabled},"&:active":{pointerEvents:"none"}}})}},sfe=n=>({code:{margin:"0 0.2em",paddingInline:"0.4em",paddingBlock:"0.2em 0.1em",fontSize:"85%",fontFamily:n.fontFamilyCode,background:"rgba(150, 150, 150, 0.1)",border:"1px solid rgba(100, 100, 100, 0.2)",borderRadius:3},kbd:{margin:"0 0.2em",paddingInline:"0.4em",paddingBlock:"0.15em 0.1em",fontSize:"90%",fontFamily:n.fontFamilyCode,background:"rgba(150, 150, 150, 0.06)",border:"1px solid rgba(100, 100, 100, 0.2)",borderBottomWidth:2,borderRadius:3},mark:{padding:0,backgroundColor:LB[2]},"u, ins":{textDecoration:"underline",textDecorationSkipInk:"auto"},"s, del":{textDecoration:"line-through"},strong:{fontWeight:600},"ul, ol":{marginInline:0,marginBlock:"0 1em",padding:0,li:{marginInline:"20px 0",marginBlock:0,paddingInline:"4px 0",paddingBlock:0}},ul:{listStyleType:"circle",ul:{listStyleType:"disc"}},ol:{listStyleType:"decimal"},"pre, blockquote":{margin:"1em 0"},pre:{padding:"0.4em 0.6em",whiteSpace:"pre-wrap",wordWrap:"break-word",background:"rgba(150, 150, 150, 0.1)",border:"1px solid rgba(100, 100, 100, 0.2)",borderRadius:3,fontFamily:n.fontFamilyCode,code:{display:"inline",margin:0,padding:0,fontSize:"inherit",fontFamily:"inherit",background:"transparent",border:0}},blockquote:{paddingInline:"0.6em 0",paddingBlock:0,borderInlineStart:"4px solid rgba(100, 100, 100, 0.2)",opacity:.85}}),lfe=n=>{const{componentCls:e,paddingSM:t}=n,i=t;return{"&-edit-content":{position:"relative","div&":{insetInlineStart:n.calc(n.paddingSM).mul(-1).equal(),marginTop:n.calc(i).mul(-1).equal(),marginBottom:`calc(1em - ${st(i)})`},[`${e}-edit-content-confirm`]:{position:"absolute",insetInlineEnd:n.calc(n.marginXS).add(2).equal(),insetBlockEnd:n.marginXS,color:n.colorTextDescription,fontWeight:"normal",fontSize:n.fontSize,fontStyle:"normal",pointerEvents:"none"},textarea:{margin:"0!important",MozTransition:"none",height:"1em"}}}},cfe=n=>({[`${n.componentCls}-copy-success`]:{"\n    &,\n    &:hover,\n    &:focus":{color:n.colorSuccess}},[`${n.componentCls}-copy-icon-only`]:{marginInlineStart:0}}),gfe=()=>({"\n  a&-ellipsis,\n  span&-ellipsis\n  ":{display:"inline-block",maxWidth:"100%"},"&-ellipsis-single-line":{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis","a&, span&":{verticalAlign:"bottom"},"> code":{paddingBlock:0,maxWidth:"calc(100% - 1.2em)",display:"inline-block",overflow:"hidden",textOverflow:"ellipsis",verticalAlign:"bottom",boxSizing:"content-box"}},"&-ellipsis-multiple-line":{display:"-webkit-box",overflow:"hidden",WebkitLineClamp:3,WebkitBoxOrient:"vertical"}}),ufe=n=>{const{componentCls:e,titleMarginTop:t}=n;return{[e]:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({color:n.colorText,wordBreak:"break-word",lineHeight:n.lineHeight,[`&${e}-secondary`]:{color:n.colorTextDescription},[`&${e}-success`]:{color:n.colorSuccessText},[`&${e}-warning`]:{color:n.colorWarningText},[`&${e}-danger`]:{color:n.colorErrorText,"a&:active, a&:focus":{color:n.colorErrorTextActive},"a&:hover":{color:n.colorErrorTextHover}},[`&${e}-disabled`]:{color:n.colorTextDisabled,cursor:"not-allowed",userSelect:"none"},"\n        div&,\n        p\n      ":{marginBottom:"1em"}},ofe(n)),{[`
      & + h1${e},
      & + h2${e},
      & + h3${e},
      & + h4${e},
      & + h5${e}
      `]:{marginTop:t},"\n      div,\n      ul,\n      li,\n      p,\n      h1,\n      h2,\n      h3,\n      h4,\n      h5":{"\n        + h1,\n        + h2,\n        + h3,\n        + h4,\n        + h5\n        ":{marginTop:t}}}),sfe(n)),rfe(n)),{[`
        ${e}-expand,
        ${e}-collapse,
        ${e}-edit,
        ${e}-copy
      `]:Object.assign(Object.assign({},HY(n)),{marginInlineStart:n.marginXXS})}),lfe(n)),cfe(n)),gfe()),{"&-rtl":{direction:"rtl"}})}},dfe=()=>({titleMarginTop:"1.2em",titleMarginBottom:"0.5em"}),_K=Oa("Typography",n=>[ufe(n)],dfe),Cfe=n=>{const{prefixCls:e,"aria-label":t,className:i,style:a,direction:o,maxLength:r,autoSize:s=!0,value:l,onSave:c,onCancel:u,onEnd:C,component:h,enterIcon:m=v.createElement(qhe,null)}=n,p=v.useRef(null),B=v.useRef(!1),b=v.useRef(null),[y,S]=v.useState(l);v.useEffect(()=>{S(l)},[l]),v.useEffect(()=>{var P;if(!((P=p.current)===null||P===void 0)&&P.resizableTextArea){const{textArea:$}=p.current.resizableTextArea;$.focus();const{length:X}=$.value;$.setSelectionRange(X,X)}},[]);const R=P=>{let{target:$}=P;S($.value.replace(/[\n\r]/g,""))},Z=()=>{B.current=!0},x=()=>{B.current=!1},M=P=>{let{keyCode:$}=P;B.current||(b.current=$)},E=()=>{c(y.trim())},F=P=>{let{keyCode:$,ctrlKey:X,altKey:L,metaKey:U,shiftKey:q}=P;b.current!==$||B.current||X||L||U||q||($===tn.ENTER?(E(),C==null||C()):$===tn.ESC&&u())},N=()=>{E()},[H,z,_]=_K(e),D=gt(e,`${e}-edit-content`,{[`${e}-rtl`]:o==="rtl",[`${e}-${h}`]:!!h},i,z,_);return H(v.createElement("div",{className:D,style:a},v.createElement(EK,{ref:p,maxLength:r,value:y,onChange:R,onKeyDown:M,onKeyUp:F,onCompositionStart:Z,onCompositionEnd:x,onBlur:N,"aria-label":t,rows:1,autoSize:s}),m!==null?Bd(m,{className:`${e}-edit-content-confirm`}):null))};var h1,lF;function Ife(){return lF||(lF=1,h1=function(){var n=document.getSelection();if(!n.rangeCount)return function(){};for(var e=document.activeElement,t=[],i=0;i<n.rangeCount;i++)t.push(n.getRangeAt(i));switch(e.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":e.blur();break;default:e=null;break}return n.removeAllRanges(),function(){n.type==="Caret"&&n.removeAllRanges(),n.rangeCount||t.forEach(function(a){n.addRange(a)}),e&&e.focus()}}),h1}var f1,cF;function hfe(){if(cF)return f1;cF=1;var n=Ife(),e={"text/plain":"Text","text/html":"Url",default:"Text"},t="Copy to clipboard: #{key}, Enter";function i(o){var r=(/mac os x/i.test(navigator.userAgent)?"":"Ctrl")+"+C";return o.replace(/#{\s*key\s*}/g,r)}function a(o,r){var s,l,c,u,C,h,m=!1;r||(r={}),s=r.debug||!1;try{c=n(),u=document.createRange(),C=document.getSelection(),h=document.createElement("span"),h.textContent=o,h.ariaHidden="true",h.style.all="unset",h.style.position="fixed",h.style.top=0,h.style.clip="rect(0, 0, 0, 0)",h.style.whiteSpace="pre",h.style.webkitUserSelect="text",h.style.MozUserSelect="text",h.style.msUserSelect="text",h.style.userSelect="text",h.addEventListener("copy",function(B){if(B.stopPropagation(),r.format)if(B.preventDefault(),typeof B.clipboardData>"u"){s&&console.warn("unable to use e.clipboardData"),s&&console.warn("trying IE specific stuff"),window.clipboardData.clearData();var b=e[r.format]||e.default;window.clipboardData.setData(b,o)}else B.clipboardData.clearData(),B.clipboardData.setData(r.format,o);r.onCopy&&(B.preventDefault(),r.onCopy(B.clipboardData))}),document.body.appendChild(h),u.selectNodeContents(h),C.addRange(u);var p=document.execCommand("copy");if(!p)throw new Error("copy command was unsuccessful");m=!0}catch(B){s&&console.error("unable to copy using execCommand: ",B),s&&console.warn("trying IE specific stuff");try{window.clipboardData.setData(r.format||"text",o),r.onCopy&&r.onCopy(window.clipboardData),m=!0}catch(b){s&&console.error("unable to copy using clipboardData: ",b),s&&console.error("falling back to prompt"),l=i("message"in r?r.message:t),window.prompt(l,o)}}finally{C&&(typeof C.removeRange=="function"?C.removeRange(u):C.removeAllRanges()),h&&document.body.removeChild(h),c()}return m}return f1=a,f1}var ffe=hfe();const Afe=mI(ffe);var mfe=function(n,e,t,i){function a(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function s(u){try{c(i.next(u))}catch(C){r(C)}}function l(u){try{c(i.throw(u))}catch(C){r(C)}}function c(u){u.done?o(u.value):a(u.value).then(s,l)}c((i=i.apply(n,e||[])).next())})};const pfe=n=>{let{copyConfig:e,children:t}=n;const[i,a]=v.useState(!1),[o,r]=v.useState(!1),s=v.useRef(null),l=()=>{s.current&&clearTimeout(s.current)},c={};e.format&&(c.format=e.format),v.useEffect(()=>l,[]);const u=Aa(C=>mfe(void 0,void 0,void 0,function*(){var h;C==null||C.preventDefault(),C==null||C.stopPropagation(),r(!0);try{const m=typeof e.text=="function"?yield e.text():e.text;Afe(m||_he(t,!0).join("")||"",c),r(!1),a(!0),l(),s.current=setTimeout(()=>{a(!1)},3e3),(h=e.onCopy)===null||h===void 0||h.call(e,C)}catch(m){throw r(!1),m}}));return{copied:i,copyLoading:o,onClick:u}};function A1(n,e){return v.useMemo(()=>{const t=!!n;return[t,Object.assign(Object.assign({},e),t&&typeof n=="object"?n:null)]},[n])}const bfe=n=>{const e=v.useRef(void 0);return v.useEffect(()=>{e.current=n}),e.current},vfe=(n,e,t)=>v.useMemo(()=>n===!0?{title:e??t}:v.isValidElement(n)?{title:n}:typeof n=="object"?Object.assign({title:e??t},n):{title:n},[n,e,t]);var yfe=function(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(n);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(n,i[a])&&(t[i[a]]=n[i[a]]);return t};const DK=v.forwardRef((n,e)=>{const{prefixCls:t,component:i="article",className:a,rootClassName:o,setContentRef:r,children:s,direction:l,style:c}=n,u=yfe(n,["prefixCls","component","className","rootClassName","setContentRef","children","direction","style"]),{getPrefixCls:C,direction:h,className:m,style:p}=Gs("typography"),B=l??h,b=r?Bs(e,r):e,y=C("typography",t),[S,R,Z]=_K(y),x=gt(y,m,{[`${y}-rtl`]:B==="rtl"},a,o,R,Z),M=Object.assign(Object.assign({},p),c);return S(v.createElement(i,Object.assign({className:x,style:M,ref:b},u),s))});function gF(n){return n===!1?[!1,!1]:Array.isArray(n)?n:[n]}function m1(n,e,t){return n===!0||n===void 0?e:n||t&&e}function Bfe(n){const e=document.createElement("em");n.appendChild(e);const t=n.getBoundingClientRect(),i=e.getBoundingClientRect();return n.removeChild(e),t.left>i.left||i.right>t.right||t.top>i.top||i.bottom>t.bottom}const OM=n=>["string","number"].includes(typeof n),Gfe=n=>{let{prefixCls:e,copied:t,locale:i,iconOnly:a,tooltips:o,icon:r,tabIndex:s,onCopy:l,loading:c}=n;const u=gF(o),C=gF(r),{copied:h,copy:m}=i??{},p=t?h:m,B=m1(u[t?1:0],p),b=typeof B=="string"?B:p;return v.createElement(AI,{title:B},v.createElement("button",{type:"button",className:gt(`${e}-copy`,{[`${e}-copy-success`]:t,[`${e}-copy-icon-only`]:a}),onClick:l,"aria-label":b,tabIndex:s},t?m1(C[1],v.createElement(Lz,null),!0):m1(C[0],c?v.createElement(AM,null):v.createElement(Uhe,null),!0)))},ly=v.forwardRef((n,e)=>{let{style:t,children:i}=n;const a=v.useRef(null);return v.useImperativeHandle(e,()=>({isExceed:()=>{const o=a.current;return o.scrollHeight>o.clientHeight},getHeight:()=>a.current.clientHeight})),v.createElement("span",{"aria-hidden":!0,ref:a,style:Object.assign({position:"fixed",display:"block",left:0,top:0,pointerEvents:"none",backgroundColor:"rgba(255, 0, 0, 0.65)"},t)},i)}),Sfe=n=>n.reduce((e,t)=>e+(OM(t)?String(t).length:1),0);function uF(n,e){let t=0;const i=[];for(let a=0;a<n.length;a+=1){if(t===e)return i;const o=n[a],s=OM(o)?String(o).length:1,l=t+s;if(l>e){const c=e-t;return i.push(String(o).slice(0,c)),i}i.push(o),t=l}return n}const p1=0,b1=1,v1=2,y1=3,dF=4,cy={display:"-webkit-box",overflow:"hidden",WebkitBoxOrient:"vertical"};function wfe(n){const{enableMeasure:e,width:t,text:i,children:a,rows:o,expanded:r,miscDeps:s,onEllipsis:l}=n,c=v.useMemo(()=>Ic(i),[i]),u=v.useMemo(()=>Sfe(c),[i]),C=v.useMemo(()=>a(c,!1),[i]),[h,m]=v.useState(null),p=v.useRef(null),B=v.useRef(null),b=v.useRef(null),y=v.useRef(null),S=v.useRef(null),[R,Z]=v.useState(!1),[x,M]=v.useState(p1),[E,F]=v.useState(0),[N,H]=v.useState(null);xi(()=>{M(e&&t&&u?b1:p1)},[t,i,o,e,c]),xi(()=>{var P,$,X,L;if(x===b1){M(v1);const U=B.current&&getComputedStyle(B.current).whiteSpace;H(U)}else if(x===v1){const U=!!(!((P=b.current)===null||P===void 0)&&P.isExceed());M(U?y1:dF),m(U?[0,u]:null),Z(U);const q=(($=b.current)===null||$===void 0?void 0:$.getHeight())||0,K=o===1?0:((X=y.current)===null||X===void 0?void 0:X.getHeight())||0,O=((L=S.current)===null||L===void 0?void 0:L.getHeight())||0,j=Math.max(q,K+O);F(j+1),l(U)}},[x]);const z=h?Math.ceil((h[0]+h[1])/2):0;xi(()=>{var P;const[$,X]=h||[0,0];if($!==X){const U=(((P=p.current)===null||P===void 0?void 0:P.getHeight())||0)>E;let q=z;X-$===1&&(q=U?$:X),m(U?[$,q]:[q,X])}},[h,z]);const _=v.useMemo(()=>{if(!e)return a(c,!1);if(x!==y1||!h||h[0]!==h[1]){const P=a(c,!1);return[dF,p1].includes(x)?P:v.createElement("span",{style:Object.assign(Object.assign({},cy),{WebkitLineClamp:o})},P)}return a(r?c:uF(c,h[0]),R)},[r,x,h,c].concat(an(s))),D={width:t,margin:0,padding:0,whiteSpace:N==="nowrap"?"normal":"inherit"};return v.createElement(v.Fragment,null,_,x===v1&&v.createElement(v.Fragment,null,v.createElement(ly,{style:Object.assign(Object.assign(Object.assign({},D),cy),{WebkitLineClamp:o}),ref:b},C),v.createElement(ly,{style:Object.assign(Object.assign(Object.assign({},D),cy),{WebkitLineClamp:o-1}),ref:y},C),v.createElement(ly,{style:Object.assign(Object.assign(Object.assign({},D),cy),{WebkitLineClamp:1}),ref:S},a([],!0))),x===y1&&h&&h[0]!==h[1]&&v.createElement(ly,{style:Object.assign(Object.assign({},D),{top:400}),ref:p},a(uF(c,z),!0)),x===b1&&v.createElement("span",{style:{whiteSpace:"inherit"},ref:B}))}const Rfe=n=>{let{enableEllipsis:e,isEllipsis:t,children:i,tooltipProps:a}=n;return!(a!=null&&a.title)||!e?i:v.createElement(AI,Object.assign({open:t?void 0:!1},a),i)};var Zfe=function(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(n);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(n,i[a])&&(t[i[a]]=n[i[a]]);return t};function xfe(n,e){let{mark:t,code:i,underline:a,delete:o,strong:r,keyboard:s,italic:l}=n,c=e;function u(C,h){h&&(c=v.createElement(C,{},c))}return u("strong",r),u("u",a),u("del",o),u("code",i),u("mark",t),u("kbd",s),u("i",l),c}const Mfe="...",yS=v.forwardRef((n,e)=>{var t;const{prefixCls:i,className:a,style:o,type:r,disabled:s,children:l,ellipsis:c,editable:u,copyable:C,component:h,title:m}=n,p=Zfe(n,["prefixCls","className","style","type","disabled","children","ellipsis","editable","copyable","component","title"]),{getPrefixCls:B,direction:b}=v.useContext(ui),[y]=bb("Text"),S=v.useRef(null),R=v.useRef(null),Z=B("typography",i),x=Ss(p,["mark","code","delete","underline","strong","keyboard","italic"]),[M,E]=A1(u),[F,N]=_a(!1,{value:E.editing}),{triggerType:H=["icon"]}=E,z=Ce=>{var He;Ce&&((He=E.onStart)===null||He===void 0||He.call(E)),N(Ce)},_=bfe(F);xi(()=>{var Ce;!F&&_&&((Ce=R.current)===null||Ce===void 0||Ce.focus())},[F]);const D=Ce=>{Ce==null||Ce.preventDefault(),z(!0)},P=Ce=>{var He;(He=E.onChange)===null||He===void 0||He.call(E,Ce),z(!1)},$=()=>{var Ce;(Ce=E.onCancel)===null||Ce===void 0||Ce.call(E),z(!1)},[X,L]=A1(C),{copied:U,copyLoading:q,onClick:K}=pfe({copyConfig:L,children:l}),[O,j]=v.useState(!1),[ne,k]=v.useState(!1),[ie,re]=v.useState(!1),[ge,de]=v.useState(!1),[xe,Ne]=v.useState(!0),[ye,pe]=A1(c,{expandable:!1,symbol:Ce=>Ce?y==null?void 0:y.collapse:y==null?void 0:y.expand}),[Te,le]=_a(pe.defaultExpanded||!1,{value:pe.expanded}),Ye=ye&&(!Te||pe.expandable==="collapsible"),{rows:he=1}=pe,Ge=v.useMemo(()=>Ye&&(pe.suffix!==void 0||pe.onEllipsis||pe.expandable||M||X),[Ye,pe,M,X]);xi(()=>{ye&&!Ge&&(j(QH("webkitLineClamp")),k(QH("textOverflow")))},[Ge,ye]);const[be,Ee]=v.useState(Ye),Se=v.useMemo(()=>Ge?!1:he===1?ne:O,[Ge,ne,O]);xi(()=>{Ee(Se&&Ye)},[Se,Ye]);const ee=Ye&&(be?ge:ie),Q=Ye&&he===1&&be,ce=Ye&&he>1&&be,me=(Ce,He)=>{var ht;le(He.expanded),(ht=pe.onExpand)===null||ht===void 0||ht.call(pe,Ce,He)},[Ze,Xe]=v.useState(0),De=Ce=>{let{offsetWidth:He}=Ce;Xe(He)},Oe=Ce=>{var He;re(Ce),ie!==Ce&&((He=pe.onEllipsis)===null||He===void 0||He.call(pe,Ce))};v.useEffect(()=>{const Ce=S.current;if(ye&&be&&Ce){const He=Bfe(Ce);ge!==He&&de(He)}},[ye,be,l,ce,xe,Ze]),v.useEffect(()=>{const Ce=S.current;if(typeof IntersectionObserver>"u"||!Ce||!be||!Ye)return;const He=new IntersectionObserver(()=>{Ne(!!Ce.offsetParent)});return He.observe(Ce),()=>{He.disconnect()}},[be,Ye]);const Je=vfe(pe.tooltip,E.text,l),At=v.useMemo(()=>{if(!(!ye||be))return[E.text,l,m,Je.title].find(OM)},[ye,be,m,Je.title,ee]);if(F)return v.createElement(Cfe,{value:(t=E.text)!==null&&t!==void 0?t:typeof l=="string"?l:"",onSave:P,onCancel:$,onEnd:E.onEnd,prefixCls:Z,className:a,style:o,direction:b,component:h,maxLength:E.maxLength,autoSize:E.autoSize,enterIcon:E.enterIcon});const qe=()=>{const{expandable:Ce,symbol:He}=pe;return Ce?v.createElement("button",{type:"button",key:"expand",className:`${Z}-${Te?"collapse":"expand"}`,onClick:ht=>me(ht,{expanded:!Te}),"aria-label":Te?y.collapse:y==null?void 0:y.expand},typeof He=="function"?He(Te):He):null},lt=()=>{if(!M)return;const{icon:Ce,tooltip:He,tabIndex:ht}=E,we=Ic(He)[0]||(y==null?void 0:y.edit),ze=typeof we=="string"?we:"";return H.includes("icon")?v.createElement(AI,{key:"edit",title:He===!1?"":we},v.createElement("button",{type:"button",ref:R,className:`${Z}-edit`,onClick:D,"aria-label":ze,tabIndex:ht},Ce||v.createElement(Jhe,{role:"button"}))):null},$e=()=>X?v.createElement(Gfe,Object.assign({key:"copy"},L,{prefixCls:Z,copied:U,locale:y,onCopy:K,loading:q,iconOnly:l==null})):null,je=Ce=>[Ce&&qe(),lt(),$e()],ke=Ce=>[Ce&&!Te&&v.createElement("span",{"aria-hidden":!0,key:"ellipsis"},Mfe),pe.suffix,je(Ce)];return v.createElement(vl,{onResize:De,disabled:!Ye},Ce=>v.createElement(Rfe,{tooltipProps:Je,enableEllipsis:Ye,isEllipsis:ee},v.createElement(DK,Object.assign({className:gt({[`${Z}-${r}`]:r,[`${Z}-disabled`]:s,[`${Z}-ellipsis`]:ye,[`${Z}-ellipsis-single-line`]:Q,[`${Z}-ellipsis-multiple-line`]:ce},a),prefixCls:i,style:Object.assign(Object.assign({},o),{WebkitLineClamp:ce?he:void 0}),component:h,ref:Bs(Ce,S,e),direction:b,onClick:H.includes("text")?D:void 0,"aria-label":At==null?void 0:At.toString(),title:m},x),v.createElement(wfe,{enableMeasure:Ye&&!be,text:l,rows:he,width:Ze,onEllipsis:Oe,expanded:Te,miscDeps:[U,Te,q,M,X,y]},(He,ht)=>xfe(n,v.createElement(v.Fragment,null,He.length>0&&ht&&!Te&&At?v.createElement("span",{key:"show-content","aria-hidden":!0},He):He,ke(ht)))))))});var Wfe=function(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(n);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(n,i[a])&&(t[i[a]]=n[i[a]]);return t};const Vfe=v.forwardRef((n,e)=>{var{ellipsis:t,rel:i}=n,a=Wfe(n,["ellipsis","rel"]);const o=Object.assign(Object.assign({},a),{rel:i===void 0&&a.target==="_blank"?"noopener noreferrer":i});return delete o.navigate,v.createElement(yS,Object.assign({},o,{ref:e,ellipsis:!!t,component:"a"}))}),Nfe=v.forwardRef((n,e)=>v.createElement(yS,Object.assign({ref:e},n,{component:"div"})));var Efe=function(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(n);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(n,i[a])&&(t[i[a]]=n[i[a]]);return t};const Hfe=(n,e)=>{var{ellipsis:t}=n,i=Efe(n,["ellipsis"]);const a=v.useMemo(()=>t&&typeof t=="object"?Ss(t,["expandable","rows"]):t,[t]);return v.createElement(yS,Object.assign({ref:e},i,{ellipsis:a,component:"span"}))},Ffe=v.forwardRef(Hfe);var Xfe=function(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(n);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(n,i[a])&&(t[i[a]]=n[i[a]]);return t};const Tfe=[1,2,3,4,5],Yfe=v.forwardRef((n,e)=>{const{level:t=1}=n,i=Xfe(n,["level"]),a=Tfe.includes(t)?`h${t}`:"h1";return v.createElement(yS,Object.assign({ref:e},i,{component:a}))}),Wb=DK;Wb.Text=Ffe;Wb.Link=Vfe;Wb.Title=Yfe;Wb.Paragraph=Nfe;const OK=v.createContext({}),zfe={aliceblue:"9ehhb",antiquewhite:"9sgk7",aqua:"1ekf",aquamarine:"4zsno",azure:"9eiv3",beige:"9lhp8",bisque:"9zg04",black:"0",blanchedalmond:"9zhe5",blue:"73",blueviolet:"5e31e",brown:"6g016",burlywood:"8ouiv",cadetblue:"3qba8",chartreuse:"4zshs",chocolate:"87k0u",coral:"9yvyo",cornflowerblue:"3xael",cornsilk:"9zjz0",crimson:"8l4xo",cyan:"1ekf",darkblue:"3v",darkcyan:"rkb",darkgoldenrod:"776yz",darkgray:"6mbhl",darkgreen:"jr4",darkgrey:"6mbhl",darkkhaki:"7ehkb",darkmagenta:"5f91n",darkolivegreen:"3bzfz",darkorange:"9yygw",darkorchid:"5z6x8",darkred:"5f8xs",darksalmon:"9441m",darkseagreen:"5lwgf",darkslateblue:"2th1n",darkslategray:"1ugcv",darkslategrey:"1ugcv",darkturquoise:"14up",darkviolet:"5rw7n",deeppink:"9yavn",deepskyblue:"11xb",dimgray:"442g9",dimgrey:"442g9",dodgerblue:"16xof",firebrick:"6y7tu",floralwhite:"9zkds",forestgreen:"1cisi",fuchsia:"9y70f",gainsboro:"8m8kc",ghostwhite:"9pq0v",goldenrod:"8j4f4",gold:"9zda8",gray:"50i2o",green:"pa8",greenyellow:"6senj",grey:"50i2o",honeydew:"9eiuo",hotpink:"9yrp0",indianred:"80gnw",indigo:"2xcoy",ivory:"9zldc",khaki:"9edu4",lavenderblush:"9ziet",lavender:"90c8q",lawngreen:"4vk74",lemonchiffon:"9zkct",lightblue:"6s73a",lightcoral:"9dtog",lightcyan:"8s1rz",lightgoldenrodyellow:"9sjiq",lightgray:"89jo3",lightgreen:"5nkwg",lightgrey:"89jo3",lightpink:"9z6wx",lightsalmon:"9z2ii",lightseagreen:"19xgq",lightskyblue:"5arju",lightslategray:"4nwk9",lightslategrey:"4nwk9",lightsteelblue:"6wau6",lightyellow:"9zlcw",lime:"1edc",limegreen:"1zcxe",linen:"9shk6",magenta:"9y70f",maroon:"4zsow",mediumaquamarine:"40eju",mediumblue:"5p",mediumorchid:"79qkz",mediumpurple:"5r3rv",mediumseagreen:"2d9ip",mediumslateblue:"4tcku",mediumspringgreen:"1di2",mediumturquoise:"2uabw",mediumvioletred:"7rn9h",midnightblue:"z980",mintcream:"9ljp6",mistyrose:"9zg0x",moccasin:"9zfzp",navajowhite:"9zest",navy:"3k",oldlace:"9wq92",olive:"50hz4",olivedrab:"472ub",orange:"9z3eo",orangered:"9ykg0",orchid:"8iu3a",palegoldenrod:"9bl4a",palegreen:"5yw0o",paleturquoise:"6v4ku",palevioletred:"8k8lv",papayawhip:"9zi6t",peachpuff:"9ze0p",peru:"80oqn",pink:"9z8wb",plum:"8nba5",powderblue:"6wgdi",purple:"4zssg",rebeccapurple:"3zk49",red:"9y6tc",rosybrown:"7cv4f",royalblue:"2jvtt",saddlebrown:"5fmkz",salmon:"9rvci",sandybrown:"9jn1c",seagreen:"1tdnb",seashell:"9zje6",sienna:"6973h",silver:"7ir40",skyblue:"5arjf",slateblue:"45e4t",slategray:"4e100",slategrey:"4e100",snow:"9zke2",springgreen:"1egv",steelblue:"2r1kk",tan:"87yx8",teal:"pds",thistle:"8ggk8",tomato:"9yqfb",turquoise:"2j4r4",violet:"9b10u",wheat:"9ld4j",white:"9zldr",whitesmoke:"9lhpx",yellow:"9zl6o",yellowgreen:"61fzm"},Zo=Math.round;function B1(n,e){const t=n.replace(/^[^(]*\((.*)/,"$1").replace(/\).*/,"").match(/\d*\.?\d+%?/g)||[],i=t.map(a=>parseFloat(a));for(let a=0;a<3;a+=1)i[a]=e(i[a]||0,t[a]||"",a);return t[3]?i[3]=t[3].includes("%")?i[3]/100:i[3]:i[3]=1,i}const CF=(n,e,t)=>t===0?n:n/100;function _m(n,e){const t=e||255;return n>t?t:n<0?0:n}class lf{constructor(e){Tr(this,"isValid",!0);Tr(this,"r",0);Tr(this,"g",0);Tr(this,"b",0);Tr(this,"a",1);Tr(this,"_h");Tr(this,"_s");Tr(this,"_l");Tr(this,"_v");Tr(this,"_max");Tr(this,"_min");Tr(this,"_brightness");function t(a){return a[0]in e&&a[1]in e&&a[2]in e}if(e)if(typeof e=="string"){let o=function(r){return a.startsWith(r)};var i=o;const a=e.trim();if(/^#?[A-F\d]{3,8}$/i.test(a))this.fromHexString(a);else if(o("rgb"))this.fromRgbString(a);else if(o("hsl"))this.fromHslString(a);else if(o("hsv")||o("hsb"))this.fromHsvString(a);else{const r=zfe[a.toLowerCase()];r&&this.fromHexString(parseInt(r,36).toString(16).padStart(6,"0"))}}else if(e instanceof lf)this.r=e.r,this.g=e.g,this.b=e.b,this.a=e.a,this._h=e._h,this._s=e._s,this._l=e._l,this._v=e._v;else if(t("rgb"))this.r=_m(e.r),this.g=_m(e.g),this.b=_m(e.b),this.a=typeof e.a=="number"?_m(e.a,1):1;else if(t("hsl"))this.fromHsl(e);else if(t("hsv"))this.fromHsv(e);else throw new Error("@ant-design/fast-color: unsupported input "+JSON.stringify(e))}setR(e){return this._sc("r",e)}setG(e){return this._sc("g",e)}setB(e){return this._sc("b",e)}setA(e){return this._sc("a",e,1)}setHue(e){const t=this.toHsv();return t.h=e,this._c(t)}getLuminance(){function e(o){const r=o/255;return r<=.03928?r/12.92:Math.pow((r+.055)/1.055,2.4)}const t=e(this.r),i=e(this.g),a=e(this.b);return .2126*t+.7152*i+.0722*a}getHue(){if(typeof this._h>"u"){const e=this.getMax()-this.getMin();e===0?this._h=0:this._h=Zo(60*(this.r===this.getMax()?(this.g-this.b)/e+(this.g<this.b?6:0):this.g===this.getMax()?(this.b-this.r)/e+2:(this.r-this.g)/e+4))}return this._h}getSaturation(){if(typeof this._s>"u"){const e=this.getMax()-this.getMin();e===0?this._s=0:this._s=e/this.getMax()}return this._s}getLightness(){return typeof this._l>"u"&&(this._l=(this.getMax()+this.getMin())/510),this._l}getValue(){return typeof this._v>"u"&&(this._v=this.getMax()/255),this._v}getBrightness(){return typeof this._brightness>"u"&&(this._brightness=(this.r*299+this.g*587+this.b*114)/1e3),this._brightness}darken(e=10){const t=this.getHue(),i=this.getSaturation();let a=this.getLightness()-e/100;return a<0&&(a=0),this._c({h:t,s:i,l:a,a:this.a})}lighten(e=10){const t=this.getHue(),i=this.getSaturation();let a=this.getLightness()+e/100;return a>1&&(a=1),this._c({h:t,s:i,l:a,a:this.a})}mix(e,t=50){const i=this._c(e),a=t/100,o=s=>(i[s]-this[s])*a+this[s],r={r:Zo(o("r")),g:Zo(o("g")),b:Zo(o("b")),a:Zo(o("a")*100)/100};return this._c(r)}tint(e=10){return this.mix({r:255,g:255,b:255,a:1},e)}shade(e=10){return this.mix({r:0,g:0,b:0,a:1},e)}onBackground(e){const t=this._c(e),i=this.a+t.a*(1-this.a),a=o=>Zo((this[o]*this.a+t[o]*t.a*(1-this.a))/i);return this._c({r:a("r"),g:a("g"),b:a("b"),a:i})}isDark(){return this.getBrightness()<128}isLight(){return this.getBrightness()>=128}equals(e){return this.r===e.r&&this.g===e.g&&this.b===e.b&&this.a===e.a}clone(){return this._c(this)}toHexString(){let e="#";const t=(this.r||0).toString(16);e+=t.length===2?t:"0"+t;const i=(this.g||0).toString(16);e+=i.length===2?i:"0"+i;const a=(this.b||0).toString(16);if(e+=a.length===2?a:"0"+a,typeof this.a=="number"&&this.a>=0&&this.a<1){const o=Zo(this.a*255).toString(16);e+=o.length===2?o:"0"+o}return e}toHsl(){return{h:this.getHue(),s:this.getSaturation(),l:this.getLightness(),a:this.a}}toHslString(){const e=this.getHue(),t=Zo(this.getSaturation()*100),i=Zo(this.getLightness()*100);return this.a!==1?`hsla(${e},${t}%,${i}%,${this.a})`:`hsl(${e},${t}%,${i}%)`}toHsv(){return{h:this.getHue(),s:this.getSaturation(),v:this.getValue(),a:this.a}}toRgb(){return{r:this.r,g:this.g,b:this.b,a:this.a}}toRgbString(){return this.a!==1?`rgba(${this.r},${this.g},${this.b},${this.a})`:`rgb(${this.r},${this.g},${this.b})`}toString(){return this.toRgbString()}_sc(e,t,i){const a=this.clone();return a[e]=_m(t,i),a}_c(e){return new this.constructor(e)}getMax(){return typeof this._max>"u"&&(this._max=Math.max(this.r,this.g,this.b)),this._max}getMin(){return typeof this._min>"u"&&(this._min=Math.min(this.r,this.g,this.b)),this._min}fromHexString(e){const t=e.replace("#","");function i(a,o){return parseInt(t[a]+t[o||a],16)}t.length<6?(this.r=i(0),this.g=i(1),this.b=i(2),this.a=t[3]?i(3)/255:1):(this.r=i(0,1),this.g=i(2,3),this.b=i(4,5),this.a=t[6]?i(6,7)/255:1)}fromHsl({h:e,s:t,l:i,a}){if(this._h=e%360,this._s=t,this._l=i,this.a=typeof a=="number"?a:1,t<=0){const h=Zo(i*255);this.r=h,this.g=h,this.b=h}let o=0,r=0,s=0;const l=e/60,c=(1-Math.abs(2*i-1))*t,u=c*(1-Math.abs(l%2-1));l>=0&&l<1?(o=c,r=u):l>=1&&l<2?(o=u,r=c):l>=2&&l<3?(r=c,s=u):l>=3&&l<4?(r=u,s=c):l>=4&&l<5?(o=u,s=c):l>=5&&l<6&&(o=c,s=u);const C=i-c/2;this.r=Zo((o+C)*255),this.g=Zo((r+C)*255),this.b=Zo((s+C)*255)}fromHsv({h:e,s:t,v:i,a}){this._h=e%360,this._s=t,this._v=i,this.a=typeof a=="number"?a:1;const o=Zo(i*255);if(this.r=o,this.g=o,this.b=o,t<=0)return;const r=e/60,s=Math.floor(r),l=r-s,c=Zo(i*(1-t)*255),u=Zo(i*(1-t*l)*255),C=Zo(i*(1-t*(1-l))*255);switch(s){case 0:this.g=C,this.b=c;break;case 1:this.r=u,this.b=c;break;case 2:this.r=c,this.b=C;break;case 3:this.r=c,this.g=u;break;case 4:this.r=C,this.g=c;break;case 5:default:this.g=c,this.b=u;break}}fromHsvString(e){const t=B1(e,CF);this.fromHsv({h:t[0],s:t[1],v:t[2],a:t[3]})}fromHslString(e){const t=B1(e,CF);this.fromHsl({h:t[0],s:t[1],l:t[2],a:t[3]})}fromRgbString(e){const t=B1(e,(i,a)=>a.includes("%")?Zo(i/100*255):i);this.r=t[0],this.g=t[1],this.b=t[2],this.a=t[3]}}const gy=2,IF=.16,Kfe=.05,Lfe=.05,_fe=.15,UK=5,kK=4,Dfe=[{index:7,amount:15},{index:6,amount:25},{index:5,amount:30},{index:5,amount:45},{index:5,amount:65},{index:5,amount:85},{index:4,amount:90},{index:3,amount:95},{index:2,amount:97},{index:1,amount:98}];function hF(n,e,t){let i;return Math.round(n.h)>=60&&Math.round(n.h)<=240?i=t?Math.round(n.h)-gy*e:Math.round(n.h)+gy*e:i=t?Math.round(n.h)+gy*e:Math.round(n.h)-gy*e,i<0?i+=360:i>=360&&(i-=360),i}function fF(n,e,t){if(n.h===0&&n.s===0)return n.s;let i;return t?i=n.s-IF*e:e===kK?i=n.s+IF:i=n.s+Kfe*e,i>1&&(i=1),t&&e===UK&&i>.1&&(i=.1),i<.06&&(i=.06),Math.round(i*100)/100}function AF(n,e,t){let i;return t?i=n.v+Lfe*e:i=n.v-_fe*e,i=Math.max(0,Math.min(1,i)),Math.round(i*100)/100}function Ofe(n,e={}){const t=[],i=new lf(n),a=i.toHsv();for(let o=UK;o>0;o-=1){const r=new lf({h:hF(a,o,!0),s:fF(a,o,!0),v:AF(a,o,!0)});t.push(r)}t.push(i);for(let o=1;o<=kK;o+=1){const r=new lf({h:hF(a,o),s:fF(a,o),v:AF(a,o)});t.push(r)}return e.theme==="dark"?Dfe.map(({index:o,amount:r})=>new lf(e.backgroundColor||"#141414").mix(t[o],r).toHexString()):t.map(o=>o.toHexString())}const vZ=["#e6f4ff","#bae0ff","#91caff","#69b1ff","#4096ff","#1677ff","#0958d9","#003eb3","#002c8c","#001d66"];vZ.primary=vZ[5];function Ufe(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}function kfe(n,e){if(!n)return!1;if(n.contains)return n.contains(e);let t=e;for(;t;){if(t===n)return!0;t=t.parentNode}return!1}const mF="data-rc-order",pF="data-rc-priority",Pfe="rc-util-key",yZ=new Map;function PK({mark:n}={}){return n?n.startsWith("data-")?n:`data-${n}`:Pfe}function UM(n){return n.attachTo?n.attachTo:document.querySelector("head")||document.body}function Jfe(n){return n==="queue"?"prependQueue":n?"prepend":"append"}function kM(n){return Array.from((yZ.get(n)||n).children).filter(e=>e.tagName==="STYLE")}function JK(n,e={}){if(!Ufe())return null;const{csp:t,prepend:i,priority:a=0}=e,o=Jfe(i),r=o==="prependQueue",s=document.createElement("style");s.setAttribute(mF,o),r&&a&&s.setAttribute(pF,`${a}`),t!=null&&t.nonce&&(s.nonce=t==null?void 0:t.nonce),s.innerHTML=n;const l=UM(e),{firstChild:c}=l;if(i){if(r){const u=(e.styles||kM(l)).filter(C=>{if(!["prepend","prependQueue"].includes(C.getAttribute(mF)))return!1;const h=Number(C.getAttribute(pF)||0);return a>=h});if(u.length)return l.insertBefore(s,u[u.length-1].nextSibling),s}l.insertBefore(s,c)}else l.appendChild(s);return s}function jfe(n,e={}){let{styles:t}=e;return t||(t=kM(UM(e))),t.find(i=>i.getAttribute(PK(e))===n)}function Qfe(n,e){const t=yZ.get(n);if(!t||!kfe(document,t)){const i=JK("",e),{parentNode:a}=i;yZ.set(n,a),n.removeChild(i)}}function qfe(n,e,t={}){var l,c,u;const i=UM(t),a=kM(i),o={...t,styles:a};Qfe(i,o);const r=jfe(e,o);if(r)return(l=o.csp)!=null&&l.nonce&&r.nonce!==((c=o.csp)==null?void 0:c.nonce)&&(r.nonce=(u=o.csp)==null?void 0:u.nonce),r.innerHTML!==n&&(r.innerHTML=n),r;const s=JK(n,o);return s.setAttribute(PK(o),e),s}function jK(n){var e;return(e=n==null?void 0:n.getRootNode)==null?void 0:e.call(n)}function $fe(n){return jK(n)instanceof ShadowRoot}function eAe(n){return $fe(n)?jK(n):null}let BZ={};const tAe=n=>{};function nAe(n,e){}function iAe(n,e){}function aAe(){BZ={}}function QK(n,e,t){!e&&!BZ[t]&&(n(!1,t),BZ[t]=!0)}function BS(n,e){QK(nAe,n,e)}function oAe(n,e){QK(iAe,n,e)}BS.preMessage=tAe;BS.resetWarned=aAe;BS.noteOnce=oAe;function rAe(n){return n.replace(/-(.)/g,(e,t)=>t.toUpperCase())}function sAe(n,e){BS(n,`[@ant-design/icons] ${e}`)}function bF(n){return typeof n=="object"&&typeof n.name=="string"&&typeof n.theme=="string"&&(typeof n.icon=="object"||typeof n.icon=="function")}function vF(n={}){return Object.keys(n).reduce((e,t)=>{const i=n[t];switch(t){case"class":e.className=i,delete e.class;break;default:delete e[t],e[rAe(t)]=i}return e},{})}function GZ(n,e,t){return t?Ct.createElement(n.tag,{key:e,...vF(n.attrs),...t},(n.children||[]).map((i,a)=>GZ(i,`${e}-${n.tag}-${a}`))):Ct.createElement(n.tag,{key:e,...vF(n.attrs)},(n.children||[]).map((i,a)=>GZ(i,`${e}-${n.tag}-${a}`)))}function qK(n){return Ofe(n)[0]}function $K(n){return n?Array.isArray(n)?n:[n]:[]}const lAe=`
.anticon {
  display: inline-flex;
  align-items: center;
  color: inherit;
  font-style: normal;
  line-height: 0;
  text-align: center;
  text-transform: none;
  vertical-align: -0.125em;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

.anticon > * {
  line-height: 1;
}

.anticon svg {
  display: inline-block;
}

.anticon::before {
  display: none;
}

.anticon .anticon-icon {
  display: block;
}

.anticon[tabindex] {
  cursor: pointer;
}

.anticon-spin::before,
.anticon-spin {
  display: inline-block;
  -webkit-animation: loadingCircle 1s infinite linear;
  animation: loadingCircle 1s infinite linear;
}

@-webkit-keyframes loadingCircle {
  100% {
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}

@keyframes loadingCircle {
  100% {
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}
`,cAe=n=>{const{csp:e,prefixCls:t,layer:i}=v.useContext(OK);let a=lAe;t&&(a=a.replace(/anticon/g,t)),i&&(a=`@layer ${i} {
${a}
}`),v.useEffect(()=>{const o=n.current,r=eAe(o);qfe(a,"@ant-design-icons",{prepend:!i,csp:e,attachTo:r})},[])},bp={primaryColor:"#333",secondaryColor:"#E6E6E6",calculated:!1};function gAe({primaryColor:n,secondaryColor:e}){bp.primaryColor=n,bp.secondaryColor=e||qK(n),bp.calculated=!!e}function uAe(){return{...bp}}const oA=n=>{const{icon:e,className:t,onClick:i,style:a,primaryColor:o,secondaryColor:r,...s}=n,l=v.useRef();let c=bp;if(o&&(c={primaryColor:o,secondaryColor:r||qK(o)}),cAe(l),sAe(bF(e),`icon should be icon definiton, but got ${e}`),!bF(e))return null;let u=e;return u&&typeof u.icon=="function"&&(u={...u,icon:u.icon(c.primaryColor,c.secondaryColor)}),GZ(u.icon,`svg-${u.name}`,{className:t,onClick:i,style:a,"data-icon":u.name,width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true",...s,ref:l})};oA.displayName="IconReact";oA.getTwoToneColors=uAe;oA.setTwoToneColors=gAe;function eL(n){const[e,t]=$K(n);return oA.setTwoToneColors({primaryColor:e,secondaryColor:t})}function dAe(){const n=oA.getTwoToneColors();return n.calculated?[n.primaryColor,n.secondaryColor]:n.primaryColor}function SZ(){return SZ=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},SZ.apply(this,arguments)}eL(vZ.primary);const Ps=v.forwardRef((n,e)=>{const{className:t,icon:i,spin:a,rotate:o,tabIndex:r,onClick:s,twoToneColor:l,...c}=n,{prefixCls:u="anticon",rootClassName:C}=v.useContext(OK),h=gt(C,u,{[`${u}-${i.name}`]:!!i.name,[`${u}-spin`]:!!a||i.name==="loading"},t);let m=r;m===void 0&&s&&(m=-1);const p=o?{msTransform:`rotate(${o}deg)`,transform:`rotate(${o}deg)`}:void 0,[B,b]=$K(l);return v.createElement("span",SZ({role:"img","aria-label":i.name},c,{ref:e,tabIndex:m,onClick:s,className:h}),v.createElement(oA,{icon:i,primaryColor:B,secondaryColor:b,style:p}))});Ps.displayName="AntdIcon";Ps.getTwoToneColor=dAe;Ps.setTwoToneColor=eL;function wZ(){return wZ=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},wZ.apply(this,arguments)}const CAe=(n,e)=>v.createElement(Ps,wZ({},n,{ref:e,icon:gK})),IAe=v.forwardRef(CAe);function RZ(){return RZ=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},RZ.apply(this,arguments)}const hAe=(n,e)=>v.createElement(Ps,RZ({},n,{ref:e,icon:$he})),fAe=v.forwardRef(hAe);function ZZ(){return ZZ=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},ZZ.apply(this,arguments)}const AAe=(n,e)=>v.createElement(Ps,ZZ({},n,{ref:e,icon:efe})),mAe=v.forwardRef(AAe);function xZ(){return xZ=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},xZ.apply(this,arguments)}const pAe=(n,e)=>v.createElement(Ps,xZ({},n,{ref:e,icon:pK})),yF=v.forwardRef(pAe);function MZ(){return MZ=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},MZ.apply(this,arguments)}const bAe=(n,e)=>v.createElement(Ps,MZ({},n,{ref:e,icon:tfe})),vAe=v.forwardRef(bAe);function WZ(){return WZ=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},WZ.apply(this,arguments)}const yAe=(n,e)=>v.createElement(Ps,WZ({},n,{ref:e,icon:_z})),BAe=v.forwardRef(yAe);function VZ(){return VZ=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},VZ.apply(this,arguments)}const GAe=(n,e)=>v.createElement(Ps,VZ({},n,{ref:e,icon:nfe})),SAe=v.forwardRef(GAe);function NZ(){return NZ=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},NZ.apply(this,arguments)}const wAe=(n,e)=>v.createElement(Ps,NZ({},n,{ref:e,icon:ife})),RAe=v.forwardRef(wAe);function EZ(){return EZ=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},EZ.apply(this,arguments)}const ZAe=(n,e)=>v.createElement(Ps,EZ({},n,{ref:e,icon:BIe})),xAe=v.forwardRef(ZAe);function HZ(){return HZ=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},HZ.apply(this,arguments)}const MAe=(n,e)=>v.createElement(Ps,HZ({},n,{ref:e,icon:GIe})),WAe=v.forwardRef(MAe),{Option:VAe}=xd,{Title:NAe,Text:EAe}=Wb,HAe=({title:n=" ",items:e=[],loading:t=!1,onItemSelect:i=()=>{},onFilterChange:a=()=>{},onSortChange:o=()=>{},onCategoryChange:r=()=>{}})=>{const[s,l]=v.useState(null),[c,u]=v.useState("newest"),[C,h]=v.useState("all"),[m,p]=v.useState(""),B=[{label:"",value:"all"},{label:" A",value:"category_a"},{label:" B",value:"category_b"},{label:" C",value:"category_c"}],b=[{label:"",value:"newest"},{label:"",value:"oldest"},{label:"",value:"name"}],y=x=>{l(x),i(x)},S=x=>{const M=x.target.value;h(M),r(M)},R=x=>{u(x),o(x)},Z=x=>{p(x),a(x)};return Le.jsxs(LM,{title:Le.jsx(NAe,{level:4,children:n}),extra:Le.jsx(xo,{type:"link",children:""}),style:{width:"100%"},bodyStyle:{padding:"12px"},children:[Le.jsxs(pp,{direction:"vertical",style:{width:"100%",marginBottom:"16px"},children:[Le.jsxs("div",{children:[Le.jsx(EAe,{strong:!0,style:{marginRight:"8px"},children:":"}),Le.jsx(Pp.Group,{value:C,onChange:S,buttonStyle:"solid",optionType:"button",size:"small",children:B.map(x=>Le.jsx(Pp.Button,{value:x.value,children:x.label},x.value))})]}),Le.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[Le.jsx(aA,{placeholder:" ",prefix:Le.jsx(BAe,{}),value:m,onChange:x=>Z(x.target.value),style:{width:"60%"},allowClear:!0}),Le.jsx(xd,{value:c,onChange:R,placeholder:" ",style:{width:"38%"},suffixIcon:Le.jsx(SAe,{}),children:b.map(x=>Le.jsx(VAe,{value:x.value,children:x.label},x.value))})]})]}),Le.jsx(YCe,{style:{margin:"8px 0"}}),Le.jsx(Ky,{itemLayout:"horizontal",dataSource:e,loading:t,locale:{emptyText:" "},renderItem:x=>Le.jsxs(Ky.Item,{onClick:()=>y(x),style:{cursor:"pointer",background:(s==null?void 0:s.id)===x.id?"#f0f5ff":"transparent",padding:"8px 12px",borderRadius:"4px",transition:"background-color 0.2s"},children:[Le.jsx(Ky.Item.Meta,{title:x.title||x.name,description:x.description||`: ${x.category||""}`}),Le.jsx("div",{children:x.date||x.created_at})]},x.id),pagination:{onChange:x=>{console.log(" :",x)},pageSize:5,size:"small",hideOnSinglePage:!0}})]})},FAe=Object.freeze(Object.defineProperty({__proto__:null,default:HAe},Symbol.toStringTag,{value:"Module"}));var PM={exports:{}},ff=typeof Reflect=="object"?Reflect:null,BF=ff&&typeof ff.apply=="function"?ff.apply:function(e,t,i){return Function.prototype.apply.call(e,t,i)},Ly;ff&&typeof ff.ownKeys=="function"?Ly=ff.ownKeys:Object.getOwnPropertySymbols?Ly=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Ly=function(e){return Object.getOwnPropertyNames(e)};function XAe(n){console&&console.warn&&console.warn(n)}var tL=Number.isNaN||function(e){return e!==e};function ea(){ea.init.call(this)}PM.exports=ea;PM.exports.once=KAe;ea.EventEmitter=ea;ea.prototype._events=void 0;ea.prototype._eventsCount=0;ea.prototype._maxListeners=void 0;var GF=10;function GS(n){if(typeof n!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof n)}Object.defineProperty(ea,"defaultMaxListeners",{enumerable:!0,get:function(){return GF},set:function(n){if(typeof n!="number"||n<0||tL(n))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+n+".");GF=n}});ea.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};ea.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||tL(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function nL(n){return n._maxListeners===void 0?ea.defaultMaxListeners:n._maxListeners}ea.prototype.getMaxListeners=function(){return nL(this)};ea.prototype.emit=function(e){for(var t=[],i=1;i<arguments.length;i++)t.push(arguments[i]);var a=e==="error",o=this._events;if(o!==void 0)a=a&&o.error===void 0;else if(!a)return!1;if(a){var r;if(t.length>0&&(r=t[0]),r instanceof Error)throw r;var s=new Error("Unhandled error."+(r?" ("+r.message+")":""));throw s.context=r,s}var l=o[e];if(l===void 0)return!1;if(typeof l=="function")BF(l,this,t);else for(var c=l.length,u=sL(l,c),i=0;i<c;++i)BF(u[i],this,t);return!0};function iL(n,e,t,i){var a,o,r;if(GS(t),o=n._events,o===void 0?(o=n._events=Object.create(null),n._eventsCount=0):(o.newListener!==void 0&&(n.emit("newListener",e,t.listener?t.listener:t),o=n._events),r=o[e]),r===void 0)r=o[e]=t,++n._eventsCount;else if(typeof r=="function"?r=o[e]=i?[t,r]:[r,t]:i?r.unshift(t):r.push(t),a=nL(n),a>0&&r.length>a&&!r.warned){r.warned=!0;var s=new Error("Possible EventEmitter memory leak detected. "+r.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");s.name="MaxListenersExceededWarning",s.emitter=n,s.type=e,s.count=r.length,XAe(s)}return n}ea.prototype.addListener=function(e,t){return iL(this,e,t,!1)};ea.prototype.on=ea.prototype.addListener;ea.prototype.prependListener=function(e,t){return iL(this,e,t,!0)};function TAe(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function aL(n,e,t){var i={fired:!1,wrapFn:void 0,target:n,type:e,listener:t},a=TAe.bind(i);return a.listener=t,i.wrapFn=a,a}ea.prototype.once=function(e,t){return GS(t),this.on(e,aL(this,e,t)),this};ea.prototype.prependOnceListener=function(e,t){return GS(t),this.prependListener(e,aL(this,e,t)),this};ea.prototype.removeListener=function(e,t){var i,a,o,r,s;if(GS(t),a=this._events,a===void 0)return this;if(i=a[e],i===void 0)return this;if(i===t||i.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete a[e],a.removeListener&&this.emit("removeListener",e,i.listener||t));else if(typeof i!="function"){for(o=-1,r=i.length-1;r>=0;r--)if(i[r]===t||i[r].listener===t){s=i[r].listener,o=r;break}if(o<0)return this;o===0?i.shift():YAe(i,o),i.length===1&&(a[e]=i[0]),a.removeListener!==void 0&&this.emit("removeListener",e,s||t)}return this};ea.prototype.off=ea.prototype.removeListener;ea.prototype.removeAllListeners=function(e){var t,i,a;if(i=this._events,i===void 0)return this;if(i.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):i[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete i[e]),this;if(arguments.length===0){var o=Object.keys(i),r;for(a=0;a<o.length;++a)r=o[a],r!=="removeListener"&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=i[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(a=t.length-1;a>=0;a--)this.removeListener(e,t[a]);return this};function oL(n,e,t){var i=n._events;if(i===void 0)return[];var a=i[e];return a===void 0?[]:typeof a=="function"?t?[a.listener||a]:[a]:t?zAe(a):sL(a,a.length)}ea.prototype.listeners=function(e){return oL(this,e,!0)};ea.prototype.rawListeners=function(e){return oL(this,e,!1)};ea.listenerCount=function(n,e){return typeof n.listenerCount=="function"?n.listenerCount(e):rL.call(n,e)};ea.prototype.listenerCount=rL;function rL(n){var e=this._events;if(e!==void 0){var t=e[n];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}ea.prototype.eventNames=function(){return this._eventsCount>0?Ly(this._events):[]};function sL(n,e){for(var t=new Array(e),i=0;i<e;++i)t[i]=n[i];return t}function YAe(n,e){for(;e+1<n.length;e++)n[e]=n[e+1];n.pop()}function zAe(n){for(var e=new Array(n.length),t=0;t<e.length;++t)e[t]=n[t].listener||n[t];return e}function KAe(n,e){return new Promise(function(t,i){function a(r){n.removeListener(e,o),i(r)}function o(){typeof n.removeListener=="function"&&n.removeListener("error",a),t([].slice.call(arguments))}lL(n,e,o,{once:!0}),e!=="error"&&LAe(n,a,{once:!0})})}function LAe(n,e,t){typeof n.on=="function"&&lL(n,"error",e,t)}function lL(n,e,t,i){if(typeof n.on=="function")i.once?n.once(e,t):n.on(e,t);else if(typeof n.addEventListener=="function")n.addEventListener(e,function a(o){i.once&&n.removeEventListener(e,a),t(o)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof n)}var _Ae=PM.exports;function DAe(n,e){var t=atob(n);if(e){for(var i=new Uint8Array(t.length),a=0,o=t.length;a<o;++a)i[a]=t.charCodeAt(a);return String.fromCharCode.apply(null,new Uint16Array(i.buffer))}return t}function OAe(n,e,t){var i=e===void 0?null:e,a=t===void 0?!1:t,o=DAe(n,a),r=o.indexOf(`
`,10)+1,s=o.substring(r)+(i?"//# sourceMappingURL="+i:""),l=new Blob([s],{type:"application/javascript"});return URL.createObjectURL(l)}function UAe(n,e,t){var i;return function(o){return i=i||OAe(n,e,t),new Worker(i,o)}}var kAe=UAe("Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwooZnVuY3Rpb24gKCkgewogICd1c2Ugc3RyaWN0JzsKCiAgLyoqCiAgICogUmVjb3JkcyB3aGF0IG9iamVjdHMgYXJlIGNvbGxpZGluZyB3aXRoIGVhY2ggb3RoZXIKICAgKi8KCiAgLyoqCiAgICogQSAzeDMgbWF0cml4LgogICAqIEF1dGhvcmVkIGJ5IHtAbGluayBodHRwOi8vZ2l0aHViLmNvbS9zY2h0ZXBwZS8gc2NodGVwcGV9CiAgICovCiAgY2xhc3MgTWF0MyB7CiAgICAvKioKICAgICAqIEEgdmVjdG9yIG9mIGxlbmd0aCA5LCBjb250YWluaW5nIGFsbCBtYXRyaXggZWxlbWVudHMuCiAgICAgKi8KCiAgICAvKioKICAgICAqIEBwYXJhbSBlbGVtZW50cyBBIHZlY3RvciBvZiBsZW5ndGggOSwgY29udGFpbmluZyBhbGwgbWF0cml4IGVsZW1lbnRzLgogICAgICovCiAgICBjb25zdHJ1Y3RvcihlbGVtZW50cykgewogICAgICBpZiAoZWxlbWVudHMgPT09IHZvaWQgMCkgewogICAgICAgIGVsZW1lbnRzID0gWzAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDBdOwogICAgICB9CgogICAgICB0aGlzLmVsZW1lbnRzID0gZWxlbWVudHM7CiAgICB9CiAgICAvKioKICAgICAqIFNldHMgdGhlIG1hdHJpeCB0byBpZGVudGl0eQogICAgICogQHRvZG8gU2hvdWxkIHBlcmhhcHMgYmUgcmVuYW1lZCB0byBgc2V0SWRlbnRpdHkoKWAgdG8gYmUgbW9yZSBjbGVhci4KICAgICAqIEB0b2RvIENyZWF0ZSBhbm90aGVyIGZ1bmN0aW9uIHRoYXQgaW1tZWRpYXRlbHkgY3JlYXRlcyBhbiBpZGVudGl0eSBtYXRyaXggZWcuIGBleWUoKWAKICAgICAqLwoKCiAgICBpZGVudGl0eSgpIHsKICAgICAgY29uc3QgZSA9IHRoaXMuZWxlbWVudHM7CiAgICAgIGVbMF0gPSAxOwogICAgICBlWzFdID0gMDsKICAgICAgZVsyXSA9IDA7CiAgICAgIGVbM10gPSAwOwogICAgICBlWzRdID0gMTsKICAgICAgZVs1XSA9IDA7CiAgICAgIGVbNl0gPSAwOwogICAgICBlWzddID0gMDsKICAgICAgZVs4XSA9IDE7CiAgICB9CiAgICAvKioKICAgICAqIFNldCBhbGwgZWxlbWVudHMgdG8gemVybwogICAgICovCgoKICAgIHNldFplcm8oKSB7CiAgICAgIGNvbnN0IGUgPSB0aGlzLmVsZW1lbnRzOwogICAgICBlWzBdID0gMDsKICAgICAgZVsxXSA9IDA7CiAgICAgIGVbMl0gPSAwOwogICAgICBlWzNdID0gMDsKICAgICAgZVs0XSA9IDA7CiAgICAgIGVbNV0gPSAwOwogICAgICBlWzZdID0gMDsKICAgICAgZVs3XSA9IDA7CiAgICAgIGVbOF0gPSAwOwogICAgfQogICAgLyoqCiAgICAgKiBTZXRzIHRoZSBtYXRyaXggZGlhZ29uYWwgZWxlbWVudHMgZnJvbSBhIFZlYzMKICAgICAqLwoKCiAgICBzZXRUcmFjZSh2ZWN0b3IpIHsKICAgICAgY29uc3QgZSA9IHRoaXMuZWxlbWVudHM7CiAgICAgIGVbMF0gPSB2ZWN0b3IueDsKICAgICAgZVs0XSA9IHZlY3Rvci55OwogICAgICBlWzhdID0gdmVjdG9yLno7CiAgICB9CiAgICAvKioKICAgICAqIEdldHMgdGhlIG1hdHJpeCBkaWFnb25hbCBlbGVtZW50cwogICAgICovCgoKICAgIGdldFRyYWNlKHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB2b2lkIDApIHsKICAgICAgICB0YXJnZXQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICBjb25zdCBlID0gdGhpcy5lbGVtZW50czsKICAgICAgdGFyZ2V0LnggPSBlWzBdOwogICAgICB0YXJnZXQueSA9IGVbNF07CiAgICAgIHRhcmdldC56ID0gZVs4XTsKICAgICAgcmV0dXJuIHRhcmdldDsKICAgIH0KICAgIC8qKgogICAgICogTWF0cml4LVZlY3RvciBtdWx0aXBsaWNhdGlvbgogICAgICogQHBhcmFtIHYgVGhlIHZlY3RvciB0byBtdWx0aXBseSB3aXRoCiAgICAgKiBAcGFyYW0gdGFyZ2V0IE9wdGlvbmFsLCB0YXJnZXQgdG8gc2F2ZSB0aGUgcmVzdWx0IGluLgogICAgICovCgoKICAgIHZtdWx0KHYsIHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB2b2lkIDApIHsKICAgICAgICB0YXJnZXQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICBjb25zdCBlID0gdGhpcy5lbGVtZW50czsKICAgICAgY29uc3QgeCA9IHYueDsKICAgICAgY29uc3QgeSA9IHYueTsKICAgICAgY29uc3QgeiA9IHYuejsKICAgICAgdGFyZ2V0LnggPSBlWzBdICogeCArIGVbMV0gKiB5ICsgZVsyXSAqIHo7CiAgICAgIHRhcmdldC55ID0gZVszXSAqIHggKyBlWzRdICogeSArIGVbNV0gKiB6OwogICAgICB0YXJnZXQueiA9IGVbNl0gKiB4ICsgZVs3XSAqIHkgKyBlWzhdICogejsKICAgICAgcmV0dXJuIHRhcmdldDsKICAgIH0KICAgIC8qKgogICAgICogTWF0cml4LXNjYWxhciBtdWx0aXBsaWNhdGlvbgogICAgICovCgoKICAgIHNtdWx0KHMpIHsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmVsZW1lbnRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgdGhpcy5lbGVtZW50c1tpXSAqPSBzOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIE1hdHJpeCBtdWx0aXBsaWNhdGlvbgogICAgICogQHBhcmFtIG1hdHJpeCBNYXRyaXggdG8gbXVsdGlwbHkgd2l0aCBmcm9tIGxlZnQgc2lkZS4KICAgICAqLwoKCiAgICBtbXVsdChtYXRyaXgsIHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB2b2lkIDApIHsKICAgICAgICB0YXJnZXQgPSBuZXcgTWF0MygpOwogICAgICB9CgogICAgICBjb25zdCBBID0gdGhpcy5lbGVtZW50czsKICAgICAgY29uc3QgQiA9IG1hdHJpeC5lbGVtZW50czsKICAgICAgY29uc3QgVCA9IHRhcmdldC5lbGVtZW50czsKICAgICAgY29uc3QgYTExID0gQVswXSwKICAgICAgICAgICAgYTEyID0gQVsxXSwKICAgICAgICAgICAgYTEzID0gQVsyXSwKICAgICAgICAgICAgYTIxID0gQVszXSwKICAgICAgICAgICAgYTIyID0gQVs0XSwKICAgICAgICAgICAgYTIzID0gQVs1XSwKICAgICAgICAgICAgYTMxID0gQVs2XSwKICAgICAgICAgICAgYTMyID0gQVs3XSwKICAgICAgICAgICAgYTMzID0gQVs4XTsKICAgICAgY29uc3QgYjExID0gQlswXSwKICAgICAgICAgICAgYjEyID0gQlsxXSwKICAgICAgICAgICAgYjEzID0gQlsyXSwKICAgICAgICAgICAgYjIxID0gQlszXSwKICAgICAgICAgICAgYjIyID0gQls0XSwKICAgICAgICAgICAgYjIzID0gQls1XSwKICAgICAgICAgICAgYjMxID0gQls2XSwKICAgICAgICAgICAgYjMyID0gQls3XSwKICAgICAgICAgICAgYjMzID0gQls4XTsKICAgICAgVFswXSA9IGExMSAqIGIxMSArIGExMiAqIGIyMSArIGExMyAqIGIzMTsKICAgICAgVFsxXSA9IGExMSAqIGIxMiArIGExMiAqIGIyMiArIGExMyAqIGIzMjsKICAgICAgVFsyXSA9IGExMSAqIGIxMyArIGExMiAqIGIyMyArIGExMyAqIGIzMzsKICAgICAgVFszXSA9IGEyMSAqIGIxMSArIGEyMiAqIGIyMSArIGEyMyAqIGIzMTsKICAgICAgVFs0XSA9IGEyMSAqIGIxMiArIGEyMiAqIGIyMiArIGEyMyAqIGIzMjsKICAgICAgVFs1XSA9IGEyMSAqIGIxMyArIGEyMiAqIGIyMyArIGEyMyAqIGIzMzsKICAgICAgVFs2XSA9IGEzMSAqIGIxMSArIGEzMiAqIGIyMSArIGEzMyAqIGIzMTsKICAgICAgVFs3XSA9IGEzMSAqIGIxMiArIGEzMiAqIGIyMiArIGEzMyAqIGIzMjsKICAgICAgVFs4XSA9IGEzMSAqIGIxMyArIGEzMiAqIGIyMyArIGEzMyAqIGIzMzsKICAgICAgcmV0dXJuIHRhcmdldDsKICAgIH0KICAgIC8qKgogICAgICogU2NhbGUgZWFjaCBjb2x1bW4gb2YgdGhlIG1hdHJpeAogICAgICovCgoKICAgIHNjYWxlKHZlY3RvciwgdGFyZ2V0KSB7CiAgICAgIGlmICh0YXJnZXQgPT09IHZvaWQgMCkgewogICAgICAgIHRhcmdldCA9IG5ldyBNYXQzKCk7CiAgICAgIH0KCiAgICAgIGNvbnN0IGUgPSB0aGlzLmVsZW1lbnRzOwogICAgICBjb25zdCB0ID0gdGFyZ2V0LmVsZW1lbnRzOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IDM7IGkrKykgewogICAgICAgIHRbMyAqIGkgKyAwXSA9IHZlY3Rvci54ICogZVszICogaSArIDBdOwogICAgICAgIHRbMyAqIGkgKyAxXSA9IHZlY3Rvci55ICogZVszICogaSArIDFdOwogICAgICAgIHRbMyAqIGkgKyAyXSA9IHZlY3Rvci56ICogZVszICogaSArIDJdOwogICAgICB9CgogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQogICAgLyoqCiAgICAgKiBTb2x2ZSBBeD1iCiAgICAgKiBAcGFyYW0gYiBUaGUgcmlnaHQgaGFuZCBzaWRlCiAgICAgKiBAcGFyYW0gdGFyZ2V0IE9wdGlvbmFsLiBUYXJnZXQgdmVjdG9yIHRvIHNhdmUgaW4uCiAgICAgKiBAcmV0dXJuIFRoZSBzb2x1dGlvbiB4CiAgICAgKiBAdG9kbyBzaG91bGQgcmV1c2UgYXJyYXlzCiAgICAgKi8KCgogICAgc29sdmUoYiwgdGFyZ2V0KSB7CiAgICAgIGlmICh0YXJnZXQgPT09IHZvaWQgMCkgewogICAgICAgIHRhcmdldCA9IG5ldyBWZWMzKCk7CiAgICAgIH0KCiAgICAgIC8vIENvbnN0cnVjdCBlcXVhdGlvbnMKICAgICAgY29uc3QgbnIgPSAzOyAvLyBudW0gcm93cwoKICAgICAgY29uc3QgbmMgPSA0OyAvLyBudW0gY29scwoKICAgICAgY29uc3QgZXFucyA9IFtdOwogICAgICBsZXQgaTsKICAgICAgbGV0IGo7CgogICAgICBmb3IgKGkgPSAwOyBpIDwgbnIgKiBuYzsgaSsrKSB7CiAgICAgICAgZXFucy5wdXNoKDApOwogICAgICB9CgogICAgICBmb3IgKGkgPSAwOyBpIDwgMzsgaSsrKSB7CiAgICAgICAgZm9yIChqID0gMDsgaiA8IDM7IGorKykgewogICAgICAgICAgZXFuc1tpICsgbmMgKiBqXSA9IHRoaXMuZWxlbWVudHNbaSArIDMgKiBqXTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGVxbnNbMyArIDQgKiAwXSA9IGIueDsKICAgICAgZXFuc1szICsgNCAqIDFdID0gYi55OwogICAgICBlcW5zWzMgKyA0ICogMl0gPSBiLno7IC8vIENvbXB1dGUgcmlnaHQgdXBwZXIgdHJpYW5ndWxhciB2ZXJzaW9uIG9mIHRoZSBtYXRyaXggLSBHYXVzcyBlbGltaW5hdGlvbgoKICAgICAgbGV0IG4gPSAzOwogICAgICBjb25zdCBrID0gbjsKICAgICAgbGV0IG5wOwogICAgICBjb25zdCBrcCA9IDQ7IC8vIG51bSByb3dzCgogICAgICBsZXQgcDsKCiAgICAgIGRvIHsKICAgICAgICBpID0gayAtIG47CgogICAgICAgIGlmIChlcW5zW2kgKyBuYyAqIGldID09PSAwKSB7CiAgICAgICAgICAvLyB0aGUgcGl2b3QgaXMgbnVsbCwgc3dhcCBsaW5lcwogICAgICAgICAgZm9yIChqID0gaSArIDE7IGogPCBrOyBqKyspIHsKICAgICAgICAgICAgaWYgKGVxbnNbaSArIG5jICogal0gIT09IDApIHsKICAgICAgICAgICAgICBucCA9IGtwOwoKICAgICAgICAgICAgICBkbyB7CiAgICAgICAgICAgICAgICAvLyBkbyBsaWduZSggaSApID0gbGlnbmUoIGkgKSArIGxpZ25lKCBrICkKICAgICAgICAgICAgICAgIHAgPSBrcCAtIG5wOwogICAgICAgICAgICAgICAgZXFuc1twICsgbmMgKiBpXSArPSBlcW5zW3AgKyBuYyAqIGpdOwogICAgICAgICAgICAgIH0gd2hpbGUgKC0tbnApOwoKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKGVxbnNbaSArIG5jICogaV0gIT09IDApIHsKICAgICAgICAgIGZvciAoaiA9IGkgKyAxOyBqIDwgazsgaisrKSB7CiAgICAgICAgICAgIGNvbnN0IG11bHRpcGxpZXIgPSBlcW5zW2kgKyBuYyAqIGpdIC8gZXFuc1tpICsgbmMgKiBpXTsKICAgICAgICAgICAgbnAgPSBrcDsKCiAgICAgICAgICAgIGRvIHsKICAgICAgICAgICAgICAvLyBkbyBsaWduZSggayApID0gbGlnbmUoIGsgKSAtIG11bHRpcGxpZXIgKiBsaWduZSggaSApCiAgICAgICAgICAgICAgcCA9IGtwIC0gbnA7CiAgICAgICAgICAgICAgZXFuc1twICsgbmMgKiBqXSA9IHAgPD0gaSA/IDAgOiBlcW5zW3AgKyBuYyAqIGpdIC0gZXFuc1twICsgbmMgKiBpXSAqIG11bHRpcGxpZXI7CiAgICAgICAgICAgIH0gd2hpbGUgKC0tbnApOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSB3aGlsZSAoLS1uKTsgLy8gR2V0IHRoZSBzb2x1dGlvbgoKCiAgICAgIHRhcmdldC56ID0gZXFuc1syICogbmMgKyAzXSAvIGVxbnNbMiAqIG5jICsgMl07CiAgICAgIHRhcmdldC55ID0gKGVxbnNbMSAqIG5jICsgM10gLSBlcW5zWzEgKiBuYyArIDJdICogdGFyZ2V0LnopIC8gZXFuc1sxICogbmMgKyAxXTsKICAgICAgdGFyZ2V0LnggPSAoZXFuc1swICogbmMgKyAzXSAtIGVxbnNbMCAqIG5jICsgMl0gKiB0YXJnZXQueiAtIGVxbnNbMCAqIG5jICsgMV0gKiB0YXJnZXQueSkgLyBlcW5zWzAgKiBuYyArIDBdOwoKICAgICAgaWYgKGlzTmFOKHRhcmdldC54KSB8fCBpc05hTih0YXJnZXQueSkgfHwgaXNOYU4odGFyZ2V0LnopIHx8IHRhcmdldC54ID09PSBJbmZpbml0eSB8fCB0YXJnZXQueSA9PT0gSW5maW5pdHkgfHwgdGFyZ2V0LnogPT09IEluZmluaXR5KSB7CiAgICAgICAgdGhyb3cgYENvdWxkIG5vdCBzb2x2ZSBlcXVhdGlvbiEgR290IHg9WyR7dGFyZ2V0LnRvU3RyaW5nKCl9XSwgYj1bJHtiLnRvU3RyaW5nKCl9XSwgQT1bJHt0aGlzLnRvU3RyaW5nKCl9XWA7CiAgICAgIH0KCiAgICAgIHJldHVybiB0YXJnZXQ7CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhbiBlbGVtZW50IGluIHRoZSBtYXRyaXggYnkgaW5kZXguIEluZGV4IHN0YXJ0cyBhdCAwLCBub3QgMSEhIQogICAgICogQHBhcmFtIHZhbHVlIElmIHByb3ZpZGVkLCB0aGUgbWF0cml4IGVsZW1lbnQgd2lsbCBiZSBzZXQgdG8gdGhpcyB2YWx1ZS4KICAgICAqLwoKCiAgICBlKHJvdywgY29sdW1uLCB2YWx1ZSkgewogICAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkgewogICAgICAgIHJldHVybiB0aGlzLmVsZW1lbnRzW2NvbHVtbiArIDMgKiByb3ddOwogICAgICB9IGVsc2UgewogICAgICAgIC8vIFNldCB2YWx1ZQogICAgICAgIHRoaXMuZWxlbWVudHNbY29sdW1uICsgMyAqIHJvd10gPSB2YWx1ZTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBDb3B5IGFub3RoZXIgbWF0cml4IGludG8gdGhpcyBtYXRyaXggb2JqZWN0LgogICAgICovCgoKICAgIGNvcHkobWF0cml4KSB7CiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbWF0cml4LmVsZW1lbnRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgdGhpcy5lbGVtZW50c1tpXSA9IG1hdHJpeC5lbGVtZW50c1tpXTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICAvKioKICAgICAqIFJldHVybnMgYSBzdHJpbmcgcmVwcmVzZW50YXRpb24gb2YgdGhlIG1hdHJpeC4KICAgICAqLwoKCiAgICB0b1N0cmluZygpIHsKICAgICAgbGV0IHIgPSAnJzsKICAgICAgY29uc3Qgc2VwID0gJywnOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCA5OyBpKyspIHsKICAgICAgICByICs9IHRoaXMuZWxlbWVudHNbaV0gKyBzZXA7CiAgICAgIH0KCiAgICAgIHJldHVybiByOwogICAgfQogICAgLyoqCiAgICAgKiByZXZlcnNlIHRoZSBtYXRyaXgKICAgICAqIEBwYXJhbSB0YXJnZXQgVGFyZ2V0IG1hdHJpeCB0byBzYXZlIGluLgogICAgICogQHJldHVybiBUaGUgc29sdXRpb24geAogICAgICovCgoKICAgIHJldmVyc2UodGFyZ2V0KSB7CiAgICAgIGlmICh0YXJnZXQgPT09IHZvaWQgMCkgewogICAgICAgIHRhcmdldCA9IG5ldyBNYXQzKCk7CiAgICAgIH0KCiAgICAgIC8vIENvbnN0cnVjdCBlcXVhdGlvbnMKICAgICAgY29uc3QgbnIgPSAzOyAvLyBudW0gcm93cwoKICAgICAgY29uc3QgbmMgPSA2OyAvLyBudW0gY29scwoKICAgICAgY29uc3QgZXFucyA9IHJldmVyc2VfZXFuczsKICAgICAgbGV0IGk7CiAgICAgIGxldCBqOwoKICAgICAgZm9yIChpID0gMDsgaSA8IDM7IGkrKykgewogICAgICAgIGZvciAoaiA9IDA7IGogPCAzOyBqKyspIHsKICAgICAgICAgIGVxbnNbaSArIG5jICogal0gPSB0aGlzLmVsZW1lbnRzW2kgKyAzICogal07CiAgICAgICAgfQogICAgICB9CgogICAgICBlcW5zWzMgKyA2ICogMF0gPSAxOwogICAgICBlcW5zWzMgKyA2ICogMV0gPSAwOwogICAgICBlcW5zWzMgKyA2ICogMl0gPSAwOwogICAgICBlcW5zWzQgKyA2ICogMF0gPSAwOwogICAgICBlcW5zWzQgKyA2ICogMV0gPSAxOwogICAgICBlcW5zWzQgKyA2ICogMl0gPSAwOwogICAgICBlcW5zWzUgKyA2ICogMF0gPSAwOwogICAgICBlcW5zWzUgKyA2ICogMV0gPSAwOwogICAgICBlcW5zWzUgKyA2ICogMl0gPSAxOyAvLyBDb21wdXRlIHJpZ2h0IHVwcGVyIHRyaWFuZ3VsYXIgdmVyc2lvbiBvZiB0aGUgbWF0cml4IC0gR2F1c3MgZWxpbWluYXRpb24KCiAgICAgIGxldCBuID0gMzsKICAgICAgY29uc3QgayA9IG47CiAgICAgIGxldCBucDsKICAgICAgY29uc3Qga3AgPSBuYzsgLy8gbnVtIHJvd3MKCiAgICAgIGxldCBwOwoKICAgICAgZG8gewogICAgICAgIGkgPSBrIC0gbjsKCiAgICAgICAgaWYgKGVxbnNbaSArIG5jICogaV0gPT09IDApIHsKICAgICAgICAgIC8vIHRoZSBwaXZvdCBpcyBudWxsLCBzd2FwIGxpbmVzCiAgICAgICAgICBmb3IgKGogPSBpICsgMTsgaiA8IGs7IGorKykgewogICAgICAgICAgICBpZiAoZXFuc1tpICsgbmMgKiBqXSAhPT0gMCkgewogICAgICAgICAgICAgIG5wID0ga3A7CgogICAgICAgICAgICAgIGRvIHsKICAgICAgICAgICAgICAgIC8vIGRvIGxpbmUoIGkgKSA9IGxpbmUoIGkgKSArIGxpbmUoIGsgKQogICAgICAgICAgICAgICAgcCA9IGtwIC0gbnA7CiAgICAgICAgICAgICAgICBlcW5zW3AgKyBuYyAqIGldICs9IGVxbnNbcCArIG5jICogal07CiAgICAgICAgICAgICAgfSB3aGlsZSAoLS1ucCk7CgogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAoZXFuc1tpICsgbmMgKiBpXSAhPT0gMCkgewogICAgICAgICAgZm9yIChqID0gaSArIDE7IGogPCBrOyBqKyspIHsKICAgICAgICAgICAgY29uc3QgbXVsdGlwbGllciA9IGVxbnNbaSArIG5jICogal0gLyBlcW5zW2kgKyBuYyAqIGldOwogICAgICAgICAgICBucCA9IGtwOwoKICAgICAgICAgICAgZG8gewogICAgICAgICAgICAgIC8vIGRvIGxpbmUoIGsgKSA9IGxpbmUoIGsgKSAtIG11bHRpcGxpZXIgKiBsaW5lKCBpICkKICAgICAgICAgICAgICBwID0ga3AgLSBucDsKICAgICAgICAgICAgICBlcW5zW3AgKyBuYyAqIGpdID0gcCA8PSBpID8gMCA6IGVxbnNbcCArIG5jICogal0gLSBlcW5zW3AgKyBuYyAqIGldICogbXVsdGlwbGllcjsKICAgICAgICAgICAgfSB3aGlsZSAoLS1ucCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IHdoaWxlICgtLW4pOyAvLyBlbGltaW5hdGUgdGhlIHVwcGVyIGxlZnQgdHJpYW5nbGUgb2YgdGhlIG1hdHJpeAoKCiAgICAgIGkgPSAyOwoKICAgICAgZG8gewogICAgICAgIGogPSBpIC0gMTsKCiAgICAgICAgZG8gewogICAgICAgICAgY29uc3QgbXVsdGlwbGllciA9IGVxbnNbaSArIG5jICogal0gLyBlcW5zW2kgKyBuYyAqIGldOwogICAgICAgICAgbnAgPSBuYzsKCiAgICAgICAgICBkbyB7CiAgICAgICAgICAgIHAgPSBuYyAtIG5wOwogICAgICAgICAgICBlcW5zW3AgKyBuYyAqIGpdID0gZXFuc1twICsgbmMgKiBqXSAtIGVxbnNbcCArIG5jICogaV0gKiBtdWx0aXBsaWVyOwogICAgICAgICAgfSB3aGlsZSAoLS1ucCk7CiAgICAgICAgfSB3aGlsZSAoai0tKTsKICAgICAgfSB3aGlsZSAoLS1pKTsgLy8gb3BlcmF0aW9ucyBvbiB0aGUgZGlhZ29uYWwKCgogICAgICBpID0gMjsKCiAgICAgIGRvIHsKICAgICAgICBjb25zdCBtdWx0aXBsaWVyID0gMSAvIGVxbnNbaSArIG5jICogaV07CiAgICAgICAgbnAgPSBuYzsKCiAgICAgICAgZG8gewogICAgICAgICAgcCA9IG5jIC0gbnA7CiAgICAgICAgICBlcW5zW3AgKyBuYyAqIGldID0gZXFuc1twICsgbmMgKiBpXSAqIG11bHRpcGxpZXI7CiAgICAgICAgfSB3aGlsZSAoLS1ucCk7CiAgICAgIH0gd2hpbGUgKGktLSk7CgogICAgICBpID0gMjsKCiAgICAgIGRvIHsKICAgICAgICBqID0gMjsKCiAgICAgICAgZG8gewogICAgICAgICAgcCA9IGVxbnNbbnIgKyBqICsgbmMgKiBpXTsKCiAgICAgICAgICBpZiAoaXNOYU4ocCkgfHwgcCA9PT0gSW5maW5pdHkpIHsKICAgICAgICAgICAgdGhyb3cgYENvdWxkIG5vdCByZXZlcnNlISBBPVske3RoaXMudG9TdHJpbmcoKX1dYDsKICAgICAgICAgIH0KCiAgICAgICAgICB0YXJnZXQuZShpLCBqLCBwKTsKICAgICAgICB9IHdoaWxlIChqLS0pOwogICAgICB9IHdoaWxlIChpLS0pOwoKICAgICAgcmV0dXJuIHRhcmdldDsKICAgIH0KICAgIC8qKgogICAgICogU2V0IHRoZSBtYXRyaXggZnJvbSBhIHF1YXRlcmlvbgogICAgICovCgoKICAgIHNldFJvdGF0aW9uRnJvbVF1YXRlcm5pb24ocSkgewogICAgICBjb25zdCB4ID0gcS54OwogICAgICBjb25zdCB5ID0gcS55OwogICAgICBjb25zdCB6ID0gcS56OwogICAgICBjb25zdCB3ID0gcS53OwogICAgICBjb25zdCB4MiA9IHggKyB4OwogICAgICBjb25zdCB5MiA9IHkgKyB5OwogICAgICBjb25zdCB6MiA9IHogKyB6OwogICAgICBjb25zdCB4eCA9IHggKiB4MjsKICAgICAgY29uc3QgeHkgPSB4ICogeTI7CiAgICAgIGNvbnN0IHh6ID0geCAqIHoyOwogICAgICBjb25zdCB5eSA9IHkgKiB5MjsKICAgICAgY29uc3QgeXogPSB5ICogejI7CiAgICAgIGNvbnN0IHp6ID0geiAqIHoyOwogICAgICBjb25zdCB3eCA9IHcgKiB4MjsKICAgICAgY29uc3Qgd3kgPSB3ICogeTI7CiAgICAgIGNvbnN0IHd6ID0gdyAqIHoyOwogICAgICBjb25zdCBlID0gdGhpcy5lbGVtZW50czsKICAgICAgZVszICogMCArIDBdID0gMSAtICh5eSArIHp6KTsKICAgICAgZVszICogMCArIDFdID0geHkgLSB3ejsKICAgICAgZVszICogMCArIDJdID0geHogKyB3eTsKICAgICAgZVszICogMSArIDBdID0geHkgKyB3ejsKICAgICAgZVszICogMSArIDFdID0gMSAtICh4eCArIHp6KTsKICAgICAgZVszICogMSArIDJdID0geXogLSB3eDsKICAgICAgZVszICogMiArIDBdID0geHogLSB3eTsKICAgICAgZVszICogMiArIDFdID0geXogKyB3eDsKICAgICAgZVszICogMiArIDJdID0gMSAtICh4eCArIHl5KTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICAvKioKICAgICAqIFRyYW5zcG9zZSB0aGUgbWF0cml4CiAgICAgKiBAcGFyYW0gdGFyZ2V0IE9wdGlvbmFsLiBXaGVyZSB0byBzdG9yZSB0aGUgcmVzdWx0LgogICAgICogQHJldHVybiBUaGUgdGFyZ2V0IE1hdDMsIG9yIGEgbmV3IE1hdDMgaWYgdGFyZ2V0IHdhcyBvbWl0dGVkLgogICAgICovCgoKICAgIHRyYW5zcG9zZSh0YXJnZXQpIHsKICAgICAgaWYgKHRhcmdldCA9PT0gdm9pZCAwKSB7CiAgICAgICAgdGFyZ2V0ID0gbmV3IE1hdDMoKTsKICAgICAgfQoKICAgICAgY29uc3QgTSA9IHRoaXMuZWxlbWVudHM7CiAgICAgIGNvbnN0IFQgPSB0YXJnZXQuZWxlbWVudHM7CiAgICAgIGxldCB0bXA7IC8vU2V0IGRpYWdvbmFscwoKICAgICAgVFswXSA9IE1bMF07CiAgICAgIFRbNF0gPSBNWzRdOwogICAgICBUWzhdID0gTVs4XTsKICAgICAgdG1wID0gTVsxXTsKICAgICAgVFsxXSA9IE1bM107CiAgICAgIFRbM10gPSB0bXA7CiAgICAgIHRtcCA9IE1bMl07CiAgICAgIFRbMl0gPSBNWzZdOwogICAgICBUWzZdID0gdG1wOwogICAgICB0bXAgPSBNWzVdOwogICAgICBUWzVdID0gTVs3XTsKICAgICAgVFs3XSA9IHRtcDsKICAgICAgcmV0dXJuIHRhcmdldDsKICAgIH0KCiAgfQogIGNvbnN0IHJldmVyc2VfZXFucyA9IFswLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwXTsKCiAgLyoqCiAgICogMy1kaW1lbnNpb25hbCB2ZWN0b3IKICAgKiBAZXhhbXBsZQogICAqICAgICBjb25zdCB2ID0gbmV3IFZlYzMoMSwgMiwgMykKICAgKiAgICAgY29uc29sZS5sb2coJ3g9JyArIHYueCkgLy8geD0xCiAgICovCgogIGNsYXNzIFZlYzMgewogICAgY29uc3RydWN0b3IoeCwgeSwgeikgewogICAgICBpZiAoeCA9PT0gdm9pZCAwKSB7CiAgICAgICAgeCA9IDAuMDsKICAgICAgfQoKICAgICAgaWYgKHkgPT09IHZvaWQgMCkgewogICAgICAgIHkgPSAwLjA7CiAgICAgIH0KCiAgICAgIGlmICh6ID09PSB2b2lkIDApIHsKICAgICAgICB6ID0gMC4wOwogICAgICB9CgogICAgICB0aGlzLnggPSB4OwogICAgICB0aGlzLnkgPSB5OwogICAgICB0aGlzLnogPSB6OwogICAgfQogICAgLyoqCiAgICAgKiBWZWN0b3IgY3Jvc3MgcHJvZHVjdAogICAgICogQHBhcmFtIHRhcmdldCBPcHRpb25hbCB0YXJnZXQgdG8gc2F2ZSBpbi4KICAgICAqLwoKCiAgICBjcm9zcyh2ZWN0b3IsIHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB2b2lkIDApIHsKICAgICAgICB0YXJnZXQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICBjb25zdCB2eCA9IHZlY3Rvci54OwogICAgICBjb25zdCB2eSA9IHZlY3Rvci55OwogICAgICBjb25zdCB2eiA9IHZlY3Rvci56OwogICAgICBjb25zdCB4ID0gdGhpcy54OwogICAgICBjb25zdCB5ID0gdGhpcy55OwogICAgICBjb25zdCB6ID0gdGhpcy56OwogICAgICB0YXJnZXQueCA9IHkgKiB2eiAtIHogKiB2eTsKICAgICAgdGFyZ2V0LnkgPSB6ICogdnggLSB4ICogdno7CiAgICAgIHRhcmdldC56ID0geCAqIHZ5IC0geSAqIHZ4OwogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQogICAgLyoqCiAgICAgKiBTZXQgdGhlIHZlY3RvcnMnIDMgZWxlbWVudHMKICAgICAqLwoKCiAgICBzZXQoeCwgeSwgeikgewogICAgICB0aGlzLnggPSB4OwogICAgICB0aGlzLnkgPSB5OwogICAgICB0aGlzLnogPSB6OwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICAgIC8qKgogICAgICogU2V0IGFsbCBjb21wb25lbnRzIG9mIHRoZSB2ZWN0b3IgdG8gemVyby4KICAgICAqLwoKCiAgICBzZXRaZXJvKCkgewogICAgICB0aGlzLnggPSB0aGlzLnkgPSB0aGlzLnogPSAwOwogICAgfQogICAgLyoqCiAgICAgKiBWZWN0b3IgYWRkaXRpb24KICAgICAqLwoKCiAgICB2YWRkKHZlY3RvciwgdGFyZ2V0KSB7CiAgICAgIGlmICh0YXJnZXQpIHsKICAgICAgICB0YXJnZXQueCA9IHZlY3Rvci54ICsgdGhpcy54OwogICAgICAgIHRhcmdldC55ID0gdmVjdG9yLnkgKyB0aGlzLnk7CiAgICAgICAgdGFyZ2V0LnogPSB2ZWN0b3IueiArIHRoaXMuejsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gbmV3IFZlYzModGhpcy54ICsgdmVjdG9yLngsIHRoaXMueSArIHZlY3Rvci55LCB0aGlzLnogKyB2ZWN0b3Iueik7CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogVmVjdG9yIHN1YnRyYWN0aW9uCiAgICAgKiBAcGFyYW0gdGFyZ2V0IE9wdGlvbmFsIHRhcmdldCB0byBzYXZlIGluLgogICAgICovCgoKICAgIHZzdWIodmVjdG9yLCB0YXJnZXQpIHsKICAgICAgaWYgKHRhcmdldCkgewogICAgICAgIHRhcmdldC54ID0gdGhpcy54IC0gdmVjdG9yLng7CiAgICAgICAgdGFyZ2V0LnkgPSB0aGlzLnkgLSB2ZWN0b3IueTsKICAgICAgICB0YXJnZXQueiA9IHRoaXMueiAtIHZlY3Rvci56OwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBuZXcgVmVjMyh0aGlzLnggLSB2ZWN0b3IueCwgdGhpcy55IC0gdmVjdG9yLnksIHRoaXMueiAtIHZlY3Rvci56KTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBHZXQgdGhlIGNyb3NzIHByb2R1Y3QgbWF0cml4IGFfY3Jvc3MgZnJvbSBhIHZlY3Rvciwgc3VjaCB0aGF0IGEgeCBiID0gYV9jcm9zcyAqIGIgPSBjCiAgICAgKgogICAgICogU2VlIHtAbGluayBodHRwczovL3d3dzguY3MudW11LnNlL2t1cnNlci9UREJEMjQvVlQwNi9sZWN0dXJlcy9MZWN0dXJlNi5wZGYgVW1lw6UgVW5pdmVyc2l0eSBMZWN0dXJlfQogICAgICovCgoKICAgIGNyb3NzbWF0KCkgewogICAgICByZXR1cm4gbmV3IE1hdDMoWzAsIC10aGlzLnosIHRoaXMueSwgdGhpcy56LCAwLCAtdGhpcy54LCAtdGhpcy55LCB0aGlzLngsIDBdKTsKICAgIH0KICAgIC8qKgogICAgICogTm9ybWFsaXplIHRoZSB2ZWN0b3IuIE5vdGUgdGhhdCB0aGlzIGNoYW5nZXMgdGhlIHZhbHVlcyBpbiB0aGUgdmVjdG9yLgogICAgICAqIEByZXR1cm4gUmV0dXJucyB0aGUgbm9ybSBvZiB0aGUgdmVjdG9yCiAgICAgKi8KCgogICAgbm9ybWFsaXplKCkgewogICAgICBjb25zdCB4ID0gdGhpcy54OwogICAgICBjb25zdCB5ID0gdGhpcy55OwogICAgICBjb25zdCB6ID0gdGhpcy56OwogICAgICBjb25zdCBuID0gTWF0aC5zcXJ0KHggKiB4ICsgeSAqIHkgKyB6ICogeik7CgogICAgICBpZiAobiA+IDAuMCkgewogICAgICAgIGNvbnN0IGludk4gPSAxIC8gbjsKICAgICAgICB0aGlzLnggKj0gaW52TjsKICAgICAgICB0aGlzLnkgKj0gaW52TjsKICAgICAgICB0aGlzLnogKj0gaW52TjsKICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBNYWtlIHNvbWV0aGluZyB1cAogICAgICAgIHRoaXMueCA9IDA7CiAgICAgICAgdGhpcy55ID0gMDsKICAgICAgICB0aGlzLnogPSAwOwogICAgICB9CgogICAgICByZXR1cm4gbjsKICAgIH0KICAgIC8qKgogICAgICogR2V0IHRoZSB2ZXJzaW9uIG9mIHRoaXMgdmVjdG9yIHRoYXQgaXMgb2YgbGVuZ3RoIDEuCiAgICAgKiBAcGFyYW0gdGFyZ2V0IE9wdGlvbmFsIHRhcmdldCB0byBzYXZlIGluCiAgICAgKiBAcmV0dXJuIFJldHVybnMgdGhlIHVuaXQgdmVjdG9yCiAgICAgKi8KCgogICAgdW5pdCh0YXJnZXQpIHsKICAgICAgaWYgKHRhcmdldCA9PT0gdm9pZCAwKSB7CiAgICAgICAgdGFyZ2V0ID0gbmV3IFZlYzMoKTsKICAgICAgfQoKICAgICAgY29uc3QgeCA9IHRoaXMueDsKICAgICAgY29uc3QgeSA9IHRoaXMueTsKICAgICAgY29uc3QgeiA9IHRoaXMuejsKICAgICAgbGV0IG5pbnYgPSBNYXRoLnNxcnQoeCAqIHggKyB5ICogeSArIHogKiB6KTsKCiAgICAgIGlmIChuaW52ID4gMC4wKSB7CiAgICAgICAgbmludiA9IDEuMCAvIG5pbnY7CiAgICAgICAgdGFyZ2V0LnggPSB4ICogbmludjsKICAgICAgICB0YXJnZXQueSA9IHkgKiBuaW52OwogICAgICAgIHRhcmdldC56ID0geiAqIG5pbnY7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGFyZ2V0LnggPSAxOwogICAgICAgIHRhcmdldC55ID0gMDsKICAgICAgICB0YXJnZXQueiA9IDA7CiAgICAgIH0KCiAgICAgIHJldHVybiB0YXJnZXQ7CiAgICB9CiAgICAvKioKICAgICAqIEdldCB0aGUgbGVuZ3RoIG9mIHRoZSB2ZWN0b3IKICAgICAqLwoKCiAgICBsZW5ndGgoKSB7CiAgICAgIGNvbnN0IHggPSB0aGlzLng7CiAgICAgIGNvbnN0IHkgPSB0aGlzLnk7CiAgICAgIGNvbnN0IHogPSB0aGlzLno7CiAgICAgIHJldHVybiBNYXRoLnNxcnQoeCAqIHggKyB5ICogeSArIHogKiB6KTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IHRoZSBzcXVhcmVkIGxlbmd0aCBvZiB0aGUgdmVjdG9yLgogICAgICovCgoKICAgIGxlbmd0aFNxdWFyZWQoKSB7CiAgICAgIHJldHVybiB0aGlzLmRvdCh0aGlzKTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IGRpc3RhbmNlIGZyb20gdGhpcyBwb2ludCB0byBhbm90aGVyIHBvaW50CiAgICAgKi8KCgogICAgZGlzdGFuY2VUbyhwKSB7CiAgICAgIGNvbnN0IHggPSB0aGlzLng7CiAgICAgIGNvbnN0IHkgPSB0aGlzLnk7CiAgICAgIGNvbnN0IHogPSB0aGlzLno7CiAgICAgIGNvbnN0IHB4ID0gcC54OwogICAgICBjb25zdCBweSA9IHAueTsKICAgICAgY29uc3QgcHogPSBwLno7CiAgICAgIHJldHVybiBNYXRoLnNxcnQoKHB4IC0geCkgKiAocHggLSB4KSArIChweSAtIHkpICogKHB5IC0geSkgKyAocHogLSB6KSAqIChweiAtIHopKTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IHNxdWFyZWQgZGlzdGFuY2UgZnJvbSB0aGlzIHBvaW50IHRvIGFub3RoZXIgcG9pbnQKICAgICAqLwoKCiAgICBkaXN0YW5jZVNxdWFyZWQocCkgewogICAgICBjb25zdCB4ID0gdGhpcy54OwogICAgICBjb25zdCB5ID0gdGhpcy55OwogICAgICBjb25zdCB6ID0gdGhpcy56OwogICAgICBjb25zdCBweCA9IHAueDsKICAgICAgY29uc3QgcHkgPSBwLnk7CiAgICAgIGNvbnN0IHB6ID0gcC56OwogICAgICByZXR1cm4gKHB4IC0geCkgKiAocHggLSB4KSArIChweSAtIHkpICogKHB5IC0geSkgKyAocHogLSB6KSAqIChweiAtIHopOwogICAgfQogICAgLyoqCiAgICAgKiBNdWx0aXBseSBhbGwgdGhlIGNvbXBvbmVudHMgb2YgdGhlIHZlY3RvciB3aXRoIGEgc2NhbGFyLgogICAgICogQHBhcmFtIHRhcmdldCBUaGUgdmVjdG9yIHRvIHNhdmUgdGhlIHJlc3VsdCBpbi4KICAgICAqLwoKCiAgICBzY2FsZShzY2FsYXIsIHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB2b2lkIDApIHsKICAgICAgICB0YXJnZXQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICBjb25zdCB4ID0gdGhpcy54OwogICAgICBjb25zdCB5ID0gdGhpcy55OwogICAgICBjb25zdCB6ID0gdGhpcy56OwogICAgICB0YXJnZXQueCA9IHNjYWxhciAqIHg7CiAgICAgIHRhcmdldC55ID0gc2NhbGFyICogeTsKICAgICAgdGFyZ2V0LnogPSBzY2FsYXIgKiB6OwogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQogICAgLyoqCiAgICAgKiBNdWx0aXBseSB0aGUgdmVjdG9yIHdpdGggYW4gb3RoZXIgdmVjdG9yLCBjb21wb25lbnQtd2lzZS4KICAgICAqIEBwYXJhbSB0YXJnZXQgVGhlIHZlY3RvciB0byBzYXZlIHRoZSByZXN1bHQgaW4uCiAgICAgKi8KCgogICAgdm11bCh2ZWN0b3IsIHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB2b2lkIDApIHsKICAgICAgICB0YXJnZXQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICB0YXJnZXQueCA9IHZlY3Rvci54ICogdGhpcy54OwogICAgICB0YXJnZXQueSA9IHZlY3Rvci55ICogdGhpcy55OwogICAgICB0YXJnZXQueiA9IHZlY3Rvci56ICogdGhpcy56OwogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQogICAgLyoqCiAgICAgKiBTY2FsZSBhIHZlY3RvciBhbmQgYWRkIGl0IHRvIHRoaXMgdmVjdG9yLiBTYXZlIHRoZSByZXN1bHQgaW4gInRhcmdldCIuICh0YXJnZXQgPSB0aGlzICsgdmVjdG9yICogc2NhbGFyKQogICAgICogQHBhcmFtIHRhcmdldCBUaGUgdmVjdG9yIHRvIHNhdmUgdGhlIHJlc3VsdCBpbi4KICAgICAqLwoKCiAgICBhZGRTY2FsZWRWZWN0b3Ioc2NhbGFyLCB2ZWN0b3IsIHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB2b2lkIDApIHsKICAgICAgICB0YXJnZXQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICB0YXJnZXQueCA9IHRoaXMueCArIHNjYWxhciAqIHZlY3Rvci54OwogICAgICB0YXJnZXQueSA9IHRoaXMueSArIHNjYWxhciAqIHZlY3Rvci55OwogICAgICB0YXJnZXQueiA9IHRoaXMueiArIHNjYWxhciAqIHZlY3Rvci56OwogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQogICAgLyoqCiAgICAgKiBDYWxjdWxhdGUgZG90IHByb2R1Y3QKICAgICAqIEBwYXJhbSB2ZWN0b3IKICAgICAqLwoKCiAgICBkb3QodmVjdG9yKSB7CiAgICAgIHJldHVybiB0aGlzLnggKiB2ZWN0b3IueCArIHRoaXMueSAqIHZlY3Rvci55ICsgdGhpcy56ICogdmVjdG9yLno7CiAgICB9CgogICAgaXNaZXJvKCkgewogICAgICByZXR1cm4gdGhpcy54ID09PSAwICYmIHRoaXMueSA9PT0gMCAmJiB0aGlzLnogPT09IDA7CiAgICB9CiAgICAvKioKICAgICAqIE1ha2UgdGhlIHZlY3RvciBwb2ludCBpbiB0aGUgb3Bwb3NpdGUgZGlyZWN0aW9uLgogICAgICogQHBhcmFtIHRhcmdldCBPcHRpb25hbCB0YXJnZXQgdG8gc2F2ZSBpbgogICAgICovCgoKICAgIG5lZ2F0ZSh0YXJnZXQpIHsKICAgICAgaWYgKHRhcmdldCA9PT0gdm9pZCAwKSB7CiAgICAgICAgdGFyZ2V0ID0gbmV3IFZlYzMoKTsKICAgICAgfQoKICAgICAgdGFyZ2V0LnggPSAtdGhpcy54OwogICAgICB0YXJnZXQueSA9IC10aGlzLnk7CiAgICAgIHRhcmdldC56ID0gLXRoaXMuejsKICAgICAgcmV0dXJuIHRhcmdldDsKICAgIH0KICAgIC8qKgogICAgICogQ29tcHV0ZSB0d28gYXJ0aWZpY2lhbCB0YW5nZW50cyB0byB0aGUgdmVjdG9yCiAgICAgKiBAcGFyYW0gdDEgVmVjdG9yIG9iamVjdCB0byBzYXZlIHRoZSBmaXJzdCB0YW5nZW50IGluCiAgICAgKiBAcGFyYW0gdDIgVmVjdG9yIG9iamVjdCB0byBzYXZlIHRoZSBzZWNvbmQgdGFuZ2VudCBpbgogICAgICovCgoKICAgIHRhbmdlbnRzKHQxLCB0MikgewogICAgICBjb25zdCBub3JtID0gdGhpcy5sZW5ndGgoKTsKCiAgICAgIGlmIChub3JtID4gMC4wKSB7CiAgICAgICAgY29uc3QgbiA9IFZlYzNfdGFuZ2VudHNfbjsKICAgICAgICBjb25zdCBpbm9ybSA9IDEgLyBub3JtOwogICAgICAgIG4uc2V0KHRoaXMueCAqIGlub3JtLCB0aGlzLnkgKiBpbm9ybSwgdGhpcy56ICogaW5vcm0pOwogICAgICAgIGNvbnN0IHJhbmRWZWMgPSBWZWMzX3RhbmdlbnRzX3JhbmRWZWM7CgogICAgICAgIGlmIChNYXRoLmFicyhuLngpIDwgMC45KSB7CiAgICAgICAgICByYW5kVmVjLnNldCgxLCAwLCAwKTsKICAgICAgICAgIG4uY3Jvc3MocmFuZFZlYywgdDEpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByYW5kVmVjLnNldCgwLCAxLCAwKTsKICAgICAgICAgIG4uY3Jvc3MocmFuZFZlYywgdDEpOwogICAgICAgIH0KCiAgICAgICAgbi5jcm9zcyh0MSwgdDIpOwogICAgICB9IGVsc2UgewogICAgICAgIC8vIFRoZSBub3JtYWwgbGVuZ3RoIGlzIHplcm8sIG1ha2Ugc29tZXRoaW5nIHVwCiAgICAgICAgdDEuc2V0KDEsIDAsIDApOwogICAgICAgIHQyLnNldCgwLCAxLCAwKTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBDb252ZXJ0cyB0byBhIG1vcmUgcmVhZGFibGUgZm9ybWF0CiAgICAgKi8KCgogICAgdG9TdHJpbmcoKSB7CiAgICAgIHJldHVybiBgJHt0aGlzLnh9LCR7dGhpcy55fSwke3RoaXMuen1gOwogICAgfQogICAgLyoqCiAgICAgKiBDb252ZXJ0cyB0byBhbiBhcnJheQogICAgICovCgoKICAgIHRvQXJyYXkoKSB7CiAgICAgIHJldHVybiBbdGhpcy54LCB0aGlzLnksIHRoaXMuel07CiAgICB9CiAgICAvKioKICAgICAqIENvcGllcyB2YWx1ZSBvZiBzb3VyY2UgdG8gdGhpcyB2ZWN0b3IuCiAgICAgKi8KCgogICAgY29weSh2ZWN0b3IpIHsKICAgICAgdGhpcy54ID0gdmVjdG9yLng7CiAgICAgIHRoaXMueSA9IHZlY3Rvci55OwogICAgICB0aGlzLnogPSB2ZWN0b3IuejsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICAvKioKICAgICAqIERvIGEgbGluZWFyIGludGVycG9sYXRpb24gYmV0d2VlbiB0d28gdmVjdG9ycwogICAgICogQHBhcmFtIHQgQSBudW1iZXIgYmV0d2VlbiAwIGFuZCAxLiAwIHdpbGwgbWFrZSB0aGlzIGZ1bmN0aW9uIHJldHVybiB1LCBhbmQgMSB3aWxsIG1ha2UgaXQgcmV0dXJuIHYuIE51bWJlcnMgaW4gYmV0d2VlbiB3aWxsIGdlbmVyYXRlIGEgdmVjdG9yIGluIGJldHdlZW4gdGhlbS4KICAgICAqLwoKCiAgICBsZXJwKHZlY3RvciwgdCwgdGFyZ2V0KSB7CiAgICAgIGNvbnN0IHggPSB0aGlzLng7CiAgICAgIGNvbnN0IHkgPSB0aGlzLnk7CiAgICAgIGNvbnN0IHogPSB0aGlzLno7CiAgICAgIHRhcmdldC54ID0geCArICh2ZWN0b3IueCAtIHgpICogdDsKICAgICAgdGFyZ2V0LnkgPSB5ICsgKHZlY3Rvci55IC0geSkgKiB0OwogICAgICB0YXJnZXQueiA9IHogKyAodmVjdG9yLnogLSB6KSAqIHQ7CiAgICB9CiAgICAvKioKICAgICAqIENoZWNrIGlmIGEgdmVjdG9yIGVxdWFscyBpcyBhbG1vc3QgZXF1YWwgdG8gYW5vdGhlciBvbmUuCiAgICAgKi8KCgogICAgYWxtb3N0RXF1YWxzKHZlY3RvciwgcHJlY2lzaW9uKSB7CiAgICAgIGlmIChwcmVjaXNpb24gPT09IHZvaWQgMCkgewogICAgICAgIHByZWNpc2lvbiA9IDFlLTY7CiAgICAgIH0KCiAgICAgIGlmIChNYXRoLmFicyh0aGlzLnggLSB2ZWN0b3IueCkgPiBwcmVjaXNpb24gfHwgTWF0aC5hYnModGhpcy55IC0gdmVjdG9yLnkpID4gcHJlY2lzaW9uIHx8IE1hdGguYWJzKHRoaXMueiAtIHZlY3Rvci56KSA+IHByZWNpc2lvbikgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgICAvKioKICAgICAqIENoZWNrIGlmIGEgdmVjdG9yIGlzIGFsbW9zdCB6ZXJvCiAgICAgKi8KCgogICAgYWxtb3N0WmVybyhwcmVjaXNpb24pIHsKICAgICAgaWYgKHByZWNpc2lvbiA9PT0gdm9pZCAwKSB7CiAgICAgICAgcHJlY2lzaW9uID0gMWUtNjsKICAgICAgfQoKICAgICAgaWYgKE1hdGguYWJzKHRoaXMueCkgPiBwcmVjaXNpb24gfHwgTWF0aC5hYnModGhpcy55KSA+IHByZWNpc2lvbiB8fCBNYXRoLmFicyh0aGlzLnopID4gcHJlY2lzaW9uKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CgogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KICAgIC8qKgogICAgICogQ2hlY2sgaWYgdGhlIHZlY3RvciBpcyBhbnRpLXBhcmFsbGVsIHRvIGFub3RoZXIgdmVjdG9yLgogICAgICogQHBhcmFtIHByZWNpc2lvbiBTZXQgdG8gemVybyBmb3IgZXhhY3QgY29tcGFyaXNvbnMKICAgICAqLwoKCiAgICBpc0FudGlwYXJhbGxlbFRvKHZlY3RvciwgcHJlY2lzaW9uKSB7CiAgICAgIHRoaXMubmVnYXRlKGFudGlwX25lZyk7CiAgICAgIHJldHVybiBhbnRpcF9uZWcuYWxtb3N0RXF1YWxzKHZlY3RvciwgcHJlY2lzaW9uKTsKICAgIH0KICAgIC8qKgogICAgICogQ2xvbmUgdGhlIHZlY3RvcgogICAgICovCgoKICAgIGNsb25lKCkgewogICAgICByZXR1cm4gbmV3IFZlYzModGhpcy54LCB0aGlzLnksIHRoaXMueik7CiAgICB9CgogIH0KICBWZWMzLlpFUk8gPSBuZXcgVmVjMygwLCAwLCAwKTsKICBWZWMzLlVOSVRfWCA9IG5ldyBWZWMzKDEsIDAsIDApOwogIFZlYzMuVU5JVF9ZID0gbmV3IFZlYzMoMCwgMSwgMCk7CiAgVmVjMy5VTklUX1ogPSBuZXcgVmVjMygwLCAwLCAxKTsKICBjb25zdCBWZWMzX3RhbmdlbnRzX24gPSBuZXcgVmVjMygpOwogIGNvbnN0IFZlYzNfdGFuZ2VudHNfcmFuZFZlYyA9IG5ldyBWZWMzKCk7CiAgY29uc3QgYW50aXBfbmVnID0gbmV3IFZlYzMoKTsKCiAgLyoqCiAgICogQXhpcyBhbGlnbmVkIGJvdW5kaW5nIGJveCBjbGFzcy4KICAgKi8KICBjbGFzcyBBQUJCIHsKICAgIC8qKgogICAgICogVGhlIGxvd2VyIGJvdW5kIG9mIHRoZSBib3VuZGluZyBib3gKICAgICAqLwoKICAgIC8qKgogICAgICogVGhlIHVwcGVyIGJvdW5kIG9mIHRoZSBib3VuZGluZyBib3gKICAgICAqLwogICAgY29uc3RydWN0b3Iob3B0aW9ucykgewogICAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7CiAgICAgICAgb3B0aW9ucyA9IHt9OwogICAgICB9CgogICAgICB0aGlzLmxvd2VyQm91bmQgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLnVwcGVyQm91bmQgPSBuZXcgVmVjMygpOwoKICAgICAgaWYgKG9wdGlvbnMubG93ZXJCb3VuZCkgewogICAgICAgIHRoaXMubG93ZXJCb3VuZC5jb3B5KG9wdGlvbnMubG93ZXJCb3VuZCk7CiAgICAgIH0KCiAgICAgIGlmIChvcHRpb25zLnVwcGVyQm91bmQpIHsKICAgICAgICB0aGlzLnVwcGVyQm91bmQuY29weShvcHRpb25zLnVwcGVyQm91bmQpOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIFNldCB0aGUgQUFCQiBib3VuZHMgZnJvbSBhIHNldCBvZiBwb2ludHMuCiAgICAgKiBAcGFyYW0gcG9pbnRzIEFuIGFycmF5IG9mIFZlYzMncy4KICAgICAqIEByZXR1cm4gVGhlIHNlbGYgb2JqZWN0CiAgICAgKi8KCgogICAgc2V0RnJvbVBvaW50cyhwb2ludHMsIHBvc2l0aW9uLCBxdWF0ZXJuaW9uLCBza2luU2l6ZSkgewogICAgICBjb25zdCBsID0gdGhpcy5sb3dlckJvdW5kOwogICAgICBjb25zdCB1ID0gdGhpcy51cHBlckJvdW5kOwogICAgICBjb25zdCBxID0gcXVhdGVybmlvbjsgLy8gU2V0IHRvIHRoZSBmaXJzdCBwb2ludAoKICAgICAgbC5jb3B5KHBvaW50c1swXSk7CgogICAgICBpZiAocSkgewogICAgICAgIHEudm11bHQobCwgbCk7CiAgICAgIH0KCiAgICAgIHUuY29weShsKTsKCiAgICAgIGZvciAobGV0IGkgPSAxOyBpIDwgcG9pbnRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgbGV0IHAgPSBwb2ludHNbaV07CgogICAgICAgIGlmIChxKSB7CiAgICAgICAgICBxLnZtdWx0KHAsIHRtcCQxKTsKICAgICAgICAgIHAgPSB0bXAkMTsKICAgICAgICB9CgogICAgICAgIGlmIChwLnggPiB1LngpIHsKICAgICAgICAgIHUueCA9IHAueDsKICAgICAgICB9CgogICAgICAgIGlmIChwLnggPCBsLngpIHsKICAgICAgICAgIGwueCA9IHAueDsKICAgICAgICB9CgogICAgICAgIGlmIChwLnkgPiB1LnkpIHsKICAgICAgICAgIHUueSA9IHAueTsKICAgICAgICB9CgogICAgICAgIGlmIChwLnkgPCBsLnkpIHsKICAgICAgICAgIGwueSA9IHAueTsKICAgICAgICB9CgogICAgICAgIGlmIChwLnogPiB1LnopIHsKICAgICAgICAgIHUueiA9IHAuejsKICAgICAgICB9CgogICAgICAgIGlmIChwLnogPCBsLnopIHsKICAgICAgICAgIGwueiA9IHAuejsKICAgICAgICB9CiAgICAgIH0gLy8gQWRkIG9mZnNldAoKCiAgICAgIGlmIChwb3NpdGlvbikgewogICAgICAgIHBvc2l0aW9uLnZhZGQobCwgbCk7CiAgICAgICAgcG9zaXRpb24udmFkZCh1LCB1KTsKICAgICAgfQoKICAgICAgaWYgKHNraW5TaXplKSB7CiAgICAgICAgbC54IC09IHNraW5TaXplOwogICAgICAgIGwueSAtPSBza2luU2l6ZTsKICAgICAgICBsLnogLT0gc2tpblNpemU7CiAgICAgICAgdS54ICs9IHNraW5TaXplOwogICAgICAgIHUueSArPSBza2luU2l6ZTsKICAgICAgICB1LnogKz0gc2tpblNpemU7CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzOwogICAgfQogICAgLyoqCiAgICAgKiBDb3B5IGJvdW5kcyBmcm9tIGFuIEFBQkIgdG8gdGhpcyBBQUJCCiAgICAgKiBAcGFyYW0gYWFiYiBTb3VyY2UgdG8gY29weSBmcm9tCiAgICAgKiBAcmV0dXJuIFRoZSB0aGlzIG9iamVjdCwgZm9yIGNoYWluYWJpbGl0eQogICAgICovCgoKICAgIGNvcHkoYWFiYikgewogICAgICB0aGlzLmxvd2VyQm91bmQuY29weShhYWJiLmxvd2VyQm91bmQpOwogICAgICB0aGlzLnVwcGVyQm91bmQuY29weShhYWJiLnVwcGVyQm91bmQpOwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICAgIC8qKgogICAgICogQ2xvbmUgYW4gQUFCQgogICAgICovCgoKICAgIGNsb25lKCkgewogICAgICByZXR1cm4gbmV3IEFBQkIoKS5jb3B5KHRoaXMpOwogICAgfQogICAgLyoqCiAgICAgKiBFeHRlbmQgdGhpcyBBQUJCIHNvIHRoYXQgaXQgY292ZXJzIHRoZSBnaXZlbiBBQUJCIHRvby4KICAgICAqLwoKCiAgICBleHRlbmQoYWFiYikgewogICAgICB0aGlzLmxvd2VyQm91bmQueCA9IE1hdGgubWluKHRoaXMubG93ZXJCb3VuZC54LCBhYWJiLmxvd2VyQm91bmQueCk7CiAgICAgIHRoaXMudXBwZXJCb3VuZC54ID0gTWF0aC5tYXgodGhpcy51cHBlckJvdW5kLngsIGFhYmIudXBwZXJCb3VuZC54KTsKICAgICAgdGhpcy5sb3dlckJvdW5kLnkgPSBNYXRoLm1pbih0aGlzLmxvd2VyQm91bmQueSwgYWFiYi5sb3dlckJvdW5kLnkpOwogICAgICB0aGlzLnVwcGVyQm91bmQueSA9IE1hdGgubWF4KHRoaXMudXBwZXJCb3VuZC55LCBhYWJiLnVwcGVyQm91bmQueSk7CiAgICAgIHRoaXMubG93ZXJCb3VuZC56ID0gTWF0aC5taW4odGhpcy5sb3dlckJvdW5kLnosIGFhYmIubG93ZXJCb3VuZC56KTsKICAgICAgdGhpcy51cHBlckJvdW5kLnogPSBNYXRoLm1heCh0aGlzLnVwcGVyQm91bmQueiwgYWFiYi51cHBlckJvdW5kLnopOwogICAgfQogICAgLyoqCiAgICAgKiBSZXR1cm5zIHRydWUgaWYgdGhlIGdpdmVuIEFBQkIgb3ZlcmxhcHMgdGhpcyBBQUJCLgogICAgICovCgoKICAgIG92ZXJsYXBzKGFhYmIpIHsKICAgICAgY29uc3QgbDEgPSB0aGlzLmxvd2VyQm91bmQ7CiAgICAgIGNvbnN0IHUxID0gdGhpcy51cHBlckJvdW5kOwogICAgICBjb25zdCBsMiA9IGFhYmIubG93ZXJCb3VuZDsKICAgICAgY29uc3QgdTIgPSBhYWJiLnVwcGVyQm91bmQ7IC8vICAgICAgbDIgICAgICAgIHUyCiAgICAgIC8vICAgICAgfC0tLS0tLS0tLXwKICAgICAgLy8gfC0tLS0tLS0tfAogICAgICAvLyBsMSAgICAgICB1MQoKICAgICAgY29uc3Qgb3ZlcmxhcHNYID0gbDIueCA8PSB1MS54ICYmIHUxLnggPD0gdTIueCB8fCBsMS54IDw9IHUyLnggJiYgdTIueCA8PSB1MS54OwogICAgICBjb25zdCBvdmVybGFwc1kgPSBsMi55IDw9IHUxLnkgJiYgdTEueSA8PSB1Mi55IHx8IGwxLnkgPD0gdTIueSAmJiB1Mi55IDw9IHUxLnk7CiAgICAgIGNvbnN0IG92ZXJsYXBzWiA9IGwyLnogPD0gdTEueiAmJiB1MS56IDw9IHUyLnogfHwgbDEueiA8PSB1Mi56ICYmIHUyLnogPD0gdTEuejsKICAgICAgcmV0dXJuIG92ZXJsYXBzWCAmJiBvdmVybGFwc1kgJiYgb3ZlcmxhcHNaOwogICAgfSAvLyBNb3N0bHkgZm9yIGRlYnVnZ2luZwoKCiAgICB2b2x1bWUoKSB7CiAgICAgIGNvbnN0IGwgPSB0aGlzLmxvd2VyQm91bmQ7CiAgICAgIGNvbnN0IHUgPSB0aGlzLnVwcGVyQm91bmQ7CiAgICAgIHJldHVybiAodS54IC0gbC54KSAqICh1LnkgLSBsLnkpICogKHUueiAtIGwueik7CiAgICB9CiAgICAvKioKICAgICAqIFJldHVybnMgdHJ1ZSBpZiB0aGUgZ2l2ZW4gQUFCQiBpcyBmdWxseSBjb250YWluZWQgaW4gdGhpcyBBQUJCLgogICAgICovCgoKICAgIGNvbnRhaW5zKGFhYmIpIHsKICAgICAgY29uc3QgbDEgPSB0aGlzLmxvd2VyQm91bmQ7CiAgICAgIGNvbnN0IHUxID0gdGhpcy51cHBlckJvdW5kOwogICAgICBjb25zdCBsMiA9IGFhYmIubG93ZXJCb3VuZDsKICAgICAgY29uc3QgdTIgPSBhYWJiLnVwcGVyQm91bmQ7IC8vICAgICAgbDIgICAgICAgIHUyCiAgICAgIC8vICAgICAgfC0tLS0tLS0tLXwKICAgICAgLy8gfC0tLS0tLS0tLS0tLS0tLXwKICAgICAgLy8gbDEgICAgICAgICAgICAgIHUxCgogICAgICByZXR1cm4gbDEueCA8PSBsMi54ICYmIHUxLnggPj0gdTIueCAmJiBsMS55IDw9IGwyLnkgJiYgdTEueSA+PSB1Mi55ICYmIGwxLnogPD0gbDIueiAmJiB1MS56ID49IHUyLno7CiAgICB9CgogICAgZ2V0Q29ybmVycyhhLCBiLCBjLCBkLCBlLCBmLCBnLCBoKSB7CiAgICAgIGNvbnN0IGwgPSB0aGlzLmxvd2VyQm91bmQ7CiAgICAgIGNvbnN0IHUgPSB0aGlzLnVwcGVyQm91bmQ7CiAgICAgIGEuY29weShsKTsKICAgICAgYi5zZXQodS54LCBsLnksIGwueik7CiAgICAgIGMuc2V0KHUueCwgdS55LCBsLnopOwogICAgICBkLnNldChsLngsIHUueSwgdS56KTsKICAgICAgZS5zZXQodS54LCBsLnksIHUueik7CiAgICAgIGYuc2V0KGwueCwgdS55LCBsLnopOwogICAgICBnLnNldChsLngsIGwueSwgdS56KTsKICAgICAgaC5jb3B5KHUpOwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgdGhlIHJlcHJlc2VudGF0aW9uIG9mIGFuIEFBQkIgaW4gYW5vdGhlciBmcmFtZS4KICAgICAqIEByZXR1cm4gVGhlICJ0YXJnZXQiIEFBQkIgb2JqZWN0LgogICAgICovCgoKICAgIHRvTG9jYWxGcmFtZShmcmFtZSwgdGFyZ2V0KSB7CiAgICAgIGNvbnN0IGNvcm5lcnMgPSB0cmFuc2Zvcm1JbnRvRnJhbWVfY29ybmVyczsKICAgICAgY29uc3QgYSA9IGNvcm5lcnNbMF07CiAgICAgIGNvbnN0IGIgPSBjb3JuZXJzWzFdOwogICAgICBjb25zdCBjID0gY29ybmVyc1syXTsKICAgICAgY29uc3QgZCA9IGNvcm5lcnNbM107CiAgICAgIGNvbnN0IGUgPSBjb3JuZXJzWzRdOwogICAgICBjb25zdCBmID0gY29ybmVyc1s1XTsKICAgICAgY29uc3QgZyA9IGNvcm5lcnNbNl07CiAgICAgIGNvbnN0IGggPSBjb3JuZXJzWzddOyAvLyBHZXQgY29ybmVycyBpbiBjdXJyZW50IGZyYW1lCgogICAgICB0aGlzLmdldENvcm5lcnMoYSwgYiwgYywgZCwgZSwgZiwgZywgaCk7IC8vIFRyYW5zZm9ybSB0aGVtIHRvIG5ldyBsb2NhbCBmcmFtZQoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IDg7IGkrKykgewogICAgICAgIGNvbnN0IGNvcm5lciA9IGNvcm5lcnNbaV07CiAgICAgICAgZnJhbWUucG9pbnRUb0xvY2FsKGNvcm5lciwgY29ybmVyKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRhcmdldC5zZXRGcm9tUG9pbnRzKGNvcm5lcnMpOwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgdGhlIHJlcHJlc2VudGF0aW9uIG9mIGFuIEFBQkIgaW4gdGhlIGdsb2JhbCBmcmFtZS4KICAgICAqIEByZXR1cm4gVGhlICJ0YXJnZXQiIEFBQkIgb2JqZWN0LgogICAgICovCgoKICAgIHRvV29ybGRGcmFtZShmcmFtZSwgdGFyZ2V0KSB7CiAgICAgIGNvbnN0IGNvcm5lcnMgPSB0cmFuc2Zvcm1JbnRvRnJhbWVfY29ybmVyczsKICAgICAgY29uc3QgYSA9IGNvcm5lcnNbMF07CiAgICAgIGNvbnN0IGIgPSBjb3JuZXJzWzFdOwogICAgICBjb25zdCBjID0gY29ybmVyc1syXTsKICAgICAgY29uc3QgZCA9IGNvcm5lcnNbM107CiAgICAgIGNvbnN0IGUgPSBjb3JuZXJzWzRdOwogICAgICBjb25zdCBmID0gY29ybmVyc1s1XTsKICAgICAgY29uc3QgZyA9IGNvcm5lcnNbNl07CiAgICAgIGNvbnN0IGggPSBjb3JuZXJzWzddOyAvLyBHZXQgY29ybmVycyBpbiBjdXJyZW50IGZyYW1lCgogICAgICB0aGlzLmdldENvcm5lcnMoYSwgYiwgYywgZCwgZSwgZiwgZywgaCk7IC8vIFRyYW5zZm9ybSB0aGVtIHRvIG5ldyBsb2NhbCBmcmFtZQoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IDg7IGkrKykgewogICAgICAgIGNvbnN0IGNvcm5lciA9IGNvcm5lcnNbaV07CiAgICAgICAgZnJhbWUucG9pbnRUb1dvcmxkKGNvcm5lciwgY29ybmVyKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRhcmdldC5zZXRGcm9tUG9pbnRzKGNvcm5lcnMpOwogICAgfQogICAgLyoqCiAgICAgKiBDaGVjayBpZiB0aGUgQUFCQiBpcyBoaXQgYnkgYSByYXkuCiAgICAgKi8KCgogICAgb3ZlcmxhcHNSYXkocmF5KSB7CiAgICAgIGNvbnN0IHsKICAgICAgICBkaXJlY3Rpb24sCiAgICAgICAgZnJvbQogICAgICB9ID0gcmF5OyAvLyBjb25zdCB0ID0gMAogICAgICAvLyByYXkuZGlyZWN0aW9uIGlzIHVuaXQgZGlyZWN0aW9uIHZlY3RvciBvZiByYXkKCiAgICAgIGNvbnN0IGRpckZyYWNYID0gMSAvIGRpcmVjdGlvbi54OwogICAgICBjb25zdCBkaXJGcmFjWSA9IDEgLyBkaXJlY3Rpb24ueTsKICAgICAgY29uc3QgZGlyRnJhY1ogPSAxIC8gZGlyZWN0aW9uLno7IC8vIHRoaXMubG93ZXJCb3VuZCBpcyB0aGUgY29ybmVyIG9mIEFBQkIgd2l0aCBtaW5pbWFsIGNvb3JkaW5hdGVzIC0gbGVmdCBib3R0b20sIHJ0IGlzIG1heGltYWwgY29ybmVyCgogICAgICBjb25zdCB0MSA9ICh0aGlzLmxvd2VyQm91bmQueCAtIGZyb20ueCkgKiBkaXJGcmFjWDsKICAgICAgY29uc3QgdDIgPSAodGhpcy51cHBlckJvdW5kLnggLSBmcm9tLngpICogZGlyRnJhY1g7CiAgICAgIGNvbnN0IHQzID0gKHRoaXMubG93ZXJCb3VuZC55IC0gZnJvbS55KSAqIGRpckZyYWNZOwogICAgICBjb25zdCB0NCA9ICh0aGlzLnVwcGVyQm91bmQueSAtIGZyb20ueSkgKiBkaXJGcmFjWTsKICAgICAgY29uc3QgdDUgPSAodGhpcy5sb3dlckJvdW5kLnogLSBmcm9tLnopICogZGlyRnJhY1o7CiAgICAgIGNvbnN0IHQ2ID0gKHRoaXMudXBwZXJCb3VuZC56IC0gZnJvbS56KSAqIGRpckZyYWNaOyAvLyBjb25zdCB0bWluID0gTWF0aC5tYXgoTWF0aC5tYXgoTWF0aC5taW4odDEsIHQyKSwgTWF0aC5taW4odDMsIHQ0KSkpOwogICAgICAvLyBjb25zdCB0bWF4ID0gTWF0aC5taW4oTWF0aC5taW4oTWF0aC5tYXgodDEsIHQyKSwgTWF0aC5tYXgodDMsIHQ0KSkpOwoKICAgICAgY29uc3QgdG1pbiA9IE1hdGgubWF4KE1hdGgubWF4KE1hdGgubWluKHQxLCB0MiksIE1hdGgubWluKHQzLCB0NCkpLCBNYXRoLm1pbih0NSwgdDYpKTsKICAgICAgY29uc3QgdG1heCA9IE1hdGgubWluKE1hdGgubWluKE1hdGgubWF4KHQxLCB0MiksIE1hdGgubWF4KHQzLCB0NCkpLCBNYXRoLm1heCh0NSwgdDYpKTsgLy8gaWYgdG1heCA8IDAsIHJheSAobGluZSkgaXMgaW50ZXJzZWN0aW5nIEFBQkIsIGJ1dCB3aG9sZSBBQUJCIGlzIGJlaGluZyB1cwoKICAgICAgaWYgKHRtYXggPCAwKSB7CiAgICAgICAgLy90ID0gdG1heDsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0gLy8gaWYgdG1pbiA+IHRtYXgsIHJheSBkb2Vzbid0IGludGVyc2VjdCBBQUJCCgoKICAgICAgaWYgKHRtaW4gPiB0bWF4KSB7CiAgICAgICAgLy90ID0gdG1heDsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICB9CiAgY29uc3QgdG1wJDEgPSBuZXcgVmVjMygpOwogIGNvbnN0IHRyYW5zZm9ybUludG9GcmFtZV9jb3JuZXJzID0gW25ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKCldOwoKICAvKioKICAgKiBDb2xsaXNpb24gIm1hdHJpeCIuCiAgICogSXQncyBhY3R1YWxseSBhIHRyaWFuZ3VsYXItc2hhcGVkIGFycmF5IG9mIHdoZXRoZXIgdHdvIGJvZGllcyBhcmUgdG91Y2hpbmcgdGhpcyBzdGVwLCBmb3IgcmVmZXJlbmNlIG5leHQgc3RlcAogICAqLwogIGNsYXNzIEFycmF5Q29sbGlzaW9uTWF0cml4IHsKICAgIC8qKgogICAgICogVGhlIG1hdHJpeCBzdG9yYWdlLgogICAgICovCiAgICBjb25zdHJ1Y3RvcigpIHsKICAgICAgdGhpcy5tYXRyaXggPSBbXTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IGFuIGVsZW1lbnQKICAgICAqLwoKCiAgICBnZXQoYmksIGJqKSB7CiAgICAgIGxldCB7CiAgICAgICAgaW5kZXg6IGkKICAgICAgfSA9IGJpOwogICAgICBsZXQgewogICAgICAgIGluZGV4OiBqCiAgICAgIH0gPSBiajsKCiAgICAgIGlmIChqID4gaSkgewogICAgICAgIGNvbnN0IHRlbXAgPSBqOwogICAgICAgIGogPSBpOwogICAgICAgIGkgPSB0ZW1wOwogICAgICB9CgogICAgICByZXR1cm4gdGhpcy5tYXRyaXhbKGkgKiAoaSArIDEpID4+IDEpICsgaiAtIDFdOwogICAgfQogICAgLyoqCiAgICAgKiBTZXQgYW4gZWxlbWVudAogICAgICovCgoKICAgIHNldChiaSwgYmosIHZhbHVlKSB7CiAgICAgIGxldCB7CiAgICAgICAgaW5kZXg6IGkKICAgICAgfSA9IGJpOwogICAgICBsZXQgewogICAgICAgIGluZGV4OiBqCiAgICAgIH0gPSBiajsKCiAgICAgIGlmIChqID4gaSkgewogICAgICAgIGNvbnN0IHRlbXAgPSBqOwogICAgICAgIGogPSBpOwogICAgICAgIGkgPSB0ZW1wOwogICAgICB9CgogICAgICB0aGlzLm1hdHJpeFsoaSAqIChpICsgMSkgPj4gMSkgKyBqIC0gMV0gPSB2YWx1ZSA/IDEgOiAwOwogICAgfQogICAgLyoqCiAgICAgKiBTZXRzIGFsbCBlbGVtZW50cyB0byB6ZXJvCiAgICAgKi8KCgogICAgcmVzZXQoKSB7CiAgICAgIGZvciAobGV0IGkgPSAwLCBsID0gdGhpcy5tYXRyaXgubGVuZ3RoOyBpICE9PSBsOyBpKyspIHsKICAgICAgICB0aGlzLm1hdHJpeFtpXSA9IDA7CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogU2V0cyB0aGUgbWF4IG51bWJlciBvZiBvYmplY3RzCiAgICAgKi8KCgogICAgc2V0TnVtT2JqZWN0cyhuKSB7CiAgICAgIHRoaXMubWF0cml4Lmxlbmd0aCA9IG4gKiAobiAtIDEpID4+IDE7CiAgICB9CgogIH0KCiAgLyoqCiAgICogQmFzZSBjbGFzcyBmb3Igb2JqZWN0cyB0aGF0IGRpc3BhdGNoZXMgZXZlbnRzLgogICAqLwogIGNsYXNzIEV2ZW50VGFyZ2V0IHsKICAgIC8qKgogICAgICogQWRkIGFuIGV2ZW50IGxpc3RlbmVyCiAgICAgKiBAcmV0dXJuIFRoZSBzZWxmIG9iamVjdCwgZm9yIGNoYWluYWJpbGl0eS4KICAgICAqLwogICAgYWRkRXZlbnRMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lcikgewogICAgICBpZiAodGhpcy5fbGlzdGVuZXJzID09PSB1bmRlZmluZWQpIHsKICAgICAgICB0aGlzLl9saXN0ZW5lcnMgPSB7fTsKICAgICAgfQoKICAgICAgY29uc3QgbGlzdGVuZXJzID0gdGhpcy5fbGlzdGVuZXJzOwoKICAgICAgaWYgKGxpc3RlbmVyc1t0eXBlXSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgbGlzdGVuZXJzW3R5cGVdID0gW107CiAgICAgIH0KCiAgICAgIGlmICghbGlzdGVuZXJzW3R5cGVdLmluY2x1ZGVzKGxpc3RlbmVyKSkgewogICAgICAgIGxpc3RlbmVyc1t0eXBlXS5wdXNoKGxpc3RlbmVyKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICAvKioKICAgICAqIENoZWNrIGlmIGFuIGV2ZW50IGxpc3RlbmVyIGlzIGFkZGVkCiAgICAgKi8KCgogICAgaGFzRXZlbnRMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lcikgewogICAgICBpZiAodGhpcy5fbGlzdGVuZXJzID09PSB1bmRlZmluZWQpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIGNvbnN0IGxpc3RlbmVycyA9IHRoaXMuX2xpc3RlbmVyczsKCiAgICAgIGlmIChsaXN0ZW5lcnNbdHlwZV0gIT09IHVuZGVmaW5lZCAmJiBsaXN0ZW5lcnNbdHlwZV0uaW5jbHVkZXMobGlzdGVuZXIpKSB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KCiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICAgIC8qKgogICAgICogQ2hlY2sgaWYgYW55IGV2ZW50IGxpc3RlbmVyIG9mIHRoZSBnaXZlbiB0eXBlIGlzIGFkZGVkCiAgICAgKi8KCgogICAgaGFzQW55RXZlbnRMaXN0ZW5lcih0eXBlKSB7CiAgICAgIGlmICh0aGlzLl9saXN0ZW5lcnMgPT09IHVuZGVmaW5lZCkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQoKICAgICAgY29uc3QgbGlzdGVuZXJzID0gdGhpcy5fbGlzdGVuZXJzOwogICAgICByZXR1cm4gbGlzdGVuZXJzW3R5cGVdICE9PSB1bmRlZmluZWQ7CiAgICB9CiAgICAvKioKICAgICAqIFJlbW92ZSBhbiBldmVudCBsaXN0ZW5lcgogICAgICogQHJldHVybiBUaGUgc2VsZiBvYmplY3QsIGZvciBjaGFpbmFiaWxpdHkuCiAgICAgKi8KCgogICAgcmVtb3ZlRXZlbnRMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lcikgewogICAgICBpZiAodGhpcy5fbGlzdGVuZXJzID09PSB1bmRlZmluZWQpIHsKICAgICAgICByZXR1cm4gdGhpczsKICAgICAgfQoKICAgICAgY29uc3QgbGlzdGVuZXJzID0gdGhpcy5fbGlzdGVuZXJzOwoKICAgICAgaWYgKGxpc3RlbmVyc1t0eXBlXSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgIH0KCiAgICAgIGNvbnN0IGluZGV4ID0gbGlzdGVuZXJzW3R5cGVdLmluZGV4T2YobGlzdGVuZXIpOwoKICAgICAgaWYgKGluZGV4ICE9PSAtMSkgewogICAgICAgIGxpc3RlbmVyc1t0eXBlXS5zcGxpY2UoaW5kZXgsIDEpOwogICAgICB9CgogICAgICByZXR1cm4gdGhpczsKICAgIH0KICAgIC8qKgogICAgICogRW1pdCBhbiBldmVudC4KICAgICAqIEByZXR1cm4gVGhlIHNlbGYgb2JqZWN0LCBmb3IgY2hhaW5hYmlsaXR5LgogICAgICovCgoKICAgIGRpc3BhdGNoRXZlbnQoZXZlbnQpIHsKICAgICAgaWYgKHRoaXMuX2xpc3RlbmVycyA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgIH0KCiAgICAgIGNvbnN0IGxpc3RlbmVycyA9IHRoaXMuX2xpc3RlbmVyczsKICAgICAgY29uc3QgbGlzdGVuZXJBcnJheSA9IGxpc3RlbmVyc1tldmVudC50eXBlXTsKCiAgICAgIGlmIChsaXN0ZW5lckFycmF5ICE9PSB1bmRlZmluZWQpIHsKICAgICAgICBldmVudC50YXJnZXQgPSB0aGlzOwoKICAgICAgICBmb3IgKGxldCBpID0gMCwgbCA9IGxpc3RlbmVyQXJyYXkubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgICAgICBsaXN0ZW5lckFycmF5W2ldLmNhbGwodGhpcywgZXZlbnQpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CgogIH0KCiAgLyoqCiAgICogQSBRdWF0ZXJuaW9uIGRlc2NyaWJlcyBhIHJvdGF0aW9uIGluIDNEIHNwYWNlLiBUaGUgUXVhdGVybmlvbiBpcyBtYXRoZW1hdGljYWxseSBkZWZpbmVkIGFzIFEgPSB4KmkgKyB5KmogKyB6KmsgKyB3LCB3aGVyZSAoaSxqLGspIGFyZSBpbWFnaW5hcnkgYmFzaXMgdmVjdG9ycy4gKHgseSx6KSBjYW4gYmUgc2VlbiBhcyBhIHZlY3RvciByZWxhdGVkIHRvIHRoZSBheGlzIG9mIHJvdGF0aW9uLCB3aGlsZSB0aGUgcmVhbCBtdWx0aXBsaWVyLCB3LCBpcyByZWxhdGVkIHRvIHRoZSBhbW91bnQgb2Ygcm90YXRpb24uCiAgICogQHBhcmFtIHggTXVsdGlwbGllciBvZiB0aGUgaW1hZ2luYXJ5IGJhc2lzIHZlY3RvciBpLgogICAqIEBwYXJhbSB5IE11bHRpcGxpZXIgb2YgdGhlIGltYWdpbmFyeSBiYXNpcyB2ZWN0b3Igai4KICAgKiBAcGFyYW0geiBNdWx0aXBsaWVyIG9mIHRoZSBpbWFnaW5hcnkgYmFzaXMgdmVjdG9yIGsuCiAgICogQHBhcmFtIHcgTXVsdGlwbGllciBvZiB0aGUgcmVhbCBwYXJ0LgogICAqIEBzZWUgaHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9RdWF0ZXJuaW9uCiAgICovCgogIGNsYXNzIFF1YXRlcm5pb24gewogICAgY29uc3RydWN0b3IoeCwgeSwgeiwgdykgewogICAgICBpZiAoeCA9PT0gdm9pZCAwKSB7CiAgICAgICAgeCA9IDA7CiAgICAgIH0KCiAgICAgIGlmICh5ID09PSB2b2lkIDApIHsKICAgICAgICB5ID0gMDsKICAgICAgfQoKICAgICAgaWYgKHogPT09IHZvaWQgMCkgewogICAgICAgIHogPSAwOwogICAgICB9CgogICAgICBpZiAodyA9PT0gdm9pZCAwKSB7CiAgICAgICAgdyA9IDE7CiAgICAgIH0KCiAgICAgIHRoaXMueCA9IHg7CiAgICAgIHRoaXMueSA9IHk7CiAgICAgIHRoaXMueiA9IHo7CiAgICAgIHRoaXMudyA9IHc7CiAgICB9CiAgICAvKioKICAgICAqIFNldCB0aGUgdmFsdWUgb2YgdGhlIHF1YXRlcm5pb24uCiAgICAgKi8KCgogICAgc2V0KHgsIHksIHosIHcpIHsKICAgICAgdGhpcy54ID0geDsKICAgICAgdGhpcy55ID0geTsKICAgICAgdGhpcy56ID0gejsKICAgICAgdGhpcy53ID0gdzsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICAvKioKICAgICAqIENvbnZlcnQgdG8gYSByZWFkYWJsZSBmb3JtYXQKICAgICAqIEByZXR1cm4gIngseSx6LHciCiAgICAgKi8KCgogICAgdG9TdHJpbmcoKSB7CiAgICAgIHJldHVybiBgJHt0aGlzLnh9LCR7dGhpcy55fSwke3RoaXMuen0sJHt0aGlzLnd9YDsKICAgIH0KICAgIC8qKgogICAgICogQ29udmVydCB0byBhbiBBcnJheQogICAgICogQHJldHVybiBbeCwgeSwgeiwgd10KICAgICAqLwoKCiAgICB0b0FycmF5KCkgewogICAgICByZXR1cm4gW3RoaXMueCwgdGhpcy55LCB0aGlzLnosIHRoaXMud107CiAgICB9CiAgICAvKioKICAgICAqIFNldCB0aGUgcXVhdGVybmlvbiBjb21wb25lbnRzIGdpdmVuIGFuIGF4aXMgYW5kIGFuIGFuZ2xlIGluIHJhZGlhbnMuCiAgICAgKi8KCgogICAgc2V0RnJvbUF4aXNBbmdsZSh2ZWN0b3IsIGFuZ2xlKSB7CiAgICAgIGNvbnN0IHMgPSBNYXRoLnNpbihhbmdsZSAqIDAuNSk7CiAgICAgIHRoaXMueCA9IHZlY3Rvci54ICogczsKICAgICAgdGhpcy55ID0gdmVjdG9yLnkgKiBzOwogICAgICB0aGlzLnogPSB2ZWN0b3IueiAqIHM7CiAgICAgIHRoaXMudyA9IE1hdGguY29zKGFuZ2xlICogMC41KTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICAvKioKICAgICAqIENvbnZlcnRzIHRoZSBxdWF0ZXJuaW9uIHRvIFsgYXhpcywgYW5nbGUgXSByZXByZXNlbnRhdGlvbi4KICAgICAqIEBwYXJhbSB0YXJnZXRBeGlzIEEgdmVjdG9yIG9iamVjdCB0byByZXVzZSBmb3Igc3RvcmluZyB0aGUgYXhpcy4KICAgICAqIEByZXR1cm4gQW4gYXJyYXksIGZpcnN0IGVsZW1lbnQgaXMgdGhlIGF4aXMgYW5kIHRoZSBzZWNvbmQgaXMgdGhlIGFuZ2xlIGluIHJhZGlhbnMuCiAgICAgKi8KCgogICAgdG9BeGlzQW5nbGUodGFyZ2V0QXhpcykgewogICAgICBpZiAodGFyZ2V0QXhpcyA9PT0gdm9pZCAwKSB7CiAgICAgICAgdGFyZ2V0QXhpcyA9IG5ldyBWZWMzKCk7CiAgICAgIH0KCiAgICAgIHRoaXMubm9ybWFsaXplKCk7IC8vIGlmIHc+MSBhY29zIGFuZCBzcXJ0IHdpbGwgcHJvZHVjZSBlcnJvcnMsIHRoaXMgY2FudCBoYXBwZW4gaWYgcXVhdGVybmlvbiBpcyBub3JtYWxpc2VkCgogICAgICBjb25zdCBhbmdsZSA9IDIgKiBNYXRoLmFjb3ModGhpcy53KTsKICAgICAgY29uc3QgcyA9IE1hdGguc3FydCgxIC0gdGhpcy53ICogdGhpcy53KTsgLy8gYXNzdW1pbmcgcXVhdGVybmlvbiBub3JtYWxpc2VkIHRoZW4gdyBpcyBsZXNzIHRoYW4gMSwgc28gdGVybSBhbHdheXMgcG9zaXRpdmUuCgogICAgICBpZiAocyA8IDAuMDAxKSB7CiAgICAgICAgLy8gdGVzdCB0byBhdm9pZCBkaXZpZGUgYnkgemVybywgcyBpcyBhbHdheXMgcG9zaXRpdmUgZHVlIHRvIHNxcnQKICAgICAgICAvLyBpZiBzIGNsb3NlIHRvIHplcm8gdGhlbiBkaXJlY3Rpb24gb2YgYXhpcyBub3QgaW1wb3J0YW50CiAgICAgICAgdGFyZ2V0QXhpcy54ID0gdGhpcy54OyAvLyBpZiBpdCBpcyBpbXBvcnRhbnQgdGhhdCBheGlzIGlzIG5vcm1hbGlzZWQgdGhlbiByZXBsYWNlIHdpdGggeD0xOyB5PXo9MDsKCiAgICAgICAgdGFyZ2V0QXhpcy55ID0gdGhpcy55OwogICAgICAgIHRhcmdldEF4aXMueiA9IHRoaXMuejsKICAgICAgfSBlbHNlIHsKICAgICAgICB0YXJnZXRBeGlzLnggPSB0aGlzLnggLyBzOyAvLyBub3JtYWxpc2UgYXhpcwoKICAgICAgICB0YXJnZXRBeGlzLnkgPSB0aGlzLnkgLyBzOwogICAgICAgIHRhcmdldEF4aXMueiA9IHRoaXMueiAvIHM7CiAgICAgIH0KCiAgICAgIHJldHVybiBbdGFyZ2V0QXhpcywgYW5nbGVdOwogICAgfQogICAgLyoqCiAgICAgKiBTZXQgdGhlIHF1YXRlcm5pb24gdmFsdWUgZ2l2ZW4gdHdvIHZlY3RvcnMuIFRoZSByZXN1bHRpbmcgcm90YXRpb24gd2lsbCBiZSB0aGUgbmVlZGVkIHJvdGF0aW9uIHRvIHJvdGF0ZSB1IHRvIHYuCiAgICAgKi8KCgogICAgc2V0RnJvbVZlY3RvcnModSwgdikgewogICAgICBpZiAodS5pc0FudGlwYXJhbGxlbFRvKHYpKSB7CiAgICAgICAgY29uc3QgdDEgPSBzZnZfdDE7CiAgICAgICAgY29uc3QgdDIgPSBzZnZfdDI7CiAgICAgICAgdS50YW5nZW50cyh0MSwgdDIpOwogICAgICAgIHRoaXMuc2V0RnJvbUF4aXNBbmdsZSh0MSwgTWF0aC5QSSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29uc3QgYSA9IHUuY3Jvc3Modik7CiAgICAgICAgdGhpcy54ID0gYS54OwogICAgICAgIHRoaXMueSA9IGEueTsKICAgICAgICB0aGlzLnogPSBhLno7CiAgICAgICAgdGhpcy53ID0gTWF0aC5zcXJ0KHUubGVuZ3RoKCkgKiogMiAqIHYubGVuZ3RoKCkgKiogMikgKyB1LmRvdCh2KTsKICAgICAgICB0aGlzLm5vcm1hbGl6ZSgpOwogICAgICB9CgogICAgICByZXR1cm4gdGhpczsKICAgIH0KICAgIC8qKgogICAgICogTXVsdGlwbHkgdGhlIHF1YXRlcm5pb24gd2l0aCBhbiBvdGhlciBxdWF0ZXJuaW9uLgogICAgICovCgoKICAgIG11bHQocXVhdCwgdGFyZ2V0KSB7CiAgICAgIGlmICh0YXJnZXQgPT09IHZvaWQgMCkgewogICAgICAgIHRhcmdldCA9IG5ldyBRdWF0ZXJuaW9uKCk7CiAgICAgIH0KCiAgICAgIGNvbnN0IGF4ID0gdGhpcy54OwogICAgICBjb25zdCBheSA9IHRoaXMueTsKICAgICAgY29uc3QgYXogPSB0aGlzLno7CiAgICAgIGNvbnN0IGF3ID0gdGhpcy53OwogICAgICBjb25zdCBieCA9IHF1YXQueDsKICAgICAgY29uc3QgYnkgPSBxdWF0Lnk7CiAgICAgIGNvbnN0IGJ6ID0gcXVhdC56OwogICAgICBjb25zdCBidyA9IHF1YXQudzsKICAgICAgdGFyZ2V0LnggPSBheCAqIGJ3ICsgYXcgKiBieCArIGF5ICogYnogLSBheiAqIGJ5OwogICAgICB0YXJnZXQueSA9IGF5ICogYncgKyBhdyAqIGJ5ICsgYXogKiBieCAtIGF4ICogYno7CiAgICAgIHRhcmdldC56ID0gYXogKiBidyArIGF3ICogYnogKyBheCAqIGJ5IC0gYXkgKiBieDsKICAgICAgdGFyZ2V0LncgPSBhdyAqIGJ3IC0gYXggKiBieCAtIGF5ICogYnkgLSBheiAqIGJ6OwogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgdGhlIGludmVyc2UgcXVhdGVybmlvbiByb3RhdGlvbi4KICAgICAqLwoKCiAgICBpbnZlcnNlKHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB2b2lkIDApIHsKICAgICAgICB0YXJnZXQgPSBuZXcgUXVhdGVybmlvbigpOwogICAgICB9CgogICAgICBjb25zdCB4ID0gdGhpcy54OwogICAgICBjb25zdCB5ID0gdGhpcy55OwogICAgICBjb25zdCB6ID0gdGhpcy56OwogICAgICBjb25zdCB3ID0gdGhpcy53OwogICAgICB0aGlzLmNvbmp1Z2F0ZSh0YXJnZXQpOwogICAgICBjb25zdCBpbm9ybTIgPSAxIC8gKHggKiB4ICsgeSAqIHkgKyB6ICogeiArIHcgKiB3KTsKICAgICAgdGFyZ2V0LnggKj0gaW5vcm0yOwogICAgICB0YXJnZXQueSAqPSBpbm9ybTI7CiAgICAgIHRhcmdldC56ICo9IGlub3JtMjsKICAgICAgdGFyZ2V0LncgKj0gaW5vcm0yOwogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgdGhlIHF1YXRlcm5pb24gY29uanVnYXRlCiAgICAgKi8KCgogICAgY29uanVnYXRlKHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB2b2lkIDApIHsKICAgICAgICB0YXJnZXQgPSBuZXcgUXVhdGVybmlvbigpOwogICAgICB9CgogICAgICB0YXJnZXQueCA9IC10aGlzLng7CiAgICAgIHRhcmdldC55ID0gLXRoaXMueTsKICAgICAgdGFyZ2V0LnogPSAtdGhpcy56OwogICAgICB0YXJnZXQudyA9IHRoaXMudzsKICAgICAgcmV0dXJuIHRhcmdldDsKICAgIH0KICAgIC8qKgogICAgICogTm9ybWFsaXplIHRoZSBxdWF0ZXJuaW9uLiBOb3RlIHRoYXQgdGhpcyBjaGFuZ2VzIHRoZSB2YWx1ZXMgb2YgdGhlIHF1YXRlcm5pb24uCiAgICAgKi8KCgogICAgbm9ybWFsaXplKCkgewogICAgICBsZXQgbCA9IE1hdGguc3FydCh0aGlzLnggKiB0aGlzLnggKyB0aGlzLnkgKiB0aGlzLnkgKyB0aGlzLnogKiB0aGlzLnogKyB0aGlzLncgKiB0aGlzLncpOwoKICAgICAgaWYgKGwgPT09IDApIHsKICAgICAgICB0aGlzLnggPSAwOwogICAgICAgIHRoaXMueSA9IDA7CiAgICAgICAgdGhpcy56ID0gMDsKICAgICAgICB0aGlzLncgPSAwOwogICAgICB9IGVsc2UgewogICAgICAgIGwgPSAxIC8gbDsKICAgICAgICB0aGlzLnggKj0gbDsKICAgICAgICB0aGlzLnkgKj0gbDsKICAgICAgICB0aGlzLnogKj0gbDsKICAgICAgICB0aGlzLncgKj0gbDsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICAvKioKICAgICAqIEFwcHJveGltYXRpb24gb2YgcXVhdGVybmlvbiBub3JtYWxpemF0aW9uLiBXb3JrcyBiZXN0IHdoZW4gcXVhdCBpcyBhbHJlYWR5IGFsbW9zdC1ub3JtYWxpemVkLgogICAgICogQGF1dGhvciB1bnBoYXNlZCwgaHR0cHM6Ly9naXRodWIuY29tL3VucGhhc2VkCiAgICAgKi8KCgogICAgbm9ybWFsaXplRmFzdCgpIHsKICAgICAgY29uc3QgZiA9ICgzLjAgLSAodGhpcy54ICogdGhpcy54ICsgdGhpcy55ICogdGhpcy55ICsgdGhpcy56ICogdGhpcy56ICsgdGhpcy53ICogdGhpcy53KSkgLyAyLjA7CgogICAgICBpZiAoZiA9PT0gMCkgewogICAgICAgIHRoaXMueCA9IDA7CiAgICAgICAgdGhpcy55ID0gMDsKICAgICAgICB0aGlzLnogPSAwOwogICAgICAgIHRoaXMudyA9IDA7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy54ICo9IGY7CiAgICAgICAgdGhpcy55ICo9IGY7CiAgICAgICAgdGhpcy56ICo9IGY7CiAgICAgICAgdGhpcy53ICo9IGY7CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzOwogICAgfQogICAgLyoqCiAgICAgKiBNdWx0aXBseSB0aGUgcXVhdGVybmlvbiBieSBhIHZlY3RvcgogICAgICovCgoKICAgIHZtdWx0KHYsIHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB2b2lkIDApIHsKICAgICAgICB0YXJnZXQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICBjb25zdCB4ID0gdi54OwogICAgICBjb25zdCB5ID0gdi55OwogICAgICBjb25zdCB6ID0gdi56OwogICAgICBjb25zdCBxeCA9IHRoaXMueDsKICAgICAgY29uc3QgcXkgPSB0aGlzLnk7CiAgICAgIGNvbnN0IHF6ID0gdGhpcy56OwogICAgICBjb25zdCBxdyA9IHRoaXMudzsgLy8gcSp2CgogICAgICBjb25zdCBpeCA9IHF3ICogeCArIHF5ICogeiAtIHF6ICogeTsKICAgICAgY29uc3QgaXkgPSBxdyAqIHkgKyBxeiAqIHggLSBxeCAqIHo7CiAgICAgIGNvbnN0IGl6ID0gcXcgKiB6ICsgcXggKiB5IC0gcXkgKiB4OwogICAgICBjb25zdCBpdyA9IC1xeCAqIHggLSBxeSAqIHkgLSBxeiAqIHo7CiAgICAgIHRhcmdldC54ID0gaXggKiBxdyArIGl3ICogLXF4ICsgaXkgKiAtcXogLSBpeiAqIC1xeTsKICAgICAgdGFyZ2V0LnkgPSBpeSAqIHF3ICsgaXcgKiAtcXkgKyBpeiAqIC1xeCAtIGl4ICogLXF6OwogICAgICB0YXJnZXQueiA9IGl6ICogcXcgKyBpdyAqIC1xeiArIGl4ICogLXF5IC0gaXkgKiAtcXg7CiAgICAgIHJldHVybiB0YXJnZXQ7CiAgICB9CiAgICAvKioKICAgICAqIENvcGllcyB2YWx1ZSBvZiBzb3VyY2UgdG8gdGhpcyBxdWF0ZXJuaW9uLgogICAgICogQHJldHVybiB0aGlzCiAgICAgKi8KCgogICAgY29weShxdWF0KSB7CiAgICAgIHRoaXMueCA9IHF1YXQueDsKICAgICAgdGhpcy55ID0gcXVhdC55OwogICAgICB0aGlzLnogPSBxdWF0Lno7CiAgICAgIHRoaXMudyA9IHF1YXQudzsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICAvKioKICAgICAqIENvbnZlcnQgdGhlIHF1YXRlcm5pb24gdG8gZXVsZXIgYW5nbGUgcmVwcmVzZW50YXRpb24uIE9yZGVyOiBZWlgsIGFzIHRoaXMgcGFnZSBkZXNjcmliZXM6IGh0dHBzOi8vd3d3LmV1Y2xpZGVhbnNwYWNlLmNvbS9tYXRocy9zdGFuZGFyZHMvaW5kZXguaHRtCiAgICAgKiBAcGFyYW0gb3JkZXIgVGhyZWUtY2hhcmFjdGVyIHN0cmluZywgZGVmYXVsdHMgdG8gIllaWCIKICAgICAqLwoKCiAgICB0b0V1bGVyKHRhcmdldCwgb3JkZXIpIHsKICAgICAgaWYgKG9yZGVyID09PSB2b2lkIDApIHsKICAgICAgICBvcmRlciA9ICdZWlgnOwogICAgICB9CgogICAgICBsZXQgaGVhZGluZzsKICAgICAgbGV0IGF0dGl0dWRlOwogICAgICBsZXQgYmFuazsKICAgICAgY29uc3QgeCA9IHRoaXMueDsKICAgICAgY29uc3QgeSA9IHRoaXMueTsKICAgICAgY29uc3QgeiA9IHRoaXMuejsKICAgICAgY29uc3QgdyA9IHRoaXMudzsKCiAgICAgIHN3aXRjaCAob3JkZXIpIHsKICAgICAgICBjYXNlICdZWlgnOgogICAgICAgICAgY29uc3QgdGVzdCA9IHggKiB5ICsgeiAqIHc7CgogICAgICAgICAgaWYgKHRlc3QgPiAwLjQ5OSkgewogICAgICAgICAgICAvLyBzaW5ndWxhcml0eSBhdCBub3J0aCBwb2xlCiAgICAgICAgICAgIGhlYWRpbmcgPSAyICogTWF0aC5hdGFuMih4LCB3KTsKICAgICAgICAgICAgYXR0aXR1ZGUgPSBNYXRoLlBJIC8gMjsKICAgICAgICAgICAgYmFuayA9IDA7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKHRlc3QgPCAtMC40OTkpIHsKICAgICAgICAgICAgLy8gc2luZ3VsYXJpdHkgYXQgc291dGggcG9sZQogICAgICAgICAgICBoZWFkaW5nID0gLTIgKiBNYXRoLmF0YW4yKHgsIHcpOwogICAgICAgICAgICBhdHRpdHVkZSA9IC1NYXRoLlBJIC8gMjsKICAgICAgICAgICAgYmFuayA9IDA7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGhlYWRpbmcgPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICBjb25zdCBzcXggPSB4ICogeDsKICAgICAgICAgICAgY29uc3Qgc3F5ID0geSAqIHk7CiAgICAgICAgICAgIGNvbnN0IHNxeiA9IHogKiB6OwogICAgICAgICAgICBoZWFkaW5nID0gTWF0aC5hdGFuMigyICogeSAqIHcgLSAyICogeCAqIHosIDEgLSAyICogc3F5IC0gMiAqIHNxeik7IC8vIEhlYWRpbmcKCiAgICAgICAgICAgIGF0dGl0dWRlID0gTWF0aC5hc2luKDIgKiB0ZXN0KTsgLy8gYXR0aXR1ZGUKCiAgICAgICAgICAgIGJhbmsgPSBNYXRoLmF0YW4yKDIgKiB4ICogdyAtIDIgKiB5ICogeiwgMSAtIDIgKiBzcXggLSAyICogc3F6KTsgLy8gYmFuawogICAgICAgICAgfQoKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBFdWxlciBvcmRlciAke29yZGVyfSBub3Qgc3VwcG9ydGVkIHlldC5gKTsKICAgICAgfQoKICAgICAgdGFyZ2V0LnkgPSBoZWFkaW5nOwogICAgICB0YXJnZXQueiA9IGF0dGl0dWRlOwogICAgICB0YXJnZXQueCA9IGJhbms7CiAgICB9CiAgICAvKioKICAgICAqIFNldCB0aGUgcXVhdGVybmlvbiBjb21wb25lbnRzIGdpdmVuIEV1bGVyIGFuZ2xlIHJlcHJlc2VudGF0aW9uLgogICAgICoKICAgICAqIEBwYXJhbSBvcmRlciBUaGUgb3JkZXIgdG8gYXBwbHkgYW5nbGVzOiAnWFlaJyBvciAnWVhaJyBvciBhbnkgb3RoZXIgY29tYmluYXRpb24uCiAgICAgKgogICAgICogU2VlIHtAbGluayBodHRwczovL3d3dy5tYXRod29ya3MuY29tL21hdGxhYmNlbnRyYWwvZmlsZWV4Y2hhbmdlLzIwNjk2LWZ1bmN0aW9uLXRvLWNvbnZlcnQtYmV0d2Vlbi1kY20tZXVsZXItYW5nbGVzLXF1YXRlcm5pb25zLWFuZC1ldWxlci12ZWN0b3JzIE1hdGhXb3Jrc30gcmVmZXJlbmNlCiAgICAgKi8KCgogICAgc2V0RnJvbUV1bGVyKHgsIHksIHosIG9yZGVyKSB7CiAgICAgIGlmIChvcmRlciA9PT0gdm9pZCAwKSB7CiAgICAgICAgb3JkZXIgPSAnWFlaJzsKICAgICAgfQoKICAgICAgY29uc3QgYzEgPSBNYXRoLmNvcyh4IC8gMik7CiAgICAgIGNvbnN0IGMyID0gTWF0aC5jb3MoeSAvIDIpOwogICAgICBjb25zdCBjMyA9IE1hdGguY29zKHogLyAyKTsKICAgICAgY29uc3QgczEgPSBNYXRoLnNpbih4IC8gMik7CiAgICAgIGNvbnN0IHMyID0gTWF0aC5zaW4oeSAvIDIpOwogICAgICBjb25zdCBzMyA9IE1hdGguc2luKHogLyAyKTsKCiAgICAgIGlmIChvcmRlciA9PT0gJ1hZWicpIHsKICAgICAgICB0aGlzLnggPSBzMSAqIGMyICogYzMgKyBjMSAqIHMyICogczM7CiAgICAgICAgdGhpcy55ID0gYzEgKiBzMiAqIGMzIC0gczEgKiBjMiAqIHMzOwogICAgICAgIHRoaXMueiA9IGMxICogYzIgKiBzMyArIHMxICogczIgKiBjMzsKICAgICAgICB0aGlzLncgPSBjMSAqIGMyICogYzMgLSBzMSAqIHMyICogczM7CiAgICAgIH0gZWxzZSBpZiAob3JkZXIgPT09ICdZWFonKSB7CiAgICAgICAgdGhpcy54ID0gczEgKiBjMiAqIGMzICsgYzEgKiBzMiAqIHMzOwogICAgICAgIHRoaXMueSA9IGMxICogczIgKiBjMyAtIHMxICogYzIgKiBzMzsKICAgICAgICB0aGlzLnogPSBjMSAqIGMyICogczMgLSBzMSAqIHMyICogYzM7CiAgICAgICAgdGhpcy53ID0gYzEgKiBjMiAqIGMzICsgczEgKiBzMiAqIHMzOwogICAgICB9IGVsc2UgaWYgKG9yZGVyID09PSAnWlhZJykgewogICAgICAgIHRoaXMueCA9IHMxICogYzIgKiBjMyAtIGMxICogczIgKiBzMzsKICAgICAgICB0aGlzLnkgPSBjMSAqIHMyICogYzMgKyBzMSAqIGMyICogczM7CiAgICAgICAgdGhpcy56ID0gYzEgKiBjMiAqIHMzICsgczEgKiBzMiAqIGMzOwogICAgICAgIHRoaXMudyA9IGMxICogYzIgKiBjMyAtIHMxICogczIgKiBzMzsKICAgICAgfSBlbHNlIGlmIChvcmRlciA9PT0gJ1pZWCcpIHsKICAgICAgICB0aGlzLnggPSBzMSAqIGMyICogYzMgLSBjMSAqIHMyICogczM7CiAgICAgICAgdGhpcy55ID0gYzEgKiBzMiAqIGMzICsgczEgKiBjMiAqIHMzOwogICAgICAgIHRoaXMueiA9IGMxICogYzIgKiBzMyAtIHMxICogczIgKiBjMzsKICAgICAgICB0aGlzLncgPSBjMSAqIGMyICogYzMgKyBzMSAqIHMyICogczM7CiAgICAgIH0gZWxzZSBpZiAob3JkZXIgPT09ICdZWlgnKSB7CiAgICAgICAgdGhpcy54ID0gczEgKiBjMiAqIGMzICsgYzEgKiBzMiAqIHMzOwogICAgICAgIHRoaXMueSA9IGMxICogczIgKiBjMyArIHMxICogYzIgKiBzMzsKICAgICAgICB0aGlzLnogPSBjMSAqIGMyICogczMgLSBzMSAqIHMyICogYzM7CiAgICAgICAgdGhpcy53ID0gYzEgKiBjMiAqIGMzIC0gczEgKiBzMiAqIHMzOwogICAgICB9IGVsc2UgaWYgKG9yZGVyID09PSAnWFpZJykgewogICAgICAgIHRoaXMueCA9IHMxICogYzIgKiBjMyAtIGMxICogczIgKiBzMzsKICAgICAgICB0aGlzLnkgPSBjMSAqIHMyICogYzMgLSBzMSAqIGMyICogczM7CiAgICAgICAgdGhpcy56ID0gYzEgKiBjMiAqIHMzICsgczEgKiBzMiAqIGMzOwogICAgICAgIHRoaXMudyA9IGMxICogYzIgKiBjMyArIHMxICogczIgKiBzMzsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CgogICAgY2xvbmUoKSB7CiAgICAgIHJldHVybiBuZXcgUXVhdGVybmlvbih0aGlzLngsIHRoaXMueSwgdGhpcy56LCB0aGlzLncpOwogICAgfQogICAgLyoqCiAgICAgKiBQZXJmb3JtcyBhIHNwaGVyaWNhbCBsaW5lYXIgaW50ZXJwb2xhdGlvbiBiZXR3ZWVuIHR3byBxdWF0CiAgICAgKgogICAgICogQHBhcmFtIHRvUXVhdCBzZWNvbmQgb3BlcmFuZAogICAgICogQHBhcmFtIHQgaW50ZXJwb2xhdGlvbiBhbW91bnQgYmV0d2VlbiB0aGUgc2VsZiBxdWF0ZXJuaW9uIGFuZCB0b1F1YXQKICAgICAqIEBwYXJhbSB0YXJnZXQgQSBxdWF0ZXJuaW9uIHRvIHN0b3JlIHRoZSByZXN1bHQgaW4uIElmIG5vdCBwcm92aWRlZCwgYSBuZXcgb25lIHdpbGwgYmUgY3JlYXRlZC4KICAgICAqIEByZXR1cm5zIHtRdWF0ZXJuaW9ufSBUaGUgInRhcmdldCIgb2JqZWN0CiAgICAgKi8KCgogICAgc2xlcnAodG9RdWF0LCB0LCB0YXJnZXQpIHsKICAgICAgaWYgKHRhcmdldCA9PT0gdm9pZCAwKSB7CiAgICAgICAgdGFyZ2V0ID0gbmV3IFF1YXRlcm5pb24oKTsKICAgICAgfQoKICAgICAgY29uc3QgYXggPSB0aGlzLng7CiAgICAgIGNvbnN0IGF5ID0gdGhpcy55OwogICAgICBjb25zdCBheiA9IHRoaXMuejsKICAgICAgY29uc3QgYXcgPSB0aGlzLnc7CiAgICAgIGxldCBieCA9IHRvUXVhdC54OwogICAgICBsZXQgYnkgPSB0b1F1YXQueTsKICAgICAgbGV0IGJ6ID0gdG9RdWF0Lno7CiAgICAgIGxldCBidyA9IHRvUXVhdC53OwogICAgICBsZXQgb21lZ2E7CiAgICAgIGxldCBjb3NvbTsKICAgICAgbGV0IHNpbm9tOwogICAgICBsZXQgc2NhbGUwOwogICAgICBsZXQgc2NhbGUxOyAvLyBjYWxjIGNvc2luZQoKICAgICAgY29zb20gPSBheCAqIGJ4ICsgYXkgKiBieSArIGF6ICogYnogKyBhdyAqIGJ3OyAvLyBhZGp1c3Qgc2lnbnMgKGlmIG5lY2Vzc2FyeSkKCiAgICAgIGlmIChjb3NvbSA8IDAuMCkgewogICAgICAgIGNvc29tID0gLWNvc29tOwogICAgICAgIGJ4ID0gLWJ4OwogICAgICAgIGJ5ID0gLWJ5OwogICAgICAgIGJ6ID0gLWJ6OwogICAgICAgIGJ3ID0gLWJ3OwogICAgICB9IC8vIGNhbGN1bGF0ZSBjb2VmZmljaWVudHMKCgogICAgICBpZiAoMS4wIC0gY29zb20gPiAwLjAwMDAwMSkgewogICAgICAgIC8vIHN0YW5kYXJkIGNhc2UgKHNsZXJwKQogICAgICAgIG9tZWdhID0gTWF0aC5hY29zKGNvc29tKTsKICAgICAgICBzaW5vbSA9IE1hdGguc2luKG9tZWdhKTsKICAgICAgICBzY2FsZTAgPSBNYXRoLnNpbigoMS4wIC0gdCkgKiBvbWVnYSkgLyBzaW5vbTsKICAgICAgICBzY2FsZTEgPSBNYXRoLnNpbih0ICogb21lZ2EpIC8gc2lub207CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gImZyb20iIGFuZCAidG8iIHF1YXRlcm5pb25zIGFyZSB2ZXJ5IGNsb3NlCiAgICAgICAgLy8gIC4uLiBzbyB3ZSBjYW4gZG8gYSBsaW5lYXIgaW50ZXJwb2xhdGlvbgogICAgICAgIHNjYWxlMCA9IDEuMCAtIHQ7CiAgICAgICAgc2NhbGUxID0gdDsKICAgICAgfSAvLyBjYWxjdWxhdGUgZmluYWwgdmFsdWVzCgoKICAgICAgdGFyZ2V0LnggPSBzY2FsZTAgKiBheCArIHNjYWxlMSAqIGJ4OwogICAgICB0YXJnZXQueSA9IHNjYWxlMCAqIGF5ICsgc2NhbGUxICogYnk7CiAgICAgIHRhcmdldC56ID0gc2NhbGUwICogYXogKyBzY2FsZTEgKiBiejsKICAgICAgdGFyZ2V0LncgPSBzY2FsZTAgKiBhdyArIHNjYWxlMSAqIGJ3OwogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQogICAgLyoqCiAgICAgKiBSb3RhdGUgYW4gYWJzb2x1dGUgb3JpZW50YXRpb24gcXVhdGVybmlvbiBnaXZlbiBhbiBhbmd1bGFyIHZlbG9jaXR5IGFuZCBhIHRpbWUgc3RlcC4KICAgICAqLwoKCiAgICBpbnRlZ3JhdGUoYW5ndWxhclZlbG9jaXR5LCBkdCwgYW5ndWxhckZhY3RvciwgdGFyZ2V0KSB7CiAgICAgIGlmICh0YXJnZXQgPT09IHZvaWQgMCkgewogICAgICAgIHRhcmdldCA9IG5ldyBRdWF0ZXJuaW9uKCk7CiAgICAgIH0KCiAgICAgIGNvbnN0IGF4ID0gYW5ndWxhclZlbG9jaXR5LnggKiBhbmd1bGFyRmFjdG9yLngsCiAgICAgICAgICAgIGF5ID0gYW5ndWxhclZlbG9jaXR5LnkgKiBhbmd1bGFyRmFjdG9yLnksCiAgICAgICAgICAgIGF6ID0gYW5ndWxhclZlbG9jaXR5LnogKiBhbmd1bGFyRmFjdG9yLnosCiAgICAgICAgICAgIGJ4ID0gdGhpcy54LAogICAgICAgICAgICBieSA9IHRoaXMueSwKICAgICAgICAgICAgYnogPSB0aGlzLnosCiAgICAgICAgICAgIGJ3ID0gdGhpcy53OwogICAgICBjb25zdCBoYWxmX2R0ID0gZHQgKiAwLjU7CiAgICAgIHRhcmdldC54ICs9IGhhbGZfZHQgKiAoYXggKiBidyArIGF5ICogYnogLSBheiAqIGJ5KTsKICAgICAgdGFyZ2V0LnkgKz0gaGFsZl9kdCAqIChheSAqIGJ3ICsgYXogKiBieCAtIGF4ICogYnopOwogICAgICB0YXJnZXQueiArPSBoYWxmX2R0ICogKGF6ICogYncgKyBheCAqIGJ5IC0gYXkgKiBieCk7CiAgICAgIHRhcmdldC53ICs9IGhhbGZfZHQgKiAoLWF4ICogYnggLSBheSAqIGJ5IC0gYXogKiBieik7CiAgICAgIHJldHVybiB0YXJnZXQ7CiAgICB9CgogIH0KICBjb25zdCBzZnZfdDEgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNmdl90MiA9IG5ldyBWZWMzKCk7CgogIC8qKgogICAqIFRoZSBhdmFpbGFibGUgc2hhcGUgdHlwZXMuCiAgICovCiAgY29uc3QgU0hBUEVfVFlQRVMgPSB7CiAgICAvKiogU1BIRVJFICovCiAgICBTUEhFUkU6IDEsCgogICAgLyoqIFBMQU5FICovCiAgICBQTEFORTogMiwKCiAgICAvKiogQk9YICovCiAgICBCT1g6IDQsCgogICAgLyoqIENPTVBPVU5EICovCiAgICBDT01QT1VORDogOCwKCiAgICAvKiogQ09OVkVYUE9MWUhFRFJPTiAqLwogICAgQ09OVkVYUE9MWUhFRFJPTjogMTYsCgogICAgLyoqIEhFSUdIVEZJRUxEICovCiAgICBIRUlHSFRGSUVMRDogMzIsCgogICAgLyoqIFBBUlRJQ0xFICovCiAgICBQQVJUSUNMRTogNjQsCgogICAgLyoqIENZTElOREVSICovCiAgICBDWUxJTkRFUjogMTI4LAoKICAgIC8qKiBUUklNRVNIICovCiAgICBUUklNRVNIOiAyNTYKICB9OwogIC8qKgogICAqIFNoYXBlVHlwZQogICAqLwoKICAvKioKICAgKiBCYXNlIGNsYXNzIGZvciBzaGFwZXMKICAgKi8KICBjbGFzcyBTaGFwZSB7CiAgICAvKioKICAgICAqIElkZW50aWZpZXIgb2YgdGhlIFNoYXBlLgogICAgICovCgogICAgLyoqCiAgICAgKiBUaGUgdHlwZSBvZiB0aGlzIHNoYXBlLiBNdXN0IGJlIHNldCB0byBhbiBpbnQgPiAwIGJ5IHN1YmNsYXNzZXMuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFRoZSBsb2NhbCBib3VuZGluZyBzcGhlcmUgcmFkaXVzIG9mIHRoaXMgc2hhcGUuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFdoZXRoZXIgdG8gcHJvZHVjZSBjb250YWN0IGZvcmNlcyB3aGVuIGluIGNvbnRhY3Qgd2l0aCBvdGhlciBib2RpZXMuIE5vdGUgdGhhdCBjb250YWN0cyB3aWxsIGJlIGdlbmVyYXRlZCwgYnV0IHRoZXkgd2lsbCBiZSBkaXNhYmxlZC4KICAgICAqIEBkZWZhdWx0IHRydWUKICAgICAqLwoKICAgIC8qKgogICAgICogQGRlZmF1bHQgMQogICAgICovCgogICAgLyoqCiAgICAgKiBAZGVmYXVsdCAtMQogICAgICovCgogICAgLyoqCiAgICAgKiBPcHRpb25hbCBtYXRlcmlhbCBvZiB0aGUgc2hhcGUgdGhhdCByZWd1bGF0ZXMgY29udGFjdCBwcm9wZXJ0aWVzLgogICAgICovCgogICAgLyoqCiAgICAgKiBUaGUgYm9keSB0byB3aGljaCB0aGUgc2hhcGUgaXMgYWRkZWQgdG8uCiAgICAgKi8KCiAgICAvKioKICAgICAqIEFsbCB0aGUgU2hhcGUgdHlwZXMuCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHsKICAgICAgaWYgKG9wdGlvbnMgPT09IHZvaWQgMCkgewogICAgICAgIG9wdGlvbnMgPSB7fTsKICAgICAgfQoKICAgICAgdGhpcy5pZCA9IFNoYXBlLmlkQ291bnRlcisrOwogICAgICB0aGlzLnR5cGUgPSBvcHRpb25zLnR5cGUgfHwgMDsKICAgICAgdGhpcy5ib3VuZGluZ1NwaGVyZVJhZGl1cyA9IDA7CiAgICAgIHRoaXMuY29sbGlzaW9uUmVzcG9uc2UgPSBvcHRpb25zLmNvbGxpc2lvblJlc3BvbnNlID8gb3B0aW9ucy5jb2xsaXNpb25SZXNwb25zZSA6IHRydWU7CiAgICAgIHRoaXMuY29sbGlzaW9uRmlsdGVyR3JvdXAgPSBvcHRpb25zLmNvbGxpc2lvbkZpbHRlckdyb3VwICE9PSB1bmRlZmluZWQgPyBvcHRpb25zLmNvbGxpc2lvbkZpbHRlckdyb3VwIDogMTsKICAgICAgdGhpcy5jb2xsaXNpb25GaWx0ZXJNYXNrID0gb3B0aW9ucy5jb2xsaXNpb25GaWx0ZXJNYXNrICE9PSB1bmRlZmluZWQgPyBvcHRpb25zLmNvbGxpc2lvbkZpbHRlck1hc2sgOiAtMTsKICAgICAgdGhpcy5tYXRlcmlhbCA9IG9wdGlvbnMubWF0ZXJpYWwgPyBvcHRpb25zLm1hdGVyaWFsIDogbnVsbDsKICAgICAgdGhpcy5ib2R5ID0gbnVsbDsKICAgIH0KICAgIC8qKgogICAgICogQ29tcHV0ZXMgdGhlIGJvdW5kaW5nIHNwaGVyZSByYWRpdXMuCiAgICAgKiBUaGUgcmVzdWx0IGlzIHN0b3JlZCBpbiB0aGUgcHJvcGVydHkgYC5ib3VuZGluZ1NwaGVyZVJhZGl1c2AKICAgICAqLwoKCiAgICB1cGRhdGVCb3VuZGluZ1NwaGVyZVJhZGl1cygpIHsKICAgICAgdGhyb3cgYGNvbXB1dGVCb3VuZGluZ1NwaGVyZVJhZGl1cygpIG5vdCBpbXBsZW1lbnRlZCBmb3Igc2hhcGUgdHlwZSAke3RoaXMudHlwZX1gOwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgdGhlIHZvbHVtZSBvZiB0aGlzIHNoYXBlCiAgICAgKi8KCgogICAgdm9sdW1lKCkgewogICAgICB0aHJvdyBgdm9sdW1lKCkgbm90IGltcGxlbWVudGVkIGZvciBzaGFwZSB0eXBlICR7dGhpcy50eXBlfWA7CiAgICB9CiAgICAvKioKICAgICAqIENhbGN1bGF0ZXMgdGhlIGluZXJ0aWEgaW4gdGhlIGxvY2FsIGZyYW1lIGZvciB0aGlzIHNoYXBlLgogICAgICogQHNlZSBodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0xpc3Rfb2ZfbW9tZW50c19vZl9pbmVydGlhCiAgICAgKi8KCgogICAgY2FsY3VsYXRlTG9jYWxJbmVydGlhKG1hc3MsIHRhcmdldCkgewogICAgICB0aHJvdyBgY2FsY3VsYXRlTG9jYWxJbmVydGlhKCkgbm90IGltcGxlbWVudGVkIGZvciBzaGFwZSB0eXBlICR7dGhpcy50eXBlfWA7CiAgICB9CiAgICAvKioKICAgICAqIEB0b2RvIHVzZSBhYnN0cmFjdCBmb3IgdGhlc2Uga2luZCBvZiBtZXRob2RzCiAgICAgKi8KCgogICAgY2FsY3VsYXRlV29ybGRBQUJCKHBvcywgcXVhdCwgbWluLCBtYXgpIHsKICAgICAgdGhyb3cgYGNhbGN1bGF0ZVdvcmxkQUFCQigpIG5vdCBpbXBsZW1lbnRlZCBmb3Igc2hhcGUgdHlwZSAke3RoaXMudHlwZX1gOwogICAgfQoKICB9CiAgU2hhcGUuaWRDb3VudGVyID0gMDsKICBTaGFwZS50eXBlcyA9IFNIQVBFX1RZUEVTOwoKICAvKioKICAgKiBUcmFuc2Zvcm1hdGlvbiB1dGlsaXRpZXMuCiAgICovCiAgY2xhc3MgVHJhbnNmb3JtIHsKICAgIC8qKgogICAgICogcG9zaXRpb24KICAgICAqLwoKICAgIC8qKgogICAgICogcXVhdGVybmlvbgogICAgICovCiAgICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7CiAgICAgIGlmIChvcHRpb25zID09PSB2b2lkIDApIHsKICAgICAgICBvcHRpb25zID0ge307CiAgICAgIH0KCiAgICAgIHRoaXMucG9zaXRpb24gPSBuZXcgVmVjMygpOwogICAgICB0aGlzLnF1YXRlcm5pb24gPSBuZXcgUXVhdGVybmlvbigpOwoKICAgICAgaWYgKG9wdGlvbnMucG9zaXRpb24pIHsKICAgICAgICB0aGlzLnBvc2l0aW9uLmNvcHkob3B0aW9ucy5wb3NpdGlvbik7CiAgICAgIH0KCiAgICAgIGlmIChvcHRpb25zLnF1YXRlcm5pb24pIHsKICAgICAgICB0aGlzLnF1YXRlcm5pb24uY29weShvcHRpb25zLnF1YXRlcm5pb24pOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhIGdsb2JhbCBwb2ludCBpbiBsb2NhbCB0cmFuc2Zvcm0gY29vcmRpbmF0ZXMuCiAgICAgKi8KCgogICAgcG9pbnRUb0xvY2FsKHdvcmxkUG9pbnQsIHJlc3VsdCkgewogICAgICByZXR1cm4gVHJhbnNmb3JtLnBvaW50VG9Mb2NhbEZyYW1lKHRoaXMucG9zaXRpb24sIHRoaXMucXVhdGVybmlvbiwgd29ybGRQb2ludCwgcmVzdWx0KTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IGEgbG9jYWwgcG9pbnQgaW4gZ2xvYmFsIHRyYW5zZm9ybSBjb29yZGluYXRlcy4KICAgICAqLwoKCiAgICBwb2ludFRvV29ybGQobG9jYWxQb2ludCwgcmVzdWx0KSB7CiAgICAgIHJldHVybiBUcmFuc2Zvcm0ucG9pbnRUb1dvcmxkRnJhbWUodGhpcy5wb3NpdGlvbiwgdGhpcy5xdWF0ZXJuaW9uLCBsb2NhbFBvaW50LCByZXN1bHQpOwogICAgfQogICAgLyoqCiAgICAgKiB2ZWN0b3JUb1dvcmxkRnJhbWUKICAgICAqLwoKCiAgICB2ZWN0b3JUb1dvcmxkRnJhbWUobG9jYWxWZWN0b3IsIHJlc3VsdCkgewogICAgICBpZiAocmVzdWx0ID09PSB2b2lkIDApIHsKICAgICAgICByZXN1bHQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICB0aGlzLnF1YXRlcm5pb24udm11bHQobG9jYWxWZWN0b3IsIHJlc3VsdCk7CiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CiAgICAvKioKICAgICAqIHBvaW50VG9Mb2NhbEZyYW1lCiAgICAgKi8KCgogICAgc3RhdGljIHBvaW50VG9Mb2NhbEZyYW1lKHBvc2l0aW9uLCBxdWF0ZXJuaW9uLCB3b3JsZFBvaW50LCByZXN1bHQpIHsKICAgICAgaWYgKHJlc3VsdCA9PT0gdm9pZCAwKSB7CiAgICAgICAgcmVzdWx0ID0gbmV3IFZlYzMoKTsKICAgICAgfQoKICAgICAgd29ybGRQb2ludC52c3ViKHBvc2l0aW9uLCByZXN1bHQpOwogICAgICBxdWF0ZXJuaW9uLmNvbmp1Z2F0ZSh0bXBRdWF0JDEpOwogICAgICB0bXBRdWF0JDEudm11bHQocmVzdWx0LCByZXN1bHQpOwogICAgICByZXR1cm4gcmVzdWx0OwogICAgfQogICAgLyoqCiAgICAgKiBwb2ludFRvV29ybGRGcmFtZQogICAgICovCgoKICAgIHN0YXRpYyBwb2ludFRvV29ybGRGcmFtZShwb3NpdGlvbiwgcXVhdGVybmlvbiwgbG9jYWxQb2ludCwgcmVzdWx0KSB7CiAgICAgIGlmIChyZXN1bHQgPT09IHZvaWQgMCkgewogICAgICAgIHJlc3VsdCA9IG5ldyBWZWMzKCk7CiAgICAgIH0KCiAgICAgIHF1YXRlcm5pb24udm11bHQobG9jYWxQb2ludCwgcmVzdWx0KTsKICAgICAgcmVzdWx0LnZhZGQocG9zaXRpb24sIHJlc3VsdCk7CiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CiAgICAvKioKICAgICAqIHZlY3RvclRvV29ybGRGcmFtZQogICAgICovCgoKICAgIHN0YXRpYyB2ZWN0b3JUb1dvcmxkRnJhbWUocXVhdGVybmlvbiwgbG9jYWxWZWN0b3IsIHJlc3VsdCkgewogICAgICBpZiAocmVzdWx0ID09PSB2b2lkIDApIHsKICAgICAgICByZXN1bHQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICBxdWF0ZXJuaW9uLnZtdWx0KGxvY2FsVmVjdG9yLCByZXN1bHQpOwogICAgICByZXR1cm4gcmVzdWx0OwogICAgfQogICAgLyoqCiAgICAgKiB2ZWN0b3JUb0xvY2FsRnJhbWUKICAgICAqLwoKCiAgICBzdGF0aWMgdmVjdG9yVG9Mb2NhbEZyYW1lKHBvc2l0aW9uLCBxdWF0ZXJuaW9uLCB3b3JsZFZlY3RvciwgcmVzdWx0KSB7CiAgICAgIGlmIChyZXN1bHQgPT09IHZvaWQgMCkgewogICAgICAgIHJlc3VsdCA9IG5ldyBWZWMzKCk7CiAgICAgIH0KCiAgICAgIHF1YXRlcm5pb24udyAqPSAtMTsKICAgICAgcXVhdGVybmlvbi52bXVsdCh3b3JsZFZlY3RvciwgcmVzdWx0KTsKICAgICAgcXVhdGVybmlvbi53ICo9IC0xOwogICAgICByZXR1cm4gcmVzdWx0OwogICAgfQoKICB9CiAgY29uc3QgdG1wUXVhdCQxID0gbmV3IFF1YXRlcm5pb24oKTsKCiAgLyoqCiAgICogQSBzZXQgb2YgcG9seWdvbnMgZGVzY3JpYmluZyBhIGNvbnZleCBzaGFwZS4KICAgKgogICAqIFRoZSBzaGFwZSBNVVNUIGJlIGNvbnZleCBmb3IgdGhlIGNvZGUgdG8gd29yayBwcm9wZXJseS4gTm8gcG9seWdvbnMgbWF5IGJlIGNvcGxhbmFyIChjb250YWluZWQKICAgKiBpbiB0aGUgc2FtZSAzRCBwbGFuZSksIGluc3RlYWQgdGhlc2Ugc2hvdWxkIGJlIG1lcmdlZCBpbnRvIG9uZSBwb2x5Z29uLgogICAqCiAgICogQGF1dGhvciBxaWFvIC8gaHR0cHM6Ly9naXRodWIuY29tL3FpYW8gKG9yaWdpbmFsIGF1dGhvciwgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9xaWFvL3RocmVlLmpzL2NvbW1pdC84NTAyNmYwYzc2OWU0MDAwMTQ4YTY3ZDQ1YTllOWI5YzUxMDg4MzZmKQogICAqIEBhdXRob3Igc2NodGVwcGUgLyBodHRwczovL2dpdGh1Yi5jb20vc2NodGVwcGUKICAgKiBAc2VlIGh0dHBzOi8vd3d3LmFsdGRldmJsb2dhZGF5LmNvbS8yMDExLzA1LzEzL2NvbnRhY3QtZ2VuZXJhdGlvbi1iZXR3ZWVuLTNkLWNvbnZleC1tZXNoZXMvCiAgICoKICAgKiBAdG9kbyBNb3ZlIHRoZSBjbGlwcGluZyBmdW5jdGlvbnMgdG8gQ29udGFjdEdlbmVyYXRvcj8KICAgKiBAdG9kbyBBdXRvbWF0aWNhbGx5IG1lcmdlIGNvcGxhbmFyIHBvbHlnb25zIGluIGNvbnN0cnVjdG9yLgogICAqIEBleGFtcGxlCiAgICogICAgIGNvbnN0IGNvbnZleFNoYXBlID0gbmV3IENBTk5PTi5Db252ZXhQb2x5aGVkcm9uKHsgdmVydGljZXMsIGZhY2VzIH0pCiAgICogICAgIGNvbnN0IGNvbnZleEJvZHkgPSBuZXcgQ0FOTk9OLkJvZHkoeyBtYXNzOiAxLCBzaGFwZTogY29udmV4U2hhcGUgfSkKICAgKiAgICAgd29ybGQuYWRkQm9keShjb252ZXhCb2R5KQogICAqLwogIGNsYXNzIENvbnZleFBvbHloZWRyb24gZXh0ZW5kcyBTaGFwZSB7CiAgICAvKiogdmVydGljZXMgKi8KCiAgICAvKioKICAgICAqIEFycmF5IG9mIGludGVnZXIgYXJyYXlzLCBpbmRpY2F0aW5nIHdoaWNoIHZlcnRpY2VzIGVhY2ggZmFjZSBjb25zaXN0cyBvZgogICAgICovCgogICAgLyoqIGZhY2VOb3JtYWxzICovCgogICAgLyoqIHdvcmxkVmVydGljZXMgKi8KCiAgICAvKiogd29ybGRWZXJ0aWNlc05lZWRzVXBkYXRlICovCgogICAgLyoqIHdvcmxkRmFjZU5vcm1hbHMgKi8KCiAgICAvKiogd29ybGRGYWNlTm9ybWFsc05lZWRzVXBkYXRlICovCgogICAgLyoqCiAgICAgKiBJZiBnaXZlbiwgdGhlc2UgbG9jYWxseSBkZWZpbmVkLCBub3JtYWxpemVkIGF4ZXMgYXJlIHRoZSBvbmx5IG9uZXMgYmVpbmcgY2hlY2tlZCB3aGVuIGRvaW5nIHNlcGFyYXRpbmcgYXhpcyBjaGVjay4KICAgICAqLwoKICAgIC8qKiB1bmlxdWVFZGdlcyAqLwoKICAgIC8qKgogICAgICogQHBhcmFtIHZlcnRpY2VzIEFuIGFycmF5IG9mIFZlYzMncwogICAgICogQHBhcmFtIGZhY2VzIEFycmF5IG9mIGludGVnZXIgYXJyYXlzLCBkZXNjcmliaW5nIHdoaWNoIHZlcnRpY2VzIHRoYXQgaXMgaW5jbHVkZWQgaW4gZWFjaCBmYWNlLgogICAgICovCiAgICBjb25zdHJ1Y3Rvcihwcm9wcykgewogICAgICBpZiAocHJvcHMgPT09IHZvaWQgMCkgewogICAgICAgIHByb3BzID0ge307CiAgICAgIH0KCiAgICAgIGNvbnN0IHsKICAgICAgICB2ZXJ0aWNlcyA9IFtdLAogICAgICAgIGZhY2VzID0gW10sCiAgICAgICAgbm9ybWFscyA9IFtdLAogICAgICAgIGF4ZXMsCiAgICAgICAgYm91bmRpbmdTcGhlcmVSYWRpdXMKICAgICAgfSA9IHByb3BzOwogICAgICBzdXBlcih7CiAgICAgICAgdHlwZTogU2hhcGUudHlwZXMuQ09OVkVYUE9MWUhFRFJPTgogICAgICB9KTsKICAgICAgdGhpcy52ZXJ0aWNlcyA9IHZlcnRpY2VzOwogICAgICB0aGlzLmZhY2VzID0gZmFjZXM7CiAgICAgIHRoaXMuZmFjZU5vcm1hbHMgPSBub3JtYWxzOwoKICAgICAgaWYgKHRoaXMuZmFjZU5vcm1hbHMubGVuZ3RoID09PSAwKSB7CiAgICAgICAgdGhpcy5jb21wdXRlTm9ybWFscygpOwogICAgICB9CgogICAgICBpZiAoIWJvdW5kaW5nU3BoZXJlUmFkaXVzKSB7CiAgICAgICAgdGhpcy51cGRhdGVCb3VuZGluZ1NwaGVyZVJhZGl1cygpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuYm91bmRpbmdTcGhlcmVSYWRpdXMgPSBib3VuZGluZ1NwaGVyZVJhZGl1czsKICAgICAgfQoKICAgICAgdGhpcy53b3JsZFZlcnRpY2VzID0gW107IC8vIFdvcmxkIHRyYW5zZm9ybWVkIHZlcnNpb24gb2YgLnZlcnRpY2VzCgogICAgICB0aGlzLndvcmxkVmVydGljZXNOZWVkc1VwZGF0ZSA9IHRydWU7CiAgICAgIHRoaXMud29ybGRGYWNlTm9ybWFscyA9IFtdOyAvLyBXb3JsZCB0cmFuc2Zvcm1lZCB2ZXJzaW9uIG9mIC5mYWNlTm9ybWFscwoKICAgICAgdGhpcy53b3JsZEZhY2VOb3JtYWxzTmVlZHNVcGRhdGUgPSB0cnVlOwogICAgICB0aGlzLnVuaXF1ZUF4ZXMgPSBheGVzID8gYXhlcy5zbGljZSgpIDogbnVsbDsKICAgICAgdGhpcy51bmlxdWVFZGdlcyA9IFtdOwogICAgICB0aGlzLmNvbXB1dGVFZGdlcygpOwogICAgfQogICAgLyoqCiAgICAgKiBDb21wdXRlcyB1bmlxdWVFZGdlcwogICAgICovCgoKICAgIGNvbXB1dGVFZGdlcygpIHsKICAgICAgY29uc3QgZmFjZXMgPSB0aGlzLmZhY2VzOwogICAgICBjb25zdCB2ZXJ0aWNlcyA9IHRoaXMudmVydGljZXM7CiAgICAgIGNvbnN0IGVkZ2VzID0gdGhpcy51bmlxdWVFZGdlczsKICAgICAgZWRnZXMubGVuZ3RoID0gMDsKICAgICAgY29uc3QgZWRnZSA9IG5ldyBWZWMzKCk7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gZmFjZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICBjb25zdCBmYWNlID0gZmFjZXNbaV07CiAgICAgICAgY29uc3QgbnVtVmVydGljZXMgPSBmYWNlLmxlbmd0aDsKCiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogIT09IG51bVZlcnRpY2VzOyBqKyspIHsKICAgICAgICAgIGNvbnN0IGsgPSAoaiArIDEpICUgbnVtVmVydGljZXM7CiAgICAgICAgICB2ZXJ0aWNlc1tmYWNlW2pdXS52c3ViKHZlcnRpY2VzW2ZhY2Vba11dLCBlZGdlKTsKICAgICAgICAgIGVkZ2Uubm9ybWFsaXplKCk7CiAgICAgICAgICBsZXQgZm91bmQgPSBmYWxzZTsKCiAgICAgICAgICBmb3IgKGxldCBwID0gMDsgcCAhPT0gZWRnZXMubGVuZ3RoOyBwKyspIHsKICAgICAgICAgICAgaWYgKGVkZ2VzW3BdLmFsbW9zdEVxdWFscyhlZGdlKSB8fCBlZGdlc1twXS5hbG1vc3RFcXVhbHMoZWRnZSkpIHsKICAgICAgICAgICAgICBmb3VuZCA9IHRydWU7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoIWZvdW5kKSB7CiAgICAgICAgICAgIGVkZ2VzLnB1c2goZWRnZS5jbG9uZSgpKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogQ29tcHV0ZSB0aGUgbm9ybWFscyBvZiB0aGUgZmFjZXMuCiAgICAgKiBXaWxsIHJldXNlIGV4aXN0aW5nIFZlYzMgb2JqZWN0cyBpbiB0aGUgYGZhY2VOb3JtYWxzYCBhcnJheSBpZiB0aGV5IGV4aXN0LgogICAgICovCgoKICAgIGNvbXB1dGVOb3JtYWxzKCkgewogICAgICB0aGlzLmZhY2VOb3JtYWxzLmxlbmd0aCA9IHRoaXMuZmFjZXMubGVuZ3RoOyAvLyBHZW5lcmF0ZSBub3JtYWxzCgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuZmFjZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICAvLyBDaGVjayBzbyBhbGwgdmVydGljZXMgZXhpc3RzIGZvciB0aGlzIGZhY2UKICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHRoaXMuZmFjZXNbaV0ubGVuZ3RoOyBqKyspIHsKICAgICAgICAgIGlmICghdGhpcy52ZXJ0aWNlc1t0aGlzLmZhY2VzW2ldW2pdXSkgewogICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFZlcnRleCAke3RoaXMuZmFjZXNbaV1bal19IG5vdCBmb3VuZCFgKTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGNvbnN0IG4gPSB0aGlzLmZhY2VOb3JtYWxzW2ldIHx8IG5ldyBWZWMzKCk7CiAgICAgICAgdGhpcy5nZXRGYWNlTm9ybWFsKGksIG4pOwogICAgICAgIG4ubmVnYXRlKG4pOwogICAgICAgIHRoaXMuZmFjZU5vcm1hbHNbaV0gPSBuOwogICAgICAgIGNvbnN0IHZlcnRleCA9IHRoaXMudmVydGljZXNbdGhpcy5mYWNlc1tpXVswXV07CgogICAgICAgIGlmIChuLmRvdCh2ZXJ0ZXgpIDwgMCkgewogICAgICAgICAgY29uc29sZS5lcnJvcihgLmZhY2VOb3JtYWxzWyR7aX1dID0gVmVjMygke24udG9TdHJpbmcoKX0pIGxvb2tzIGxpa2UgaXQgcG9pbnRzIGludG8gdGhlIHNoYXBlPyBUaGUgdmVydGljZXMgZm9sbG93LiBNYWtlIHN1cmUgdGhleSBhcmUgb3JkZXJlZCBDQ1cgYXJvdW5kIHRoZSBub3JtYWwsIHVzaW5nIHRoZSByaWdodCBoYW5kIHJ1bGUuYCk7CgogICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB0aGlzLmZhY2VzW2ldLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgIGNvbnNvbGUud2FybihgLnZlcnRpY2VzWyR7dGhpcy5mYWNlc1tpXVtqXX1dID0gVmVjMygke3RoaXMudmVydGljZXNbdGhpcy5mYWNlc1tpXVtqXV0udG9TdHJpbmcoKX0pYCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIENvbXB1dGUgdGhlIG5vcm1hbCBvZiBhIGZhY2UgZnJvbSBpdHMgdmVydGljZXMKICAgICAqLwoKCiAgICBnZXRGYWNlTm9ybWFsKGksIHRhcmdldCkgewogICAgICBjb25zdCBmID0gdGhpcy5mYWNlc1tpXTsKICAgICAgY29uc3QgdmEgPSB0aGlzLnZlcnRpY2VzW2ZbMF1dOwogICAgICBjb25zdCB2YiA9IHRoaXMudmVydGljZXNbZlsxXV07CiAgICAgIGNvbnN0IHZjID0gdGhpcy52ZXJ0aWNlc1tmWzJdXTsKICAgICAgQ29udmV4UG9seWhlZHJvbi5jb21wdXRlTm9ybWFsKHZhLCB2YiwgdmMsIHRhcmdldCk7CiAgICB9CiAgICAvKioKICAgICAqIEdldCBmYWNlIG5vcm1hbCBnaXZlbiAzIHZlcnRpY2VzCiAgICAgKi8KCgogICAgc3RhdGljIGNvbXB1dGVOb3JtYWwodmEsIHZiLCB2YywgdGFyZ2V0KSB7CiAgICAgIGNvbnN0IGNiID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3QgYWIgPSBuZXcgVmVjMygpOwogICAgICB2Yi52c3ViKHZhLCBhYik7CiAgICAgIHZjLnZzdWIodmIsIGNiKTsKICAgICAgY2IuY3Jvc3MoYWIsIHRhcmdldCk7CgogICAgICBpZiAoIXRhcmdldC5pc1plcm8oKSkgewogICAgICAgIHRhcmdldC5ub3JtYWxpemUoKTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBAcGFyYW0gbWluRGlzdCBDbGFtcCBkaXN0YW5jZQogICAgICogQHBhcmFtIHJlc3VsdCBUaGUgYW4gYXJyYXkgb2YgY29udGFjdCBwb2ludCBvYmplY3RzLCBzZWUgY2xpcEZhY2VBZ2FpbnN0SHVsbAogICAgICovCgoKICAgIGNsaXBBZ2FpbnN0SHVsbChwb3NBLCBxdWF0QSwgaHVsbEIsIHBvc0IsIHF1YXRCLCBzZXBhcmF0aW5nTm9ybWFsLCBtaW5EaXN0LCBtYXhEaXN0LCByZXN1bHQpIHsKICAgICAgY29uc3QgV29ybGROb3JtYWwgPSBuZXcgVmVjMygpOwogICAgICBsZXQgY2xvc2VzdEZhY2VCID0gLTE7CiAgICAgIGxldCBkbWF4ID0gLU51bWJlci5NQVhfVkFMVUU7CgogICAgICBmb3IgKGxldCBmYWNlID0gMDsgZmFjZSA8IGh1bGxCLmZhY2VzLmxlbmd0aDsgZmFjZSsrKSB7CiAgICAgICAgV29ybGROb3JtYWwuY29weShodWxsQi5mYWNlTm9ybWFsc1tmYWNlXSk7CiAgICAgICAgcXVhdEIudm11bHQoV29ybGROb3JtYWwsIFdvcmxkTm9ybWFsKTsKICAgICAgICBjb25zdCBkID0gV29ybGROb3JtYWwuZG90KHNlcGFyYXRpbmdOb3JtYWwpOwoKICAgICAgICBpZiAoZCA+IGRtYXgpIHsKICAgICAgICAgIGRtYXggPSBkOwogICAgICAgICAgY2xvc2VzdEZhY2VCID0gZmFjZTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGNvbnN0IHdvcmxkVmVydHNCMSA9IFtdOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBodWxsQi5mYWNlc1tjbG9zZXN0RmFjZUJdLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgY29uc3QgYiA9IGh1bGxCLnZlcnRpY2VzW2h1bGxCLmZhY2VzW2Nsb3Nlc3RGYWNlQl1baV1dOwogICAgICAgIGNvbnN0IHdvcmxkYiA9IG5ldyBWZWMzKCk7CiAgICAgICAgd29ybGRiLmNvcHkoYik7CiAgICAgICAgcXVhdEIudm11bHQod29ybGRiLCB3b3JsZGIpOwogICAgICAgIHBvc0IudmFkZCh3b3JsZGIsIHdvcmxkYik7CiAgICAgICAgd29ybGRWZXJ0c0IxLnB1c2god29ybGRiKTsKICAgICAgfQoKICAgICAgaWYgKGNsb3Nlc3RGYWNlQiA+PSAwKSB7CiAgICAgICAgdGhpcy5jbGlwRmFjZUFnYWluc3RIdWxsKHNlcGFyYXRpbmdOb3JtYWwsIHBvc0EsIHF1YXRBLCB3b3JsZFZlcnRzQjEsIG1pbkRpc3QsIG1heERpc3QsIHJlc3VsdCk7CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogRmluZCB0aGUgc2VwYXJhdGluZyBheGlzIGJldHdlZW4gdGhpcyBodWxsIGFuZCBhbm90aGVyCiAgICAgKiBAcGFyYW0gdGFyZ2V0IFRoZSB0YXJnZXQgdmVjdG9yIHRvIHNhdmUgdGhlIGF4aXMgaW4KICAgICAqIEByZXR1cm4gUmV0dXJucyBmYWxzZSBpZiBhIHNlcGFyYXRpb24gaXMgZm91bmQsIGVsc2UgdHJ1ZQogICAgICovCgoKICAgIGZpbmRTZXBhcmF0aW5nQXhpcyhodWxsQiwgcG9zQSwgcXVhdEEsIHBvc0IsIHF1YXRCLCB0YXJnZXQsIGZhY2VMaXN0QSwgZmFjZUxpc3RCKSB7CiAgICAgIGNvbnN0IGZhY2VBTm9ybWFsV1MzID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3QgV29ybGRub3JtYWwxID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3QgZGVsdGFDID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3Qgd29ybGRFZGdlMCA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IHdvcmxkRWRnZTEgPSBuZXcgVmVjMygpOwogICAgICBjb25zdCBDcm9zcyA9IG5ldyBWZWMzKCk7CiAgICAgIGxldCBkbWluID0gTnVtYmVyLk1BWF9WQUxVRTsKICAgICAgY29uc3QgaHVsbEEgPSB0aGlzOwoKICAgICAgaWYgKCFodWxsQS51bmlxdWVBeGVzKSB7CiAgICAgICAgY29uc3QgbnVtRmFjZXNBID0gZmFjZUxpc3RBID8gZmFjZUxpc3RBLmxlbmd0aCA6IGh1bGxBLmZhY2VzLmxlbmd0aDsgLy8gVGVzdCBmYWNlIG5vcm1hbHMgZnJvbSBodWxsQQoKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG51bUZhY2VzQTsgaSsrKSB7CiAgICAgICAgICBjb25zdCBmaSA9IGZhY2VMaXN0QSA/IGZhY2VMaXN0QVtpXSA6IGk7IC8vIEdldCB3b3JsZCBmYWNlIG5vcm1hbAoKICAgICAgICAgIGZhY2VBTm9ybWFsV1MzLmNvcHkoaHVsbEEuZmFjZU5vcm1hbHNbZmldKTsKICAgICAgICAgIHF1YXRBLnZtdWx0KGZhY2VBTm9ybWFsV1MzLCBmYWNlQU5vcm1hbFdTMyk7CiAgICAgICAgICBjb25zdCBkID0gaHVsbEEudGVzdFNlcEF4aXMoZmFjZUFOb3JtYWxXUzMsIGh1bGxCLCBwb3NBLCBxdWF0QSwgcG9zQiwgcXVhdEIpOwoKICAgICAgICAgIGlmIChkID09PSBmYWxzZSkgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGQgPCBkbWluKSB7CiAgICAgICAgICAgIGRtaW4gPSBkOwogICAgICAgICAgICB0YXJnZXQuY29weShmYWNlQU5vcm1hbFdTMyk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIC8vIFRlc3QgdW5pcXVlIGF4ZXMKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gaHVsbEEudW5pcXVlQXhlcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgLy8gR2V0IHdvcmxkIGF4aXMKICAgICAgICAgIHF1YXRBLnZtdWx0KGh1bGxBLnVuaXF1ZUF4ZXNbaV0sIGZhY2VBTm9ybWFsV1MzKTsKICAgICAgICAgIGNvbnN0IGQgPSBodWxsQS50ZXN0U2VwQXhpcyhmYWNlQU5vcm1hbFdTMywgaHVsbEIsIHBvc0EsIHF1YXRBLCBwb3NCLCBxdWF0Qik7CgogICAgICAgICAgaWYgKGQgPT09IGZhbHNlKSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoZCA8IGRtaW4pIHsKICAgICAgICAgICAgZG1pbiA9IGQ7CiAgICAgICAgICAgIHRhcmdldC5jb3B5KGZhY2VBTm9ybWFsV1MzKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmICghaHVsbEIudW5pcXVlQXhlcykgewogICAgICAgIC8vIFRlc3QgZmFjZSBub3JtYWxzIGZyb20gaHVsbEIKICAgICAgICBjb25zdCBudW1GYWNlc0IgPSBmYWNlTGlzdEIgPyBmYWNlTGlzdEIubGVuZ3RoIDogaHVsbEIuZmFjZXMubGVuZ3RoOwoKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG51bUZhY2VzQjsgaSsrKSB7CiAgICAgICAgICBjb25zdCBmaSA9IGZhY2VMaXN0QiA/IGZhY2VMaXN0QltpXSA6IGk7CiAgICAgICAgICBXb3JsZG5vcm1hbDEuY29weShodWxsQi5mYWNlTm9ybWFsc1tmaV0pOwogICAgICAgICAgcXVhdEIudm11bHQoV29ybGRub3JtYWwxLCBXb3JsZG5vcm1hbDEpOwogICAgICAgICAgY29uc3QgZCA9IGh1bGxBLnRlc3RTZXBBeGlzKFdvcmxkbm9ybWFsMSwgaHVsbEIsIHBvc0EsIHF1YXRBLCBwb3NCLCBxdWF0Qik7CgogICAgICAgICAgaWYgKGQgPT09IGZhbHNlKSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoZCA8IGRtaW4pIHsKICAgICAgICAgICAgZG1pbiA9IGQ7CiAgICAgICAgICAgIHRhcmdldC5jb3B5KFdvcmxkbm9ybWFsMSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIC8vIFRlc3QgdW5pcXVlIGF4ZXMgaW4gQgogICAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSBodWxsQi51bmlxdWVBeGVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICBxdWF0Qi52bXVsdChodWxsQi51bmlxdWVBeGVzW2ldLCBXb3JsZG5vcm1hbDEpOwogICAgICAgICAgY29uc3QgZCA9IGh1bGxBLnRlc3RTZXBBeGlzKFdvcmxkbm9ybWFsMSwgaHVsbEIsIHBvc0EsIHF1YXRBLCBwb3NCLCBxdWF0Qik7CgogICAgICAgICAgaWYgKGQgPT09IGZhbHNlKSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoZCA8IGRtaW4pIHsKICAgICAgICAgICAgZG1pbiA9IGQ7CiAgICAgICAgICAgIHRhcmdldC5jb3B5KFdvcmxkbm9ybWFsMSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IC8vIFRlc3QgZWRnZXMKCgogICAgICBmb3IgKGxldCBlMCA9IDA7IGUwICE9PSBodWxsQS51bmlxdWVFZGdlcy5sZW5ndGg7IGUwKyspIHsKICAgICAgICAvLyBHZXQgd29ybGQgZWRnZQogICAgICAgIHF1YXRBLnZtdWx0KGh1bGxBLnVuaXF1ZUVkZ2VzW2UwXSwgd29ybGRFZGdlMCk7CgogICAgICAgIGZvciAobGV0IGUxID0gMDsgZTEgIT09IGh1bGxCLnVuaXF1ZUVkZ2VzLmxlbmd0aDsgZTErKykgewogICAgICAgICAgLy8gR2V0IHdvcmxkIGVkZ2UgMgogICAgICAgICAgcXVhdEIudm11bHQoaHVsbEIudW5pcXVlRWRnZXNbZTFdLCB3b3JsZEVkZ2UxKTsKICAgICAgICAgIHdvcmxkRWRnZTAuY3Jvc3Mod29ybGRFZGdlMSwgQ3Jvc3MpOwoKICAgICAgICAgIGlmICghQ3Jvc3MuYWxtb3N0WmVybygpKSB7CiAgICAgICAgICAgIENyb3NzLm5vcm1hbGl6ZSgpOwogICAgICAgICAgICBjb25zdCBkaXN0ID0gaHVsbEEudGVzdFNlcEF4aXMoQ3Jvc3MsIGh1bGxCLCBwb3NBLCBxdWF0QSwgcG9zQiwgcXVhdEIpOwoKICAgICAgICAgICAgaWYgKGRpc3QgPT09IGZhbHNlKSB7CiAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoZGlzdCA8IGRtaW4pIHsKICAgICAgICAgICAgICBkbWluID0gZGlzdDsKICAgICAgICAgICAgICB0YXJnZXQuY29weShDcm9zcyk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIHBvc0IudnN1Yihwb3NBLCBkZWx0YUMpOwoKICAgICAgaWYgKGRlbHRhQy5kb3QodGFyZ2V0KSA+IDAuMCkgewogICAgICAgIHRhcmdldC5uZWdhdGUodGFyZ2V0KTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgICAvKioKICAgICAqIFRlc3Qgc2VwYXJhdGluZyBheGlzIGFnYWluc3QgdHdvIGh1bGxzLiBCb3RoIGh1bGxzIGFyZSBwcm9qZWN0ZWQgb250byB0aGUgYXhpcyBhbmQgdGhlIG92ZXJsYXAgc2l6ZSBpcyByZXR1cm5lZCBpZiB0aGVyZSBpcyBvbmUuCiAgICAgKiBAcmV0dXJuIFRoZSBvdmVybGFwIGRlcHRoLCBvciBGQUxTRSBpZiBubyBwZW5ldHJhdGlvbi4KICAgICAqLwoKCiAgICB0ZXN0U2VwQXhpcyhheGlzLCBodWxsQiwgcG9zQSwgcXVhdEEsIHBvc0IsIHF1YXRCKSB7CiAgICAgIGNvbnN0IGh1bGxBID0gdGhpczsKICAgICAgQ29udmV4UG9seWhlZHJvbi5wcm9qZWN0KGh1bGxBLCBheGlzLCBwb3NBLCBxdWF0QSwgbWF4bWluQSk7CiAgICAgIENvbnZleFBvbHloZWRyb24ucHJvamVjdChodWxsQiwgYXhpcywgcG9zQiwgcXVhdEIsIG1heG1pbkIpOwogICAgICBjb25zdCBtYXhBID0gbWF4bWluQVswXTsKICAgICAgY29uc3QgbWluQSA9IG1heG1pbkFbMV07CiAgICAgIGNvbnN0IG1heEIgPSBtYXhtaW5CWzBdOwogICAgICBjb25zdCBtaW5CID0gbWF4bWluQlsxXTsKCiAgICAgIGlmIChtYXhBIDwgbWluQiB8fCBtYXhCIDwgbWluQSkgewogICAgICAgIHJldHVybiBmYWxzZTsgLy8gU2VwYXJhdGVkCiAgICAgIH0KCiAgICAgIGNvbnN0IGQwID0gbWF4QSAtIG1pbkI7CiAgICAgIGNvbnN0IGQxID0gbWF4QiAtIG1pbkE7CiAgICAgIGNvbnN0IGRlcHRoID0gZDAgPCBkMSA/IGQwIDogZDE7CiAgICAgIHJldHVybiBkZXB0aDsKICAgIH0KICAgIC8qKgogICAgICogY2FsY3VsYXRlTG9jYWxJbmVydGlhCiAgICAgKi8KCgogICAgY2FsY3VsYXRlTG9jYWxJbmVydGlhKG1hc3MsIHRhcmdldCkgewogICAgICAvLyBBcHByb3hpbWF0ZSB3aXRoIGJveCBpbmVydGlhCiAgICAgIC8vIEV4YWN0IGluZXJ0aWEgY2FsY3VsYXRpb24gaXMgb3ZlcmtpbGwsIGJ1dCBzZWUgaHR0cDovL2dlb21ldHJpY3Rvb2xzLmNvbS9Eb2N1bWVudGF0aW9uL1BvbHloZWRyYWxNYXNzUHJvcGVydGllcy5wZGYgZm9yIHRoZSBjb3JyZWN0IHdheSB0byBkbyBpdAogICAgICBjb25zdCBhYWJibWF4ID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3QgYWFiYm1pbiA9IG5ldyBWZWMzKCk7CiAgICAgIHRoaXMuY29tcHV0ZUxvY2FsQUFCQihhYWJibWluLCBhYWJibWF4KTsKICAgICAgY29uc3QgeCA9IGFhYmJtYXgueCAtIGFhYmJtaW4ueDsKICAgICAgY29uc3QgeSA9IGFhYmJtYXgueSAtIGFhYmJtaW4ueTsKICAgICAgY29uc3QgeiA9IGFhYmJtYXgueiAtIGFhYmJtaW4uejsKICAgICAgdGFyZ2V0LnggPSAxLjAgLyAxMi4wICogbWFzcyAqICgyICogeSAqIDIgKiB5ICsgMiAqIHogKiAyICogeik7CiAgICAgIHRhcmdldC55ID0gMS4wIC8gMTIuMCAqIG1hc3MgKiAoMiAqIHggKiAyICogeCArIDIgKiB6ICogMiAqIHopOwogICAgICB0YXJnZXQueiA9IDEuMCAvIDEyLjAgKiBtYXNzICogKDIgKiB5ICogMiAqIHkgKyAyICogeCAqIDIgKiB4KTsKICAgIH0KICAgIC8qKgogICAgICogQHBhcmFtIGZhY2VfaSBJbmRleCBvZiB0aGUgZmFjZQogICAgICovCgoKICAgIGdldFBsYW5lQ29uc3RhbnRPZkZhY2UoZmFjZV9pKSB7CiAgICAgIGNvbnN0IGYgPSB0aGlzLmZhY2VzW2ZhY2VfaV07CiAgICAgIGNvbnN0IG4gPSB0aGlzLmZhY2VOb3JtYWxzW2ZhY2VfaV07CiAgICAgIGNvbnN0IHYgPSB0aGlzLnZlcnRpY2VzW2ZbMF1dOwogICAgICBjb25zdCBjID0gLW4uZG90KHYpOwogICAgICByZXR1cm4gYzsKICAgIH0KICAgIC8qKgogICAgICogQ2xpcCBhIGZhY2UgYWdhaW5zdCBhIGh1bGwuCiAgICAgKiBAcGFyYW0gd29ybGRWZXJ0c0IxIEFuIGFycmF5IG9mIFZlYzMgd2l0aCB2ZXJ0aWNlcyBpbiB0aGUgd29ybGQgZnJhbWUuCiAgICAgKiBAcGFyYW0gbWluRGlzdCBEaXN0YW5jZSBjbGFtcGluZwogICAgICogQHBhcmFtIEFycmF5IHJlc3VsdCBBcnJheSB0byBzdG9yZSByZXN1bHRpbmcgY29udGFjdCBwb2ludHMgaW4uIFdpbGwgYmUgb2JqZWN0cyB3aXRoIHByb3BlcnRpZXM6IHBvaW50LCBkZXB0aCwgbm9ybWFsLiBUaGVzZSBhcmUgcmVwcmVzZW50ZWQgaW4gd29ybGQgY29vcmRpbmF0ZXMuCiAgICAgKi8KCgogICAgY2xpcEZhY2VBZ2FpbnN0SHVsbChzZXBhcmF0aW5nTm9ybWFsLCBwb3NBLCBxdWF0QSwgd29ybGRWZXJ0c0IxLCBtaW5EaXN0LCBtYXhEaXN0LCByZXN1bHQpIHsKICAgICAgY29uc3QgZmFjZUFOb3JtYWxXUyA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IGVkZ2UwID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3QgV29ybGRFZGdlMCA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IHdvcmxkUGxhbmVBbm9ybWFsMSA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IHBsYW5lTm9ybWFsV1MxID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3Qgd29ybGRBMSA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IGxvY2FsUGxhbmVOb3JtYWwgPSBuZXcgVmVjMygpOwogICAgICBjb25zdCBwbGFuZU5vcm1hbFdTID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3QgaHVsbEEgPSB0aGlzOwogICAgICBjb25zdCB3b3JsZFZlcnRzQjIgPSBbXTsKICAgICAgY29uc3QgcFZ0eEluID0gd29ybGRWZXJ0c0IxOwogICAgICBjb25zdCBwVnR4T3V0ID0gd29ybGRWZXJ0c0IyOwogICAgICBsZXQgY2xvc2VzdEZhY2VBID0gLTE7CiAgICAgIGxldCBkbWluID0gTnVtYmVyLk1BWF9WQUxVRTsgLy8gRmluZCB0aGUgZmFjZSB3aXRoIG5vcm1hbCBjbG9zZXN0IHRvIHRoZSBzZXBhcmF0aW5nIGF4aXMKCiAgICAgIGZvciAobGV0IGZhY2UgPSAwOyBmYWNlIDwgaHVsbEEuZmFjZXMubGVuZ3RoOyBmYWNlKyspIHsKICAgICAgICBmYWNlQU5vcm1hbFdTLmNvcHkoaHVsbEEuZmFjZU5vcm1hbHNbZmFjZV0pOwogICAgICAgIHF1YXRBLnZtdWx0KGZhY2VBTm9ybWFsV1MsIGZhY2VBTm9ybWFsV1MpOwogICAgICAgIGNvbnN0IGQgPSBmYWNlQU5vcm1hbFdTLmRvdChzZXBhcmF0aW5nTm9ybWFsKTsKCiAgICAgICAgaWYgKGQgPCBkbWluKSB7CiAgICAgICAgICBkbWluID0gZDsKICAgICAgICAgIGNsb3Nlc3RGYWNlQSA9IGZhY2U7CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAoY2xvc2VzdEZhY2VBIDwgMCkgewogICAgICAgIHJldHVybjsKICAgICAgfSAvLyBHZXQgdGhlIGZhY2UgYW5kIGNvbnN0cnVjdCBjb25uZWN0ZWQgZmFjZXMKCgogICAgICBjb25zdCBwb2x5QSA9IGh1bGxBLmZhY2VzW2Nsb3Nlc3RGYWNlQV07CiAgICAgIHBvbHlBLmNvbm5lY3RlZEZhY2VzID0gW107CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGh1bGxBLmZhY2VzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBodWxsQS5mYWNlc1tpXS5sZW5ndGg7IGorKykgewogICAgICAgICAgaWYgKAogICAgICAgICAgLyogU2hhcmluZyBhIHZlcnRleCovCiAgICAgICAgICBwb2x5QS5pbmRleE9mKGh1bGxBLmZhY2VzW2ldW2pdKSAhPT0gLTEgJiYKICAgICAgICAgIC8qIE5vdCB0aGUgb25lIHdlIGFyZSBsb29raW5nIGZvciBjb25uZWN0aW9ucyBmcm9tICovCiAgICAgICAgICBpICE9PSBjbG9zZXN0RmFjZUEgJiYKICAgICAgICAgIC8qIE5vdCBhbHJlYWR5IGFkZGVkICovCiAgICAgICAgICBwb2x5QS5jb25uZWN0ZWRGYWNlcy5pbmRleE9mKGkpID09PSAtMSkgewogICAgICAgICAgICBwb2x5QS5jb25uZWN0ZWRGYWNlcy5wdXNoKGkpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSAvLyBDbGlwIHRoZSBwb2x5Z29uIHRvIHRoZSBiYWNrIG9mIHRoZSBwbGFuZXMgb2YgYWxsIGZhY2VzIG9mIGh1bGwgQSwKICAgICAgLy8gdGhhdCBhcmUgYWRqYWNlbnQgdG8gdGhlIHdpdG5lc3MgZmFjZQoKCiAgICAgIGNvbnN0IG51bVZlcnRpY2VzQSA9IHBvbHlBLmxlbmd0aDsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbnVtVmVydGljZXNBOyBpKyspIHsKICAgICAgICBjb25zdCBhID0gaHVsbEEudmVydGljZXNbcG9seUFbaV1dOwogICAgICAgIGNvbnN0IGIgPSBodWxsQS52ZXJ0aWNlc1twb2x5QVsoaSArIDEpICUgbnVtVmVydGljZXNBXV07CiAgICAgICAgYS52c3ViKGIsIGVkZ2UwKTsKICAgICAgICBXb3JsZEVkZ2UwLmNvcHkoZWRnZTApOwogICAgICAgIHF1YXRBLnZtdWx0KFdvcmxkRWRnZTAsIFdvcmxkRWRnZTApOwogICAgICAgIHBvc0EudmFkZChXb3JsZEVkZ2UwLCBXb3JsZEVkZ2UwKTsKICAgICAgICB3b3JsZFBsYW5lQW5vcm1hbDEuY29weSh0aGlzLmZhY2VOb3JtYWxzW2Nsb3Nlc3RGYWNlQV0pOwogICAgICAgIHF1YXRBLnZtdWx0KHdvcmxkUGxhbmVBbm9ybWFsMSwgd29ybGRQbGFuZUFub3JtYWwxKTsKICAgICAgICBwb3NBLnZhZGQod29ybGRQbGFuZUFub3JtYWwxLCB3b3JsZFBsYW5lQW5vcm1hbDEpOwogICAgICAgIFdvcmxkRWRnZTAuY3Jvc3Mod29ybGRQbGFuZUFub3JtYWwxLCBwbGFuZU5vcm1hbFdTMSk7CiAgICAgICAgcGxhbmVOb3JtYWxXUzEubmVnYXRlKHBsYW5lTm9ybWFsV1MxKTsKICAgICAgICB3b3JsZEExLmNvcHkoYSk7CiAgICAgICAgcXVhdEEudm11bHQod29ybGRBMSwgd29ybGRBMSk7CiAgICAgICAgcG9zQS52YWRkKHdvcmxkQTEsIHdvcmxkQTEpOwogICAgICAgIGNvbnN0IG90aGVyRmFjZSA9IHBvbHlBLmNvbm5lY3RlZEZhY2VzW2ldOwogICAgICAgIGxvY2FsUGxhbmVOb3JtYWwuY29weSh0aGlzLmZhY2VOb3JtYWxzW290aGVyRmFjZV0pOwogICAgICAgIGNvbnN0IGxvY2FsUGxhbmVFcSA9IHRoaXMuZ2V0UGxhbmVDb25zdGFudE9mRmFjZShvdGhlckZhY2UpOwogICAgICAgIHBsYW5lTm9ybWFsV1MuY29weShsb2NhbFBsYW5lTm9ybWFsKTsKICAgICAgICBxdWF0QS52bXVsdChwbGFuZU5vcm1hbFdTLCBwbGFuZU5vcm1hbFdTKTsKICAgICAgICBjb25zdCBwbGFuZUVxV1MgPSBsb2NhbFBsYW5lRXEgLSBwbGFuZU5vcm1hbFdTLmRvdChwb3NBKTsgLy8gQ2xpcCBmYWNlIGFnYWluc3Qgb3VyIGNvbnN0cnVjdGVkIHBsYW5lCgogICAgICAgIHRoaXMuY2xpcEZhY2VBZ2FpbnN0UGxhbmUocFZ0eEluLCBwVnR4T3V0LCBwbGFuZU5vcm1hbFdTLCBwbGFuZUVxV1MpOyAvLyBUaHJvdyBhd2F5IGFsbCBjbGlwcGVkIHBvaW50cywgYnV0IHNhdmUgdGhlIHJlbWFpbmluZyB1bnRpbCBuZXh0IGNsaXAKCiAgICAgICAgd2hpbGUgKHBWdHhJbi5sZW5ndGgpIHsKICAgICAgICAgIHBWdHhJbi5zaGlmdCgpOwogICAgICAgIH0KCiAgICAgICAgd2hpbGUgKHBWdHhPdXQubGVuZ3RoKSB7CiAgICAgICAgICBwVnR4SW4ucHVzaChwVnR4T3V0LnNoaWZ0KCkpOwogICAgICAgIH0KICAgICAgfSAvLyBvbmx5IGtlZXAgY29udGFjdCBwb2ludHMgdGhhdCBhcmUgYmVoaW5kIHRoZSB3aXRuZXNzIGZhY2UKCgogICAgICBsb2NhbFBsYW5lTm9ybWFsLmNvcHkodGhpcy5mYWNlTm9ybWFsc1tjbG9zZXN0RmFjZUFdKTsKICAgICAgY29uc3QgbG9jYWxQbGFuZUVxID0gdGhpcy5nZXRQbGFuZUNvbnN0YW50T2ZGYWNlKGNsb3Nlc3RGYWNlQSk7CiAgICAgIHBsYW5lTm9ybWFsV1MuY29weShsb2NhbFBsYW5lTm9ybWFsKTsKICAgICAgcXVhdEEudm11bHQocGxhbmVOb3JtYWxXUywgcGxhbmVOb3JtYWxXUyk7CiAgICAgIGNvbnN0IHBsYW5lRXFXUyA9IGxvY2FsUGxhbmVFcSAtIHBsYW5lTm9ybWFsV1MuZG90KHBvc0EpOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwVnR4SW4ubGVuZ3RoOyBpKyspIHsKICAgICAgICBsZXQgZGVwdGggPSBwbGFuZU5vcm1hbFdTLmRvdChwVnR4SW5baV0pICsgcGxhbmVFcVdTOyAvLyA/Pz8KCiAgICAgICAgaWYgKGRlcHRoIDw9IG1pbkRpc3QpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKGBjbGFtcGVkOiBkZXB0aD0ke2RlcHRofSB0byBtaW5EaXN0PSR7bWluRGlzdH1gKTsKICAgICAgICAgIGRlcHRoID0gbWluRGlzdDsKICAgICAgICB9CgogICAgICAgIGlmIChkZXB0aCA8PSBtYXhEaXN0KSB7CiAgICAgICAgICBjb25zdCBwb2ludCA9IHBWdHhJbltpXTsKCiAgICAgICAgICBpZiAoZGVwdGggPD0gMWUtNikgewogICAgICAgICAgICBjb25zdCBwID0gewogICAgICAgICAgICAgIHBvaW50LAogICAgICAgICAgICAgIG5vcm1hbDogcGxhbmVOb3JtYWxXUywKICAgICAgICAgICAgICBkZXB0aAogICAgICAgICAgICB9OwogICAgICAgICAgICByZXN1bHQucHVzaChwKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogQ2xpcCBhIGZhY2UgaW4gYSBodWxsIGFnYWluc3QgdGhlIGJhY2sgb2YgYSBwbGFuZS4KICAgICAqIEBwYXJhbSBwbGFuZUNvbnN0YW50IFRoZSBjb25zdGFudCBpbiB0aGUgbWF0aGVtYXRpY2FsIHBsYW5lIGVxdWF0aW9uCiAgICAgKi8KCgogICAgY2xpcEZhY2VBZ2FpbnN0UGxhbmUoaW5WZXJ0aWNlcywgb3V0VmVydGljZXMsIHBsYW5lTm9ybWFsLCBwbGFuZUNvbnN0YW50KSB7CiAgICAgIGxldCBuX2RvdF9maXJzdDsKICAgICAgbGV0IG5fZG90X2xhc3Q7CiAgICAgIGNvbnN0IG51bVZlcnRzID0gaW5WZXJ0aWNlcy5sZW5ndGg7CgogICAgICBpZiAobnVtVmVydHMgPCAyKSB7CiAgICAgICAgcmV0dXJuIG91dFZlcnRpY2VzOwogICAgICB9CgogICAgICBsZXQgZmlyc3RWZXJ0ZXggPSBpblZlcnRpY2VzW2luVmVydGljZXMubGVuZ3RoIC0gMV07CiAgICAgIGxldCBsYXN0VmVydGV4ID0gaW5WZXJ0aWNlc1swXTsKICAgICAgbl9kb3RfZmlyc3QgPSBwbGFuZU5vcm1hbC5kb3QoZmlyc3RWZXJ0ZXgpICsgcGxhbmVDb25zdGFudDsKCiAgICAgIGZvciAobGV0IHZpID0gMDsgdmkgPCBudW1WZXJ0czsgdmkrKykgewogICAgICAgIGxhc3RWZXJ0ZXggPSBpblZlcnRpY2VzW3ZpXTsKICAgICAgICBuX2RvdF9sYXN0ID0gcGxhbmVOb3JtYWwuZG90KGxhc3RWZXJ0ZXgpICsgcGxhbmVDb25zdGFudDsKCiAgICAgICAgaWYgKG5fZG90X2ZpcnN0IDwgMCkgewogICAgICAgICAgaWYgKG5fZG90X2xhc3QgPCAwKSB7CiAgICAgICAgICAgIC8vIFN0YXJ0IDwgMCwgZW5kIDwgMCwgc28gb3V0cHV0IGxhc3RWZXJ0ZXgKICAgICAgICAgICAgY29uc3QgbmV3diA9IG5ldyBWZWMzKCk7CiAgICAgICAgICAgIG5ld3YuY29weShsYXN0VmVydGV4KTsKICAgICAgICAgICAgb3V0VmVydGljZXMucHVzaChuZXd2KTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIFN0YXJ0IDwgMCwgZW5kID49IDAsIHNvIG91dHB1dCBpbnRlcnNlY3Rpb24KICAgICAgICAgICAgY29uc3QgbmV3diA9IG5ldyBWZWMzKCk7CiAgICAgICAgICAgIGZpcnN0VmVydGV4LmxlcnAobGFzdFZlcnRleCwgbl9kb3RfZmlyc3QgLyAobl9kb3RfZmlyc3QgLSBuX2RvdF9sYXN0KSwgbmV3dik7CiAgICAgICAgICAgIG91dFZlcnRpY2VzLnB1c2gobmV3dik7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGlmIChuX2RvdF9sYXN0IDwgMCkgewogICAgICAgICAgICAvLyBTdGFydCA+PSAwLCBlbmQgPCAwIHNvIG91dHB1dCBpbnRlcnNlY3Rpb24gYW5kIGVuZAogICAgICAgICAgICBjb25zdCBuZXd2ID0gbmV3IFZlYzMoKTsKICAgICAgICAgICAgZmlyc3RWZXJ0ZXgubGVycChsYXN0VmVydGV4LCBuX2RvdF9maXJzdCAvIChuX2RvdF9maXJzdCAtIG5fZG90X2xhc3QpLCBuZXd2KTsKICAgICAgICAgICAgb3V0VmVydGljZXMucHVzaChuZXd2KTsKICAgICAgICAgICAgb3V0VmVydGljZXMucHVzaChsYXN0VmVydGV4KTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGZpcnN0VmVydGV4ID0gbGFzdFZlcnRleDsKICAgICAgICBuX2RvdF9maXJzdCA9IG5fZG90X2xhc3Q7CiAgICAgIH0KCiAgICAgIHJldHVybiBvdXRWZXJ0aWNlczsKICAgIH0KICAgIC8qKgogICAgICogVXBkYXRlcyBgLndvcmxkVmVydGljZXNgIGFuZCBzZXRzIGAud29ybGRWZXJ0aWNlc05lZWRzVXBkYXRlYCB0byBmYWxzZS4KICAgICAqLwoKCiAgICBjb21wdXRlV29ybGRWZXJ0aWNlcyhwb3NpdGlvbiwgcXVhdCkgewogICAgICB3aGlsZSAodGhpcy53b3JsZFZlcnRpY2VzLmxlbmd0aCA8IHRoaXMudmVydGljZXMubGVuZ3RoKSB7CiAgICAgICAgdGhpcy53b3JsZFZlcnRpY2VzLnB1c2gobmV3IFZlYzMoKSk7CiAgICAgIH0KCiAgICAgIGNvbnN0IHZlcnRzID0gdGhpcy52ZXJ0aWNlczsKICAgICAgY29uc3Qgd29ybGRWZXJ0cyA9IHRoaXMud29ybGRWZXJ0aWNlczsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSB0aGlzLnZlcnRpY2VzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgcXVhdC52bXVsdCh2ZXJ0c1tpXSwgd29ybGRWZXJ0c1tpXSk7CiAgICAgICAgcG9zaXRpb24udmFkZCh3b3JsZFZlcnRzW2ldLCB3b3JsZFZlcnRzW2ldKTsKICAgICAgfQoKICAgICAgdGhpcy53b3JsZFZlcnRpY2VzTmVlZHNVcGRhdGUgPSBmYWxzZTsKICAgIH0KCiAgICBjb21wdXRlTG9jYWxBQUJCKGFhYmJtaW4sIGFhYmJtYXgpIHsKICAgICAgY29uc3QgdmVydGljZXMgPSB0aGlzLnZlcnRpY2VzOwogICAgICBhYWJibWluLnNldChOdW1iZXIuTUFYX1ZBTFVFLCBOdW1iZXIuTUFYX1ZBTFVFLCBOdW1iZXIuTUFYX1ZBTFVFKTsKICAgICAgYWFiYm1heC5zZXQoLU51bWJlci5NQVhfVkFMVUUsIC1OdW1iZXIuTUFYX1ZBTFVFLCAtTnVtYmVyLk1BWF9WQUxVRSk7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMudmVydGljZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICBjb25zdCB2ID0gdmVydGljZXNbaV07CgogICAgICAgIGlmICh2LnggPCBhYWJibWluLngpIHsKICAgICAgICAgIGFhYmJtaW4ueCA9IHYueDsKICAgICAgICB9IGVsc2UgaWYgKHYueCA+IGFhYmJtYXgueCkgewogICAgICAgICAgYWFiYm1heC54ID0gdi54OwogICAgICAgIH0KCiAgICAgICAgaWYgKHYueSA8IGFhYmJtaW4ueSkgewogICAgICAgICAgYWFiYm1pbi55ID0gdi55OwogICAgICAgIH0gZWxzZSBpZiAodi55ID4gYWFiYm1heC55KSB7CiAgICAgICAgICBhYWJibWF4LnkgPSB2Lnk7CiAgICAgICAgfQoKICAgICAgICBpZiAodi56IDwgYWFiYm1pbi56KSB7CiAgICAgICAgICBhYWJibWluLnogPSB2Lno7CiAgICAgICAgfSBlbHNlIGlmICh2LnogPiBhYWJibWF4LnopIHsKICAgICAgICAgIGFhYmJtYXgueiA9IHYuejsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogVXBkYXRlcyBgd29ybGRWZXJ0aWNlc2AgYW5kIHNldHMgYHdvcmxkVmVydGljZXNOZWVkc1VwZGF0ZWAgdG8gZmFsc2UuCiAgICAgKi8KCgogICAgY29tcHV0ZVdvcmxkRmFjZU5vcm1hbHMocXVhdCkgewogICAgICBjb25zdCBOID0gdGhpcy5mYWNlTm9ybWFscy5sZW5ndGg7CgogICAgICB3aGlsZSAodGhpcy53b3JsZEZhY2VOb3JtYWxzLmxlbmd0aCA8IE4pIHsKICAgICAgICB0aGlzLndvcmxkRmFjZU5vcm1hbHMucHVzaChuZXcgVmVjMygpKTsKICAgICAgfQoKICAgICAgY29uc3Qgbm9ybWFscyA9IHRoaXMuZmFjZU5vcm1hbHM7CiAgICAgIGNvbnN0IHdvcmxkTm9ybWFscyA9IHRoaXMud29ybGRGYWNlTm9ybWFsczsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSBOOyBpKyspIHsKICAgICAgICBxdWF0LnZtdWx0KG5vcm1hbHNbaV0sIHdvcmxkTm9ybWFsc1tpXSk7CiAgICAgIH0KCiAgICAgIHRoaXMud29ybGRGYWNlTm9ybWFsc05lZWRzVXBkYXRlID0gZmFsc2U7CiAgICB9CiAgICAvKioKICAgICAqIHVwZGF0ZUJvdW5kaW5nU3BoZXJlUmFkaXVzCiAgICAgKi8KCgogICAgdXBkYXRlQm91bmRpbmdTcGhlcmVSYWRpdXMoKSB7CiAgICAgIC8vIEFzc3VtZSBwb2ludHMgYXJlIGRpc3RyaWJ1dGVkIHdpdGggbG9jYWwgKDAsMCwwKSBhcyBjZW50ZXIKICAgICAgbGV0IG1heDIgPSAwOwogICAgICBjb25zdCB2ZXJ0cyA9IHRoaXMudmVydGljZXM7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gdmVydHMubGVuZ3RoOyBpKyspIHsKICAgICAgICBjb25zdCBub3JtMiA9IHZlcnRzW2ldLmxlbmd0aFNxdWFyZWQoKTsKCiAgICAgICAgaWYgKG5vcm0yID4gbWF4MikgewogICAgICAgICAgbWF4MiA9IG5vcm0yOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhpcy5ib3VuZGluZ1NwaGVyZVJhZGl1cyA9IE1hdGguc3FydChtYXgyKTsKICAgIH0KICAgIC8qKgogICAgICogY2FsY3VsYXRlV29ybGRBQUJCCiAgICAgKi8KCgogICAgY2FsY3VsYXRlV29ybGRBQUJCKHBvcywgcXVhdCwgbWluLCBtYXgpIHsKICAgICAgY29uc3QgdmVydHMgPSB0aGlzLnZlcnRpY2VzOwogICAgICBsZXQgbWlueDsKICAgICAgbGV0IG1pbnk7CiAgICAgIGxldCBtaW56OwogICAgICBsZXQgbWF4eDsKICAgICAgbGV0IG1heHk7CiAgICAgIGxldCBtYXh6OwogICAgICBsZXQgdGVtcFdvcmxkVmVydGV4ID0gbmV3IFZlYzMoKTsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdmVydHMubGVuZ3RoOyBpKyspIHsKICAgICAgICB0ZW1wV29ybGRWZXJ0ZXguY29weSh2ZXJ0c1tpXSk7CiAgICAgICAgcXVhdC52bXVsdCh0ZW1wV29ybGRWZXJ0ZXgsIHRlbXBXb3JsZFZlcnRleCk7CiAgICAgICAgcG9zLnZhZGQodGVtcFdvcmxkVmVydGV4LCB0ZW1wV29ybGRWZXJ0ZXgpOwogICAgICAgIGNvbnN0IHYgPSB0ZW1wV29ybGRWZXJ0ZXg7CgogICAgICAgIGlmIChtaW54ID09PSB1bmRlZmluZWQgfHwgdi54IDwgbWlueCkgewogICAgICAgICAgbWlueCA9IHYueDsKICAgICAgICB9CgogICAgICAgIGlmIChtYXh4ID09PSB1bmRlZmluZWQgfHwgdi54ID4gbWF4eCkgewogICAgICAgICAgbWF4eCA9IHYueDsKICAgICAgICB9CgogICAgICAgIGlmIChtaW55ID09PSB1bmRlZmluZWQgfHwgdi55IDwgbWlueSkgewogICAgICAgICAgbWlueSA9IHYueTsKICAgICAgICB9CgogICAgICAgIGlmIChtYXh5ID09PSB1bmRlZmluZWQgfHwgdi55ID4gbWF4eSkgewogICAgICAgICAgbWF4eSA9IHYueTsKICAgICAgICB9CgogICAgICAgIGlmIChtaW56ID09PSB1bmRlZmluZWQgfHwgdi56IDwgbWlueikgewogICAgICAgICAgbWlueiA9IHYuejsKICAgICAgICB9CgogICAgICAgIGlmIChtYXh6ID09PSB1bmRlZmluZWQgfHwgdi56ID4gbWF4eikgewogICAgICAgICAgbWF4eiA9IHYuejsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIG1pbi5zZXQobWlueCwgbWlueSwgbWlueik7CiAgICAgIG1heC5zZXQobWF4eCwgbWF4eSwgbWF4eik7CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhcHByb3hpbWF0ZSBjb252ZXggdm9sdW1lCiAgICAgKi8KCgogICAgdm9sdW1lKCkgewogICAgICByZXR1cm4gNC4wICogTWF0aC5QSSAqIHRoaXMuYm91bmRpbmdTcGhlcmVSYWRpdXMgLyAzLjA7CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhbiBhdmVyYWdlIG9mIGFsbCB0aGUgdmVydGljZXMgcG9zaXRpb25zCiAgICAgKi8KCgogICAgZ2V0QXZlcmFnZVBvaW50TG9jYWwodGFyZ2V0KSB7CiAgICAgIGlmICh0YXJnZXQgPT09IHZvaWQgMCkgewogICAgICAgIHRhcmdldCA9IG5ldyBWZWMzKCk7CiAgICAgIH0KCiAgICAgIGNvbnN0IHZlcnRzID0gdGhpcy52ZXJ0aWNlczsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdmVydHMubGVuZ3RoOyBpKyspIHsKICAgICAgICB0YXJnZXQudmFkZCh2ZXJ0c1tpXSwgdGFyZ2V0KTsKICAgICAgfQoKICAgICAgdGFyZ2V0LnNjYWxlKDEgLyB2ZXJ0cy5sZW5ndGgsIHRhcmdldCk7CiAgICAgIHJldHVybiB0YXJnZXQ7CiAgICB9CiAgICAvKioKICAgICAqIFRyYW5zZm9ybSBhbGwgbG9jYWwgcG9pbnRzLiBXaWxsIGNoYW5nZSB0aGUgLnZlcnRpY2VzCiAgICAgKi8KCgogICAgdHJhbnNmb3JtQWxsUG9pbnRzKG9mZnNldCwgcXVhdCkgewogICAgICBjb25zdCBuID0gdGhpcy52ZXJ0aWNlcy5sZW5ndGg7CiAgICAgIGNvbnN0IHZlcnRzID0gdGhpcy52ZXJ0aWNlczsgLy8gQXBwbHkgcm90YXRpb24KCiAgICAgIGlmIChxdWF0KSB7CiAgICAgICAgLy8gUm90YXRlIHZlcnRpY2VzCiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBuOyBpKyspIHsKICAgICAgICAgIGNvbnN0IHYgPSB2ZXJ0c1tpXTsKICAgICAgICAgIHF1YXQudm11bHQodiwgdik7CiAgICAgICAgfSAvLyBSb3RhdGUgZmFjZSBub3JtYWxzCgoKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuZmFjZU5vcm1hbHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIGNvbnN0IHYgPSB0aGlzLmZhY2VOb3JtYWxzW2ldOwogICAgICAgICAgcXVhdC52bXVsdCh2LCB2KTsKICAgICAgICB9CiAgICAgICAgLyoKICAgICAgICAgICAgICAvLyBSb3RhdGUgZWRnZXMKICAgICAgICAgICAgICBmb3IobGV0IGk9MDsgaTx0aGlzLnVuaXF1ZUVkZ2VzLmxlbmd0aDsgaSsrKXsKICAgICAgICAgICAgICAgICAgY29uc3QgdiA9IHRoaXMudW5pcXVlRWRnZXNbaV07CiAgICAgICAgICAgICAgICAgIHF1YXQudm11bHQodix2KTsKICAgICAgICAgICAgICB9Ki8KCiAgICAgIH0gLy8gQXBwbHkgb2Zmc2V0CgoKICAgICAgaWYgKG9mZnNldCkgewogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbjsgaSsrKSB7CiAgICAgICAgICBjb25zdCB2ID0gdmVydHNbaV07CiAgICAgICAgICB2LnZhZGQob2Zmc2V0LCB2KTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogQ2hlY2tzIHdoZXRoZXIgcCBpcyBpbnNpZGUgdGhlIHBvbHloZWRyYS4gTXVzdCBiZSBpbiBsb2NhbCBjb29yZHMuCiAgICAgKiBUaGUgcG9pbnQgbGllcyBvdXRzaWRlIG9mIHRoZSBjb252ZXggaHVsbCBvZiB0aGUgb3RoZXIgcG9pbnRzIGlmIGFuZCBvbmx5IGlmIHRoZSBkaXJlY3Rpb24KICAgICAqIG9mIGFsbCB0aGUgdmVjdG9ycyBmcm9tIGl0IHRvIHRob3NlIG90aGVyIHBvaW50cyBhcmUgb24gbGVzcyB0aGFuIG9uZSBoYWxmIG9mIGEgc3BoZXJlIGFyb3VuZCBpdC4KICAgICAqIEBwYXJhbSBwIEEgcG9pbnQgZ2l2ZW4gaW4gbG9jYWwgY29vcmRpbmF0ZXMKICAgICAqLwoKCiAgICBwb2ludElzSW5zaWRlKHApIHsKICAgICAgY29uc3QgdmVydHMgPSB0aGlzLnZlcnRpY2VzOwogICAgICBjb25zdCBmYWNlcyA9IHRoaXMuZmFjZXM7CiAgICAgIGNvbnN0IG5vcm1hbHMgPSB0aGlzLmZhY2VOb3JtYWxzOwogICAgICBjb25zdCBwb3NpdGl2ZVJlc3VsdCA9IG51bGw7CiAgICAgIGNvbnN0IHBvaW50SW5zaWRlID0gbmV3IFZlYzMoKTsKICAgICAgdGhpcy5nZXRBdmVyYWdlUG9pbnRMb2NhbChwb2ludEluc2lkZSk7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuZmFjZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICBsZXQgbiA9IG5vcm1hbHNbaV07CiAgICAgICAgY29uc3QgdiA9IHZlcnRzW2ZhY2VzW2ldWzBdXTsgLy8gV2Ugb25seSBuZWVkIG9uZSBwb2ludCBpbiB0aGUgZmFjZQogICAgICAgIC8vIFRoaXMgZG90IHByb2R1Y3QgZGV0ZXJtaW5lcyB3aGljaCBzaWRlIG9mIHRoZSBlZGdlIHRoZSBwb2ludCBpcwoKICAgICAgICBjb25zdCB2VG9QID0gbmV3IFZlYzMoKTsKICAgICAgICBwLnZzdWIodiwgdlRvUCk7CiAgICAgICAgY29uc3QgcjEgPSBuLmRvdCh2VG9QKTsKICAgICAgICBjb25zdCB2VG9Qb2ludEluc2lkZSA9IG5ldyBWZWMzKCk7CiAgICAgICAgcG9pbnRJbnNpZGUudnN1Yih2LCB2VG9Qb2ludEluc2lkZSk7CiAgICAgICAgY29uc3QgcjIgPSBuLmRvdCh2VG9Qb2ludEluc2lkZSk7CgogICAgICAgIGlmIChyMSA8IDAgJiYgcjIgPiAwIHx8IHIxID4gMCAmJiByMiA8IDApIHsKICAgICAgICAgIHJldHVybiBmYWxzZTsgLy8gRW5jb3VudGVyZWQgc29tZSBvdGhlciBzaWduLiBFeGl0LgogICAgICAgIH0KICAgICAgfSAvLyBJZiB3ZSBnb3QgaGVyZSwgYWxsIGRvdCBwcm9kdWN0cyB3ZXJlIG9mIHRoZSBzYW1lIHNpZ24uCgoKICAgICAgcmV0dXJuIHBvc2l0aXZlUmVzdWx0ID8gMSA6IC0xOwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgbWF4IGFuZCBtaW4gZG90IHByb2R1Y3Qgb2YgYSBjb252ZXggaHVsbCBhdCBwb3NpdGlvbiAocG9zLHF1YXQpIHByb2plY3RlZCBvbnRvIGFuIGF4aXMuCiAgICAgKiBSZXN1bHRzIGFyZSBzYXZlZCBpbiB0aGUgYXJyYXkgbWF4bWluLgogICAgICogQHBhcmFtIHJlc3VsdCByZXN1bHRbMF0gYW5kIHJlc3VsdFsxXSB3aWxsIGJlIHNldCB0byBtYXhpbXVtIGFuZCBtaW5pbXVtLCByZXNwZWN0aXZlbHkuCiAgICAgKi8KCgogICAgc3RhdGljIHByb2plY3Qoc2hhcGUsIGF4aXMsIHBvcywgcXVhdCwgcmVzdWx0KSB7CiAgICAgIGNvbnN0IG4gPSBzaGFwZS52ZXJ0aWNlcy5sZW5ndGg7CiAgICAgIGNvbnN0IGxvY2FsQXhpcyA9IHByb2plY3RfbG9jYWxBeGlzOwogICAgICBsZXQgbWF4ID0gMDsKICAgICAgbGV0IG1pbiA9IDA7CiAgICAgIGNvbnN0IGxvY2FsT3JpZ2luID0gcHJvamVjdF9sb2NhbE9yaWdpbjsKICAgICAgY29uc3QgdnMgPSBzaGFwZS52ZXJ0aWNlczsKICAgICAgbG9jYWxPcmlnaW4uc2V0WmVybygpOyAvLyBUcmFuc2Zvcm0gdGhlIGF4aXMgdG8gbG9jYWwKCiAgICAgIFRyYW5zZm9ybS52ZWN0b3JUb0xvY2FsRnJhbWUocG9zLCBxdWF0LCBheGlzLCBsb2NhbEF4aXMpOwogICAgICBUcmFuc2Zvcm0ucG9pbnRUb0xvY2FsRnJhbWUocG9zLCBxdWF0LCBsb2NhbE9yaWdpbiwgbG9jYWxPcmlnaW4pOwogICAgICBjb25zdCBhZGQgPSBsb2NhbE9yaWdpbi5kb3QobG9jYWxBeGlzKTsKICAgICAgbWluID0gbWF4ID0gdnNbMF0uZG90KGxvY2FsQXhpcyk7CgogICAgICBmb3IgKGxldCBpID0gMTsgaSA8IG47IGkrKykgewogICAgICAgIGNvbnN0IHZhbCA9IHZzW2ldLmRvdChsb2NhbEF4aXMpOwoKICAgICAgICBpZiAodmFsID4gbWF4KSB7CiAgICAgICAgICBtYXggPSB2YWw7CiAgICAgICAgfQoKICAgICAgICBpZiAodmFsIDwgbWluKSB7CiAgICAgICAgICBtaW4gPSB2YWw7CiAgICAgICAgfQogICAgICB9CgogICAgICBtaW4gLT0gYWRkOwogICAgICBtYXggLT0gYWRkOwoKICAgICAgaWYgKG1pbiA+IG1heCkgewogICAgICAgIC8vIEluY29uc2lzdGVudCAtIHN3YXAKICAgICAgICBjb25zdCB0ZW1wID0gbWluOwogICAgICAgIG1pbiA9IG1heDsKICAgICAgICBtYXggPSB0ZW1wOwogICAgICB9IC8vIE91dHB1dAoKCiAgICAgIHJlc3VsdFswXSA9IG1heDsKICAgICAgcmVzdWx0WzFdID0gbWluOwogICAgfQoKICB9CiAgY29uc3QgbWF4bWluQSA9IFtdOwogIGNvbnN0IG1heG1pbkIgPSBbXTsKICBuZXcgVmVjMygpOwogIGNvbnN0IHByb2plY3RfbG9jYWxBeGlzID0gbmV3IFZlYzMoKTsKICBjb25zdCBwcm9qZWN0X2xvY2FsT3JpZ2luID0gbmV3IFZlYzMoKTsKCiAgLyoqCiAgICogQSAzZCBib3ggc2hhcGUuCiAgICogQGV4YW1wbGUKICAgKiAgICAgY29uc3Qgc2l6ZSA9IDEKICAgKiAgICAgY29uc3QgaGFsZkV4dGVudHMgPSBuZXcgQ0FOTk9OLlZlYzMoc2l6ZSwgc2l6ZSwgc2l6ZSkKICAgKiAgICAgY29uc3QgYm94U2hhcGUgPSBuZXcgQ0FOTk9OLkJveChoYWxmRXh0ZW50cykKICAgKiAgICAgY29uc3QgYm94Qm9keSA9IG5ldyBDQU5OT04uQm9keSh7IG1hc3M6IDEsIHNoYXBlOiBib3hTaGFwZSB9KQogICAqICAgICB3b3JsZC5hZGRCb2R5KGJveEJvZHkpCiAgICovCiAgY2xhc3MgQm94IGV4dGVuZHMgU2hhcGUgewogICAgLyoqCiAgICAgKiBUaGUgaGFsZiBleHRlbnRzIG9mIHRoZSBib3guCiAgICAgKi8KCiAgICAvKioKICAgICAqIFVzZWQgYnkgdGhlIGNvbnRhY3QgZ2VuZXJhdG9yIHRvIG1ha2UgY29udGFjdHMgd2l0aCBvdGhlciBjb252ZXggcG9seWhlZHJhIGZvciBleGFtcGxlLgogICAgICovCiAgICBjb25zdHJ1Y3RvcihoYWxmRXh0ZW50cykgewogICAgICBzdXBlcih7CiAgICAgICAgdHlwZTogU2hhcGUudHlwZXMuQk9YCiAgICAgIH0pOwogICAgICB0aGlzLmhhbGZFeHRlbnRzID0gaGFsZkV4dGVudHM7CiAgICAgIHRoaXMuY29udmV4UG9seWhlZHJvblJlcHJlc2VudGF0aW9uID0gbnVsbDsKICAgICAgdGhpcy51cGRhdGVDb252ZXhQb2x5aGVkcm9uUmVwcmVzZW50YXRpb24oKTsKICAgICAgdGhpcy51cGRhdGVCb3VuZGluZ1NwaGVyZVJhZGl1cygpOwogICAgfQogICAgLyoqCiAgICAgKiBVcGRhdGVzIHRoZSBsb2NhbCBjb252ZXggcG9seWhlZHJvbiByZXByZXNlbnRhdGlvbiB1c2VkIGZvciBzb21lIGNvbGxpc2lvbnMuCiAgICAgKi8KCgogICAgdXBkYXRlQ29udmV4UG9seWhlZHJvblJlcHJlc2VudGF0aW9uKCkgewogICAgICBjb25zdCBzeCA9IHRoaXMuaGFsZkV4dGVudHMueDsKICAgICAgY29uc3Qgc3kgPSB0aGlzLmhhbGZFeHRlbnRzLnk7CiAgICAgIGNvbnN0IHN6ID0gdGhpcy5oYWxmRXh0ZW50cy56OwogICAgICBjb25zdCBWID0gVmVjMzsKICAgICAgY29uc3QgdmVydGljZXMgPSBbbmV3IFYoLXN4LCAtc3ksIC1zeiksIG5ldyBWKHN4LCAtc3ksIC1zeiksIG5ldyBWKHN4LCBzeSwgLXN6KSwgbmV3IFYoLXN4LCBzeSwgLXN6KSwgbmV3IFYoLXN4LCAtc3ksIHN6KSwgbmV3IFYoc3gsIC1zeSwgc3opLCBuZXcgVihzeCwgc3ksIHN6KSwgbmV3IFYoLXN4LCBzeSwgc3opXTsKICAgICAgY29uc3QgZmFjZXMgPSBbWzMsIDIsIDEsIDBdLCAvLyAtegogICAgICBbNCwgNSwgNiwgN10sIC8vICt6CiAgICAgIFs1LCA0LCAwLCAxXSwgLy8gLXkKICAgICAgWzIsIDMsIDcsIDZdLCAvLyAreQogICAgICBbMCwgNCwgNywgM10sIC8vIC14CiAgICAgIFsxLCAyLCA2LCA1XSAvLyAreAogICAgICBdOwogICAgICBjb25zdCBheGVzID0gW25ldyBWKDAsIDAsIDEpLCBuZXcgVigwLCAxLCAwKSwgbmV3IFYoMSwgMCwgMCldOwogICAgICBjb25zdCBoID0gbmV3IENvbnZleFBvbHloZWRyb24oewogICAgICAgIHZlcnRpY2VzLAogICAgICAgIGZhY2VzLAogICAgICAgIGF4ZXMKICAgICAgfSk7CiAgICAgIHRoaXMuY29udmV4UG9seWhlZHJvblJlcHJlc2VudGF0aW9uID0gaDsKICAgICAgaC5tYXRlcmlhbCA9IHRoaXMubWF0ZXJpYWw7CiAgICB9CiAgICAvKioKICAgICAqIENhbGN1bGF0ZSB0aGUgaW5lcnRpYSBvZiB0aGUgYm94LgogICAgICovCgoKICAgIGNhbGN1bGF0ZUxvY2FsSW5lcnRpYShtYXNzLCB0YXJnZXQpIHsKICAgICAgaWYgKHRhcmdldCA9PT0gdm9pZCAwKSB7CiAgICAgICAgdGFyZ2V0ID0gbmV3IFZlYzMoKTsKICAgICAgfQoKICAgICAgQm94LmNhbGN1bGF0ZUluZXJ0aWEodGhpcy5oYWxmRXh0ZW50cywgbWFzcywgdGFyZ2V0KTsKICAgICAgcmV0dXJuIHRhcmdldDsKICAgIH0KCiAgICBzdGF0aWMgY2FsY3VsYXRlSW5lcnRpYShoYWxmRXh0ZW50cywgbWFzcywgdGFyZ2V0KSB7CiAgICAgIGNvbnN0IGUgPSBoYWxmRXh0ZW50czsKICAgICAgdGFyZ2V0LnggPSAxLjAgLyAxMi4wICogbWFzcyAqICgyICogZS55ICogMiAqIGUueSArIDIgKiBlLnogKiAyICogZS56KTsKICAgICAgdGFyZ2V0LnkgPSAxLjAgLyAxMi4wICogbWFzcyAqICgyICogZS54ICogMiAqIGUueCArIDIgKiBlLnogKiAyICogZS56KTsKICAgICAgdGFyZ2V0LnogPSAxLjAgLyAxMi4wICogbWFzcyAqICgyICogZS55ICogMiAqIGUueSArIDIgKiBlLnggKiAyICogZS54KTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IHRoZSBib3ggNiBzaWRlIG5vcm1hbHMKICAgICAqIEBwYXJhbSBzaXhUYXJnZXRWZWN0b3JzIEFuIGFycmF5IG9mIDYgdmVjdG9ycywgdG8gc3RvcmUgdGhlIHJlc3VsdGluZyBzaWRlIG5vcm1hbHMgaW4uCiAgICAgKiBAcGFyYW0gcXVhdCBPcmllbnRhdGlvbiB0byBhcHBseSB0byB0aGUgbm9ybWFsIHZlY3RvcnMuIElmIG5vdCBwcm92aWRlZCwgdGhlIHZlY3RvcnMgd2lsbCBiZSBpbiByZXNwZWN0IHRvIHRoZSBsb2NhbCBmcmFtZS4KICAgICAqLwoKCiAgICBnZXRTaWRlTm9ybWFscyhzaXhUYXJnZXRWZWN0b3JzLCBxdWF0KSB7CiAgICAgIGNvbnN0IHNpZGVzID0gc2l4VGFyZ2V0VmVjdG9yczsKICAgICAgY29uc3QgZXggPSB0aGlzLmhhbGZFeHRlbnRzOwogICAgICBzaWRlc1swXS5zZXQoZXgueCwgMCwgMCk7CiAgICAgIHNpZGVzWzFdLnNldCgwLCBleC55LCAwKTsKICAgICAgc2lkZXNbMl0uc2V0KDAsIDAsIGV4LnopOwogICAgICBzaWRlc1szXS5zZXQoLWV4LngsIDAsIDApOwogICAgICBzaWRlc1s0XS5zZXQoMCwgLWV4LnksIDApOwogICAgICBzaWRlc1s1XS5zZXQoMCwgMCwgLWV4LnopOwoKICAgICAgaWYgKHF1YXQgIT09IHVuZGVmaW5lZCkgewogICAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSBzaWRlcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgcXVhdC52bXVsdChzaWRlc1tpXSwgc2lkZXNbaV0pOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIHNpZGVzOwogICAgfQogICAgLyoqCiAgICAgKiBSZXR1cm5zIHRoZSB2b2x1bWUgb2YgdGhlIGJveC4KICAgICAqLwoKCiAgICB2b2x1bWUoKSB7CiAgICAgIHJldHVybiA4LjAgKiB0aGlzLmhhbGZFeHRlbnRzLnggKiB0aGlzLmhhbGZFeHRlbnRzLnkgKiB0aGlzLmhhbGZFeHRlbnRzLno7CiAgICB9CiAgICAvKioKICAgICAqIHVwZGF0ZUJvdW5kaW5nU3BoZXJlUmFkaXVzCiAgICAgKi8KCgogICAgdXBkYXRlQm91bmRpbmdTcGhlcmVSYWRpdXMoKSB7CiAgICAgIHRoaXMuYm91bmRpbmdTcGhlcmVSYWRpdXMgPSB0aGlzLmhhbGZFeHRlbnRzLmxlbmd0aCgpOwogICAgfQogICAgLyoqCiAgICAgKiBmb3JFYWNoV29ybGRDb3JuZXIKICAgICAqLwoKCiAgICBmb3JFYWNoV29ybGRDb3JuZXIocG9zLCBxdWF0LCBjYWxsYmFjaykgewogICAgICBjb25zdCBlID0gdGhpcy5oYWxmRXh0ZW50czsKICAgICAgY29uc3QgY29ybmVycyA9IFtbZS54LCBlLnksIGUuel0sIFstZS54LCBlLnksIGUuel0sIFstZS54LCAtZS55LCBlLnpdLCBbLWUueCwgLWUueSwgLWUuel0sIFtlLngsIC1lLnksIC1lLnpdLCBbZS54LCBlLnksIC1lLnpdLCBbLWUueCwgZS55LCAtZS56XSwgW2UueCwgLWUueSwgZS56XV07CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvcm5lcnMubGVuZ3RoOyBpKyspIHsKICAgICAgICB3b3JsZENvcm5lclRlbXBQb3Muc2V0KGNvcm5lcnNbaV1bMF0sIGNvcm5lcnNbaV1bMV0sIGNvcm5lcnNbaV1bMl0pOwogICAgICAgIHF1YXQudm11bHQod29ybGRDb3JuZXJUZW1wUG9zLCB3b3JsZENvcm5lclRlbXBQb3MpOwogICAgICAgIHBvcy52YWRkKHdvcmxkQ29ybmVyVGVtcFBvcywgd29ybGRDb3JuZXJUZW1wUG9zKTsKICAgICAgICBjYWxsYmFjayh3b3JsZENvcm5lclRlbXBQb3MueCwgd29ybGRDb3JuZXJUZW1wUG9zLnksIHdvcmxkQ29ybmVyVGVtcFBvcy56KTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBjYWxjdWxhdGVXb3JsZEFBQkIKICAgICAqLwoKCiAgICBjYWxjdWxhdGVXb3JsZEFBQkIocG9zLCBxdWF0LCBtaW4sIG1heCkgewogICAgICBjb25zdCBlID0gdGhpcy5oYWxmRXh0ZW50czsKICAgICAgd29ybGRDb3JuZXJzVGVtcFswXS5zZXQoZS54LCBlLnksIGUueik7CiAgICAgIHdvcmxkQ29ybmVyc1RlbXBbMV0uc2V0KC1lLngsIGUueSwgZS56KTsKICAgICAgd29ybGRDb3JuZXJzVGVtcFsyXS5zZXQoLWUueCwgLWUueSwgZS56KTsKICAgICAgd29ybGRDb3JuZXJzVGVtcFszXS5zZXQoLWUueCwgLWUueSwgLWUueik7CiAgICAgIHdvcmxkQ29ybmVyc1RlbXBbNF0uc2V0KGUueCwgLWUueSwgLWUueik7CiAgICAgIHdvcmxkQ29ybmVyc1RlbXBbNV0uc2V0KGUueCwgZS55LCAtZS56KTsKICAgICAgd29ybGRDb3JuZXJzVGVtcFs2XS5zZXQoLWUueCwgZS55LCAtZS56KTsKICAgICAgd29ybGRDb3JuZXJzVGVtcFs3XS5zZXQoZS54LCAtZS55LCBlLnopOwogICAgICBjb25zdCB3YyA9IHdvcmxkQ29ybmVyc1RlbXBbMF07CiAgICAgIHF1YXQudm11bHQod2MsIHdjKTsKICAgICAgcG9zLnZhZGQod2MsIHdjKTsKICAgICAgbWF4LmNvcHkod2MpOwogICAgICBtaW4uY29weSh3Yyk7CgogICAgICBmb3IgKGxldCBpID0gMTsgaSA8IDg7IGkrKykgewogICAgICAgIGNvbnN0IHdjID0gd29ybGRDb3JuZXJzVGVtcFtpXTsKICAgICAgICBxdWF0LnZtdWx0KHdjLCB3Yyk7CiAgICAgICAgcG9zLnZhZGQod2MsIHdjKTsKICAgICAgICBjb25zdCB4ID0gd2MueDsKICAgICAgICBjb25zdCB5ID0gd2MueTsKICAgICAgICBjb25zdCB6ID0gd2MuejsKCiAgICAgICAgaWYgKHggPiBtYXgueCkgewogICAgICAgICAgbWF4LnggPSB4OwogICAgICAgIH0KCiAgICAgICAgaWYgKHkgPiBtYXgueSkgewogICAgICAgICAgbWF4LnkgPSB5OwogICAgICAgIH0KCiAgICAgICAgaWYgKHogPiBtYXgueikgewogICAgICAgICAgbWF4LnogPSB6OwogICAgICAgIH0KCiAgICAgICAgaWYgKHggPCBtaW4ueCkgewogICAgICAgICAgbWluLnggPSB4OwogICAgICAgIH0KCiAgICAgICAgaWYgKHkgPCBtaW4ueSkgewogICAgICAgICAgbWluLnkgPSB5OwogICAgICAgIH0KCiAgICAgICAgaWYgKHogPCBtaW4ueikgewogICAgICAgICAgbWluLnogPSB6OwogICAgICAgIH0KICAgICAgfSAvLyBHZXQgZWFjaCBheGlzIG1heAogICAgICAvLyBtaW4uc2V0KEluZmluaXR5LEluZmluaXR5LEluZmluaXR5KTsKICAgICAgLy8gbWF4LnNldCgtSW5maW5pdHksLUluZmluaXR5LC1JbmZpbml0eSk7CiAgICAgIC8vIHRoaXMuZm9yRWFjaFdvcmxkQ29ybmVyKHBvcyxxdWF0LGZ1bmN0aW9uKHgseSx6KXsKICAgICAgLy8gICAgIGlmKHggPiBtYXgueCl7CiAgICAgIC8vICAgICAgICAgbWF4LnggPSB4OwogICAgICAvLyAgICAgfQogICAgICAvLyAgICAgaWYoeSA+IG1heC55KXsKICAgICAgLy8gICAgICAgICBtYXgueSA9IHk7CiAgICAgIC8vICAgICB9CiAgICAgIC8vICAgICBpZih6ID4gbWF4LnopewogICAgICAvLyAgICAgICAgIG1heC56ID0gejsKICAgICAgLy8gICAgIH0KICAgICAgLy8gICAgIGlmKHggPCBtaW4ueCl7CiAgICAgIC8vICAgICAgICAgbWluLnggPSB4OwogICAgICAvLyAgICAgfQogICAgICAvLyAgICAgaWYoeSA8IG1pbi55KXsKICAgICAgLy8gICAgICAgICBtaW4ueSA9IHk7CiAgICAgIC8vICAgICB9CiAgICAgIC8vICAgICBpZih6IDwgbWluLnopewogICAgICAvLyAgICAgICAgIG1pbi56ID0gejsKICAgICAgLy8gICAgIH0KICAgICAgLy8gfSk7CgogICAgfQoKICB9CiAgY29uc3Qgd29ybGRDb3JuZXJUZW1wUG9zID0gbmV3IFZlYzMoKTsKICBjb25zdCB3b3JsZENvcm5lcnNUZW1wID0gW25ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKCldOwoKICAvKioKICAgKiBCT0RZX1RZUEVTCiAgICovCiAgY29uc3QgQk9EWV9UWVBFUyA9IHsKICAgIC8qKiBEWU5BTUlDICovCiAgICBEWU5BTUlDOiAxLAoKICAgIC8qKiBTVEFUSUMgKi8KICAgIFNUQVRJQzogMiwKCiAgICAvKiogS0lORU1BVElDICovCiAgICBLSU5FTUFUSUM6IDQKICB9OwogIC8qKgogICAqIEJvZHlUeXBlCiAgICovCgogIC8qKgogICAqIEJPRFlfU0xFRVBfU1RBVEVTCiAgICovCiAgY29uc3QgQk9EWV9TTEVFUF9TVEFURVMgPSB7CiAgICAvKiogQVdBS0UgKi8KICAgIEFXQUtFOiAwLAoKICAgIC8qKiBTTEVFUFkgKi8KICAgIFNMRUVQWTogMSwKCiAgICAvKiogU0xFRVBJTkcgKi8KICAgIFNMRUVQSU5HOiAyCiAgfTsKICAvKioKICAgKiBCb2R5U2xlZXBTdGF0ZQogICAqLwoKICAvKioKICAgKiBCYXNlIGNsYXNzIGZvciBhbGwgYm9keSB0eXBlcy4KICAgKiBAZXhhbXBsZQogICAqICAgICBjb25zdCBzaGFwZSA9IG5ldyBDQU5OT04uU3BoZXJlKDEpCiAgICogICAgIGNvbnN0IGJvZHkgPSBuZXcgQ0FOTk9OLkJvZHkoewogICAqICAgICAgIG1hc3M6IDEsCiAgICogICAgICAgc2hhcGUsCiAgICogICAgIH0pCiAgICogICAgIHdvcmxkLmFkZEJvZHkoYm9keSkKICAgKi8KICBjbGFzcyBCb2R5IGV4dGVuZHMgRXZlbnRUYXJnZXQgewogICAgLyoqCiAgICAgKiBEaXNwYXRjaGVkIGFmdGVyIHR3byBib2RpZXMgY29sbGlkZS4gVGhpcyBldmVudCBpcyBkaXNwYXRjaGVkIG9uIGVhY2gKICAgICAqIG9mIHRoZSB0d28gYm9kaWVzIGludm9sdmVkIGluIHRoZSBjb2xsaXNpb24uCiAgICAgKiBAZXZlbnQgY29sbGlkZQogICAgICogQHBhcmFtIGJvZHkgVGhlIGJvZHkgdGhhdCB3YXMgaW52b2x2ZWQgaW4gdGhlIGNvbGxpc2lvbi4KICAgICAqIEBwYXJhbSBjb250YWN0IFRoZSBkZXRhaWxzIG9mIHRoZSBjb2xsaXNpb24uCiAgICAgKi8KCiAgICAvKioKICAgICAqIEEgZHluYW1pYyBib2R5IGlzIGZ1bGx5IHNpbXVsYXRlZC4gQ2FuIGJlIG1vdmVkIG1hbnVhbGx5IGJ5IHRoZSB1c2VyLCBidXQgbm9ybWFsbHkgdGhleSBtb3ZlIGFjY29yZGluZyB0byBmb3JjZXMuIEEgZHluYW1pYyBib2R5IGNhbiBjb2xsaWRlIHdpdGggYWxsIGJvZHkgdHlwZXMuIEEgZHluYW1pYyBib2R5IGFsd2F5cyBoYXMgZmluaXRlLCBub24temVybyBtYXNzLgogICAgICovCgogICAgLyoqCiAgICAgKiBBIHN0YXRpYyBib2R5IGRvZXMgbm90IG1vdmUgZHVyaW5nIHNpbXVsYXRpb24gYW5kIGJlaGF2ZXMgYXMgaWYgaXQgaGFzIGluZmluaXRlIG1hc3MuIFN0YXRpYyBib2RpZXMgY2FuIGJlIG1vdmVkIG1hbnVhbGx5IGJ5IHNldHRpbmcgdGhlIHBvc2l0aW9uIG9mIHRoZSBib2R5LiBUaGUgdmVsb2NpdHkgb2YgYSBzdGF0aWMgYm9keSBpcyBhbHdheXMgemVyby4gU3RhdGljIGJvZGllcyBkbyBub3QgY29sbGlkZSB3aXRoIG90aGVyIHN0YXRpYyBvciBraW5lbWF0aWMgYm9kaWVzLgogICAgICovCgogICAgLyoqCiAgICAgKiBBIGtpbmVtYXRpYyBib2R5IG1vdmVzIHVuZGVyIHNpbXVsYXRpb24gYWNjb3JkaW5nIHRvIGl0cyB2ZWxvY2l0eS4gVGhleSBkbyBub3QgcmVzcG9uZCB0byBmb3JjZXMuIFRoZXkgY2FuIGJlIG1vdmVkIG1hbnVhbGx5LCBidXQgbm9ybWFsbHkgYSBraW5lbWF0aWMgYm9keSBpcyBtb3ZlZCBieSBzZXR0aW5nIGl0cyB2ZWxvY2l0eS4gQSBraW5lbWF0aWMgYm9keSBiZWhhdmVzIGFzIGlmIGl0IGhhcyBpbmZpbml0ZSBtYXNzLiBLaW5lbWF0aWMgYm9kaWVzIGRvIG5vdCBjb2xsaWRlIHdpdGggb3RoZXIgc3RhdGljIG9yIGtpbmVtYXRpYyBib2RpZXMuCiAgICAgKi8KCiAgICAvKioKICAgICAqIEFXQUtFCiAgICAgKi8KCiAgICAvKioKICAgICAqIFNMRUVQWQogICAgICovCgogICAgLyoqCiAgICAgKiBTTEVFUElORwogICAgICovCgogICAgLyoqCiAgICAgKiBEaXNwYXRjaGVkIGFmdGVyIGEgc2xlZXBpbmcgYm9keSBoYXMgd29rZW4gdXAuCiAgICAgKiBAZXZlbnQgd2FrZXVwCiAgICAgKi8KCiAgICAvKioKICAgICAqIERpc3BhdGNoZWQgYWZ0ZXIgYSBib2R5IGhhcyBnb25lIGluIHRvIHRoZSBzbGVlcHkgc3RhdGUuCiAgICAgKiBAZXZlbnQgc2xlZXB5CiAgICAgKi8KCiAgICAvKioKICAgICAqIERpc3BhdGNoZWQgYWZ0ZXIgYSBib2R5IGhhcyBmYWxsZW4gYXNsZWVwLgogICAgICogQGV2ZW50IHNsZWVwCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHsKICAgICAgaWYgKG9wdGlvbnMgPT09IHZvaWQgMCkgewogICAgICAgIG9wdGlvbnMgPSB7fTsKICAgICAgfQoKICAgICAgc3VwZXIoKTsKICAgICAgdGhpcy5pZCA9IEJvZHkuaWRDb3VudGVyKys7CiAgICAgIHRoaXMuaW5kZXggPSAtMTsKICAgICAgdGhpcy53b3JsZCA9IG51bGw7CiAgICAgIHRoaXMudmxhbWJkYSA9IG5ldyBWZWMzKCk7CiAgICAgIHRoaXMuY29sbGlzaW9uRmlsdGVyR3JvdXAgPSB0eXBlb2Ygb3B0aW9ucy5jb2xsaXNpb25GaWx0ZXJHcm91cCA9PT0gJ251bWJlcicgPyBvcHRpb25zLmNvbGxpc2lvbkZpbHRlckdyb3VwIDogMTsKICAgICAgdGhpcy5jb2xsaXNpb25GaWx0ZXJNYXNrID0gdHlwZW9mIG9wdGlvbnMuY29sbGlzaW9uRmlsdGVyTWFzayA9PT0gJ251bWJlcicgPyBvcHRpb25zLmNvbGxpc2lvbkZpbHRlck1hc2sgOiAtMTsKICAgICAgdGhpcy5jb2xsaXNpb25SZXNwb25zZSA9IHR5cGVvZiBvcHRpb25zLmNvbGxpc2lvblJlc3BvbnNlID09PSAnYm9vbGVhbicgPyBvcHRpb25zLmNvbGxpc2lvblJlc3BvbnNlIDogdHJ1ZTsKICAgICAgdGhpcy5wb3NpdGlvbiA9IG5ldyBWZWMzKCk7CiAgICAgIHRoaXMucHJldmlvdXNQb3NpdGlvbiA9IG5ldyBWZWMzKCk7CiAgICAgIHRoaXMuaW50ZXJwb2xhdGVkUG9zaXRpb24gPSBuZXcgVmVjMygpOwogICAgICB0aGlzLmluaXRQb3NpdGlvbiA9IG5ldyBWZWMzKCk7CgogICAgICBpZiAob3B0aW9ucy5wb3NpdGlvbikgewogICAgICAgIHRoaXMucG9zaXRpb24uY29weShvcHRpb25zLnBvc2l0aW9uKTsKICAgICAgICB0aGlzLnByZXZpb3VzUG9zaXRpb24uY29weShvcHRpb25zLnBvc2l0aW9uKTsKICAgICAgICB0aGlzLmludGVycG9sYXRlZFBvc2l0aW9uLmNvcHkob3B0aW9ucy5wb3NpdGlvbik7CiAgICAgICAgdGhpcy5pbml0UG9zaXRpb24uY29weShvcHRpb25zLnBvc2l0aW9uKTsKICAgICAgfQoKICAgICAgdGhpcy52ZWxvY2l0eSA9IG5ldyBWZWMzKCk7CgogICAgICBpZiAob3B0aW9ucy52ZWxvY2l0eSkgewogICAgICAgIHRoaXMudmVsb2NpdHkuY29weShvcHRpb25zLnZlbG9jaXR5KTsKICAgICAgfQoKICAgICAgdGhpcy5pbml0VmVsb2NpdHkgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLmZvcmNlID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3QgbWFzcyA9IHR5cGVvZiBvcHRpb25zLm1hc3MgPT09ICdudW1iZXInID8gb3B0aW9ucy5tYXNzIDogMDsKICAgICAgdGhpcy5tYXNzID0gbWFzczsKICAgICAgdGhpcy5pbnZNYXNzID0gbWFzcyA+IDAgPyAxLjAgLyBtYXNzIDogMDsKICAgICAgdGhpcy5tYXRlcmlhbCA9IG9wdGlvbnMubWF0ZXJpYWwgfHwgbnVsbDsKICAgICAgdGhpcy5saW5lYXJEYW1waW5nID0gdHlwZW9mIG9wdGlvbnMubGluZWFyRGFtcGluZyA9PT0gJ251bWJlcicgPyBvcHRpb25zLmxpbmVhckRhbXBpbmcgOiAwLjAxOwogICAgICB0aGlzLnR5cGUgPSBtYXNzIDw9IDAuMCA/IEJvZHkuU1RBVElDIDogQm9keS5EWU5BTUlDOwoKICAgICAgaWYgKHR5cGVvZiBvcHRpb25zLnR5cGUgPT09IHR5cGVvZiBCb2R5LlNUQVRJQykgewogICAgICAgIHRoaXMudHlwZSA9IG9wdGlvbnMudHlwZTsKICAgICAgfQoKICAgICAgdGhpcy5hbGxvd1NsZWVwID0gdHlwZW9mIG9wdGlvbnMuYWxsb3dTbGVlcCAhPT0gJ3VuZGVmaW5lZCcgPyBvcHRpb25zLmFsbG93U2xlZXAgOiB0cnVlOwogICAgICB0aGlzLnNsZWVwU3RhdGUgPSBCb2R5LkFXQUtFOwogICAgICB0aGlzLnNsZWVwU3BlZWRMaW1pdCA9IHR5cGVvZiBvcHRpb25zLnNsZWVwU3BlZWRMaW1pdCAhPT0gJ3VuZGVmaW5lZCcgPyBvcHRpb25zLnNsZWVwU3BlZWRMaW1pdCA6IDAuMTsKICAgICAgdGhpcy5zbGVlcFRpbWVMaW1pdCA9IHR5cGVvZiBvcHRpb25zLnNsZWVwVGltZUxpbWl0ICE9PSAndW5kZWZpbmVkJyA/IG9wdGlvbnMuc2xlZXBUaW1lTGltaXQgOiAxOwogICAgICB0aGlzLnRpbWVMYXN0U2xlZXB5ID0gMDsKICAgICAgdGhpcy53YWtlVXBBZnRlck5hcnJvd3BoYXNlID0gZmFsc2U7CiAgICAgIHRoaXMudG9ycXVlID0gbmV3IFZlYzMoKTsKICAgICAgdGhpcy5xdWF0ZXJuaW9uID0gbmV3IFF1YXRlcm5pb24oKTsKICAgICAgdGhpcy5pbml0UXVhdGVybmlvbiA9IG5ldyBRdWF0ZXJuaW9uKCk7CiAgICAgIHRoaXMucHJldmlvdXNRdWF0ZXJuaW9uID0gbmV3IFF1YXRlcm5pb24oKTsKICAgICAgdGhpcy5pbnRlcnBvbGF0ZWRRdWF0ZXJuaW9uID0gbmV3IFF1YXRlcm5pb24oKTsKCiAgICAgIGlmIChvcHRpb25zLnF1YXRlcm5pb24pIHsKICAgICAgICB0aGlzLnF1YXRlcm5pb24uY29weShvcHRpb25zLnF1YXRlcm5pb24pOwogICAgICAgIHRoaXMuaW5pdFF1YXRlcm5pb24uY29weShvcHRpb25zLnF1YXRlcm5pb24pOwogICAgICAgIHRoaXMucHJldmlvdXNRdWF0ZXJuaW9uLmNvcHkob3B0aW9ucy5xdWF0ZXJuaW9uKTsKICAgICAgICB0aGlzLmludGVycG9sYXRlZFF1YXRlcm5pb24uY29weShvcHRpb25zLnF1YXRlcm5pb24pOwogICAgICB9CgogICAgICB0aGlzLmFuZ3VsYXJWZWxvY2l0eSA9IG5ldyBWZWMzKCk7CgogICAgICBpZiAob3B0aW9ucy5hbmd1bGFyVmVsb2NpdHkpIHsKICAgICAgICB0aGlzLmFuZ3VsYXJWZWxvY2l0eS5jb3B5KG9wdGlvbnMuYW5ndWxhclZlbG9jaXR5KTsKICAgICAgfQoKICAgICAgdGhpcy5pbml0QW5ndWxhclZlbG9jaXR5ID0gbmV3IFZlYzMoKTsKICAgICAgdGhpcy5zaGFwZXMgPSBbXTsKICAgICAgdGhpcy5zaGFwZU9mZnNldHMgPSBbXTsKICAgICAgdGhpcy5zaGFwZU9yaWVudGF0aW9ucyA9IFtdOwogICAgICB0aGlzLmluZXJ0aWEgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLmludkluZXJ0aWEgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLmludkluZXJ0aWFXb3JsZCA9IG5ldyBNYXQzKCk7CiAgICAgIHRoaXMuaW52TWFzc1NvbHZlID0gMDsKICAgICAgdGhpcy5pbnZJbmVydGlhU29sdmUgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLmludkluZXJ0aWFXb3JsZFNvbHZlID0gbmV3IE1hdDMoKTsKICAgICAgdGhpcy5maXhlZFJvdGF0aW9uID0gdHlwZW9mIG9wdGlvbnMuZml4ZWRSb3RhdGlvbiAhPT0gJ3VuZGVmaW5lZCcgPyBvcHRpb25zLmZpeGVkUm90YXRpb24gOiBmYWxzZTsKICAgICAgdGhpcy5hbmd1bGFyRGFtcGluZyA9IHR5cGVvZiBvcHRpb25zLmFuZ3VsYXJEYW1waW5nICE9PSAndW5kZWZpbmVkJyA/IG9wdGlvbnMuYW5ndWxhckRhbXBpbmcgOiAwLjAxOwogICAgICB0aGlzLmxpbmVhckZhY3RvciA9IG5ldyBWZWMzKDEsIDEsIDEpOwoKICAgICAgaWYgKG9wdGlvbnMubGluZWFyRmFjdG9yKSB7CiAgICAgICAgdGhpcy5saW5lYXJGYWN0b3IuY29weShvcHRpb25zLmxpbmVhckZhY3Rvcik7CiAgICAgIH0KCiAgICAgIHRoaXMuYW5ndWxhckZhY3RvciA9IG5ldyBWZWMzKDEsIDEsIDEpOwoKICAgICAgaWYgKG9wdGlvbnMuYW5ndWxhckZhY3RvcikgewogICAgICAgIHRoaXMuYW5ndWxhckZhY3Rvci5jb3B5KG9wdGlvbnMuYW5ndWxhckZhY3Rvcik7CiAgICAgIH0KCiAgICAgIHRoaXMuYWFiYiA9IG5ldyBBQUJCKCk7CiAgICAgIHRoaXMuYWFiYk5lZWRzVXBkYXRlID0gdHJ1ZTsKICAgICAgdGhpcy5ib3VuZGluZ1JhZGl1cyA9IDA7CiAgICAgIHRoaXMud2xhbWJkYSA9IG5ldyBWZWMzKCk7CiAgICAgIHRoaXMuaXNUcmlnZ2VyID0gQm9vbGVhbihvcHRpb25zLmlzVHJpZ2dlcik7CgogICAgICBpZiAob3B0aW9ucy5zaGFwZSkgewogICAgICAgIHRoaXMuYWRkU2hhcGUob3B0aW9ucy5zaGFwZSk7CiAgICAgIH0KCiAgICAgIHRoaXMudXBkYXRlTWFzc1Byb3BlcnRpZXMoKTsKICAgIH0KICAgIC8qKgogICAgICogV2FrZSB0aGUgYm9keSB1cC4KICAgICAqLwoKCiAgICB3YWtlVXAoKSB7CiAgICAgIGNvbnN0IHByZXZTdGF0ZSA9IHRoaXMuc2xlZXBTdGF0ZTsKICAgICAgdGhpcy5zbGVlcFN0YXRlID0gQm9keS5BV0FLRTsKICAgICAgdGhpcy53YWtlVXBBZnRlck5hcnJvd3BoYXNlID0gZmFsc2U7CgogICAgICBpZiAocHJldlN0YXRlID09PSBCb2R5LlNMRUVQSU5HKSB7CiAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KEJvZHkud2FrZXVwRXZlbnQpOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIEZvcmNlIGJvZHkgc2xlZXAKICAgICAqLwoKCiAgICBzbGVlcCgpIHsKICAgICAgdGhpcy5zbGVlcFN0YXRlID0gQm9keS5TTEVFUElORzsKICAgICAgdGhpcy52ZWxvY2l0eS5zZXQoMCwgMCwgMCk7CiAgICAgIHRoaXMuYW5ndWxhclZlbG9jaXR5LnNldCgwLCAwLCAwKTsKICAgICAgdGhpcy53YWtlVXBBZnRlck5hcnJvd3BoYXNlID0gZmFsc2U7CiAgICB9CiAgICAvKioKICAgICAqIENhbGxlZCBldmVyeSB0aW1lc3RlcCB0byB1cGRhdGUgaW50ZXJuYWwgc2xlZXAgdGltZXIgYW5kIGNoYW5nZSBzbGVlcCBzdGF0ZSBpZiBuZWVkZWQuCiAgICAgKiBAcGFyYW0gdGltZSBUaGUgd29ybGQgdGltZSBpbiBzZWNvbmRzCiAgICAgKi8KCgogICAgc2xlZXBUaWNrKHRpbWUpIHsKICAgICAgaWYgKHRoaXMuYWxsb3dTbGVlcCkgewogICAgICAgIGNvbnN0IHNsZWVwU3RhdGUgPSB0aGlzLnNsZWVwU3RhdGU7CiAgICAgICAgY29uc3Qgc3BlZWRTcXVhcmVkID0gdGhpcy52ZWxvY2l0eS5sZW5ndGhTcXVhcmVkKCkgKyB0aGlzLmFuZ3VsYXJWZWxvY2l0eS5sZW5ndGhTcXVhcmVkKCk7CiAgICAgICAgY29uc3Qgc3BlZWRMaW1pdFNxdWFyZWQgPSB0aGlzLnNsZWVwU3BlZWRMaW1pdCAqKiAyOwoKICAgICAgICBpZiAoc2xlZXBTdGF0ZSA9PT0gQm9keS5BV0FLRSAmJiBzcGVlZFNxdWFyZWQgPCBzcGVlZExpbWl0U3F1YXJlZCkgewogICAgICAgICAgdGhpcy5zbGVlcFN0YXRlID0gQm9keS5TTEVFUFk7IC8vIFNsZWVweQoKICAgICAgICAgIHRoaXMudGltZUxhc3RTbGVlcHkgPSB0aW1lOwogICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KEJvZHkuc2xlZXB5RXZlbnQpOwogICAgICAgIH0gZWxzZSBpZiAoc2xlZXBTdGF0ZSA9PT0gQm9keS5TTEVFUFkgJiYgc3BlZWRTcXVhcmVkID4gc3BlZWRMaW1pdFNxdWFyZWQpIHsKICAgICAgICAgIHRoaXMud2FrZVVwKCk7IC8vIFdha2UgdXAKICAgICAgICB9IGVsc2UgaWYgKHNsZWVwU3RhdGUgPT09IEJvZHkuU0xFRVBZICYmIHRpbWUgLSB0aGlzLnRpbWVMYXN0U2xlZXB5ID4gdGhpcy5zbGVlcFRpbWVMaW1pdCkgewogICAgICAgICAgdGhpcy5zbGVlcCgpOyAvLyBTbGVlcGluZwoKICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChCb2R5LnNsZWVwRXZlbnQpOwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBJZiB0aGUgYm9keSBpcyBzbGVlcGluZywgaXQgc2hvdWxkIGJlIGltbW92YWJsZSAvIGhhdmUgaW5maW5pdGUgbWFzcyBkdXJpbmcgc29sdmUuIFdlIHNvbHZlIGl0IGJ5IGhhdmluZyBhIHNlcGFyYXRlICJzb2x2ZSBtYXNzIi4KICAgICAqLwoKCiAgICB1cGRhdGVTb2x2ZU1hc3NQcm9wZXJ0aWVzKCkgewogICAgICBpZiAodGhpcy5zbGVlcFN0YXRlID09PSBCb2R5LlNMRUVQSU5HIHx8IHRoaXMudHlwZSA9PT0gQm9keS5LSU5FTUFUSUMpIHsKICAgICAgICB0aGlzLmludk1hc3NTb2x2ZSA9IDA7CiAgICAgICAgdGhpcy5pbnZJbmVydGlhU29sdmUuc2V0WmVybygpOwogICAgICAgIHRoaXMuaW52SW5lcnRpYVdvcmxkU29sdmUuc2V0WmVybygpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuaW52TWFzc1NvbHZlID0gdGhpcy5pbnZNYXNzOwogICAgICAgIHRoaXMuaW52SW5lcnRpYVNvbHZlLmNvcHkodGhpcy5pbnZJbmVydGlhKTsKICAgICAgICB0aGlzLmludkluZXJ0aWFXb3JsZFNvbHZlLmNvcHkodGhpcy5pbnZJbmVydGlhV29ybGQpOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIENvbnZlcnQgYSB3b3JsZCBwb2ludCB0byBsb2NhbCBib2R5IGZyYW1lLgogICAgICovCgoKICAgIHBvaW50VG9Mb2NhbEZyYW1lKHdvcmxkUG9pbnQsIHJlc3VsdCkgewogICAgICBpZiAocmVzdWx0ID09PSB2b2lkIDApIHsKICAgICAgICByZXN1bHQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICB3b3JsZFBvaW50LnZzdWIodGhpcy5wb3NpdGlvbiwgcmVzdWx0KTsKICAgICAgdGhpcy5xdWF0ZXJuaW9uLmNvbmp1Z2F0ZSgpLnZtdWx0KHJlc3VsdCwgcmVzdWx0KTsKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KICAgIC8qKgogICAgICogQ29udmVydCBhIHdvcmxkIHZlY3RvciB0byBsb2NhbCBib2R5IGZyYW1lLgogICAgICovCgoKICAgIHZlY3RvclRvTG9jYWxGcmFtZSh3b3JsZFZlY3RvciwgcmVzdWx0KSB7CiAgICAgIGlmIChyZXN1bHQgPT09IHZvaWQgMCkgewogICAgICAgIHJlc3VsdCA9IG5ldyBWZWMzKCk7CiAgICAgIH0KCiAgICAgIHRoaXMucXVhdGVybmlvbi5jb25qdWdhdGUoKS52bXVsdCh3b3JsZFZlY3RvciwgcmVzdWx0KTsKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KICAgIC8qKgogICAgICogQ29udmVydCBhIGxvY2FsIGJvZHkgcG9pbnQgdG8gd29ybGQgZnJhbWUuCiAgICAgKi8KCgogICAgcG9pbnRUb1dvcmxkRnJhbWUobG9jYWxQb2ludCwgcmVzdWx0KSB7CiAgICAgIGlmIChyZXN1bHQgPT09IHZvaWQgMCkgewogICAgICAgIHJlc3VsdCA9IG5ldyBWZWMzKCk7CiAgICAgIH0KCiAgICAgIHRoaXMucXVhdGVybmlvbi52bXVsdChsb2NhbFBvaW50LCByZXN1bHQpOwogICAgICByZXN1bHQudmFkZCh0aGlzLnBvc2l0aW9uLCByZXN1bHQpOwogICAgICByZXR1cm4gcmVzdWx0OwogICAgfQogICAgLyoqCiAgICAgKiBDb252ZXJ0IGEgbG9jYWwgYm9keSBwb2ludCB0byB3b3JsZCBmcmFtZS4KICAgICAqLwoKCiAgICB2ZWN0b3JUb1dvcmxkRnJhbWUobG9jYWxWZWN0b3IsIHJlc3VsdCkgewogICAgICBpZiAocmVzdWx0ID09PSB2b2lkIDApIHsKICAgICAgICByZXN1bHQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICB0aGlzLnF1YXRlcm5pb24udm11bHQobG9jYWxWZWN0b3IsIHJlc3VsdCk7CiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CiAgICAvKioKICAgICAqIEFkZCBhIHNoYXBlIHRvIHRoZSBib2R5IHdpdGggYSBsb2NhbCBvZmZzZXQgYW5kIG9yaWVudGF0aW9uLgogICAgICogQHJldHVybiBUaGUgYm9keSBvYmplY3QsIGZvciBjaGFpbmFiaWxpdHkuCiAgICAgKi8KCgogICAgYWRkU2hhcGUoc2hhcGUsIF9vZmZzZXQsIF9vcmllbnRhdGlvbikgewogICAgICBjb25zdCBvZmZzZXQgPSBuZXcgVmVjMygpOwogICAgICBjb25zdCBvcmllbnRhdGlvbiA9IG5ldyBRdWF0ZXJuaW9uKCk7CgogICAgICBpZiAoX29mZnNldCkgewogICAgICAgIG9mZnNldC5jb3B5KF9vZmZzZXQpOwogICAgICB9CgogICAgICBpZiAoX29yaWVudGF0aW9uKSB7CiAgICAgICAgb3JpZW50YXRpb24uY29weShfb3JpZW50YXRpb24pOwogICAgICB9CgogICAgICB0aGlzLnNoYXBlcy5wdXNoKHNoYXBlKTsKICAgICAgdGhpcy5zaGFwZU9mZnNldHMucHVzaChvZmZzZXQpOwogICAgICB0aGlzLnNoYXBlT3JpZW50YXRpb25zLnB1c2gob3JpZW50YXRpb24pOwogICAgICB0aGlzLnVwZGF0ZU1hc3NQcm9wZXJ0aWVzKCk7CiAgICAgIHRoaXMudXBkYXRlQm91bmRpbmdSYWRpdXMoKTsKICAgICAgdGhpcy5hYWJiTmVlZHNVcGRhdGUgPSB0cnVlOwogICAgICBzaGFwZS5ib2R5ID0gdGhpczsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICAvKioKICAgICAqIFJlbW92ZSBhIHNoYXBlIGZyb20gdGhlIGJvZHkuCiAgICAgKiBAcmV0dXJuIFRoZSBib2R5IG9iamVjdCwgZm9yIGNoYWluYWJpbGl0eS4KICAgICAqLwoKCiAgICByZW1vdmVTaGFwZShzaGFwZSkgewogICAgICBjb25zdCBpbmRleCA9IHRoaXMuc2hhcGVzLmluZGV4T2Yoc2hhcGUpOwoKICAgICAgaWYgKGluZGV4ID09PSAtMSkgewogICAgICAgIGNvbnNvbGUud2FybignU2hhcGUgZG9lcyBub3QgYmVsb25nIHRvIHRoZSBib2R5Jyk7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgIH0KCiAgICAgIHRoaXMuc2hhcGVzLnNwbGljZShpbmRleCwgMSk7CiAgICAgIHRoaXMuc2hhcGVPZmZzZXRzLnNwbGljZShpbmRleCwgMSk7CiAgICAgIHRoaXMuc2hhcGVPcmllbnRhdGlvbnMuc3BsaWNlKGluZGV4LCAxKTsKICAgICAgdGhpcy51cGRhdGVNYXNzUHJvcGVydGllcygpOwogICAgICB0aGlzLnVwZGF0ZUJvdW5kaW5nUmFkaXVzKCk7CiAgICAgIHRoaXMuYWFiYk5lZWRzVXBkYXRlID0gdHJ1ZTsKICAgICAgc2hhcGUuYm9keSA9IG51bGw7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogICAgLyoqCiAgICAgKiBVcGRhdGUgdGhlIGJvdW5kaW5nIHJhZGl1cyBvZiB0aGUgYm9keS4gU2hvdWxkIGJlIGRvbmUgaWYgYW55IG9mIHRoZSBzaGFwZXMgYXJlIGNoYW5nZWQuCiAgICAgKi8KCgogICAgdXBkYXRlQm91bmRpbmdSYWRpdXMoKSB7CiAgICAgIGNvbnN0IHNoYXBlcyA9IHRoaXMuc2hhcGVzOwogICAgICBjb25zdCBzaGFwZU9mZnNldHMgPSB0aGlzLnNoYXBlT2Zmc2V0czsKICAgICAgY29uc3QgTiA9IHNoYXBlcy5sZW5ndGg7CiAgICAgIGxldCByYWRpdXMgPSAwOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IE47IGkrKykgewogICAgICAgIGNvbnN0IHNoYXBlID0gc2hhcGVzW2ldOwogICAgICAgIHNoYXBlLnVwZGF0ZUJvdW5kaW5nU3BoZXJlUmFkaXVzKCk7CiAgICAgICAgY29uc3Qgb2Zmc2V0ID0gc2hhcGVPZmZzZXRzW2ldLmxlbmd0aCgpOwogICAgICAgIGNvbnN0IHIgPSBzaGFwZS5ib3VuZGluZ1NwaGVyZVJhZGl1czsKCiAgICAgICAgaWYgKG9mZnNldCArIHIgPiByYWRpdXMpIHsKICAgICAgICAgIHJhZGl1cyA9IG9mZnNldCArIHI7CiAgICAgICAgfQogICAgICB9CgogICAgICB0aGlzLmJvdW5kaW5nUmFkaXVzID0gcmFkaXVzOwogICAgfQogICAgLyoqCiAgICAgKiBVcGRhdGVzIHRoZSAuYWFiYgogICAgICovCgoKICAgIHVwZGF0ZUFBQkIoKSB7CiAgICAgIGNvbnN0IHNoYXBlcyA9IHRoaXMuc2hhcGVzOwogICAgICBjb25zdCBzaGFwZU9mZnNldHMgPSB0aGlzLnNoYXBlT2Zmc2V0czsKICAgICAgY29uc3Qgc2hhcGVPcmllbnRhdGlvbnMgPSB0aGlzLnNoYXBlT3JpZW50YXRpb25zOwogICAgICBjb25zdCBOID0gc2hhcGVzLmxlbmd0aDsKICAgICAgY29uc3Qgb2Zmc2V0ID0gdG1wVmVjOwogICAgICBjb25zdCBvcmllbnRhdGlvbiA9IHRtcFF1YXQ7CiAgICAgIGNvbnN0IGJvZHlRdWF0ID0gdGhpcy5xdWF0ZXJuaW9uOwogICAgICBjb25zdCBhYWJiID0gdGhpcy5hYWJiOwogICAgICBjb25zdCBzaGFwZUFBQkIgPSB1cGRhdGVBQUJCX3NoYXBlQUFCQjsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSBOOyBpKyspIHsKICAgICAgICBjb25zdCBzaGFwZSA9IHNoYXBlc1tpXTsgLy8gR2V0IHNoYXBlIHdvcmxkIHBvc2l0aW9uCgogICAgICAgIGJvZHlRdWF0LnZtdWx0KHNoYXBlT2Zmc2V0c1tpXSwgb2Zmc2V0KTsKICAgICAgICBvZmZzZXQudmFkZCh0aGlzLnBvc2l0aW9uLCBvZmZzZXQpOyAvLyBHZXQgc2hhcGUgd29ybGQgcXVhdGVybmlvbgoKICAgICAgICBib2R5UXVhdC5tdWx0KHNoYXBlT3JpZW50YXRpb25zW2ldLCBvcmllbnRhdGlvbik7IC8vIEdldCBzaGFwZSBBQUJCCgogICAgICAgIHNoYXBlLmNhbGN1bGF0ZVdvcmxkQUFCQihvZmZzZXQsIG9yaWVudGF0aW9uLCBzaGFwZUFBQkIubG93ZXJCb3VuZCwgc2hhcGVBQUJCLnVwcGVyQm91bmQpOwoKICAgICAgICBpZiAoaSA9PT0gMCkgewogICAgICAgICAgYWFiYi5jb3B5KHNoYXBlQUFCQik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGFhYmIuZXh0ZW5kKHNoYXBlQUFCQik7CiAgICAgICAgfQogICAgICB9CgogICAgICB0aGlzLmFhYmJOZWVkc1VwZGF0ZSA9IGZhbHNlOwogICAgfQogICAgLyoqCiAgICAgKiBVcGRhdGUgYC5pbmVydGlhV29ybGRgIGFuZCBgLmludkluZXJ0aWFXb3JsZGAKICAgICAqLwoKCiAgICB1cGRhdGVJbmVydGlhV29ybGQoZm9yY2UpIHsKICAgICAgY29uc3QgSSA9IHRoaXMuaW52SW5lcnRpYTsKCiAgICAgIGlmIChJLnggPT09IEkueSAmJiBJLnkgPT09IEkueiAmJiAhZm9yY2UpIDsgZWxzZSB7CiAgICAgICAgY29uc3QgbTEgPSB1aXdfbTE7CiAgICAgICAgY29uc3QgbTIgPSB1aXdfbTI7CiAgICAgICAgbTEuc2V0Um90YXRpb25Gcm9tUXVhdGVybmlvbih0aGlzLnF1YXRlcm5pb24pOwogICAgICAgIG0xLnRyYW5zcG9zZShtMik7CiAgICAgICAgbTEuc2NhbGUoSSwgbTEpOwogICAgICAgIG0xLm1tdWx0KG0yLCB0aGlzLmludkluZXJ0aWFXb3JsZCk7CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogQXBwbHkgZm9yY2UgdG8gYSBwb2ludCBvZiB0aGUgYm9keS4gVGhpcyBjb3VsZCBmb3IgZXhhbXBsZSBiZSBhIHBvaW50IG9uIHRoZSBCb2R5IHN1cmZhY2UuCiAgICAgKiBBcHBseWluZyBmb3JjZSB0aGlzIHdheSB3aWxsIGFkZCB0byBCb2R5LmZvcmNlIGFuZCBCb2R5LnRvcnF1ZS4KICAgICAqIEBwYXJhbSBmb3JjZSBUaGUgYW1vdW50IG9mIGZvcmNlIHRvIGFkZC4KICAgICAqIEBwYXJhbSByZWxhdGl2ZVBvaW50IEEgcG9pbnQgcmVsYXRpdmUgdG8gdGhlIGNlbnRlciBvZiBtYXNzIHRvIGFwcGx5IHRoZSBmb3JjZSBvbi4KICAgICAqLwoKCiAgICBhcHBseUZvcmNlKGZvcmNlLCByZWxhdGl2ZVBvaW50KSB7CiAgICAgIGlmIChyZWxhdGl2ZVBvaW50ID09PSB2b2lkIDApIHsKICAgICAgICByZWxhdGl2ZVBvaW50ID0gbmV3IFZlYzMoKTsKICAgICAgfQoKICAgICAgLy8gTmVlZGVkPwogICAgICBpZiAodGhpcy50eXBlICE9PSBCb2R5LkRZTkFNSUMpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLnNsZWVwU3RhdGUgPT09IEJvZHkuU0xFRVBJTkcpIHsKICAgICAgICB0aGlzLndha2VVcCgpOwogICAgICB9IC8vIENvbXB1dGUgcHJvZHVjZWQgcm90YXRpb25hbCBmb3JjZQoKCiAgICAgIGNvbnN0IHJvdEZvcmNlID0gQm9keV9hcHBseUZvcmNlX3JvdEZvcmNlOwogICAgICByZWxhdGl2ZVBvaW50LmNyb3NzKGZvcmNlLCByb3RGb3JjZSk7IC8vIEFkZCBsaW5lYXIgZm9yY2UKCiAgICAgIHRoaXMuZm9yY2UudmFkZChmb3JjZSwgdGhpcy5mb3JjZSk7IC8vIEFkZCByb3RhdGlvbmFsIGZvcmNlCgogICAgICB0aGlzLnRvcnF1ZS52YWRkKHJvdEZvcmNlLCB0aGlzLnRvcnF1ZSk7CiAgICB9CiAgICAvKioKICAgICAqIEFwcGx5IGZvcmNlIHRvIGEgbG9jYWwgcG9pbnQgaW4gdGhlIGJvZHkuCiAgICAgKiBAcGFyYW0gZm9yY2UgVGhlIGZvcmNlIHZlY3RvciB0byBhcHBseSwgZGVmaW5lZCBsb2NhbGx5IGluIHRoZSBib2R5IGZyYW1lLgogICAgICogQHBhcmFtIGxvY2FsUG9pbnQgQSBsb2NhbCBwb2ludCBpbiB0aGUgYm9keSB0byBhcHBseSB0aGUgZm9yY2Ugb24uCiAgICAgKi8KCgogICAgYXBwbHlMb2NhbEZvcmNlKGxvY2FsRm9yY2UsIGxvY2FsUG9pbnQpIHsKICAgICAgaWYgKGxvY2FsUG9pbnQgPT09IHZvaWQgMCkgewogICAgICAgIGxvY2FsUG9pbnQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICBpZiAodGhpcy50eXBlICE9PSBCb2R5LkRZTkFNSUMpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGNvbnN0IHdvcmxkRm9yY2UgPSBCb2R5X2FwcGx5TG9jYWxGb3JjZV93b3JsZEZvcmNlOwogICAgICBjb25zdCByZWxhdGl2ZVBvaW50V29ybGQgPSBCb2R5X2FwcGx5TG9jYWxGb3JjZV9yZWxhdGl2ZVBvaW50V29ybGQ7IC8vIFRyYW5zZm9ybSB0aGUgZm9yY2UgdmVjdG9yIHRvIHdvcmxkIHNwYWNlCgogICAgICB0aGlzLnZlY3RvclRvV29ybGRGcmFtZShsb2NhbEZvcmNlLCB3b3JsZEZvcmNlKTsKICAgICAgdGhpcy52ZWN0b3JUb1dvcmxkRnJhbWUobG9jYWxQb2ludCwgcmVsYXRpdmVQb2ludFdvcmxkKTsKICAgICAgdGhpcy5hcHBseUZvcmNlKHdvcmxkRm9yY2UsIHJlbGF0aXZlUG9pbnRXb3JsZCk7CiAgICB9CiAgICAvKioKICAgICAqIEFwcGx5IHRvcnF1ZSB0byB0aGUgYm9keS4KICAgICAqIEBwYXJhbSB0b3JxdWUgVGhlIGFtb3VudCBvZiB0b3JxdWUgdG8gYWRkLgogICAgICovCgoKICAgIGFwcGx5VG9ycXVlKHRvcnF1ZSkgewogICAgICBpZiAodGhpcy50eXBlICE9PSBCb2R5LkRZTkFNSUMpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLnNsZWVwU3RhdGUgPT09IEJvZHkuU0xFRVBJTkcpIHsKICAgICAgICB0aGlzLndha2VVcCgpOwogICAgICB9IC8vIEFkZCByb3RhdGlvbmFsIGZvcmNlCgoKICAgICAgdGhpcy50b3JxdWUudmFkZCh0b3JxdWUsIHRoaXMudG9ycXVlKTsKICAgIH0KICAgIC8qKgogICAgICogQXBwbHkgaW1wdWxzZSB0byBhIHBvaW50IG9mIHRoZSBib2R5LiBUaGlzIGNvdWxkIGZvciBleGFtcGxlIGJlIGEgcG9pbnQgb24gdGhlIEJvZHkgc3VyZmFjZS4KICAgICAqIEFuIGltcHVsc2UgaXMgYSBmb3JjZSBhZGRlZCB0byBhIGJvZHkgZHVyaW5nIGEgc2hvcnQgcGVyaW9kIG9mIHRpbWUgKGltcHVsc2UgPSBmb3JjZSAqIHRpbWUpLgogICAgICogSW1wdWxzZXMgd2lsbCBiZSBhZGRlZCB0byBCb2R5LnZlbG9jaXR5IGFuZCBCb2R5LmFuZ3VsYXJWZWxvY2l0eS4KICAgICAqIEBwYXJhbSBpbXB1bHNlIFRoZSBhbW91bnQgb2YgaW1wdWxzZSB0byBhZGQuCiAgICAgKiBAcGFyYW0gcmVsYXRpdmVQb2ludCBBIHBvaW50IHJlbGF0aXZlIHRvIHRoZSBjZW50ZXIgb2YgbWFzcyB0byBhcHBseSB0aGUgZm9yY2Ugb24uCiAgICAgKi8KCgogICAgYXBwbHlJbXB1bHNlKGltcHVsc2UsIHJlbGF0aXZlUG9pbnQpIHsKICAgICAgaWYgKHJlbGF0aXZlUG9pbnQgPT09IHZvaWQgMCkgewogICAgICAgIHJlbGF0aXZlUG9pbnQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICBpZiAodGhpcy50eXBlICE9PSBCb2R5LkRZTkFNSUMpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLnNsZWVwU3RhdGUgPT09IEJvZHkuU0xFRVBJTkcpIHsKICAgICAgICB0aGlzLndha2VVcCgpOwogICAgICB9IC8vIENvbXB1dGUgcG9pbnQgcG9zaXRpb24gcmVsYXRpdmUgdG8gdGhlIGJvZHkgY2VudGVyCgoKICAgICAgY29uc3QgciA9IHJlbGF0aXZlUG9pbnQ7IC8vIENvbXB1dGUgcHJvZHVjZWQgY2VudHJhbCBpbXB1bHNlIHZlbG9jaXR5CgogICAgICBjb25zdCB2ZWxvID0gQm9keV9hcHBseUltcHVsc2VfdmVsbzsKICAgICAgdmVsby5jb3B5KGltcHVsc2UpOwogICAgICB2ZWxvLnNjYWxlKHRoaXMuaW52TWFzcywgdmVsbyk7IC8vIEFkZCBsaW5lYXIgaW1wdWxzZQoKICAgICAgdGhpcy52ZWxvY2l0eS52YWRkKHZlbG8sIHRoaXMudmVsb2NpdHkpOyAvLyBDb21wdXRlIHByb2R1Y2VkIHJvdGF0aW9uYWwgaW1wdWxzZSB2ZWxvY2l0eQoKICAgICAgY29uc3Qgcm90VmVsbyA9IEJvZHlfYXBwbHlJbXB1bHNlX3JvdFZlbG87CiAgICAgIHIuY3Jvc3MoaW1wdWxzZSwgcm90VmVsbyk7CiAgICAgIC8qCiAgICAgICByb3RWZWxvLnggKj0gdGhpcy5pbnZJbmVydGlhLng7CiAgICAgICByb3RWZWxvLnkgKj0gdGhpcy5pbnZJbmVydGlhLnk7CiAgICAgICByb3RWZWxvLnogKj0gdGhpcy5pbnZJbmVydGlhLno7CiAgICAgICAqLwoKICAgICAgdGhpcy5pbnZJbmVydGlhV29ybGQudm11bHQocm90VmVsbywgcm90VmVsbyk7IC8vIEFkZCByb3RhdGlvbmFsIEltcHVsc2UKCiAgICAgIHRoaXMuYW5ndWxhclZlbG9jaXR5LnZhZGQocm90VmVsbywgdGhpcy5hbmd1bGFyVmVsb2NpdHkpOwogICAgfQogICAgLyoqCiAgICAgKiBBcHBseSBsb2NhbGx5LWRlZmluZWQgaW1wdWxzZSB0byBhIGxvY2FsIHBvaW50IGluIHRoZSBib2R5LgogICAgICogQHBhcmFtIGZvcmNlIFRoZSBmb3JjZSB2ZWN0b3IgdG8gYXBwbHksIGRlZmluZWQgbG9jYWxseSBpbiB0aGUgYm9keSBmcmFtZS4KICAgICAqIEBwYXJhbSBsb2NhbFBvaW50IEEgbG9jYWwgcG9pbnQgaW4gdGhlIGJvZHkgdG8gYXBwbHkgdGhlIGZvcmNlIG9uLgogICAgICovCgoKICAgIGFwcGx5TG9jYWxJbXB1bHNlKGxvY2FsSW1wdWxzZSwgbG9jYWxQb2ludCkgewogICAgICBpZiAobG9jYWxQb2ludCA9PT0gdm9pZCAwKSB7CiAgICAgICAgbG9jYWxQb2ludCA9IG5ldyBWZWMzKCk7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLnR5cGUgIT09IEJvZHkuRFlOQU1JQykgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgY29uc3Qgd29ybGRJbXB1bHNlID0gQm9keV9hcHBseUxvY2FsSW1wdWxzZV93b3JsZEltcHVsc2U7CiAgICAgIGNvbnN0IHJlbGF0aXZlUG9pbnRXb3JsZCA9IEJvZHlfYXBwbHlMb2NhbEltcHVsc2VfcmVsYXRpdmVQb2ludDsgLy8gVHJhbnNmb3JtIHRoZSBmb3JjZSB2ZWN0b3IgdG8gd29ybGQgc3BhY2UKCiAgICAgIHRoaXMudmVjdG9yVG9Xb3JsZEZyYW1lKGxvY2FsSW1wdWxzZSwgd29ybGRJbXB1bHNlKTsKICAgICAgdGhpcy52ZWN0b3JUb1dvcmxkRnJhbWUobG9jYWxQb2ludCwgcmVsYXRpdmVQb2ludFdvcmxkKTsKICAgICAgdGhpcy5hcHBseUltcHVsc2Uod29ybGRJbXB1bHNlLCByZWxhdGl2ZVBvaW50V29ybGQpOwogICAgfQogICAgLyoqCiAgICAgKiBTaG91bGQgYmUgY2FsbGVkIHdoZW5ldmVyIHlvdSBjaGFuZ2UgdGhlIGJvZHkgc2hhcGUgb3IgbWFzcy4KICAgICAqLwoKCiAgICB1cGRhdGVNYXNzUHJvcGVydGllcygpIHsKICAgICAgY29uc3QgaGFsZkV4dGVudHMgPSBCb2R5X3VwZGF0ZU1hc3NQcm9wZXJ0aWVzX2hhbGZFeHRlbnRzOwogICAgICB0aGlzLmludk1hc3MgPSB0aGlzLm1hc3MgPiAwID8gMS4wIC8gdGhpcy5tYXNzIDogMDsKICAgICAgY29uc3QgSSA9IHRoaXMuaW5lcnRpYTsKICAgICAgY29uc3QgZml4ZWQgPSB0aGlzLmZpeGVkUm90YXRpb247IC8vIEFwcHJveGltYXRlIHdpdGggQUFCQiBib3gKCiAgICAgIHRoaXMudXBkYXRlQUFCQigpOwogICAgICBoYWxmRXh0ZW50cy5zZXQoKHRoaXMuYWFiYi51cHBlckJvdW5kLnggLSB0aGlzLmFhYmIubG93ZXJCb3VuZC54KSAvIDIsICh0aGlzLmFhYmIudXBwZXJCb3VuZC55IC0gdGhpcy5hYWJiLmxvd2VyQm91bmQueSkgLyAyLCAodGhpcy5hYWJiLnVwcGVyQm91bmQueiAtIHRoaXMuYWFiYi5sb3dlckJvdW5kLnopIC8gMik7CiAgICAgIEJveC5jYWxjdWxhdGVJbmVydGlhKGhhbGZFeHRlbnRzLCB0aGlzLm1hc3MsIEkpOwogICAgICB0aGlzLmludkluZXJ0aWEuc2V0KEkueCA+IDAgJiYgIWZpeGVkID8gMS4wIC8gSS54IDogMCwgSS55ID4gMCAmJiAhZml4ZWQgPyAxLjAgLyBJLnkgOiAwLCBJLnogPiAwICYmICFmaXhlZCA/IDEuMCAvIEkueiA6IDApOwogICAgICB0aGlzLnVwZGF0ZUluZXJ0aWFXb3JsZCh0cnVlKTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IHdvcmxkIHZlbG9jaXR5IG9mIGEgcG9pbnQgaW4gdGhlIGJvZHkuCiAgICAgKiBAcGFyYW0gd29ybGRQb2ludAogICAgICogQHBhcmFtIHJlc3VsdAogICAgICogQHJldHVybiBUaGUgcmVzdWx0IHZlY3Rvci4KICAgICAqLwoKCiAgICBnZXRWZWxvY2l0eUF0V29ybGRQb2ludCh3b3JsZFBvaW50LCByZXN1bHQpIHsKICAgICAgY29uc3QgciA9IG5ldyBWZWMzKCk7CiAgICAgIHdvcmxkUG9pbnQudnN1Yih0aGlzLnBvc2l0aW9uLCByKTsKICAgICAgdGhpcy5hbmd1bGFyVmVsb2NpdHkuY3Jvc3MociwgcmVzdWx0KTsKICAgICAgdGhpcy52ZWxvY2l0eS52YWRkKHJlc3VsdCwgcmVzdWx0KTsKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KICAgIC8qKgogICAgICogTW92ZSB0aGUgYm9keSBmb3J3YXJkIGluIHRpbWUuCiAgICAgKiBAcGFyYW0gZHQgVGltZSBzdGVwCiAgICAgKiBAcGFyYW0gcXVhdE5vcm1hbGl6ZSBTZXQgdG8gdHJ1ZSB0byBub3JtYWxpemUgdGhlIGJvZHkgcXVhdGVybmlvbgogICAgICogQHBhcmFtIHF1YXROb3JtYWxpemVGYXN0IElmIHRoZSBxdWF0ZXJuaW9uIHNob3VsZCBiZSBub3JtYWxpemVkIHVzaW5nICJmYXN0IiBxdWF0ZXJuaW9uIG5vcm1hbGl6YXRpb24KICAgICAqLwoKCiAgICBpbnRlZ3JhdGUoZHQsIHF1YXROb3JtYWxpemUsIHF1YXROb3JtYWxpemVGYXN0KSB7CiAgICAgIC8vIFNhdmUgcHJldmlvdXMgcG9zaXRpb24KICAgICAgdGhpcy5wcmV2aW91c1Bvc2l0aW9uLmNvcHkodGhpcy5wb3NpdGlvbik7CiAgICAgIHRoaXMucHJldmlvdXNRdWF0ZXJuaW9uLmNvcHkodGhpcy5xdWF0ZXJuaW9uKTsKCiAgICAgIGlmICghKHRoaXMudHlwZSA9PT0gQm9keS5EWU5BTUlDIHx8IHRoaXMudHlwZSA9PT0gQm9keS5LSU5FTUFUSUMpIHx8IHRoaXMuc2xlZXBTdGF0ZSA9PT0gQm9keS5TTEVFUElORykgewogICAgICAgIC8vIE9ubHkgZm9yIGR5bmFtaWMKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGNvbnN0IHZlbG8gPSB0aGlzLnZlbG9jaXR5OwogICAgICBjb25zdCBhbmd1bGFyVmVsbyA9IHRoaXMuYW5ndWxhclZlbG9jaXR5OwogICAgICBjb25zdCBwb3MgPSB0aGlzLnBvc2l0aW9uOwogICAgICBjb25zdCBmb3JjZSA9IHRoaXMuZm9yY2U7CiAgICAgIGNvbnN0IHRvcnF1ZSA9IHRoaXMudG9ycXVlOwogICAgICBjb25zdCBxdWF0ID0gdGhpcy5xdWF0ZXJuaW9uOwogICAgICBjb25zdCBpbnZNYXNzID0gdGhpcy5pbnZNYXNzOwogICAgICBjb25zdCBpbnZJbmVydGlhID0gdGhpcy5pbnZJbmVydGlhV29ybGQ7CiAgICAgIGNvbnN0IGxpbmVhckZhY3RvciA9IHRoaXMubGluZWFyRmFjdG9yOwogICAgICBjb25zdCBpTWR0ID0gaW52TWFzcyAqIGR0OwogICAgICB2ZWxvLnggKz0gZm9yY2UueCAqIGlNZHQgKiBsaW5lYXJGYWN0b3IueDsKICAgICAgdmVsby55ICs9IGZvcmNlLnkgKiBpTWR0ICogbGluZWFyRmFjdG9yLnk7CiAgICAgIHZlbG8ueiArPSBmb3JjZS56ICogaU1kdCAqIGxpbmVhckZhY3Rvci56OwogICAgICBjb25zdCBlID0gaW52SW5lcnRpYS5lbGVtZW50czsKICAgICAgY29uc3QgYW5ndWxhckZhY3RvciA9IHRoaXMuYW5ndWxhckZhY3RvcjsKICAgICAgY29uc3QgdHggPSB0b3JxdWUueCAqIGFuZ3VsYXJGYWN0b3IueDsKICAgICAgY29uc3QgdHkgPSB0b3JxdWUueSAqIGFuZ3VsYXJGYWN0b3IueTsKICAgICAgY29uc3QgdHogPSB0b3JxdWUueiAqIGFuZ3VsYXJGYWN0b3IuejsKICAgICAgYW5ndWxhclZlbG8ueCArPSBkdCAqIChlWzBdICogdHggKyBlWzFdICogdHkgKyBlWzJdICogdHopOwogICAgICBhbmd1bGFyVmVsby55ICs9IGR0ICogKGVbM10gKiB0eCArIGVbNF0gKiB0eSArIGVbNV0gKiB0eik7CiAgICAgIGFuZ3VsYXJWZWxvLnogKz0gZHQgKiAoZVs2XSAqIHR4ICsgZVs3XSAqIHR5ICsgZVs4XSAqIHR6KTsgLy8gVXNlIG5ldyB2ZWxvY2l0eSAgLSBsZWFwIGZyb2cKCiAgICAgIHBvcy54ICs9IHZlbG8ueCAqIGR0OwogICAgICBwb3MueSArPSB2ZWxvLnkgKiBkdDsKICAgICAgcG9zLnogKz0gdmVsby56ICogZHQ7CiAgICAgIHF1YXQuaW50ZWdyYXRlKHRoaXMuYW5ndWxhclZlbG9jaXR5LCBkdCwgdGhpcy5hbmd1bGFyRmFjdG9yLCBxdWF0KTsKCiAgICAgIGlmIChxdWF0Tm9ybWFsaXplKSB7CiAgICAgICAgaWYgKHF1YXROb3JtYWxpemVGYXN0KSB7CiAgICAgICAgICBxdWF0Lm5vcm1hbGl6ZUZhc3QoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcXVhdC5ub3JtYWxpemUoKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHRoaXMuYWFiYk5lZWRzVXBkYXRlID0gdHJ1ZTsgLy8gVXBkYXRlIHdvcmxkIGluZXJ0aWEKCiAgICAgIHRoaXMudXBkYXRlSW5lcnRpYVdvcmxkKCk7CiAgICB9CgogIH0KICBCb2R5LmlkQ291bnRlciA9IDA7CiAgQm9keS5DT0xMSURFX0VWRU5UX05BTUUgPSAnY29sbGlkZSc7CiAgQm9keS5EWU5BTUlDID0gQk9EWV9UWVBFUy5EWU5BTUlDOwogIEJvZHkuU1RBVElDID0gQk9EWV9UWVBFUy5TVEFUSUM7CiAgQm9keS5LSU5FTUFUSUMgPSBCT0RZX1RZUEVTLktJTkVNQVRJQzsKICBCb2R5LkFXQUtFID0gQk9EWV9TTEVFUF9TVEFURVMuQVdBS0U7CiAgQm9keS5TTEVFUFkgPSBCT0RZX1NMRUVQX1NUQVRFUy5TTEVFUFk7CiAgQm9keS5TTEVFUElORyA9IEJPRFlfU0xFRVBfU1RBVEVTLlNMRUVQSU5HOwogIEJvZHkud2FrZXVwRXZlbnQgPSB7CiAgICB0eXBlOiAnd2FrZXVwJwogIH07CiAgQm9keS5zbGVlcHlFdmVudCA9IHsKICAgIHR5cGU6ICdzbGVlcHknCiAgfTsKICBCb2R5LnNsZWVwRXZlbnQgPSB7CiAgICB0eXBlOiAnc2xlZXAnCiAgfTsKICBjb25zdCB0bXBWZWMgPSBuZXcgVmVjMygpOwogIGNvbnN0IHRtcFF1YXQgPSBuZXcgUXVhdGVybmlvbigpOwogIGNvbnN0IHVwZGF0ZUFBQkJfc2hhcGVBQUJCID0gbmV3IEFBQkIoKTsKICBjb25zdCB1aXdfbTEgPSBuZXcgTWF0MygpOwogIGNvbnN0IHVpd19tMiA9IG5ldyBNYXQzKCk7CiAgbmV3IE1hdDMoKTsKICBjb25zdCBCb2R5X2FwcGx5Rm9yY2Vfcm90Rm9yY2UgPSBuZXcgVmVjMygpOwogIGNvbnN0IEJvZHlfYXBwbHlMb2NhbEZvcmNlX3dvcmxkRm9yY2UgPSBuZXcgVmVjMygpOwogIGNvbnN0IEJvZHlfYXBwbHlMb2NhbEZvcmNlX3JlbGF0aXZlUG9pbnRXb3JsZCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgQm9keV9hcHBseUltcHVsc2VfdmVsbyA9IG5ldyBWZWMzKCk7CiAgY29uc3QgQm9keV9hcHBseUltcHVsc2Vfcm90VmVsbyA9IG5ldyBWZWMzKCk7CiAgY29uc3QgQm9keV9hcHBseUxvY2FsSW1wdWxzZV93b3JsZEltcHVsc2UgPSBuZXcgVmVjMygpOwogIGNvbnN0IEJvZHlfYXBwbHlMb2NhbEltcHVsc2VfcmVsYXRpdmVQb2ludCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgQm9keV91cGRhdGVNYXNzUHJvcGVydGllc19oYWxmRXh0ZW50cyA9IG5ldyBWZWMzKCk7CgogIC8qKgogICAqIEJhc2UgY2xhc3MgZm9yIGJyb2FkcGhhc2UgaW1wbGVtZW50YXRpb25zCiAgICogQGF1dGhvciBzY2h0ZXBwZQogICAqLwogIGNsYXNzIEJyb2FkcGhhc2UgewogICAgLyoqCiAgICAgKiBUaGUgd29ybGQgdG8gc2VhcmNoIGZvciBjb2xsaXNpb25zIGluLgogICAgICovCgogICAgLyoqCiAgICAgKiBJZiBzZXQgdG8gdHJ1ZSwgdGhlIGJyb2FkcGhhc2UgdXNlcyBib3VuZGluZyBib3hlcyBmb3IgaW50ZXJzZWN0aW9uIHRlc3RzLCBlbHNlIGl0IHVzZXMgYm91bmRpbmcgc3BoZXJlcy4KICAgICAqLwoKICAgIC8qKgogICAgICogU2V0IHRvIHRydWUgaWYgdGhlIG9iamVjdHMgaW4gdGhlIHdvcmxkIG1vdmVkLgogICAgICovCiAgICBjb25zdHJ1Y3RvcigpIHsKICAgICAgdGhpcy53b3JsZCA9IG51bGw7CiAgICAgIHRoaXMudXNlQm91bmRpbmdCb3hlcyA9IGZhbHNlOwogICAgICB0aGlzLmRpcnR5ID0gdHJ1ZTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IHRoZSBjb2xsaXNpb24gcGFpcnMgZnJvbSB0aGUgd29ybGQKICAgICAqIEBwYXJhbSB3b3JsZCBUaGUgd29ybGQgdG8gc2VhcmNoIGluCiAgICAgKiBAcGFyYW0gcDEgRW1wdHkgYXJyYXkgdG8gYmUgZmlsbGVkIHdpdGggYm9keSBvYmplY3RzCiAgICAgKiBAcGFyYW0gcDIgRW1wdHkgYXJyYXkgdG8gYmUgZmlsbGVkIHdpdGggYm9keSBvYmplY3RzCiAgICAgKi8KCgogICAgY29sbGlzaW9uUGFpcnMod29ybGQsIHAxLCBwMikgewogICAgICB0aHJvdyBuZXcgRXJyb3IoJ2NvbGxpc2lvblBhaXJzIG5vdCBpbXBsZW1lbnRlZCBmb3IgdGhpcyBCcm9hZFBoYXNlIGNsYXNzIScpOwogICAgfQogICAgLyoqCiAgICAgKiBDaGVjayBpZiBhIGJvZHkgcGFpciBuZWVkcyB0byBiZSBpbnRlcnNlY3Rpb24gdGVzdGVkIGF0IGFsbC4KICAgICAqLwoKCiAgICBuZWVkQnJvYWRwaGFzZUNvbGxpc2lvbihib2R5QSwgYm9keUIpIHsKICAgICAgLy8gQ2hlY2sgY29sbGlzaW9uIGZpbHRlciBtYXNrcwogICAgICBpZiAoKGJvZHlBLmNvbGxpc2lvbkZpbHRlckdyb3VwICYgYm9keUIuY29sbGlzaW9uRmlsdGVyTWFzaykgPT09IDAgfHwgKGJvZHlCLmNvbGxpc2lvbkZpbHRlckdyb3VwICYgYm9keUEuY29sbGlzaW9uRmlsdGVyTWFzaykgPT09IDApIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0gLy8gQ2hlY2sgdHlwZXMKCgogICAgICBpZiAoKChib2R5QS50eXBlICYgQm9keS5TVEFUSUMpICE9PSAwIHx8IGJvZHlBLnNsZWVwU3RhdGUgPT09IEJvZHkuU0xFRVBJTkcpICYmICgoYm9keUIudHlwZSAmIEJvZHkuU1RBVElDKSAhPT0gMCB8fCBib2R5Qi5zbGVlcFN0YXRlID09PSBCb2R5LlNMRUVQSU5HKSkgewogICAgICAgIC8vIEJvdGggYm9kaWVzIGFyZSBzdGF0aWMgb3Igc2xlZXBpbmcuIFNraXAuCiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CgogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KICAgIC8qKgogICAgICogQ2hlY2sgaWYgdGhlIGJvdW5kaW5nIHZvbHVtZXMgb2YgdHdvIGJvZGllcyBpbnRlcnNlY3QuCiAgICAgKi8KCgogICAgaW50ZXJzZWN0aW9uVGVzdChib2R5QSwgYm9keUIsIHBhaXJzMSwgcGFpcnMyKSB7CiAgICAgIGlmICh0aGlzLnVzZUJvdW5kaW5nQm94ZXMpIHsKICAgICAgICB0aGlzLmRvQm91bmRpbmdCb3hCcm9hZHBoYXNlKGJvZHlBLCBib2R5QiwgcGFpcnMxLCBwYWlyczIpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuZG9Cb3VuZGluZ1NwaGVyZUJyb2FkcGhhc2UoYm9keUEsIGJvZHlCLCBwYWlyczEsIHBhaXJzMik7CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogQ2hlY2sgaWYgdGhlIGJvdW5kaW5nIHNwaGVyZXMgb2YgdHdvIGJvZGllcyBhcmUgaW50ZXJzZWN0aW5nLgogICAgICogQHBhcmFtIHBhaXJzMSBib2R5QSBpcyBhcHBlbmRlZCB0byB0aGlzIGFycmF5IGlmIGludGVyc2VjdGlvbgogICAgICogQHBhcmFtIHBhaXJzMiBib2R5QiBpcyBhcHBlbmRlZCB0byB0aGlzIGFycmF5IGlmIGludGVyc2VjdGlvbgogICAgICovCgoKICAgIGRvQm91bmRpbmdTcGhlcmVCcm9hZHBoYXNlKGJvZHlBLCBib2R5QiwgcGFpcnMxLCBwYWlyczIpIHsKICAgICAgY29uc3QgciA9IEJyb2FkcGhhc2VfY29sbGlzaW9uUGFpcnNfcjsKICAgICAgYm9keUIucG9zaXRpb24udnN1Yihib2R5QS5wb3NpdGlvbiwgcik7CiAgICAgIGNvbnN0IGJvdW5kaW5nUmFkaXVzU3VtMiA9IChib2R5QS5ib3VuZGluZ1JhZGl1cyArIGJvZHlCLmJvdW5kaW5nUmFkaXVzKSAqKiAyOwogICAgICBjb25zdCBub3JtMiA9IHIubGVuZ3RoU3F1YXJlZCgpOwoKICAgICAgaWYgKG5vcm0yIDwgYm91bmRpbmdSYWRpdXNTdW0yKSB7CiAgICAgICAgcGFpcnMxLnB1c2goYm9keUEpOwogICAgICAgIHBhaXJzMi5wdXNoKGJvZHlCKTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBDaGVjayBpZiB0aGUgYm91bmRpbmcgYm94ZXMgb2YgdHdvIGJvZGllcyBhcmUgaW50ZXJzZWN0aW5nLgogICAgICovCgoKICAgIGRvQm91bmRpbmdCb3hCcm9hZHBoYXNlKGJvZHlBLCBib2R5QiwgcGFpcnMxLCBwYWlyczIpIHsKICAgICAgaWYgKGJvZHlBLmFhYmJOZWVkc1VwZGF0ZSkgewogICAgICAgIGJvZHlBLnVwZGF0ZUFBQkIoKTsKICAgICAgfQoKICAgICAgaWYgKGJvZHlCLmFhYmJOZWVkc1VwZGF0ZSkgewogICAgICAgIGJvZHlCLnVwZGF0ZUFBQkIoKTsKICAgICAgfSAvLyBDaGVjayBBQUJCIC8gQUFCQgoKCiAgICAgIGlmIChib2R5QS5hYWJiLm92ZXJsYXBzKGJvZHlCLmFhYmIpKSB7CiAgICAgICAgcGFpcnMxLnB1c2goYm9keUEpOwogICAgICAgIHBhaXJzMi5wdXNoKGJvZHlCKTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBSZW1vdmVzIGR1cGxpY2F0ZSBwYWlycyBmcm9tIHRoZSBwYWlyIGFycmF5cy4KICAgICAqLwoKCiAgICBtYWtlUGFpcnNVbmlxdWUocGFpcnMxLCBwYWlyczIpIHsKICAgICAgY29uc3QgdCA9IEJyb2FkcGhhc2VfbWFrZVBhaXJzVW5pcXVlX3RlbXA7CiAgICAgIGNvbnN0IHAxID0gQnJvYWRwaGFzZV9tYWtlUGFpcnNVbmlxdWVfcDE7CiAgICAgIGNvbnN0IHAyID0gQnJvYWRwaGFzZV9tYWtlUGFpcnNVbmlxdWVfcDI7CiAgICAgIGNvbnN0IE4gPSBwYWlyczEubGVuZ3RoOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IE47IGkrKykgewogICAgICAgIHAxW2ldID0gcGFpcnMxW2ldOwogICAgICAgIHAyW2ldID0gcGFpcnMyW2ldOwogICAgICB9CgogICAgICBwYWlyczEubGVuZ3RoID0gMDsKICAgICAgcGFpcnMyLmxlbmd0aCA9IDA7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gTjsgaSsrKSB7CiAgICAgICAgY29uc3QgaWQxID0gcDFbaV0uaWQ7CiAgICAgICAgY29uc3QgaWQyID0gcDJbaV0uaWQ7CiAgICAgICAgY29uc3Qga2V5ID0gaWQxIDwgaWQyID8gYCR7aWQxfSwke2lkMn1gIDogYCR7aWQyfSwke2lkMX1gOwogICAgICAgIHRba2V5XSA9IGk7CiAgICAgICAgdC5rZXlzLnB1c2goa2V5KTsKICAgICAgfQoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IHQua2V5cy5sZW5ndGg7IGkrKykgewogICAgICAgIGNvbnN0IGtleSA9IHQua2V5cy5wb3AoKTsKICAgICAgICBjb25zdCBwYWlySW5kZXggPSB0W2tleV07CiAgICAgICAgcGFpcnMxLnB1c2gocDFbcGFpckluZGV4XSk7CiAgICAgICAgcGFpcnMyLnB1c2gocDJbcGFpckluZGV4XSk7CiAgICAgICAgZGVsZXRlIHRba2V5XTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBUbyBiZSBpbXBsZW1lbnRlZCBieSBzdWJjYXNzZXMKICAgICAqLwoKCiAgICBzZXRXb3JsZCh3b3JsZCkge30KICAgIC8qKgogICAgICogQ2hlY2sgaWYgdGhlIGJvdW5kaW5nIHNwaGVyZXMgb2YgdHdvIGJvZGllcyBvdmVybGFwLgogICAgICovCgoKICAgIHN0YXRpYyBib3VuZGluZ1NwaGVyZUNoZWNrKGJvZHlBLCBib2R5QikgewogICAgICBjb25zdCBkaXN0ID0gbmV3IFZlYzMoKTsgLy8gYnNjX2Rpc3Q7CgogICAgICBib2R5QS5wb3NpdGlvbi52c3ViKGJvZHlCLnBvc2l0aW9uLCBkaXN0KTsKICAgICAgY29uc3Qgc2EgPSBib2R5QS5zaGFwZXNbMF07CiAgICAgIGNvbnN0IHNiID0gYm9keUIuc2hhcGVzWzBdOwogICAgICByZXR1cm4gTWF0aC5wb3coc2EuYm91bmRpbmdTcGhlcmVSYWRpdXMgKyBzYi5ib3VuZGluZ1NwaGVyZVJhZGl1cywgMikgPiBkaXN0Lmxlbmd0aFNxdWFyZWQoKTsKICAgIH0KICAgIC8qKgogICAgICogUmV0dXJucyBhbGwgdGhlIGJvZGllcyB3aXRoaW4gdGhlIEFBQkIuCiAgICAgKi8KCgogICAgYWFiYlF1ZXJ5KHdvcmxkLCBhYWJiLCByZXN1bHQpIHsKICAgICAgY29uc29sZS53YXJuKCcuYWFiYlF1ZXJ5IGlzIG5vdCBpbXBsZW1lbnRlZCBpbiB0aGlzIEJyb2FkcGhhc2Ugc3ViY2xhc3MuJyk7CiAgICAgIHJldHVybiBbXTsKICAgIH0KCiAgfSAvLyBUZW1wIG9iamVjdHMKCiAgY29uc3QgQnJvYWRwaGFzZV9jb2xsaXNpb25QYWlyc19yID0gbmV3IFZlYzMoKTsKICBuZXcgVmVjMygpOwogIG5ldyBRdWF0ZXJuaW9uKCk7CiAgbmV3IFZlYzMoKTsKICBjb25zdCBCcm9hZHBoYXNlX21ha2VQYWlyc1VuaXF1ZV90ZW1wID0gewogICAga2V5czogW10KICB9OwogIGNvbnN0IEJyb2FkcGhhc2VfbWFrZVBhaXJzVW5pcXVlX3AxID0gW107CiAgY29uc3QgQnJvYWRwaGFzZV9tYWtlUGFpcnNVbmlxdWVfcDIgPSBbXTsKICBuZXcgVmVjMygpOwogIG5ldyBWZWMzKCk7CiAgbmV3IFZlYzMoKTsKCiAgLyoqCiAgICogTmFpdmUgYnJvYWRwaGFzZSBpbXBsZW1lbnRhdGlvbiwgdXNlZCBpbiBsYWNrIG9mIGJldHRlciBvbmVzLgogICAqCiAgICogVGhlIG5haXZlIGJyb2FkcGhhc2UgbG9va3MgYXQgYWxsIHBvc3NpYmxlIHBhaXJzIHdpdGhvdXQgcmVzdHJpY3Rpb24sIHRoZXJlZm9yZSBpdCBoYXMgY29tcGxleGl0eSBOXjIgXyh3aGljaCBpcyBiYWQpXwogICAqLwogIGNsYXNzIE5haXZlQnJvYWRwaGFzZSBleHRlbmRzIEJyb2FkcGhhc2UgewogICAgLyoqCiAgICAgKiBAdG9kbyBSZW1vdmUgdXNlbGVzcyBjb25zdHJ1Y3RvcgogICAgICovCiAgICBjb25zdHJ1Y3RvcigpIHsKICAgICAgc3VwZXIoKTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IGFsbCB0aGUgY29sbGlzaW9uIHBhaXJzIGluIHRoZSBwaHlzaWNzIHdvcmxkCiAgICAgKi8KCgogICAgY29sbGlzaW9uUGFpcnMod29ybGQsIHBhaXJzMSwgcGFpcnMyKSB7CiAgICAgIGNvbnN0IGJvZGllcyA9IHdvcmxkLmJvZGllczsKICAgICAgY29uc3QgbiA9IGJvZGllcy5sZW5ndGg7CiAgICAgIGxldCBiaTsKICAgICAgbGV0IGJqOyAvLyBOYWl2ZSBOXjIgZnR3IQoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IG47IGkrKykgewogICAgICAgIGZvciAobGV0IGogPSAwOyBqICE9PSBpOyBqKyspIHsKICAgICAgICAgIGJpID0gYm9kaWVzW2ldOwogICAgICAgICAgYmogPSBib2RpZXNbal07CgogICAgICAgICAgaWYgKCF0aGlzLm5lZWRCcm9hZHBoYXNlQ29sbGlzaW9uKGJpLCBiaikpIHsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICB9CgogICAgICAgICAgdGhpcy5pbnRlcnNlY3Rpb25UZXN0KGJpLCBiaiwgcGFpcnMxLCBwYWlyczIpOwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBSZXR1cm5zIGFsbCB0aGUgYm9kaWVzIHdpdGhpbiBhbiBBQUJCLgogICAgICogQHBhcmFtIHJlc3VsdCBBbiBhcnJheSB0byBzdG9yZSByZXN1bHRpbmcgYm9kaWVzIGluLgogICAgICovCgoKICAgIGFhYmJRdWVyeSh3b3JsZCwgYWFiYiwgcmVzdWx0KSB7CiAgICAgIGlmIChyZXN1bHQgPT09IHZvaWQgMCkgewogICAgICAgIHJlc3VsdCA9IFtdOwogICAgICB9CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHdvcmxkLmJvZGllcy5sZW5ndGg7IGkrKykgewogICAgICAgIGNvbnN0IGIgPSB3b3JsZC5ib2RpZXNbaV07CgogICAgICAgIGlmIChiLmFhYmJOZWVkc1VwZGF0ZSkgewogICAgICAgICAgYi51cGRhdGVBQUJCKCk7CiAgICAgICAgfSAvLyBVZ2x5IGhhY2sgdW50aWwgQm9keSBnZXRzIGFhYmIKCgogICAgICAgIGlmIChiLmFhYmIub3ZlcmxhcHMoYWFiYikpIHsKICAgICAgICAgIHJlc3VsdC5wdXNoKGIpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KCiAgfQoKICAvKioKICAgKiBTdG9yYWdlIGZvciBSYXkgY2FzdGluZyBkYXRhCiAgICovCiAgY2xhc3MgUmF5Y2FzdFJlc3VsdCB7CiAgICAvKioKICAgICAqIHJheUZyb21Xb3JsZAogICAgICovCgogICAgLyoqCiAgICAgKiByYXlUb1dvcmxkCiAgICAgKi8KCiAgICAvKioKICAgICAqIGhpdE5vcm1hbFdvcmxkCiAgICAgKi8KCiAgICAvKioKICAgICAqIGhpdFBvaW50V29ybGQKICAgICAqLwoKICAgIC8qKgogICAgICogaGFzSGl0CiAgICAgKi8KCiAgICAvKioKICAgICAqIHNoYXBlCiAgICAgKi8KCiAgICAvKioKICAgICAqIGJvZHkKICAgICAqLwoKICAgIC8qKgogICAgICogVGhlIGluZGV4IG9mIHRoZSBoaXQgdHJpYW5nbGUsIGlmIHRoZSBoaXQgc2hhcGUgd2FzIGEgdHJpbWVzaAogICAgICovCgogICAgLyoqCiAgICAgKiBEaXN0YW5jZSB0byB0aGUgaGl0LiBXaWxsIGJlIHNldCB0byAtMSBpZiB0aGVyZSB3YXMgbm8gaGl0CiAgICAgKi8KCiAgICAvKioKICAgICAqIElmIHRoZSByYXkgc2hvdWxkIHN0b3AgdHJhdmVyc2luZyB0aGUgYm9kaWVzCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKCkgewogICAgICB0aGlzLnJheUZyb21Xb3JsZCA9IG5ldyBWZWMzKCk7CiAgICAgIHRoaXMucmF5VG9Xb3JsZCA9IG5ldyBWZWMzKCk7CiAgICAgIHRoaXMuaGl0Tm9ybWFsV29ybGQgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLmhpdFBvaW50V29ybGQgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLmhhc0hpdCA9IGZhbHNlOwogICAgICB0aGlzLnNoYXBlID0gbnVsbDsKICAgICAgdGhpcy5ib2R5ID0gbnVsbDsKICAgICAgdGhpcy5oaXRGYWNlSW5kZXggPSAtMTsKICAgICAgdGhpcy5kaXN0YW5jZSA9IC0xOwogICAgICB0aGlzLnNob3VsZFN0b3AgPSBmYWxzZTsKICAgIH0KICAgIC8qKgogICAgICogUmVzZXQgYWxsIHJlc3VsdCBkYXRhLgogICAgICovCgoKICAgIHJlc2V0KCkgewogICAgICB0aGlzLnJheUZyb21Xb3JsZC5zZXRaZXJvKCk7CiAgICAgIHRoaXMucmF5VG9Xb3JsZC5zZXRaZXJvKCk7CiAgICAgIHRoaXMuaGl0Tm9ybWFsV29ybGQuc2V0WmVybygpOwogICAgICB0aGlzLmhpdFBvaW50V29ybGQuc2V0WmVybygpOwogICAgICB0aGlzLmhhc0hpdCA9IGZhbHNlOwogICAgICB0aGlzLnNoYXBlID0gbnVsbDsKICAgICAgdGhpcy5ib2R5ID0gbnVsbDsKICAgICAgdGhpcy5oaXRGYWNlSW5kZXggPSAtMTsKICAgICAgdGhpcy5kaXN0YW5jZSA9IC0xOwogICAgICB0aGlzLnNob3VsZFN0b3AgPSBmYWxzZTsKICAgIH0KICAgIC8qKgogICAgICogYWJvcnQKICAgICAqLwoKCiAgICBhYm9ydCgpIHsKICAgICAgdGhpcy5zaG91bGRTdG9wID0gdHJ1ZTsKICAgIH0KICAgIC8qKgogICAgICogU2V0IHJlc3VsdCBkYXRhLgogICAgICovCgoKICAgIHNldChyYXlGcm9tV29ybGQsIHJheVRvV29ybGQsIGhpdE5vcm1hbFdvcmxkLCBoaXRQb2ludFdvcmxkLCBzaGFwZSwgYm9keSwgZGlzdGFuY2UpIHsKICAgICAgdGhpcy5yYXlGcm9tV29ybGQuY29weShyYXlGcm9tV29ybGQpOwogICAgICB0aGlzLnJheVRvV29ybGQuY29weShyYXlUb1dvcmxkKTsKICAgICAgdGhpcy5oaXROb3JtYWxXb3JsZC5jb3B5KGhpdE5vcm1hbFdvcmxkKTsKICAgICAgdGhpcy5oaXRQb2ludFdvcmxkLmNvcHkoaGl0UG9pbnRXb3JsZCk7CiAgICAgIHRoaXMuc2hhcGUgPSBzaGFwZTsKICAgICAgdGhpcy5ib2R5ID0gYm9keTsKICAgICAgdGhpcy5kaXN0YW5jZSA9IGRpc3RhbmNlOwogICAgfQoKICB9CgogIGxldCBfU2hhcGUkdHlwZXMkU1BIRVJFLCBfU2hhcGUkdHlwZXMkUExBTkUsIF9TaGFwZSR0eXBlcyRCT1gsIF9TaGFwZSR0eXBlcyRDWUxJTkRFUiwgX1NoYXBlJHR5cGVzJENPTlZFWFBPLCBfU2hhcGUkdHlwZXMkSEVJR0hURkksIF9TaGFwZSR0eXBlcyRUUklNRVNIOwoKICAvKioKICAgKiBSQVlfTU9ERVMKICAgKi8KICBjb25zdCBSQVlfTU9ERVMgPSB7CiAgICAvKiogQ0xPU0VTVCAqLwogICAgQ0xPU0VTVDogMSwKCiAgICAvKiogQU5ZICovCiAgICBBTlk6IDIsCgogICAgLyoqIEFMTCAqLwogICAgQUxMOiA0CiAgfTsKICAvKioKICAgKiBSYXlNb2RlCiAgICovCgogIF9TaGFwZSR0eXBlcyRTUEhFUkUgPSBTaGFwZS50eXBlcy5TUEhFUkU7CiAgX1NoYXBlJHR5cGVzJFBMQU5FID0gU2hhcGUudHlwZXMuUExBTkU7CiAgX1NoYXBlJHR5cGVzJEJPWCA9IFNoYXBlLnR5cGVzLkJPWDsKICBfU2hhcGUkdHlwZXMkQ1lMSU5ERVIgPSBTaGFwZS50eXBlcy5DWUxJTkRFUjsKICBfU2hhcGUkdHlwZXMkQ09OVkVYUE8gPSBTaGFwZS50eXBlcy5DT05WRVhQT0xZSEVEUk9OOwogIF9TaGFwZSR0eXBlcyRIRUlHSFRGSSA9IFNoYXBlLnR5cGVzLkhFSUdIVEZJRUxEOwogIF9TaGFwZSR0eXBlcyRUUklNRVNIID0gU2hhcGUudHlwZXMuVFJJTUVTSDsKCiAgLyoqCiAgICogQSBsaW5lIGluIDNEIHNwYWNlIHRoYXQgaW50ZXJzZWN0cyBib2RpZXMgYW5kIHJldHVybiBwb2ludHMuCiAgICovCiAgY2xhc3MgUmF5IHsKICAgIC8qKgogICAgICogZnJvbQogICAgICovCgogICAgLyoqCiAgICAgKiB0bwogICAgICovCgogICAgLyoqCiAgICAgKiBkaXJlY3Rpb24KICAgICAqLwoKICAgIC8qKgogICAgICogVGhlIHByZWNpc2lvbiBvZiB0aGUgcmF5LiBVc2VkIHdoZW4gY2hlY2tpbmcgcGFyYWxsZWxpdHkgZXRjLgogICAgICogQGRlZmF1bHQgMC4wMDAxCiAgICAgKi8KCiAgICAvKioKICAgICAqIFNldCB0byBgZmFsc2VgIGlmIHlvdSBkb24ndCB3YW50IHRoZSBSYXkgdG8gdGFrZSBgY29sbGlzaW9uUmVzcG9uc2VgIGZsYWdzIGludG8gYWNjb3VudCBvbiBib2RpZXMgYW5kIHNoYXBlcy4KICAgICAqIEBkZWZhdWx0IHRydWUKICAgICAqLwoKICAgIC8qKgogICAgICogSWYgc2V0IHRvIGB0cnVlYCwgdGhlIHJheSBza2lwcyBhbnkgaGl0cyB3aXRoIG5vcm1hbC5kb3QocmF5RGlyZWN0aW9uKSA8IDAuCiAgICAgKiBAZGVmYXVsdCBmYWxzZQogICAgICovCgogICAgLyoqCiAgICAgKiBjb2xsaXNpb25GaWx0ZXJNYXNrCiAgICAgKiBAZGVmYXVsdCAtMQogICAgICovCgogICAgLyoqCiAgICAgKiBjb2xsaXNpb25GaWx0ZXJHcm91cAogICAgICogQGRlZmF1bHQgLTEKICAgICAqLwoKICAgIC8qKgogICAgICogVGhlIGludGVyc2VjdGlvbiBtb2RlLiBTaG91bGQgYmUgUmF5LkFOWSwgUmF5LkFMTCBvciBSYXkuQ0xPU0VTVC4KICAgICAqIEBkZWZhdWx0IFJBWS5BTlkKICAgICAqLwoKICAgIC8qKgogICAgICogQ3VycmVudCByZXN1bHQgb2JqZWN0LgogICAgICovCgogICAgLyoqCiAgICAgKiBXaWxsIGJlIHNldCB0byBgdHJ1ZWAgZHVyaW5nIGludGVyc2VjdFdvcmxkKCkgaWYgdGhlIHJheSBoaXQgYW55dGhpbmcuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFVzZXItcHJvdmlkZWQgcmVzdWx0IGNhbGxiYWNrLiBXaWxsIGJlIHVzZWQgaWYgbW9kZSBpcyBSYXkuQUxMLgogICAgICovCgogICAgLyoqCiAgICAgKiBDTE9TRVNUCiAgICAgKi8KCiAgICAvKioKICAgICAqIEFOWQogICAgICovCgogICAgLyoqCiAgICAgKiBBTEwKICAgICAqLwogICAgZ2V0IFtfU2hhcGUkdHlwZXMkU1BIRVJFXSgpIHsKICAgICAgcmV0dXJuIHRoaXMuX2ludGVyc2VjdFNwaGVyZTsKICAgIH0KCiAgICBnZXQgW19TaGFwZSR0eXBlcyRQTEFORV0oKSB7CiAgICAgIHJldHVybiB0aGlzLl9pbnRlcnNlY3RQbGFuZTsKICAgIH0KCiAgICBnZXQgW19TaGFwZSR0eXBlcyRCT1hdKCkgewogICAgICByZXR1cm4gdGhpcy5faW50ZXJzZWN0Qm94OwogICAgfQoKICAgIGdldCBbX1NoYXBlJHR5cGVzJENZTElOREVSXSgpIHsKICAgICAgcmV0dXJuIHRoaXMuX2ludGVyc2VjdENvbnZleDsKICAgIH0KCiAgICBnZXQgW19TaGFwZSR0eXBlcyRDT05WRVhQT10oKSB7CiAgICAgIHJldHVybiB0aGlzLl9pbnRlcnNlY3RDb252ZXg7CiAgICB9CgogICAgZ2V0IFtfU2hhcGUkdHlwZXMkSEVJR0hURkldKCkgewogICAgICByZXR1cm4gdGhpcy5faW50ZXJzZWN0SGVpZ2h0ZmllbGQ7CiAgICB9CgogICAgZ2V0IFtfU2hhcGUkdHlwZXMkVFJJTUVTSF0oKSB7CiAgICAgIHJldHVybiB0aGlzLl9pbnRlcnNlY3RUcmltZXNoOwogICAgfQoKICAgIGNvbnN0cnVjdG9yKGZyb20sIHRvKSB7CiAgICAgIGlmIChmcm9tID09PSB2b2lkIDApIHsKICAgICAgICBmcm9tID0gbmV3IFZlYzMoKTsKICAgICAgfQoKICAgICAgaWYgKHRvID09PSB2b2lkIDApIHsKICAgICAgICB0byA9IG5ldyBWZWMzKCk7CiAgICAgIH0KCiAgICAgIHRoaXMuZnJvbSA9IGZyb20uY2xvbmUoKTsKICAgICAgdGhpcy50byA9IHRvLmNsb25lKCk7CiAgICAgIHRoaXMuZGlyZWN0aW9uID0gbmV3IFZlYzMoKTsKICAgICAgdGhpcy5wcmVjaXNpb24gPSAwLjAwMDE7CiAgICAgIHRoaXMuY2hlY2tDb2xsaXNpb25SZXNwb25zZSA9IHRydWU7CiAgICAgIHRoaXMuc2tpcEJhY2tmYWNlcyA9IGZhbHNlOwogICAgICB0aGlzLmNvbGxpc2lvbkZpbHRlck1hc2sgPSAtMTsKICAgICAgdGhpcy5jb2xsaXNpb25GaWx0ZXJHcm91cCA9IC0xOwogICAgICB0aGlzLm1vZGUgPSBSYXkuQU5ZOwogICAgICB0aGlzLnJlc3VsdCA9IG5ldyBSYXljYXN0UmVzdWx0KCk7CiAgICAgIHRoaXMuaGFzSGl0ID0gZmFsc2U7CgogICAgICB0aGlzLmNhbGxiYWNrID0gcmVzdWx0ID0+IHt9OwogICAgfQogICAgLyoqCiAgICAgKiBEbyBpdGVyc2VjdGlvbiBhZ2FpbnN0IGFsbCBib2RpZXMgaW4gdGhlIGdpdmVuIFdvcmxkLgogICAgICogQHJldHVybiBUcnVlIGlmIHRoZSByYXkgaGl0IGFueXRoaW5nLCBvdGhlcndpc2UgZmFsc2UuCiAgICAgKi8KCgogICAgaW50ZXJzZWN0V29ybGQod29ybGQsIG9wdGlvbnMpIHsKICAgICAgdGhpcy5tb2RlID0gb3B0aW9ucy5tb2RlIHx8IFJheS5BTlk7CiAgICAgIHRoaXMucmVzdWx0ID0gb3B0aW9ucy5yZXN1bHQgfHwgbmV3IFJheWNhc3RSZXN1bHQoKTsKICAgICAgdGhpcy5za2lwQmFja2ZhY2VzID0gISFvcHRpb25zLnNraXBCYWNrZmFjZXM7CiAgICAgIHRoaXMuY29sbGlzaW9uRmlsdGVyTWFzayA9IHR5cGVvZiBvcHRpb25zLmNvbGxpc2lvbkZpbHRlck1hc2sgIT09ICd1bmRlZmluZWQnID8gb3B0aW9ucy5jb2xsaXNpb25GaWx0ZXJNYXNrIDogLTE7CiAgICAgIHRoaXMuY29sbGlzaW9uRmlsdGVyR3JvdXAgPSB0eXBlb2Ygb3B0aW9ucy5jb2xsaXNpb25GaWx0ZXJHcm91cCAhPT0gJ3VuZGVmaW5lZCcgPyBvcHRpb25zLmNvbGxpc2lvbkZpbHRlckdyb3VwIDogLTE7CiAgICAgIHRoaXMuY2hlY2tDb2xsaXNpb25SZXNwb25zZSA9IHR5cGVvZiBvcHRpb25zLmNoZWNrQ29sbGlzaW9uUmVzcG9uc2UgIT09ICd1bmRlZmluZWQnID8gb3B0aW9ucy5jaGVja0NvbGxpc2lvblJlc3BvbnNlIDogdHJ1ZTsKCiAgICAgIGlmIChvcHRpb25zLmZyb20pIHsKICAgICAgICB0aGlzLmZyb20uY29weShvcHRpb25zLmZyb20pOwogICAgICB9CgogICAgICBpZiAob3B0aW9ucy50bykgewogICAgICAgIHRoaXMudG8uY29weShvcHRpb25zLnRvKTsKICAgICAgfQoKICAgICAgdGhpcy5jYWxsYmFjayA9IG9wdGlvbnMuY2FsbGJhY2sgfHwgKCgpID0+IHt9KTsKCiAgICAgIHRoaXMuaGFzSGl0ID0gZmFsc2U7CiAgICAgIHRoaXMucmVzdWx0LnJlc2V0KCk7CiAgICAgIHRoaXMudXBkYXRlRGlyZWN0aW9uKCk7CiAgICAgIHRoaXMuZ2V0QUFCQih0bXBBQUJCJDEpOwogICAgICB0bXBBcnJheS5sZW5ndGggPSAwOwogICAgICB3b3JsZC5icm9hZHBoYXNlLmFhYmJRdWVyeSh3b3JsZCwgdG1wQUFCQiQxLCB0bXBBcnJheSk7CiAgICAgIHRoaXMuaW50ZXJzZWN0Qm9kaWVzKHRtcEFycmF5KTsKICAgICAgcmV0dXJuIHRoaXMuaGFzSGl0OwogICAgfQogICAgLyoqCiAgICAgKiBTaG9vdCBhIHJheSBhdCBhIGJvZHksIGdldCBiYWNrIGluZm9ybWF0aW9uIGFib3V0IHRoZSBoaXQuCiAgICAgKiBAZGVwcmVjYXRlZCBAcGFyYW0gcmVzdWx0IHNldCB0aGUgcmVzdWx0IHByb3BlcnR5IG9mIHRoZSBSYXkgaW5zdGVhZC4KICAgICAqLwoKCiAgICBpbnRlcnNlY3RCb2R5KGJvZHksIHJlc3VsdCkgewogICAgICBpZiAocmVzdWx0KSB7CiAgICAgICAgdGhpcy5yZXN1bHQgPSByZXN1bHQ7CiAgICAgICAgdGhpcy51cGRhdGVEaXJlY3Rpb24oKTsKICAgICAgfQoKICAgICAgY29uc3QgY2hlY2tDb2xsaXNpb25SZXNwb25zZSA9IHRoaXMuY2hlY2tDb2xsaXNpb25SZXNwb25zZTsKCiAgICAgIGlmIChjaGVja0NvbGxpc2lvblJlc3BvbnNlICYmICFib2R5LmNvbGxpc2lvblJlc3BvbnNlKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAoKHRoaXMuY29sbGlzaW9uRmlsdGVyR3JvdXAgJiBib2R5LmNvbGxpc2lvbkZpbHRlck1hc2spID09PSAwIHx8IChib2R5LmNvbGxpc2lvbkZpbHRlckdyb3VwICYgdGhpcy5jb2xsaXNpb25GaWx0ZXJNYXNrKSA9PT0gMCkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgY29uc3QgeGkgPSBpbnRlcnNlY3RCb2R5X3hpOwogICAgICBjb25zdCBxaSA9IGludGVyc2VjdEJvZHlfcWk7CgogICAgICBmb3IgKGxldCBpID0gMCwgTiA9IGJvZHkuc2hhcGVzLmxlbmd0aDsgaSA8IE47IGkrKykgewogICAgICAgIGNvbnN0IHNoYXBlID0gYm9keS5zaGFwZXNbaV07CgogICAgICAgIGlmIChjaGVja0NvbGxpc2lvblJlc3BvbnNlICYmICFzaGFwZS5jb2xsaXNpb25SZXNwb25zZSkgewogICAgICAgICAgY29udGludWU7IC8vIFNraXAKICAgICAgICB9CgogICAgICAgIGJvZHkucXVhdGVybmlvbi5tdWx0KGJvZHkuc2hhcGVPcmllbnRhdGlvbnNbaV0sIHFpKTsKICAgICAgICBib2R5LnF1YXRlcm5pb24udm11bHQoYm9keS5zaGFwZU9mZnNldHNbaV0sIHhpKTsKICAgICAgICB4aS52YWRkKGJvZHkucG9zaXRpb24sIHhpKTsKICAgICAgICB0aGlzLmludGVyc2VjdFNoYXBlKHNoYXBlLCBxaSwgeGksIGJvZHkpOwoKICAgICAgICBpZiAodGhpcy5yZXN1bHQuc2hvdWxkU3RvcCkgewogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIFNob290IGEgcmF5IGF0IGFuIGFycmF5IGJvZGllcywgZ2V0IGJhY2sgaW5mb3JtYXRpb24gYWJvdXQgdGhlIGhpdC4KICAgICAqIEBwYXJhbSBib2RpZXMgQW4gYXJyYXkgb2YgQm9keSBvYmplY3RzLgogICAgICogQGRlcHJlY2F0ZWQgQHBhcmFtIHJlc3VsdCBzZXQgdGhlIHJlc3VsdCBwcm9wZXJ0eSBvZiB0aGUgUmF5IGluc3RlYWQuCiAgICAgKgogICAgICovCgoKICAgIGludGVyc2VjdEJvZGllcyhib2RpZXMsIHJlc3VsdCkgewogICAgICBpZiAocmVzdWx0KSB7CiAgICAgICAgdGhpcy5yZXN1bHQgPSByZXN1bHQ7CiAgICAgICAgdGhpcy51cGRhdGVEaXJlY3Rpb24oKTsKICAgICAgfQoKICAgICAgZm9yIChsZXQgaSA9IDAsIGwgPSBib2RpZXMubGVuZ3RoOyAhdGhpcy5yZXN1bHQuc2hvdWxkU3RvcCAmJiBpIDwgbDsgaSsrKSB7CiAgICAgICAgdGhpcy5pbnRlcnNlY3RCb2R5KGJvZGllc1tpXSk7CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogVXBkYXRlcyB0aGUgZGlyZWN0aW9uIHZlY3Rvci4KICAgICAqLwoKCiAgICB1cGRhdGVEaXJlY3Rpb24oKSB7CiAgICAgIHRoaXMudG8udnN1Yih0aGlzLmZyb20sIHRoaXMuZGlyZWN0aW9uKTsKICAgICAgdGhpcy5kaXJlY3Rpb24ubm9ybWFsaXplKCk7CiAgICB9CgogICAgaW50ZXJzZWN0U2hhcGUoc2hhcGUsIHF1YXQsIHBvc2l0aW9uLCBib2R5KSB7CiAgICAgIGNvbnN0IGZyb20gPSB0aGlzLmZyb207IC8vIENoZWNraW5nIGJvdW5kaW5nU3BoZXJlCgogICAgICBjb25zdCBkaXN0YW5jZSA9IGRpc3RhbmNlRnJvbUludGVyc2VjdGlvbihmcm9tLCB0aGlzLmRpcmVjdGlvbiwgcG9zaXRpb24pOwoKICAgICAgaWYgKGRpc3RhbmNlID4gc2hhcGUuYm91bmRpbmdTcGhlcmVSYWRpdXMpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGNvbnN0IGludGVyc2VjdE1ldGhvZCA9IHRoaXNbc2hhcGUudHlwZV07CgogICAgICBpZiAoaW50ZXJzZWN0TWV0aG9kKSB7CiAgICAgICAgaW50ZXJzZWN0TWV0aG9kLmNhbGwodGhpcywgc2hhcGUsIHF1YXQsIHBvc2l0aW9uLCBib2R5LCBzaGFwZSk7CiAgICAgIH0KICAgIH0KCiAgICBfaW50ZXJzZWN0Qm94KGJveCwgcXVhdCwgcG9zaXRpb24sIGJvZHksIHJlcG9ydGVkU2hhcGUpIHsKICAgICAgcmV0dXJuIHRoaXMuX2ludGVyc2VjdENvbnZleChib3guY29udmV4UG9seWhlZHJvblJlcHJlc2VudGF0aW9uLCBxdWF0LCBwb3NpdGlvbiwgYm9keSwgcmVwb3J0ZWRTaGFwZSk7CiAgICB9CgogICAgX2ludGVyc2VjdFBsYW5lKHNoYXBlLCBxdWF0LCBwb3NpdGlvbiwgYm9keSwgcmVwb3J0ZWRTaGFwZSkgewogICAgICBjb25zdCBmcm9tID0gdGhpcy5mcm9tOwogICAgICBjb25zdCB0byA9IHRoaXMudG87CiAgICAgIGNvbnN0IGRpcmVjdGlvbiA9IHRoaXMuZGlyZWN0aW9uOyAvLyBHZXQgcGxhbmUgbm9ybWFsCgogICAgICBjb25zdCB3b3JsZE5vcm1hbCA9IG5ldyBWZWMzKDAsIDAsIDEpOwogICAgICBxdWF0LnZtdWx0KHdvcmxkTm9ybWFsLCB3b3JsZE5vcm1hbCk7CiAgICAgIGNvbnN0IGxlbiA9IG5ldyBWZWMzKCk7CiAgICAgIGZyb20udnN1Yihwb3NpdGlvbiwgbGVuKTsKICAgICAgY29uc3QgcGxhbmVUb0Zyb20gPSBsZW4uZG90KHdvcmxkTm9ybWFsKTsKICAgICAgdG8udnN1Yihwb3NpdGlvbiwgbGVuKTsKICAgICAgY29uc3QgcGxhbmVUb1RvID0gbGVuLmRvdCh3b3JsZE5vcm1hbCk7CgogICAgICBpZiAocGxhbmVUb0Zyb20gKiBwbGFuZVRvVG8gPiAwKSB7CiAgICAgICAgLy8gImZyb20iIGFuZCAidG8iIGFyZSBvbiB0aGUgc2FtZSBzaWRlIG9mIHRoZSBwbGFuZS4uLiBiYWlsIG91dAogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKGZyb20uZGlzdGFuY2VUbyh0bykgPCBwbGFuZVRvRnJvbSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgY29uc3Qgbl9kb3RfZGlyID0gd29ybGROb3JtYWwuZG90KGRpcmVjdGlvbik7CgogICAgICBpZiAoTWF0aC5hYnMobl9kb3RfZGlyKSA8IHRoaXMucHJlY2lzaW9uKSB7CiAgICAgICAgLy8gTm8gaW50ZXJzZWN0aW9uCiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBjb25zdCBwbGFuZVBvaW50VG9Gcm9tID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3QgZGlyX3NjYWxlZF93aXRoX3QgPSBuZXcgVmVjMygpOwogICAgICBjb25zdCBoaXRQb2ludFdvcmxkID0gbmV3IFZlYzMoKTsKICAgICAgZnJvbS52c3ViKHBvc2l0aW9uLCBwbGFuZVBvaW50VG9Gcm9tKTsKICAgICAgY29uc3QgdCA9IC13b3JsZE5vcm1hbC5kb3QocGxhbmVQb2ludFRvRnJvbSkgLyBuX2RvdF9kaXI7CiAgICAgIGRpcmVjdGlvbi5zY2FsZSh0LCBkaXJfc2NhbGVkX3dpdGhfdCk7CiAgICAgIGZyb20udmFkZChkaXJfc2NhbGVkX3dpdGhfdCwgaGl0UG9pbnRXb3JsZCk7CiAgICAgIHRoaXMucmVwb3J0SW50ZXJzZWN0aW9uKHdvcmxkTm9ybWFsLCBoaXRQb2ludFdvcmxkLCByZXBvcnRlZFNoYXBlLCBib2R5LCAtMSk7CiAgICB9CiAgICAvKioKICAgICAqIEdldCB0aGUgd29ybGQgQUFCQiBvZiB0aGUgcmF5LgogICAgICovCgoKICAgIGdldEFBQkIoYWFiYikgewogICAgICBjb25zdCB7CiAgICAgICAgbG93ZXJCb3VuZCwKICAgICAgICB1cHBlckJvdW5kCiAgICAgIH0gPSBhYWJiOwogICAgICBjb25zdCB0byA9IHRoaXMudG87CiAgICAgIGNvbnN0IGZyb20gPSB0aGlzLmZyb207CiAgICAgIGxvd2VyQm91bmQueCA9IE1hdGgubWluKHRvLngsIGZyb20ueCk7CiAgICAgIGxvd2VyQm91bmQueSA9IE1hdGgubWluKHRvLnksIGZyb20ueSk7CiAgICAgIGxvd2VyQm91bmQueiA9IE1hdGgubWluKHRvLnosIGZyb20ueik7CiAgICAgIHVwcGVyQm91bmQueCA9IE1hdGgubWF4KHRvLngsIGZyb20ueCk7CiAgICAgIHVwcGVyQm91bmQueSA9IE1hdGgubWF4KHRvLnksIGZyb20ueSk7CiAgICAgIHVwcGVyQm91bmQueiA9IE1hdGgubWF4KHRvLnosIGZyb20ueik7CiAgICB9CgogICAgX2ludGVyc2VjdEhlaWdodGZpZWxkKHNoYXBlLCBxdWF0LCBwb3NpdGlvbiwgYm9keSwgcmVwb3J0ZWRTaGFwZSkgewogICAgICBzaGFwZS5kYXRhOwogICAgICBzaGFwZS5lbGVtZW50U2l6ZTsgLy8gQ29udmVydCB0aGUgcmF5IHRvIGxvY2FsIGhlaWdodGZpZWxkIGNvb3JkaW5hdGVzCgogICAgICBjb25zdCBsb2NhbFJheSA9IGludGVyc2VjdEhlaWdodGZpZWxkX2xvY2FsUmF5OyAvL25ldyBSYXkodGhpcy5mcm9tLCB0aGlzLnRvKTsKCiAgICAgIGxvY2FsUmF5LmZyb20uY29weSh0aGlzLmZyb20pOwogICAgICBsb2NhbFJheS50by5jb3B5KHRoaXMudG8pOwogICAgICBUcmFuc2Zvcm0ucG9pbnRUb0xvY2FsRnJhbWUocG9zaXRpb24sIHF1YXQsIGxvY2FsUmF5LmZyb20sIGxvY2FsUmF5LmZyb20pOwogICAgICBUcmFuc2Zvcm0ucG9pbnRUb0xvY2FsRnJhbWUocG9zaXRpb24sIHF1YXQsIGxvY2FsUmF5LnRvLCBsb2NhbFJheS50byk7CiAgICAgIGxvY2FsUmF5LnVwZGF0ZURpcmVjdGlvbigpOyAvLyBHZXQgdGhlIGluZGV4IG9mIHRoZSBkYXRhIHBvaW50cyB0byB0ZXN0IGFnYWluc3QKCiAgICAgIGNvbnN0IGluZGV4ID0gaW50ZXJzZWN0SGVpZ2h0ZmllbGRfaW5kZXg7CiAgICAgIGxldCBpTWluWDsKICAgICAgbGV0IGlNaW5ZOwogICAgICBsZXQgaU1heFg7CiAgICAgIGxldCBpTWF4WTsgLy8gU2V0IHRvIG1heAoKICAgICAgaU1pblggPSBpTWluWSA9IDA7CiAgICAgIGlNYXhYID0gaU1heFkgPSBzaGFwZS5kYXRhLmxlbmd0aCAtIDE7CiAgICAgIGNvbnN0IGFhYmIgPSBuZXcgQUFCQigpOwogICAgICBsb2NhbFJheS5nZXRBQUJCKGFhYmIpOwogICAgICBzaGFwZS5nZXRJbmRleE9mUG9zaXRpb24oYWFiYi5sb3dlckJvdW5kLngsIGFhYmIubG93ZXJCb3VuZC55LCBpbmRleCwgdHJ1ZSk7CiAgICAgIGlNaW5YID0gTWF0aC5tYXgoaU1pblgsIGluZGV4WzBdKTsKICAgICAgaU1pblkgPSBNYXRoLm1heChpTWluWSwgaW5kZXhbMV0pOwogICAgICBzaGFwZS5nZXRJbmRleE9mUG9zaXRpb24oYWFiYi51cHBlckJvdW5kLngsIGFhYmIudXBwZXJCb3VuZC55LCBpbmRleCwgdHJ1ZSk7CiAgICAgIGlNYXhYID0gTWF0aC5taW4oaU1heFgsIGluZGV4WzBdICsgMSk7CiAgICAgIGlNYXhZID0gTWF0aC5taW4oaU1heFksIGluZGV4WzFdICsgMSk7CgogICAgICBmb3IgKGxldCBpID0gaU1pblg7IGkgPCBpTWF4WDsgaSsrKSB7CiAgICAgICAgZm9yIChsZXQgaiA9IGlNaW5ZOyBqIDwgaU1heFk7IGorKykgewogICAgICAgICAgaWYgKHRoaXMucmVzdWx0LnNob3VsZFN0b3ApIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQoKICAgICAgICAgIHNoYXBlLmdldEFhYmJBdEluZGV4KGksIGosIGFhYmIpOwoKICAgICAgICAgIGlmICghYWFiYi5vdmVybGFwc1JheShsb2NhbFJheSkpIHsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICB9IC8vIExvd2VyIHRyaWFuZ2xlCgoKICAgICAgICAgIHNoYXBlLmdldENvbnZleFRyaWFuZ2xlUGlsbGFyKGksIGosIGZhbHNlKTsKICAgICAgICAgIFRyYW5zZm9ybS5wb2ludFRvV29ybGRGcmFtZShwb3NpdGlvbiwgcXVhdCwgc2hhcGUucGlsbGFyT2Zmc2V0LCB3b3JsZFBpbGxhck9mZnNldCk7CgogICAgICAgICAgdGhpcy5faW50ZXJzZWN0Q29udmV4KHNoYXBlLnBpbGxhckNvbnZleCwgcXVhdCwgd29ybGRQaWxsYXJPZmZzZXQsIGJvZHksIHJlcG9ydGVkU2hhcGUsIGludGVyc2VjdENvbnZleE9wdGlvbnMpOwoKICAgICAgICAgIGlmICh0aGlzLnJlc3VsdC5zaG91bGRTdG9wKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0gLy8gVXBwZXIgdHJpYW5nbGUKCgogICAgICAgICAgc2hhcGUuZ2V0Q29udmV4VHJpYW5nbGVQaWxsYXIoaSwgaiwgdHJ1ZSk7CiAgICAgICAgICBUcmFuc2Zvcm0ucG9pbnRUb1dvcmxkRnJhbWUocG9zaXRpb24sIHF1YXQsIHNoYXBlLnBpbGxhck9mZnNldCwgd29ybGRQaWxsYXJPZmZzZXQpOwoKICAgICAgICAgIHRoaXMuX2ludGVyc2VjdENvbnZleChzaGFwZS5waWxsYXJDb252ZXgsIHF1YXQsIHdvcmxkUGlsbGFyT2Zmc2V0LCBib2R5LCByZXBvcnRlZFNoYXBlLCBpbnRlcnNlY3RDb252ZXhPcHRpb25zKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBfaW50ZXJzZWN0U3BoZXJlKHNwaGVyZSwgcXVhdCwgcG9zaXRpb24sIGJvZHksIHJlcG9ydGVkU2hhcGUpIHsKICAgICAgY29uc3QgZnJvbSA9IHRoaXMuZnJvbTsKICAgICAgY29uc3QgdG8gPSB0aGlzLnRvOwogICAgICBjb25zdCByID0gc3BoZXJlLnJhZGl1czsKICAgICAgY29uc3QgYSA9ICh0by54IC0gZnJvbS54KSAqKiAyICsgKHRvLnkgLSBmcm9tLnkpICoqIDIgKyAodG8ueiAtIGZyb20ueikgKiogMjsKICAgICAgY29uc3QgYiA9IDIgKiAoKHRvLnggLSBmcm9tLngpICogKGZyb20ueCAtIHBvc2l0aW9uLngpICsgKHRvLnkgLSBmcm9tLnkpICogKGZyb20ueSAtIHBvc2l0aW9uLnkpICsgKHRvLnogLSBmcm9tLnopICogKGZyb20ueiAtIHBvc2l0aW9uLnopKTsKICAgICAgY29uc3QgYyA9IChmcm9tLnggLSBwb3NpdGlvbi54KSAqKiAyICsgKGZyb20ueSAtIHBvc2l0aW9uLnkpICoqIDIgKyAoZnJvbS56IC0gcG9zaXRpb24ueikgKiogMiAtIHIgKiogMjsKICAgICAgY29uc3QgZGVsdGEgPSBiICoqIDIgLSA0ICogYSAqIGM7CiAgICAgIGNvbnN0IGludGVyc2VjdGlvblBvaW50ID0gUmF5X2ludGVyc2VjdFNwaGVyZV9pbnRlcnNlY3Rpb25Qb2ludDsKICAgICAgY29uc3Qgbm9ybWFsID0gUmF5X2ludGVyc2VjdFNwaGVyZV9ub3JtYWw7CgogICAgICBpZiAoZGVsdGEgPCAwKSB7CiAgICAgICAgLy8gTm8gaW50ZXJzZWN0aW9uCiAgICAgICAgcmV0dXJuOwogICAgICB9IGVsc2UgaWYgKGRlbHRhID09PSAwKSB7CiAgICAgICAgLy8gc2luZ2xlIGludGVyc2VjdGlvbiBwb2ludAogICAgICAgIGZyb20ubGVycCh0bywgZGVsdGEsIGludGVyc2VjdGlvblBvaW50KTsKICAgICAgICBpbnRlcnNlY3Rpb25Qb2ludC52c3ViKHBvc2l0aW9uLCBub3JtYWwpOwogICAgICAgIG5vcm1hbC5ub3JtYWxpemUoKTsKICAgICAgICB0aGlzLnJlcG9ydEludGVyc2VjdGlvbihub3JtYWwsIGludGVyc2VjdGlvblBvaW50LCByZXBvcnRlZFNoYXBlLCBib2R5LCAtMSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29uc3QgZDEgPSAoLWIgLSBNYXRoLnNxcnQoZGVsdGEpKSAvICgyICogYSk7CiAgICAgICAgY29uc3QgZDIgPSAoLWIgKyBNYXRoLnNxcnQoZGVsdGEpKSAvICgyICogYSk7CgogICAgICAgIGlmIChkMSA+PSAwICYmIGQxIDw9IDEpIHsKICAgICAgICAgIGZyb20ubGVycCh0bywgZDEsIGludGVyc2VjdGlvblBvaW50KTsKICAgICAgICAgIGludGVyc2VjdGlvblBvaW50LnZzdWIocG9zaXRpb24sIG5vcm1hbCk7CiAgICAgICAgICBub3JtYWwubm9ybWFsaXplKCk7CiAgICAgICAgICB0aGlzLnJlcG9ydEludGVyc2VjdGlvbihub3JtYWwsIGludGVyc2VjdGlvblBvaW50LCByZXBvcnRlZFNoYXBlLCBib2R5LCAtMSk7CiAgICAgICAgfQoKICAgICAgICBpZiAodGhpcy5yZXN1bHQuc2hvdWxkU3RvcCkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgaWYgKGQyID49IDAgJiYgZDIgPD0gMSkgewogICAgICAgICAgZnJvbS5sZXJwKHRvLCBkMiwgaW50ZXJzZWN0aW9uUG9pbnQpOwogICAgICAgICAgaW50ZXJzZWN0aW9uUG9pbnQudnN1Yihwb3NpdGlvbiwgbm9ybWFsKTsKICAgICAgICAgIG5vcm1hbC5ub3JtYWxpemUoKTsKICAgICAgICAgIHRoaXMucmVwb3J0SW50ZXJzZWN0aW9uKG5vcm1hbCwgaW50ZXJzZWN0aW9uUG9pbnQsIHJlcG9ydGVkU2hhcGUsIGJvZHksIC0xKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBfaW50ZXJzZWN0Q29udmV4KHNoYXBlLCBxdWF0LCBwb3NpdGlvbiwgYm9keSwgcmVwb3J0ZWRTaGFwZSwgb3B0aW9ucykgewogICAgICBjb25zdCBub3JtYWwgPSBpbnRlcnNlY3RDb252ZXhfbm9ybWFsOwogICAgICBjb25zdCB2ZWN0b3IgPSBpbnRlcnNlY3RDb252ZXhfdmVjdG9yOwogICAgICBjb25zdCBmYWNlTGlzdCA9IG9wdGlvbnMgJiYgb3B0aW9ucy5mYWNlTGlzdCB8fCBudWxsOyAvLyBDaGVja2luZyBmYWNlcwoKICAgICAgY29uc3QgZmFjZXMgPSBzaGFwZS5mYWNlczsKICAgICAgY29uc3QgdmVydGljZXMgPSBzaGFwZS52ZXJ0aWNlczsKICAgICAgY29uc3Qgbm9ybWFscyA9IHNoYXBlLmZhY2VOb3JtYWxzOwogICAgICBjb25zdCBkaXJlY3Rpb24gPSB0aGlzLmRpcmVjdGlvbjsKICAgICAgY29uc3QgZnJvbSA9IHRoaXMuZnJvbTsKICAgICAgY29uc3QgdG8gPSB0aGlzLnRvOwogICAgICBjb25zdCBmcm9tVG9EaXN0YW5jZSA9IGZyb20uZGlzdGFuY2VUbyh0byk7CiAgICAgIGNvbnN0IE5mYWNlcyA9IGZhY2VMaXN0ID8gZmFjZUxpc3QubGVuZ3RoIDogZmFjZXMubGVuZ3RoOwogICAgICBjb25zdCByZXN1bHQgPSB0aGlzLnJlc3VsdDsKCiAgICAgIGZvciAobGV0IGogPSAwOyAhcmVzdWx0LnNob3VsZFN0b3AgJiYgaiA8IE5mYWNlczsgaisrKSB7CiAgICAgICAgY29uc3QgZmkgPSBmYWNlTGlzdCA/IGZhY2VMaXN0W2pdIDogajsKICAgICAgICBjb25zdCBmYWNlID0gZmFjZXNbZmldOwogICAgICAgIGNvbnN0IGZhY2VOb3JtYWwgPSBub3JtYWxzW2ZpXTsKICAgICAgICBjb25zdCBxID0gcXVhdDsKICAgICAgICBjb25zdCB4ID0gcG9zaXRpb247IC8vIGRldGVybWluZSBpZiByYXkgaW50ZXJzZWN0cyB0aGUgcGxhbmUgb2YgdGhlIGZhY2UKICAgICAgICAvLyBub3RlOiB0aGlzIHdvcmtzIHJlZ2FyZGxlc3Mgb2YgdGhlIGRpcmVjdGlvbiBvZiB0aGUgZmFjZSBub3JtYWwKICAgICAgICAvLyBHZXQgcGxhbmUgcG9pbnQgaW4gd29ybGQgY29vcmRpbmF0ZXMuLi4KCiAgICAgICAgdmVjdG9yLmNvcHkodmVydGljZXNbZmFjZVswXV0pOwogICAgICAgIHEudm11bHQodmVjdG9yLCB2ZWN0b3IpOwogICAgICAgIHZlY3Rvci52YWRkKHgsIHZlY3Rvcik7IC8vIC4uLmJ1dCBtYWtlIGl0IHJlbGF0aXZlIHRvIHRoZSByYXkgZnJvbS4gV2UnbGwgZml4IHRoaXMgbGF0ZXIuCgogICAgICAgIHZlY3Rvci52c3ViKGZyb20sIHZlY3Rvcik7IC8vIEdldCBwbGFuZSBub3JtYWwKCiAgICAgICAgcS52bXVsdChmYWNlTm9ybWFsLCBub3JtYWwpOyAvLyBJZiB0aGlzIGRvdCBwcm9kdWN0IGlzIG5lZ2F0aXZlLCB3ZSBoYXZlIHNvbWV0aGluZyBpbnRlcmVzdGluZwoKICAgICAgICBjb25zdCBkb3QgPSBkaXJlY3Rpb24uZG90KG5vcm1hbCk7IC8vIEJhaWwgb3V0IGlmIHJheSBhbmQgcGxhbmUgYXJlIHBhcmFsbGVsCgogICAgICAgIGlmIChNYXRoLmFicyhkb3QpIDwgdGhpcy5wcmVjaXNpb24pIHsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0gLy8gY2FsYyBkaXN0YW5jZSB0byBwbGFuZQoKCiAgICAgICAgY29uc3Qgc2NhbGFyID0gbm9ybWFsLmRvdCh2ZWN0b3IpIC8gZG90OyAvLyBpZiBuZWdhdGl2ZSBkaXN0YW5jZSwgdGhlbiBwbGFuZSBpcyBiZWhpbmQgcmF5CgogICAgICAgIGlmIChzY2FsYXIgPCAwKSB7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9IC8vIGlmIChkb3QgPCAwKSB7CiAgICAgICAgLy8gSW50ZXJzZWN0aW9uIHBvaW50IGlzIGZyb20gKyBkaXJlY3Rpb24gKiBzY2FsYXIKCgogICAgICAgIGRpcmVjdGlvbi5zY2FsZShzY2FsYXIsIGludGVyc2VjdFBvaW50KTsKICAgICAgICBpbnRlcnNlY3RQb2ludC52YWRkKGZyb20sIGludGVyc2VjdFBvaW50KTsgLy8gYSBpcyB0aGUgcG9pbnQgd2UgY29tcGFyZSBwb2ludHMgYiBhbmQgYyB3aXRoLgoKICAgICAgICBhLmNvcHkodmVydGljZXNbZmFjZVswXV0pOwogICAgICAgIHEudm11bHQoYSwgYSk7CiAgICAgICAgeC52YWRkKGEsIGEpOwoKICAgICAgICBmb3IgKGxldCBpID0gMTsgIXJlc3VsdC5zaG91bGRTdG9wICYmIGkgPCBmYWNlLmxlbmd0aCAtIDE7IGkrKykgewogICAgICAgICAgLy8gVHJhbnNmb3JtIDMgdmVydGljZXMgdG8gd29ybGQgY29vcmRzCiAgICAgICAgICBiLmNvcHkodmVydGljZXNbZmFjZVtpXV0pOwogICAgICAgICAgYy5jb3B5KHZlcnRpY2VzW2ZhY2VbaSArIDFdXSk7CiAgICAgICAgICBxLnZtdWx0KGIsIGIpOwogICAgICAgICAgcS52bXVsdChjLCBjKTsKICAgICAgICAgIHgudmFkZChiLCBiKTsKICAgICAgICAgIHgudmFkZChjLCBjKTsKICAgICAgICAgIGNvbnN0IGRpc3RhbmNlID0gaW50ZXJzZWN0UG9pbnQuZGlzdGFuY2VUbyhmcm9tKTsKCiAgICAgICAgICBpZiAoIShSYXkucG9pbnRJblRyaWFuZ2xlKGludGVyc2VjdFBvaW50LCBhLCBiLCBjKSB8fCBSYXkucG9pbnRJblRyaWFuZ2xlKGludGVyc2VjdFBvaW50LCBiLCBhLCBjKSkgfHwgZGlzdGFuY2UgPiBmcm9tVG9EaXN0YW5jZSkgewogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgIH0KCiAgICAgICAgICB0aGlzLnJlcG9ydEludGVyc2VjdGlvbihub3JtYWwsIGludGVyc2VjdFBvaW50LCByZXBvcnRlZFNoYXBlLCBib2R5LCBmaSk7CiAgICAgICAgfSAvLyB9CgogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIEB0b2RvIE9wdGltaXplIGJ5IHRyYW5zZm9ybWluZyB0aGUgd29ybGQgdG8gbG9jYWwgc3BhY2UgZmlyc3QuCiAgICAgKiBAdG9kbyBVc2UgT2N0cmVlIGxvb2t1cAogICAgICovCgoKICAgIF9pbnRlcnNlY3RUcmltZXNoKG1lc2gsIHF1YXQsIHBvc2l0aW9uLCBib2R5LCByZXBvcnRlZFNoYXBlLCBvcHRpb25zKSB7CiAgICAgIGNvbnN0IG5vcm1hbCA9IGludGVyc2VjdFRyaW1lc2hfbm9ybWFsOwogICAgICBjb25zdCB0cmlhbmdsZXMgPSBpbnRlcnNlY3RUcmltZXNoX3RyaWFuZ2xlczsKICAgICAgY29uc3QgdHJlZVRyYW5zZm9ybSA9IGludGVyc2VjdFRyaW1lc2hfdHJlZVRyYW5zZm9ybTsKICAgICAgY29uc3QgdmVjdG9yID0gaW50ZXJzZWN0Q29udmV4X3ZlY3RvcjsKICAgICAgY29uc3QgbG9jYWxEaXJlY3Rpb24gPSBpbnRlcnNlY3RUcmltZXNoX2xvY2FsRGlyZWN0aW9uOwogICAgICBjb25zdCBsb2NhbEZyb20gPSBpbnRlcnNlY3RUcmltZXNoX2xvY2FsRnJvbTsKICAgICAgY29uc3QgbG9jYWxUbyA9IGludGVyc2VjdFRyaW1lc2hfbG9jYWxUbzsKICAgICAgY29uc3Qgd29ybGRJbnRlcnNlY3RQb2ludCA9IGludGVyc2VjdFRyaW1lc2hfd29ybGRJbnRlcnNlY3RQb2ludDsKICAgICAgY29uc3Qgd29ybGROb3JtYWwgPSBpbnRlcnNlY3RUcmltZXNoX3dvcmxkTm9ybWFsOyAvLyBDaGVja2luZyBmYWNlcwoKICAgICAgY29uc3QgaW5kaWNlcyA9IG1lc2guaW5kaWNlczsKICAgICAgbWVzaC52ZXJ0aWNlczsgLy8gY29uc3Qgbm9ybWFscyA9IG1lc2guZmFjZU5vcm1hbHMKCiAgICAgIGNvbnN0IGZyb20gPSB0aGlzLmZyb207CiAgICAgIGNvbnN0IHRvID0gdGhpcy50bzsKICAgICAgY29uc3QgZGlyZWN0aW9uID0gdGhpcy5kaXJlY3Rpb247CiAgICAgIHRyZWVUcmFuc2Zvcm0ucG9zaXRpb24uY29weShwb3NpdGlvbik7CiAgICAgIHRyZWVUcmFuc2Zvcm0ucXVhdGVybmlvbi5jb3B5KHF1YXQpOyAvLyBUcmFuc2Zvcm0gcmF5IHRvIGxvY2FsIHNwYWNlIQoKICAgICAgVHJhbnNmb3JtLnZlY3RvclRvTG9jYWxGcmFtZShwb3NpdGlvbiwgcXVhdCwgZGlyZWN0aW9uLCBsb2NhbERpcmVjdGlvbik7CiAgICAgIFRyYW5zZm9ybS5wb2ludFRvTG9jYWxGcmFtZShwb3NpdGlvbiwgcXVhdCwgZnJvbSwgbG9jYWxGcm9tKTsKICAgICAgVHJhbnNmb3JtLnBvaW50VG9Mb2NhbEZyYW1lKHBvc2l0aW9uLCBxdWF0LCB0bywgbG9jYWxUbyk7CiAgICAgIGxvY2FsVG8ueCAqPSBtZXNoLnNjYWxlLng7CiAgICAgIGxvY2FsVG8ueSAqPSBtZXNoLnNjYWxlLnk7CiAgICAgIGxvY2FsVG8ueiAqPSBtZXNoLnNjYWxlLno7CiAgICAgIGxvY2FsRnJvbS54ICo9IG1lc2guc2NhbGUueDsKICAgICAgbG9jYWxGcm9tLnkgKj0gbWVzaC5zY2FsZS55OwogICAgICBsb2NhbEZyb20ueiAqPSBtZXNoLnNjYWxlLno7CiAgICAgIGxvY2FsVG8udnN1Yihsb2NhbEZyb20sIGxvY2FsRGlyZWN0aW9uKTsKICAgICAgbG9jYWxEaXJlY3Rpb24ubm9ybWFsaXplKCk7CiAgICAgIGNvbnN0IGZyb21Ub0Rpc3RhbmNlU3F1YXJlZCA9IGxvY2FsRnJvbS5kaXN0YW5jZVNxdWFyZWQobG9jYWxUbyk7CiAgICAgIG1lc2gudHJlZS5yYXlRdWVyeSh0aGlzLCB0cmVlVHJhbnNmb3JtLCB0cmlhbmdsZXMpOwoKICAgICAgZm9yIChsZXQgaSA9IDAsIE4gPSB0cmlhbmdsZXMubGVuZ3RoOyAhdGhpcy5yZXN1bHQuc2hvdWxkU3RvcCAmJiBpICE9PSBOOyBpKyspIHsKICAgICAgICBjb25zdCB0cmlhbmdsZXNJbmRleCA9IHRyaWFuZ2xlc1tpXTsKICAgICAgICBtZXNoLmdldE5vcm1hbCh0cmlhbmdsZXNJbmRleCwgbm9ybWFsKTsgLy8gZGV0ZXJtaW5lIGlmIHJheSBpbnRlcnNlY3RzIHRoZSBwbGFuZSBvZiB0aGUgZmFjZQogICAgICAgIC8vIG5vdGU6IHRoaXMgd29ya3MgcmVnYXJkbGVzcyBvZiB0aGUgZGlyZWN0aW9uIG9mIHRoZSBmYWNlIG5vcm1hbAogICAgICAgIC8vIEdldCBwbGFuZSBwb2ludCBpbiB3b3JsZCBjb29yZGluYXRlcy4uLgoKICAgICAgICBtZXNoLmdldFZlcnRleChpbmRpY2VzW3RyaWFuZ2xlc0luZGV4ICogM10sIGEpOyAvLyAuLi5idXQgbWFrZSBpdCByZWxhdGl2ZSB0byB0aGUgcmF5IGZyb20uIFdlJ2xsIGZpeCB0aGlzIGxhdGVyLgoKICAgICAgICBhLnZzdWIobG9jYWxGcm9tLCB2ZWN0b3IpOyAvLyBJZiB0aGlzIGRvdCBwcm9kdWN0IGlzIG5lZ2F0aXZlLCB3ZSBoYXZlIHNvbWV0aGluZyBpbnRlcmVzdGluZwoKICAgICAgICBjb25zdCBkb3QgPSBsb2NhbERpcmVjdGlvbi5kb3Qobm9ybWFsKTsgLy8gQmFpbCBvdXQgaWYgcmF5IGFuZCBwbGFuZSBhcmUgcGFyYWxsZWwKICAgICAgICAvLyBpZiAoTWF0aC5hYnMoIGRvdCApIDwgdGhpcy5wcmVjaXNpb24pewogICAgICAgIC8vICAgICBjb250aW51ZTsKICAgICAgICAvLyB9CiAgICAgICAgLy8gY2FsYyBkaXN0YW5jZSB0byBwbGFuZQoKICAgICAgICBjb25zdCBzY2FsYXIgPSBub3JtYWwuZG90KHZlY3RvcikgLyBkb3Q7IC8vIGlmIG5lZ2F0aXZlIGRpc3RhbmNlLCB0aGVuIHBsYW5lIGlzIGJlaGluZCByYXkKCiAgICAgICAgaWYgKHNjYWxhciA8IDApIHsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0gLy8gSW50ZXJzZWN0aW9uIHBvaW50IGlzIGZyb20gKyBkaXJlY3Rpb24gKiBzY2FsYXIKCgogICAgICAgIGxvY2FsRGlyZWN0aW9uLnNjYWxlKHNjYWxhciwgaW50ZXJzZWN0UG9pbnQpOwogICAgICAgIGludGVyc2VjdFBvaW50LnZhZGQobG9jYWxGcm9tLCBpbnRlcnNlY3RQb2ludCk7IC8vIEdldCB0cmlhbmdsZSB2ZXJ0aWNlcwoKICAgICAgICBtZXNoLmdldFZlcnRleChpbmRpY2VzW3RyaWFuZ2xlc0luZGV4ICogMyArIDFdLCBiKTsKICAgICAgICBtZXNoLmdldFZlcnRleChpbmRpY2VzW3RyaWFuZ2xlc0luZGV4ICogMyArIDJdLCBjKTsKICAgICAgICBjb25zdCBzcXVhcmVkRGlzdGFuY2UgPSBpbnRlcnNlY3RQb2ludC5kaXN0YW5jZVNxdWFyZWQobG9jYWxGcm9tKTsKCiAgICAgICAgaWYgKCEoUmF5LnBvaW50SW5UcmlhbmdsZShpbnRlcnNlY3RQb2ludCwgYiwgYSwgYykgfHwgUmF5LnBvaW50SW5UcmlhbmdsZShpbnRlcnNlY3RQb2ludCwgYSwgYiwgYykpIHx8IHNxdWFyZWREaXN0YW5jZSA+IGZyb21Ub0Rpc3RhbmNlU3F1YXJlZCkgewogICAgICAgICAgY29udGludWU7CiAgICAgICAgfSAvLyB0cmFuc2Zvcm0gaW50ZXJzZWN0cG9pbnQgYW5kIG5vcm1hbCB0byB3b3JsZAoKCiAgICAgICAgVHJhbnNmb3JtLnZlY3RvclRvV29ybGRGcmFtZShxdWF0LCBub3JtYWwsIHdvcmxkTm9ybWFsKTsKICAgICAgICBUcmFuc2Zvcm0ucG9pbnRUb1dvcmxkRnJhbWUocG9zaXRpb24sIHF1YXQsIGludGVyc2VjdFBvaW50LCB3b3JsZEludGVyc2VjdFBvaW50KTsKICAgICAgICB0aGlzLnJlcG9ydEludGVyc2VjdGlvbih3b3JsZE5vcm1hbCwgd29ybGRJbnRlcnNlY3RQb2ludCwgcmVwb3J0ZWRTaGFwZSwgYm9keSwgdHJpYW5nbGVzSW5kZXgpOwogICAgICB9CgogICAgICB0cmlhbmdsZXMubGVuZ3RoID0gMDsKICAgIH0KICAgIC8qKgogICAgICogQHJldHVybiBUcnVlIGlmIHRoZSBpbnRlcnNlY3Rpb25zIHNob3VsZCBjb250aW51ZQogICAgICovCgoKICAgIHJlcG9ydEludGVyc2VjdGlvbihub3JtYWwsIGhpdFBvaW50V29ybGQsIHNoYXBlLCBib2R5LCBoaXRGYWNlSW5kZXgpIHsKICAgICAgY29uc3QgZnJvbSA9IHRoaXMuZnJvbTsKICAgICAgY29uc3QgdG8gPSB0aGlzLnRvOwogICAgICBjb25zdCBkaXN0YW5jZSA9IGZyb20uZGlzdGFuY2VUbyhoaXRQb2ludFdvcmxkKTsKICAgICAgY29uc3QgcmVzdWx0ID0gdGhpcy5yZXN1bHQ7IC8vIFNraXAgYmFjayBmYWNlcz8KCiAgICAgIGlmICh0aGlzLnNraXBCYWNrZmFjZXMgJiYgbm9ybWFsLmRvdCh0aGlzLmRpcmVjdGlvbikgPiAwKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICByZXN1bHQuaGl0RmFjZUluZGV4ID0gdHlwZW9mIGhpdEZhY2VJbmRleCAhPT0gJ3VuZGVmaW5lZCcgPyBoaXRGYWNlSW5kZXggOiAtMTsKCiAgICAgIHN3aXRjaCAodGhpcy5tb2RlKSB7CiAgICAgICAgY2FzZSBSYXkuQUxMOgogICAgICAgICAgdGhpcy5oYXNIaXQgPSB0cnVlOwogICAgICAgICAgcmVzdWx0LnNldChmcm9tLCB0bywgbm9ybWFsLCBoaXRQb2ludFdvcmxkLCBzaGFwZSwgYm9keSwgZGlzdGFuY2UpOwogICAgICAgICAgcmVzdWx0Lmhhc0hpdCA9IHRydWU7CiAgICAgICAgICB0aGlzLmNhbGxiYWNrKHJlc3VsdCk7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSBSYXkuQ0xPU0VTVDoKICAgICAgICAgIC8vIFN0b3JlIGlmIGNsb3NlciB0aGFuIGN1cnJlbnQgY2xvc2VzdAogICAgICAgICAgaWYgKGRpc3RhbmNlIDwgcmVzdWx0LmRpc3RhbmNlIHx8ICFyZXN1bHQuaGFzSGl0KSB7CiAgICAgICAgICAgIHRoaXMuaGFzSGl0ID0gdHJ1ZTsKICAgICAgICAgICAgcmVzdWx0Lmhhc0hpdCA9IHRydWU7CiAgICAgICAgICAgIHJlc3VsdC5zZXQoZnJvbSwgdG8sIG5vcm1hbCwgaGl0UG9pbnRXb3JsZCwgc2hhcGUsIGJvZHksIGRpc3RhbmNlKTsKICAgICAgICAgIH0KCiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSBSYXkuQU5ZOgogICAgICAgICAgLy8gUmVwb3J0IGFuZCBzdG9wLgogICAgICAgICAgdGhpcy5oYXNIaXQgPSB0cnVlOwogICAgICAgICAgcmVzdWx0Lmhhc0hpdCA9IHRydWU7CiAgICAgICAgICByZXN1bHQuc2V0KGZyb20sIHRvLCBub3JtYWwsIGhpdFBvaW50V29ybGQsIHNoYXBlLCBib2R5LCBkaXN0YW5jZSk7CiAgICAgICAgICByZXN1bHQuc2hvdWxkU3RvcCA9IHRydWU7CiAgICAgICAgICBicmVhazsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBBcyBwZXIgIkJhcnljZW50cmljIFRlY2huaXF1ZSIgYXMgbmFtZWQKICAgICAqIHtAbGluayBodHRwczovL3d3dy5ibGFja3Bhd24uY29tL3RleHRzL3BvaW50aW5wb2x5L2RlZmF1bHQuaHRtbCBoZXJlfSBidXQgd2l0aG91dCB0aGUgZGl2aXNpb24KICAgICAqLwoKCiAgICBzdGF0aWMgcG9pbnRJblRyaWFuZ2xlKHAsIGEsIGIsIGMpIHsKICAgICAgYy52c3ViKGEsIHYwKTsKICAgICAgYi52c3ViKGEsIHYxKTsKICAgICAgcC52c3ViKGEsIHYyKTsKICAgICAgY29uc3QgZG90MDAgPSB2MC5kb3QodjApOwogICAgICBjb25zdCBkb3QwMSA9IHYwLmRvdCh2MSk7CiAgICAgIGNvbnN0IGRvdDAyID0gdjAuZG90KHYyKTsKICAgICAgY29uc3QgZG90MTEgPSB2MS5kb3QodjEpOwogICAgICBjb25zdCBkb3QxMiA9IHYxLmRvdCh2Mik7CiAgICAgIGxldCB1OwogICAgICBsZXQgdjsKICAgICAgcmV0dXJuICh1ID0gZG90MTEgKiBkb3QwMiAtIGRvdDAxICogZG90MTIpID49IDAgJiYgKHYgPSBkb3QwMCAqIGRvdDEyIC0gZG90MDEgKiBkb3QwMikgPj0gMCAmJiB1ICsgdiA8IGRvdDAwICogZG90MTEgLSBkb3QwMSAqIGRvdDAxOwogICAgfQoKICB9CiAgUmF5LkNMT1NFU1QgPSBSQVlfTU9ERVMuQ0xPU0VTVDsKICBSYXkuQU5ZID0gUkFZX01PREVTLkFOWTsKICBSYXkuQUxMID0gUkFZX01PREVTLkFMTDsKICBjb25zdCB0bXBBQUJCJDEgPSBuZXcgQUFCQigpOwogIGNvbnN0IHRtcEFycmF5ID0gW107CiAgY29uc3QgdjEgPSBuZXcgVmVjMygpOwogIGNvbnN0IHYyID0gbmV3IFZlYzMoKTsKICBjb25zdCBpbnRlcnNlY3RCb2R5X3hpID0gbmV3IFZlYzMoKTsKICBjb25zdCBpbnRlcnNlY3RCb2R5X3FpID0gbmV3IFF1YXRlcm5pb24oKTsKICBjb25zdCBpbnRlcnNlY3RQb2ludCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgYSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgYiA9IG5ldyBWZWMzKCk7CiAgY29uc3QgYyA9IG5ldyBWZWMzKCk7CiAgbmV3IFZlYzMoKTsKICBuZXcgUmF5Y2FzdFJlc3VsdCgpOwogIGNvbnN0IGludGVyc2VjdENvbnZleE9wdGlvbnMgPSB7CiAgICBmYWNlTGlzdDogWzBdCiAgfTsKICBjb25zdCB3b3JsZFBpbGxhck9mZnNldCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgaW50ZXJzZWN0SGVpZ2h0ZmllbGRfbG9jYWxSYXkgPSBuZXcgUmF5KCk7CiAgY29uc3QgaW50ZXJzZWN0SGVpZ2h0ZmllbGRfaW5kZXggPSBbXTsKICBjb25zdCBSYXlfaW50ZXJzZWN0U3BoZXJlX2ludGVyc2VjdGlvblBvaW50ID0gbmV3IFZlYzMoKTsKICBjb25zdCBSYXlfaW50ZXJzZWN0U3BoZXJlX25vcm1hbCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgaW50ZXJzZWN0Q29udmV4X25vcm1hbCA9IG5ldyBWZWMzKCk7CiAgbmV3IFZlYzMoKTsKICBuZXcgVmVjMygpOwogIGNvbnN0IGludGVyc2VjdENvbnZleF92ZWN0b3IgPSBuZXcgVmVjMygpOwogIGNvbnN0IGludGVyc2VjdFRyaW1lc2hfbm9ybWFsID0gbmV3IFZlYzMoKTsKICBjb25zdCBpbnRlcnNlY3RUcmltZXNoX2xvY2FsRGlyZWN0aW9uID0gbmV3IFZlYzMoKTsKICBjb25zdCBpbnRlcnNlY3RUcmltZXNoX2xvY2FsRnJvbSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgaW50ZXJzZWN0VHJpbWVzaF9sb2NhbFRvID0gbmV3IFZlYzMoKTsKICBjb25zdCBpbnRlcnNlY3RUcmltZXNoX3dvcmxkTm9ybWFsID0gbmV3IFZlYzMoKTsKICBjb25zdCBpbnRlcnNlY3RUcmltZXNoX3dvcmxkSW50ZXJzZWN0UG9pbnQgPSBuZXcgVmVjMygpOwogIG5ldyBBQUJCKCk7CiAgY29uc3QgaW50ZXJzZWN0VHJpbWVzaF90cmlhbmdsZXMgPSBbXTsKICBjb25zdCBpbnRlcnNlY3RUcmltZXNoX3RyZWVUcmFuc2Zvcm0gPSBuZXcgVHJhbnNmb3JtKCk7CiAgY29uc3QgdjAgPSBuZXcgVmVjMygpOwogIGNvbnN0IGludGVyc2VjdCA9IG5ldyBWZWMzKCk7CgogIGZ1bmN0aW9uIGRpc3RhbmNlRnJvbUludGVyc2VjdGlvbihmcm9tLCBkaXJlY3Rpb24sIHBvc2l0aW9uKSB7CiAgICAvLyB2MCBpcyB2ZWN0b3IgZnJvbSBmcm9tIHRvIHBvc2l0aW9uCiAgICBwb3NpdGlvbi52c3ViKGZyb20sIHYwKTsKICAgIGNvbnN0IGRvdCA9IHYwLmRvdChkaXJlY3Rpb24pOyAvLyBpbnRlcnNlY3QgPSBkaXJlY3Rpb24qZG90ICsgZnJvbQoKICAgIGRpcmVjdGlvbi5zY2FsZShkb3QsIGludGVyc2VjdCk7CiAgICBpbnRlcnNlY3QudmFkZChmcm9tLCBpbnRlcnNlY3QpOwogICAgY29uc3QgZGlzdGFuY2UgPSBwb3NpdGlvbi5kaXN0YW5jZVRvKGludGVyc2VjdCk7CiAgICByZXR1cm4gZGlzdGFuY2U7CiAgfQoKICAvKioKICAgKiBTd2VlcCBhbmQgcHJ1bmUgYnJvYWRwaGFzZSBhbG9uZyBvbmUgYXhpcy4KICAgKi8KICBjbGFzcyBTQVBCcm9hZHBoYXNlIGV4dGVuZHMgQnJvYWRwaGFzZSB7CiAgICAvKioKICAgICAqIExpc3Qgb2YgYm9kaWVzIGN1cnJlbnRseSBpbiB0aGUgYnJvYWRwaGFzZS4KICAgICAqLwoKICAgIC8qKgogICAgICogVGhlIHdvcmxkIHRvIHNlYXJjaCBpbi4KICAgICAqLwoKICAgIC8qKgogICAgICogQXhpcyB0byBzb3J0IHRoZSBib2RpZXMgYWxvbmcuCiAgICAgKiBTZXQgdG8gMCBmb3IgeCBheGlzLCBhbmQgMSBmb3IgeSBheGlzLgogICAgICogRm9yIGJlc3QgcGVyZm9ybWFuY2UsIHBpY2sgdGhlIGF4aXMgd2hlcmUgYm9kaWVzIGFyZSBtb3N0IGRpc3RyaWJ1dGVkLgogICAgICovCgogICAgLyoqCiAgICAgKiBDaGVjayBpZiB0aGUgYm91bmRzIG9mIHR3byBib2RpZXMgb3ZlcmxhcCwgYWxvbmcgdGhlIGdpdmVuIFNBUCBheGlzLgogICAgICovCiAgICBzdGF0aWMgY2hlY2tCb3VuZHMoYmksIGJqLCBheGlzSW5kZXgpIHsKICAgICAgbGV0IGJpUG9zOwogICAgICBsZXQgYmpQb3M7CgogICAgICBpZiAoYXhpc0luZGV4ID09PSAwKSB7CiAgICAgICAgYmlQb3MgPSBiaS5wb3NpdGlvbi54OwogICAgICAgIGJqUG9zID0gYmoucG9zaXRpb24ueDsKICAgICAgfSBlbHNlIGlmIChheGlzSW5kZXggPT09IDEpIHsKICAgICAgICBiaVBvcyA9IGJpLnBvc2l0aW9uLnk7CiAgICAgICAgYmpQb3MgPSBiai5wb3NpdGlvbi55OwogICAgICB9IGVsc2UgaWYgKGF4aXNJbmRleCA9PT0gMikgewogICAgICAgIGJpUG9zID0gYmkucG9zaXRpb24uejsKICAgICAgICBialBvcyA9IGJqLnBvc2l0aW9uLno7CiAgICAgIH0KCiAgICAgIGNvbnN0IHJpID0gYmkuYm91bmRpbmdSYWRpdXMsCiAgICAgICAgICAgIHJqID0gYmouYm91bmRpbmdSYWRpdXMsCiAgICAgICAgICAgIGJvdW5kQTIgPSBiaVBvcyArIHJpLAogICAgICAgICAgICBib3VuZEIxID0gYmpQb3MgLSByajsKICAgICAgcmV0dXJuIGJvdW5kQjEgPCBib3VuZEEyOwogICAgfSAvLyBOb3RlOiB0aGVzZSBhcmUgaWRlbnRpY2FsLCBzYXZlIGZvciB4L3kveiBsb3dlcmJvdW5kCgogICAgLyoqCiAgICAgKiBpbnNlcnRpb25Tb3J0WAogICAgICovCgoKICAgIHN0YXRpYyBpbnNlcnRpb25Tb3J0WChhKSB7CiAgICAgIGZvciAobGV0IGkgPSAxLCBsID0gYS5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgICAgICBjb25zdCB2ID0gYVtpXTsKICAgICAgICBsZXQgajsKCiAgICAgICAgZm9yIChqID0gaSAtIDE7IGogPj0gMDsgai0tKSB7CiAgICAgICAgICBpZiAoYVtqXS5hYWJiLmxvd2VyQm91bmQueCA8PSB2LmFhYmIubG93ZXJCb3VuZC54KSB7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQoKICAgICAgICAgIGFbaiArIDFdID0gYVtqXTsKICAgICAgICB9CgogICAgICAgIGFbaiArIDFdID0gdjsKICAgICAgfQoKICAgICAgcmV0dXJuIGE7CiAgICB9CiAgICAvKioKICAgICAqIGluc2VydGlvblNvcnRZCiAgICAgKi8KCgogICAgc3RhdGljIGluc2VydGlvblNvcnRZKGEpIHsKICAgICAgZm9yIChsZXQgaSA9IDEsIGwgPSBhLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICAgIGNvbnN0IHYgPSBhW2ldOwogICAgICAgIGxldCBqOwoKICAgICAgICBmb3IgKGogPSBpIC0gMTsgaiA+PSAwOyBqLS0pIHsKICAgICAgICAgIGlmIChhW2pdLmFhYmIubG93ZXJCb3VuZC55IDw9IHYuYWFiYi5sb3dlckJvdW5kLnkpIHsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CgogICAgICAgICAgYVtqICsgMV0gPSBhW2pdOwogICAgICAgIH0KCiAgICAgICAgYVtqICsgMV0gPSB2OwogICAgICB9CgogICAgICByZXR1cm4gYTsKICAgIH0KICAgIC8qKgogICAgICogaW5zZXJ0aW9uU29ydFoKICAgICAqLwoKCiAgICBzdGF0aWMgaW5zZXJ0aW9uU29ydFooYSkgewogICAgICBmb3IgKGxldCBpID0gMSwgbCA9IGEubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgICAgY29uc3QgdiA9IGFbaV07CiAgICAgICAgbGV0IGo7CgogICAgICAgIGZvciAoaiA9IGkgLSAxOyBqID49IDA7IGotLSkgewogICAgICAgICAgaWYgKGFbal0uYWFiYi5sb3dlckJvdW5kLnogPD0gdi5hYWJiLmxvd2VyQm91bmQueikgewogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KCiAgICAgICAgICBhW2ogKyAxXSA9IGFbal07CiAgICAgICAgfQoKICAgICAgICBhW2ogKyAxXSA9IHY7CiAgICAgIH0KCiAgICAgIHJldHVybiBhOwogICAgfQoKICAgIGNvbnN0cnVjdG9yKHdvcmxkKSB7CiAgICAgIHN1cGVyKCk7CiAgICAgIHRoaXMuYXhpc0xpc3QgPSBbXTsKICAgICAgdGhpcy53b3JsZCA9IG51bGw7CiAgICAgIHRoaXMuYXhpc0luZGV4ID0gMDsKICAgICAgY29uc3QgYXhpc0xpc3QgPSB0aGlzLmF4aXNMaXN0OwoKICAgICAgdGhpcy5fYWRkQm9keUhhbmRsZXIgPSBldmVudCA9PiB7CiAgICAgICAgYXhpc0xpc3QucHVzaChldmVudC5ib2R5KTsKICAgICAgfTsKCiAgICAgIHRoaXMuX3JlbW92ZUJvZHlIYW5kbGVyID0gZXZlbnQgPT4gewogICAgICAgIGNvbnN0IGlkeCA9IGF4aXNMaXN0LmluZGV4T2YoZXZlbnQuYm9keSk7CgogICAgICAgIGlmIChpZHggIT09IC0xKSB7CiAgICAgICAgICBheGlzTGlzdC5zcGxpY2UoaWR4LCAxKTsKICAgICAgICB9CiAgICAgIH07CgogICAgICBpZiAod29ybGQpIHsKICAgICAgICB0aGlzLnNldFdvcmxkKHdvcmxkKTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBDaGFuZ2UgdGhlIHdvcmxkCiAgICAgKi8KCgogICAgc2V0V29ybGQod29ybGQpIHsKICAgICAgLy8gQ2xlYXIgdGhlIG9sZCBheGlzIGFycmF5CiAgICAgIHRoaXMuYXhpc0xpc3QubGVuZ3RoID0gMDsgLy8gQWRkIGFsbCBib2RpZXMgZnJvbSB0aGUgbmV3IHdvcmxkCgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHdvcmxkLmJvZGllcy5sZW5ndGg7IGkrKykgewogICAgICAgIHRoaXMuYXhpc0xpc3QucHVzaCh3b3JsZC5ib2RpZXNbaV0pOwogICAgICB9IC8vIFJlbW92ZSBvbGQgaGFuZGxlcnMsIGlmIGFueQoKCiAgICAgIHdvcmxkLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2FkZEJvZHknLCB0aGlzLl9hZGRCb2R5SGFuZGxlcik7CiAgICAgIHdvcmxkLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3JlbW92ZUJvZHknLCB0aGlzLl9yZW1vdmVCb2R5SGFuZGxlcik7IC8vIEFkZCBoYW5kbGVycyB0byB1cGRhdGUgdGhlIGxpc3Qgb2YgYm9kaWVzLgoKICAgICAgd29ybGQuYWRkRXZlbnRMaXN0ZW5lcignYWRkQm9keScsIHRoaXMuX2FkZEJvZHlIYW5kbGVyKTsKICAgICAgd29ybGQuYWRkRXZlbnRMaXN0ZW5lcigncmVtb3ZlQm9keScsIHRoaXMuX3JlbW92ZUJvZHlIYW5kbGVyKTsKICAgICAgdGhpcy53b3JsZCA9IHdvcmxkOwogICAgICB0aGlzLmRpcnR5ID0gdHJ1ZTsKICAgIH0KICAgIC8qKgogICAgICogQ29sbGVjdCBhbGwgY29sbGlzaW9uIHBhaXJzCiAgICAgKi8KCgogICAgY29sbGlzaW9uUGFpcnMod29ybGQsIHAxLCBwMikgewogICAgICBjb25zdCBib2RpZXMgPSB0aGlzLmF4aXNMaXN0OwogICAgICBjb25zdCBOID0gYm9kaWVzLmxlbmd0aDsKICAgICAgY29uc3QgYXhpc0luZGV4ID0gdGhpcy5heGlzSW5kZXg7CiAgICAgIGxldCBpOwogICAgICBsZXQgajsKCiAgICAgIGlmICh0aGlzLmRpcnR5KSB7CiAgICAgICAgdGhpcy5zb3J0TGlzdCgpOwogICAgICAgIHRoaXMuZGlydHkgPSBmYWxzZTsKICAgICAgfSAvLyBMb29rIHRocm91Z2ggdGhlIGxpc3QKCgogICAgICBmb3IgKGkgPSAwOyBpICE9PSBOOyBpKyspIHsKICAgICAgICBjb25zdCBiaSA9IGJvZGllc1tpXTsKCiAgICAgICAgZm9yIChqID0gaSArIDE7IGogPCBOOyBqKyspIHsKICAgICAgICAgIGNvbnN0IGJqID0gYm9kaWVzW2pdOwoKICAgICAgICAgIGlmICghdGhpcy5uZWVkQnJvYWRwaGFzZUNvbGxpc2lvbihiaSwgYmopKSB7CiAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgfQoKICAgICAgICAgIGlmICghU0FQQnJvYWRwaGFzZS5jaGVja0JvdW5kcyhiaSwgYmosIGF4aXNJbmRleCkpIHsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CgogICAgICAgICAgdGhpcy5pbnRlcnNlY3Rpb25UZXN0KGJpLCBiaiwgcDEsIHAyKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBzb3J0TGlzdCgpIHsKICAgICAgY29uc3QgYXhpc0xpc3QgPSB0aGlzLmF4aXNMaXN0OwogICAgICBjb25zdCBheGlzSW5kZXggPSB0aGlzLmF4aXNJbmRleDsKICAgICAgY29uc3QgTiA9IGF4aXNMaXN0Lmxlbmd0aDsgLy8gVXBkYXRlIEFBQkJzCgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gTjsgaSsrKSB7CiAgICAgICAgY29uc3QgYmkgPSBheGlzTGlzdFtpXTsKCiAgICAgICAgaWYgKGJpLmFhYmJOZWVkc1VwZGF0ZSkgewogICAgICAgICAgYmkudXBkYXRlQUFCQigpOwogICAgICAgIH0KICAgICAgfSAvLyBTb3J0IHRoZSBsaXN0CgoKICAgICAgaWYgKGF4aXNJbmRleCA9PT0gMCkgewogICAgICAgIFNBUEJyb2FkcGhhc2UuaW5zZXJ0aW9uU29ydFgoYXhpc0xpc3QpOwogICAgICB9IGVsc2UgaWYgKGF4aXNJbmRleCA9PT0gMSkgewogICAgICAgIFNBUEJyb2FkcGhhc2UuaW5zZXJ0aW9uU29ydFkoYXhpc0xpc3QpOwogICAgICB9IGVsc2UgaWYgKGF4aXNJbmRleCA9PT0gMikgewogICAgICAgIFNBUEJyb2FkcGhhc2UuaW5zZXJ0aW9uU29ydFooYXhpc0xpc3QpOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIENvbXB1dGVzIHRoZSB2YXJpYW5jZSBvZiB0aGUgYm9keSBwb3NpdGlvbnMgYW5kIGVzdGltYXRlcyB0aGUgYmVzdCBheGlzIHRvIHVzZS4KICAgICAqIFdpbGwgYXV0b21hdGljYWxseSBzZXQgcHJvcGVydHkgYGF4aXNJbmRleGAuCiAgICAgKi8KCgogICAgYXV0b0RldGVjdEF4aXMoKSB7CiAgICAgIGxldCBzdW1YID0gMDsKICAgICAgbGV0IHN1bVgyID0gMDsKICAgICAgbGV0IHN1bVkgPSAwOwogICAgICBsZXQgc3VtWTIgPSAwOwogICAgICBsZXQgc3VtWiA9IDA7CiAgICAgIGxldCBzdW1aMiA9IDA7CiAgICAgIGNvbnN0IGJvZGllcyA9IHRoaXMuYXhpc0xpc3Q7CiAgICAgIGNvbnN0IE4gPSBib2RpZXMubGVuZ3RoOwogICAgICBjb25zdCBpbnZOID0gMSAvIE47CgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gTjsgaSsrKSB7CiAgICAgICAgY29uc3QgYiA9IGJvZGllc1tpXTsKICAgICAgICBjb25zdCBjZW50ZXJYID0gYi5wb3NpdGlvbi54OwogICAgICAgIHN1bVggKz0gY2VudGVyWDsKICAgICAgICBzdW1YMiArPSBjZW50ZXJYICogY2VudGVyWDsKICAgICAgICBjb25zdCBjZW50ZXJZID0gYi5wb3NpdGlvbi55OwogICAgICAgIHN1bVkgKz0gY2VudGVyWTsKICAgICAgICBzdW1ZMiArPSBjZW50ZXJZICogY2VudGVyWTsKICAgICAgICBjb25zdCBjZW50ZXJaID0gYi5wb3NpdGlvbi56OwogICAgICAgIHN1bVogKz0gY2VudGVyWjsKICAgICAgICBzdW1aMiArPSBjZW50ZXJaICogY2VudGVyWjsKICAgICAgfQoKICAgICAgY29uc3QgdmFyaWFuY2VYID0gc3VtWDIgLSBzdW1YICogc3VtWCAqIGludk47CiAgICAgIGNvbnN0IHZhcmlhbmNlWSA9IHN1bVkyIC0gc3VtWSAqIHN1bVkgKiBpbnZOOwogICAgICBjb25zdCB2YXJpYW5jZVogPSBzdW1aMiAtIHN1bVogKiBzdW1aICogaW52TjsKCiAgICAgIGlmICh2YXJpYW5jZVggPiB2YXJpYW5jZVkpIHsKICAgICAgICBpZiAodmFyaWFuY2VYID4gdmFyaWFuY2VaKSB7CiAgICAgICAgICB0aGlzLmF4aXNJbmRleCA9IDA7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuYXhpc0luZGV4ID0gMjsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAodmFyaWFuY2VZID4gdmFyaWFuY2VaKSB7CiAgICAgICAgdGhpcy5heGlzSW5kZXggPSAxOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuYXhpc0luZGV4ID0gMjsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBSZXR1cm5zIGFsbCB0aGUgYm9kaWVzIHdpdGhpbiBhbiBBQUJCLgogICAgICogQHBhcmFtIHJlc3VsdCBBbiBhcnJheSB0byBzdG9yZSByZXN1bHRpbmcgYm9kaWVzIGluLgogICAgICovCgoKICAgIGFhYmJRdWVyeSh3b3JsZCwgYWFiYiwgcmVzdWx0KSB7CiAgICAgIGlmIChyZXN1bHQgPT09IHZvaWQgMCkgewogICAgICAgIHJlc3VsdCA9IFtdOwogICAgICB9CgogICAgICBpZiAodGhpcy5kaXJ0eSkgewogICAgICAgIHRoaXMuc29ydExpc3QoKTsKICAgICAgICB0aGlzLmRpcnR5ID0gZmFsc2U7CiAgICAgIH0KCiAgICAgIGNvbnN0IGF4aXNJbmRleCA9IHRoaXMuYXhpc0luZGV4OwogICAgICBsZXQgYXhpcyA9ICd4JzsKCiAgICAgIGlmIChheGlzSW5kZXggPT09IDEpIHsKICAgICAgICBheGlzID0gJ3knOwogICAgICB9CgogICAgICBpZiAoYXhpc0luZGV4ID09PSAyKSB7CiAgICAgICAgYXhpcyA9ICd6JzsKICAgICAgfQoKICAgICAgY29uc3QgYXhpc0xpc3QgPSB0aGlzLmF4aXNMaXN0OwogICAgICBhYWJiLmxvd2VyQm91bmRbYXhpc107CiAgICAgIGFhYmIudXBwZXJCb3VuZFtheGlzXTsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYXhpc0xpc3QubGVuZ3RoOyBpKyspIHsKICAgICAgICBjb25zdCBiID0gYXhpc0xpc3RbaV07CgogICAgICAgIGlmIChiLmFhYmJOZWVkc1VwZGF0ZSkgewogICAgICAgICAgYi51cGRhdGVBQUJCKCk7CiAgICAgICAgfQoKICAgICAgICBpZiAoYi5hYWJiLm92ZXJsYXBzKGFhYmIpKSB7CiAgICAgICAgICByZXN1bHQucHVzaChiKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CgogIH0KCiAgY2xhc3MgVXRpbHMgewogICAgLyoqCiAgICAgKiBFeHRlbmQgYW4gb3B0aW9ucyBvYmplY3Qgd2l0aCBkZWZhdWx0IHZhbHVlcy4KICAgICAqIEBwYXJhbSBvcHRpb25zIFRoZSBvcHRpb25zIG9iamVjdC4gTWF5IGJlIGZhbHN5OiBpbiB0aGlzIGNhc2UsIGEgbmV3IG9iamVjdCBpcyBjcmVhdGVkIGFuZCByZXR1cm5lZC4KICAgICAqIEBwYXJhbSBkZWZhdWx0cyBBbiBvYmplY3QgY29udGFpbmluZyBkZWZhdWx0IHZhbHVlcy4KICAgICAqIEByZXR1cm4gVGhlIG1vZGlmaWVkIG9wdGlvbnMgb2JqZWN0LgogICAgICovCiAgICBzdGF0aWMgZGVmYXVsdHMob3B0aW9ucywgZGVmYXVsdHMpIHsKICAgICAgaWYgKG9wdGlvbnMgPT09IHZvaWQgMCkgewogICAgICAgIG9wdGlvbnMgPSB7fTsKICAgICAgfQoKICAgICAgZm9yIChsZXQga2V5IGluIGRlZmF1bHRzKSB7CiAgICAgICAgaWYgKCEoa2V5IGluIG9wdGlvbnMpKSB7CiAgICAgICAgICBvcHRpb25zW2tleV0gPSBkZWZhdWx0c1trZXldOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIG9wdGlvbnM7CiAgICB9CgogIH0KCiAgLyoqCiAgICogQ29uc3RyYWludCBiYXNlIGNsYXNzCiAgICovCiAgY2xhc3MgQ29uc3RyYWludCB7CiAgICAvKioKICAgICAqIEVxdWF0aW9ucyB0byBiZSBzb2x2ZWQgaW4gdGhpcyBjb25zdHJhaW50LgogICAgICovCgogICAgLyoqCiAgICAgKiBCb2R5IEEuCiAgICAgKi8KCiAgICAvKioKICAgICAqIEJvZHkgQi4KICAgICAqLwoKICAgIC8qKgogICAgICogU2V0IHRvIGZhbHNlIGlmIHlvdSBkb24ndCB3YW50IHRoZSBib2RpZXMgdG8gY29sbGlkZSB3aGVuIHRoZXkgYXJlIGNvbm5lY3RlZC4KICAgICAqLwogICAgY29uc3RydWN0b3IoYm9keUEsIGJvZHlCLCBvcHRpb25zKSB7CiAgICAgIGlmIChvcHRpb25zID09PSB2b2lkIDApIHsKICAgICAgICBvcHRpb25zID0ge307CiAgICAgIH0KCiAgICAgIG9wdGlvbnMgPSBVdGlscy5kZWZhdWx0cyhvcHRpb25zLCB7CiAgICAgICAgY29sbGlkZUNvbm5lY3RlZDogdHJ1ZSwKICAgICAgICB3YWtlVXBCb2RpZXM6IHRydWUKICAgICAgfSk7CiAgICAgIHRoaXMuZXF1YXRpb25zID0gW107CiAgICAgIHRoaXMuYm9keUEgPSBib2R5QTsKICAgICAgdGhpcy5ib2R5QiA9IGJvZHlCOwogICAgICB0aGlzLmlkID0gQ29uc3RyYWludC5pZENvdW50ZXIrKzsKICAgICAgdGhpcy5jb2xsaWRlQ29ubmVjdGVkID0gb3B0aW9ucy5jb2xsaWRlQ29ubmVjdGVkOwoKICAgICAgaWYgKG9wdGlvbnMud2FrZVVwQm9kaWVzKSB7CiAgICAgICAgaWYgKGJvZHlBKSB7CiAgICAgICAgICBib2R5QS53YWtlVXAoKTsKICAgICAgICB9CgogICAgICAgIGlmIChib2R5QikgewogICAgICAgICAgYm9keUIud2FrZVVwKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIFVwZGF0ZSBhbGwgdGhlIGVxdWF0aW9ucyB3aXRoIGRhdGEuCiAgICAgKi8KCgogICAgdXBkYXRlKCkgewogICAgICB0aHJvdyBuZXcgRXJyb3IoJ21ldGhvZCB1cGRhdGUoKSBub3QgaW1wbG1lbWVudGVkIGluIHRoaXMgQ29uc3RyYWludCBzdWJjbGFzcyEnKTsKICAgIH0KICAgIC8qKgogICAgICogRW5hYmxlcyBhbGwgZXF1YXRpb25zIGluIHRoZSBjb25zdHJhaW50LgogICAgICovCgoKICAgIGVuYWJsZSgpIHsKICAgICAgY29uc3QgZXFzID0gdGhpcy5lcXVhdGlvbnM7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGVxcy5sZW5ndGg7IGkrKykgewogICAgICAgIGVxc1tpXS5lbmFibGVkID0gdHJ1ZTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBEaXNhYmxlcyBhbGwgZXF1YXRpb25zIGluIHRoZSBjb25zdHJhaW50LgogICAgICovCgoKICAgIGRpc2FibGUoKSB7CiAgICAgIGNvbnN0IGVxcyA9IHRoaXMuZXF1YXRpb25zOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBlcXMubGVuZ3RoOyBpKyspIHsKICAgICAgICBlcXNbaV0uZW5hYmxlZCA9IGZhbHNlOwogICAgICB9CiAgICB9CgogIH0KICBDb25zdHJhaW50LmlkQ291bnRlciA9IDA7CgogIC8qKgogICAqIEFuIGVsZW1lbnQgY29udGFpbmluZyA2IGVudHJpZXMsIDMgc3BhdGlhbCBhbmQgMyByb3RhdGlvbmFsIGRlZ3JlZXMgb2YgZnJlZWRvbS4KICAgKi8KCiAgY2xhc3MgSmFjb2JpYW5FbGVtZW50IHsKICAgIC8qKgogICAgICogc3BhdGlhbAogICAgICovCgogICAgLyoqCiAgICAgKiByb3RhdGlvbmFsCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKCkgewogICAgICB0aGlzLnNwYXRpYWwgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLnJvdGF0aW9uYWwgPSBuZXcgVmVjMygpOwogICAgfQogICAgLyoqCiAgICAgKiBNdWx0aXBseSB3aXRoIG90aGVyIEphY29iaWFuRWxlbWVudAogICAgICovCgoKICAgIG11bHRpcGx5RWxlbWVudChlbGVtZW50KSB7CiAgICAgIHJldHVybiBlbGVtZW50LnNwYXRpYWwuZG90KHRoaXMuc3BhdGlhbCkgKyBlbGVtZW50LnJvdGF0aW9uYWwuZG90KHRoaXMucm90YXRpb25hbCk7CiAgICB9CiAgICAvKioKICAgICAqIE11bHRpcGx5IHdpdGggdHdvIHZlY3RvcnMKICAgICAqLwoKCiAgICBtdWx0aXBseVZlY3RvcnMoc3BhdGlhbCwgcm90YXRpb25hbCkgewogICAgICByZXR1cm4gc3BhdGlhbC5kb3QodGhpcy5zcGF0aWFsKSArIHJvdGF0aW9uYWwuZG90KHRoaXMucm90YXRpb25hbCk7CiAgICB9CgogIH0KCiAgLyoqCiAgICogRXF1YXRpb24gYmFzZSBjbGFzcy4KICAgKgogICAqIGBhYCwgYGJgIGFuZCBgZXBzYCBhcmUge0BsaW5rIGh0dHBzOi8vd3d3OC5jcy51bXUuc2Uva3Vyc2VyLzVEVjA1OC9WVDE1L2xlY3R1cmVzL1NQT09LbGFibm90ZXMucGRmIFNQT09LfSBwYXJhbWV0ZXJzIHRoYXQgZGVmYXVsdCB0byBgMC4wYC4gU2VlIHtAbGluayBodHRwczovL2dpdGh1Yi5jb20vc2NodGVwcGUvY2Fubm9uLmpzL2lzc3Vlcy8yMzgjaXNzdWVjb21tZW50LTE0NzE3MjMyNyB0aGlzIGV4Y2hhbmdlfSBmb3IgbW9yZSBkZXRhaWxzIG9uIENhbm5vbidzIHBoeXNpY3MgaW1wbGVtZW50YXRpb24uCiAgICovCiAgY2xhc3MgRXF1YXRpb24gewogICAgLyoqCiAgICAgKiBNaW5pbXVtIChyZWFkOiBuZWdhdGl2ZSBtYXgpIGZvcmNlIHRvIGJlIGFwcGxpZWQgYnkgdGhlIGNvbnN0cmFpbnQuCiAgICAgKi8KCiAgICAvKioKICAgICAqIE1heGltdW0gKHJlYWQ6IHBvc2l0aXZlIG1heCkgZm9yY2UgdG8gYmUgYXBwbGllZCBieSB0aGUgY29uc3RyYWludC4KICAgICAqLwoKICAgIC8qKgogICAgICogU1BPT0sgcGFyYW1ldGVyCiAgICAgKi8KCiAgICAvKioKICAgICAqIFNQT09LIHBhcmFtZXRlcgogICAgICovCgogICAgLyoqCiAgICAgKiBTUE9PSyBwYXJhbWV0ZXIKICAgICAqLwoKICAgIC8qKgogICAgICogQSBudW1iZXIsIHByb3BvcnRpb25hbCB0byB0aGUgZm9yY2UgYWRkZWQgdG8gdGhlIGJvZGllcy4KICAgICAqLwogICAgY29uc3RydWN0b3IoYmksIGJqLCBtaW5Gb3JjZSwgbWF4Rm9yY2UpIHsKICAgICAgaWYgKG1pbkZvcmNlID09PSB2b2lkIDApIHsKICAgICAgICBtaW5Gb3JjZSA9IC0xZTY7CiAgICAgIH0KCiAgICAgIGlmIChtYXhGb3JjZSA9PT0gdm9pZCAwKSB7CiAgICAgICAgbWF4Rm9yY2UgPSAxZTY7CiAgICAgIH0KCiAgICAgIHRoaXMuaWQgPSBFcXVhdGlvbi5pZENvdW50ZXIrKzsKICAgICAgdGhpcy5taW5Gb3JjZSA9IG1pbkZvcmNlOwogICAgICB0aGlzLm1heEZvcmNlID0gbWF4Rm9yY2U7CiAgICAgIHRoaXMuYmkgPSBiaTsKICAgICAgdGhpcy5iaiA9IGJqOwogICAgICB0aGlzLmEgPSAwLjA7IC8vIFNQT09LIHBhcmFtZXRlcgoKICAgICAgdGhpcy5iID0gMC4wOyAvLyBTUE9PSyBwYXJhbWV0ZXIKCiAgICAgIHRoaXMuZXBzID0gMC4wOyAvLyBTUE9PSyBwYXJhbWV0ZXIKCiAgICAgIHRoaXMuamFjb2JpYW5FbGVtZW50QSA9IG5ldyBKYWNvYmlhbkVsZW1lbnQoKTsKICAgICAgdGhpcy5qYWNvYmlhbkVsZW1lbnRCID0gbmV3IEphY29iaWFuRWxlbWVudCgpOwogICAgICB0aGlzLmVuYWJsZWQgPSB0cnVlOwogICAgICB0aGlzLm11bHRpcGxpZXIgPSAwOwogICAgICB0aGlzLnNldFNwb29rUGFyYW1zKDFlNywgNCwgMSAvIDYwKTsgLy8gU2V0IHR5cGljYWwgc3Bvb2sgcGFyYW1zCiAgICB9CiAgICAvKioKICAgICAqIFJlY2FsY3VsYXRlcyBhLCBiLCBhbmQgZXBzLgogICAgICoKICAgICAqIFRoZSBFcXVhdGlvbiBjb25zdHJ1Y3RvciBzZXRzIHR5cGljYWwgU1BPT0sgcGFyYW1ldGVycyBhcyBzdWNoOgogICAgICogKiBgc3RpZmZuZXNzYCA9IDFlNwogICAgICogKiBgcmVsYXhhdGlvbmAgPSA0CiAgICAgKiAqIGB0aW1lU3RlcGA9IDEgLyA2MCwgX25vdGUgdGhlIGhhcmRjb2RlZCByZWZyZXNoIHJhdGUuXwogICAgICovCgoKICAgIHNldFNwb29rUGFyYW1zKHN0aWZmbmVzcywgcmVsYXhhdGlvbiwgdGltZVN0ZXApIHsKICAgICAgY29uc3QgZCA9IHJlbGF4YXRpb247CiAgICAgIGNvbnN0IGsgPSBzdGlmZm5lc3M7CiAgICAgIGNvbnN0IGggPSB0aW1lU3RlcDsKICAgICAgdGhpcy5hID0gNC4wIC8gKGggKiAoMSArIDQgKiBkKSk7CiAgICAgIHRoaXMuYiA9IDQuMCAqIGQgLyAoMSArIDQgKiBkKTsKICAgICAgdGhpcy5lcHMgPSA0LjAgLyAoaCAqIGggKiBrICogKDEgKyA0ICogZCkpOwogICAgfQogICAgLyoqCiAgICAgKiBDb21wdXRlcyB0aGUgcmlnaHQgaGFuZCBzaWRlIG9mIHRoZSBTUE9PSyBlcXVhdGlvbgogICAgICovCgoKICAgIGNvbXB1dGVCKGEsIGIsIGgpIHsKICAgICAgY29uc3QgR1cgPSB0aGlzLmNvbXB1dGVHVygpOwogICAgICBjb25zdCBHcSA9IHRoaXMuY29tcHV0ZUdxKCk7CiAgICAgIGNvbnN0IEdpTWYgPSB0aGlzLmNvbXB1dGVHaU1mKCk7CiAgICAgIHJldHVybiAtR3EgKiBhIC0gR1cgKiBiIC0gR2lNZiAqIGg7CiAgICB9CiAgICAvKioKICAgICAqIENvbXB1dGVzIEcqcSwgd2hlcmUgcSBhcmUgdGhlIGdlbmVyYWxpemVkIGJvZHkgY29vcmRpbmF0ZXMKICAgICAqLwoKCiAgICBjb21wdXRlR3EoKSB7CiAgICAgIGNvbnN0IEdBID0gdGhpcy5qYWNvYmlhbkVsZW1lbnRBOwogICAgICBjb25zdCBHQiA9IHRoaXMuamFjb2JpYW5FbGVtZW50QjsKICAgICAgY29uc3QgYmkgPSB0aGlzLmJpOwogICAgICBjb25zdCBiaiA9IHRoaXMuYmo7CiAgICAgIGNvbnN0IHhpID0gYmkucG9zaXRpb247CiAgICAgIGNvbnN0IHhqID0gYmoucG9zaXRpb247CiAgICAgIHJldHVybiBHQS5zcGF0aWFsLmRvdCh4aSkgKyBHQi5zcGF0aWFsLmRvdCh4aik7CiAgICB9CiAgICAvKioKICAgICAqIENvbXB1dGVzIEcqVywgd2hlcmUgVyBhcmUgdGhlIGJvZHkgdmVsb2NpdGllcwogICAgICovCgoKICAgIGNvbXB1dGVHVygpIHsKICAgICAgY29uc3QgR0EgPSB0aGlzLmphY29iaWFuRWxlbWVudEE7CiAgICAgIGNvbnN0IEdCID0gdGhpcy5qYWNvYmlhbkVsZW1lbnRCOwogICAgICBjb25zdCBiaSA9IHRoaXMuYmk7CiAgICAgIGNvbnN0IGJqID0gdGhpcy5iajsKICAgICAgY29uc3QgdmkgPSBiaS52ZWxvY2l0eTsKICAgICAgY29uc3QgdmogPSBiai52ZWxvY2l0eTsKICAgICAgY29uc3Qgd2kgPSBiaS5hbmd1bGFyVmVsb2NpdHk7CiAgICAgIGNvbnN0IHdqID0gYmouYW5ndWxhclZlbG9jaXR5OwogICAgICByZXR1cm4gR0EubXVsdGlwbHlWZWN0b3JzKHZpLCB3aSkgKyBHQi5tdWx0aXBseVZlY3RvcnModmosIHdqKTsKICAgIH0KICAgIC8qKgogICAgICogQ29tcHV0ZXMgRypXbGFtYmRhLCB3aGVyZSBXIGFyZSB0aGUgYm9keSB2ZWxvY2l0aWVzCiAgICAgKi8KCgogICAgY29tcHV0ZUdXbGFtYmRhKCkgewogICAgICBjb25zdCBHQSA9IHRoaXMuamFjb2JpYW5FbGVtZW50QTsKICAgICAgY29uc3QgR0IgPSB0aGlzLmphY29iaWFuRWxlbWVudEI7CiAgICAgIGNvbnN0IGJpID0gdGhpcy5iaTsKICAgICAgY29uc3QgYmogPSB0aGlzLmJqOwogICAgICBjb25zdCB2aSA9IGJpLnZsYW1iZGE7CiAgICAgIGNvbnN0IHZqID0gYmoudmxhbWJkYTsKICAgICAgY29uc3Qgd2kgPSBiaS53bGFtYmRhOwogICAgICBjb25zdCB3aiA9IGJqLndsYW1iZGE7CiAgICAgIHJldHVybiBHQS5tdWx0aXBseVZlY3RvcnModmksIHdpKSArIEdCLm11bHRpcGx5VmVjdG9ycyh2aiwgd2opOwogICAgfQogICAgLyoqCiAgICAgKiBDb21wdXRlcyBHKmludihNKSpmLCB3aGVyZSBNIGlzIHRoZSBtYXNzIG1hdHJpeCB3aXRoIGRpYWdvbmFsIGJsb2NrcyBmb3IgZWFjaCBib2R5LCBhbmQgZiBhcmUgdGhlIGZvcmNlcyBvbiB0aGUgYm9kaWVzLgogICAgICovCgoKICAgIGNvbXB1dGVHaU1mKCkgewogICAgICBjb25zdCBHQSA9IHRoaXMuamFjb2JpYW5FbGVtZW50QTsKICAgICAgY29uc3QgR0IgPSB0aGlzLmphY29iaWFuRWxlbWVudEI7CiAgICAgIGNvbnN0IGJpID0gdGhpcy5iaTsKICAgICAgY29uc3QgYmogPSB0aGlzLmJqOwogICAgICBjb25zdCBmaSA9IGJpLmZvcmNlOwogICAgICBjb25zdCB0aSA9IGJpLnRvcnF1ZTsKICAgICAgY29uc3QgZmogPSBiai5mb3JjZTsKICAgICAgY29uc3QgdGogPSBiai50b3JxdWU7CiAgICAgIGNvbnN0IGludk1hc3NpID0gYmkuaW52TWFzc1NvbHZlOwogICAgICBjb25zdCBpbnZNYXNzaiA9IGJqLmludk1hc3NTb2x2ZTsKICAgICAgZmkuc2NhbGUoaW52TWFzc2ksIGlNZmkpOwogICAgICBmai5zY2FsZShpbnZNYXNzaiwgaU1maik7CiAgICAgIGJpLmludkluZXJ0aWFXb3JsZFNvbHZlLnZtdWx0KHRpLCBpbnZJaV92bXVsdF90YXVpKTsKICAgICAgYmouaW52SW5lcnRpYVdvcmxkU29sdmUudm11bHQodGosIGludklqX3ZtdWx0X3RhdWopOwogICAgICByZXR1cm4gR0EubXVsdGlwbHlWZWN0b3JzKGlNZmksIGludklpX3ZtdWx0X3RhdWkpICsgR0IubXVsdGlwbHlWZWN0b3JzKGlNZmosIGludklqX3ZtdWx0X3RhdWopOwogICAgfQogICAgLyoqCiAgICAgKiBDb21wdXRlcyBHKmludihNKSpHJwogICAgICovCgoKICAgIGNvbXB1dGVHaU1HdCgpIHsKICAgICAgY29uc3QgR0EgPSB0aGlzLmphY29iaWFuRWxlbWVudEE7CiAgICAgIGNvbnN0IEdCID0gdGhpcy5qYWNvYmlhbkVsZW1lbnRCOwogICAgICBjb25zdCBiaSA9IHRoaXMuYmk7CiAgICAgIGNvbnN0IGJqID0gdGhpcy5iajsKICAgICAgY29uc3QgaW52TWFzc2kgPSBiaS5pbnZNYXNzU29sdmU7CiAgICAgIGNvbnN0IGludk1hc3NqID0gYmouaW52TWFzc1NvbHZlOwogICAgICBjb25zdCBpbnZJaSA9IGJpLmludkluZXJ0aWFXb3JsZFNvbHZlOwogICAgICBjb25zdCBpbnZJaiA9IGJqLmludkluZXJ0aWFXb3JsZFNvbHZlOwogICAgICBsZXQgcmVzdWx0ID0gaW52TWFzc2kgKyBpbnZNYXNzajsKICAgICAgaW52SWkudm11bHQoR0Eucm90YXRpb25hbCwgdG1wKTsKICAgICAgcmVzdWx0ICs9IHRtcC5kb3QoR0Eucm90YXRpb25hbCk7CiAgICAgIGludklqLnZtdWx0KEdCLnJvdGF0aW9uYWwsIHRtcCk7CiAgICAgIHJlc3VsdCArPSB0bXAuZG90KEdCLnJvdGF0aW9uYWwpOwogICAgICByZXR1cm4gcmVzdWx0OwogICAgfQogICAgLyoqCiAgICAgKiBBZGQgY29uc3RyYWludCB2ZWxvY2l0eSB0byB0aGUgYm9kaWVzLgogICAgICovCgoKICAgIGFkZFRvV2xhbWJkYShkZWx0YWxhbWJkYSkgewogICAgICBjb25zdCBHQSA9IHRoaXMuamFjb2JpYW5FbGVtZW50QTsKICAgICAgY29uc3QgR0IgPSB0aGlzLmphY29iaWFuRWxlbWVudEI7CiAgICAgIGNvbnN0IGJpID0gdGhpcy5iaTsKICAgICAgY29uc3QgYmogPSB0aGlzLmJqOwogICAgICBjb25zdCB0ZW1wID0gYWRkVG9XbGFtYmRhX3RlbXA7IC8vIEFkZCB0byBsaW5lYXIgdmVsb2NpdHkKICAgICAgLy8gdl9sYW1iZGEgKz0gaW52KE0pICogZGVsdGFfbGFtYmEgKiBHCgogICAgICBiaS52bGFtYmRhLmFkZFNjYWxlZFZlY3RvcihiaS5pbnZNYXNzU29sdmUgKiBkZWx0YWxhbWJkYSwgR0Euc3BhdGlhbCwgYmkudmxhbWJkYSk7CiAgICAgIGJqLnZsYW1iZGEuYWRkU2NhbGVkVmVjdG9yKGJqLmludk1hc3NTb2x2ZSAqIGRlbHRhbGFtYmRhLCBHQi5zcGF0aWFsLCBiai52bGFtYmRhKTsgLy8gQWRkIHRvIGFuZ3VsYXIgdmVsb2NpdHkKCiAgICAgIGJpLmludkluZXJ0aWFXb3JsZFNvbHZlLnZtdWx0KEdBLnJvdGF0aW9uYWwsIHRlbXApOwogICAgICBiaS53bGFtYmRhLmFkZFNjYWxlZFZlY3RvcihkZWx0YWxhbWJkYSwgdGVtcCwgYmkud2xhbWJkYSk7CiAgICAgIGJqLmludkluZXJ0aWFXb3JsZFNvbHZlLnZtdWx0KEdCLnJvdGF0aW9uYWwsIHRlbXApOwogICAgICBiai53bGFtYmRhLmFkZFNjYWxlZFZlY3RvcihkZWx0YWxhbWJkYSwgdGVtcCwgYmoud2xhbWJkYSk7CiAgICB9CiAgICAvKioKICAgICAqIENvbXB1dGUgdGhlIGRlbm9taW5hdG9yIHBhcnQgb2YgdGhlIFNQT09LIGVxdWF0aW9uOiBDID0gRyppbnYoTSkqRycgKyBlcHMKICAgICAqLwoKCiAgICBjb21wdXRlQygpIHsKICAgICAgcmV0dXJuIHRoaXMuY29tcHV0ZUdpTUd0KCkgKyB0aGlzLmVwczsKICAgIH0KCiAgfQogIEVxdWF0aW9uLmlkQ291bnRlciA9IDA7CiAgY29uc3QgaU1maSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgaU1maiA9IG5ldyBWZWMzKCk7CiAgY29uc3QgaW52SWlfdm11bHRfdGF1aSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgaW52SWpfdm11bHRfdGF1aiA9IG5ldyBWZWMzKCk7CiAgY29uc3QgdG1wID0gbmV3IFZlYzMoKTsKICBjb25zdCBhZGRUb1dsYW1iZGFfdGVtcCA9IG5ldyBWZWMzKCk7CgogIC8qKgogICAqIENvbnRhY3Qvbm9uLXBlbmV0cmF0aW9uIGNvbnN0cmFpbnQgZXF1YXRpb24KICAgKi8KICBjbGFzcyBDb250YWN0RXF1YXRpb24gZXh0ZW5kcyBFcXVhdGlvbiB7CiAgICAvKioKICAgICAqICJib3VuY2luZXNzIjogdTEgPSAtZSp1MAogICAgICovCgogICAgLyoqCiAgICAgKiBXb3JsZC1vcmllbnRlZCB2ZWN0b3IgdGhhdCBnb2VzIGZyb20gdGhlIGNlbnRlciBvZiBiaSB0byB0aGUgY29udGFjdCBwb2ludC4KICAgICAqLwoKICAgIC8qKgogICAgICogV29ybGQtb3JpZW50ZWQgdmVjdG9yIHRoYXQgc3RhcnRzIGluIGJvZHkgaiBwb3NpdGlvbiBhbmQgZ29lcyB0byB0aGUgY29udGFjdCBwb2ludC4KICAgICAqLwoKICAgIC8qKgogICAgICogQ29udGFjdCBub3JtYWwsIHBvaW50aW5nIG91dCBvZiBib2R5IGkuCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKGJvZHlBLCBib2R5QiwgbWF4Rm9yY2UpIHsKICAgICAgaWYgKG1heEZvcmNlID09PSB2b2lkIDApIHsKICAgICAgICBtYXhGb3JjZSA9IDFlNjsKICAgICAgfQoKICAgICAgc3VwZXIoYm9keUEsIGJvZHlCLCAwLCBtYXhGb3JjZSk7CiAgICAgIHRoaXMucmVzdGl0dXRpb24gPSAwLjA7CiAgICAgIHRoaXMucmkgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLnJqID0gbmV3IFZlYzMoKTsKICAgICAgdGhpcy5uaSA9IG5ldyBWZWMzKCk7CiAgICB9CgogICAgY29tcHV0ZUIoaCkgewogICAgICBjb25zdCBhID0gdGhpcy5hOwogICAgICBjb25zdCBiID0gdGhpcy5iOwogICAgICBjb25zdCBiaSA9IHRoaXMuYmk7CiAgICAgIGNvbnN0IGJqID0gdGhpcy5iajsKICAgICAgY29uc3QgcmkgPSB0aGlzLnJpOwogICAgICBjb25zdCByaiA9IHRoaXMucmo7CiAgICAgIGNvbnN0IHJpeG4gPSBDb250YWN0RXF1YXRpb25fY29tcHV0ZUJfdGVtcDE7CiAgICAgIGNvbnN0IHJqeG4gPSBDb250YWN0RXF1YXRpb25fY29tcHV0ZUJfdGVtcDI7CiAgICAgIGNvbnN0IHZpID0gYmkudmVsb2NpdHk7CiAgICAgIGNvbnN0IHdpID0gYmkuYW5ndWxhclZlbG9jaXR5OwogICAgICBiaS5mb3JjZTsKICAgICAgYmkudG9ycXVlOwogICAgICBjb25zdCB2aiA9IGJqLnZlbG9jaXR5OwogICAgICBjb25zdCB3aiA9IGJqLmFuZ3VsYXJWZWxvY2l0eTsKICAgICAgYmouZm9yY2U7CiAgICAgIGJqLnRvcnF1ZTsKICAgICAgY29uc3QgcGVuZXRyYXRpb25WZWMgPSBDb250YWN0RXF1YXRpb25fY29tcHV0ZUJfdGVtcDM7CiAgICAgIGNvbnN0IEdBID0gdGhpcy5qYWNvYmlhbkVsZW1lbnRBOwogICAgICBjb25zdCBHQiA9IHRoaXMuamFjb2JpYW5FbGVtZW50QjsKICAgICAgY29uc3QgbiA9IHRoaXMubmk7IC8vIENhbHVjbGF0ZSBjcm9zcyBwcm9kdWN0cwoKICAgICAgcmkuY3Jvc3Mobiwgcml4bik7CiAgICAgIHJqLmNyb3NzKG4sIHJqeG4pOyAvLyBnID0geGorcmogLSh4aStyaSkKICAgICAgLy8gRyA9IFsgLW5pICAtcml4biAgbmkgIHJqeG4gXQoKICAgICAgbi5uZWdhdGUoR0Euc3BhdGlhbCk7CiAgICAgIHJpeG4ubmVnYXRlKEdBLnJvdGF0aW9uYWwpOwogICAgICBHQi5zcGF0aWFsLmNvcHkobik7CiAgICAgIEdCLnJvdGF0aW9uYWwuY29weShyanhuKTsgLy8gQ2FsY3VsYXRlIHRoZSBwZW5ldHJhdGlvbiB2ZWN0b3IKCiAgICAgIHBlbmV0cmF0aW9uVmVjLmNvcHkoYmoucG9zaXRpb24pOwogICAgICBwZW5ldHJhdGlvblZlYy52YWRkKHJqLCBwZW5ldHJhdGlvblZlYyk7CiAgICAgIHBlbmV0cmF0aW9uVmVjLnZzdWIoYmkucG9zaXRpb24sIHBlbmV0cmF0aW9uVmVjKTsKICAgICAgcGVuZXRyYXRpb25WZWMudnN1YihyaSwgcGVuZXRyYXRpb25WZWMpOwogICAgICBjb25zdCBnID0gbi5kb3QocGVuZXRyYXRpb25WZWMpOyAvLyBDb21wdXRlIGl0ZXJhdGlvbgoKICAgICAgY29uc3QgZVBsdXNPbmUgPSB0aGlzLnJlc3RpdHV0aW9uICsgMTsKICAgICAgY29uc3QgR1cgPSBlUGx1c09uZSAqIHZqLmRvdChuKSAtIGVQbHVzT25lICogdmkuZG90KG4pICsgd2ouZG90KHJqeG4pIC0gd2kuZG90KHJpeG4pOwogICAgICBjb25zdCBHaU1mID0gdGhpcy5jb21wdXRlR2lNZigpOwogICAgICBjb25zdCBCID0gLWcgKiBhIC0gR1cgKiBiIC0gaCAqIEdpTWY7CiAgICAgIHJldHVybiBCOwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgdGhlIGN1cnJlbnQgcmVsYXRpdmUgdmVsb2NpdHkgaW4gdGhlIGNvbnRhY3QgcG9pbnQuCiAgICAgKi8KCgogICAgZ2V0SW1wYWN0VmVsb2NpdHlBbG9uZ05vcm1hbCgpIHsKICAgICAgY29uc3QgdmkgPSBDb250YWN0RXF1YXRpb25fZ2V0SW1wYWN0VmVsb2NpdHlBbG9uZ05vcm1hbF92aTsKICAgICAgY29uc3QgdmogPSBDb250YWN0RXF1YXRpb25fZ2V0SW1wYWN0VmVsb2NpdHlBbG9uZ05vcm1hbF92ajsKICAgICAgY29uc3QgeGkgPSBDb250YWN0RXF1YXRpb25fZ2V0SW1wYWN0VmVsb2NpdHlBbG9uZ05vcm1hbF94aTsKICAgICAgY29uc3QgeGogPSBDb250YWN0RXF1YXRpb25fZ2V0SW1wYWN0VmVsb2NpdHlBbG9uZ05vcm1hbF94ajsKICAgICAgY29uc3QgcmVsVmVsID0gQ29udGFjdEVxdWF0aW9uX2dldEltcGFjdFZlbG9jaXR5QWxvbmdOb3JtYWxfcmVsVmVsOwogICAgICB0aGlzLmJpLnBvc2l0aW9uLnZhZGQodGhpcy5yaSwgeGkpOwogICAgICB0aGlzLmJqLnBvc2l0aW9uLnZhZGQodGhpcy5yaiwgeGopOwogICAgICB0aGlzLmJpLmdldFZlbG9jaXR5QXRXb3JsZFBvaW50KHhpLCB2aSk7CiAgICAgIHRoaXMuYmouZ2V0VmVsb2NpdHlBdFdvcmxkUG9pbnQoeGosIHZqKTsKICAgICAgdmkudnN1Yih2aiwgcmVsVmVsKTsKICAgICAgcmV0dXJuIHRoaXMubmkuZG90KHJlbFZlbCk7CiAgICB9CgogIH0KICBjb25zdCBDb250YWN0RXF1YXRpb25fY29tcHV0ZUJfdGVtcDEgPSBuZXcgVmVjMygpOyAvLyBUZW1wIHZlY3RvcnMKCiAgY29uc3QgQ29udGFjdEVxdWF0aW9uX2NvbXB1dGVCX3RlbXAyID0gbmV3IFZlYzMoKTsKICBjb25zdCBDb250YWN0RXF1YXRpb25fY29tcHV0ZUJfdGVtcDMgPSBuZXcgVmVjMygpOwogIGNvbnN0IENvbnRhY3RFcXVhdGlvbl9nZXRJbXBhY3RWZWxvY2l0eUFsb25nTm9ybWFsX3ZpID0gbmV3IFZlYzMoKTsKICBjb25zdCBDb250YWN0RXF1YXRpb25fZ2V0SW1wYWN0VmVsb2NpdHlBbG9uZ05vcm1hbF92aiA9IG5ldyBWZWMzKCk7CiAgY29uc3QgQ29udGFjdEVxdWF0aW9uX2dldEltcGFjdFZlbG9jaXR5QWxvbmdOb3JtYWxfeGkgPSBuZXcgVmVjMygpOwogIGNvbnN0IENvbnRhY3RFcXVhdGlvbl9nZXRJbXBhY3RWZWxvY2l0eUFsb25nTm9ybWFsX3hqID0gbmV3IFZlYzMoKTsKICBjb25zdCBDb250YWN0RXF1YXRpb25fZ2V0SW1wYWN0VmVsb2NpdHlBbG9uZ05vcm1hbF9yZWxWZWwgPSBuZXcgVmVjMygpOwoKICAvKioKICAgKiBDb25uZWN0cyB0d28gYm9kaWVzIGF0IGdpdmVuIG9mZnNldCBwb2ludHMuCiAgICogQGV4YW1wbGUKICAgKiAgICAgY29uc3QgYm9keUEgPSBuZXcgQm9keSh7IG1hc3M6IDEgfSkKICAgKiAgICAgY29uc3QgYm9keUIgPSBuZXcgQm9keSh7IG1hc3M6IDEgfSkKICAgKiAgICAgYm9keUEucG9zaXRpb24uc2V0KC0xLCAwLCAwKQogICAqICAgICBib2R5Qi5wb3NpdGlvbi5zZXQoMSwgMCwgMCkKICAgKiAgICAgYm9keUEuYWRkU2hhcGUoc2hhcGVBKQogICAqICAgICBib2R5Qi5hZGRTaGFwZShzaGFwZUIpCiAgICogICAgIHdvcmxkLmFkZEJvZHkoYm9keUEpCiAgICogICAgIHdvcmxkLmFkZEJvZHkoYm9keUIpCiAgICogICAgIGNvbnN0IGxvY2FsUGl2b3RBID0gbmV3IFZlYzMoMSwgMCwgMCkKICAgKiAgICAgY29uc3QgbG9jYWxQaXZvdEIgPSBuZXcgVmVjMygtMSwgMCwgMCkKICAgKiAgICAgY29uc3QgY29uc3RyYWludCA9IG5ldyBQb2ludFRvUG9pbnRDb25zdHJhaW50KGJvZHlBLCBsb2NhbFBpdm90QSwgYm9keUIsIGxvY2FsUGl2b3RCKQogICAqICAgICB3b3JsZC5hZGRDb25zdHJhaW50KGNvbnN0cmFpbnQpCiAgICovCiAgY2xhc3MgUG9pbnRUb1BvaW50Q29uc3RyYWludCBleHRlbmRzIENvbnN0cmFpbnQgewogICAgLyoqCiAgICAgKiBQaXZvdCwgZGVmaW5lZCBsb2NhbGx5IGluIGJvZHlBLgogICAgICovCgogICAgLyoqCiAgICAgKiBQaXZvdCwgZGVmaW5lZCBsb2NhbGx5IGluIGJvZHlCLgogICAgICovCgogICAgLyoqCiAgICAgKiBAcGFyYW0gcGl2b3RBIFRoZSBwb2ludCByZWxhdGl2ZSB0byB0aGUgY2VudGVyIG9mIG1hc3Mgb2YgYm9keUEgd2hpY2ggYm9keUEgaXMgY29uc3RyYWluZWQgdG8uCiAgICAgKiBAcGFyYW0gYm9keUIgQm9keSB0aGF0IHdpbGwgYmUgY29uc3RyYWluZWQgaW4gYSBzaW1pbGFyIHdheSB0byB0aGUgc2FtZSBwb2ludCBhcyBib2R5QS4gV2Ugd2lsbCB0aGVyZWZvcmUgZ2V0IGEgbGluayBiZXR3ZWVuIGJvZHlBIGFuZCBib2R5Qi4gSWYgbm90IHNwZWNpZmllZCwgYm9keUEgd2lsbCBiZSBjb25zdHJhaW5lZCB0byBhIHN0YXRpYyBwb2ludC4KICAgICAqIEBwYXJhbSBwaXZvdEIgVGhlIHBvaW50IHJlbGF0aXZlIHRvIHRoZSBjZW50ZXIgb2YgbWFzcyBvZiBib2R5QiB3aGljaCBib2R5QiBpcyBjb25zdHJhaW5lZCB0by4KICAgICAqIEBwYXJhbSBtYXhGb3JjZSBUaGUgbWF4aW11bSBmb3JjZSB0aGF0IHNob3VsZCBiZSBhcHBsaWVkIHRvIGNvbnN0cmFpbiB0aGUgYm9kaWVzLgogICAgICovCiAgICBjb25zdHJ1Y3Rvcihib2R5QSwgcGl2b3RBLCBib2R5QiwgcGl2b3RCLCBtYXhGb3JjZSkgewogICAgICBpZiAocGl2b3RBID09PSB2b2lkIDApIHsKICAgICAgICBwaXZvdEEgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICBpZiAocGl2b3RCID09PSB2b2lkIDApIHsKICAgICAgICBwaXZvdEIgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICBpZiAobWF4Rm9yY2UgPT09IHZvaWQgMCkgewogICAgICAgIG1heEZvcmNlID0gMWU2OwogICAgICB9CgogICAgICBzdXBlcihib2R5QSwgYm9keUIpOwogICAgICB0aGlzLnBpdm90QSA9IHBpdm90QS5jbG9uZSgpOwogICAgICB0aGlzLnBpdm90QiA9IHBpdm90Qi5jbG9uZSgpOwogICAgICBjb25zdCB4ID0gdGhpcy5lcXVhdGlvblggPSBuZXcgQ29udGFjdEVxdWF0aW9uKGJvZHlBLCBib2R5Qik7CiAgICAgIGNvbnN0IHkgPSB0aGlzLmVxdWF0aW9uWSA9IG5ldyBDb250YWN0RXF1YXRpb24oYm9keUEsIGJvZHlCKTsKICAgICAgY29uc3QgeiA9IHRoaXMuZXF1YXRpb25aID0gbmV3IENvbnRhY3RFcXVhdGlvbihib2R5QSwgYm9keUIpOyAvLyBFcXVhdGlvbnMgdG8gYmUgZmVkIHRvIHRoZSBzb2x2ZXIKCiAgICAgIHRoaXMuZXF1YXRpb25zLnB1c2goeCwgeSwgeik7IC8vIE1ha2UgdGhlIGVxdWF0aW9ucyBiaWRpcmVjdGlvbmFsCgogICAgICB4Lm1pbkZvcmNlID0geS5taW5Gb3JjZSA9IHoubWluRm9yY2UgPSAtbWF4Rm9yY2U7CiAgICAgIHgubWF4Rm9yY2UgPSB5Lm1heEZvcmNlID0gei5tYXhGb3JjZSA9IG1heEZvcmNlOwogICAgICB4Lm5pLnNldCgxLCAwLCAwKTsKICAgICAgeS5uaS5zZXQoMCwgMSwgMCk7CiAgICAgIHoubmkuc2V0KDAsIDAsIDEpOwogICAgfQoKICAgIHVwZGF0ZSgpIHsKICAgICAgY29uc3QgYm9keUEgPSB0aGlzLmJvZHlBOwogICAgICBjb25zdCBib2R5QiA9IHRoaXMuYm9keUI7CiAgICAgIGNvbnN0IHggPSB0aGlzLmVxdWF0aW9uWDsKICAgICAgY29uc3QgeSA9IHRoaXMuZXF1YXRpb25ZOwogICAgICBjb25zdCB6ID0gdGhpcy5lcXVhdGlvblo7IC8vIFJvdGF0ZSB0aGUgcGl2b3RzIHRvIHdvcmxkIHNwYWNlCgogICAgICBib2R5QS5xdWF0ZXJuaW9uLnZtdWx0KHRoaXMucGl2b3RBLCB4LnJpKTsKICAgICAgYm9keUIucXVhdGVybmlvbi52bXVsdCh0aGlzLnBpdm90QiwgeC5yaik7CiAgICAgIHkucmkuY29weSh4LnJpKTsKICAgICAgeS5yai5jb3B5KHgucmopOwogICAgICB6LnJpLmNvcHkoeC5yaSk7CiAgICAgIHoucmouY29weSh4LnJqKTsKICAgIH0KCiAgfQoKICAvKioKICAgKiBDb25lIGVxdWF0aW9uLiBXb3JrcyB0byBrZWVwIHRoZSBnaXZlbiBib2R5IHdvcmxkIHZlY3RvcnMgYWxpZ25lZCwgb3IgdGlsdGVkIHdpdGhpbiBhIGdpdmVuIGFuZ2xlIGZyb20gZWFjaCBvdGhlci4KICAgKi8KICBjbGFzcyBDb25lRXF1YXRpb24gZXh0ZW5kcyBFcXVhdGlvbiB7CiAgICAvKioKICAgICAqIExvY2FsIGF4aXMgaW4gQQogICAgICovCgogICAgLyoqCiAgICAgKiBMb2NhbCBheGlzIGluIEIKICAgICAqLwoKICAgIC8qKgogICAgICogVGhlICJjb25lIGFuZ2xlIiB0byBrZWVwCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKGJvZHlBLCBib2R5Qiwgb3B0aW9ucykgewogICAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7CiAgICAgICAgb3B0aW9ucyA9IHt9OwogICAgICB9CgogICAgICBjb25zdCBtYXhGb3JjZSA9IHR5cGVvZiBvcHRpb25zLm1heEZvcmNlICE9PSAndW5kZWZpbmVkJyA/IG9wdGlvbnMubWF4Rm9yY2UgOiAxZTY7CiAgICAgIHN1cGVyKGJvZHlBLCBib2R5QiwgLW1heEZvcmNlLCBtYXhGb3JjZSk7CiAgICAgIHRoaXMuYXhpc0EgPSBvcHRpb25zLmF4aXNBID8gb3B0aW9ucy5heGlzQS5jbG9uZSgpIDogbmV3IFZlYzMoMSwgMCwgMCk7CiAgICAgIHRoaXMuYXhpc0IgPSBvcHRpb25zLmF4aXNCID8gb3B0aW9ucy5heGlzQi5jbG9uZSgpIDogbmV3IFZlYzMoMCwgMSwgMCk7CiAgICAgIHRoaXMuYW5nbGUgPSB0eXBlb2Ygb3B0aW9ucy5hbmdsZSAhPT0gJ3VuZGVmaW5lZCcgPyBvcHRpb25zLmFuZ2xlIDogMDsKICAgIH0KCiAgICBjb21wdXRlQihoKSB7CiAgICAgIGNvbnN0IGEgPSB0aGlzLmE7CiAgICAgIGNvbnN0IGIgPSB0aGlzLmI7CiAgICAgIGNvbnN0IG5pID0gdGhpcy5heGlzQTsKICAgICAgY29uc3QgbmogPSB0aGlzLmF4aXNCOwogICAgICBjb25zdCBuaXhuaiA9IHRtcFZlYzEkMjsKICAgICAgY29uc3Qgbmp4bmkgPSB0bXBWZWMyJDI7CiAgICAgIGNvbnN0IEdBID0gdGhpcy5qYWNvYmlhbkVsZW1lbnRBOwogICAgICBjb25zdCBHQiA9IHRoaXMuamFjb2JpYW5FbGVtZW50QjsgLy8gQ2FsdWNsYXRlIGNyb3NzIHByb2R1Y3RzCgogICAgICBuaS5jcm9zcyhuaiwgbml4bmopOwogICAgICBuai5jcm9zcyhuaSwgbmp4bmkpOyAvLyBUaGUgYW5nbGUgYmV0d2VlbiB0d28gdmVjdG9yIGlzOgogICAgICAvLyBjb3ModGhldGEpID0gYSAqIGIgLyAobGVuZ3RoKGEpICogbGVuZ3RoKGIpID0geyBsZW4oYSkgPSBsZW4oYikgPSAxIH0gPSBhICogYgogICAgICAvLyBnID0gYSAqIGIKICAgICAgLy8gZ2RvdCA9IChiIHggYSkgKiB3aSArIChhIHggYikgKiB3agogICAgICAvLyBHID0gWzAgYnhhIDAgYXhiXQogICAgICAvLyBXID0gW3ZpIHdpIHZqIHdqXQoKICAgICAgR0Eucm90YXRpb25hbC5jb3B5KG5qeG5pKTsKICAgICAgR0Iucm90YXRpb25hbC5jb3B5KG5peG5qKTsKICAgICAgY29uc3QgZyA9IE1hdGguY29zKHRoaXMuYW5nbGUpIC0gbmkuZG90KG5qKTsKICAgICAgY29uc3QgR1cgPSB0aGlzLmNvbXB1dGVHVygpOwogICAgICBjb25zdCBHaU1mID0gdGhpcy5jb21wdXRlR2lNZigpOwogICAgICBjb25zdCBCID0gLWcgKiBhIC0gR1cgKiBiIC0gaCAqIEdpTWY7CiAgICAgIHJldHVybiBCOwogICAgfQoKICB9CiAgY29uc3QgdG1wVmVjMSQyID0gbmV3IFZlYzMoKTsKICBjb25zdCB0bXBWZWMyJDIgPSBuZXcgVmVjMygpOwoKICAvKioKICAgKiBSb3RhdGlvbmFsIGNvbnN0cmFpbnQuIFdvcmtzIHRvIGtlZXAgdGhlIGxvY2FsIHZlY3RvcnMgb3J0aG9nb25hbCB0byBlYWNoIG90aGVyIGluIHdvcmxkIHNwYWNlLgogICAqLwogIGNsYXNzIFJvdGF0aW9uYWxFcXVhdGlvbiBleHRlbmRzIEVxdWF0aW9uIHsKICAgIC8qKgogICAgICogV29ybGQgb3JpZW50ZWQgcm90YXRpb25hbCBheGlzLgogICAgICovCgogICAgLyoqCiAgICAgKiBXb3JsZCBvcmllbnRlZCByb3RhdGlvbmFsIGF4aXMuCiAgICAgKi8KCiAgICAvKioKICAgICAqIG1heEFuZ2xlCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKGJvZHlBLCBib2R5Qiwgb3B0aW9ucykgewogICAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7CiAgICAgICAgb3B0aW9ucyA9IHt9OwogICAgICB9CgogICAgICBjb25zdCBtYXhGb3JjZSA9IHR5cGVvZiBvcHRpb25zLm1heEZvcmNlICE9PSAndW5kZWZpbmVkJyA/IG9wdGlvbnMubWF4Rm9yY2UgOiAxZTY7CiAgICAgIHN1cGVyKGJvZHlBLCBib2R5QiwgLW1heEZvcmNlLCBtYXhGb3JjZSk7CiAgICAgIHRoaXMuYXhpc0EgPSBvcHRpb25zLmF4aXNBID8gb3B0aW9ucy5heGlzQS5jbG9uZSgpIDogbmV3IFZlYzMoMSwgMCwgMCk7CiAgICAgIHRoaXMuYXhpc0IgPSBvcHRpb25zLmF4aXNCID8gb3B0aW9ucy5heGlzQi5jbG9uZSgpIDogbmV3IFZlYzMoMCwgMSwgMCk7CiAgICAgIHRoaXMubWF4QW5nbGUgPSBNYXRoLlBJIC8gMjsKICAgIH0KCiAgICBjb21wdXRlQihoKSB7CiAgICAgIGNvbnN0IGEgPSB0aGlzLmE7CiAgICAgIGNvbnN0IGIgPSB0aGlzLmI7CiAgICAgIGNvbnN0IG5pID0gdGhpcy5heGlzQTsKICAgICAgY29uc3QgbmogPSB0aGlzLmF4aXNCOwogICAgICBjb25zdCBuaXhuaiA9IHRtcFZlYzEkMTsKICAgICAgY29uc3Qgbmp4bmkgPSB0bXBWZWMyJDE7CiAgICAgIGNvbnN0IEdBID0gdGhpcy5qYWNvYmlhbkVsZW1lbnRBOwogICAgICBjb25zdCBHQiA9IHRoaXMuamFjb2JpYW5FbGVtZW50QjsgLy8gQ2FsdWNsYXRlIGNyb3NzIHByb2R1Y3RzCgogICAgICBuaS5jcm9zcyhuaiwgbml4bmopOwogICAgICBuai5jcm9zcyhuaSwgbmp4bmkpOyAvLyBnID0gbmkgKiBuagogICAgICAvLyBnZG90ID0gKG5qIHggbmkpICogd2kgKyAobmkgeCBuaikgKiB3agogICAgICAvLyBHID0gWzAgbmp4bmkgMCBuaXhual0KICAgICAgLy8gVyA9IFt2aSB3aSB2aiB3al0KCiAgICAgIEdBLnJvdGF0aW9uYWwuY29weShuanhuaSk7CiAgICAgIEdCLnJvdGF0aW9uYWwuY29weShuaXhuaik7CiAgICAgIGNvbnN0IGcgPSBNYXRoLmNvcyh0aGlzLm1heEFuZ2xlKSAtIG5pLmRvdChuaik7CiAgICAgIGNvbnN0IEdXID0gdGhpcy5jb21wdXRlR1coKTsKICAgICAgY29uc3QgR2lNZiA9IHRoaXMuY29tcHV0ZUdpTWYoKTsKICAgICAgY29uc3QgQiA9IC1nICogYSAtIEdXICogYiAtIGggKiBHaU1mOwogICAgICByZXR1cm4gQjsKICAgIH0KCiAgfQogIGNvbnN0IHRtcFZlYzEkMSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgdG1wVmVjMiQxID0gbmV3IFZlYzMoKTsKCiAgLyoqCiAgICogQSBDb25lIFR3aXN0IGNvbnN0cmFpbnQsIHVzZWZ1bCBmb3IgcmFnZG9sbHMuCiAgICovCiAgY2xhc3MgQ29uZVR3aXN0Q29uc3RyYWludCBleHRlbmRzIFBvaW50VG9Qb2ludENvbnN0cmFpbnQgewogICAgLyoqCiAgICAgKiBUaGUgYXhpcyBkaXJlY3Rpb24gZm9yIHRoZSBjb25zdHJhaW50IG9mIHRoZSBib2R5IEEuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFRoZSBheGlzIGRpcmVjdGlvbiBmb3IgdGhlIGNvbnN0cmFpbnQgb2YgdGhlIGJvZHkgQi4KICAgICAqLwoKICAgIC8qKgogICAgICogVGhlIGFwZXJ0dXJlIGFuZ2xlIG9mIHRoZSBjb25lLgogICAgICovCgogICAgLyoqCiAgICAgKiBUaGUgdHdpc3QgYW5nbGUgb2YgdGhlIGpvaW50LgogICAgICovCiAgICBjb25zdHJ1Y3Rvcihib2R5QSwgYm9keUIsIG9wdGlvbnMpIHsKICAgICAgaWYgKG9wdGlvbnMgPT09IHZvaWQgMCkgewogICAgICAgIG9wdGlvbnMgPSB7fTsKICAgICAgfQoKICAgICAgY29uc3QgbWF4Rm9yY2UgPSB0eXBlb2Ygb3B0aW9ucy5tYXhGb3JjZSAhPT0gJ3VuZGVmaW5lZCcgPyBvcHRpb25zLm1heEZvcmNlIDogMWU2OyAvLyBTZXQgcGl2b3QgcG9pbnQgaW4gYmV0d2VlbgoKICAgICAgY29uc3QgcGl2b3RBID0gb3B0aW9ucy5waXZvdEEgPyBvcHRpb25zLnBpdm90QS5jbG9uZSgpIDogbmV3IFZlYzMoKTsKICAgICAgY29uc3QgcGl2b3RCID0gb3B0aW9ucy5waXZvdEIgPyBvcHRpb25zLnBpdm90Qi5jbG9uZSgpIDogbmV3IFZlYzMoKTsKICAgICAgc3VwZXIoYm9keUEsIHBpdm90QSwgYm9keUIsIHBpdm90QiwgbWF4Rm9yY2UpOwogICAgICB0aGlzLmF4aXNBID0gb3B0aW9ucy5heGlzQSA/IG9wdGlvbnMuYXhpc0EuY2xvbmUoKSA6IG5ldyBWZWMzKCk7CiAgICAgIHRoaXMuYXhpc0IgPSBvcHRpb25zLmF4aXNCID8gb3B0aW9ucy5heGlzQi5jbG9uZSgpIDogbmV3IFZlYzMoKTsKICAgICAgdGhpcy5jb2xsaWRlQ29ubmVjdGVkID0gISFvcHRpb25zLmNvbGxpZGVDb25uZWN0ZWQ7CiAgICAgIHRoaXMuYW5nbGUgPSB0eXBlb2Ygb3B0aW9ucy5hbmdsZSAhPT0gJ3VuZGVmaW5lZCcgPyBvcHRpb25zLmFuZ2xlIDogMDsKICAgICAgY29uc3QgYyA9IHRoaXMuY29uZUVxdWF0aW9uID0gbmV3IENvbmVFcXVhdGlvbihib2R5QSwgYm9keUIsIG9wdGlvbnMpOwogICAgICBjb25zdCB0ID0gdGhpcy50d2lzdEVxdWF0aW9uID0gbmV3IFJvdGF0aW9uYWxFcXVhdGlvbihib2R5QSwgYm9keUIsIG9wdGlvbnMpOwogICAgICB0aGlzLnR3aXN0QW5nbGUgPSB0eXBlb2Ygb3B0aW9ucy50d2lzdEFuZ2xlICE9PSAndW5kZWZpbmVkJyA/IG9wdGlvbnMudHdpc3RBbmdsZSA6IDA7IC8vIE1ha2UgdGhlIGNvbmUgZXF1YXRpb24gcHVzaCB0aGUgYm9kaWVzIHRvd2FyZCB0aGUgY29uZSBheGlzLCBub3Qgb3V0d2FyZAoKICAgICAgYy5tYXhGb3JjZSA9IDA7CiAgICAgIGMubWluRm9yY2UgPSAtbWF4Rm9yY2U7IC8vIE1ha2UgdGhlIHR3aXN0IGVxdWF0aW9uIGFkZCB0b3JxdWUgdG93YXJkIHRoZSBpbml0aWFsIHBvc2l0aW9uCgogICAgICB0Lm1heEZvcmNlID0gMDsKICAgICAgdC5taW5Gb3JjZSA9IC1tYXhGb3JjZTsKICAgICAgdGhpcy5lcXVhdGlvbnMucHVzaChjLCB0KTsKICAgIH0KCiAgICB1cGRhdGUoKSB7CiAgICAgIGNvbnN0IGJvZHlBID0gdGhpcy5ib2R5QTsKICAgICAgY29uc3QgYm9keUIgPSB0aGlzLmJvZHlCOwogICAgICBjb25zdCBjb25lID0gdGhpcy5jb25lRXF1YXRpb247CiAgICAgIGNvbnN0IHR3aXN0ID0gdGhpcy50d2lzdEVxdWF0aW9uOwogICAgICBzdXBlci51cGRhdGUoKTsgLy8gVXBkYXRlIHRoZSBheGVzIHRvIHRoZSBjb25lIGNvbnN0cmFpbnQKCiAgICAgIGJvZHlBLnZlY3RvclRvV29ybGRGcmFtZSh0aGlzLmF4aXNBLCBjb25lLmF4aXNBKTsKICAgICAgYm9keUIudmVjdG9yVG9Xb3JsZEZyYW1lKHRoaXMuYXhpc0IsIGNvbmUuYXhpc0IpOyAvLyBVcGRhdGUgdGhlIHdvcmxkIGF4ZXMgaW4gdGhlIHR3aXN0IGNvbnN0cmFpbnQKCiAgICAgIHRoaXMuYXhpc0EudGFuZ2VudHModHdpc3QuYXhpc0EsIHR3aXN0LmF4aXNBKTsKICAgICAgYm9keUEudmVjdG9yVG9Xb3JsZEZyYW1lKHR3aXN0LmF4aXNBLCB0d2lzdC5heGlzQSk7CiAgICAgIHRoaXMuYXhpc0IudGFuZ2VudHModHdpc3QuYXhpc0IsIHR3aXN0LmF4aXNCKTsKICAgICAgYm9keUIudmVjdG9yVG9Xb3JsZEZyYW1lKHR3aXN0LmF4aXNCLCB0d2lzdC5heGlzQik7CiAgICAgIGNvbmUuYW5nbGUgPSB0aGlzLmFuZ2xlOwogICAgICB0d2lzdC5tYXhBbmdsZSA9IHRoaXMudHdpc3RBbmdsZTsKICAgIH0KCiAgfQogIG5ldyBWZWMzKCk7CiAgbmV3IFZlYzMoKTsKCiAgLyoqCiAgICogQ29uc3RyYWlucyB0d28gYm9kaWVzIHRvIGJlIGF0IGEgY29uc3RhbnQgZGlzdGFuY2UgZnJvbSBlYWNoIG90aGVycyBjZW50ZXIgb2YgbWFzcy4KICAgKi8KICBjbGFzcyBEaXN0YW5jZUNvbnN0cmFpbnQgZXh0ZW5kcyBDb25zdHJhaW50IHsKICAgIC8qKgogICAgICogVGhlIGRpc3RhbmNlIHRvIGtlZXAuIElmIHVuZGVmaW5lZCwgaXQgd2lsbCBiZSBzZXQgdG8gdGhlIGN1cnJlbnQgZGlzdGFuY2UgYmV0d2VlbiBib2R5QSBhbmQgYm9keUIKICAgICAqLwoKICAgIC8qKgogICAgICogQHBhcmFtIGRpc3RhbmNlIFRoZSBkaXN0YW5jZSB0byBrZWVwLiBJZiB1bmRlZmluZWQsIGl0IHdpbGwgYmUgc2V0IHRvIHRoZSBjdXJyZW50IGRpc3RhbmNlIGJldHdlZW4gYm9keUEgYW5kIGJvZHlCLgogICAgICogQHBhcmFtIG1heEZvcmNlIFRoZSBtYXhpbXVtIGZvcmNlIHRoYXQgc2hvdWxkIGJlIGFwcGxpZWQgdG8gY29uc3RyYWluIHRoZSBib2RpZXMuCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKGJvZHlBLCBib2R5QiwgZGlzdGFuY2UsIG1heEZvcmNlKSB7CiAgICAgIGlmIChtYXhGb3JjZSA9PT0gdm9pZCAwKSB7CiAgICAgICAgbWF4Rm9yY2UgPSAxZTY7CiAgICAgIH0KCiAgICAgIHN1cGVyKGJvZHlBLCBib2R5Qik7CgogICAgICBpZiAodHlwZW9mIGRpc3RhbmNlID09PSAndW5kZWZpbmVkJykgewogICAgICAgIGRpc3RhbmNlID0gYm9keUEucG9zaXRpb24uZGlzdGFuY2VUbyhib2R5Qi5wb3NpdGlvbik7CiAgICAgIH0KCiAgICAgIHRoaXMuZGlzdGFuY2UgPSBkaXN0YW5jZTsKICAgICAgY29uc3QgZXEgPSB0aGlzLmRpc3RhbmNlRXF1YXRpb24gPSBuZXcgQ29udGFjdEVxdWF0aW9uKGJvZHlBLCBib2R5Qik7CiAgICAgIHRoaXMuZXF1YXRpb25zLnB1c2goZXEpOyAvLyBNYWtlIGl0IGJpZGlyZWN0aW9uYWwKCiAgICAgIGVxLm1pbkZvcmNlID0gLW1heEZvcmNlOwogICAgICBlcS5tYXhGb3JjZSA9IG1heEZvcmNlOwogICAgfQogICAgLyoqCiAgICAgKiB1cGRhdGUKICAgICAqLwoKCiAgICB1cGRhdGUoKSB7CiAgICAgIGNvbnN0IGJvZHlBID0gdGhpcy5ib2R5QTsKICAgICAgY29uc3QgYm9keUIgPSB0aGlzLmJvZHlCOwogICAgICBjb25zdCBlcSA9IHRoaXMuZGlzdGFuY2VFcXVhdGlvbjsKICAgICAgY29uc3QgaGFsZkRpc3QgPSB0aGlzLmRpc3RhbmNlICogMC41OwogICAgICBjb25zdCBub3JtYWwgPSBlcS5uaTsKICAgICAgYm9keUIucG9zaXRpb24udnN1Yihib2R5QS5wb3NpdGlvbiwgbm9ybWFsKTsKICAgICAgbm9ybWFsLm5vcm1hbGl6ZSgpOwogICAgICBub3JtYWwuc2NhbGUoaGFsZkRpc3QsIGVxLnJpKTsKICAgICAgbm9ybWFsLnNjYWxlKC1oYWxmRGlzdCwgZXEucmopOwogICAgfQoKICB9CgogIC8qKgogICAqIExvY2sgY29uc3RyYWludC4gV2lsbCByZW1vdmUgYWxsIGRlZ3JlZXMgb2YgZnJlZWRvbSBiZXR3ZWVuIHRoZSBib2RpZXMuCiAgICovCiAgY2xhc3MgTG9ja0NvbnN0cmFpbnQgZXh0ZW5kcyBQb2ludFRvUG9pbnRDb25zdHJhaW50IHsKICAgIGNvbnN0cnVjdG9yKGJvZHlBLCBib2R5Qiwgb3B0aW9ucykgewogICAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7CiAgICAgICAgb3B0aW9ucyA9IHt9OwogICAgICB9CgogICAgICBjb25zdCBtYXhGb3JjZSA9IHR5cGVvZiBvcHRpb25zLm1heEZvcmNlICE9PSAndW5kZWZpbmVkJyA/IG9wdGlvbnMubWF4Rm9yY2UgOiAxZTY7IC8vIFNldCBwaXZvdCBwb2ludCBpbiBiZXR3ZWVuCgogICAgICBjb25zdCBwaXZvdEEgPSBuZXcgVmVjMygpOwogICAgICBjb25zdCBwaXZvdEIgPSBuZXcgVmVjMygpOwogICAgICBjb25zdCBoYWxmV2F5ID0gbmV3IFZlYzMoKTsKICAgICAgYm9keUEucG9zaXRpb24udmFkZChib2R5Qi5wb3NpdGlvbiwgaGFsZldheSk7CiAgICAgIGhhbGZXYXkuc2NhbGUoMC41LCBoYWxmV2F5KTsKICAgICAgYm9keUIucG9pbnRUb0xvY2FsRnJhbWUoaGFsZldheSwgcGl2b3RCKTsKICAgICAgYm9keUEucG9pbnRUb0xvY2FsRnJhbWUoaGFsZldheSwgcGl2b3RBKTsgLy8gVGhlIHBvaW50LXRvLXBvaW50IGNvbnN0cmFpbnQgd2lsbCBrZWVwIGEgcG9pbnQgc2hhcmVkIGJldHdlZW4gdGhlIGJvZGllcwoKICAgICAgc3VwZXIoYm9keUEsIHBpdm90QSwgYm9keUIsIHBpdm90QiwgbWF4Rm9yY2UpOyAvLyBTdG9yZSBpbml0aWFsIHJvdGF0aW9uIG9mIHRoZSBib2RpZXMgYXMgdW5pdCB2ZWN0b3JzIGluIHRoZSBsb2NhbCBib2R5IHNwYWNlcwoKICAgICAgdGhpcy54QSA9IGJvZHlBLnZlY3RvclRvTG9jYWxGcmFtZShWZWMzLlVOSVRfWCk7CiAgICAgIHRoaXMueEIgPSBib2R5Qi52ZWN0b3JUb0xvY2FsRnJhbWUoVmVjMy5VTklUX1gpOwogICAgICB0aGlzLnlBID0gYm9keUEudmVjdG9yVG9Mb2NhbEZyYW1lKFZlYzMuVU5JVF9ZKTsKICAgICAgdGhpcy55QiA9IGJvZHlCLnZlY3RvclRvTG9jYWxGcmFtZShWZWMzLlVOSVRfWSk7CiAgICAgIHRoaXMuekEgPSBib2R5QS52ZWN0b3JUb0xvY2FsRnJhbWUoVmVjMy5VTklUX1opOwogICAgICB0aGlzLnpCID0gYm9keUIudmVjdG9yVG9Mb2NhbEZyYW1lKFZlYzMuVU5JVF9aKTsgLy8gLi4uYW5kIHRoZSBmb2xsb3dpbmcgcm90YXRpb25hbCBlcXVhdGlvbnMgd2lsbCBrZWVwIGFsbCByb3RhdGlvbmFsIERPRidzIGluIHBsYWNlCgogICAgICBjb25zdCByMSA9IHRoaXMucm90YXRpb25hbEVxdWF0aW9uMSA9IG5ldyBSb3RhdGlvbmFsRXF1YXRpb24oYm9keUEsIGJvZHlCLCBvcHRpb25zKTsKICAgICAgY29uc3QgcjIgPSB0aGlzLnJvdGF0aW9uYWxFcXVhdGlvbjIgPSBuZXcgUm90YXRpb25hbEVxdWF0aW9uKGJvZHlBLCBib2R5Qiwgb3B0aW9ucyk7CiAgICAgIGNvbnN0IHIzID0gdGhpcy5yb3RhdGlvbmFsRXF1YXRpb24zID0gbmV3IFJvdGF0aW9uYWxFcXVhdGlvbihib2R5QSwgYm9keUIsIG9wdGlvbnMpOwogICAgICB0aGlzLmVxdWF0aW9ucy5wdXNoKHIxLCByMiwgcjMpOwogICAgfQogICAgLyoqCiAgICAgKiB1cGRhdGUKICAgICAqLwoKCiAgICB1cGRhdGUoKSB7CiAgICAgIGNvbnN0IGJvZHlBID0gdGhpcy5ib2R5QTsKICAgICAgY29uc3QgYm9keUIgPSB0aGlzLmJvZHlCOwogICAgICB0aGlzLm1vdG9yRXF1YXRpb247CiAgICAgIGNvbnN0IHIxID0gdGhpcy5yb3RhdGlvbmFsRXF1YXRpb24xOwogICAgICBjb25zdCByMiA9IHRoaXMucm90YXRpb25hbEVxdWF0aW9uMjsKICAgICAgY29uc3QgcjMgPSB0aGlzLnJvdGF0aW9uYWxFcXVhdGlvbjM7CiAgICAgIHN1cGVyLnVwZGF0ZSgpOyAvLyBUaGVzZSB2ZWN0b3IgcGFpcnMgbXVzdCBiZSBvcnRob2dvbmFsCgogICAgICBib2R5QS52ZWN0b3JUb1dvcmxkRnJhbWUodGhpcy54QSwgcjEuYXhpc0EpOwogICAgICBib2R5Qi52ZWN0b3JUb1dvcmxkRnJhbWUodGhpcy55QiwgcjEuYXhpc0IpOwogICAgICBib2R5QS52ZWN0b3JUb1dvcmxkRnJhbWUodGhpcy55QSwgcjIuYXhpc0EpOwogICAgICBib2R5Qi52ZWN0b3JUb1dvcmxkRnJhbWUodGhpcy56QiwgcjIuYXhpc0IpOwogICAgICBib2R5QS52ZWN0b3JUb1dvcmxkRnJhbWUodGhpcy56QSwgcjMuYXhpc0EpOwogICAgICBib2R5Qi52ZWN0b3JUb1dvcmxkRnJhbWUodGhpcy54QiwgcjMuYXhpc0IpOwogICAgfQoKICB9CiAgbmV3IFZlYzMoKTsKICBuZXcgVmVjMygpOwoKICAvKioKICAgKiBSb3RhdGlvbmFsIG1vdG9yIGNvbnN0cmFpbnQuIFRyaWVzIHRvIGtlZXAgdGhlIHJlbGF0aXZlIGFuZ3VsYXIgdmVsb2NpdHkgb2YgdGhlIGJvZGllcyB0byBhIGdpdmVuIHZhbHVlLgogICAqLwogIGNsYXNzIFJvdGF0aW9uYWxNb3RvckVxdWF0aW9uIGV4dGVuZHMgRXF1YXRpb24gewogICAgLyoqCiAgICAgKiBXb3JsZCBvcmllbnRlZCByb3RhdGlvbmFsIGF4aXMuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFdvcmxkIG9yaWVudGVkIHJvdGF0aW9uYWwgYXhpcy4KICAgICAqLwoKICAgIC8qKgogICAgICogTW90b3IgdmVsb2NpdHkuCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKGJvZHlBLCBib2R5QiwgbWF4Rm9yY2UpIHsKICAgICAgaWYgKG1heEZvcmNlID09PSB2b2lkIDApIHsKICAgICAgICBtYXhGb3JjZSA9IDFlNjsKICAgICAgfQoKICAgICAgc3VwZXIoYm9keUEsIGJvZHlCLCAtbWF4Rm9yY2UsIG1heEZvcmNlKTsKICAgICAgdGhpcy5heGlzQSA9IG5ldyBWZWMzKCk7CiAgICAgIHRoaXMuYXhpc0IgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLnRhcmdldFZlbG9jaXR5ID0gMDsKICAgIH0KCiAgICBjb21wdXRlQihoKSB7CiAgICAgIHRoaXMuYTsKICAgICAgY29uc3QgYiA9IHRoaXMuYjsKICAgICAgdGhpcy5iaTsKICAgICAgdGhpcy5iajsKICAgICAgY29uc3QgYXhpc0EgPSB0aGlzLmF4aXNBOwogICAgICBjb25zdCBheGlzQiA9IHRoaXMuYXhpc0I7CiAgICAgIGNvbnN0IEdBID0gdGhpcy5qYWNvYmlhbkVsZW1lbnRBOwogICAgICBjb25zdCBHQiA9IHRoaXMuamFjb2JpYW5FbGVtZW50QjsgLy8gZyA9IDAKICAgICAgLy8gZ2RvdCA9IGF4aXNBICogd2kgLSBheGlzQiAqIHdqCiAgICAgIC8vIGdkb3QgPSBHICogVyA9IEcgKiBbdmkgd2kgdmogd2pdCiAgICAgIC8vID0+CiAgICAgIC8vIEcgPSBbMCBheGlzQSAwIC1heGlzQl0KCiAgICAgIEdBLnJvdGF0aW9uYWwuY29weShheGlzQSk7CiAgICAgIGF4aXNCLm5lZ2F0ZShHQi5yb3RhdGlvbmFsKTsKICAgICAgY29uc3QgR1cgPSB0aGlzLmNvbXB1dGVHVygpIC0gdGhpcy50YXJnZXRWZWxvY2l0eTsKICAgICAgY29uc3QgR2lNZiA9IHRoaXMuY29tcHV0ZUdpTWYoKTsKICAgICAgY29uc3QgQiA9IC1HVyAqIGIgLSBoICogR2lNZjsKICAgICAgcmV0dXJuIEI7CiAgICB9CgogIH0KCiAgLyoqCiAgICogSGluZ2UgY29uc3RyYWludC4gVGhpbmsgb2YgaXQgYXMgYSBkb29yIGhpbmdlLiBJdCB0cmllcyB0byBrZWVwIHRoZSBkb29yIGluIHRoZSBjb3JyZWN0IHBsYWNlIGFuZCB3aXRoIHRoZSBjb3JyZWN0IG9yaWVudGF0aW9uLgogICAqLwogIGNsYXNzIEhpbmdlQ29uc3RyYWludCBleHRlbmRzIFBvaW50VG9Qb2ludENvbnN0cmFpbnQgewogICAgLyoqCiAgICAgKiBSb3RhdGlvbiBheGlzLCBkZWZpbmVkIGxvY2FsbHkgaW4gYm9keUEuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFJvdGF0aW9uIGF4aXMsIGRlZmluZWQgbG9jYWxseSBpbiBib2R5Qi4KICAgICAqLwogICAgY29uc3RydWN0b3IoYm9keUEsIGJvZHlCLCBvcHRpb25zKSB7CiAgICAgIGlmIChvcHRpb25zID09PSB2b2lkIDApIHsKICAgICAgICBvcHRpb25zID0ge307CiAgICAgIH0KCiAgICAgIGNvbnN0IG1heEZvcmNlID0gdHlwZW9mIG9wdGlvbnMubWF4Rm9yY2UgIT09ICd1bmRlZmluZWQnID8gb3B0aW9ucy5tYXhGb3JjZSA6IDFlNjsKICAgICAgY29uc3QgcGl2b3RBID0gb3B0aW9ucy5waXZvdEEgPyBvcHRpb25zLnBpdm90QS5jbG9uZSgpIDogbmV3IFZlYzMoKTsKICAgICAgY29uc3QgcGl2b3RCID0gb3B0aW9ucy5waXZvdEIgPyBvcHRpb25zLnBpdm90Qi5jbG9uZSgpIDogbmV3IFZlYzMoKTsKICAgICAgc3VwZXIoYm9keUEsIHBpdm90QSwgYm9keUIsIHBpdm90QiwgbWF4Rm9yY2UpOwogICAgICBjb25zdCBheGlzQSA9IHRoaXMuYXhpc0EgPSBvcHRpb25zLmF4aXNBID8gb3B0aW9ucy5heGlzQS5jbG9uZSgpIDogbmV3IFZlYzMoMSwgMCwgMCk7CiAgICAgIGF4aXNBLm5vcm1hbGl6ZSgpOwogICAgICBjb25zdCBheGlzQiA9IHRoaXMuYXhpc0IgPSBvcHRpb25zLmF4aXNCID8gb3B0aW9ucy5heGlzQi5jbG9uZSgpIDogbmV3IFZlYzMoMSwgMCwgMCk7CiAgICAgIGF4aXNCLm5vcm1hbGl6ZSgpOwogICAgICB0aGlzLmNvbGxpZGVDb25uZWN0ZWQgPSAhIW9wdGlvbnMuY29sbGlkZUNvbm5lY3RlZDsKICAgICAgY29uc3Qgcm90YXRpb25hbDEgPSB0aGlzLnJvdGF0aW9uYWxFcXVhdGlvbjEgPSBuZXcgUm90YXRpb25hbEVxdWF0aW9uKGJvZHlBLCBib2R5Qiwgb3B0aW9ucyk7CiAgICAgIGNvbnN0IHJvdGF0aW9uYWwyID0gdGhpcy5yb3RhdGlvbmFsRXF1YXRpb24yID0gbmV3IFJvdGF0aW9uYWxFcXVhdGlvbihib2R5QSwgYm9keUIsIG9wdGlvbnMpOwogICAgICBjb25zdCBtb3RvciA9IHRoaXMubW90b3JFcXVhdGlvbiA9IG5ldyBSb3RhdGlvbmFsTW90b3JFcXVhdGlvbihib2R5QSwgYm9keUIsIG1heEZvcmNlKTsKICAgICAgbW90b3IuZW5hYmxlZCA9IGZhbHNlOyAvLyBOb3QgZW5hYmxlZCBieSBkZWZhdWx0CiAgICAgIC8vIEVxdWF0aW9ucyB0byBiZSBmZWQgdG8gdGhlIHNvbHZlcgoKICAgICAgdGhpcy5lcXVhdGlvbnMucHVzaChyb3RhdGlvbmFsMSwgcm90YXRpb25hbDIsIG1vdG9yKTsKICAgIH0KICAgIC8qKgogICAgICogZW5hYmxlTW90b3IKICAgICAqLwoKCiAgICBlbmFibGVNb3RvcigpIHsKICAgICAgdGhpcy5tb3RvckVxdWF0aW9uLmVuYWJsZWQgPSB0cnVlOwogICAgfQogICAgLyoqCiAgICAgKiBkaXNhYmxlTW90b3IKICAgICAqLwoKCiAgICBkaXNhYmxlTW90b3IoKSB7CiAgICAgIHRoaXMubW90b3JFcXVhdGlvbi5lbmFibGVkID0gZmFsc2U7CiAgICB9CiAgICAvKioKICAgICAqIHNldE1vdG9yU3BlZWQKICAgICAqLwoKCiAgICBzZXRNb3RvclNwZWVkKHNwZWVkKSB7CiAgICAgIHRoaXMubW90b3JFcXVhdGlvbi50YXJnZXRWZWxvY2l0eSA9IHNwZWVkOwogICAgfQogICAgLyoqCiAgICAgKiBzZXRNb3Rvck1heEZvcmNlCiAgICAgKi8KCgogICAgc2V0TW90b3JNYXhGb3JjZShtYXhGb3JjZSkgewogICAgICB0aGlzLm1vdG9yRXF1YXRpb24ubWF4Rm9yY2UgPSBtYXhGb3JjZTsKICAgICAgdGhpcy5tb3RvckVxdWF0aW9uLm1pbkZvcmNlID0gLW1heEZvcmNlOwogICAgfQogICAgLyoqCiAgICAgKiB1cGRhdGUKICAgICAqLwoKCiAgICB1cGRhdGUoKSB7CiAgICAgIGNvbnN0IGJvZHlBID0gdGhpcy5ib2R5QTsKICAgICAgY29uc3QgYm9keUIgPSB0aGlzLmJvZHlCOwogICAgICBjb25zdCBtb3RvciA9IHRoaXMubW90b3JFcXVhdGlvbjsKICAgICAgY29uc3QgcjEgPSB0aGlzLnJvdGF0aW9uYWxFcXVhdGlvbjE7CiAgICAgIGNvbnN0IHIyID0gdGhpcy5yb3RhdGlvbmFsRXF1YXRpb24yOwogICAgICBjb25zdCB3b3JsZEF4aXNBID0gSGluZ2VDb25zdHJhaW50X3VwZGF0ZV90bXBWZWMxOwogICAgICBjb25zdCB3b3JsZEF4aXNCID0gSGluZ2VDb25zdHJhaW50X3VwZGF0ZV90bXBWZWMyOwogICAgICBjb25zdCBheGlzQSA9IHRoaXMuYXhpc0E7CiAgICAgIGNvbnN0IGF4aXNCID0gdGhpcy5heGlzQjsKICAgICAgc3VwZXIudXBkYXRlKCk7IC8vIEdldCB3b3JsZCBheGVzCgogICAgICBib2R5QS5xdWF0ZXJuaW9uLnZtdWx0KGF4aXNBLCB3b3JsZEF4aXNBKTsKICAgICAgYm9keUIucXVhdGVybmlvbi52bXVsdChheGlzQiwgd29ybGRBeGlzQik7CiAgICAgIHdvcmxkQXhpc0EudGFuZ2VudHMocjEuYXhpc0EsIHIyLmF4aXNBKTsKICAgICAgcjEuYXhpc0IuY29weSh3b3JsZEF4aXNCKTsKICAgICAgcjIuYXhpc0IuY29weSh3b3JsZEF4aXNCKTsKCiAgICAgIGlmICh0aGlzLm1vdG9yRXF1YXRpb24uZW5hYmxlZCkgewogICAgICAgIGJvZHlBLnF1YXRlcm5pb24udm11bHQodGhpcy5heGlzQSwgbW90b3IuYXhpc0EpOwogICAgICAgIGJvZHlCLnF1YXRlcm5pb24udm11bHQodGhpcy5heGlzQiwgbW90b3IuYXhpc0IpOwogICAgICB9CiAgICB9CgogIH0KICBjb25zdCBIaW5nZUNvbnN0cmFpbnRfdXBkYXRlX3RtcFZlYzEgPSBuZXcgVmVjMygpOwogIGNvbnN0IEhpbmdlQ29uc3RyYWludF91cGRhdGVfdG1wVmVjMiA9IG5ldyBWZWMzKCk7CgogIC8qKgogICAqIENvbnN0cmFpbnMgdGhlIHNsaXBwaW5nIGluIGEgY29udGFjdCBhbG9uZyBhIHRhbmdlbnQKICAgKi8KICBjbGFzcyBGcmljdGlvbkVxdWF0aW9uIGV4dGVuZHMgRXF1YXRpb24gewogICAgLy8gVGFuZ2VudAoKICAgIC8qKgogICAgICogQHBhcmFtIHNsaXBGb3JjZSBzaG91bGQgYmUgKy1GX2ZyaWN0aW9uID0gKy1tdSAqIEZfbm9ybWFsID0gKy1tdSAqIG0gKiBnCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKGJvZHlBLCBib2R5Qiwgc2xpcEZvcmNlKSB7CiAgICAgIHN1cGVyKGJvZHlBLCBib2R5QiwgLXNsaXBGb3JjZSwgc2xpcEZvcmNlKTsKICAgICAgdGhpcy5yaSA9IG5ldyBWZWMzKCk7CiAgICAgIHRoaXMucmogPSBuZXcgVmVjMygpOwogICAgICB0aGlzLnQgPSBuZXcgVmVjMygpOwogICAgfQoKICAgIGNvbXB1dGVCKGgpIHsKICAgICAgdGhpcy5hOwogICAgICBjb25zdCBiID0gdGhpcy5iOwogICAgICB0aGlzLmJpOwogICAgICB0aGlzLmJqOwogICAgICBjb25zdCByaSA9IHRoaXMucmk7CiAgICAgIGNvbnN0IHJqID0gdGhpcy5yajsKICAgICAgY29uc3Qgcml4dCA9IEZyaWN0aW9uRXF1YXRpb25fY29tcHV0ZUJfdGVtcDE7CiAgICAgIGNvbnN0IHJqeHQgPSBGcmljdGlvbkVxdWF0aW9uX2NvbXB1dGVCX3RlbXAyOwogICAgICBjb25zdCB0ID0gdGhpcy50OyAvLyBDYWx1Y2xhdGUgY3Jvc3MgcHJvZHVjdHMKCiAgICAgIHJpLmNyb3NzKHQsIHJpeHQpOwogICAgICByai5jcm9zcyh0LCByanh0KTsgLy8gRyA9IFstdCAtcml4dCB0IHJqeHRdCiAgICAgIC8vIEFuZCByZW1lbWJlciwgdGhpcyBpcyBhIHB1cmUgdmVsb2NpdHkgY29uc3RyYWludCwgZyBpcyBhbHdheXMgemVybyEKCiAgICAgIGNvbnN0IEdBID0gdGhpcy5qYWNvYmlhbkVsZW1lbnRBOwogICAgICBjb25zdCBHQiA9IHRoaXMuamFjb2JpYW5FbGVtZW50QjsKICAgICAgdC5uZWdhdGUoR0Euc3BhdGlhbCk7CiAgICAgIHJpeHQubmVnYXRlKEdBLnJvdGF0aW9uYWwpOwogICAgICBHQi5zcGF0aWFsLmNvcHkodCk7CiAgICAgIEdCLnJvdGF0aW9uYWwuY29weShyanh0KTsKICAgICAgY29uc3QgR1cgPSB0aGlzLmNvbXB1dGVHVygpOwogICAgICBjb25zdCBHaU1mID0gdGhpcy5jb21wdXRlR2lNZigpOwogICAgICBjb25zdCBCID0gLUdXICogYiAtIGggKiBHaU1mOwogICAgICByZXR1cm4gQjsKICAgIH0KCiAgfQogIGNvbnN0IEZyaWN0aW9uRXF1YXRpb25fY29tcHV0ZUJfdGVtcDEgPSBuZXcgVmVjMygpOwogIGNvbnN0IEZyaWN0aW9uRXF1YXRpb25fY29tcHV0ZUJfdGVtcDIgPSBuZXcgVmVjMygpOwoKICAvKioKICAgKiBEZWZpbmVzIHdoYXQgaGFwcGVucyB3aGVuIHR3byBtYXRlcmlhbHMgbWVldC4KICAgKiBAdG9kbyBSZWZhY3RvciBtYXRlcmlhbHMgdG8gbWF0ZXJpYWxBIGFuZCBtYXRlcmlhbEIKICAgKi8KICBjbGFzcyBDb250YWN0TWF0ZXJpYWwgewogICAgLyoqCiAgICAgKiBJZGVudGlmaWVyIG9mIHRoaXMgbWF0ZXJpYWwuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFBhcnRpY2lwYXRpbmcgbWF0ZXJpYWxzLgogICAgICovCgogICAgLyoqCiAgICAgKiBGcmljdGlvbiBjb2VmZmljaWVudC4KICAgICAqIEBkZWZhdWx0IDAuMwogICAgICovCgogICAgLyoqCiAgICAgKiBSZXN0aXR1dGlvbiBjb2VmZmljaWVudC4KICAgICAqIEBkZWZhdWx0IDAuMwogICAgICovCgogICAgLyoqCiAgICAgKiBTdGlmZm5lc3Mgb2YgdGhlIHByb2R1Y2VkIGNvbnRhY3QgZXF1YXRpb25zLgogICAgICogQGRlZmF1bHQgMWU3CiAgICAgKi8KCiAgICAvKioKICAgICAqIFJlbGF4YXRpb24gdGltZSBvZiB0aGUgcHJvZHVjZWQgY29udGFjdCBlcXVhdGlvbnMuCiAgICAgKiBAZGVmYXVsdCAzCiAgICAgKi8KCiAgICAvKioKICAgICAqIFN0aWZmbmVzcyBvZiB0aGUgcHJvZHVjZWQgZnJpY3Rpb24gZXF1YXRpb25zLgogICAgICogQGRlZmF1bHQgMWU3CiAgICAgKi8KCiAgICAvKioKICAgICAqIFJlbGF4YXRpb24gdGltZSBvZiB0aGUgcHJvZHVjZWQgZnJpY3Rpb24gZXF1YXRpb25zCiAgICAgKiBAZGVmYXVsdCAzCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKG0xLCBtMiwgb3B0aW9ucykgewogICAgICBvcHRpb25zID0gVXRpbHMuZGVmYXVsdHMob3B0aW9ucywgewogICAgICAgIGZyaWN0aW9uOiAwLjMsCiAgICAgICAgcmVzdGl0dXRpb246IDAuMywKICAgICAgICBjb250YWN0RXF1YXRpb25TdGlmZm5lc3M6IDFlNywKICAgICAgICBjb250YWN0RXF1YXRpb25SZWxheGF0aW9uOiAzLAogICAgICAgIGZyaWN0aW9uRXF1YXRpb25TdGlmZm5lc3M6IDFlNywKICAgICAgICBmcmljdGlvbkVxdWF0aW9uUmVsYXhhdGlvbjogMwogICAgICB9KTsKICAgICAgdGhpcy5pZCA9IENvbnRhY3RNYXRlcmlhbC5pZENvdW50ZXIrKzsKICAgICAgdGhpcy5tYXRlcmlhbHMgPSBbbTEsIG0yXTsKICAgICAgdGhpcy5mcmljdGlvbiA9IG9wdGlvbnMuZnJpY3Rpb247CiAgICAgIHRoaXMucmVzdGl0dXRpb24gPSBvcHRpb25zLnJlc3RpdHV0aW9uOwogICAgICB0aGlzLmNvbnRhY3RFcXVhdGlvblN0aWZmbmVzcyA9IG9wdGlvbnMuY29udGFjdEVxdWF0aW9uU3RpZmZuZXNzOwogICAgICB0aGlzLmNvbnRhY3RFcXVhdGlvblJlbGF4YXRpb24gPSBvcHRpb25zLmNvbnRhY3RFcXVhdGlvblJlbGF4YXRpb247CiAgICAgIHRoaXMuZnJpY3Rpb25FcXVhdGlvblN0aWZmbmVzcyA9IG9wdGlvbnMuZnJpY3Rpb25FcXVhdGlvblN0aWZmbmVzczsKICAgICAgdGhpcy5mcmljdGlvbkVxdWF0aW9uUmVsYXhhdGlvbiA9IG9wdGlvbnMuZnJpY3Rpb25FcXVhdGlvblJlbGF4YXRpb247CiAgICB9CgogIH0KICBDb250YWN0TWF0ZXJpYWwuaWRDb3VudGVyID0gMDsKCiAgLyoqCiAgICogRGVmaW5lcyBhIHBoeXNpY3MgbWF0ZXJpYWwuCiAgICovCiAgY2xhc3MgTWF0ZXJpYWwgewogICAgLyoqCiAgICAgKiBNYXRlcmlhbCBuYW1lLgogICAgICogSWYgb3B0aW9ucyBpcyBhIHN0cmluZywgbmFtZSB3aWxsIGJlIHNldCB0byB0aGF0IHN0cmluZy4KICAgICAqIEB0b2RvIERlcHJlY2F0ZSB0aGlzCiAgICAgKi8KCiAgICAvKiogTWF0ZXJpYWwgaWQuICovCgogICAgLyoqCiAgICAgKiBGcmljdGlvbiBmb3IgdGhpcyBtYXRlcmlhbC4KICAgICAqIElmIG5vbi1uZWdhdGl2ZSwgaXQgd2lsbCBiZSB1c2VkIGluc3RlYWQgb2YgdGhlIGZyaWN0aW9uIGdpdmVuIGJ5IENvbnRhY3RNYXRlcmlhbHMuIElmIHRoZXJlJ3Mgbm8gbWF0Y2hpbmcgQ29udGFjdE1hdGVyaWFsLCB0aGUgdmFsdWUgZnJvbSBgZGVmYXVsdENvbnRhY3RNYXRlcmlhbGAgaW4gdGhlIFdvcmxkIHdpbGwgYmUgdXNlZC4KICAgICAqLwoKICAgIC8qKgogICAgICogUmVzdGl0dXRpb24gZm9yIHRoaXMgbWF0ZXJpYWwuCiAgICAgKiBJZiBub24tbmVnYXRpdmUsIGl0IHdpbGwgYmUgdXNlZCBpbnN0ZWFkIG9mIHRoZSByZXN0aXR1dGlvbiBnaXZlbiBieSBDb250YWN0TWF0ZXJpYWxzLiBJZiB0aGVyZSdzIG5vIG1hdGNoaW5nIENvbnRhY3RNYXRlcmlhbCwgdGhlIHZhbHVlIGZyb20gYGRlZmF1bHRDb250YWN0TWF0ZXJpYWxgIGluIHRoZSBXb3JsZCB3aWxsIGJlIHVzZWQuCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHsKICAgICAgaWYgKG9wdGlvbnMgPT09IHZvaWQgMCkgewogICAgICAgIG9wdGlvbnMgPSB7fTsKICAgICAgfQoKICAgICAgbGV0IG5hbWUgPSAnJzsgLy8gQmFja3dhcmRzIGNvbXBhdGliaWxpdHkgZml4CgogICAgICBpZiAodHlwZW9mIG9wdGlvbnMgPT09ICdzdHJpbmcnKSB7CiAgICAgICAgLy9jb25zb2xlLndhcm4oYFBhc3NpbmcgYSBzdHJpbmcgdG8gTWF0ZXJpYWxPcHRpb25zIGlzIGRlcHJlY2F0ZWQsIGFuZCBoYXMgbm8gZWZmZWN0YCkKICAgICAgICBuYW1lID0gb3B0aW9uczsKICAgICAgICBvcHRpb25zID0ge307CiAgICAgIH0KCiAgICAgIHRoaXMubmFtZSA9IG5hbWU7CiAgICAgIHRoaXMuaWQgPSBNYXRlcmlhbC5pZENvdW50ZXIrKzsKICAgICAgdGhpcy5mcmljdGlvbiA9IHR5cGVvZiBvcHRpb25zLmZyaWN0aW9uICE9PSAndW5kZWZpbmVkJyA/IG9wdGlvbnMuZnJpY3Rpb24gOiAtMTsKICAgICAgdGhpcy5yZXN0aXR1dGlvbiA9IHR5cGVvZiBvcHRpb25zLnJlc3RpdHV0aW9uICE9PSAndW5kZWZpbmVkJyA/IG9wdGlvbnMucmVzdGl0dXRpb24gOiAtMTsKICAgIH0KCiAgfQogIE1hdGVyaWFsLmlkQ291bnRlciA9IDA7CgogIC8qKgogICAqIEEgc3ByaW5nLCBjb25uZWN0aW5nIHR3byBib2RpZXMuCiAgICogQGV4YW1wbGUKICAgKiAgICAgY29uc3Qgc3ByaW5nID0gbmV3IFNwcmluZyhib3hCb2R5LCBzcGhlcmVCb2R5LCB7CiAgICogICAgICAgcmVzdExlbmd0aDogMCwKICAgKiAgICAgICBzdGlmZm5lc3M6IDUwLAogICAqICAgICAgIGRhbXBpbmc6IDEsCiAgICogICAgIH0pCiAgICoKICAgKiAgICAgLy8gQ29tcHV0ZSB0aGUgZm9yY2UgYWZ0ZXIgZWFjaCBzdGVwCiAgICogICAgIHdvcmxkLmFkZEV2ZW50TGlzdGVuZXIoJ3Bvc3RTdGVwJywgKGV2ZW50KSA9PiB7CiAgICogICAgICAgc3ByaW5nLmFwcGx5Rm9yY2UoKQogICAqICAgICB9KQogICAqLwogIGNsYXNzIFNwcmluZyB7CiAgICAvKioKICAgICAqIFJlc3QgbGVuZ3RoIG9mIHRoZSBzcHJpbmcuIEEgbnVtYmVyID4gMC4KICAgICAqIEBkZWZhdWx0IDEKICAgICAqLwoKICAgIC8qKgogICAgICogU3RpZmZuZXNzIG9mIHRoZSBzcHJpbmcuIEEgbnVtYmVyID49IDAuCiAgICAgKiBAZGVmYXVsdCAxMDAKICAgICAqLwoKICAgIC8qKgogICAgICogRGFtcGluZyBvZiB0aGUgc3ByaW5nLiBBIG51bWJlciA+PSAwLgogICAgICogQGRlZmF1bHQgMQogICAgICovCgogICAgLyoqCiAgICAgKiBGaXJzdCBjb25uZWN0ZWQgYm9keS4KICAgICAqLwoKICAgIC8qKgogICAgICogU2Vjb25kIGNvbm5lY3RlZCBib2R5LgogICAgICovCgogICAgLyoqCiAgICAgKiBBbmNob3IgZm9yIGJvZHlBIGluIGxvY2FsIGJvZHlBIGNvb3JkaW5hdGVzLgogICAgICogV2hlcmUgdG8gaG9vayB0aGUgc3ByaW5nIHRvIGJvZHkgQSwgaW4gbG9jYWwgYm9keSBjb29yZGluYXRlcy4KICAgICAqIEBkZWZhdWx0IG5ldyBWZWMzKCkKICAgICAqLwoKICAgIC8qKgogICAgICogQW5jaG9yIGZvciBib2R5QiBpbiBsb2NhbCBib2R5QiBjb29yZGluYXRlcy4KICAgICAqIFdoZXJlIHRvIGhvb2sgdGhlIHNwcmluZyB0byBib2R5IEIsIGluIGxvY2FsIGJvZHkgY29vcmRpbmF0ZXMuCiAgICAgKiBAZGVmYXVsdCBuZXcgVmVjMygpCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKGJvZHlBLCBib2R5Qiwgb3B0aW9ucykgewogICAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7CiAgICAgICAgb3B0aW9ucyA9IHt9OwogICAgICB9CgogICAgICB0aGlzLnJlc3RMZW5ndGggPSB0eXBlb2Ygb3B0aW9ucy5yZXN0TGVuZ3RoID09PSAnbnVtYmVyJyA/IG9wdGlvbnMucmVzdExlbmd0aCA6IDE7CiAgICAgIHRoaXMuc3RpZmZuZXNzID0gb3B0aW9ucy5zdGlmZm5lc3MgfHwgMTAwOwogICAgICB0aGlzLmRhbXBpbmcgPSBvcHRpb25zLmRhbXBpbmcgfHwgMTsKICAgICAgdGhpcy5ib2R5QSA9IGJvZHlBOwogICAgICB0aGlzLmJvZHlCID0gYm9keUI7CiAgICAgIHRoaXMubG9jYWxBbmNob3JBID0gbmV3IFZlYzMoKTsKICAgICAgdGhpcy5sb2NhbEFuY2hvckIgPSBuZXcgVmVjMygpOwoKICAgICAgaWYgKG9wdGlvbnMubG9jYWxBbmNob3JBKSB7CiAgICAgICAgdGhpcy5sb2NhbEFuY2hvckEuY29weShvcHRpb25zLmxvY2FsQW5jaG9yQSk7CiAgICAgIH0KCiAgICAgIGlmIChvcHRpb25zLmxvY2FsQW5jaG9yQikgewogICAgICAgIHRoaXMubG9jYWxBbmNob3JCLmNvcHkob3B0aW9ucy5sb2NhbEFuY2hvckIpOwogICAgICB9CgogICAgICBpZiAob3B0aW9ucy53b3JsZEFuY2hvckEpIHsKICAgICAgICB0aGlzLnNldFdvcmxkQW5jaG9yQShvcHRpb25zLndvcmxkQW5jaG9yQSk7CiAgICAgIH0KCiAgICAgIGlmIChvcHRpb25zLndvcmxkQW5jaG9yQikgewogICAgICAgIHRoaXMuc2V0V29ybGRBbmNob3JCKG9wdGlvbnMud29ybGRBbmNob3JCKTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBTZXQgdGhlIGFuY2hvciBwb2ludCBvbiBib2R5IEEsIHVzaW5nIHdvcmxkIGNvb3JkaW5hdGVzLgogICAgICovCgoKICAgIHNldFdvcmxkQW5jaG9yQSh3b3JsZEFuY2hvckEpIHsKICAgICAgdGhpcy5ib2R5QS5wb2ludFRvTG9jYWxGcmFtZSh3b3JsZEFuY2hvckEsIHRoaXMubG9jYWxBbmNob3JBKTsKICAgIH0KICAgIC8qKgogICAgICogU2V0IHRoZSBhbmNob3IgcG9pbnQgb24gYm9keSBCLCB1c2luZyB3b3JsZCBjb29yZGluYXRlcy4KICAgICAqLwoKCiAgICBzZXRXb3JsZEFuY2hvckIod29ybGRBbmNob3JCKSB7CiAgICAgIHRoaXMuYm9keUIucG9pbnRUb0xvY2FsRnJhbWUod29ybGRBbmNob3JCLCB0aGlzLmxvY2FsQW5jaG9yQik7CiAgICB9CiAgICAvKioKICAgICAqIEdldCB0aGUgYW5jaG9yIHBvaW50IG9uIGJvZHkgQSwgaW4gd29ybGQgY29vcmRpbmF0ZXMuCiAgICAgKiBAcGFyYW0gcmVzdWx0IFRoZSB2ZWN0b3IgdG8gc3RvcmUgdGhlIHJlc3VsdCBpbi4KICAgICAqLwoKCiAgICBnZXRXb3JsZEFuY2hvckEocmVzdWx0KSB7CiAgICAgIHRoaXMuYm9keUEucG9pbnRUb1dvcmxkRnJhbWUodGhpcy5sb2NhbEFuY2hvckEsIHJlc3VsdCk7CiAgICB9CiAgICAvKioKICAgICAqIEdldCB0aGUgYW5jaG9yIHBvaW50IG9uIGJvZHkgQiwgaW4gd29ybGQgY29vcmRpbmF0ZXMuCiAgICAgKiBAcGFyYW0gcmVzdWx0IFRoZSB2ZWN0b3IgdG8gc3RvcmUgdGhlIHJlc3VsdCBpbi4KICAgICAqLwoKCiAgICBnZXRXb3JsZEFuY2hvckIocmVzdWx0KSB7CiAgICAgIHRoaXMuYm9keUIucG9pbnRUb1dvcmxkRnJhbWUodGhpcy5sb2NhbEFuY2hvckIsIHJlc3VsdCk7CiAgICB9CiAgICAvKioKICAgICAqIEFwcGx5IHRoZSBzcHJpbmcgZm9yY2UgdG8gdGhlIGNvbm5lY3RlZCBib2RpZXMuCiAgICAgKi8KCgogICAgYXBwbHlGb3JjZSgpIHsKICAgICAgY29uc3QgayA9IHRoaXMuc3RpZmZuZXNzOwogICAgICBjb25zdCBkID0gdGhpcy5kYW1waW5nOwogICAgICBjb25zdCBsID0gdGhpcy5yZXN0TGVuZ3RoOwogICAgICBjb25zdCBib2R5QSA9IHRoaXMuYm9keUE7CiAgICAgIGNvbnN0IGJvZHlCID0gdGhpcy5ib2R5QjsKICAgICAgY29uc3QgciA9IGFwcGx5Rm9yY2VfcjsKICAgICAgY29uc3Qgcl91bml0ID0gYXBwbHlGb3JjZV9yX3VuaXQ7CiAgICAgIGNvbnN0IHUgPSBhcHBseUZvcmNlX3U7CiAgICAgIGNvbnN0IGYgPSBhcHBseUZvcmNlX2Y7CiAgICAgIGNvbnN0IHRtcCA9IGFwcGx5Rm9yY2VfdG1wOwogICAgICBjb25zdCB3b3JsZEFuY2hvckEgPSBhcHBseUZvcmNlX3dvcmxkQW5jaG9yQTsKICAgICAgY29uc3Qgd29ybGRBbmNob3JCID0gYXBwbHlGb3JjZV93b3JsZEFuY2hvckI7CiAgICAgIGNvbnN0IHJpID0gYXBwbHlGb3JjZV9yaTsKICAgICAgY29uc3QgcmogPSBhcHBseUZvcmNlX3JqOwogICAgICBjb25zdCByaV94X2YgPSBhcHBseUZvcmNlX3JpX3hfZjsKICAgICAgY29uc3QgcmpfeF9mID0gYXBwbHlGb3JjZV9yal94X2Y7IC8vIEdldCB3b3JsZCBhbmNob3JzCgogICAgICB0aGlzLmdldFdvcmxkQW5jaG9yQSh3b3JsZEFuY2hvckEpOwogICAgICB0aGlzLmdldFdvcmxkQW5jaG9yQih3b3JsZEFuY2hvckIpOyAvLyBHZXQgb2Zmc2V0IHBvaW50cwoKICAgICAgd29ybGRBbmNob3JBLnZzdWIoYm9keUEucG9zaXRpb24sIHJpKTsKICAgICAgd29ybGRBbmNob3JCLnZzdWIoYm9keUIucG9zaXRpb24sIHJqKTsgLy8gQ29tcHV0ZSBkaXN0YW5jZSB2ZWN0b3IgYmV0d2VlbiB3b3JsZCBhbmNob3IgcG9pbnRzCgogICAgICB3b3JsZEFuY2hvckIudnN1Yih3b3JsZEFuY2hvckEsIHIpOwogICAgICBjb25zdCBybGVuID0gci5sZW5ndGgoKTsKICAgICAgcl91bml0LmNvcHkocik7CiAgICAgIHJfdW5pdC5ub3JtYWxpemUoKTsgLy8gQ29tcHV0ZSByZWxhdGl2ZSB2ZWxvY2l0eSBvZiB0aGUgYW5jaG9yIHBvaW50cywgdQoKICAgICAgYm9keUIudmVsb2NpdHkudnN1Yihib2R5QS52ZWxvY2l0eSwgdSk7IC8vIEFkZCByb3RhdGlvbmFsIHZlbG9jaXR5CgogICAgICBib2R5Qi5hbmd1bGFyVmVsb2NpdHkuY3Jvc3MocmosIHRtcCk7CiAgICAgIHUudmFkZCh0bXAsIHUpOwogICAgICBib2R5QS5hbmd1bGFyVmVsb2NpdHkuY3Jvc3MocmksIHRtcCk7CiAgICAgIHUudnN1Yih0bXAsIHUpOyAvLyBGID0gLSBrICogKCB4IC0gTCApIC0gRCAqICggdSApCgogICAgICByX3VuaXQuc2NhbGUoLWsgKiAocmxlbiAtIGwpIC0gZCAqIHUuZG90KHJfdW5pdCksIGYpOyAvLyBBZGQgZm9yY2VzIHRvIGJvZGllcwoKICAgICAgYm9keUEuZm9yY2UudnN1YihmLCBib2R5QS5mb3JjZSk7CiAgICAgIGJvZHlCLmZvcmNlLnZhZGQoZiwgYm9keUIuZm9yY2UpOyAvLyBBbmd1bGFyIGZvcmNlCgogICAgICByaS5jcm9zcyhmLCByaV94X2YpOwogICAgICByai5jcm9zcyhmLCByal94X2YpOwogICAgICBib2R5QS50b3JxdWUudnN1YihyaV94X2YsIGJvZHlBLnRvcnF1ZSk7CiAgICAgIGJvZHlCLnRvcnF1ZS52YWRkKHJqX3hfZiwgYm9keUIudG9ycXVlKTsKICAgIH0KCiAgfQogIGNvbnN0IGFwcGx5Rm9yY2VfciA9IG5ldyBWZWMzKCk7CiAgY29uc3QgYXBwbHlGb3JjZV9yX3VuaXQgPSBuZXcgVmVjMygpOwogIGNvbnN0IGFwcGx5Rm9yY2VfdSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgYXBwbHlGb3JjZV9mID0gbmV3IFZlYzMoKTsKICBjb25zdCBhcHBseUZvcmNlX3dvcmxkQW5jaG9yQSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgYXBwbHlGb3JjZV93b3JsZEFuY2hvckIgPSBuZXcgVmVjMygpOwogIGNvbnN0IGFwcGx5Rm9yY2VfcmkgPSBuZXcgVmVjMygpOwogIGNvbnN0IGFwcGx5Rm9yY2VfcmogPSBuZXcgVmVjMygpOwogIGNvbnN0IGFwcGx5Rm9yY2VfcmlfeF9mID0gbmV3IFZlYzMoKTsKICBjb25zdCBhcHBseUZvcmNlX3JqX3hfZiA9IG5ldyBWZWMzKCk7CiAgY29uc3QgYXBwbHlGb3JjZV90bXAgPSBuZXcgVmVjMygpOwoKICAvKioKICAgKiBXaGVlbEluZm8KICAgKi8KICBjbGFzcyBXaGVlbEluZm8gewogICAgLyoqCiAgICAgKiBNYXggdHJhdmVsIGRpc3RhbmNlIG9mIHRoZSBzdXNwZW5zaW9uLCBpbiBtZXRlcnMuCiAgICAgKiBAZGVmYXVsdCAxCiAgICAgKi8KCiAgICAvKioKICAgICAqIFNwZWVkIHRvIGFwcGx5IHRvIHRoZSB3aGVlbCByb3RhdGlvbiB3aGVuIHRoZSB3aGVlbCBpcyBzbGlkaW5nLgogICAgICogQGRlZmF1bHQgLTAuMQogICAgICovCgogICAgLyoqCiAgICAgKiBJZiB0aGUgY3VzdG9tU2xpZGluZ1JvdGF0aW9uYWxTcGVlZCBzaG91bGQgYmUgdXNlZC4KICAgICAqIEBkZWZhdWx0IGZhbHNlCiAgICAgKi8KCiAgICAvKioKICAgICAqIHNsaWRpbmcKICAgICAqLwoKICAgIC8qKgogICAgICogQ29ubmVjdGlvbiBwb2ludCwgZGVmaW5lZCBsb2NhbGx5IGluIHRoZSBjaGFzc2lzIGJvZHkgZnJhbWUuCiAgICAgKi8KCiAgICAvKioKICAgICAqIGNoYXNzaXNDb25uZWN0aW9uUG9pbnRXb3JsZAogICAgICovCgogICAgLyoqCiAgICAgKiBkaXJlY3Rpb25Mb2NhbAogICAgICovCgogICAgLyoqCiAgICAgKiBkaXJlY3Rpb25Xb3JsZAogICAgICovCgogICAgLyoqCiAgICAgKiBheGxlTG9jYWwKICAgICAqLwoKICAgIC8qKgogICAgICogYXhsZVdvcmxkCiAgICAgKi8KCiAgICAvKioKICAgICAqIHN1c3BlbnNpb25SZXN0TGVuZ3RoCiAgICAgKiBAZGVmYXVsdCAxCiAgICAgKi8KCiAgICAvKioKICAgICAqIHN1c3BlbnNpb25NYXhMZW5ndGgKICAgICAqIEBkZWZhdWx0IDIKICAgICAqLwoKICAgIC8qKgogICAgICogcmFkaXVzCiAgICAgKiBAZGVmYXVsdCAxCiAgICAgKi8KCiAgICAvKioKICAgICAqIHN1c3BlbnNpb25TdGlmZm5lc3MKICAgICAqIEBkZWZhdWx0IDEwMAogICAgICovCgogICAgLyoqCiAgICAgKiBkYW1waW5nQ29tcHJlc3Npb24KICAgICAqIEBkZWZhdWx0IDEwCiAgICAgKi8KCiAgICAvKioKICAgICAqIGRhbXBpbmdSZWxheGF0aW9uCiAgICAgKiBAZGVmYXVsdCAxMAogICAgICovCgogICAgLyoqCiAgICAgKiBmcmljdGlvblNsaXAKICAgICAqIEBkZWZhdWx0IDEwLjUKICAgICAqLwoKICAgIC8qKiBmb3J3YXJkQWNjZWxlcmF0aW9uICovCgogICAgLyoqIHNpZGVBY2NlbGVyYXRpb24gKi8KCiAgICAvKioKICAgICAqIHN0ZWVyaW5nCiAgICAgKiBAZGVmYXVsdCAwCiAgICAgKi8KCiAgICAvKioKICAgICAqIFJvdGF0aW9uIHZhbHVlLCBpbiByYWRpYW5zLgogICAgICogQGRlZmF1bHQgMAogICAgICovCgogICAgLyoqCiAgICAgKiBkZWx0YVJvdGF0aW9uCiAgICAgKiBAZGVmYXVsdCAwCiAgICAgKi8KCiAgICAvKioKICAgICAqIHJvbGxJbmZsdWVuY2UKICAgICAqIEBkZWZhdWx0IDAuMDEKICAgICAqLwoKICAgIC8qKgogICAgICogbWF4U3VzcGVuc2lvbkZvcmNlCiAgICAgKi8KCiAgICAvKioKICAgICAqIGVuZ2luZUZvcmNlCiAgICAgKi8KCiAgICAvKioKICAgICAqIGJyYWtlCiAgICAgKi8KCiAgICAvKioKICAgICAqIGlzRnJvbnRXaGVlbAogICAgICogQGRlZmF1bHQgdHJ1ZQogICAgICovCgogICAgLyoqCiAgICAgKiBjbGlwcGVkSW52Q29udGFjdERvdFN1c3BlbnNpb24KICAgICAqIEBkZWZhdWx0IDEKICAgICAqLwoKICAgIC8qKgogICAgICogc3VzcGVuc2lvblJlbGF0aXZlVmVsb2NpdHkKICAgICAqIEBkZWZhdWx0IDAKICAgICAqLwoKICAgIC8qKgogICAgICogc3VzcGVuc2lvbkZvcmNlCiAgICAgKiBAZGVmYXVsdCAwCiAgICAgKi8KCiAgICAvKioKICAgICAqIHNsaXBJbmZvCiAgICAgKi8KCiAgICAvKioKICAgICAqIHNraWRJbmZvCiAgICAgKiBAZGVmYXVsdCAwCiAgICAgKi8KCiAgICAvKioKICAgICAqIHN1c3BlbnNpb25MZW5ndGgKICAgICAqIEBkZWZhdWx0IDAKICAgICAqLwoKICAgIC8qKgogICAgICogc2lkZUltcHVsc2UKICAgICAqLwoKICAgIC8qKgogICAgICogZm9yd2FyZEltcHVsc2UKICAgICAqLwoKICAgIC8qKgogICAgICogVGhlIHJlc3VsdCBmcm9tIHJheWNhc3RpbmcuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFdoZWVsIHdvcmxkIHRyYW5zZm9ybS4KICAgICAqLwoKICAgIC8qKgogICAgICogaXNJbkNvbnRhY3QKICAgICAqLwogICAgY29uc3RydWN0b3Iob3B0aW9ucykgewogICAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7CiAgICAgICAgb3B0aW9ucyA9IHt9OwogICAgICB9CgogICAgICBvcHRpb25zID0gVXRpbHMuZGVmYXVsdHMob3B0aW9ucywgewogICAgICAgIGNoYXNzaXNDb25uZWN0aW9uUG9pbnRMb2NhbDogbmV3IFZlYzMoKSwKICAgICAgICBjaGFzc2lzQ29ubmVjdGlvblBvaW50V29ybGQ6IG5ldyBWZWMzKCksCiAgICAgICAgZGlyZWN0aW9uTG9jYWw6IG5ldyBWZWMzKCksCiAgICAgICAgZGlyZWN0aW9uV29ybGQ6IG5ldyBWZWMzKCksCiAgICAgICAgYXhsZUxvY2FsOiBuZXcgVmVjMygpLAogICAgICAgIGF4bGVXb3JsZDogbmV3IFZlYzMoKSwKICAgICAgICBzdXNwZW5zaW9uUmVzdExlbmd0aDogMSwKICAgICAgICBzdXNwZW5zaW9uTWF4TGVuZ3RoOiAyLAogICAgICAgIHJhZGl1czogMSwKICAgICAgICBzdXNwZW5zaW9uU3RpZmZuZXNzOiAxMDAsCiAgICAgICAgZGFtcGluZ0NvbXByZXNzaW9uOiAxMCwKICAgICAgICBkYW1waW5nUmVsYXhhdGlvbjogMTAsCiAgICAgICAgZnJpY3Rpb25TbGlwOiAxMC41LAogICAgICAgIGZvcndhcmRBY2NlbGVyYXRpb246IDEsCiAgICAgICAgc2lkZUFjY2VsZXJhdGlvbjogMSwKICAgICAgICBzdGVlcmluZzogMCwKICAgICAgICByb3RhdGlvbjogMCwKICAgICAgICBkZWx0YVJvdGF0aW9uOiAwLAogICAgICAgIHJvbGxJbmZsdWVuY2U6IDAuMDEsCiAgICAgICAgbWF4U3VzcGVuc2lvbkZvcmNlOiBOdW1iZXIuTUFYX1ZBTFVFLAogICAgICAgIGlzRnJvbnRXaGVlbDogdHJ1ZSwKICAgICAgICBjbGlwcGVkSW52Q29udGFjdERvdFN1c3BlbnNpb246IDEsCiAgICAgICAgc3VzcGVuc2lvblJlbGF0aXZlVmVsb2NpdHk6IDAsCiAgICAgICAgc3VzcGVuc2lvbkZvcmNlOiAwLAogICAgICAgIHNsaXBJbmZvOiAwLAogICAgICAgIHNraWRJbmZvOiAwLAogICAgICAgIHN1c3BlbnNpb25MZW5ndGg6IDAsCiAgICAgICAgbWF4U3VzcGVuc2lvblRyYXZlbDogMSwKICAgICAgICB1c2VDdXN0b21TbGlkaW5nUm90YXRpb25hbFNwZWVkOiBmYWxzZSwKICAgICAgICBjdXN0b21TbGlkaW5nUm90YXRpb25hbFNwZWVkOiAtMC4xCiAgICAgIH0pOwogICAgICB0aGlzLm1heFN1c3BlbnNpb25UcmF2ZWwgPSBvcHRpb25zLm1heFN1c3BlbnNpb25UcmF2ZWw7CiAgICAgIHRoaXMuY3VzdG9tU2xpZGluZ1JvdGF0aW9uYWxTcGVlZCA9IG9wdGlvbnMuY3VzdG9tU2xpZGluZ1JvdGF0aW9uYWxTcGVlZDsKICAgICAgdGhpcy51c2VDdXN0b21TbGlkaW5nUm90YXRpb25hbFNwZWVkID0gb3B0aW9ucy51c2VDdXN0b21TbGlkaW5nUm90YXRpb25hbFNwZWVkOwogICAgICB0aGlzLnNsaWRpbmcgPSBmYWxzZTsKICAgICAgdGhpcy5jaGFzc2lzQ29ubmVjdGlvblBvaW50TG9jYWwgPSBvcHRpb25zLmNoYXNzaXNDb25uZWN0aW9uUG9pbnRMb2NhbC5jbG9uZSgpOwogICAgICB0aGlzLmNoYXNzaXNDb25uZWN0aW9uUG9pbnRXb3JsZCA9IG9wdGlvbnMuY2hhc3Npc0Nvbm5lY3Rpb25Qb2ludFdvcmxkLmNsb25lKCk7CiAgICAgIHRoaXMuZGlyZWN0aW9uTG9jYWwgPSBvcHRpb25zLmRpcmVjdGlvbkxvY2FsLmNsb25lKCk7CiAgICAgIHRoaXMuZGlyZWN0aW9uV29ybGQgPSBvcHRpb25zLmRpcmVjdGlvbldvcmxkLmNsb25lKCk7CiAgICAgIHRoaXMuYXhsZUxvY2FsID0gb3B0aW9ucy5heGxlTG9jYWwuY2xvbmUoKTsKICAgICAgdGhpcy5heGxlV29ybGQgPSBvcHRpb25zLmF4bGVXb3JsZC5jbG9uZSgpOwogICAgICB0aGlzLnN1c3BlbnNpb25SZXN0TGVuZ3RoID0gb3B0aW9ucy5zdXNwZW5zaW9uUmVzdExlbmd0aDsKICAgICAgdGhpcy5zdXNwZW5zaW9uTWF4TGVuZ3RoID0gb3B0aW9ucy5zdXNwZW5zaW9uTWF4TGVuZ3RoOwogICAgICB0aGlzLnJhZGl1cyA9IG9wdGlvbnMucmFkaXVzOwogICAgICB0aGlzLnN1c3BlbnNpb25TdGlmZm5lc3MgPSBvcHRpb25zLnN1c3BlbnNpb25TdGlmZm5lc3M7CiAgICAgIHRoaXMuZGFtcGluZ0NvbXByZXNzaW9uID0gb3B0aW9ucy5kYW1waW5nQ29tcHJlc3Npb247CiAgICAgIHRoaXMuZGFtcGluZ1JlbGF4YXRpb24gPSBvcHRpb25zLmRhbXBpbmdSZWxheGF0aW9uOwogICAgICB0aGlzLmZyaWN0aW9uU2xpcCA9IG9wdGlvbnMuZnJpY3Rpb25TbGlwOwogICAgICB0aGlzLmZvcndhcmRBY2NlbGVyYXRpb24gPSBvcHRpb25zLmZvcndhcmRBY2NlbGVyYXRpb247CiAgICAgIHRoaXMuc2lkZUFjY2VsZXJhdGlvbiA9IG9wdGlvbnMuc2lkZUFjY2VsZXJhdGlvbjsKICAgICAgdGhpcy5zdGVlcmluZyA9IDA7CiAgICAgIHRoaXMucm90YXRpb24gPSAwOwogICAgICB0aGlzLmRlbHRhUm90YXRpb24gPSAwOwogICAgICB0aGlzLnJvbGxJbmZsdWVuY2UgPSBvcHRpb25zLnJvbGxJbmZsdWVuY2U7CiAgICAgIHRoaXMubWF4U3VzcGVuc2lvbkZvcmNlID0gb3B0aW9ucy5tYXhTdXNwZW5zaW9uRm9yY2U7CiAgICAgIHRoaXMuZW5naW5lRm9yY2UgPSAwOwogICAgICB0aGlzLmJyYWtlID0gMDsKICAgICAgdGhpcy5pc0Zyb250V2hlZWwgPSBvcHRpb25zLmlzRnJvbnRXaGVlbDsKICAgICAgdGhpcy5jbGlwcGVkSW52Q29udGFjdERvdFN1c3BlbnNpb24gPSAxOwogICAgICB0aGlzLnN1c3BlbnNpb25SZWxhdGl2ZVZlbG9jaXR5ID0gMDsKICAgICAgdGhpcy5zdXNwZW5zaW9uRm9yY2UgPSAwOwogICAgICB0aGlzLnNsaXBJbmZvID0gMDsKICAgICAgdGhpcy5za2lkSW5mbyA9IDA7CiAgICAgIHRoaXMuc3VzcGVuc2lvbkxlbmd0aCA9IDA7CiAgICAgIHRoaXMuc2lkZUltcHVsc2UgPSAwOwogICAgICB0aGlzLmZvcndhcmRJbXB1bHNlID0gMDsKICAgICAgdGhpcy5yYXljYXN0UmVzdWx0ID0gbmV3IFJheWNhc3RSZXN1bHQoKTsKICAgICAgdGhpcy53b3JsZFRyYW5zZm9ybSA9IG5ldyBUcmFuc2Zvcm0oKTsKICAgICAgdGhpcy5pc0luQ29udGFjdCA9IGZhbHNlOwogICAgfQoKICAgIHVwZGF0ZVdoZWVsKGNoYXNzaXMpIHsKICAgICAgY29uc3QgcmF5Y2FzdFJlc3VsdCA9IHRoaXMucmF5Y2FzdFJlc3VsdDsKCiAgICAgIGlmICh0aGlzLmlzSW5Db250YWN0KSB7CiAgICAgICAgY29uc3QgcHJvamVjdCA9IHJheWNhc3RSZXN1bHQuaGl0Tm9ybWFsV29ybGQuZG90KHJheWNhc3RSZXN1bHQuZGlyZWN0aW9uV29ybGQpOwogICAgICAgIHJheWNhc3RSZXN1bHQuaGl0UG9pbnRXb3JsZC52c3ViKGNoYXNzaXMucG9zaXRpb24sIHJlbHBvcyk7CiAgICAgICAgY2hhc3Npcy5nZXRWZWxvY2l0eUF0V29ybGRQb2ludChyZWxwb3MsIGNoYXNzaXNfdmVsb2NpdHlfYXRfY29udGFjdFBvaW50KTsKICAgICAgICBjb25zdCBwcm9qVmVsID0gcmF5Y2FzdFJlc3VsdC5oaXROb3JtYWxXb3JsZC5kb3QoY2hhc3Npc192ZWxvY2l0eV9hdF9jb250YWN0UG9pbnQpOwoKICAgICAgICBpZiAocHJvamVjdCA+PSAtMC4xKSB7CiAgICAgICAgICB0aGlzLnN1c3BlbnNpb25SZWxhdGl2ZVZlbG9jaXR5ID0gMC4wOwogICAgICAgICAgdGhpcy5jbGlwcGVkSW52Q29udGFjdERvdFN1c3BlbnNpb24gPSAxLjAgLyAwLjE7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbnN0IGludiA9IC0xIC8gcHJvamVjdDsKICAgICAgICAgIHRoaXMuc3VzcGVuc2lvblJlbGF0aXZlVmVsb2NpdHkgPSBwcm9qVmVsICogaW52OwogICAgICAgICAgdGhpcy5jbGlwcGVkSW52Q29udGFjdERvdFN1c3BlbnNpb24gPSBpbnY7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIC8vIE5vdCBpbiBjb250YWN0IDogcG9zaXRpb24gd2hlZWwgaW4gYSBuaWNlIChyZXN0IGxlbmd0aCkgcG9zaXRpb24KICAgICAgICByYXljYXN0UmVzdWx0LnN1c3BlbnNpb25MZW5ndGggPSB0aGlzLnN1c3BlbnNpb25SZXN0TGVuZ3RoOwogICAgICAgIHRoaXMuc3VzcGVuc2lvblJlbGF0aXZlVmVsb2NpdHkgPSAwLjA7CiAgICAgICAgcmF5Y2FzdFJlc3VsdC5kaXJlY3Rpb25Xb3JsZC5zY2FsZSgtMSwgcmF5Y2FzdFJlc3VsdC5oaXROb3JtYWxXb3JsZCk7CiAgICAgICAgdGhpcy5jbGlwcGVkSW52Q29udGFjdERvdFN1c3BlbnNpb24gPSAxLjA7CiAgICAgIH0KICAgIH0KCiAgfQogIGNvbnN0IGNoYXNzaXNfdmVsb2NpdHlfYXRfY29udGFjdFBvaW50ID0gbmV3IFZlYzMoKTsKICBjb25zdCByZWxwb3MgPSBuZXcgVmVjMygpOwoKICAvKioKICAgKiBWZWhpY2xlIGhlbHBlciBjbGFzcyB0aGF0IGNhc3RzIHJheXMgZnJvbSB0aGUgd2hlZWwgcG9zaXRpb25zIHRvd2FyZHMgdGhlIGdyb3VuZCBhbmQgYXBwbGllcyBmb3JjZXMuCiAgICovCiAgY2xhc3MgUmF5Y2FzdFZlaGljbGUgewogICAgLyoqIFRoZSBjYXIgY2hhc3NpcyBib2R5LiAqLwoKICAgIC8qKiBUaGUgd2hlZWxzLiAqLwoKICAgIC8qKiBXaWxsIGJlIHNldCB0byB0cnVlIGlmIHRoZSBjYXIgaXMgc2xpZGluZy4gKi8KCiAgICAvKiogSW5kZXggb2YgdGhlIHJpZ2h0IGF4aXMuIHg9MCwgeT0xLCB6PTIgKi8KCiAgICAvKiogSW5kZXggb2YgdGhlIGZvcndhcmQgYXhpcy4geD0wLCB5PTEsIHo9MiAqLwoKICAgIC8qKiBJbmRleCBvZiB0aGUgdXAgYXhpcy4geD0wLCB5PTEsIHo9MiAqLwoKICAgIC8qKiBUaGUgY29uc3RyYWludHMuICovCgogICAgLyoqIE9wdGlvbmFsIHByZS1zdGVwIGNhbGxiYWNrLiAqLwoKICAgIC8qKiBOdW1iZXIgb2Ygd2hlZWxzIG9uIHRoZSBncm91bmQuICovCiAgICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7CiAgICAgIHRoaXMuY2hhc3Npc0JvZHkgPSBvcHRpb25zLmNoYXNzaXNCb2R5OwogICAgICB0aGlzLndoZWVsSW5mb3MgPSBbXTsKICAgICAgdGhpcy5zbGlkaW5nID0gZmFsc2U7CiAgICAgIHRoaXMud29ybGQgPSBudWxsOwogICAgICB0aGlzLmluZGV4UmlnaHRBeGlzID0gdHlwZW9mIG9wdGlvbnMuaW5kZXhSaWdodEF4aXMgIT09ICd1bmRlZmluZWQnID8gb3B0aW9ucy5pbmRleFJpZ2h0QXhpcyA6IDI7CiAgICAgIHRoaXMuaW5kZXhGb3J3YXJkQXhpcyA9IHR5cGVvZiBvcHRpb25zLmluZGV4Rm9yd2FyZEF4aXMgIT09ICd1bmRlZmluZWQnID8gb3B0aW9ucy5pbmRleEZvcndhcmRBeGlzIDogMDsKICAgICAgdGhpcy5pbmRleFVwQXhpcyA9IHR5cGVvZiBvcHRpb25zLmluZGV4VXBBeGlzICE9PSAndW5kZWZpbmVkJyA/IG9wdGlvbnMuaW5kZXhVcEF4aXMgOiAxOwogICAgICB0aGlzLmNvbnN0cmFpbnRzID0gW107CgogICAgICB0aGlzLnByZVN0ZXBDYWxsYmFjayA9ICgpID0+IHt9OwoKICAgICAgdGhpcy5jdXJyZW50VmVoaWNsZVNwZWVkS21Ib3VyID0gMDsKICAgICAgdGhpcy5udW1XaGVlbHNPbkdyb3VuZCA9IDA7CiAgICB9CiAgICAvKioKICAgICAqIEFkZCBhIHdoZWVsLiBGb3IgaW5mb3JtYXRpb24gYWJvdXQgdGhlIG9wdGlvbnMsIHNlZSBgV2hlZWxJbmZvYC4KICAgICAqLwoKCiAgICBhZGRXaGVlbChvcHRpb25zKSB7CiAgICAgIGlmIChvcHRpb25zID09PSB2b2lkIDApIHsKICAgICAgICBvcHRpb25zID0ge307CiAgICAgIH0KCiAgICAgIGNvbnN0IGluZm8gPSBuZXcgV2hlZWxJbmZvKG9wdGlvbnMpOwogICAgICBjb25zdCBpbmRleCA9IHRoaXMud2hlZWxJbmZvcy5sZW5ndGg7CiAgICAgIHRoaXMud2hlZWxJbmZvcy5wdXNoKGluZm8pOwogICAgICByZXR1cm4gaW5kZXg7CiAgICB9CiAgICAvKioKICAgICAqIFNldCB0aGUgc3RlZXJpbmcgdmFsdWUgb2YgYSB3aGVlbC4KICAgICAqLwoKCiAgICBzZXRTdGVlcmluZ1ZhbHVlKHZhbHVlLCB3aGVlbEluZGV4KSB7CiAgICAgIGNvbnN0IHdoZWVsID0gdGhpcy53aGVlbEluZm9zW3doZWVsSW5kZXhdOwogICAgICB3aGVlbC5zdGVlcmluZyA9IHZhbHVlOwogICAgfQogICAgLyoqCiAgICAgKiBTZXQgdGhlIHdoZWVsIGZvcmNlIHRvIGFwcGx5IG9uIG9uZSBvZiB0aGUgd2hlZWxzIGVhY2ggdGltZSBzdGVwCiAgICAgKi8KCgogICAgYXBwbHlFbmdpbmVGb3JjZSh2YWx1ZSwgd2hlZWxJbmRleCkgewogICAgICB0aGlzLndoZWVsSW5mb3Nbd2hlZWxJbmRleF0uZW5naW5lRm9yY2UgPSB2YWx1ZTsKICAgIH0KICAgIC8qKgogICAgICogU2V0IHRoZSBicmFraW5nIGZvcmNlIG9mIGEgd2hlZWwKICAgICAqLwoKCiAgICBzZXRCcmFrZShicmFrZSwgd2hlZWxJbmRleCkgewogICAgICB0aGlzLndoZWVsSW5mb3Nbd2hlZWxJbmRleF0uYnJha2UgPSBicmFrZTsKICAgIH0KICAgIC8qKgogICAgICogQWRkIHRoZSB2ZWhpY2xlIGluY2x1ZGluZyBpdHMgY29uc3RyYWludHMgdG8gdGhlIHdvcmxkLgogICAgICovCgoKICAgIGFkZFRvV29ybGQod29ybGQpIHsKICAgICAgd29ybGQuYWRkQm9keSh0aGlzLmNoYXNzaXNCb2R5KTsKICAgICAgY29uc3QgdGhhdCA9IHRoaXM7CgogICAgICB0aGlzLnByZVN0ZXBDYWxsYmFjayA9ICgpID0+IHsKICAgICAgICB0aGF0LnVwZGF0ZVZlaGljbGUod29ybGQuZHQpOwogICAgICB9OwoKICAgICAgd29ybGQuYWRkRXZlbnRMaXN0ZW5lcigncHJlU3RlcCcsIHRoaXMucHJlU3RlcENhbGxiYWNrKTsKICAgICAgdGhpcy53b3JsZCA9IHdvcmxkOwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgb25lIG9mIHRoZSB3aGVlbCBheGxlcywgd29ybGQtb3JpZW50ZWQuCiAgICAgKi8KCgogICAgZ2V0VmVoaWNsZUF4aXNXb3JsZChheGlzSW5kZXgsIHJlc3VsdCkgewogICAgICByZXN1bHQuc2V0KGF4aXNJbmRleCA9PT0gMCA/IDEgOiAwLCBheGlzSW5kZXggPT09IDEgPyAxIDogMCwgYXhpc0luZGV4ID09PSAyID8gMSA6IDApOwogICAgICB0aGlzLmNoYXNzaXNCb2R5LnZlY3RvclRvV29ybGRGcmFtZShyZXN1bHQsIHJlc3VsdCk7CiAgICB9CgogICAgdXBkYXRlVmVoaWNsZSh0aW1lU3RlcCkgewogICAgICBjb25zdCB3aGVlbEluZm9zID0gdGhpcy53aGVlbEluZm9zOwogICAgICBjb25zdCBudW1XaGVlbHMgPSB3aGVlbEluZm9zLmxlbmd0aDsKICAgICAgY29uc3QgY2hhc3Npc0JvZHkgPSB0aGlzLmNoYXNzaXNCb2R5OwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBudW1XaGVlbHM7IGkrKykgewogICAgICAgIHRoaXMudXBkYXRlV2hlZWxUcmFuc2Zvcm0oaSk7CiAgICAgIH0KCiAgICAgIHRoaXMuY3VycmVudFZlaGljbGVTcGVlZEttSG91ciA9IDMuNiAqIGNoYXNzaXNCb2R5LnZlbG9jaXR5Lmxlbmd0aCgpOwogICAgICBjb25zdCBmb3J3YXJkV29ybGQgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLmdldFZlaGljbGVBeGlzV29ybGQodGhpcy5pbmRleEZvcndhcmRBeGlzLCBmb3J3YXJkV29ybGQpOwoKICAgICAgaWYgKGZvcndhcmRXb3JsZC5kb3QoY2hhc3Npc0JvZHkudmVsb2NpdHkpIDwgMCkgewogICAgICAgIHRoaXMuY3VycmVudFZlaGljbGVTcGVlZEttSG91ciAqPSAtMTsKICAgICAgfSAvLyBzaW11bGF0ZSBzdXNwZW5zaW9uCgoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBudW1XaGVlbHM7IGkrKykgewogICAgICAgIHRoaXMuY2FzdFJheSh3aGVlbEluZm9zW2ldKTsKICAgICAgfQoKICAgICAgdGhpcy51cGRhdGVTdXNwZW5zaW9uKHRpbWVTdGVwKTsKICAgICAgY29uc3QgaW1wdWxzZSA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IHJlbHBvcyA9IG5ldyBWZWMzKCk7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG51bVdoZWVsczsgaSsrKSB7CiAgICAgICAgLy9hcHBseSBzdXNwZW5zaW9uIGZvcmNlCiAgICAgICAgY29uc3Qgd2hlZWwgPSB3aGVlbEluZm9zW2ldOwogICAgICAgIGxldCBzdXNwZW5zaW9uRm9yY2UgPSB3aGVlbC5zdXNwZW5zaW9uRm9yY2U7CgogICAgICAgIGlmIChzdXNwZW5zaW9uRm9yY2UgPiB3aGVlbC5tYXhTdXNwZW5zaW9uRm9yY2UpIHsKICAgICAgICAgIHN1c3BlbnNpb25Gb3JjZSA9IHdoZWVsLm1heFN1c3BlbnNpb25Gb3JjZTsKICAgICAgICB9CgogICAgICAgIHdoZWVsLnJheWNhc3RSZXN1bHQuaGl0Tm9ybWFsV29ybGQuc2NhbGUoc3VzcGVuc2lvbkZvcmNlICogdGltZVN0ZXAsIGltcHVsc2UpOwogICAgICAgIHdoZWVsLnJheWNhc3RSZXN1bHQuaGl0UG9pbnRXb3JsZC52c3ViKGNoYXNzaXNCb2R5LnBvc2l0aW9uLCByZWxwb3MpOwogICAgICAgIGNoYXNzaXNCb2R5LmFwcGx5SW1wdWxzZShpbXB1bHNlLCByZWxwb3MpOwogICAgICB9CgogICAgICB0aGlzLnVwZGF0ZUZyaWN0aW9uKHRpbWVTdGVwKTsKICAgICAgY29uc3QgaGl0Tm9ybWFsV29ybGRTY2FsZWRXaXRoUHJvaiA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IGZ3ZCA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IHZlbCA9IG5ldyBWZWMzKCk7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG51bVdoZWVsczsgaSsrKSB7CiAgICAgICAgY29uc3Qgd2hlZWwgPSB3aGVlbEluZm9zW2ldOyAvL2NvbnN0IHJlbHBvcyA9IG5ldyBWZWMzKCk7CiAgICAgICAgLy93aGVlbC5jaGFzc2lzQ29ubmVjdGlvblBvaW50V29ybGQudnN1YihjaGFzc2lzQm9keS5wb3NpdGlvbiwgcmVscG9zKTsKCiAgICAgICAgY2hhc3Npc0JvZHkuZ2V0VmVsb2NpdHlBdFdvcmxkUG9pbnQod2hlZWwuY2hhc3Npc0Nvbm5lY3Rpb25Qb2ludFdvcmxkLCB2ZWwpOyAvLyBIYWNrIHRvIGdldCB0aGUgcm90YXRpb24gaW4gdGhlIGNvcnJlY3QgZGlyZWN0aW9uCgogICAgICAgIGxldCBtID0gMTsKCiAgICAgICAgc3dpdGNoICh0aGlzLmluZGV4VXBBeGlzKSB7CiAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgIG0gPSAtMTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgICBpZiAod2hlZWwuaXNJbkNvbnRhY3QpIHsKICAgICAgICAgIHRoaXMuZ2V0VmVoaWNsZUF4aXNXb3JsZCh0aGlzLmluZGV4Rm9yd2FyZEF4aXMsIGZ3ZCk7CiAgICAgICAgICBjb25zdCBwcm9qID0gZndkLmRvdCh3aGVlbC5yYXljYXN0UmVzdWx0LmhpdE5vcm1hbFdvcmxkKTsKICAgICAgICAgIHdoZWVsLnJheWNhc3RSZXN1bHQuaGl0Tm9ybWFsV29ybGQuc2NhbGUocHJvaiwgaGl0Tm9ybWFsV29ybGRTY2FsZWRXaXRoUHJvaik7CiAgICAgICAgICBmd2QudnN1YihoaXROb3JtYWxXb3JsZFNjYWxlZFdpdGhQcm9qLCBmd2QpOwogICAgICAgICAgY29uc3QgcHJvajIgPSBmd2QuZG90KHZlbCk7CiAgICAgICAgICB3aGVlbC5kZWx0YVJvdGF0aW9uID0gbSAqIHByb2oyICogdGltZVN0ZXAgLyB3aGVlbC5yYWRpdXM7CiAgICAgICAgfQoKICAgICAgICBpZiAoKHdoZWVsLnNsaWRpbmcgfHwgIXdoZWVsLmlzSW5Db250YWN0KSAmJiB3aGVlbC5lbmdpbmVGb3JjZSAhPT0gMCAmJiB3aGVlbC51c2VDdXN0b21TbGlkaW5nUm90YXRpb25hbFNwZWVkKSB7CiAgICAgICAgICAvLyBBcHBseSBjdXN0b20gcm90YXRpb24gd2hlbiBhY2NlbGVyYXRpbmcgYW5kIHNsaWRpbmcKICAgICAgICAgIHdoZWVsLmRlbHRhUm90YXRpb24gPSAod2hlZWwuZW5naW5lRm9yY2UgPiAwID8gMSA6IC0xKSAqIHdoZWVsLmN1c3RvbVNsaWRpbmdSb3RhdGlvbmFsU3BlZWQgKiB0aW1lU3RlcDsKICAgICAgICB9IC8vIExvY2sgd2hlZWxzCgoKICAgICAgICBpZiAoTWF0aC5hYnMod2hlZWwuYnJha2UpID4gTWF0aC5hYnMod2hlZWwuZW5naW5lRm9yY2UpKSB7CiAgICAgICAgICB3aGVlbC5kZWx0YVJvdGF0aW9uID0gMDsKICAgICAgICB9CgogICAgICAgIHdoZWVsLnJvdGF0aW9uICs9IHdoZWVsLmRlbHRhUm90YXRpb247IC8vIFVzZSB0aGUgb2xkIHZhbHVlCgogICAgICAgIHdoZWVsLmRlbHRhUm90YXRpb24gKj0gMC45OTsgLy8gZGFtcGluZyBvZiByb3RhdGlvbiB3aGVuIG5vdCBpbiBjb250YWN0CiAgICAgIH0KICAgIH0KCiAgICB1cGRhdGVTdXNwZW5zaW9uKGRlbHRhVGltZSkgewogICAgICBjb25zdCBjaGFzc2lzQm9keSA9IHRoaXMuY2hhc3Npc0JvZHk7CiAgICAgIGNvbnN0IGNoYXNzaXNNYXNzID0gY2hhc3Npc0JvZHkubWFzczsKICAgICAgY29uc3Qgd2hlZWxJbmZvcyA9IHRoaXMud2hlZWxJbmZvczsKICAgICAgY29uc3QgbnVtV2hlZWxzID0gd2hlZWxJbmZvcy5sZW5ndGg7CgogICAgICBmb3IgKGxldCB3X2l0ID0gMDsgd19pdCA8IG51bVdoZWVsczsgd19pdCsrKSB7CiAgICAgICAgY29uc3Qgd2hlZWwgPSB3aGVlbEluZm9zW3dfaXRdOwoKICAgICAgICBpZiAod2hlZWwuaXNJbkNvbnRhY3QpIHsKICAgICAgICAgIGxldCBmb3JjZTsgLy8gU3ByaW5nCgogICAgICAgICAgY29uc3Qgc3VzcF9sZW5ndGggPSB3aGVlbC5zdXNwZW5zaW9uUmVzdExlbmd0aDsKICAgICAgICAgIGNvbnN0IGN1cnJlbnRfbGVuZ3RoID0gd2hlZWwuc3VzcGVuc2lvbkxlbmd0aDsKICAgICAgICAgIGNvbnN0IGxlbmd0aF9kaWZmID0gc3VzcF9sZW5ndGggLSBjdXJyZW50X2xlbmd0aDsKICAgICAgICAgIGZvcmNlID0gd2hlZWwuc3VzcGVuc2lvblN0aWZmbmVzcyAqIGxlbmd0aF9kaWZmICogd2hlZWwuY2xpcHBlZEludkNvbnRhY3REb3RTdXNwZW5zaW9uOyAvLyBEYW1wZXIKCiAgICAgICAgICBjb25zdCBwcm9qZWN0ZWRfcmVsX3ZlbCA9IHdoZWVsLnN1c3BlbnNpb25SZWxhdGl2ZVZlbG9jaXR5OwogICAgICAgICAgbGV0IHN1c3BfZGFtcGluZzsKCiAgICAgICAgICBpZiAocHJvamVjdGVkX3JlbF92ZWwgPCAwKSB7CiAgICAgICAgICAgIHN1c3BfZGFtcGluZyA9IHdoZWVsLmRhbXBpbmdDb21wcmVzc2lvbjsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHN1c3BfZGFtcGluZyA9IHdoZWVsLmRhbXBpbmdSZWxheGF0aW9uOwogICAgICAgICAgfQoKICAgICAgICAgIGZvcmNlIC09IHN1c3BfZGFtcGluZyAqIHByb2plY3RlZF9yZWxfdmVsOwogICAgICAgICAgd2hlZWwuc3VzcGVuc2lvbkZvcmNlID0gZm9yY2UgKiBjaGFzc2lzTWFzczsKCiAgICAgICAgICBpZiAod2hlZWwuc3VzcGVuc2lvbkZvcmNlIDwgMCkgewogICAgICAgICAgICB3aGVlbC5zdXNwZW5zaW9uRm9yY2UgPSAwOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB3aGVlbC5zdXNwZW5zaW9uRm9yY2UgPSAwOwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBSZW1vdmUgdGhlIHZlaGljbGUgaW5jbHVkaW5nIGl0cyBjb25zdHJhaW50cyBmcm9tIHRoZSB3b3JsZC4KICAgICAqLwoKCiAgICByZW1vdmVGcm9tV29ybGQod29ybGQpIHsKICAgICAgdGhpcy5jb25zdHJhaW50czsKICAgICAgd29ybGQucmVtb3ZlQm9keSh0aGlzLmNoYXNzaXNCb2R5KTsKICAgICAgd29ybGQucmVtb3ZlRXZlbnRMaXN0ZW5lcigncHJlU3RlcCcsIHRoaXMucHJlU3RlcENhbGxiYWNrKTsKICAgICAgdGhpcy53b3JsZCA9IG51bGw7CiAgICB9CgogICAgY2FzdFJheSh3aGVlbCkgewogICAgICBjb25zdCByYXl2ZWN0b3IgPSBjYXN0UmF5X3JheXZlY3RvcjsKICAgICAgY29uc3QgdGFyZ2V0ID0gY2FzdFJheV90YXJnZXQ7CiAgICAgIHRoaXMudXBkYXRlV2hlZWxUcmFuc2Zvcm1Xb3JsZCh3aGVlbCk7CiAgICAgIGNvbnN0IGNoYXNzaXNCb2R5ID0gdGhpcy5jaGFzc2lzQm9keTsKICAgICAgbGV0IGRlcHRoID0gLTE7CiAgICAgIGNvbnN0IHJheWxlbiA9IHdoZWVsLnN1c3BlbnNpb25SZXN0TGVuZ3RoICsgd2hlZWwucmFkaXVzOwogICAgICB3aGVlbC5kaXJlY3Rpb25Xb3JsZC5zY2FsZShyYXlsZW4sIHJheXZlY3Rvcik7CiAgICAgIGNvbnN0IHNvdXJjZSA9IHdoZWVsLmNoYXNzaXNDb25uZWN0aW9uUG9pbnRXb3JsZDsKICAgICAgc291cmNlLnZhZGQocmF5dmVjdG9yLCB0YXJnZXQpOwogICAgICBjb25zdCByYXljYXN0UmVzdWx0ID0gd2hlZWwucmF5Y2FzdFJlc3VsdDsKICAgICAgcmF5Y2FzdFJlc3VsdC5yZXNldCgpOyAvLyBUdXJuIG9mZiByYXkgY29sbGlzaW9uIHdpdGggdGhlIGNoYXNzaXMgdGVtcG9yYXJpbHkKCiAgICAgIGNvbnN0IG9sZFN0YXRlID0gY2hhc3Npc0JvZHkuY29sbGlzaW9uUmVzcG9uc2U7CiAgICAgIGNoYXNzaXNCb2R5LmNvbGxpc2lvblJlc3BvbnNlID0gZmFsc2U7IC8vIENhc3QgcmF5IGFnYWluc3Qgd29ybGQKCiAgICAgIHRoaXMud29ybGQucmF5VGVzdChzb3VyY2UsIHRhcmdldCwgcmF5Y2FzdFJlc3VsdCk7CiAgICAgIGNoYXNzaXNCb2R5LmNvbGxpc2lvblJlc3BvbnNlID0gb2xkU3RhdGU7CiAgICAgIGNvbnN0IG9iamVjdCA9IHJheWNhc3RSZXN1bHQuYm9keTsKICAgICAgd2hlZWwucmF5Y2FzdFJlc3VsdC5ncm91bmRPYmplY3QgPSAwOwoKICAgICAgaWYgKG9iamVjdCkgewogICAgICAgIGRlcHRoID0gcmF5Y2FzdFJlc3VsdC5kaXN0YW5jZTsKICAgICAgICB3aGVlbC5yYXljYXN0UmVzdWx0LmhpdE5vcm1hbFdvcmxkID0gcmF5Y2FzdFJlc3VsdC5oaXROb3JtYWxXb3JsZDsKICAgICAgICB3aGVlbC5pc0luQ29udGFjdCA9IHRydWU7CiAgICAgICAgY29uc3QgaGl0RGlzdGFuY2UgPSByYXljYXN0UmVzdWx0LmRpc3RhbmNlOwogICAgICAgIHdoZWVsLnN1c3BlbnNpb25MZW5ndGggPSBoaXREaXN0YW5jZSAtIHdoZWVsLnJhZGl1czsgLy8gY2xhbXAgb24gbWF4IHN1c3BlbnNpb24gdHJhdmVsCgogICAgICAgIGNvbnN0IG1pblN1c3BlbnNpb25MZW5ndGggPSB3aGVlbC5zdXNwZW5zaW9uUmVzdExlbmd0aCAtIHdoZWVsLm1heFN1c3BlbnNpb25UcmF2ZWw7CiAgICAgICAgY29uc3QgbWF4U3VzcGVuc2lvbkxlbmd0aCA9IHdoZWVsLnN1c3BlbnNpb25SZXN0TGVuZ3RoICsgd2hlZWwubWF4U3VzcGVuc2lvblRyYXZlbDsKCiAgICAgICAgaWYgKHdoZWVsLnN1c3BlbnNpb25MZW5ndGggPCBtaW5TdXNwZW5zaW9uTGVuZ3RoKSB7CiAgICAgICAgICB3aGVlbC5zdXNwZW5zaW9uTGVuZ3RoID0gbWluU3VzcGVuc2lvbkxlbmd0aDsKICAgICAgICB9CgogICAgICAgIGlmICh3aGVlbC5zdXNwZW5zaW9uTGVuZ3RoID4gbWF4U3VzcGVuc2lvbkxlbmd0aCkgewogICAgICAgICAgd2hlZWwuc3VzcGVuc2lvbkxlbmd0aCA9IG1heFN1c3BlbnNpb25MZW5ndGg7CiAgICAgICAgICB3aGVlbC5yYXljYXN0UmVzdWx0LnJlc2V0KCk7CiAgICAgICAgfQoKICAgICAgICBjb25zdCBkZW5vbWluYXRvciA9IHdoZWVsLnJheWNhc3RSZXN1bHQuaGl0Tm9ybWFsV29ybGQuZG90KHdoZWVsLmRpcmVjdGlvbldvcmxkKTsKICAgICAgICBjb25zdCBjaGFzc2lzX3ZlbG9jaXR5X2F0X2NvbnRhY3RQb2ludCA9IG5ldyBWZWMzKCk7CiAgICAgICAgY2hhc3Npc0JvZHkuZ2V0VmVsb2NpdHlBdFdvcmxkUG9pbnQod2hlZWwucmF5Y2FzdFJlc3VsdC5oaXRQb2ludFdvcmxkLCBjaGFzc2lzX3ZlbG9jaXR5X2F0X2NvbnRhY3RQb2ludCk7CiAgICAgICAgY29uc3QgcHJvalZlbCA9IHdoZWVsLnJheWNhc3RSZXN1bHQuaGl0Tm9ybWFsV29ybGQuZG90KGNoYXNzaXNfdmVsb2NpdHlfYXRfY29udGFjdFBvaW50KTsKCiAgICAgICAgaWYgKGRlbm9taW5hdG9yID49IC0wLjEpIHsKICAgICAgICAgIHdoZWVsLnN1c3BlbnNpb25SZWxhdGl2ZVZlbG9jaXR5ID0gMDsKICAgICAgICAgIHdoZWVsLmNsaXBwZWRJbnZDb250YWN0RG90U3VzcGVuc2lvbiA9IDEgLyAwLjE7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbnN0IGludiA9IC0xIC8gZGVub21pbmF0b3I7CiAgICAgICAgICB3aGVlbC5zdXNwZW5zaW9uUmVsYXRpdmVWZWxvY2l0eSA9IHByb2pWZWwgKiBpbnY7CiAgICAgICAgICB3aGVlbC5jbGlwcGVkSW52Q29udGFjdERvdFN1c3BlbnNpb24gPSBpbnY7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIC8vcHV0IHdoZWVsIGluZm8gYXMgaW4gcmVzdCBwb3NpdGlvbgogICAgICAgIHdoZWVsLnN1c3BlbnNpb25MZW5ndGggPSB3aGVlbC5zdXNwZW5zaW9uUmVzdExlbmd0aCArIDAgKiB3aGVlbC5tYXhTdXNwZW5zaW9uVHJhdmVsOwogICAgICAgIHdoZWVsLnN1c3BlbnNpb25SZWxhdGl2ZVZlbG9jaXR5ID0gMC4wOwogICAgICAgIHdoZWVsLmRpcmVjdGlvbldvcmxkLnNjYWxlKC0xLCB3aGVlbC5yYXljYXN0UmVzdWx0LmhpdE5vcm1hbFdvcmxkKTsKICAgICAgICB3aGVlbC5jbGlwcGVkSW52Q29udGFjdERvdFN1c3BlbnNpb24gPSAxLjA7CiAgICAgIH0KCiAgICAgIHJldHVybiBkZXB0aDsKICAgIH0KCiAgICB1cGRhdGVXaGVlbFRyYW5zZm9ybVdvcmxkKHdoZWVsKSB7CiAgICAgIHdoZWVsLmlzSW5Db250YWN0ID0gZmFsc2U7CiAgICAgIGNvbnN0IGNoYXNzaXNCb2R5ID0gdGhpcy5jaGFzc2lzQm9keTsKICAgICAgY2hhc3Npc0JvZHkucG9pbnRUb1dvcmxkRnJhbWUod2hlZWwuY2hhc3Npc0Nvbm5lY3Rpb25Qb2ludExvY2FsLCB3aGVlbC5jaGFzc2lzQ29ubmVjdGlvblBvaW50V29ybGQpOwogICAgICBjaGFzc2lzQm9keS52ZWN0b3JUb1dvcmxkRnJhbWUod2hlZWwuZGlyZWN0aW9uTG9jYWwsIHdoZWVsLmRpcmVjdGlvbldvcmxkKTsKICAgICAgY2hhc3Npc0JvZHkudmVjdG9yVG9Xb3JsZEZyYW1lKHdoZWVsLmF4bGVMb2NhbCwgd2hlZWwuYXhsZVdvcmxkKTsKICAgIH0KICAgIC8qKgogICAgICogVXBkYXRlIG9uZSBvZiB0aGUgd2hlZWwgdHJhbnNmb3JtLgogICAgICogTm90ZSB3aGVuIHJlbmRlcmluZyB3aGVlbHM6IGR1cmluZyBlYWNoIHN0ZXAsIHdoZWVsIHRyYW5zZm9ybXMgYXJlIHVwZGF0ZWQgQkVGT1JFIHRoZSBjaGFzc2lzOyBpZS4gdGhlaXIgcG9zaXRpb24gYmVjb21lcyBpbnZhbGlkIGFmdGVyIHRoZSBzdGVwLiBUaHVzIHdoZW4geW91IHJlbmRlciB3aGVlbHMsIHlvdSBtdXN0IHVwZGF0ZSB3aGVlbCB0cmFuc2Zvcm1zIGJlZm9yZSByZW5kZXJpbmcgdGhlbS4gU2VlIHJheWNhc3RWZWhpY2xlIGRlbW8gZm9yIGFuIGV4YW1wbGUuCiAgICAgKiBAcGFyYW0gd2hlZWxJbmRleCBUaGUgd2hlZWwgaW5kZXggdG8gdXBkYXRlLgogICAgICovCgoKICAgIHVwZGF0ZVdoZWVsVHJhbnNmb3JtKHdoZWVsSW5kZXgpIHsKICAgICAgY29uc3QgdXAgPSB0bXBWZWM0OwogICAgICBjb25zdCByaWdodCA9IHRtcFZlYzU7CiAgICAgIGNvbnN0IGZ3ZCA9IHRtcFZlYzY7CiAgICAgIGNvbnN0IHdoZWVsID0gdGhpcy53aGVlbEluZm9zW3doZWVsSW5kZXhdOwogICAgICB0aGlzLnVwZGF0ZVdoZWVsVHJhbnNmb3JtV29ybGQod2hlZWwpOwogICAgICB3aGVlbC5kaXJlY3Rpb25Mb2NhbC5zY2FsZSgtMSwgdXApOwogICAgICByaWdodC5jb3B5KHdoZWVsLmF4bGVMb2NhbCk7CiAgICAgIHVwLmNyb3NzKHJpZ2h0LCBmd2QpOwogICAgICBmd2Qubm9ybWFsaXplKCk7CiAgICAgIHJpZ2h0Lm5vcm1hbGl6ZSgpOyAvLyBSb3RhdGUgYXJvdW5kIHN0ZWVyaW5nIG92ZXIgdGhlIHdoZWVsQXhsZQoKICAgICAgY29uc3Qgc3RlZXJpbmcgPSB3aGVlbC5zdGVlcmluZzsKICAgICAgY29uc3Qgc3RlZXJpbmdPcm4gPSBuZXcgUXVhdGVybmlvbigpOwogICAgICBzdGVlcmluZ09ybi5zZXRGcm9tQXhpc0FuZ2xlKHVwLCBzdGVlcmluZyk7CiAgICAgIGNvbnN0IHJvdGF0aW5nT3JuID0gbmV3IFF1YXRlcm5pb24oKTsKICAgICAgcm90YXRpbmdPcm4uc2V0RnJvbUF4aXNBbmdsZShyaWdodCwgd2hlZWwucm90YXRpb24pOyAvLyBXb3JsZCByb3RhdGlvbiBvZiB0aGUgd2hlZWwKCiAgICAgIGNvbnN0IHEgPSB3aGVlbC53b3JsZFRyYW5zZm9ybS5xdWF0ZXJuaW9uOwogICAgICB0aGlzLmNoYXNzaXNCb2R5LnF1YXRlcm5pb24ubXVsdChzdGVlcmluZ09ybiwgcSk7CiAgICAgIHEubXVsdChyb3RhdGluZ09ybiwgcSk7CiAgICAgIHEubm9ybWFsaXplKCk7IC8vIHdvcmxkIHBvc2l0aW9uIG9mIHRoZSB3aGVlbAoKICAgICAgY29uc3QgcCA9IHdoZWVsLndvcmxkVHJhbnNmb3JtLnBvc2l0aW9uOwogICAgICBwLmNvcHkod2hlZWwuZGlyZWN0aW9uV29ybGQpOwogICAgICBwLnNjYWxlKHdoZWVsLnN1c3BlbnNpb25MZW5ndGgsIHApOwogICAgICBwLnZhZGQod2hlZWwuY2hhc3Npc0Nvbm5lY3Rpb25Qb2ludFdvcmxkLCBwKTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IHRoZSB3b3JsZCB0cmFuc2Zvcm0gb2Ygb25lIG9mIHRoZSB3aGVlbHMKICAgICAqLwoKCiAgICBnZXRXaGVlbFRyYW5zZm9ybVdvcmxkKHdoZWVsSW5kZXgpIHsKICAgICAgcmV0dXJuIHRoaXMud2hlZWxJbmZvc1t3aGVlbEluZGV4XS53b3JsZFRyYW5zZm9ybTsKICAgIH0KCiAgICB1cGRhdGVGcmljdGlvbih0aW1lU3RlcCkgewogICAgICBjb25zdCBzdXJmTm9ybWFsV1Nfc2NhbGVkX3Byb2ogPSB1cGRhdGVGcmljdGlvbl9zdXJmTm9ybWFsV1Nfc2NhbGVkX3Byb2o7IC8vY2FsY3VsYXRlIHRoZSBpbXB1bHNlLCBzbyB0aGF0IHRoZSB3aGVlbHMgZG9uJ3QgbW92ZSBzaWRld2FyZHMKCiAgICAgIGNvbnN0IHdoZWVsSW5mb3MgPSB0aGlzLndoZWVsSW5mb3M7CiAgICAgIGNvbnN0IG51bVdoZWVscyA9IHdoZWVsSW5mb3MubGVuZ3RoOwogICAgICBjb25zdCBjaGFzc2lzQm9keSA9IHRoaXMuY2hhc3Npc0JvZHk7CiAgICAgIGNvbnN0IGZvcndhcmRXUyA9IHVwZGF0ZUZyaWN0aW9uX2ZvcndhcmRXUzsKICAgICAgY29uc3QgYXhsZSA9IHVwZGF0ZUZyaWN0aW9uX2F4bGU7CiAgICAgIHRoaXMubnVtV2hlZWxzT25Hcm91bmQgPSAwOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBudW1XaGVlbHM7IGkrKykgewogICAgICAgIGNvbnN0IHdoZWVsID0gd2hlZWxJbmZvc1tpXTsKICAgICAgICBjb25zdCBncm91bmRPYmplY3QgPSB3aGVlbC5yYXljYXN0UmVzdWx0LmJvZHk7CgogICAgICAgIGlmIChncm91bmRPYmplY3QpIHsKICAgICAgICAgIHRoaXMubnVtV2hlZWxzT25Hcm91bmQrKzsKICAgICAgICB9CgogICAgICAgIHdoZWVsLnNpZGVJbXB1bHNlID0gMDsKICAgICAgICB3aGVlbC5mb3J3YXJkSW1wdWxzZSA9IDA7CgogICAgICAgIGlmICghZm9yd2FyZFdTW2ldKSB7CiAgICAgICAgICBmb3J3YXJkV1NbaV0gPSBuZXcgVmVjMygpOwogICAgICAgIH0KCiAgICAgICAgaWYgKCFheGxlW2ldKSB7CiAgICAgICAgICBheGxlW2ldID0gbmV3IFZlYzMoKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbnVtV2hlZWxzOyBpKyspIHsKICAgICAgICBjb25zdCB3aGVlbCA9IHdoZWVsSW5mb3NbaV07CiAgICAgICAgY29uc3QgZ3JvdW5kT2JqZWN0ID0gd2hlZWwucmF5Y2FzdFJlc3VsdC5ib2R5OwoKICAgICAgICBpZiAoZ3JvdW5kT2JqZWN0KSB7CiAgICAgICAgICBjb25zdCBheGxlaSA9IGF4bGVbaV07CiAgICAgICAgICBjb25zdCB3aGVlbFRyYW5zID0gdGhpcy5nZXRXaGVlbFRyYW5zZm9ybVdvcmxkKGkpOyAvLyBHZXQgd29ybGQgYXhsZQoKICAgICAgICAgIHdoZWVsVHJhbnMudmVjdG9yVG9Xb3JsZEZyYW1lKGRpcmVjdGlvbnNbdGhpcy5pbmRleFJpZ2h0QXhpc10sIGF4bGVpKTsKICAgICAgICAgIGNvbnN0IHN1cmZOb3JtYWxXUyA9IHdoZWVsLnJheWNhc3RSZXN1bHQuaGl0Tm9ybWFsV29ybGQ7CiAgICAgICAgICBjb25zdCBwcm9qID0gYXhsZWkuZG90KHN1cmZOb3JtYWxXUyk7CiAgICAgICAgICBzdXJmTm9ybWFsV1Muc2NhbGUocHJvaiwgc3VyZk5vcm1hbFdTX3NjYWxlZF9wcm9qKTsKICAgICAgICAgIGF4bGVpLnZzdWIoc3VyZk5vcm1hbFdTX3NjYWxlZF9wcm9qLCBheGxlaSk7CiAgICAgICAgICBheGxlaS5ub3JtYWxpemUoKTsKICAgICAgICAgIHN1cmZOb3JtYWxXUy5jcm9zcyhheGxlaSwgZm9yd2FyZFdTW2ldKTsKICAgICAgICAgIGZvcndhcmRXU1tpXS5ub3JtYWxpemUoKTsKICAgICAgICAgIHdoZWVsLnNpZGVJbXB1bHNlID0gcmVzb2x2ZVNpbmdsZUJpbGF0ZXJhbChjaGFzc2lzQm9keSwgd2hlZWwucmF5Y2FzdFJlc3VsdC5oaXRQb2ludFdvcmxkLCBncm91bmRPYmplY3QsIHdoZWVsLnJheWNhc3RSZXN1bHQuaGl0UG9pbnRXb3JsZCwgYXhsZWkpOwogICAgICAgICAgd2hlZWwuc2lkZUltcHVsc2UgKj0gc2lkZUZyaWN0aW9uU3RpZmZuZXNzMjsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGNvbnN0IHNpZGVGYWN0b3IgPSAxOwogICAgICBjb25zdCBmd2RGYWN0b3IgPSAwLjU7CiAgICAgIHRoaXMuc2xpZGluZyA9IGZhbHNlOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBudW1XaGVlbHM7IGkrKykgewogICAgICAgIGNvbnN0IHdoZWVsID0gd2hlZWxJbmZvc1tpXTsKICAgICAgICBjb25zdCBncm91bmRPYmplY3QgPSB3aGVlbC5yYXljYXN0UmVzdWx0LmJvZHk7CiAgICAgICAgbGV0IHJvbGxpbmdGcmljdGlvbiA9IDA7CiAgICAgICAgd2hlZWwuc2xpcEluZm8gPSAxOwoKICAgICAgICBpZiAoZ3JvdW5kT2JqZWN0KSB7CiAgICAgICAgICBjb25zdCBkZWZhdWx0Um9sbGluZ0ZyaWN0aW9uSW1wdWxzZSA9IDA7CiAgICAgICAgICBjb25zdCBtYXhJbXB1bHNlID0gd2hlZWwuYnJha2UgPyB3aGVlbC5icmFrZSA6IGRlZmF1bHRSb2xsaW5nRnJpY3Rpb25JbXB1bHNlOyAvLyBidFdoZWVsQ29udGFjdFBvaW50IGNvbnRhY3RQdChjaGFzc2lzQm9keSxncm91bmRPYmplY3Qsd2hlZWxJbmZyYXljYXN0SW5mby5oaXRQb2ludFdvcmxkLGZvcndhcmRXU1t3aGVlbF0sbWF4SW1wdWxzZSk7CiAgICAgICAgICAvLyByb2xsaW5nRnJpY3Rpb24gPSBjYWxjUm9sbGluZ0ZyaWN0aW9uKGNvbnRhY3RQdCk7CgogICAgICAgICAgcm9sbGluZ0ZyaWN0aW9uID0gY2FsY1JvbGxpbmdGcmljdGlvbihjaGFzc2lzQm9keSwgZ3JvdW5kT2JqZWN0LCB3aGVlbC5yYXljYXN0UmVzdWx0LmhpdFBvaW50V29ybGQsIGZvcndhcmRXU1tpXSwgbWF4SW1wdWxzZSk7CiAgICAgICAgICByb2xsaW5nRnJpY3Rpb24gKz0gd2hlZWwuZW5naW5lRm9yY2UgKiB0aW1lU3RlcDsgLy8gcm9sbGluZ0ZyaWN0aW9uID0gMDsKCiAgICAgICAgICBjb25zdCBmYWN0b3IgPSBtYXhJbXB1bHNlIC8gcm9sbGluZ0ZyaWN0aW9uOwogICAgICAgICAgd2hlZWwuc2xpcEluZm8gKj0gZmFjdG9yOwogICAgICAgIH0gLy9zd2l0Y2ggYmV0d2VlbiBhY3RpdmUgcm9sbGluZyAodGhyb3R0bGUpLCBicmFraW5nIGFuZCBub24tYWN0aXZlIHJvbGxpbmcgZnJpY3Rpb24gKG50aHJvdHRsZS9icmVhaykKCgogICAgICAgIHdoZWVsLmZvcndhcmRJbXB1bHNlID0gMDsKICAgICAgICB3aGVlbC5za2lkSW5mbyA9IDE7CgogICAgICAgIGlmIChncm91bmRPYmplY3QpIHsKICAgICAgICAgIHdoZWVsLnNraWRJbmZvID0gMTsKICAgICAgICAgIGNvbnN0IG1heGltcCA9IHdoZWVsLnN1c3BlbnNpb25Gb3JjZSAqIHRpbWVTdGVwICogd2hlZWwuZnJpY3Rpb25TbGlwOwogICAgICAgICAgY29uc3QgbWF4aW1wU2lkZSA9IG1heGltcDsKICAgICAgICAgIGNvbnN0IG1heGltcFNxdWFyZWQgPSBtYXhpbXAgKiBtYXhpbXBTaWRlOwogICAgICAgICAgd2hlZWwuZm9yd2FyZEltcHVsc2UgPSByb2xsaW5nRnJpY3Rpb247IC8vd2hlZWxJbmZvLmVuZ2luZUZvcmNlKiB0aW1lU3RlcDsKCiAgICAgICAgICBjb25zdCB4ID0gd2hlZWwuZm9yd2FyZEltcHVsc2UgKiBmd2RGYWN0b3IgLyB3aGVlbC5mb3J3YXJkQWNjZWxlcmF0aW9uOwogICAgICAgICAgY29uc3QgeSA9IHdoZWVsLnNpZGVJbXB1bHNlICogc2lkZUZhY3RvciAvIHdoZWVsLnNpZGVBY2NlbGVyYXRpb247CiAgICAgICAgICBjb25zdCBpbXB1bHNlU3F1YXJlZCA9IHggKiB4ICsgeSAqIHk7CiAgICAgICAgICB3aGVlbC5zbGlkaW5nID0gZmFsc2U7CgogICAgICAgICAgaWYgKGltcHVsc2VTcXVhcmVkID4gbWF4aW1wU3F1YXJlZCkgewogICAgICAgICAgICB0aGlzLnNsaWRpbmcgPSB0cnVlOwogICAgICAgICAgICB3aGVlbC5zbGlkaW5nID0gdHJ1ZTsKICAgICAgICAgICAgY29uc3QgZmFjdG9yID0gbWF4aW1wIC8gTWF0aC5zcXJ0KGltcHVsc2VTcXVhcmVkKTsKICAgICAgICAgICAgd2hlZWwuc2tpZEluZm8gKj0gZmFjdG9yOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKHRoaXMuc2xpZGluZykgewogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbnVtV2hlZWxzOyBpKyspIHsKICAgICAgICAgIGNvbnN0IHdoZWVsID0gd2hlZWxJbmZvc1tpXTsKCiAgICAgICAgICBpZiAod2hlZWwuc2lkZUltcHVsc2UgIT09IDApIHsKICAgICAgICAgICAgaWYgKHdoZWVsLnNraWRJbmZvIDwgMSkgewogICAgICAgICAgICAgIHdoZWVsLmZvcndhcmRJbXB1bHNlICo9IHdoZWVsLnNraWRJbmZvOwogICAgICAgICAgICAgIHdoZWVsLnNpZGVJbXB1bHNlICo9IHdoZWVsLnNraWRJbmZvOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IC8vIGFwcGx5IHRoZSBpbXB1bHNlcwoKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbnVtV2hlZWxzOyBpKyspIHsKICAgICAgICBjb25zdCB3aGVlbCA9IHdoZWVsSW5mb3NbaV07CiAgICAgICAgY29uc3QgcmVsX3BvcyA9IG5ldyBWZWMzKCk7CiAgICAgICAgd2hlZWwucmF5Y2FzdFJlc3VsdC5oaXRQb2ludFdvcmxkLnZzdWIoY2hhc3Npc0JvZHkucG9zaXRpb24sIHJlbF9wb3MpOyAvLyBjYW5ub25zIGFwcGx5aW1wdWxzZSBpcyB1c2luZyB3b3JsZCBjb29yZCBmb3IgdGhlIHBvc2l0aW9uCiAgICAgICAgLy9yZWxfcG9zLmNvcHkod2hlZWwucmF5Y2FzdFJlc3VsdC5oaXRQb2ludFdvcmxkKTsKCiAgICAgICAgaWYgKHdoZWVsLmZvcndhcmRJbXB1bHNlICE9PSAwKSB7CiAgICAgICAgICBjb25zdCBpbXB1bHNlID0gbmV3IFZlYzMoKTsKICAgICAgICAgIGZvcndhcmRXU1tpXS5zY2FsZSh3aGVlbC5mb3J3YXJkSW1wdWxzZSwgaW1wdWxzZSk7CiAgICAgICAgICBjaGFzc2lzQm9keS5hcHBseUltcHVsc2UoaW1wdWxzZSwgcmVsX3Bvcyk7CiAgICAgICAgfQoKICAgICAgICBpZiAod2hlZWwuc2lkZUltcHVsc2UgIT09IDApIHsKICAgICAgICAgIGNvbnN0IGdyb3VuZE9iamVjdCA9IHdoZWVsLnJheWNhc3RSZXN1bHQuYm9keTsKICAgICAgICAgIGNvbnN0IHJlbF9wb3MyID0gbmV3IFZlYzMoKTsKICAgICAgICAgIHdoZWVsLnJheWNhc3RSZXN1bHQuaGl0UG9pbnRXb3JsZC52c3ViKGdyb3VuZE9iamVjdC5wb3NpdGlvbiwgcmVsX3BvczIpOyAvL3JlbF9wb3MyLmNvcHkod2hlZWwucmF5Y2FzdFJlc3VsdC5oaXRQb2ludFdvcmxkKTsKCiAgICAgICAgICBjb25zdCBzaWRlSW1wID0gbmV3IFZlYzMoKTsKICAgICAgICAgIGF4bGVbaV0uc2NhbGUod2hlZWwuc2lkZUltcHVsc2UsIHNpZGVJbXApOyAvLyBTY2FsZSB0aGUgcmVsYXRpdmUgcG9zaXRpb24gaW4gdGhlIHVwIGRpcmVjdGlvbiB3aXRoIHJvbGxJbmZsdWVuY2UuCiAgICAgICAgICAvLyBJZiByb2xsSW5mbHVlbmNlIGlzIDEsIHRoZSBpbXB1bHNlIHdpbGwgYmUgYXBwbGllZCBvbiB0aGUgaGl0UG9pbnQgKGVhc3kgdG8gcm9sbCBvdmVyKSwgaWYgaXQgaXMgemVybyBpdCB3aWxsIGJlIGFwcGxpZWQgaW4gdGhlIHNhbWUgcGxhbmUgYXMgdGhlIGNlbnRlciBvZiBtYXNzIChub3QgZWFzeSB0byByb2xsIG92ZXIpLgoKICAgICAgICAgIGNoYXNzaXNCb2R5LnZlY3RvclRvTG9jYWxGcmFtZShyZWxfcG9zLCByZWxfcG9zKTsKICAgICAgICAgIHJlbF9wb3NbJ3h5eidbdGhpcy5pbmRleFVwQXhpc11dICo9IHdoZWVsLnJvbGxJbmZsdWVuY2U7CiAgICAgICAgICBjaGFzc2lzQm9keS52ZWN0b3JUb1dvcmxkRnJhbWUocmVsX3BvcywgcmVsX3Bvcyk7CiAgICAgICAgICBjaGFzc2lzQm9keS5hcHBseUltcHVsc2Uoc2lkZUltcCwgcmVsX3Bvcyk7IC8vYXBwbHkgZnJpY3Rpb24gaW1wdWxzZSBvbiB0aGUgZ3JvdW5kCgogICAgICAgICAgc2lkZUltcC5zY2FsZSgtMSwgc2lkZUltcCk7CiAgICAgICAgICBncm91bmRPYmplY3QuYXBwbHlJbXB1bHNlKHNpZGVJbXAsIHJlbF9wb3MyKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgfQogIG5ldyBWZWMzKCk7CiAgbmV3IFZlYzMoKTsKICBuZXcgVmVjMygpOwogIGNvbnN0IHRtcFZlYzQgPSBuZXcgVmVjMygpOwogIGNvbnN0IHRtcFZlYzUgPSBuZXcgVmVjMygpOwogIGNvbnN0IHRtcFZlYzYgPSBuZXcgVmVjMygpOwogIG5ldyBSYXkoKTsKICBuZXcgVmVjMygpOwogIGNvbnN0IGNhc3RSYXlfcmF5dmVjdG9yID0gbmV3IFZlYzMoKTsKICBjb25zdCBjYXN0UmF5X3RhcmdldCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgZGlyZWN0aW9ucyA9IFtuZXcgVmVjMygxLCAwLCAwKSwgbmV3IFZlYzMoMCwgMSwgMCksIG5ldyBWZWMzKDAsIDAsIDEpXTsKICBjb25zdCB1cGRhdGVGcmljdGlvbl9zdXJmTm9ybWFsV1Nfc2NhbGVkX3Byb2ogPSBuZXcgVmVjMygpOwogIGNvbnN0IHVwZGF0ZUZyaWN0aW9uX2F4bGUgPSBbXTsKICBjb25zdCB1cGRhdGVGcmljdGlvbl9mb3J3YXJkV1MgPSBbXTsKICBjb25zdCBzaWRlRnJpY3Rpb25TdGlmZm5lc3MyID0gMTsKICBjb25zdCBjYWxjUm9sbGluZ0ZyaWN0aW9uX3ZlbDEgPSBuZXcgVmVjMygpOwogIGNvbnN0IGNhbGNSb2xsaW5nRnJpY3Rpb25fdmVsMiA9IG5ldyBWZWMzKCk7CiAgY29uc3QgY2FsY1JvbGxpbmdGcmljdGlvbl92ZWwgPSBuZXcgVmVjMygpOwoKICBmdW5jdGlvbiBjYWxjUm9sbGluZ0ZyaWN0aW9uKGJvZHkwLCBib2R5MSwgZnJpY3Rpb25Qb3NXb3JsZCwgZnJpY3Rpb25EaXJlY3Rpb25Xb3JsZCwgbWF4SW1wdWxzZSkgewogICAgbGV0IGoxID0gMDsKICAgIGNvbnN0IGNvbnRhY3RQb3NXb3JsZCA9IGZyaWN0aW9uUG9zV29ybGQ7IC8vIGNvbnN0IHJlbF9wb3MxID0gbmV3IFZlYzMoKTsKICAgIC8vIGNvbnN0IHJlbF9wb3MyID0gbmV3IFZlYzMoKTsKCiAgICBjb25zdCB2ZWwxID0gY2FsY1JvbGxpbmdGcmljdGlvbl92ZWwxOwogICAgY29uc3QgdmVsMiA9IGNhbGNSb2xsaW5nRnJpY3Rpb25fdmVsMjsKICAgIGNvbnN0IHZlbCA9IGNhbGNSb2xsaW5nRnJpY3Rpb25fdmVsOyAvLyBjb250YWN0UG9zV29ybGQudnN1Yihib2R5MC5wb3NpdGlvbiwgcmVsX3BvczEpOwogICAgLy8gY29udGFjdFBvc1dvcmxkLnZzdWIoYm9keTEucG9zaXRpb24sIHJlbF9wb3MyKTsKCiAgICBib2R5MC5nZXRWZWxvY2l0eUF0V29ybGRQb2ludChjb250YWN0UG9zV29ybGQsIHZlbDEpOwogICAgYm9keTEuZ2V0VmVsb2NpdHlBdFdvcmxkUG9pbnQoY29udGFjdFBvc1dvcmxkLCB2ZWwyKTsKICAgIHZlbDEudnN1Yih2ZWwyLCB2ZWwpOwogICAgY29uc3QgdnJlbCA9IGZyaWN0aW9uRGlyZWN0aW9uV29ybGQuZG90KHZlbCk7CiAgICBjb25zdCBkZW5vbTAgPSBjb21wdXRlSW1wdWxzZURlbm9taW5hdG9yKGJvZHkwLCBmcmljdGlvblBvc1dvcmxkLCBmcmljdGlvbkRpcmVjdGlvbldvcmxkKTsKICAgIGNvbnN0IGRlbm9tMSA9IGNvbXB1dGVJbXB1bHNlRGVub21pbmF0b3IoYm9keTEsIGZyaWN0aW9uUG9zV29ybGQsIGZyaWN0aW9uRGlyZWN0aW9uV29ybGQpOwogICAgY29uc3QgcmVsYXhhdGlvbiA9IDE7CiAgICBjb25zdCBqYWNEaWFnQUJJbnYgPSByZWxheGF0aW9uIC8gKGRlbm9tMCArIGRlbm9tMSk7IC8vIGNhbGN1bGF0ZSBqIHRoYXQgbW92ZXMgdXMgdG8gemVybyByZWxhdGl2ZSB2ZWxvY2l0eQoKICAgIGoxID0gLXZyZWwgKiBqYWNEaWFnQUJJbnY7CgogICAgaWYgKG1heEltcHVsc2UgPCBqMSkgewogICAgICBqMSA9IG1heEltcHVsc2U7CiAgICB9CgogICAgaWYgKGoxIDwgLW1heEltcHVsc2UpIHsKICAgICAgajEgPSAtbWF4SW1wdWxzZTsKICAgIH0KCiAgICByZXR1cm4gajE7CiAgfQoKICBjb25zdCBjb21wdXRlSW1wdWxzZURlbm9taW5hdG9yX3IwID0gbmV3IFZlYzMoKTsKICBjb25zdCBjb21wdXRlSW1wdWxzZURlbm9taW5hdG9yX2MwID0gbmV3IFZlYzMoKTsKICBjb25zdCBjb21wdXRlSW1wdWxzZURlbm9taW5hdG9yX3ZlYyA9IG5ldyBWZWMzKCk7CiAgY29uc3QgY29tcHV0ZUltcHVsc2VEZW5vbWluYXRvcl9tID0gbmV3IFZlYzMoKTsKCiAgZnVuY3Rpb24gY29tcHV0ZUltcHVsc2VEZW5vbWluYXRvcihib2R5LCBwb3MsIG5vcm1hbCkgewogICAgY29uc3QgcjAgPSBjb21wdXRlSW1wdWxzZURlbm9taW5hdG9yX3IwOwogICAgY29uc3QgYzAgPSBjb21wdXRlSW1wdWxzZURlbm9taW5hdG9yX2MwOwogICAgY29uc3QgdmVjID0gY29tcHV0ZUltcHVsc2VEZW5vbWluYXRvcl92ZWM7CiAgICBjb25zdCBtID0gY29tcHV0ZUltcHVsc2VEZW5vbWluYXRvcl9tOwogICAgcG9zLnZzdWIoYm9keS5wb3NpdGlvbiwgcjApOwogICAgcjAuY3Jvc3Mobm9ybWFsLCBjMCk7CiAgICBib2R5LmludkluZXJ0aWFXb3JsZC52bXVsdChjMCwgbSk7CiAgICBtLmNyb3NzKHIwLCB2ZWMpOwogICAgcmV0dXJuIGJvZHkuaW52TWFzcyArIG5vcm1hbC5kb3QodmVjKTsKICB9CgogIGNvbnN0IHJlc29sdmVTaW5nbGVCaWxhdGVyYWxfdmVsMSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgcmVzb2x2ZVNpbmdsZUJpbGF0ZXJhbF92ZWwyID0gbmV3IFZlYzMoKTsKICBjb25zdCByZXNvbHZlU2luZ2xlQmlsYXRlcmFsX3ZlbCA9IG5ldyBWZWMzKCk7IC8vIGJpbGF0ZXJhbCBjb25zdHJhaW50IGJldHdlZW4gdHdvIGR5bmFtaWMgb2JqZWN0cwoKICBmdW5jdGlvbiByZXNvbHZlU2luZ2xlQmlsYXRlcmFsKGJvZHkxLCBwb3MxLCBib2R5MiwgcG9zMiwgbm9ybWFsKSB7CiAgICBjb25zdCBub3JtYWxMZW5TcXIgPSBub3JtYWwubGVuZ3RoU3F1YXJlZCgpOwoKICAgIGlmIChub3JtYWxMZW5TcXIgPiAxLjEpIHsKICAgICAgcmV0dXJuIDA7IC8vIG5vIGltcHVsc2UKICAgIH0gLy8gY29uc3QgcmVsX3BvczEgPSBuZXcgVmVjMygpOwogICAgLy8gY29uc3QgcmVsX3BvczIgPSBuZXcgVmVjMygpOwogICAgLy8gcG9zMS52c3ViKGJvZHkxLnBvc2l0aW9uLCByZWxfcG9zMSk7CiAgICAvLyBwb3MyLnZzdWIoYm9keTIucG9zaXRpb24sIHJlbF9wb3MyKTsKCgogICAgY29uc3QgdmVsMSA9IHJlc29sdmVTaW5nbGVCaWxhdGVyYWxfdmVsMTsKICAgIGNvbnN0IHZlbDIgPSByZXNvbHZlU2luZ2xlQmlsYXRlcmFsX3ZlbDI7CiAgICBjb25zdCB2ZWwgPSByZXNvbHZlU2luZ2xlQmlsYXRlcmFsX3ZlbDsKICAgIGJvZHkxLmdldFZlbG9jaXR5QXRXb3JsZFBvaW50KHBvczEsIHZlbDEpOwogICAgYm9keTIuZ2V0VmVsb2NpdHlBdFdvcmxkUG9pbnQocG9zMiwgdmVsMik7CiAgICB2ZWwxLnZzdWIodmVsMiwgdmVsKTsKICAgIGNvbnN0IHJlbF92ZWwgPSBub3JtYWwuZG90KHZlbCk7CiAgICBjb25zdCBjb250YWN0RGFtcGluZyA9IDAuMjsKICAgIGNvbnN0IG1hc3NUZXJtID0gMSAvIChib2R5MS5pbnZNYXNzICsgYm9keTIuaW52TWFzcyk7CiAgICBjb25zdCBpbXB1bHNlID0gLWNvbnRhY3REYW1waW5nICogcmVsX3ZlbCAqIG1hc3NUZXJtOwogICAgcmV0dXJuIGltcHVsc2U7CiAgfQoKICAvKioKICAgKiBTcGhlcmljYWwgc2hhcGUKICAgKiBAZXhhbXBsZQogICAqICAgICBjb25zdCByYWRpdXMgPSAxCiAgICogICAgIGNvbnN0IHNwaGVyZVNoYXBlID0gbmV3IENBTk5PTi5TcGhlcmUocmFkaXVzKQogICAqICAgICBjb25zdCBzcGhlcmVCb2R5ID0gbmV3IENBTk5PTi5Cb2R5KHsgbWFzczogMSwgc2hhcGU6IHNwaGVyZVNoYXBlIH0pCiAgICogICAgIHdvcmxkLmFkZEJvZHkoc3BoZXJlQm9keSkKICAgKi8KICBjbGFzcyBTcGhlcmUgZXh0ZW5kcyBTaGFwZSB7CiAgICAvKioKICAgICAqIFRoZSByYWRpdXMgb2YgdGhlIHNwaGVyZS4KICAgICAqLwoKICAgIC8qKgogICAgICoKICAgICAqIEBwYXJhbSByYWRpdXMgVGhlIHJhZGl1cyBvZiB0aGUgc3BoZXJlLCBhIG5vbi1uZWdhdGl2ZSBudW1iZXIuCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKHJhZGl1cykgewogICAgICBzdXBlcih7CiAgICAgICAgdHlwZTogU2hhcGUudHlwZXMuU1BIRVJFCiAgICAgIH0pOwogICAgICB0aGlzLnJhZGl1cyA9IHJhZGl1cyAhPT0gdW5kZWZpbmVkID8gcmFkaXVzIDogMS4wOwoKICAgICAgaWYgKHRoaXMucmFkaXVzIDwgMCkgewogICAgICAgIHRocm93IG5ldyBFcnJvcignVGhlIHNwaGVyZSByYWRpdXMgY2Fubm90IGJlIG5lZ2F0aXZlLicpOwogICAgICB9CgogICAgICB0aGlzLnVwZGF0ZUJvdW5kaW5nU3BoZXJlUmFkaXVzKCk7CiAgICB9CiAgICAvKiogY2FsY3VsYXRlTG9jYWxJbmVydGlhICovCgoKICAgIGNhbGN1bGF0ZUxvY2FsSW5lcnRpYShtYXNzLCB0YXJnZXQpIHsKICAgICAgaWYgKHRhcmdldCA9PT0gdm9pZCAwKSB7CiAgICAgICAgdGFyZ2V0ID0gbmV3IFZlYzMoKTsKICAgICAgfQoKICAgICAgY29uc3QgSSA9IDIuMCAqIG1hc3MgKiB0aGlzLnJhZGl1cyAqIHRoaXMucmFkaXVzIC8gNS4wOwogICAgICB0YXJnZXQueCA9IEk7CiAgICAgIHRhcmdldC55ID0gSTsKICAgICAgdGFyZ2V0LnogPSBJOwogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQogICAgLyoqIHZvbHVtZSAqLwoKCiAgICB2b2x1bWUoKSB7CiAgICAgIHJldHVybiA0LjAgKiBNYXRoLlBJICogTWF0aC5wb3codGhpcy5yYWRpdXMsIDMpIC8gMy4wOwogICAgfQoKICAgIHVwZGF0ZUJvdW5kaW5nU3BoZXJlUmFkaXVzKCkgewogICAgICB0aGlzLmJvdW5kaW5nU3BoZXJlUmFkaXVzID0gdGhpcy5yYWRpdXM7CiAgICB9CgogICAgY2FsY3VsYXRlV29ybGRBQUJCKHBvcywgcXVhdCwgbWluLCBtYXgpIHsKICAgICAgY29uc3QgciA9IHRoaXMucmFkaXVzOwogICAgICBjb25zdCBheGVzID0gWyd4JywgJ3knLCAneiddOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBheGVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgY29uc3QgYXggPSBheGVzW2ldOwogICAgICAgIG1pbltheF0gPSBwb3NbYXhdIC0gcjsKICAgICAgICBtYXhbYXhdID0gcG9zW2F4XSArIHI7CiAgICAgIH0KICAgIH0KCiAgfQogIG5ldyBWZWMzKCk7CiAgbmV3IFZlYzMoKTsKICBuZXcgVmVjMygpOyAvLyBUZW1wIHZlY3RvcnMgZm9yIGNhbGN1bGF0aW9uCgogIG5ldyBWZWMzKCk7IC8vIFJlbGF0aXZlIHZlbG9jaXR5CgogIG5ldyBWZWMzKCk7CiAgbmV3IFZlYzMoKTsKICBuZXcgVmVjMygpOwogIG5ldyBWZWMzKCk7CiAgbmV3IFZlYzMoKTsKCiAgLyoqCiAgICogQ3lsaW5kZXIgY2xhc3MuCiAgICogQGV4YW1wbGUKICAgKiAgICAgY29uc3QgcmFkaXVzVG9wID0gMC41CiAgICogICAgIGNvbnN0IHJhZGl1c0JvdHRvbSA9IDAuNQogICAqICAgICBjb25zdCBoZWlnaHQgPSAyCiAgICogICAgIGNvbnN0IG51bVNlZ21lbnRzID0gMTIKICAgKiAgICAgY29uc3QgY3lsaW5kZXJTaGFwZSA9IG5ldyBDQU5OT04uQ3lsaW5kZXIocmFkaXVzVG9wLCByYWRpdXNCb3R0b20sIGhlaWdodCwgbnVtU2VnbWVudHMpCiAgICogICAgIGNvbnN0IGN5bGluZGVyQm9keSA9IG5ldyBDQU5OT04uQm9keSh7IG1hc3M6IDEsIHNoYXBlOiBjeWxpbmRlclNoYXBlIH0pCiAgICogICAgIHdvcmxkLmFkZEJvZHkoY3lsaW5kZXJCb2R5KQogICAqLwoKICBjbGFzcyBDeWxpbmRlciBleHRlbmRzIENvbnZleFBvbHloZWRyb24gewogICAgLyoqIFRoZSByYWRpdXMgb2YgdGhlIHRvcCBvZiB0aGUgQ3lsaW5kZXIuICovCgogICAgLyoqIFRoZSByYWRpdXMgb2YgdGhlIGJvdHRvbSBvZiB0aGUgQ3lsaW5kZXIuICovCgogICAgLyoqIFRoZSBoZWlnaHQgb2YgdGhlIEN5bGluZGVyLiAqLwoKICAgIC8qKiBUaGUgbnVtYmVyIG9mIHNlZ21lbnRzIHRvIGJ1aWxkIHRoZSBjeWxpbmRlciBvdXQgb2YuICovCgogICAgLyoqCiAgICAgKiBAcGFyYW0gcmFkaXVzVG9wIFRoZSByYWRpdXMgb2YgdGhlIHRvcCBvZiB0aGUgQ3lsaW5kZXIuCiAgICAgKiBAcGFyYW0gcmFkaXVzQm90dG9tIFRoZSByYWRpdXMgb2YgdGhlIGJvdHRvbSBvZiB0aGUgQ3lsaW5kZXIuCiAgICAgKiBAcGFyYW0gaGVpZ2h0IFRoZSBoZWlnaHQgb2YgdGhlIEN5bGluZGVyLgogICAgICogQHBhcmFtIG51bVNlZ21lbnRzIFRoZSBudW1iZXIgb2Ygc2VnbWVudHMgdG8gYnVpbGQgdGhlIGN5bGluZGVyIG91dCBvZi4KICAgICAqLwogICAgY29uc3RydWN0b3IocmFkaXVzVG9wLCByYWRpdXNCb3R0b20sIGhlaWdodCwgbnVtU2VnbWVudHMpIHsKICAgICAgaWYgKHJhZGl1c1RvcCA9PT0gdm9pZCAwKSB7CiAgICAgICAgcmFkaXVzVG9wID0gMTsKICAgICAgfQoKICAgICAgaWYgKHJhZGl1c0JvdHRvbSA9PT0gdm9pZCAwKSB7CiAgICAgICAgcmFkaXVzQm90dG9tID0gMTsKICAgICAgfQoKICAgICAgaWYgKGhlaWdodCA9PT0gdm9pZCAwKSB7CiAgICAgICAgaGVpZ2h0ID0gMTsKICAgICAgfQoKICAgICAgaWYgKG51bVNlZ21lbnRzID09PSB2b2lkIDApIHsKICAgICAgICBudW1TZWdtZW50cyA9IDg7CiAgICAgIH0KCiAgICAgIGlmIChyYWRpdXNUb3AgPCAwKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdUaGUgY3lsaW5kZXIgcmFkaXVzVG9wIGNhbm5vdCBiZSBuZWdhdGl2ZS4nKTsKICAgICAgfQoKICAgICAgaWYgKHJhZGl1c0JvdHRvbSA8IDApIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBjeWxpbmRlciByYWRpdXNCb3R0b20gY2Fubm90IGJlIG5lZ2F0aXZlLicpOwogICAgICB9CgogICAgICBjb25zdCBOID0gbnVtU2VnbWVudHM7CiAgICAgIGNvbnN0IHZlcnRpY2VzID0gW107CiAgICAgIGNvbnN0IGF4ZXMgPSBbXTsKICAgICAgY29uc3QgZmFjZXMgPSBbXTsKICAgICAgY29uc3QgYm90dG9tZmFjZSA9IFtdOwogICAgICBjb25zdCB0b3BmYWNlID0gW107CiAgICAgIGNvbnN0IGNvcyA9IE1hdGguY29zOwogICAgICBjb25zdCBzaW4gPSBNYXRoLnNpbjsgLy8gRmlyc3QgYm90dG9tIHBvaW50CgogICAgICB2ZXJ0aWNlcy5wdXNoKG5ldyBWZWMzKC1yYWRpdXNCb3R0b20gKiBzaW4oMCksIC1oZWlnaHQgKiAwLjUsIHJhZGl1c0JvdHRvbSAqIGNvcygwKSkpOwogICAgICBib3R0b21mYWNlLnB1c2goMCk7IC8vIEZpcnN0IHRvcCBwb2ludAoKICAgICAgdmVydGljZXMucHVzaChuZXcgVmVjMygtcmFkaXVzVG9wICogc2luKDApLCBoZWlnaHQgKiAwLjUsIHJhZGl1c1RvcCAqIGNvcygwKSkpOwogICAgICB0b3BmYWNlLnB1c2goMSk7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IE47IGkrKykgewogICAgICAgIGNvbnN0IHRoZXRhID0gMiAqIE1hdGguUEkgLyBOICogKGkgKyAxKTsKICAgICAgICBjb25zdCB0aGV0YU4gPSAyICogTWF0aC5QSSAvIE4gKiAoaSArIDAuNSk7CgogICAgICAgIGlmIChpIDwgTiAtIDEpIHsKICAgICAgICAgIC8vIEJvdHRvbQogICAgICAgICAgdmVydGljZXMucHVzaChuZXcgVmVjMygtcmFkaXVzQm90dG9tICogc2luKHRoZXRhKSwgLWhlaWdodCAqIDAuNSwgcmFkaXVzQm90dG9tICogY29zKHRoZXRhKSkpOwogICAgICAgICAgYm90dG9tZmFjZS5wdXNoKDIgKiBpICsgMik7IC8vIFRvcAoKICAgICAgICAgIHZlcnRpY2VzLnB1c2gobmV3IFZlYzMoLXJhZGl1c1RvcCAqIHNpbih0aGV0YSksIGhlaWdodCAqIDAuNSwgcmFkaXVzVG9wICogY29zKHRoZXRhKSkpOwogICAgICAgICAgdG9wZmFjZS5wdXNoKDIgKiBpICsgMyk7IC8vIEZhY2UKCiAgICAgICAgICBmYWNlcy5wdXNoKFsyICogaSwgMiAqIGkgKyAxLCAyICogaSArIDMsIDIgKiBpICsgMl0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBmYWNlcy5wdXNoKFsyICogaSwgMiAqIGkgKyAxLCAxLCAwXSk7IC8vIENvbm5lY3QKICAgICAgICB9IC8vIEF4aXM6IHdlIGNhbiBjdXQgb2ZmIGhhbGYgb2YgdGhlbSBpZiB3ZSBoYXZlIGV2ZW4gbnVtYmVyIG9mIHNlZ21lbnRzCgoKICAgICAgICBpZiAoTiAlIDIgPT09IDEgfHwgaSA8IE4gLyAyKSB7CiAgICAgICAgICBheGVzLnB1c2gobmV3IFZlYzMoLXNpbih0aGV0YU4pLCAwLCBjb3ModGhldGFOKSkpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgZmFjZXMucHVzaChib3R0b21mYWNlKTsKICAgICAgYXhlcy5wdXNoKG5ldyBWZWMzKDAsIDEsIDApKTsgLy8gUmVvcmRlciB0b3AgZmFjZQoKICAgICAgY29uc3QgdGVtcCA9IFtdOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0b3BmYWNlLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgdGVtcC5wdXNoKHRvcGZhY2VbdG9wZmFjZS5sZW5ndGggLSBpIC0gMV0pOwogICAgICB9CgogICAgICBmYWNlcy5wdXNoKHRlbXApOwogICAgICBzdXBlcih7CiAgICAgICAgdmVydGljZXMsCiAgICAgICAgZmFjZXMsCiAgICAgICAgYXhlcwogICAgICB9KTsKICAgICAgdGhpcy50eXBlID0gU2hhcGUudHlwZXMuQ1lMSU5ERVI7CiAgICAgIHRoaXMucmFkaXVzVG9wID0gcmFkaXVzVG9wOwogICAgICB0aGlzLnJhZGl1c0JvdHRvbSA9IHJhZGl1c0JvdHRvbTsKICAgICAgdGhpcy5oZWlnaHQgPSBoZWlnaHQ7CiAgICAgIHRoaXMubnVtU2VnbWVudHMgPSBudW1TZWdtZW50czsKICAgIH0KCiAgfQoKICAvKioKICAgKiBQYXJ0aWNsZSBzaGFwZS4KICAgKiBAZXhhbXBsZQogICAqICAgICBjb25zdCBwYXJ0aWNsZVNoYXBlID0gbmV3IENBTk5PTi5QYXJ0aWNsZSgpCiAgICogICAgIGNvbnN0IHBhcnRpY2xlQm9keSA9IG5ldyBDQU5OT04uQm9keSh7IG1hc3M6IDEsIHNoYXBlOiBwYXJ0aWNsZVNoYXBlIH0pCiAgICogICAgIHdvcmxkLmFkZEJvZHkocGFydGljbGVCb2R5KQogICAqLwogIGNsYXNzIFBhcnRpY2xlIGV4dGVuZHMgU2hhcGUgewogICAgY29uc3RydWN0b3IoKSB7CiAgICAgIHN1cGVyKHsKICAgICAgICB0eXBlOiBTaGFwZS50eXBlcy5QQVJUSUNMRQogICAgICB9KTsKICAgIH0KICAgIC8qKgogICAgICogY2FsY3VsYXRlTG9jYWxJbmVydGlhCiAgICAgKi8KCgogICAgY2FsY3VsYXRlTG9jYWxJbmVydGlhKG1hc3MsIHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB2b2lkIDApIHsKICAgICAgICB0YXJnZXQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICB0YXJnZXQuc2V0KDAsIDAsIDApOwogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQoKICAgIHZvbHVtZSgpIHsKICAgICAgcmV0dXJuIDA7CiAgICB9CgogICAgdXBkYXRlQm91bmRpbmdTcGhlcmVSYWRpdXMoKSB7CiAgICAgIHRoaXMuYm91bmRpbmdTcGhlcmVSYWRpdXMgPSAwOwogICAgfQoKICAgIGNhbGN1bGF0ZVdvcmxkQUFCQihwb3MsIHF1YXQsIG1pbiwgbWF4KSB7CiAgICAgIC8vIEdldCBlYWNoIGF4aXMgbWF4CiAgICAgIG1pbi5jb3B5KHBvcyk7CiAgICAgIG1heC5jb3B5KHBvcyk7CiAgICB9CgogIH0KCiAgLyoqCiAgICogQSBwbGFuZSwgZmFjaW5nIGluIHRoZSBaIGRpcmVjdGlvbi4gVGhlIHBsYW5lIGhhcyBpdHMgc3VyZmFjZSBhdCB6PTAgYW5kIGV2ZXJ5dGhpbmcgYmVsb3cgej0wIGlzIGFzc3VtZWQgdG8gYmUgc29saWQgcGxhbmUuIFRvIG1ha2UgdGhlIHBsYW5lIGZhY2UgaW4gc29tZSBvdGhlciBkaXJlY3Rpb24gdGhhbiB6LCB5b3UgbXVzdCBwdXQgaXQgaW5zaWRlIGEgQm9keSBhbmQgcm90YXRlIHRoYXQgYm9keS4gU2VlIHRoZSBkZW1vcy4KICAgKiBAZXhhbXBsZQogICAqICAgICBjb25zdCBwbGFuZVNoYXBlID0gbmV3IENBTk5PTi5QbGFuZSgpCiAgICogICAgIGNvbnN0IHBsYW5lQm9keSA9IG5ldyBDQU5OT04uQm9keSh7IG1hc3M6IDAsIHNoYXBlOiAgcGxhbmVTaGFwZSB9KQogICAqICAgICBwbGFuZUJvZHkucXVhdGVybmlvbi5zZXRGcm9tRXVsZXIoLU1hdGguUEkgLyAyLCAwLCAwKSAvLyBtYWtlIGl0IGZhY2UgdXAKICAgKiAgICAgd29ybGQuYWRkQm9keShwbGFuZUJvZHkpCiAgICovCiAgY2xhc3MgUGxhbmUgZXh0ZW5kcyBTaGFwZSB7CiAgICAvKiogd29ybGROb3JtYWwgKi8KCiAgICAvKiogd29ybGROb3JtYWxOZWVkc1VwZGF0ZSAqLwogICAgY29uc3RydWN0b3IoKSB7CiAgICAgIHN1cGVyKHsKICAgICAgICB0eXBlOiBTaGFwZS50eXBlcy5QTEFORQogICAgICB9KTsgLy8gV29ybGQgb3JpZW50ZWQgbm9ybWFsCgogICAgICB0aGlzLndvcmxkTm9ybWFsID0gbmV3IFZlYzMoKTsKICAgICAgdGhpcy53b3JsZE5vcm1hbE5lZWRzVXBkYXRlID0gdHJ1ZTsKICAgICAgdGhpcy5ib3VuZGluZ1NwaGVyZVJhZGl1cyA9IE51bWJlci5NQVhfVkFMVUU7CiAgICB9CiAgICAvKiogY29tcHV0ZVdvcmxkTm9ybWFsICovCgoKICAgIGNvbXB1dGVXb3JsZE5vcm1hbChxdWF0KSB7CiAgICAgIGNvbnN0IG4gPSB0aGlzLndvcmxkTm9ybWFsOwogICAgICBuLnNldCgwLCAwLCAxKTsKICAgICAgcXVhdC52bXVsdChuLCBuKTsKICAgICAgdGhpcy53b3JsZE5vcm1hbE5lZWRzVXBkYXRlID0gZmFsc2U7CiAgICB9CgogICAgY2FsY3VsYXRlTG9jYWxJbmVydGlhKG1hc3MsIHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB2b2lkIDApIHsKICAgICAgICB0YXJnZXQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQoKICAgIHZvbHVtZSgpIHsKICAgICAgcmV0dXJuICgvLyBUaGUgcGxhbmUgaXMgaW5maW5pdGUuLi4KICAgICAgICBOdW1iZXIuTUFYX1ZBTFVFCiAgICAgICk7CiAgICB9CgogICAgY2FsY3VsYXRlV29ybGRBQUJCKHBvcywgcXVhdCwgbWluLCBtYXgpIHsKICAgICAgLy8gVGhlIHBsYW5lIEFBQkIgaXMgaW5maW5pdGUsIGV4Y2VwdCBpZiB0aGUgbm9ybWFsIGlzIHBvaW50aW5nIGFsb25nIGFueSBheGlzCiAgICAgIHRlbXBOb3JtYWwuc2V0KDAsIDAsIDEpOyAvLyBEZWZhdWx0IHBsYW5lIG5vcm1hbCBpcyB6CgogICAgICBxdWF0LnZtdWx0KHRlbXBOb3JtYWwsIHRlbXBOb3JtYWwpOwogICAgICBjb25zdCBtYXhWYWwgPSBOdW1iZXIuTUFYX1ZBTFVFOwogICAgICBtaW4uc2V0KC1tYXhWYWwsIC1tYXhWYWwsIC1tYXhWYWwpOwogICAgICBtYXguc2V0KG1heFZhbCwgbWF4VmFsLCBtYXhWYWwpOwoKICAgICAgaWYgKHRlbXBOb3JtYWwueCA9PT0gMSkgewogICAgICAgIG1heC54ID0gcG9zLng7CiAgICAgIH0gZWxzZSBpZiAodGVtcE5vcm1hbC54ID09PSAtMSkgewogICAgICAgIG1pbi54ID0gcG9zLng7CiAgICAgIH0KCiAgICAgIGlmICh0ZW1wTm9ybWFsLnkgPT09IDEpIHsKICAgICAgICBtYXgueSA9IHBvcy55OwogICAgICB9IGVsc2UgaWYgKHRlbXBOb3JtYWwueSA9PT0gLTEpIHsKICAgICAgICBtaW4ueSA9IHBvcy55OwogICAgICB9CgogICAgICBpZiAodGVtcE5vcm1hbC56ID09PSAxKSB7CiAgICAgICAgbWF4LnogPSBwb3MuejsKICAgICAgfSBlbHNlIGlmICh0ZW1wTm9ybWFsLnogPT09IC0xKSB7CiAgICAgICAgbWluLnogPSBwb3MuejsKICAgICAgfQogICAgfQoKICAgIHVwZGF0ZUJvdW5kaW5nU3BoZXJlUmFkaXVzKCkgewogICAgICB0aGlzLmJvdW5kaW5nU3BoZXJlUmFkaXVzID0gTnVtYmVyLk1BWF9WQUxVRTsKICAgIH0KCiAgfQogIGNvbnN0IHRlbXBOb3JtYWwgPSBuZXcgVmVjMygpOwoKICAvKioKICAgKiBIZWlnaHRmaWVsZCBzaGFwZSBjbGFzcy4gSGVpZ2h0IGRhdGEgaXMgZ2l2ZW4gYXMgYW4gYXJyYXkuIFRoZXNlIGRhdGEgcG9pbnRzIGFyZSBzcHJlYWQgb3V0IGV2ZW5seSB3aXRoIGEgZ2l2ZW4gZGlzdGFuY2UuCiAgICogQHRvZG8gU2hvdWxkIGJlIHBvc3NpYmxlIHRvIHVzZSBhbG9uZyBhbGwgYXhlcywgbm90IGp1c3QgeQogICAqIEB0b2RvIHNob3VsZCBiZSBwb3NzaWJsZSB0byBzY2FsZSBhbG9uZyBhbGwgYXhlcwogICAqIEB0b2RvIFJlZmFjdG9yIGVsZW1lbnRTaXplIHRvIGVsZW1lbnRTaXplWCBhbmQgZWxlbWVudFNpemVZCiAgICoKICAgKiBAZXhhbXBsZQogICAqICAgICAvLyBHZW5lcmF0ZSBzb21lIGhlaWdodCBkYXRhICh5LXZhbHVlcykuCiAgICogICAgIGNvbnN0IGRhdGEgPSBbXQogICAqICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDEwMDA7IGkrKykgewogICAqICAgICAgICAgY29uc3QgeSA9IDAuNSAqIE1hdGguY29zKDAuMiAqIGkpCiAgICogICAgICAgICBkYXRhLnB1c2goeSkKICAgKiAgICAgfQogICAqCiAgICogICAgIC8vIENyZWF0ZSB0aGUgaGVpZ2h0ZmllbGQgc2hhcGUKICAgKiAgICAgY29uc3QgaGVpZ2h0ZmllbGRTaGFwZSA9IG5ldyBDQU5OT04uSGVpZ2h0ZmllbGQoZGF0YSwgewogICAqICAgICAgICAgZWxlbWVudFNpemU6IDEgLy8gRGlzdGFuY2UgYmV0d2VlbiB0aGUgZGF0YSBwb2ludHMgaW4gWCBhbmQgWSBkaXJlY3Rpb25zCiAgICogICAgIH0pCiAgICogICAgIGNvbnN0IGhlaWdodGZpZWxkQm9keSA9IG5ldyBDQU5OT04uQm9keSh7IHNoYXBlOiBoZWlnaHRmaWVsZFNoYXBlIH0pCiAgICogICAgIHdvcmxkLmFkZEJvZHkoaGVpZ2h0ZmllbGRCb2R5KQogICAqLwogIGNsYXNzIEhlaWdodGZpZWxkIGV4dGVuZHMgU2hhcGUgewogICAgLyoqCiAgICAgKiBBbiBhcnJheSBvZiBudW1iZXJzLCBvciBoZWlnaHQgdmFsdWVzLCB0aGF0IGFyZSBzcHJlYWQgb3V0IGFsb25nIHRoZSB4IGF4aXMuCiAgICAgKi8KCiAgICAvKioKICAgICAqIE1heCB2YWx1ZSBvZiB0aGUgZGF0YSBwb2ludHMgaW4gdGhlIGRhdGEgYXJyYXkuCiAgICAgKi8KCiAgICAvKioKICAgICAqIE1pbmltdW0gdmFsdWUgb2YgdGhlIGRhdGEgcG9pbnRzIGluIHRoZSBkYXRhIGFycmF5LgogICAgICovCgogICAgLyoqCiAgICAgKiBXb3JsZCBzcGFjaW5nIGJldHdlZW4gdGhlIGRhdGEgcG9pbnRzIGluIFggYW5kIFkgZGlyZWN0aW9uLgogICAgICogQHRvZG8gZWxlbWVudFNpemVYIGFuZCBZCiAgICAgKiBAZGVmYXVsdCAxCiAgICAgKi8KCiAgICAvKioKICAgICAqIEBkZWZhdWx0IHRydWUKICAgICAqLwoKICAgIC8qKgogICAgICogQHBhcmFtIGRhdGEgQW4gYXJyYXkgb2YgbnVtYmVycywgb3IgaGVpZ2h0IHZhbHVlcywgdGhhdCBhcmUgc3ByZWFkIG91dCBhbG9uZyB0aGUgeCBheGlzLgogICAgICovCiAgICBjb25zdHJ1Y3RvcihkYXRhLCBvcHRpb25zKSB7CiAgICAgIGlmIChvcHRpb25zID09PSB2b2lkIDApIHsKICAgICAgICBvcHRpb25zID0ge307CiAgICAgIH0KCiAgICAgIG9wdGlvbnMgPSBVdGlscy5kZWZhdWx0cyhvcHRpb25zLCB7CiAgICAgICAgbWF4VmFsdWU6IG51bGwsCiAgICAgICAgbWluVmFsdWU6IG51bGwsCiAgICAgICAgZWxlbWVudFNpemU6IDEKICAgICAgfSk7CiAgICAgIHN1cGVyKHsKICAgICAgICB0eXBlOiBTaGFwZS50eXBlcy5IRUlHSFRGSUVMRAogICAgICB9KTsKICAgICAgdGhpcy5kYXRhID0gZGF0YTsKICAgICAgdGhpcy5tYXhWYWx1ZSA9IG9wdGlvbnMubWF4VmFsdWU7CiAgICAgIHRoaXMubWluVmFsdWUgPSBvcHRpb25zLm1pblZhbHVlOwogICAgICB0aGlzLmVsZW1lbnRTaXplID0gb3B0aW9ucy5lbGVtZW50U2l6ZTsKCiAgICAgIGlmIChvcHRpb25zLm1pblZhbHVlID09PSBudWxsKSB7CiAgICAgICAgdGhpcy51cGRhdGVNaW5WYWx1ZSgpOwogICAgICB9CgogICAgICBpZiAob3B0aW9ucy5tYXhWYWx1ZSA9PT0gbnVsbCkgewogICAgICAgIHRoaXMudXBkYXRlTWF4VmFsdWUoKTsKICAgICAgfQoKICAgICAgdGhpcy5jYWNoZUVuYWJsZWQgPSB0cnVlOwogICAgICB0aGlzLnBpbGxhckNvbnZleCA9IG5ldyBDb252ZXhQb2x5aGVkcm9uKCk7CiAgICAgIHRoaXMucGlsbGFyT2Zmc2V0ID0gbmV3IFZlYzMoKTsKICAgICAgdGhpcy51cGRhdGVCb3VuZGluZ1NwaGVyZVJhZGl1cygpOyAvLyAiaV9qX2lzVXBwZXIiID0+IHsgY29udmV4OiAuLi4sIG9mZnNldDogLi4uIH0KICAgICAgLy8gZm9yIGV4YW1wbGU6CiAgICAgIC8vIF9jYWNoZWRQaWxsYXJzWyIwXzJfMSJdCgogICAgICB0aGlzLl9jYWNoZWRQaWxsYXJzID0ge307CiAgICB9CiAgICAvKioKICAgICAqIENhbGwgd2hlbmV2ZXIgeW91IGNoYW5nZSB0aGUgZGF0YSBhcnJheS4KICAgICAqLwoKCiAgICB1cGRhdGUoKSB7CiAgICAgIHRoaXMuX2NhY2hlZFBpbGxhcnMgPSB7fTsKICAgIH0KICAgIC8qKgogICAgICogVXBkYXRlIHRoZSBgbWluVmFsdWVgIHByb3BlcnR5CiAgICAgKi8KCgogICAgdXBkYXRlTWluVmFsdWUoKSB7CiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGE7CiAgICAgIGxldCBtaW5WYWx1ZSA9IGRhdGFbMF1bMF07CgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gZGF0YS5sZW5ndGg7IGkrKykgewogICAgICAgIGZvciAobGV0IGogPSAwOyBqICE9PSBkYXRhW2ldLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICBjb25zdCB2ID0gZGF0YVtpXVtqXTsKCiAgICAgICAgICBpZiAodiA8IG1pblZhbHVlKSB7CiAgICAgICAgICAgIG1pblZhbHVlID0gdjsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIHRoaXMubWluVmFsdWUgPSBtaW5WYWx1ZTsKICAgIH0KICAgIC8qKgogICAgICogVXBkYXRlIHRoZSBgbWF4VmFsdWVgIHByb3BlcnR5CiAgICAgKi8KCgogICAgdXBkYXRlTWF4VmFsdWUoKSB7CiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGE7CiAgICAgIGxldCBtYXhWYWx1ZSA9IGRhdGFbMF1bMF07CgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gZGF0YS5sZW5ndGg7IGkrKykgewogICAgICAgIGZvciAobGV0IGogPSAwOyBqICE9PSBkYXRhW2ldLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICBjb25zdCB2ID0gZGF0YVtpXVtqXTsKCiAgICAgICAgICBpZiAodiA+IG1heFZhbHVlKSB7CiAgICAgICAgICAgIG1heFZhbHVlID0gdjsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIHRoaXMubWF4VmFsdWUgPSBtYXhWYWx1ZTsKICAgIH0KICAgIC8qKgogICAgICogU2V0IHRoZSBoZWlnaHQgdmFsdWUgYXQgYW4gaW5kZXguIERvbid0IGZvcmdldCB0byB1cGRhdGUgbWF4VmFsdWUgYW5kIG1pblZhbHVlIGFmdGVyIHlvdSdyZSBkb25lLgogICAgICovCgoKICAgIHNldEhlaWdodFZhbHVlQXRJbmRleCh4aSwgeWksIHZhbHVlKSB7CiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGE7CiAgICAgIGRhdGFbeGldW3lpXSA9IHZhbHVlOyAvLyBJbnZhbGlkYXRlIGNhY2hlCgogICAgICB0aGlzLmNsZWFyQ2FjaGVkQ29udmV4VHJpYW5nbGVQaWxsYXIoeGksIHlpLCBmYWxzZSk7CgogICAgICBpZiAoeGkgPiAwKSB7CiAgICAgICAgdGhpcy5jbGVhckNhY2hlZENvbnZleFRyaWFuZ2xlUGlsbGFyKHhpIC0gMSwgeWksIHRydWUpOwogICAgICAgIHRoaXMuY2xlYXJDYWNoZWRDb252ZXhUcmlhbmdsZVBpbGxhcih4aSAtIDEsIHlpLCBmYWxzZSk7CiAgICAgIH0KCiAgICAgIGlmICh5aSA+IDApIHsKICAgICAgICB0aGlzLmNsZWFyQ2FjaGVkQ29udmV4VHJpYW5nbGVQaWxsYXIoeGksIHlpIC0gMSwgdHJ1ZSk7CiAgICAgICAgdGhpcy5jbGVhckNhY2hlZENvbnZleFRyaWFuZ2xlUGlsbGFyKHhpLCB5aSAtIDEsIGZhbHNlKTsKICAgICAgfQoKICAgICAgaWYgKHlpID4gMCAmJiB4aSA+IDApIHsKICAgICAgICB0aGlzLmNsZWFyQ2FjaGVkQ29udmV4VHJpYW5nbGVQaWxsYXIoeGkgLSAxLCB5aSAtIDEsIHRydWUpOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIEdldCBtYXgvbWluIGluIGEgcmVjdGFuZ2xlIGluIHRoZSBtYXRyaXggZGF0YQogICAgICogQHBhcmFtIHJlc3VsdCBBbiBhcnJheSB0byBzdG9yZSB0aGUgcmVzdWx0cyBpbi4KICAgICAqIEByZXR1cm4gVGhlIHJlc3VsdCBhcnJheSwgaWYgaXQgd2FzIHBhc3NlZCBpbi4gTWluaW11bSB3aWxsIGJlIGF0IHBvc2l0aW9uIDAgYW5kIG1heCBhdCAxLgogICAgICovCgoKICAgIGdldFJlY3RNaW5NYXgoaU1pblgsIGlNaW5ZLCBpTWF4WCwgaU1heFksIHJlc3VsdCkgewogICAgICBpZiAocmVzdWx0ID09PSB2b2lkIDApIHsKICAgICAgICByZXN1bHQgPSBbXTsKICAgICAgfQoKICAgICAgLy8gR2V0IG1heCBhbmQgbWluIG9mIHRoZSBkYXRhCiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGE7IC8vIFNldCBmaXJzdCB2YWx1ZQoKICAgICAgbGV0IG1heCA9IHRoaXMubWluVmFsdWU7CgogICAgICBmb3IgKGxldCBpID0gaU1pblg7IGkgPD0gaU1heFg7IGkrKykgewogICAgICAgIGZvciAobGV0IGogPSBpTWluWTsgaiA8PSBpTWF4WTsgaisrKSB7CiAgICAgICAgICBjb25zdCBoZWlnaHQgPSBkYXRhW2ldW2pdOwoKICAgICAgICAgIGlmIChoZWlnaHQgPiBtYXgpIHsKICAgICAgICAgICAgbWF4ID0gaGVpZ2h0OwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgcmVzdWx0WzBdID0gdGhpcy5taW5WYWx1ZTsKICAgICAgcmVzdWx0WzFdID0gbWF4OwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgdGhlIGluZGV4IG9mIGEgbG9jYWwgcG9zaXRpb24gb24gdGhlIGhlaWdodGZpZWxkLiBUaGUgaW5kZXhlcyBpbmRpY2F0ZSB0aGUgcmVjdGFuZ2xlcywgc28gaWYgeW91ciB0ZXJyYWluIGlzIG1hZGUgb2YgTiB4IE4gaGVpZ2h0IGRhdGEgcG9pbnRzLCB5b3Ugd2lsbCBoYXZlIHJlY3RhbmdsZSBpbmRleGVzIHJhbmdpbmcgZnJvbSAwIHRvIE4tMS4KICAgICAqIEBwYXJhbSByZXN1bHQgVHdvLWVsZW1lbnQgYXJyYXkKICAgICAqIEBwYXJhbSBjbGFtcCBJZiB0aGUgcG9zaXRpb24gc2hvdWxkIGJlIGNsYW1wZWQgdG8gdGhlIGhlaWdodGZpZWxkIGVkZ2UuCiAgICAgKi8KCgogICAgZ2V0SW5kZXhPZlBvc2l0aW9uKHgsIHksIHJlc3VsdCwgY2xhbXApIHsKICAgICAgLy8gR2V0IHRoZSBpbmRleCBvZiB0aGUgZGF0YSBwb2ludHMgdG8gdGVzdCBhZ2FpbnN0CiAgICAgIGNvbnN0IHcgPSB0aGlzLmVsZW1lbnRTaXplOwogICAgICBjb25zdCBkYXRhID0gdGhpcy5kYXRhOwogICAgICBsZXQgeGkgPSBNYXRoLmZsb29yKHggLyB3KTsKICAgICAgbGV0IHlpID0gTWF0aC5mbG9vcih5IC8gdyk7CiAgICAgIHJlc3VsdFswXSA9IHhpOwogICAgICByZXN1bHRbMV0gPSB5aTsKCiAgICAgIGlmIChjbGFtcCkgewogICAgICAgIC8vIENsYW1wIGluZGV4IHRvIGVkZ2VzCiAgICAgICAgaWYgKHhpIDwgMCkgewogICAgICAgICAgeGkgPSAwOwogICAgICAgIH0KCiAgICAgICAgaWYgKHlpIDwgMCkgewogICAgICAgICAgeWkgPSAwOwogICAgICAgIH0KCiAgICAgICAgaWYgKHhpID49IGRhdGEubGVuZ3RoIC0gMSkgewogICAgICAgICAgeGkgPSBkYXRhLmxlbmd0aCAtIDE7CiAgICAgICAgfQoKICAgICAgICBpZiAoeWkgPj0gZGF0YVswXS5sZW5ndGggLSAxKSB7CiAgICAgICAgICB5aSA9IGRhdGFbMF0ubGVuZ3RoIC0gMTsKICAgICAgICB9CiAgICAgIH0gLy8gQmFpbCBvdXQgaWYgd2UgYXJlIG91dCBvZiB0aGUgdGVycmFpbgoKCiAgICAgIGlmICh4aSA8IDAgfHwgeWkgPCAwIHx8IHhpID49IGRhdGEubGVuZ3RoIC0gMSB8fCB5aSA+PSBkYXRhWzBdLmxlbmd0aCAtIDEpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGdldFRyaWFuZ2xlQXQoeCwgeSwgZWRnZUNsYW1wLCBhLCBiLCBjKSB7CiAgICAgIGNvbnN0IGlkeCA9IGdldEhlaWdodEF0X2lkeDsKICAgICAgdGhpcy5nZXRJbmRleE9mUG9zaXRpb24oeCwgeSwgaWR4LCBlZGdlQ2xhbXApOwogICAgICBsZXQgeGkgPSBpZHhbMF07CiAgICAgIGxldCB5aSA9IGlkeFsxXTsKICAgICAgY29uc3QgZGF0YSA9IHRoaXMuZGF0YTsKCiAgICAgIGlmIChlZGdlQ2xhbXApIHsKICAgICAgICB4aSA9IE1hdGgubWluKGRhdGEubGVuZ3RoIC0gMiwgTWF0aC5tYXgoMCwgeGkpKTsKICAgICAgICB5aSA9IE1hdGgubWluKGRhdGFbMF0ubGVuZ3RoIC0gMiwgTWF0aC5tYXgoMCwgeWkpKTsKICAgICAgfQoKICAgICAgY29uc3QgZWxlbWVudFNpemUgPSB0aGlzLmVsZW1lbnRTaXplOwogICAgICBjb25zdCBsb3dlckRpc3QyID0gKHggLyBlbGVtZW50U2l6ZSAtIHhpKSAqKiAyICsgKHkgLyBlbGVtZW50U2l6ZSAtIHlpKSAqKiAyOwogICAgICBjb25zdCB1cHBlckRpc3QyID0gKHggLyBlbGVtZW50U2l6ZSAtICh4aSArIDEpKSAqKiAyICsgKHkgLyBlbGVtZW50U2l6ZSAtICh5aSArIDEpKSAqKiAyOwogICAgICBjb25zdCB1cHBlciA9IGxvd2VyRGlzdDIgPiB1cHBlckRpc3QyOwogICAgICB0aGlzLmdldFRyaWFuZ2xlKHhpLCB5aSwgdXBwZXIsIGEsIGIsIGMpOwogICAgICByZXR1cm4gdXBwZXI7CiAgICB9CgogICAgZ2V0Tm9ybWFsQXQoeCwgeSwgZWRnZUNsYW1wLCByZXN1bHQpIHsKICAgICAgY29uc3QgYSA9IGdldE5vcm1hbEF0X2E7CiAgICAgIGNvbnN0IGIgPSBnZXROb3JtYWxBdF9iOwogICAgICBjb25zdCBjID0gZ2V0Tm9ybWFsQXRfYzsKICAgICAgY29uc3QgZTAgPSBnZXROb3JtYWxBdF9lMDsKICAgICAgY29uc3QgZTEgPSBnZXROb3JtYWxBdF9lMTsKICAgICAgdGhpcy5nZXRUcmlhbmdsZUF0KHgsIHksIGVkZ2VDbGFtcCwgYSwgYiwgYyk7CiAgICAgIGIudnN1YihhLCBlMCk7CiAgICAgIGMudnN1YihhLCBlMSk7CiAgICAgIGUwLmNyb3NzKGUxLCByZXN1bHQpOwogICAgICByZXN1bHQubm9ybWFsaXplKCk7CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhbiBBQUJCIG9mIGEgc3F1YXJlIGluIHRoZSBoZWlnaHRmaWVsZAogICAgICogQHBhcmFtIHhpCiAgICAgKiBAcGFyYW0geWkKICAgICAqIEBwYXJhbSByZXN1bHQKICAgICAqLwoKCiAgICBnZXRBYWJiQXRJbmRleCh4aSwgeWksIF9yZWYpIHsKICAgICAgbGV0IHsKICAgICAgICBsb3dlckJvdW5kLAogICAgICAgIHVwcGVyQm91bmQKICAgICAgfSA9IF9yZWY7CiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGE7CiAgICAgIGNvbnN0IGVsZW1lbnRTaXplID0gdGhpcy5lbGVtZW50U2l6ZTsKICAgICAgbG93ZXJCb3VuZC5zZXQoeGkgKiBlbGVtZW50U2l6ZSwgeWkgKiBlbGVtZW50U2l6ZSwgZGF0YVt4aV1beWldKTsKICAgICAgdXBwZXJCb3VuZC5zZXQoKHhpICsgMSkgKiBlbGVtZW50U2l6ZSwgKHlpICsgMSkgKiBlbGVtZW50U2l6ZSwgZGF0YVt4aSArIDFdW3lpICsgMV0pOwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgdGhlIGhlaWdodCBpbiB0aGUgaGVpZ2h0ZmllbGQgYXQgYSBnaXZlbiBwb3NpdGlvbgogICAgICovCgoKICAgIGdldEhlaWdodEF0KHgsIHksIGVkZ2VDbGFtcCkgewogICAgICBjb25zdCBkYXRhID0gdGhpcy5kYXRhOwogICAgICBjb25zdCBhID0gZ2V0SGVpZ2h0QXRfYTsKICAgICAgY29uc3QgYiA9IGdldEhlaWdodEF0X2I7CiAgICAgIGNvbnN0IGMgPSBnZXRIZWlnaHRBdF9jOwogICAgICBjb25zdCBpZHggPSBnZXRIZWlnaHRBdF9pZHg7CiAgICAgIHRoaXMuZ2V0SW5kZXhPZlBvc2l0aW9uKHgsIHksIGlkeCwgZWRnZUNsYW1wKTsKICAgICAgbGV0IHhpID0gaWR4WzBdOwogICAgICBsZXQgeWkgPSBpZHhbMV07CgogICAgICBpZiAoZWRnZUNsYW1wKSB7CiAgICAgICAgeGkgPSBNYXRoLm1pbihkYXRhLmxlbmd0aCAtIDIsIE1hdGgubWF4KDAsIHhpKSk7CiAgICAgICAgeWkgPSBNYXRoLm1pbihkYXRhWzBdLmxlbmd0aCAtIDIsIE1hdGgubWF4KDAsIHlpKSk7CiAgICAgIH0KCiAgICAgIGNvbnN0IHVwcGVyID0gdGhpcy5nZXRUcmlhbmdsZUF0KHgsIHksIGVkZ2VDbGFtcCwgYSwgYiwgYyk7CiAgICAgIGJhcnljZW50cmljV2VpZ2h0cyh4LCB5LCBhLngsIGEueSwgYi54LCBiLnksIGMueCwgYy55LCBnZXRIZWlnaHRBdF93ZWlnaHRzKTsKICAgICAgY29uc3QgdyA9IGdldEhlaWdodEF0X3dlaWdodHM7CgogICAgICBpZiAodXBwZXIpIHsKICAgICAgICAvLyBUb3AgdHJpYW5nbGUgdmVydHMKICAgICAgICByZXR1cm4gZGF0YVt4aSArIDFdW3lpICsgMV0gKiB3LnggKyBkYXRhW3hpXVt5aSArIDFdICogdy55ICsgZGF0YVt4aSArIDFdW3lpXSAqIHcuejsKICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBUb3AgdHJpYW5nbGUgdmVydHMKICAgICAgICByZXR1cm4gZGF0YVt4aV1beWldICogdy54ICsgZGF0YVt4aSArIDFdW3lpXSAqIHcueSArIGRhdGFbeGldW3lpICsgMV0gKiB3Lno7CiAgICAgIH0KICAgIH0KCiAgICBnZXRDYWNoZUNvbnZleFRyaWFuZ2xlUGlsbGFyS2V5KHhpLCB5aSwgZ2V0VXBwZXJUcmlhbmdsZSkgewogICAgICByZXR1cm4gYCR7eGl9XyR7eWl9XyR7Z2V0VXBwZXJUcmlhbmdsZSA/IDEgOiAwfWA7CiAgICB9CgogICAgZ2V0Q2FjaGVkQ29udmV4VHJpYW5nbGVQaWxsYXIoeGksIHlpLCBnZXRVcHBlclRyaWFuZ2xlKSB7CiAgICAgIHJldHVybiB0aGlzLl9jYWNoZWRQaWxsYXJzW3RoaXMuZ2V0Q2FjaGVDb252ZXhUcmlhbmdsZVBpbGxhcktleSh4aSwgeWksIGdldFVwcGVyVHJpYW5nbGUpXTsKICAgIH0KCiAgICBzZXRDYWNoZWRDb252ZXhUcmlhbmdsZVBpbGxhcih4aSwgeWksIGdldFVwcGVyVHJpYW5nbGUsIGNvbnZleCwgb2Zmc2V0KSB7CiAgICAgIHRoaXMuX2NhY2hlZFBpbGxhcnNbdGhpcy5nZXRDYWNoZUNvbnZleFRyaWFuZ2xlUGlsbGFyS2V5KHhpLCB5aSwgZ2V0VXBwZXJUcmlhbmdsZSldID0gewogICAgICAgIGNvbnZleCwKICAgICAgICBvZmZzZXQKICAgICAgfTsKICAgIH0KCiAgICBjbGVhckNhY2hlZENvbnZleFRyaWFuZ2xlUGlsbGFyKHhpLCB5aSwgZ2V0VXBwZXJUcmlhbmdsZSkgewogICAgICBkZWxldGUgdGhpcy5fY2FjaGVkUGlsbGFyc1t0aGlzLmdldENhY2hlQ29udmV4VHJpYW5nbGVQaWxsYXJLZXkoeGksIHlpLCBnZXRVcHBlclRyaWFuZ2xlKV07CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhIHRyaWFuZ2xlIGZyb20gdGhlIGhlaWdodGZpZWxkCiAgICAgKi8KCgogICAgZ2V0VHJpYW5nbGUoeGksIHlpLCB1cHBlciwgYSwgYiwgYykgewogICAgICBjb25zdCBkYXRhID0gdGhpcy5kYXRhOwogICAgICBjb25zdCBlbGVtZW50U2l6ZSA9IHRoaXMuZWxlbWVudFNpemU7CgogICAgICBpZiAodXBwZXIpIHsKICAgICAgICAvLyBUb3AgdHJpYW5nbGUgdmVydHMKICAgICAgICBhLnNldCgoeGkgKyAxKSAqIGVsZW1lbnRTaXplLCAoeWkgKyAxKSAqIGVsZW1lbnRTaXplLCBkYXRhW3hpICsgMV1beWkgKyAxXSk7CiAgICAgICAgYi5zZXQoeGkgKiBlbGVtZW50U2l6ZSwgKHlpICsgMSkgKiBlbGVtZW50U2l6ZSwgZGF0YVt4aV1beWkgKyAxXSk7CiAgICAgICAgYy5zZXQoKHhpICsgMSkgKiBlbGVtZW50U2l6ZSwgeWkgKiBlbGVtZW50U2l6ZSwgZGF0YVt4aSArIDFdW3lpXSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gVG9wIHRyaWFuZ2xlIHZlcnRzCiAgICAgICAgYS5zZXQoeGkgKiBlbGVtZW50U2l6ZSwgeWkgKiBlbGVtZW50U2l6ZSwgZGF0YVt4aV1beWldKTsKICAgICAgICBiLnNldCgoeGkgKyAxKSAqIGVsZW1lbnRTaXplLCB5aSAqIGVsZW1lbnRTaXplLCBkYXRhW3hpICsgMV1beWldKTsKICAgICAgICBjLnNldCh4aSAqIGVsZW1lbnRTaXplLCAoeWkgKyAxKSAqIGVsZW1lbnRTaXplLCBkYXRhW3hpXVt5aSArIDFdKTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBHZXQgYSB0cmlhbmdsZSBpbiB0aGUgdGVycmFpbiBpbiB0aGUgZm9ybSBvZiBhIHRyaWFuZ3VsYXIgY29udmV4IHNoYXBlLgogICAgICovCgoKICAgIGdldENvbnZleFRyaWFuZ2xlUGlsbGFyKHhpLCB5aSwgZ2V0VXBwZXJUcmlhbmdsZSkgewogICAgICBsZXQgcmVzdWx0ID0gdGhpcy5waWxsYXJDb252ZXg7CiAgICAgIGxldCBvZmZzZXRSZXN1bHQgPSB0aGlzLnBpbGxhck9mZnNldDsKCiAgICAgIGlmICh0aGlzLmNhY2hlRW5hYmxlZCkgewogICAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLmdldENhY2hlZENvbnZleFRyaWFuZ2xlUGlsbGFyKHhpLCB5aSwgZ2V0VXBwZXJUcmlhbmdsZSk7CgogICAgICAgIGlmIChkYXRhKSB7CiAgICAgICAgICB0aGlzLnBpbGxhckNvbnZleCA9IGRhdGEuY29udmV4OwogICAgICAgICAgdGhpcy5waWxsYXJPZmZzZXQgPSBkYXRhLm9mZnNldDsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIHJlc3VsdCA9IG5ldyBDb252ZXhQb2x5aGVkcm9uKCk7CiAgICAgICAgb2Zmc2V0UmVzdWx0ID0gbmV3IFZlYzMoKTsKICAgICAgICB0aGlzLnBpbGxhckNvbnZleCA9IHJlc3VsdDsKICAgICAgICB0aGlzLnBpbGxhck9mZnNldCA9IG9mZnNldFJlc3VsdDsKICAgICAgfQoKICAgICAgY29uc3QgZGF0YSA9IHRoaXMuZGF0YTsKICAgICAgY29uc3QgZWxlbWVudFNpemUgPSB0aGlzLmVsZW1lbnRTaXplOwogICAgICBjb25zdCBmYWNlcyA9IHJlc3VsdC5mYWNlczsgLy8gUmV1c2UgdmVydHMgaWYgcG9zc2libGUKCiAgICAgIHJlc3VsdC52ZXJ0aWNlcy5sZW5ndGggPSA2OwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCA2OyBpKyspIHsKICAgICAgICBpZiAoIXJlc3VsdC52ZXJ0aWNlc1tpXSkgewogICAgICAgICAgcmVzdWx0LnZlcnRpY2VzW2ldID0gbmV3IFZlYzMoKTsKICAgICAgICB9CiAgICAgIH0gLy8gUmV1c2UgZmFjZXMgaWYgcG9zc2libGUKCgogICAgICBmYWNlcy5sZW5ndGggPSA1OwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCA1OyBpKyspIHsKICAgICAgICBpZiAoIWZhY2VzW2ldKSB7CiAgICAgICAgICBmYWNlc1tpXSA9IFtdOwogICAgICAgIH0KICAgICAgfQoKICAgICAgY29uc3QgdmVydHMgPSByZXN1bHQudmVydGljZXM7CiAgICAgIGNvbnN0IGggPSAoTWF0aC5taW4oZGF0YVt4aV1beWldLCBkYXRhW3hpICsgMV1beWldLCBkYXRhW3hpXVt5aSArIDFdLCBkYXRhW3hpICsgMV1beWkgKyAxXSkgLSB0aGlzLm1pblZhbHVlKSAvIDIgKyB0aGlzLm1pblZhbHVlOwoKICAgICAgaWYgKCFnZXRVcHBlclRyaWFuZ2xlKSB7CiAgICAgICAgLy8gQ2VudGVyIG9mIHRoZSB0cmlhbmdsZSBwaWxsYXIgLSBhbGwgcG9seWdvbnMgYXJlIGdpdmVuIHJlbGF0aXZlIHRvIHRoaXMgb25lCiAgICAgICAgb2Zmc2V0UmVzdWx0LnNldCgoeGkgKyAwLjI1KSAqIGVsZW1lbnRTaXplLCAvLyBzb3J0IG9mIGNlbnRlciBvZiBhIHRyaWFuZ2xlCiAgICAgICAgKHlpICsgMC4yNSkgKiBlbGVtZW50U2l6ZSwgaCAvLyB2ZXJ0aWNhbCBjZW50ZXIKICAgICAgICApOyAvLyBUb3AgdHJpYW5nbGUgdmVydHMKCiAgICAgICAgdmVydHNbMF0uc2V0KC0wLjI1ICogZWxlbWVudFNpemUsIC0wLjI1ICogZWxlbWVudFNpemUsIGRhdGFbeGldW3lpXSAtIGgpOwogICAgICAgIHZlcnRzWzFdLnNldCgwLjc1ICogZWxlbWVudFNpemUsIC0wLjI1ICogZWxlbWVudFNpemUsIGRhdGFbeGkgKyAxXVt5aV0gLSBoKTsKICAgICAgICB2ZXJ0c1syXS5zZXQoLTAuMjUgKiBlbGVtZW50U2l6ZSwgMC43NSAqIGVsZW1lbnRTaXplLCBkYXRhW3hpXVt5aSArIDFdIC0gaCk7IC8vIGJvdHRvbSB0cmlhbmdsZSB2ZXJ0cwoKICAgICAgICB2ZXJ0c1szXS5zZXQoLTAuMjUgKiBlbGVtZW50U2l6ZSwgLTAuMjUgKiBlbGVtZW50U2l6ZSwgLU1hdGguYWJzKGgpIC0gMSk7CiAgICAgICAgdmVydHNbNF0uc2V0KDAuNzUgKiBlbGVtZW50U2l6ZSwgLTAuMjUgKiBlbGVtZW50U2l6ZSwgLU1hdGguYWJzKGgpIC0gMSk7CiAgICAgICAgdmVydHNbNV0uc2V0KC0wLjI1ICogZWxlbWVudFNpemUsIDAuNzUgKiBlbGVtZW50U2l6ZSwgLU1hdGguYWJzKGgpIC0gMSk7IC8vIHRvcCB0cmlhbmdsZQoKICAgICAgICBmYWNlc1swXVswXSA9IDA7CiAgICAgICAgZmFjZXNbMF1bMV0gPSAxOwogICAgICAgIGZhY2VzWzBdWzJdID0gMjsgLy8gYm90dG9tIHRyaWFuZ2xlCgogICAgICAgIGZhY2VzWzFdWzBdID0gNTsKICAgICAgICBmYWNlc1sxXVsxXSA9IDQ7CiAgICAgICAgZmFjZXNbMV1bMl0gPSAzOyAvLyAteCBmYWNpbmcgcXVhZAoKICAgICAgICBmYWNlc1syXVswXSA9IDA7CiAgICAgICAgZmFjZXNbMl1bMV0gPSAyOwogICAgICAgIGZhY2VzWzJdWzJdID0gNTsKICAgICAgICBmYWNlc1syXVszXSA9IDM7IC8vIC15IGZhY2luZyBxdWFkCgogICAgICAgIGZhY2VzWzNdWzBdID0gMTsKICAgICAgICBmYWNlc1szXVsxXSA9IDA7CiAgICAgICAgZmFjZXNbM11bMl0gPSAzOwogICAgICAgIGZhY2VzWzNdWzNdID0gNDsgLy8gK3h5IGZhY2luZyBxdWFkCgogICAgICAgIGZhY2VzWzRdWzBdID0gNDsKICAgICAgICBmYWNlc1s0XVsxXSA9IDU7CiAgICAgICAgZmFjZXNbNF1bMl0gPSAyOwogICAgICAgIGZhY2VzWzRdWzNdID0gMTsKICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBDZW50ZXIgb2YgdGhlIHRyaWFuZ2xlIHBpbGxhciAtIGFsbCBwb2x5Z29ucyBhcmUgZ2l2ZW4gcmVsYXRpdmUgdG8gdGhpcyBvbmUKICAgICAgICBvZmZzZXRSZXN1bHQuc2V0KCh4aSArIDAuNzUpICogZWxlbWVudFNpemUsIC8vIHNvcnQgb2YgY2VudGVyIG9mIGEgdHJpYW5nbGUKICAgICAgICAoeWkgKyAwLjc1KSAqIGVsZW1lbnRTaXplLCBoIC8vIHZlcnRpY2FsIGNlbnRlcgogICAgICAgICk7IC8vIFRvcCB0cmlhbmdsZSB2ZXJ0cwoKICAgICAgICB2ZXJ0c1swXS5zZXQoMC4yNSAqIGVsZW1lbnRTaXplLCAwLjI1ICogZWxlbWVudFNpemUsIGRhdGFbeGkgKyAxXVt5aSArIDFdIC0gaCk7CiAgICAgICAgdmVydHNbMV0uc2V0KC0wLjc1ICogZWxlbWVudFNpemUsIDAuMjUgKiBlbGVtZW50U2l6ZSwgZGF0YVt4aV1beWkgKyAxXSAtIGgpOwogICAgICAgIHZlcnRzWzJdLnNldCgwLjI1ICogZWxlbWVudFNpemUsIC0wLjc1ICogZWxlbWVudFNpemUsIGRhdGFbeGkgKyAxXVt5aV0gLSBoKTsgLy8gYm90dG9tIHRyaWFuZ2xlIHZlcnRzCgogICAgICAgIHZlcnRzWzNdLnNldCgwLjI1ICogZWxlbWVudFNpemUsIDAuMjUgKiBlbGVtZW50U2l6ZSwgLU1hdGguYWJzKGgpIC0gMSk7CiAgICAgICAgdmVydHNbNF0uc2V0KC0wLjc1ICogZWxlbWVudFNpemUsIDAuMjUgKiBlbGVtZW50U2l6ZSwgLU1hdGguYWJzKGgpIC0gMSk7CiAgICAgICAgdmVydHNbNV0uc2V0KDAuMjUgKiBlbGVtZW50U2l6ZSwgLTAuNzUgKiBlbGVtZW50U2l6ZSwgLU1hdGguYWJzKGgpIC0gMSk7IC8vIFRvcCB0cmlhbmdsZQoKICAgICAgICBmYWNlc1swXVswXSA9IDA7CiAgICAgICAgZmFjZXNbMF1bMV0gPSAxOwogICAgICAgIGZhY2VzWzBdWzJdID0gMjsgLy8gYm90dG9tIHRyaWFuZ2xlCgogICAgICAgIGZhY2VzWzFdWzBdID0gNTsKICAgICAgICBmYWNlc1sxXVsxXSA9IDQ7CiAgICAgICAgZmFjZXNbMV1bMl0gPSAzOyAvLyAreCBmYWNpbmcgcXVhZAoKICAgICAgICBmYWNlc1syXVswXSA9IDI7CiAgICAgICAgZmFjZXNbMl1bMV0gPSA1OwogICAgICAgIGZhY2VzWzJdWzJdID0gMzsKICAgICAgICBmYWNlc1syXVszXSA9IDA7IC8vICt5IGZhY2luZyBxdWFkCgogICAgICAgIGZhY2VzWzNdWzBdID0gMzsKICAgICAgICBmYWNlc1szXVsxXSA9IDQ7CiAgICAgICAgZmFjZXNbM11bMl0gPSAxOwogICAgICAgIGZhY2VzWzNdWzNdID0gMDsgLy8gLXh5IGZhY2luZyBxdWFkCgogICAgICAgIGZhY2VzWzRdWzBdID0gMTsKICAgICAgICBmYWNlc1s0XVsxXSA9IDQ7CiAgICAgICAgZmFjZXNbNF1bMl0gPSA1OwogICAgICAgIGZhY2VzWzRdWzNdID0gMjsKICAgICAgfQoKICAgICAgcmVzdWx0LmNvbXB1dGVOb3JtYWxzKCk7CiAgICAgIHJlc3VsdC5jb21wdXRlRWRnZXMoKTsKICAgICAgcmVzdWx0LnVwZGF0ZUJvdW5kaW5nU3BoZXJlUmFkaXVzKCk7CiAgICAgIHRoaXMuc2V0Q2FjaGVkQ29udmV4VHJpYW5nbGVQaWxsYXIoeGksIHlpLCBnZXRVcHBlclRyaWFuZ2xlLCByZXN1bHQsIG9mZnNldFJlc3VsdCk7CiAgICB9CgogICAgY2FsY3VsYXRlTG9jYWxJbmVydGlhKG1hc3MsIHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB2b2lkIDApIHsKICAgICAgICB0YXJnZXQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICB0YXJnZXQuc2V0KDAsIDAsIDApOwogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQoKICAgIHZvbHVtZSgpIHsKICAgICAgcmV0dXJuICgvLyBUaGUgdGVycmFpbiBpcyBpbmZpbml0ZQogICAgICAgIE51bWJlci5NQVhfVkFMVUUKICAgICAgKTsKICAgIH0KCiAgICBjYWxjdWxhdGVXb3JsZEFBQkIocG9zLCBxdWF0LCBtaW4sIG1heCkgewogICAgICAvKiogQFRPRE8gZG8gaXQgcHJvcGVybHkgKi8KICAgICAgbWluLnNldCgtTnVtYmVyLk1BWF9WQUxVRSwgLU51bWJlci5NQVhfVkFMVUUsIC1OdW1iZXIuTUFYX1ZBTFVFKTsKICAgICAgbWF4LnNldChOdW1iZXIuTUFYX1ZBTFVFLCBOdW1iZXIuTUFYX1ZBTFVFLCBOdW1iZXIuTUFYX1ZBTFVFKTsKICAgIH0KCiAgICB1cGRhdGVCb3VuZGluZ1NwaGVyZVJhZGl1cygpIHsKICAgICAgLy8gVXNlIHRoZSBib3VuZGluZyBib3ggb2YgdGhlIG1pbi9tYXggdmFsdWVzCiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGE7CiAgICAgIGNvbnN0IHMgPSB0aGlzLmVsZW1lbnRTaXplOwogICAgICB0aGlzLmJvdW5kaW5nU3BoZXJlUmFkaXVzID0gbmV3IFZlYzMoZGF0YS5sZW5ndGggKiBzLCBkYXRhWzBdLmxlbmd0aCAqIHMsIE1hdGgubWF4KE1hdGguYWJzKHRoaXMubWF4VmFsdWUpLCBNYXRoLmFicyh0aGlzLm1pblZhbHVlKSkpLmxlbmd0aCgpOwogICAgfQogICAgLyoqCiAgICAgKiBTZXRzIHRoZSBoZWlnaHQgdmFsdWVzIGZyb20gYW4gaW1hZ2UuIEN1cnJlbnRseSBvbmx5IHN1cHBvcnRlZCBpbiBicm93c2VyLgogICAgICovCgoKICAgIHNldEhlaWdodHNGcm9tSW1hZ2UoaW1hZ2UsIHNjYWxlKSB7CiAgICAgIGNvbnN0IHsKICAgICAgICB4LAogICAgICAgIHosCiAgICAgICAgeQogICAgICB9ID0gc2NhbGU7CiAgICAgIGNvbnN0IGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpOwogICAgICBjYW52YXMud2lkdGggPSBpbWFnZS53aWR0aDsKICAgICAgY2FudmFzLmhlaWdodCA9IGltYWdlLmhlaWdodDsKICAgICAgY29uc3QgY29udGV4dCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpOwogICAgICBjb250ZXh0LmRyYXdJbWFnZShpbWFnZSwgMCwgMCk7CiAgICAgIGNvbnN0IGltYWdlRGF0YSA9IGNvbnRleHQuZ2V0SW1hZ2VEYXRhKDAsIDAsIGltYWdlLndpZHRoLCBpbWFnZS5oZWlnaHQpOwogICAgICBjb25zdCBtYXRyaXggPSB0aGlzLmRhdGE7CiAgICAgIG1hdHJpeC5sZW5ndGggPSAwOwogICAgICB0aGlzLmVsZW1lbnRTaXplID0gTWF0aC5hYnMoeCkgLyBpbWFnZURhdGEud2lkdGg7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGltYWdlRGF0YS5oZWlnaHQ7IGkrKykgewogICAgICAgIGNvbnN0IHJvdyA9IFtdOwoKICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGltYWdlRGF0YS53aWR0aDsgaisrKSB7CiAgICAgICAgICBjb25zdCBhID0gaW1hZ2VEYXRhLmRhdGFbKGkgKiBpbWFnZURhdGEuaGVpZ2h0ICsgaikgKiA0XTsKICAgICAgICAgIGNvbnN0IGIgPSBpbWFnZURhdGEuZGF0YVsoaSAqIGltYWdlRGF0YS5oZWlnaHQgKyBqKSAqIDQgKyAxXTsKICAgICAgICAgIGNvbnN0IGMgPSBpbWFnZURhdGEuZGF0YVsoaSAqIGltYWdlRGF0YS5oZWlnaHQgKyBqKSAqIDQgKyAyXTsKICAgICAgICAgIGNvbnN0IGhlaWdodCA9IChhICsgYiArIGMpIC8gNCAvIDI1NSAqIHo7CgogICAgICAgICAgaWYgKHggPCAwKSB7CiAgICAgICAgICAgIHJvdy5wdXNoKGhlaWdodCk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByb3cudW5zaGlmdChoZWlnaHQpOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKHkgPCAwKSB7CiAgICAgICAgICBtYXRyaXgudW5zaGlmdChyb3cpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBtYXRyaXgucHVzaChyb3cpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhpcy51cGRhdGVNYXhWYWx1ZSgpOwogICAgICB0aGlzLnVwZGF0ZU1pblZhbHVlKCk7CiAgICAgIHRoaXMudXBkYXRlKCk7CiAgICB9CgogIH0KICBjb25zdCBnZXRIZWlnaHRBdF9pZHggPSBbXTsKICBjb25zdCBnZXRIZWlnaHRBdF93ZWlnaHRzID0gbmV3IFZlYzMoKTsKICBjb25zdCBnZXRIZWlnaHRBdF9hID0gbmV3IFZlYzMoKTsKICBjb25zdCBnZXRIZWlnaHRBdF9iID0gbmV3IFZlYzMoKTsKICBjb25zdCBnZXRIZWlnaHRBdF9jID0gbmV3IFZlYzMoKTsKICBjb25zdCBnZXROb3JtYWxBdF9hID0gbmV3IFZlYzMoKTsKICBjb25zdCBnZXROb3JtYWxBdF9iID0gbmV3IFZlYzMoKTsKICBjb25zdCBnZXROb3JtYWxBdF9jID0gbmV3IFZlYzMoKTsKICBjb25zdCBnZXROb3JtYWxBdF9lMCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgZ2V0Tm9ybWFsQXRfZTEgPSBuZXcgVmVjMygpOyAvLyBmcm9tIGh0dHBzOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0JhcnljZW50cmljX2Nvb3JkaW5hdGVfc3lzdGVtCgogIGZ1bmN0aW9uIGJhcnljZW50cmljV2VpZ2h0cyh4LCB5LCBheCwgYXksIGJ4LCBieSwgY3gsIGN5LCByZXN1bHQpIHsKICAgIHJlc3VsdC54ID0gKChieSAtIGN5KSAqICh4IC0gY3gpICsgKGN4IC0gYngpICogKHkgLSBjeSkpIC8gKChieSAtIGN5KSAqIChheCAtIGN4KSArIChjeCAtIGJ4KSAqIChheSAtIGN5KSk7CiAgICByZXN1bHQueSA9ICgoY3kgLSBheSkgKiAoeCAtIGN4KSArIChheCAtIGN4KSAqICh5IC0gY3kpKSAvICgoYnkgLSBjeSkgKiAoYXggLSBjeCkgKyAoY3ggLSBieCkgKiAoYXkgLSBjeSkpOwogICAgcmVzdWx0LnogPSAxIC0gcmVzdWx0LnggLSByZXN1bHQueTsKICB9CgogIC8qKgogICAqIE9jdHJlZU5vZGUKICAgKi8KICBjbGFzcyBPY3RyZWVOb2RlIHsKICAgIC8qKiBUaGUgcm9vdCBub2RlICovCgogICAgLyoqIEJvdW5kYXJ5IG9mIHRoaXMgbm9kZSAqLwoKICAgIC8qKiBDb250YWluZWQgZGF0YSBhdCB0aGUgY3VycmVudCBub2RlIGxldmVsICovCgogICAgLyoqIENoaWxkcmVuIHRvIHRoaXMgbm9kZSAqLwogICAgY29uc3RydWN0b3Iob3B0aW9ucykgewogICAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7CiAgICAgICAgb3B0aW9ucyA9IHt9OwogICAgICB9CgogICAgICB0aGlzLnJvb3QgPSBvcHRpb25zLnJvb3QgfHwgbnVsbDsKICAgICAgdGhpcy5hYWJiID0gb3B0aW9ucy5hYWJiID8gb3B0aW9ucy5hYWJiLmNsb25lKCkgOiBuZXcgQUFCQigpOwogICAgICB0aGlzLmRhdGEgPSBbXTsKICAgICAgdGhpcy5jaGlsZHJlbiA9IFtdOwogICAgfQogICAgLyoqCiAgICAgKiByZXNldAogICAgICovCgoKICAgIHJlc2V0KCkgewogICAgICB0aGlzLmNoaWxkcmVuLmxlbmd0aCA9IHRoaXMuZGF0YS5sZW5ndGggPSAwOwogICAgfQogICAgLyoqCiAgICAgKiBJbnNlcnQgZGF0YSBpbnRvIHRoaXMgbm9kZQogICAgICogQHJldHVybiBUcnVlIGlmIHN1Y2Nlc3NmdWwsIG90aGVyd2lzZSBmYWxzZQogICAgICovCgoKICAgIGluc2VydChhYWJiLCBlbGVtZW50RGF0YSwgbGV2ZWwpIHsKICAgICAgaWYgKGxldmVsID09PSB2b2lkIDApIHsKICAgICAgICBsZXZlbCA9IDA7CiAgICAgIH0KCiAgICAgIGNvbnN0IG5vZGVEYXRhID0gdGhpcy5kYXRhOyAvLyBJZ25vcmUgb2JqZWN0cyB0aGF0IGRvIG5vdCBiZWxvbmcgaW4gdGhpcyBub2RlCgogICAgICBpZiAoIXRoaXMuYWFiYi5jb250YWlucyhhYWJiKSkgewogICAgICAgIHJldHVybiBmYWxzZTsgLy8gb2JqZWN0IGNhbm5vdCBiZSBhZGRlZAogICAgICB9CgogICAgICBjb25zdCBjaGlsZHJlbiA9IHRoaXMuY2hpbGRyZW47CiAgICAgIGNvbnN0IG1heERlcHRoID0gdGhpcy5tYXhEZXB0aCB8fCB0aGlzLnJvb3QubWF4RGVwdGg7CgogICAgICBpZiAobGV2ZWwgPCBtYXhEZXB0aCkgewogICAgICAgIC8vIFN1YmRpdmlkZSBpZiB0aGVyZSBhcmUgbm8gY2hpbGRyZW4geWV0CiAgICAgICAgbGV0IHN1YmRpdmlkZWQgPSBmYWxzZTsKCiAgICAgICAgaWYgKCFjaGlsZHJlbi5sZW5ndGgpIHsKICAgICAgICAgIHRoaXMuc3ViZGl2aWRlKCk7CiAgICAgICAgICBzdWJkaXZpZGVkID0gdHJ1ZTsKICAgICAgICB9IC8vIGFkZCB0byB3aGljaGV2ZXIgbm9kZSB3aWxsIGFjY2VwdCBpdAoKCiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IDg7IGkrKykgewogICAgICAgICAgaWYgKGNoaWxkcmVuW2ldLmluc2VydChhYWJiLCBlbGVtZW50RGF0YSwgbGV2ZWwgKyAxKSkgewogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmIChzdWJkaXZpZGVkKSB7CiAgICAgICAgICAvLyBObyBjaGlsZHJlbiBhY2NlcHRlZCEgTWlnaHQgYXMgd2VsbCBqdXN0IHJlbW92ZSBlbSBzaW5jZSB0aGV5IGNvbnRhaW4gbm9uZQogICAgICAgICAgY2hpbGRyZW4ubGVuZ3RoID0gMDsKICAgICAgICB9CiAgICAgIH0gLy8gVG9vIGRlZXAsIG9yIGNoaWxkcmVuIGRpZG50IHdhbnQgaXQuIGFkZCBpdCBpbiBjdXJyZW50IG5vZGUKCgogICAgICBub2RlRGF0YS5wdXNoKGVsZW1lbnREYXRhKTsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgICAvKioKICAgICAqIENyZWF0ZSA4IGVxdWFsbHkgc2l6ZWQgY2hpbGRyZW4gbm9kZXMgYW5kIHB1dCB0aGVtIGluIHRoZSBgY2hpbGRyZW5gIGFycmF5LgogICAgICovCgoKICAgIHN1YmRpdmlkZSgpIHsKICAgICAgY29uc3QgYWFiYiA9IHRoaXMuYWFiYjsKICAgICAgY29uc3QgbCA9IGFhYmIubG93ZXJCb3VuZDsKICAgICAgY29uc3QgdSA9IGFhYmIudXBwZXJCb3VuZDsKICAgICAgY29uc3QgY2hpbGRyZW4gPSB0aGlzLmNoaWxkcmVuOwogICAgICBjaGlsZHJlbi5wdXNoKG5ldyBPY3RyZWVOb2RlKHsKICAgICAgICBhYWJiOiBuZXcgQUFCQih7CiAgICAgICAgICBsb3dlckJvdW5kOiBuZXcgVmVjMygwLCAwLCAwKQogICAgICAgIH0pCiAgICAgIH0pLCBuZXcgT2N0cmVlTm9kZSh7CiAgICAgICAgYWFiYjogbmV3IEFBQkIoewogICAgICAgICAgbG93ZXJCb3VuZDogbmV3IFZlYzMoMSwgMCwgMCkKICAgICAgICB9KQogICAgICB9KSwgbmV3IE9jdHJlZU5vZGUoewogICAgICAgIGFhYmI6IG5ldyBBQUJCKHsKICAgICAgICAgIGxvd2VyQm91bmQ6IG5ldyBWZWMzKDEsIDEsIDApCiAgICAgICAgfSkKICAgICAgfSksIG5ldyBPY3RyZWVOb2RlKHsKICAgICAgICBhYWJiOiBuZXcgQUFCQih7CiAgICAgICAgICBsb3dlckJvdW5kOiBuZXcgVmVjMygxLCAxLCAxKQogICAgICAgIH0pCiAgICAgIH0pLCBuZXcgT2N0cmVlTm9kZSh7CiAgICAgICAgYWFiYjogbmV3IEFBQkIoewogICAgICAgICAgbG93ZXJCb3VuZDogbmV3IFZlYzMoMCwgMSwgMSkKICAgICAgICB9KQogICAgICB9KSwgbmV3IE9jdHJlZU5vZGUoewogICAgICAgIGFhYmI6IG5ldyBBQUJCKHsKICAgICAgICAgIGxvd2VyQm91bmQ6IG5ldyBWZWMzKDAsIDAsIDEpCiAgICAgICAgfSkKICAgICAgfSksIG5ldyBPY3RyZWVOb2RlKHsKICAgICAgICBhYWJiOiBuZXcgQUFCQih7CiAgICAgICAgICBsb3dlckJvdW5kOiBuZXcgVmVjMygxLCAwLCAxKQogICAgICAgIH0pCiAgICAgIH0pLCBuZXcgT2N0cmVlTm9kZSh7CiAgICAgICAgYWFiYjogbmV3IEFBQkIoewogICAgICAgICAgbG93ZXJCb3VuZDogbmV3IFZlYzMoMCwgMSwgMCkKICAgICAgICB9KQogICAgICB9KSk7CiAgICAgIHUudnN1YihsLCBoYWxmRGlhZ29uYWwpOwogICAgICBoYWxmRGlhZ29uYWwuc2NhbGUoMC41LCBoYWxmRGlhZ29uYWwpOwogICAgICBjb25zdCByb290ID0gdGhpcy5yb290IHx8IHRoaXM7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gODsgaSsrKSB7CiAgICAgICAgY29uc3QgY2hpbGQgPSBjaGlsZHJlbltpXTsgLy8gU2V0IGN1cnJlbnQgbm9kZSBhcyByb290CgogICAgICAgIGNoaWxkLnJvb3QgPSByb290OyAvLyBDb21wdXRlIGJvdW5kcwoKICAgICAgICBjb25zdCBsb3dlckJvdW5kID0gY2hpbGQuYWFiYi5sb3dlckJvdW5kOwogICAgICAgIGxvd2VyQm91bmQueCAqPSBoYWxmRGlhZ29uYWwueDsKICAgICAgICBsb3dlckJvdW5kLnkgKj0gaGFsZkRpYWdvbmFsLnk7CiAgICAgICAgbG93ZXJCb3VuZC56ICo9IGhhbGZEaWFnb25hbC56OwogICAgICAgIGxvd2VyQm91bmQudmFkZChsLCBsb3dlckJvdW5kKTsgLy8gVXBwZXIgYm91bmQgaXMgYWx3YXlzIGxvd2VyIGJvdW5kICsgaGFsZkRpYWdvbmFsCgogICAgICAgIGxvd2VyQm91bmQudmFkZChoYWxmRGlhZ29uYWwsIGNoaWxkLmFhYmIudXBwZXJCb3VuZCk7CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogR2V0IGFsbCBkYXRhLCBwb3RlbnRpYWxseSB3aXRoaW4gYW4gQUFCQgogICAgICogQHJldHVybiBUaGUgInJlc3VsdCIgb2JqZWN0CiAgICAgKi8KCgogICAgYWFiYlF1ZXJ5KGFhYmIsIHJlc3VsdCkgewogICAgICB0aGlzLmRhdGE7IC8vIGFib3J0IGlmIHRoZSByYW5nZSBkb2VzIG5vdCBpbnRlcnNlY3QgdGhpcyBub2RlCiAgICAgIC8vIGlmICghdGhpcy5hYWJiLm92ZXJsYXBzKGFhYmIpKXsKICAgICAgLy8gICAgIHJldHVybiByZXN1bHQ7CiAgICAgIC8vIH0KICAgICAgLy8gQWRkIG9iamVjdHMgYXQgdGhpcyBsZXZlbAogICAgICAvLyBBcnJheS5wcm90b3R5cGUucHVzaC5hcHBseShyZXN1bHQsIG5vZGVEYXRhKTsKICAgICAgLy8gQWRkIGNoaWxkIGRhdGEKICAgICAgLy8gQHRvZG8gdW53cmFwIHJlY3Vyc2lvbiBpbnRvIGEgcXVldWUgLyBsb29wLCB0aGF0J3MgZmFzdGVyIGluIEpTCgogICAgICB0aGlzLmNoaWxkcmVuOyAvLyBmb3IgKGxldCBpID0gMCwgTiA9IHRoaXMuY2hpbGRyZW4ubGVuZ3RoOyBpICE9PSBOOyBpKyspIHsKICAgICAgLy8gICAgIGNoaWxkcmVuW2ldLmFhYmJRdWVyeShhYWJiLCByZXN1bHQpOwogICAgICAvLyB9CgogICAgICBjb25zdCBxdWV1ZSA9IFt0aGlzXTsKCiAgICAgIHdoaWxlIChxdWV1ZS5sZW5ndGgpIHsKICAgICAgICBjb25zdCBub2RlID0gcXVldWUucG9wKCk7CgogICAgICAgIGlmIChub2RlLmFhYmIub3ZlcmxhcHMoYWFiYikpIHsKICAgICAgICAgIEFycmF5LnByb3RvdHlwZS5wdXNoLmFwcGx5KHJlc3VsdCwgbm9kZS5kYXRhKTsKICAgICAgICB9CgogICAgICAgIEFycmF5LnByb3RvdHlwZS5wdXNoLmFwcGx5KHF1ZXVlLCBub2RlLmNoaWxkcmVuKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KICAgIC8qKgogICAgICogR2V0IGFsbCBkYXRhLCBwb3RlbnRpYWxseSBpbnRlcnNlY3RlZCBieSBhIHJheS4KICAgICAqIEByZXR1cm4gVGhlICJyZXN1bHQiIG9iamVjdAogICAgICovCgoKICAgIHJheVF1ZXJ5KHJheSwgdHJlZVRyYW5zZm9ybSwgcmVzdWx0KSB7CiAgICAgIC8vIFVzZSBhYWJiIHF1ZXJ5IGZvciBub3cuCgogICAgICAvKiogQHRvZG8gaW1wbGVtZW50IHJlYWwgcmF5IHF1ZXJ5IHdoaWNoIG5lZWRzIGxlc3MgbG9va3VwcyAqLwogICAgICByYXkuZ2V0QUFCQih0bXBBQUJCKTsKICAgICAgdG1wQUFCQi50b0xvY2FsRnJhbWUodHJlZVRyYW5zZm9ybSwgdG1wQUFCQik7CiAgICAgIHRoaXMuYWFiYlF1ZXJ5KHRtcEFBQkIsIHJlc3VsdCk7CiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CiAgICAvKioKICAgICAqIHJlbW92ZUVtcHR5Tm9kZXMKICAgICAqLwoKCiAgICByZW1vdmVFbXB0eU5vZGVzKCkgewogICAgICBmb3IgKGxldCBpID0gdGhpcy5jaGlsZHJlbi5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgewogICAgICAgIHRoaXMuY2hpbGRyZW5baV0ucmVtb3ZlRW1wdHlOb2RlcygpOwoKICAgICAgICBpZiAoIXRoaXMuY2hpbGRyZW5baV0uY2hpbGRyZW4ubGVuZ3RoICYmICF0aGlzLmNoaWxkcmVuW2ldLmRhdGEubGVuZ3RoKSB7CiAgICAgICAgICB0aGlzLmNoaWxkcmVuLnNwbGljZShpLCAxKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgfQogIC8qKgogICAqIE9jdHJlZQogICAqLwoKCiAgY2xhc3MgT2N0cmVlIGV4dGVuZHMgT2N0cmVlTm9kZSB7CiAgICAvKioKICAgICAqIE1heGltdW0gc3ViZGl2aXNpb24gZGVwdGgKICAgICAqIEBkZWZhdWx0IDgKICAgICAqLwoKICAgIC8qKgogICAgICogQHBhcmFtIGFhYmIgVGhlIHRvdGFsIEFBQkIgb2YgdGhlIHRyZWUKICAgICAqLwogICAgY29uc3RydWN0b3IoYWFiYiwgb3B0aW9ucykgewogICAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7CiAgICAgICAgb3B0aW9ucyA9IHt9OwogICAgICB9CgogICAgICBzdXBlcih7CiAgICAgICAgcm9vdDogbnVsbCwKICAgICAgICBhYWJiCiAgICAgIH0pOwogICAgICB0aGlzLm1heERlcHRoID0gdHlwZW9mIG9wdGlvbnMubWF4RGVwdGggIT09ICd1bmRlZmluZWQnID8gb3B0aW9ucy5tYXhEZXB0aCA6IDg7CiAgICB9CgogIH0KICBjb25zdCBoYWxmRGlhZ29uYWwgPSBuZXcgVmVjMygpOwogIGNvbnN0IHRtcEFBQkIgPSBuZXcgQUFCQigpOwoKICAvKioKICAgKiBUcmltZXNoLgogICAqIEBleGFtcGxlCiAgICogICAgIC8vIEhvdyB0byBtYWtlIGEgbWVzaCB3aXRoIGEgc2luZ2xlIHRyaWFuZ2xlCiAgICogICAgIGNvbnN0IHZlcnRpY2VzID0gWwogICAqICAgICAgICAgMCwgMCwgMCwgLy8gdmVydGV4IDAKICAgKiAgICAgICAgIDEsIDAsIDAsIC8vIHZlcnRleCAxCiAgICogICAgICAgICAwLCAxLCAwICAvLyB2ZXJ0ZXggMgogICAqICAgICBdCiAgICogICAgIGNvbnN0IGluZGljZXMgPSBbCiAgICogICAgICAgICAwLCAxLCAyICAvLyB0cmlhbmdsZSAwCiAgICogICAgIF0KICAgKiAgICAgY29uc3QgdHJpbWVzaFNoYXBlID0gbmV3IENBTk5PTi5UcmltZXNoKHZlcnRpY2VzLCBpbmRpY2VzKQogICAqLwogIGNsYXNzIFRyaW1lc2ggZXh0ZW5kcyBTaGFwZSB7CiAgICAvKioKICAgICAqIHZlcnRpY2VzCiAgICAgKi8KCiAgICAvKioKICAgICAqIEFycmF5IG9mIGludGVnZXJzLCBpbmRpY2F0aW5nIHdoaWNoIHZlcnRpY2VzIGVhY2ggdHJpYW5nbGUgY29uc2lzdHMgb2YuIFRoZSBsZW5ndGggb2YgdGhpcyBhcnJheSBpcyB0aHVzIDMgdGltZXMgdGhlIG51bWJlciBvZiB0cmlhbmdsZXMuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFRoZSBub3JtYWxzIGRhdGEuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFRoZSBsb2NhbCBBQUJCIG9mIHRoZSBtZXNoLgogICAgICovCgogICAgLyoqCiAgICAgKiBSZWZlcmVuY2VzIHRvIHZlcnRleCBwYWlycywgbWFraW5nIHVwIGFsbCB1bmlxdWUgZWRnZXMgaW4gdGhlIHRyaW1lc2guCiAgICAgKi8KCiAgICAvKioKICAgICAqIExvY2FsIHNjYWxpbmcgb2YgdGhlIG1lc2guIFVzZSAuc2V0U2NhbGUoKSB0byBzZXQgaXQuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFRoZSBpbmRleGVkIHRyaWFuZ2xlcy4gVXNlIC51cGRhdGVUcmVlKCkgdG8gdXBkYXRlIGl0LgogICAgICovCiAgICBjb25zdHJ1Y3Rvcih2ZXJ0aWNlcywgaW5kaWNlcykgewogICAgICBzdXBlcih7CiAgICAgICAgdHlwZTogU2hhcGUudHlwZXMuVFJJTUVTSAogICAgICB9KTsKICAgICAgdGhpcy52ZXJ0aWNlcyA9IG5ldyBGbG9hdDMyQXJyYXkodmVydGljZXMpOwogICAgICB0aGlzLmluZGljZXMgPSBuZXcgSW50MTZBcnJheShpbmRpY2VzKTsKICAgICAgdGhpcy5ub3JtYWxzID0gbmV3IEZsb2F0MzJBcnJheShpbmRpY2VzLmxlbmd0aCk7CiAgICAgIHRoaXMuYWFiYiA9IG5ldyBBQUJCKCk7CiAgICAgIHRoaXMuZWRnZXMgPSBudWxsOwogICAgICB0aGlzLnNjYWxlID0gbmV3IFZlYzMoMSwgMSwgMSk7CiAgICAgIHRoaXMudHJlZSA9IG5ldyBPY3RyZWUoKTsKICAgICAgdGhpcy51cGRhdGVFZGdlcygpOwogICAgICB0aGlzLnVwZGF0ZU5vcm1hbHMoKTsKICAgICAgdGhpcy51cGRhdGVBQUJCKCk7CiAgICAgIHRoaXMudXBkYXRlQm91bmRpbmdTcGhlcmVSYWRpdXMoKTsKICAgICAgdGhpcy51cGRhdGVUcmVlKCk7CiAgICB9CiAgICAvKioKICAgICAqIHVwZGF0ZVRyZWUKICAgICAqLwoKCiAgICB1cGRhdGVUcmVlKCkgewogICAgICBjb25zdCB0cmVlID0gdGhpcy50cmVlOwogICAgICB0cmVlLnJlc2V0KCk7CiAgICAgIHRyZWUuYWFiYi5jb3B5KHRoaXMuYWFiYik7CiAgICAgIGNvbnN0IHNjYWxlID0gdGhpcy5zY2FsZTsgLy8gVGhlIGxvY2FsIG1lc2ggQUFCQiBpcyBzY2FsZWQsIGJ1dCB0aGUgb2N0cmVlIEFBQkIgc2hvdWxkIGJlIHVuc2NhbGVkCgogICAgICB0cmVlLmFhYmIubG93ZXJCb3VuZC54ICo9IDEgLyBzY2FsZS54OwogICAgICB0cmVlLmFhYmIubG93ZXJCb3VuZC55ICo9IDEgLyBzY2FsZS55OwogICAgICB0cmVlLmFhYmIubG93ZXJCb3VuZC56ICo9IDEgLyBzY2FsZS56OwogICAgICB0cmVlLmFhYmIudXBwZXJCb3VuZC54ICo9IDEgLyBzY2FsZS54OwogICAgICB0cmVlLmFhYmIudXBwZXJCb3VuZC55ICo9IDEgLyBzY2FsZS55OwogICAgICB0cmVlLmFhYmIudXBwZXJCb3VuZC56ICo9IDEgLyBzY2FsZS56OyAvLyBJbnNlcnQgYWxsIHRyaWFuZ2xlcwoKICAgICAgY29uc3QgdHJpYW5nbGVBQUJCID0gbmV3IEFBQkIoKTsKICAgICAgY29uc3QgYSA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IGIgPSBuZXcgVmVjMygpOwogICAgICBjb25zdCBjID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3QgcG9pbnRzID0gW2EsIGIsIGNdOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmluZGljZXMubGVuZ3RoIC8gMzsgaSsrKSB7CiAgICAgICAgLy90aGlzLmdldFRyaWFuZ2xlVmVydGljZXMoaSwgYSwgYiwgYyk7CiAgICAgICAgLy8gR2V0IHVuc2NhbGVkIHRyaWFuZ2xlIHZlcnRzCiAgICAgICAgY29uc3QgaTMgPSBpICogMzsKCiAgICAgICAgdGhpcy5fZ2V0VW5zY2FsZWRWZXJ0ZXgodGhpcy5pbmRpY2VzW2kzXSwgYSk7CgogICAgICAgIHRoaXMuX2dldFVuc2NhbGVkVmVydGV4KHRoaXMuaW5kaWNlc1tpMyArIDFdLCBiKTsKCiAgICAgICAgdGhpcy5fZ2V0VW5zY2FsZWRWZXJ0ZXgodGhpcy5pbmRpY2VzW2kzICsgMl0sIGMpOwoKICAgICAgICB0cmlhbmdsZUFBQkIuc2V0RnJvbVBvaW50cyhwb2ludHMpOwogICAgICAgIHRyZWUuaW5zZXJ0KHRyaWFuZ2xlQUFCQiwgaSk7CiAgICAgIH0KCiAgICAgIHRyZWUucmVtb3ZlRW1wdHlOb2RlcygpOwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgdHJpYW5nbGVzIGluIGEgbG9jYWwgQUFCQiBmcm9tIHRoZSB0cmltZXNoLgogICAgICogQHBhcmFtIHJlc3VsdCBBbiBhcnJheSBvZiBpbnRlZ2VycywgcmVmZXJlbmNpbmcgdGhlIHF1ZXJpZWQgdHJpYW5nbGVzLgogICAgICovCgoKICAgIGdldFRyaWFuZ2xlc0luQUFCQihhYWJiLCByZXN1bHQpIHsKICAgICAgdW5zY2FsZWRBQUJCLmNvcHkoYWFiYik7IC8vIFNjYWxlIGl0IHRvIGxvY2FsCgogICAgICBjb25zdCBzY2FsZSA9IHRoaXMuc2NhbGU7CiAgICAgIGNvbnN0IGlzeCA9IHNjYWxlLng7CiAgICAgIGNvbnN0IGlzeSA9IHNjYWxlLnk7CiAgICAgIGNvbnN0IGlzeiA9IHNjYWxlLno7CiAgICAgIGNvbnN0IGwgPSB1bnNjYWxlZEFBQkIubG93ZXJCb3VuZDsKICAgICAgY29uc3QgdSA9IHVuc2NhbGVkQUFCQi51cHBlckJvdW5kOwogICAgICBsLnggLz0gaXN4OwogICAgICBsLnkgLz0gaXN5OwogICAgICBsLnogLz0gaXN6OwogICAgICB1LnggLz0gaXN4OwogICAgICB1LnkgLz0gaXN5OwogICAgICB1LnogLz0gaXN6OwogICAgICByZXR1cm4gdGhpcy50cmVlLmFhYmJRdWVyeSh1bnNjYWxlZEFBQkIsIHJlc3VsdCk7CiAgICB9CiAgICAvKioKICAgICAqIHNldFNjYWxlCiAgICAgKi8KCgogICAgc2V0U2NhbGUoc2NhbGUpIHsKICAgICAgY29uc3Qgd2FzVW5pZm9ybSA9IHRoaXMuc2NhbGUueCA9PT0gdGhpcy5zY2FsZS55ICYmIHRoaXMuc2NhbGUueSA9PT0gdGhpcy5zY2FsZS56OwogICAgICBjb25zdCBpc1VuaWZvcm0gPSBzY2FsZS54ID09PSBzY2FsZS55ICYmIHNjYWxlLnkgPT09IHNjYWxlLno7CgogICAgICBpZiAoISh3YXNVbmlmb3JtICYmIGlzVW5pZm9ybSkpIHsKICAgICAgICAvLyBOb24tdW5pZm9ybSBzY2FsaW5nLiBOZWVkIHRvIHVwZGF0ZSBub3JtYWxzLgogICAgICAgIHRoaXMudXBkYXRlTm9ybWFscygpOwogICAgICB9CgogICAgICB0aGlzLnNjYWxlLmNvcHkoc2NhbGUpOwogICAgICB0aGlzLnVwZGF0ZUFBQkIoKTsKICAgICAgdGhpcy51cGRhdGVCb3VuZGluZ1NwaGVyZVJhZGl1cygpOwogICAgfQogICAgLyoqCiAgICAgKiBDb21wdXRlIHRoZSBub3JtYWxzIG9mIHRoZSBmYWNlcy4gV2lsbCBzYXZlIGluIHRoZSBgLm5vcm1hbHNgIGFycmF5LgogICAgICovCgoKICAgIHVwZGF0ZU5vcm1hbHMoKSB7CiAgICAgIGNvbnN0IG4gPSBjb21wdXRlTm9ybWFsc19uOyAvLyBHZW5lcmF0ZSBub3JtYWxzCgogICAgICBjb25zdCBub3JtYWxzID0gdGhpcy5ub3JtYWxzOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmluZGljZXMubGVuZ3RoIC8gMzsgaSsrKSB7CiAgICAgICAgY29uc3QgaTMgPSBpICogMzsKICAgICAgICBjb25zdCBhID0gdGhpcy5pbmRpY2VzW2kzXTsKICAgICAgICBjb25zdCBiID0gdGhpcy5pbmRpY2VzW2kzICsgMV07CiAgICAgICAgY29uc3QgYyA9IHRoaXMuaW5kaWNlc1tpMyArIDJdOwogICAgICAgIHRoaXMuZ2V0VmVydGV4KGEsIHZhKTsKICAgICAgICB0aGlzLmdldFZlcnRleChiLCB2Yik7CiAgICAgICAgdGhpcy5nZXRWZXJ0ZXgoYywgdmMpOwogICAgICAgIFRyaW1lc2guY29tcHV0ZU5vcm1hbCh2YiwgdmEsIHZjLCBuKTsKICAgICAgICBub3JtYWxzW2kzXSA9IG4ueDsKICAgICAgICBub3JtYWxzW2kzICsgMV0gPSBuLnk7CiAgICAgICAgbm9ybWFsc1tpMyArIDJdID0gbi56OwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIFVwZGF0ZSB0aGUgYC5lZGdlc2AgcHJvcGVydHkKICAgICAqLwoKCiAgICB1cGRhdGVFZGdlcygpIHsKICAgICAgY29uc3QgZWRnZXMgPSB7fTsKCiAgICAgIGNvbnN0IGFkZCA9IChhLCBiKSA9PiB7CiAgICAgICAgY29uc3Qga2V5ID0gYSA8IGIgPyBgJHthfV8ke2J9YCA6IGAke2J9XyR7YX1gOwogICAgICAgIGVkZ2VzW2tleV0gPSB0cnVlOwogICAgICB9OwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmluZGljZXMubGVuZ3RoIC8gMzsgaSsrKSB7CiAgICAgICAgY29uc3QgaTMgPSBpICogMzsKICAgICAgICBjb25zdCBhID0gdGhpcy5pbmRpY2VzW2kzXTsKICAgICAgICBjb25zdCBiID0gdGhpcy5pbmRpY2VzW2kzICsgMV07CiAgICAgICAgY29uc3QgYyA9IHRoaXMuaW5kaWNlc1tpMyArIDJdOwogICAgICAgIGFkZChhLCBiKTsKICAgICAgICBhZGQoYiwgYyk7CiAgICAgICAgYWRkKGMsIGEpOwogICAgICB9CgogICAgICBjb25zdCBrZXlzID0gT2JqZWN0LmtleXMoZWRnZXMpOwogICAgICB0aGlzLmVkZ2VzID0gbmV3IEludDE2QXJyYXkoa2V5cy5sZW5ndGggKiAyKTsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwga2V5cy5sZW5ndGg7IGkrKykgewogICAgICAgIGNvbnN0IGluZGljZXMgPSBrZXlzW2ldLnNwbGl0KCdfJyk7CiAgICAgICAgdGhpcy5lZGdlc1syICogaV0gPSBwYXJzZUludChpbmRpY2VzWzBdLCAxMCk7CiAgICAgICAgdGhpcy5lZGdlc1syICogaSArIDFdID0gcGFyc2VJbnQoaW5kaWNlc1sxXSwgMTApOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhbiBlZGdlIHZlcnRleAogICAgICogQHBhcmFtIGZpcnN0T3JTZWNvbmQgMCBvciAxLCBkZXBlbmRpbmcgb24gd2hpY2ggb25lIG9mIHRoZSB2ZXJ0aWNlcyB5b3UgbmVlZC4KICAgICAqIEBwYXJhbSB2ZXJ0ZXhTdG9yZSBXaGVyZSB0byBzdG9yZSB0aGUgcmVzdWx0CiAgICAgKi8KCgogICAgZ2V0RWRnZVZlcnRleChlZGdlSW5kZXgsIGZpcnN0T3JTZWNvbmQsIHZlcnRleFN0b3JlKSB7CiAgICAgIGNvbnN0IHZlcnRleEluZGV4ID0gdGhpcy5lZGdlc1tlZGdlSW5kZXggKiAyICsgKGZpcnN0T3JTZWNvbmQgPyAxIDogMCldOwogICAgICB0aGlzLmdldFZlcnRleCh2ZXJ0ZXhJbmRleCwgdmVydGV4U3RvcmUpOwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgYSB2ZWN0b3IgYWxvbmcgYW4gZWRnZS4KICAgICAqLwoKCiAgICBnZXRFZGdlVmVjdG9yKGVkZ2VJbmRleCwgdmVjdG9yU3RvcmUpIHsKICAgICAgY29uc3QgdmEgPSBnZXRFZGdlVmVjdG9yX3ZhOwogICAgICBjb25zdCB2YiA9IGdldEVkZ2VWZWN0b3JfdmI7CiAgICAgIHRoaXMuZ2V0RWRnZVZlcnRleChlZGdlSW5kZXgsIDAsIHZhKTsKICAgICAgdGhpcy5nZXRFZGdlVmVydGV4KGVkZ2VJbmRleCwgMSwgdmIpOwogICAgICB2Yi52c3ViKHZhLCB2ZWN0b3JTdG9yZSk7CiAgICB9CiAgICAvKioKICAgICAqIEdldCBmYWNlIG5vcm1hbCBnaXZlbiAzIHZlcnRpY2VzCiAgICAgKi8KCgogICAgc3RhdGljIGNvbXB1dGVOb3JtYWwodmEsIHZiLCB2YywgdGFyZ2V0KSB7CiAgICAgIHZiLnZzdWIodmEsIGFiKTsKICAgICAgdmMudnN1Yih2YiwgY2IpOwogICAgICBjYi5jcm9zcyhhYiwgdGFyZ2V0KTsKCiAgICAgIGlmICghdGFyZ2V0LmlzWmVybygpKSB7CiAgICAgICAgdGFyZ2V0Lm5vcm1hbGl6ZSgpOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIEdldCB2ZXJ0ZXggaS4KICAgICAqIEByZXR1cm4gVGhlICJvdXQiIHZlY3RvciBvYmplY3QKICAgICAqLwoKCiAgICBnZXRWZXJ0ZXgoaSwgb3V0KSB7CiAgICAgIGNvbnN0IHNjYWxlID0gdGhpcy5zY2FsZTsKCiAgICAgIHRoaXMuX2dldFVuc2NhbGVkVmVydGV4KGksIG91dCk7CgogICAgICBvdXQueCAqPSBzY2FsZS54OwogICAgICBvdXQueSAqPSBzY2FsZS55OwogICAgICBvdXQueiAqPSBzY2FsZS56OwogICAgICByZXR1cm4gb3V0OwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgcmF3IHZlcnRleCBpCiAgICAgKiBAcmV0dXJuIFRoZSAib3V0IiB2ZWN0b3Igb2JqZWN0CiAgICAgKi8KCgogICAgX2dldFVuc2NhbGVkVmVydGV4KGksIG91dCkgewogICAgICBjb25zdCBpMyA9IGkgKiAzOwogICAgICBjb25zdCB2ZXJ0aWNlcyA9IHRoaXMudmVydGljZXM7CiAgICAgIHJldHVybiBvdXQuc2V0KHZlcnRpY2VzW2kzXSwgdmVydGljZXNbaTMgKyAxXSwgdmVydGljZXNbaTMgKyAyXSk7CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhIHZlcnRleCBmcm9tIHRoZSB0cmltZXNoLHRyYW5zZm9ybWVkIGJ5IHRoZSBnaXZlbiBwb3NpdGlvbiBhbmQgcXVhdGVybmlvbi4KICAgICAqIEByZXR1cm4gVGhlICJvdXQiIHZlY3RvciBvYmplY3QKICAgICAqLwoKCiAgICBnZXRXb3JsZFZlcnRleChpLCBwb3MsIHF1YXQsIG91dCkgewogICAgICB0aGlzLmdldFZlcnRleChpLCBvdXQpOwogICAgICBUcmFuc2Zvcm0ucG9pbnRUb1dvcmxkRnJhbWUocG9zLCBxdWF0LCBvdXQsIG91dCk7CiAgICAgIHJldHVybiBvdXQ7CiAgICB9CiAgICAvKioKICAgICAqIEdldCB0aGUgdGhyZWUgdmVydGljZXMgZm9yIHRyaWFuZ2xlIGkuCiAgICAgKi8KCgogICAgZ2V0VHJpYW5nbGVWZXJ0aWNlcyhpLCBhLCBiLCBjKSB7CiAgICAgIGNvbnN0IGkzID0gaSAqIDM7CiAgICAgIHRoaXMuZ2V0VmVydGV4KHRoaXMuaW5kaWNlc1tpM10sIGEpOwogICAgICB0aGlzLmdldFZlcnRleCh0aGlzLmluZGljZXNbaTMgKyAxXSwgYik7CiAgICAgIHRoaXMuZ2V0VmVydGV4KHRoaXMuaW5kaWNlc1tpMyArIDJdLCBjKTsKICAgIH0KICAgIC8qKgogICAgICogQ29tcHV0ZSB0aGUgbm9ybWFsIG9mIHRyaWFuZ2xlIGkuCiAgICAgKiBAcmV0dXJuIFRoZSAidGFyZ2V0IiB2ZWN0b3Igb2JqZWN0CiAgICAgKi8KCgogICAgZ2V0Tm9ybWFsKGksIHRhcmdldCkgewogICAgICBjb25zdCBpMyA9IGkgKiAzOwogICAgICByZXR1cm4gdGFyZ2V0LnNldCh0aGlzLm5vcm1hbHNbaTNdLCB0aGlzLm5vcm1hbHNbaTMgKyAxXSwgdGhpcy5ub3JtYWxzW2kzICsgMl0pOwogICAgfQogICAgLyoqCiAgICAgKiBAcmV0dXJuIFRoZSAidGFyZ2V0IiB2ZWN0b3Igb2JqZWN0CiAgICAgKi8KCgogICAgY2FsY3VsYXRlTG9jYWxJbmVydGlhKG1hc3MsIHRhcmdldCkgewogICAgICAvLyBBcHByb3hpbWF0ZSB3aXRoIGJveCBpbmVydGlhCiAgICAgIC8vIEV4YWN0IGluZXJ0aWEgY2FsY3VsYXRpb24gaXMgb3ZlcmtpbGwsIGJ1dCBzZWUgaHR0cDovL2dlb21ldHJpY3Rvb2xzLmNvbS9Eb2N1bWVudGF0aW9uL1BvbHloZWRyYWxNYXNzUHJvcGVydGllcy5wZGYgZm9yIHRoZSBjb3JyZWN0IHdheSB0byBkbyBpdAogICAgICB0aGlzLmNvbXB1dGVMb2NhbEFBQkIoY2xpX2FhYmIpOwogICAgICBjb25zdCB4ID0gY2xpX2FhYmIudXBwZXJCb3VuZC54IC0gY2xpX2FhYmIubG93ZXJCb3VuZC54OwogICAgICBjb25zdCB5ID0gY2xpX2FhYmIudXBwZXJCb3VuZC55IC0gY2xpX2FhYmIubG93ZXJCb3VuZC55OwogICAgICBjb25zdCB6ID0gY2xpX2FhYmIudXBwZXJCb3VuZC56IC0gY2xpX2FhYmIubG93ZXJCb3VuZC56OwogICAgICByZXR1cm4gdGFyZ2V0LnNldCgxLjAgLyAxMi4wICogbWFzcyAqICgyICogeSAqIDIgKiB5ICsgMiAqIHogKiAyICogeiksIDEuMCAvIDEyLjAgKiBtYXNzICogKDIgKiB4ICogMiAqIHggKyAyICogeiAqIDIgKiB6KSwgMS4wIC8gMTIuMCAqIG1hc3MgKiAoMiAqIHkgKiAyICogeSArIDIgKiB4ICogMiAqIHgpKTsKICAgIH0KICAgIC8qKgogICAgICogQ29tcHV0ZSB0aGUgbG9jYWwgQUFCQiBmb3IgdGhlIHRyaW1lc2gKICAgICAqLwoKCiAgICBjb21wdXRlTG9jYWxBQUJCKGFhYmIpIHsKICAgICAgY29uc3QgbCA9IGFhYmIubG93ZXJCb3VuZDsKICAgICAgY29uc3QgdSA9IGFhYmIudXBwZXJCb3VuZDsKICAgICAgY29uc3QgbiA9IHRoaXMudmVydGljZXMubGVuZ3RoOwogICAgICB0aGlzLnZlcnRpY2VzOwogICAgICBjb25zdCB2ID0gY29tcHV0ZUxvY2FsQUFCQl93b3JsZFZlcnQ7CiAgICAgIHRoaXMuZ2V0VmVydGV4KDAsIHYpOwogICAgICBsLmNvcHkodik7CiAgICAgIHUuY29weSh2KTsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSBuOyBpKyspIHsKICAgICAgICB0aGlzLmdldFZlcnRleChpLCB2KTsKCiAgICAgICAgaWYgKHYueCA8IGwueCkgewogICAgICAgICAgbC54ID0gdi54OwogICAgICAgIH0gZWxzZSBpZiAodi54ID4gdS54KSB7CiAgICAgICAgICB1LnggPSB2Lng7CiAgICAgICAgfQoKICAgICAgICBpZiAodi55IDwgbC55KSB7CiAgICAgICAgICBsLnkgPSB2Lnk7CiAgICAgICAgfSBlbHNlIGlmICh2LnkgPiB1LnkpIHsKICAgICAgICAgIHUueSA9IHYueTsKICAgICAgICB9CgogICAgICAgIGlmICh2LnogPCBsLnopIHsKICAgICAgICAgIGwueiA9IHYuejsKICAgICAgICB9IGVsc2UgaWYgKHYueiA+IHUueikgewogICAgICAgICAgdS56ID0gdi56OwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBVcGRhdGUgdGhlIGAuYWFiYmAgcHJvcGVydHkKICAgICAqLwoKCiAgICB1cGRhdGVBQUJCKCkgewogICAgICB0aGlzLmNvbXB1dGVMb2NhbEFBQkIodGhpcy5hYWJiKTsKICAgIH0KICAgIC8qKgogICAgICogV2lsbCB1cGRhdGUgdGhlIGAuYm91bmRpbmdTcGhlcmVSYWRpdXNgIHByb3BlcnR5CiAgICAgKi8KCgogICAgdXBkYXRlQm91bmRpbmdTcGhlcmVSYWRpdXMoKSB7CiAgICAgIC8vIEFzc3VtZSBwb2ludHMgYXJlIGRpc3RyaWJ1dGVkIHdpdGggbG9jYWwgKDAsMCwwKSBhcyBjZW50ZXIKICAgICAgbGV0IG1heDIgPSAwOwogICAgICBjb25zdCB2ZXJ0aWNlcyA9IHRoaXMudmVydGljZXM7CiAgICAgIGNvbnN0IHYgPSBuZXcgVmVjMygpOwoKICAgICAgZm9yIChsZXQgaSA9IDAsIE4gPSB2ZXJ0aWNlcy5sZW5ndGggLyAzOyBpICE9PSBOOyBpKyspIHsKICAgICAgICB0aGlzLmdldFZlcnRleChpLCB2KTsKICAgICAgICBjb25zdCBub3JtMiA9IHYubGVuZ3RoU3F1YXJlZCgpOwoKICAgICAgICBpZiAobm9ybTIgPiBtYXgyKSB7CiAgICAgICAgICBtYXgyID0gbm9ybTI7CiAgICAgICAgfQogICAgICB9CgogICAgICB0aGlzLmJvdW5kaW5nU3BoZXJlUmFkaXVzID0gTWF0aC5zcXJ0KG1heDIpOwogICAgfQogICAgLyoqCiAgICAgKiBjYWxjdWxhdGVXb3JsZEFBQkIKICAgICAqLwoKCiAgICBjYWxjdWxhdGVXb3JsZEFBQkIocG9zLCBxdWF0LCBtaW4sIG1heCkgewogICAgICAvKgogICAgICAgICAgY29uc3QgbiA9IHRoaXMudmVydGljZXMubGVuZ3RoIC8gMywKICAgICAgICAgICAgICB2ZXJ0cyA9IHRoaXMudmVydGljZXM7CiAgICAgICAgICBjb25zdCBtaW54LG1pbnksbWlueixtYXh4LG1heHksbWF4ejsKICAgICAgICAgICBjb25zdCB2ID0gdGVtcFdvcmxkVmVydGV4OwogICAgICAgICAgZm9yKGxldCBpPTA7IGk8bjsgaSsrKXsKICAgICAgICAgICAgICB0aGlzLmdldFZlcnRleChpLCB2KTsKICAgICAgICAgICAgICBxdWF0LnZtdWx0KHYsIHYpOwogICAgICAgICAgICAgIHBvcy52YWRkKHYsIHYpOwogICAgICAgICAgICAgIGlmICh2LnggPCBtaW54IHx8IG1pbng9PT11bmRlZmluZWQpewogICAgICAgICAgICAgICAgICBtaW54ID0gdi54OwogICAgICAgICAgICAgIH0gZWxzZSBpZih2LnggPiBtYXh4IHx8IG1heHg9PT11bmRlZmluZWQpewogICAgICAgICAgICAgICAgICBtYXh4ID0gdi54OwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgaWYgKHYueSA8IG1pbnkgfHwgbWlueT09PXVuZGVmaW5lZCl7CiAgICAgICAgICAgICAgICAgIG1pbnkgPSB2Lnk7CiAgICAgICAgICAgICAgfSBlbHNlIGlmKHYueSA+IG1heHkgfHwgbWF4eT09PXVuZGVmaW5lZCl7CiAgICAgICAgICAgICAgICAgIG1heHkgPSB2Lnk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICBpZiAodi56IDwgbWlueiB8fCBtaW56PT09dW5kZWZpbmVkKXsKICAgICAgICAgICAgICAgICAgbWlueiA9IHYuejsKICAgICAgICAgICAgICB9IGVsc2UgaWYodi56ID4gbWF4eiB8fCBtYXh6PT09dW5kZWZpbmVkKXsKICAgICAgICAgICAgICAgICAgbWF4eiA9IHYuejsKICAgICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICBtaW4uc2V0KG1pbngsbWlueSxtaW56KTsKICAgICAgICAgIG1heC5zZXQobWF4eCxtYXh5LG1heHopOwogICAgICAgICAgKi8KICAgICAgLy8gRmFzdGVyIGFwcHJveGltYXRpb24gdXNpbmcgbG9jYWwgQUFCQgogICAgICBjb25zdCBmcmFtZSA9IGNhbGN1bGF0ZVdvcmxkQUFCQl9mcmFtZTsKICAgICAgY29uc3QgcmVzdWx0ID0gY2FsY3VsYXRlV29ybGRBQUJCX2FhYmI7CiAgICAgIGZyYW1lLnBvc2l0aW9uID0gcG9zOwogICAgICBmcmFtZS5xdWF0ZXJuaW9uID0gcXVhdDsKICAgICAgdGhpcy5hYWJiLnRvV29ybGRGcmFtZShmcmFtZSwgcmVzdWx0KTsKICAgICAgbWluLmNvcHkocmVzdWx0Lmxvd2VyQm91bmQpOwogICAgICBtYXguY29weShyZXN1bHQudXBwZXJCb3VuZCk7CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhcHByb3hpbWF0ZSB2b2x1bWUKICAgICAqLwoKCiAgICB2b2x1bWUoKSB7CiAgICAgIHJldHVybiA0LjAgKiBNYXRoLlBJICogdGhpcy5ib3VuZGluZ1NwaGVyZVJhZGl1cyAvIDMuMDsKICAgIH0KICAgIC8qKgogICAgICogQ3JlYXRlIGEgVHJpbWVzaCBpbnN0YW5jZSwgc2hhcGVkIGFzIGEgdG9ydXMuCiAgICAgKi8KCgogICAgc3RhdGljIGNyZWF0ZVRvcnVzKHJhZGl1cywgdHViZSwgcmFkaWFsU2VnbWVudHMsIHR1YnVsYXJTZWdtZW50cywgYXJjKSB7CiAgICAgIGlmIChyYWRpdXMgPT09IHZvaWQgMCkgewogICAgICAgIHJhZGl1cyA9IDE7CiAgICAgIH0KCiAgICAgIGlmICh0dWJlID09PSB2b2lkIDApIHsKICAgICAgICB0dWJlID0gMC41OwogICAgICB9CgogICAgICBpZiAocmFkaWFsU2VnbWVudHMgPT09IHZvaWQgMCkgewogICAgICAgIHJhZGlhbFNlZ21lbnRzID0gODsKICAgICAgfQoKICAgICAgaWYgKHR1YnVsYXJTZWdtZW50cyA9PT0gdm9pZCAwKSB7CiAgICAgICAgdHVidWxhclNlZ21lbnRzID0gNjsKICAgICAgfQoKICAgICAgaWYgKGFyYyA9PT0gdm9pZCAwKSB7CiAgICAgICAgYXJjID0gTWF0aC5QSSAqIDI7CiAgICAgIH0KCiAgICAgIGNvbnN0IHZlcnRpY2VzID0gW107CiAgICAgIGNvbnN0IGluZGljZXMgPSBbXTsKCiAgICAgIGZvciAobGV0IGogPSAwOyBqIDw9IHJhZGlhbFNlZ21lbnRzOyBqKyspIHsKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8PSB0dWJ1bGFyU2VnbWVudHM7IGkrKykgewogICAgICAgICAgY29uc3QgdSA9IGkgLyB0dWJ1bGFyU2VnbWVudHMgKiBhcmM7CiAgICAgICAgICBjb25zdCB2ID0gaiAvIHJhZGlhbFNlZ21lbnRzICogTWF0aC5QSSAqIDI7CiAgICAgICAgICBjb25zdCB4ID0gKHJhZGl1cyArIHR1YmUgKiBNYXRoLmNvcyh2KSkgKiBNYXRoLmNvcyh1KTsKICAgICAgICAgIGNvbnN0IHkgPSAocmFkaXVzICsgdHViZSAqIE1hdGguY29zKHYpKSAqIE1hdGguc2luKHUpOwogICAgICAgICAgY29uc3QgeiA9IHR1YmUgKiBNYXRoLnNpbih2KTsKICAgICAgICAgIHZlcnRpY2VzLnB1c2goeCwgeSwgeik7CiAgICAgICAgfQogICAgICB9CgogICAgICBmb3IgKGxldCBqID0gMTsgaiA8PSByYWRpYWxTZWdtZW50czsgaisrKSB7CiAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPD0gdHVidWxhclNlZ21lbnRzOyBpKyspIHsKICAgICAgICAgIGNvbnN0IGEgPSAodHVidWxhclNlZ21lbnRzICsgMSkgKiBqICsgaSAtIDE7CiAgICAgICAgICBjb25zdCBiID0gKHR1YnVsYXJTZWdtZW50cyArIDEpICogKGogLSAxKSArIGkgLSAxOwogICAgICAgICAgY29uc3QgYyA9ICh0dWJ1bGFyU2VnbWVudHMgKyAxKSAqIChqIC0gMSkgKyBpOwogICAgICAgICAgY29uc3QgZCA9ICh0dWJ1bGFyU2VnbWVudHMgKyAxKSAqIGogKyBpOwogICAgICAgICAgaW5kaWNlcy5wdXNoKGEsIGIsIGQpOwogICAgICAgICAgaW5kaWNlcy5wdXNoKGIsIGMsIGQpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIG5ldyBUcmltZXNoKHZlcnRpY2VzLCBpbmRpY2VzKTsKICAgIH0KCiAgfQogIGNvbnN0IGNvbXB1dGVOb3JtYWxzX24gPSBuZXcgVmVjMygpOwogIGNvbnN0IHVuc2NhbGVkQUFCQiA9IG5ldyBBQUJCKCk7CiAgY29uc3QgZ2V0RWRnZVZlY3Rvcl92YSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgZ2V0RWRnZVZlY3Rvcl92YiA9IG5ldyBWZWMzKCk7CiAgY29uc3QgY2IgPSBuZXcgVmVjMygpOwogIGNvbnN0IGFiID0gbmV3IFZlYzMoKTsKICBjb25zdCB2YSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgdmIgPSBuZXcgVmVjMygpOwogIGNvbnN0IHZjID0gbmV3IFZlYzMoKTsKICBjb25zdCBjbGlfYWFiYiA9IG5ldyBBQUJCKCk7CiAgY29uc3QgY29tcHV0ZUxvY2FsQUFCQl93b3JsZFZlcnQgPSBuZXcgVmVjMygpOwogIGNvbnN0IGNhbGN1bGF0ZVdvcmxkQUFCQl9mcmFtZSA9IG5ldyBUcmFuc2Zvcm0oKTsKICBjb25zdCBjYWxjdWxhdGVXb3JsZEFBQkJfYWFiYiA9IG5ldyBBQUJCKCk7CgogIC8qKgogICAqIENvbnN0cmFpbnQgZXF1YXRpb24gc29sdmVyIGJhc2UgY2xhc3MuCiAgICovCiAgY2xhc3MgU29sdmVyIHsKICAgIC8qKgogICAgICogQWxsIGVxdWF0aW9ucyB0byBiZSBzb2x2ZWQKICAgICAqLwoKICAgIC8qKgogICAgICogQHRvZG8gcmVtb3ZlIHVzZWxlc3MgY29uc3RydWN0b3IKICAgICAqLwogICAgY29uc3RydWN0b3IoKSB7CiAgICAgIHRoaXMuZXF1YXRpb25zID0gW107CiAgICB9CiAgICAvKioKICAgICAqIFNob3VsZCBiZSBpbXBsZW1lbnRlZCBpbiBzdWJjbGFzc2VzIQogICAgICogQHRvZG8gdXNlIGFic3RyYWN0CiAgICAgKiBAcmV0dXJuIG51bWJlciBvZiBpdGVyYXRpb25zIHBlcmZvcm1lZAogICAgICovCgoKICAgIHNvbHZlKGR0LCB3b3JsZCkgewogICAgICByZXR1cm4gKC8vIFNob3VsZCByZXR1cm4gdGhlIG51bWJlciBvZiBpdGVyYXRpb25zIGRvbmUhCiAgICAgICAgMAogICAgICApOwogICAgfQogICAgLyoqCiAgICAgKiBBZGQgYW4gZXF1YXRpb24KICAgICAqLwoKCiAgICBhZGRFcXVhdGlvbihlcSkgewogICAgICBpZiAoZXEuZW5hYmxlZCAmJiAhZXEuYmkuaXNUcmlnZ2VyICYmICFlcS5iai5pc1RyaWdnZXIpIHsKICAgICAgICB0aGlzLmVxdWF0aW9ucy5wdXNoKGVxKTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBSZW1vdmUgYW4gZXF1YXRpb24KICAgICAqLwoKCiAgICByZW1vdmVFcXVhdGlvbihlcSkgewogICAgICBjb25zdCBlcXMgPSB0aGlzLmVxdWF0aW9uczsKICAgICAgY29uc3QgaSA9IGVxcy5pbmRleE9mKGVxKTsKCiAgICAgIGlmIChpICE9PSAtMSkgewogICAgICAgIGVxcy5zcGxpY2UoaSwgMSk7CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogQWRkIGFsbCBlcXVhdGlvbnMKICAgICAqLwoKCiAgICByZW1vdmVBbGxFcXVhdGlvbnMoKSB7CiAgICAgIHRoaXMuZXF1YXRpb25zLmxlbmd0aCA9IDA7CiAgICB9CgogIH0KCiAgLyoqCiAgICogQ29uc3RyYWludCBlcXVhdGlvbiBHYXVzcy1TZWlkZWwgc29sdmVyLgogICAqIEB0b2RvIFRoZSBzcG9vayBwYXJhbWV0ZXJzIHNob3VsZCBiZSBzcGVjaWZpZWQgZm9yIGVhY2ggY29uc3RyYWludCwgbm90IGdsb2JhbGx5LgogICAqIEBzZWUgaHR0cHM6Ly93d3c4LmNzLnVtdS5zZS9rdXJzZXIvNURWMDU4L1ZUMDkvbGVjdHVyZXMvc3Bvb2tub3Rlcy5wZGYKICAgKi8KICBjbGFzcyBHU1NvbHZlciBleHRlbmRzIFNvbHZlciB7CiAgICAvKioKICAgICAqIFRoZSBudW1iZXIgb2Ygc29sdmVyIGl0ZXJhdGlvbnMgZGV0ZXJtaW5lcyBxdWFsaXR5IG9mIHRoZSBjb25zdHJhaW50cyBpbiB0aGUgd29ybGQuCiAgICAgKiBUaGUgbW9yZSBpdGVyYXRpb25zLCB0aGUgbW9yZSBjb3JyZWN0IHNpbXVsYXRpb24uIE1vcmUgaXRlcmF0aW9ucyBuZWVkIG1vcmUgY29tcHV0YXRpb25zIHRob3VnaC4gSWYgeW91IGhhdmUgYSBsYXJnZSBncmF2aXR5IGZvcmNlIGluIHlvdXIgd29ybGQsIHlvdSB3aWxsIG5lZWQgbW9yZSBpdGVyYXRpb25zLgogICAgICovCgogICAgLyoqCiAgICAgKiBXaGVuIHRvbGVyYW5jZSBpcyByZWFjaGVkLCB0aGUgc3lzdGVtIGlzIGFzc3VtZWQgdG8gYmUgY29udmVyZ2VkLgogICAgICovCgogICAgLyoqCiAgICAgKiBAdG9kbyByZW1vdmUgdXNlbGVzcyBjb25zdHJ1Y3RvcgogICAgICovCiAgICBjb25zdHJ1Y3RvcigpIHsKICAgICAgc3VwZXIoKTsKICAgICAgdGhpcy5pdGVyYXRpb25zID0gMTA7CiAgICAgIHRoaXMudG9sZXJhbmNlID0gMWUtNzsKICAgIH0KICAgIC8qKgogICAgICogU29sdmUKICAgICAqIEByZXR1cm4gbnVtYmVyIG9mIGl0ZXJhdGlvbnMgcGVyZm9ybWVkCiAgICAgKi8KCgogICAgc29sdmUoZHQsIHdvcmxkKSB7CiAgICAgIGxldCBpdGVyID0gMDsKICAgICAgY29uc3QgbWF4SXRlciA9IHRoaXMuaXRlcmF0aW9uczsKICAgICAgY29uc3QgdG9sU3F1YXJlZCA9IHRoaXMudG9sZXJhbmNlICogdGhpcy50b2xlcmFuY2U7CiAgICAgIGNvbnN0IGVxdWF0aW9ucyA9IHRoaXMuZXF1YXRpb25zOwogICAgICBjb25zdCBOZXEgPSBlcXVhdGlvbnMubGVuZ3RoOwogICAgICBjb25zdCBib2RpZXMgPSB3b3JsZC5ib2RpZXM7CiAgICAgIGNvbnN0IE5ib2RpZXMgPSBib2RpZXMubGVuZ3RoOwogICAgICBjb25zdCBoID0gZHQ7CiAgICAgIGxldCBCOwogICAgICBsZXQgaW52QzsKICAgICAgbGV0IGRlbHRhbGFtYmRhOwogICAgICBsZXQgZGVsdGFsYW1iZGFUb3Q7CiAgICAgIGxldCBHV2xhbWJkYTsKICAgICAgbGV0IGxhbWJkYWo7IC8vIFVwZGF0ZSBzb2x2ZSBtYXNzCgogICAgICBpZiAoTmVxICE9PSAwKSB7CiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IE5ib2RpZXM7IGkrKykgewogICAgICAgICAgYm9kaWVzW2ldLnVwZGF0ZVNvbHZlTWFzc1Byb3BlcnRpZXMoKTsKICAgICAgICB9CiAgICAgIH0gLy8gVGhpbmdzIHRoYXQgZG8gbm90IGNoYW5nZSBkdXJpbmcgaXRlcmF0aW9uIGNhbiBiZSBjb21wdXRlZCBvbmNlCgoKICAgICAgY29uc3QgaW52Q3MgPSBHU1NvbHZlcl9zb2x2ZV9pbnZDczsKICAgICAgY29uc3QgQnMgPSBHU1NvbHZlcl9zb2x2ZV9CczsKICAgICAgY29uc3QgbGFtYmRhID0gR1NTb2x2ZXJfc29sdmVfbGFtYmRhOwogICAgICBpbnZDcy5sZW5ndGggPSBOZXE7CiAgICAgIEJzLmxlbmd0aCA9IE5lcTsKICAgICAgbGFtYmRhLmxlbmd0aCA9IE5lcTsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSBOZXE7IGkrKykgewogICAgICAgIGNvbnN0IGMgPSBlcXVhdGlvbnNbaV07CiAgICAgICAgbGFtYmRhW2ldID0gMC4wOwogICAgICAgIEJzW2ldID0gYy5jb21wdXRlQihoKTsKICAgICAgICBpbnZDc1tpXSA9IDEuMCAvIGMuY29tcHV0ZUMoKTsKICAgICAgfQoKICAgICAgaWYgKE5lcSAhPT0gMCkgewogICAgICAgIC8vIFJlc2V0IHZsYW1iZGEKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gTmJvZGllczsgaSsrKSB7CiAgICAgICAgICBjb25zdCBiID0gYm9kaWVzW2ldOwogICAgICAgICAgY29uc3QgdmxhbWJkYSA9IGIudmxhbWJkYTsKICAgICAgICAgIGNvbnN0IHdsYW1iZGEgPSBiLndsYW1iZGE7CiAgICAgICAgICB2bGFtYmRhLnNldCgwLCAwLCAwKTsKICAgICAgICAgIHdsYW1iZGEuc2V0KDAsIDAsIDApOwogICAgICAgIH0gLy8gSXRlcmF0ZSBvdmVyIGVxdWF0aW9ucwoKCiAgICAgICAgZm9yIChpdGVyID0gMDsgaXRlciAhPT0gbWF4SXRlcjsgaXRlcisrKSB7CiAgICAgICAgICAvLyBBY2N1bXVsYXRlIHRoZSB0b3RhbCBlcnJvciBmb3IgZWFjaCBpdGVyYXRpb24uCiAgICAgICAgICBkZWx0YWxhbWJkYVRvdCA9IDAuMDsKCiAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiAhPT0gTmVxOyBqKyspIHsKICAgICAgICAgICAgY29uc3QgYyA9IGVxdWF0aW9uc1tqXTsgLy8gQ29tcHV0ZSBpdGVyYXRpb24KCiAgICAgICAgICAgIEIgPSBCc1tqXTsKICAgICAgICAgICAgaW52QyA9IGludkNzW2pdOwogICAgICAgICAgICBsYW1iZGFqID0gbGFtYmRhW2pdOwogICAgICAgICAgICBHV2xhbWJkYSA9IGMuY29tcHV0ZUdXbGFtYmRhKCk7CiAgICAgICAgICAgIGRlbHRhbGFtYmRhID0gaW52QyAqIChCIC0gR1dsYW1iZGEgLSBjLmVwcyAqIGxhbWJkYWopOyAvLyBDbGFtcCBpZiB3ZSBhcmUgbm90IHdpdGhpbiB0aGUgbWluL21heCBpbnRlcnZhbAoKICAgICAgICAgICAgaWYgKGxhbWJkYWogKyBkZWx0YWxhbWJkYSA8IGMubWluRm9yY2UpIHsKICAgICAgICAgICAgICBkZWx0YWxhbWJkYSA9IGMubWluRm9yY2UgLSBsYW1iZGFqOwogICAgICAgICAgICB9IGVsc2UgaWYgKGxhbWJkYWogKyBkZWx0YWxhbWJkYSA+IGMubWF4Rm9yY2UpIHsKICAgICAgICAgICAgICBkZWx0YWxhbWJkYSA9IGMubWF4Rm9yY2UgLSBsYW1iZGFqOwogICAgICAgICAgICB9CgogICAgICAgICAgICBsYW1iZGFbal0gKz0gZGVsdGFsYW1iZGE7CiAgICAgICAgICAgIGRlbHRhbGFtYmRhVG90ICs9IGRlbHRhbGFtYmRhID4gMC4wID8gZGVsdGFsYW1iZGEgOiAtZGVsdGFsYW1iZGE7IC8vIGFicyhkZWx0YWxhbWJkYSkKCiAgICAgICAgICAgIGMuYWRkVG9XbGFtYmRhKGRlbHRhbGFtYmRhKTsKICAgICAgICAgIH0gLy8gSWYgdGhlIHRvdGFsIGVycm9yIGlzIHNtYWxsIGVub3VnaCAtIHN0b3AgaXRlcmF0ZQoKCiAgICAgICAgICBpZiAoZGVsdGFsYW1iZGFUb3QgKiBkZWx0YWxhbWJkYVRvdCA8IHRvbFNxdWFyZWQpIHsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CiAgICAgICAgfSAvLyBBZGQgcmVzdWx0IHRvIHZlbG9jaXR5CgoKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gTmJvZGllczsgaSsrKSB7CiAgICAgICAgICBjb25zdCBiID0gYm9kaWVzW2ldOwogICAgICAgICAgY29uc3QgdiA9IGIudmVsb2NpdHk7CiAgICAgICAgICBjb25zdCB3ID0gYi5hbmd1bGFyVmVsb2NpdHk7CiAgICAgICAgICBiLnZsYW1iZGEudm11bChiLmxpbmVhckZhY3RvciwgYi52bGFtYmRhKTsKICAgICAgICAgIHYudmFkZChiLnZsYW1iZGEsIHYpOwogICAgICAgICAgYi53bGFtYmRhLnZtdWwoYi5hbmd1bGFyRmFjdG9yLCBiLndsYW1iZGEpOwogICAgICAgICAgdy52YWRkKGIud2xhbWJkYSwgdyk7CiAgICAgICAgfSAvLyBTZXQgdGhlIGAubXVsdGlwbGllcmAgcHJvcGVydHkgb2YgZWFjaCBlcXVhdGlvbgoKCiAgICAgICAgbGV0IGwgPSBlcXVhdGlvbnMubGVuZ3RoOwogICAgICAgIGNvbnN0IGludkR0ID0gMSAvIGg7CgogICAgICAgIHdoaWxlIChsLS0pIHsKICAgICAgICAgIGVxdWF0aW9uc1tsXS5tdWx0aXBsaWVyID0gbGFtYmRhW2xdICogaW52RHQ7CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gaXRlcjsKICAgIH0KCiAgfSAvLyBKdXN0IHRlbXBvcmFyeSBudW1iZXIgaG9sZGVycyB0aGF0IHdlIHdhbnQgdG8gcmV1c2UgZWFjaCBpdGVyYXRpb24uCgogIGNvbnN0IEdTU29sdmVyX3NvbHZlX2xhbWJkYSA9IFtdOwogIGNvbnN0IEdTU29sdmVyX3NvbHZlX2ludkNzID0gW107CiAgY29uc3QgR1NTb2x2ZXJfc29sdmVfQnMgPSBbXTsKCiAgLyoqCiAgICogU3BsaXRzIHRoZSBlcXVhdGlvbnMgaW50byBpc2xhbmRzIGFuZCBzb2x2ZXMgdGhlbSBpbmRlcGVuZGVudGx5LiBDYW4gaW1wcm92ZSBwZXJmb3JtYW5jZS4KICAgKi8KICBjbGFzcyBTcGxpdFNvbHZlciBleHRlbmRzIFNvbHZlciB7CiAgICAvKioKICAgICAqIFRoZSBudW1iZXIgb2Ygc29sdmVyIGl0ZXJhdGlvbnMgZGV0ZXJtaW5lcyBxdWFsaXR5IG9mIHRoZSBjb25zdHJhaW50cyBpbiB0aGUgd29ybGQuIFRoZSBtb3JlIGl0ZXJhdGlvbnMsIHRoZSBtb3JlIGNvcnJlY3Qgc2ltdWxhdGlvbi4gTW9yZSBpdGVyYXRpb25zIG5lZWQgbW9yZSBjb21wdXRhdGlvbnMgdGhvdWdoLiBJZiB5b3UgaGF2ZSBhIGxhcmdlIGdyYXZpdHkgZm9yY2UgaW4geW91ciB3b3JsZCwgeW91IHdpbGwgbmVlZCBtb3JlIGl0ZXJhdGlvbnMuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFdoZW4gdG9sZXJhbmNlIGlzIHJlYWNoZWQsIHRoZSBzeXN0ZW0gaXMgYXNzdW1lZCB0byBiZSBjb252ZXJnZWQuCiAgICAgKi8KCiAgICAvKiogc3Vic29sdmVyICovCiAgICBjb25zdHJ1Y3RvcihzdWJzb2x2ZXIpIHsKICAgICAgc3VwZXIoKTsKICAgICAgdGhpcy5pdGVyYXRpb25zID0gMTA7CiAgICAgIHRoaXMudG9sZXJhbmNlID0gMWUtNzsKICAgICAgdGhpcy5zdWJzb2x2ZXIgPSBzdWJzb2x2ZXI7CiAgICAgIHRoaXMubm9kZXMgPSBbXTsKICAgICAgdGhpcy5ub2RlUG9vbCA9IFtdOyAvLyBDcmVhdGUgbmVlZGVkIG5vZGVzLCByZXVzZSBpZiBwb3NzaWJsZQoKICAgICAgd2hpbGUgKHRoaXMubm9kZVBvb2wubGVuZ3RoIDwgMTI4KSB7CiAgICAgICAgdGhpcy5ub2RlUG9vbC5wdXNoKHRoaXMuY3JlYXRlTm9kZSgpKTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBjcmVhdGVOb2RlCiAgICAgKi8KCgogICAgY3JlYXRlTm9kZSgpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICBib2R5OiBudWxsLAogICAgICAgIGNoaWxkcmVuOiBbXSwKICAgICAgICBlcXM6IFtdLAogICAgICAgIHZpc2l0ZWQ6IGZhbHNlCiAgICAgIH07CiAgICB9CiAgICAvKioKICAgICAqIFNvbHZlIHRoZSBzdWJzeXN0ZW1zCiAgICAgKiBAcmV0dXJuIG51bWJlciBvZiBpdGVyYXRpb25zIHBlcmZvcm1lZAogICAgICovCgoKICAgIHNvbHZlKGR0LCB3b3JsZCkgewogICAgICBjb25zdCBub2RlcyA9IFNwbGl0U29sdmVyX3NvbHZlX25vZGVzOwogICAgICBjb25zdCBub2RlUG9vbCA9IHRoaXMubm9kZVBvb2w7CiAgICAgIGNvbnN0IGJvZGllcyA9IHdvcmxkLmJvZGllczsKICAgICAgY29uc3QgZXF1YXRpb25zID0gdGhpcy5lcXVhdGlvbnM7CiAgICAgIGNvbnN0IE5lcSA9IGVxdWF0aW9ucy5sZW5ndGg7CiAgICAgIGNvbnN0IE5ib2RpZXMgPSBib2RpZXMubGVuZ3RoOwogICAgICBjb25zdCBzdWJzb2x2ZXIgPSB0aGlzLnN1YnNvbHZlcjsgLy8gQ3JlYXRlIG5lZWRlZCBub2RlcywgcmV1c2UgaWYgcG9zc2libGUKCiAgICAgIHdoaWxlIChub2RlUG9vbC5sZW5ndGggPCBOYm9kaWVzKSB7CiAgICAgICAgbm9kZVBvb2wucHVzaCh0aGlzLmNyZWF0ZU5vZGUoKSk7CiAgICAgIH0KCiAgICAgIG5vZGVzLmxlbmd0aCA9IE5ib2RpZXM7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IE5ib2RpZXM7IGkrKykgewogICAgICAgIG5vZGVzW2ldID0gbm9kZVBvb2xbaV07CiAgICAgIH0gLy8gUmVzZXQgbm9kZSB2YWx1ZXMKCgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gTmJvZGllczsgaSsrKSB7CiAgICAgICAgY29uc3Qgbm9kZSA9IG5vZGVzW2ldOwogICAgICAgIG5vZGUuYm9keSA9IGJvZGllc1tpXTsKICAgICAgICBub2RlLmNoaWxkcmVuLmxlbmd0aCA9IDA7CiAgICAgICAgbm9kZS5lcXMubGVuZ3RoID0gMDsKICAgICAgICBub2RlLnZpc2l0ZWQgPSBmYWxzZTsKICAgICAgfQoKICAgICAgZm9yIChsZXQgayA9IDA7IGsgIT09IE5lcTsgaysrKSB7CiAgICAgICAgY29uc3QgZXEgPSBlcXVhdGlvbnNba107CiAgICAgICAgY29uc3QgaSA9IGJvZGllcy5pbmRleE9mKGVxLmJpKTsKICAgICAgICBjb25zdCBqID0gYm9kaWVzLmluZGV4T2YoZXEuYmopOwogICAgICAgIGNvbnN0IG5pID0gbm9kZXNbaV07CiAgICAgICAgY29uc3QgbmogPSBub2Rlc1tqXTsKICAgICAgICBuaS5jaGlsZHJlbi5wdXNoKG5qKTsKICAgICAgICBuaS5lcXMucHVzaChlcSk7CiAgICAgICAgbmouY2hpbGRyZW4ucHVzaChuaSk7CiAgICAgICAgbmouZXFzLnB1c2goZXEpOwogICAgICB9CgogICAgICBsZXQgY2hpbGQ7CiAgICAgIGxldCBuID0gMDsKICAgICAgbGV0IGVxcyA9IFNwbGl0U29sdmVyX3NvbHZlX2VxczsKICAgICAgc3Vic29sdmVyLnRvbGVyYW5jZSA9IHRoaXMudG9sZXJhbmNlOwogICAgICBzdWJzb2x2ZXIuaXRlcmF0aW9ucyA9IHRoaXMuaXRlcmF0aW9uczsKICAgICAgY29uc3QgZHVtbXlXb3JsZCA9IFNwbGl0U29sdmVyX3NvbHZlX2R1bW15V29ybGQ7CgogICAgICB3aGlsZSAoY2hpbGQgPSBnZXRVbnZpc2l0ZWROb2RlKG5vZGVzKSkgewogICAgICAgIGVxcy5sZW5ndGggPSAwOwogICAgICAgIGR1bW15V29ybGQuYm9kaWVzLmxlbmd0aCA9IDA7CiAgICAgICAgYmZzKGNoaWxkLCB2aXNpdEZ1bmMsIGR1bW15V29ybGQuYm9kaWVzLCBlcXMpOwogICAgICAgIGNvbnN0IE5lcXMgPSBlcXMubGVuZ3RoOwogICAgICAgIGVxcyA9IGVxcy5zb3J0KHNvcnRCeUlkKTsKCiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IE5lcXM7IGkrKykgewogICAgICAgICAgc3Vic29sdmVyLmFkZEVxdWF0aW9uKGVxc1tpXSk7CiAgICAgICAgfQoKICAgICAgICBzdWJzb2x2ZXIuc29sdmUoZHQsIGR1bW15V29ybGQpOwogICAgICAgIHN1YnNvbHZlci5yZW1vdmVBbGxFcXVhdGlvbnMoKTsKICAgICAgICBuKys7CiAgICAgIH0KCiAgICAgIHJldHVybiBuOwogICAgfQoKICB9IC8vIFJldHVybnMgdGhlIG51bWJlciBvZiBzdWJzeXN0ZW1zCgogIGNvbnN0IFNwbGl0U29sdmVyX3NvbHZlX25vZGVzID0gW107IC8vIEFsbCBhbGxvY2F0ZWQgbm9kZSBvYmplY3RzCgogIGNvbnN0IFNwbGl0U29sdmVyX3NvbHZlX2VxcyA9IFtdOyAvLyBUZW1wIGFycmF5CgogIGNvbnN0IFNwbGl0U29sdmVyX3NvbHZlX2R1bW15V29ybGQgPSB7CiAgICBib2RpZXM6IFtdCiAgfTsgLy8gVGVtcCBvYmplY3QKCiAgY29uc3QgU1RBVElDID0gQm9keS5TVEFUSUM7CgogIGZ1bmN0aW9uIGdldFVudmlzaXRlZE5vZGUobm9kZXMpIHsKICAgIGNvbnN0IE5ub2RlcyA9IG5vZGVzLmxlbmd0aDsKCiAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gTm5vZGVzOyBpKyspIHsKICAgICAgY29uc3Qgbm9kZSA9IG5vZGVzW2ldOwoKICAgICAgaWYgKCFub2RlLnZpc2l0ZWQgJiYgIShub2RlLmJvZHkudHlwZSAmIFNUQVRJQykpIHsKICAgICAgICByZXR1cm4gbm9kZTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBmYWxzZTsKICB9CgogIGNvbnN0IHF1ZXVlID0gW107CgogIGZ1bmN0aW9uIGJmcyhyb290LCB2aXNpdEZ1bmMsIGJkcywgZXFzKSB7CiAgICBxdWV1ZS5wdXNoKHJvb3QpOwogICAgcm9vdC52aXNpdGVkID0gdHJ1ZTsKICAgIHZpc2l0RnVuYyhyb290LCBiZHMsIGVxcyk7CgogICAgd2hpbGUgKHF1ZXVlLmxlbmd0aCkgewogICAgICBjb25zdCBub2RlID0gcXVldWUucG9wKCk7IC8vIExvb3Agb3ZlciB1bnZpc2l0ZWQgY2hpbGQgbm9kZXMKCiAgICAgIGxldCBjaGlsZDsKCiAgICAgIHdoaWxlIChjaGlsZCA9IGdldFVudmlzaXRlZE5vZGUobm9kZS5jaGlsZHJlbikpIHsKICAgICAgICBjaGlsZC52aXNpdGVkID0gdHJ1ZTsKICAgICAgICB2aXNpdEZ1bmMoY2hpbGQsIGJkcywgZXFzKTsKICAgICAgICBxdWV1ZS5wdXNoKGNoaWxkKTsKICAgICAgfQogICAgfQogIH0KCiAgZnVuY3Rpb24gdmlzaXRGdW5jKG5vZGUsIGJkcywgZXFzKSB7CiAgICBiZHMucHVzaChub2RlLmJvZHkpOwogICAgY29uc3QgTmVxcyA9IG5vZGUuZXFzLmxlbmd0aDsKCiAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gTmVxczsgaSsrKSB7CiAgICAgIGNvbnN0IGVxID0gbm9kZS5lcXNbaV07CgogICAgICBpZiAoIWVxcy5pbmNsdWRlcyhlcSkpIHsKICAgICAgICBlcXMucHVzaChlcSk7CiAgICAgIH0KICAgIH0KICB9CgogIGZ1bmN0aW9uIHNvcnRCeUlkKGEsIGIpIHsKICAgIHJldHVybiBiLmlkIC0gYS5pZDsKICB9CgogIC8qKgogICAqIEZvciBwb29saW5nIG9iamVjdHMgdGhhdCBjYW4gYmUgcmV1c2VkLgogICAqLwogIGNsYXNzIFBvb2wgewogICAgY29uc3RydWN0b3IoKSB7CiAgICAgIHRoaXMub2JqZWN0cyA9IFtdOwogICAgICB0aGlzLnR5cGUgPSBPYmplY3Q7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZWxlYXNlIGFuIG9iamVjdCBhZnRlciB1c2UKICAgICAqLwogICAgcmVsZWFzZSgpIHsKICAgICAgY29uc3QgTmFyZ3MgPSBhcmd1bWVudHMubGVuZ3RoOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IE5hcmdzOyBpKyspIHsKICAgICAgICB0aGlzLm9iamVjdHMucHVzaChpIDwgMCB8fCBhcmd1bWVudHMubGVuZ3RoIDw9IGkgPyB1bmRlZmluZWQgOiBhcmd1bWVudHNbaV0pOwogICAgICB9CgogICAgICByZXR1cm4gdGhpczsKICAgIH0KICAgIC8qKgogICAgICogR2V0IGFuIG9iamVjdAogICAgICovCgoKICAgIGdldCgpIHsKICAgICAgaWYgKHRoaXMub2JqZWN0cy5sZW5ndGggPT09IDApIHsKICAgICAgICByZXR1cm4gdGhpcy5jb25zdHJ1Y3RPYmplY3QoKTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gdGhpcy5vYmplY3RzLnBvcCgpOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIENvbnN0cnVjdCBhbiBvYmplY3QuIFNob3VsZCBiZSBpbXBsZW1lbnRlZCBpbiBlYWNoIHN1YmNsYXNzLgogICAgICovCgoKICAgIGNvbnN0cnVjdE9iamVjdCgpIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCdjb25zdHJ1Y3RPYmplY3QoKSBub3QgaW1wbGVtZW50ZWQgaW4gdGhpcyBQb29sIHN1YmNsYXNzIHlldCEnKTsKICAgIH0KICAgIC8qKgogICAgICogQHJldHVybiBTZWxmLCBmb3IgY2hhaW5pbmcKICAgICAqLwoKCiAgICByZXNpemUoc2l6ZSkgewogICAgICBjb25zdCBvYmplY3RzID0gdGhpcy5vYmplY3RzOwoKICAgICAgd2hpbGUgKG9iamVjdHMubGVuZ3RoID4gc2l6ZSkgewogICAgICAgIG9iamVjdHMucG9wKCk7CiAgICAgIH0KCiAgICAgIHdoaWxlIChvYmplY3RzLmxlbmd0aCA8IHNpemUpIHsKICAgICAgICBvYmplY3RzLnB1c2godGhpcy5jb25zdHJ1Y3RPYmplY3QoKSk7CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzOwogICAgfQoKICB9CgogIC8qKgogICAqIFZlYzNQb29sCiAgICovCgogIGNsYXNzIFZlYzNQb29sIGV4dGVuZHMgUG9vbCB7CiAgICBjb25zdHJ1Y3RvcigpIHsKICAgICAgc3VwZXIoLi4uYXJndW1lbnRzKTsKICAgICAgdGhpcy50eXBlID0gVmVjMzsKICAgIH0KCiAgICAvKioKICAgICAqIENvbnN0cnVjdCBhIHZlY3RvcgogICAgICovCiAgICBjb25zdHJ1Y3RPYmplY3QoKSB7CiAgICAgIHJldHVybiBuZXcgVmVjMygpOwogICAgfQoKICB9CgogIC8vIE5hbWluZyBydWxlOiBiYXNlZCBvZiB0aGUgb3JkZXIgaW4gU0hBUEVfVFlQRVMsCiAgLy8gdGhlIGZpcnN0IHBhcnQgb2YgdGhlIG1ldGhvZCBpcyBmb3JtZWQgYnkgdGhlCiAgLy8gc2hhcGUgdHlwZSB0aGF0IGNvbWVzIGJlZm9yZSwgaW4gdGhlIHNlY29uZCBwYXJ0CiAgLy8gdGhlcmUgaXMgdGhlIHNoYXBlIHR5cGUgdGhhdCBjb21lcyBhZnRlciBpbiB0aGUgU0hBUEVfVFlQRVMgbGlzdAogIGNvbnN0IENPTExJU0lPTl9UWVBFUyA9IHsKICAgIHNwaGVyZVNwaGVyZTogU2hhcGUudHlwZXMuU1BIRVJFLAogICAgc3BoZXJlUGxhbmU6IFNoYXBlLnR5cGVzLlNQSEVSRSB8IFNoYXBlLnR5cGVzLlBMQU5FLAogICAgYm94Qm94OiBTaGFwZS50eXBlcy5CT1ggfCBTaGFwZS50eXBlcy5CT1gsCiAgICBzcGhlcmVCb3g6IFNoYXBlLnR5cGVzLlNQSEVSRSB8IFNoYXBlLnR5cGVzLkJPWCwKICAgIHBsYW5lQm94OiBTaGFwZS50eXBlcy5QTEFORSB8IFNoYXBlLnR5cGVzLkJPWCwKICAgIGNvbnZleENvbnZleDogU2hhcGUudHlwZXMuQ09OVkVYUE9MWUhFRFJPTiwKICAgIHNwaGVyZUNvbnZleDogU2hhcGUudHlwZXMuU1BIRVJFIHwgU2hhcGUudHlwZXMuQ09OVkVYUE9MWUhFRFJPTiwKICAgIHBsYW5lQ29udmV4OiBTaGFwZS50eXBlcy5QTEFORSB8IFNoYXBlLnR5cGVzLkNPTlZFWFBPTFlIRURST04sCiAgICBib3hDb252ZXg6IFNoYXBlLnR5cGVzLkJPWCB8IFNoYXBlLnR5cGVzLkNPTlZFWFBPTFlIRURST04sCiAgICBzcGhlcmVIZWlnaHRmaWVsZDogU2hhcGUudHlwZXMuU1BIRVJFIHwgU2hhcGUudHlwZXMuSEVJR0hURklFTEQsCiAgICBib3hIZWlnaHRmaWVsZDogU2hhcGUudHlwZXMuQk9YIHwgU2hhcGUudHlwZXMuSEVJR0hURklFTEQsCiAgICBjb252ZXhIZWlnaHRmaWVsZDogU2hhcGUudHlwZXMuQ09OVkVYUE9MWUhFRFJPTiB8IFNoYXBlLnR5cGVzLkhFSUdIVEZJRUxELAogICAgc3BoZXJlUGFydGljbGU6IFNoYXBlLnR5cGVzLlBBUlRJQ0xFIHwgU2hhcGUudHlwZXMuU1BIRVJFLAogICAgcGxhbmVQYXJ0aWNsZTogU2hhcGUudHlwZXMuUExBTkUgfCBTaGFwZS50eXBlcy5QQVJUSUNMRSwKICAgIGJveFBhcnRpY2xlOiBTaGFwZS50eXBlcy5CT1ggfCBTaGFwZS50eXBlcy5QQVJUSUNMRSwKICAgIGNvbnZleFBhcnRpY2xlOiBTaGFwZS50eXBlcy5QQVJUSUNMRSB8IFNoYXBlLnR5cGVzLkNPTlZFWFBPTFlIRURST04sCiAgICBjeWxpbmRlckN5bGluZGVyOiBTaGFwZS50eXBlcy5DWUxJTkRFUiwKICAgIHNwaGVyZUN5bGluZGVyOiBTaGFwZS50eXBlcy5TUEhFUkUgfCBTaGFwZS50eXBlcy5DWUxJTkRFUiwKICAgIHBsYW5lQ3lsaW5kZXI6IFNoYXBlLnR5cGVzLlBMQU5FIHwgU2hhcGUudHlwZXMuQ1lMSU5ERVIsCiAgICBib3hDeWxpbmRlcjogU2hhcGUudHlwZXMuQk9YIHwgU2hhcGUudHlwZXMuQ1lMSU5ERVIsCiAgICBjb252ZXhDeWxpbmRlcjogU2hhcGUudHlwZXMuQ09OVkVYUE9MWUhFRFJPTiB8IFNoYXBlLnR5cGVzLkNZTElOREVSLAogICAgaGVpZ2h0ZmllbGRDeWxpbmRlcjogU2hhcGUudHlwZXMuSEVJR0hURklFTEQgfCBTaGFwZS50eXBlcy5DWUxJTkRFUiwKICAgIHBhcnRpY2xlQ3lsaW5kZXI6IFNoYXBlLnR5cGVzLlBBUlRJQ0xFIHwgU2hhcGUudHlwZXMuQ1lMSU5ERVIsCiAgICBzcGhlcmVUcmltZXNoOiBTaGFwZS50eXBlcy5TUEhFUkUgfCBTaGFwZS50eXBlcy5UUklNRVNILAogICAgcGxhbmVUcmltZXNoOiBTaGFwZS50eXBlcy5QTEFORSB8IFNoYXBlLnR5cGVzLlRSSU1FU0gKICB9OwoKICAvKioKICAgKiBIZWxwZXIgY2xhc3MgZm9yIHRoZSBXb3JsZC4gR2VuZXJhdGVzIENvbnRhY3RFcXVhdGlvbnMuCiAgICogQHRvZG8gU3BoZXJlLUNvbnZleFBvbHloZWRyb24gY29udGFjdHMKICAgKiBAdG9kbyBDb250YWN0IHJlZHVjdGlvbgogICAqIEB0b2RvIHNob3VsZCBtb3ZlIG1ldGhvZHMgdG8gcHJvdG90eXBlCiAgICovCiAgY2xhc3MgTmFycm93cGhhc2UgewogICAgLyoqCiAgICAgKiBJbnRlcm5hbCBzdG9yYWdlIG9mIHBvb2xlZCBjb250YWN0IHBvaW50cy4KICAgICAqLwoKICAgIC8qKgogICAgICogUG9vbGVkIHZlY3RvcnMuCiAgICAgKi8KICAgIGdldCBbQ09MTElTSU9OX1RZUEVTLnNwaGVyZVNwaGVyZV0oKSB7CiAgICAgIHJldHVybiB0aGlzLnNwaGVyZVNwaGVyZTsKICAgIH0KCiAgICBnZXQgW0NPTExJU0lPTl9UWVBFUy5zcGhlcmVQbGFuZV0oKSB7CiAgICAgIHJldHVybiB0aGlzLnNwaGVyZVBsYW5lOwogICAgfQoKICAgIGdldCBbQ09MTElTSU9OX1RZUEVTLmJveEJveF0oKSB7CiAgICAgIHJldHVybiB0aGlzLmJveEJveDsKICAgIH0KCiAgICBnZXQgW0NPTExJU0lPTl9UWVBFUy5zcGhlcmVCb3hdKCkgewogICAgICByZXR1cm4gdGhpcy5zcGhlcmVCb3g7CiAgICB9CgogICAgZ2V0IFtDT0xMSVNJT05fVFlQRVMucGxhbmVCb3hdKCkgewogICAgICByZXR1cm4gdGhpcy5wbGFuZUJveDsKICAgIH0KCiAgICBnZXQgW0NPTExJU0lPTl9UWVBFUy5jb252ZXhDb252ZXhdKCkgewogICAgICByZXR1cm4gdGhpcy5jb252ZXhDb252ZXg7CiAgICB9CgogICAgZ2V0IFtDT0xMSVNJT05fVFlQRVMuc3BoZXJlQ29udmV4XSgpIHsKICAgICAgcmV0dXJuIHRoaXMuc3BoZXJlQ29udmV4OwogICAgfQoKICAgIGdldCBbQ09MTElTSU9OX1RZUEVTLnBsYW5lQ29udmV4XSgpIHsKICAgICAgcmV0dXJuIHRoaXMucGxhbmVDb252ZXg7CiAgICB9CgogICAgZ2V0IFtDT0xMSVNJT05fVFlQRVMuYm94Q29udmV4XSgpIHsKICAgICAgcmV0dXJuIHRoaXMuYm94Q29udmV4OwogICAgfQoKICAgIGdldCBbQ09MTElTSU9OX1RZUEVTLnNwaGVyZUhlaWdodGZpZWxkXSgpIHsKICAgICAgcmV0dXJuIHRoaXMuc3BoZXJlSGVpZ2h0ZmllbGQ7CiAgICB9CgogICAgZ2V0IFtDT0xMSVNJT05fVFlQRVMuYm94SGVpZ2h0ZmllbGRdKCkgewogICAgICByZXR1cm4gdGhpcy5ib3hIZWlnaHRmaWVsZDsKICAgIH0KCiAgICBnZXQgW0NPTExJU0lPTl9UWVBFUy5jb252ZXhIZWlnaHRmaWVsZF0oKSB7CiAgICAgIHJldHVybiB0aGlzLmNvbnZleEhlaWdodGZpZWxkOwogICAgfQoKICAgIGdldCBbQ09MTElTSU9OX1RZUEVTLnNwaGVyZVBhcnRpY2xlXSgpIHsKICAgICAgcmV0dXJuIHRoaXMuc3BoZXJlUGFydGljbGU7CiAgICB9CgogICAgZ2V0IFtDT0xMSVNJT05fVFlQRVMucGxhbmVQYXJ0aWNsZV0oKSB7CiAgICAgIHJldHVybiB0aGlzLnBsYW5lUGFydGljbGU7CiAgICB9CgogICAgZ2V0IFtDT0xMSVNJT05fVFlQRVMuYm94UGFydGljbGVdKCkgewogICAgICByZXR1cm4gdGhpcy5ib3hQYXJ0aWNsZTsKICAgIH0KCiAgICBnZXQgW0NPTExJU0lPTl9UWVBFUy5jb252ZXhQYXJ0aWNsZV0oKSB7CiAgICAgIHJldHVybiB0aGlzLmNvbnZleFBhcnRpY2xlOwogICAgfQoKICAgIGdldCBbQ09MTElTSU9OX1RZUEVTLmN5bGluZGVyQ3lsaW5kZXJdKCkgewogICAgICByZXR1cm4gdGhpcy5jb252ZXhDb252ZXg7CiAgICB9CgogICAgZ2V0IFtDT0xMSVNJT05fVFlQRVMuc3BoZXJlQ3lsaW5kZXJdKCkgewogICAgICByZXR1cm4gdGhpcy5zcGhlcmVDb252ZXg7CiAgICB9CgogICAgZ2V0IFtDT0xMSVNJT05fVFlQRVMucGxhbmVDeWxpbmRlcl0oKSB7CiAgICAgIHJldHVybiB0aGlzLnBsYW5lQ29udmV4OwogICAgfQoKICAgIGdldCBbQ09MTElTSU9OX1RZUEVTLmJveEN5bGluZGVyXSgpIHsKICAgICAgcmV0dXJuIHRoaXMuYm94Q29udmV4OwogICAgfQoKICAgIGdldCBbQ09MTElTSU9OX1RZUEVTLmNvbnZleEN5bGluZGVyXSgpIHsKICAgICAgcmV0dXJuIHRoaXMuY29udmV4Q29udmV4OwogICAgfQoKICAgIGdldCBbQ09MTElTSU9OX1RZUEVTLmhlaWdodGZpZWxkQ3lsaW5kZXJdKCkgewogICAgICByZXR1cm4gdGhpcy5oZWlnaHRmaWVsZEN5bGluZGVyOwogICAgfQoKICAgIGdldCBbQ09MTElTSU9OX1RZUEVTLnBhcnRpY2xlQ3lsaW5kZXJdKCkgewogICAgICByZXR1cm4gdGhpcy5wYXJ0aWNsZUN5bGluZGVyOwogICAgfQoKICAgIGdldCBbQ09MTElTSU9OX1RZUEVTLnNwaGVyZVRyaW1lc2hdKCkgewogICAgICByZXR1cm4gdGhpcy5zcGhlcmVUcmltZXNoOwogICAgfQoKICAgIGdldCBbQ09MTElTSU9OX1RZUEVTLnBsYW5lVHJpbWVzaF0oKSB7CiAgICAgIHJldHVybiB0aGlzLnBsYW5lVHJpbWVzaDsKICAgIH0gLy8gZ2V0IFtDT0xMSVNJT05fVFlQRVMuY29udmV4VHJpbWVzaF0oKSB7CiAgICAvLyAgIHJldHVybiB0aGlzLmNvbnZleFRyaW1lc2gKICAgIC8vIH0KCgogICAgY29uc3RydWN0b3Iod29ybGQpIHsKICAgICAgdGhpcy5jb250YWN0UG9pbnRQb29sID0gW107CiAgICAgIHRoaXMuZnJpY3Rpb25FcXVhdGlvblBvb2wgPSBbXTsKICAgICAgdGhpcy5yZXN1bHQgPSBbXTsKICAgICAgdGhpcy5mcmljdGlvblJlc3VsdCA9IFtdOwogICAgICB0aGlzLnYzcG9vbCA9IG5ldyBWZWMzUG9vbCgpOwogICAgICB0aGlzLndvcmxkID0gd29ybGQ7CiAgICAgIHRoaXMuY3VycmVudENvbnRhY3RNYXRlcmlhbCA9IHdvcmxkLmRlZmF1bHRDb250YWN0TWF0ZXJpYWw7CiAgICAgIHRoaXMuZW5hYmxlRnJpY3Rpb25SZWR1Y3Rpb24gPSBmYWxzZTsKICAgIH0KICAgIC8qKgogICAgICogTWFrZSBhIGNvbnRhY3Qgb2JqZWN0LCBieSB1c2luZyB0aGUgaW50ZXJuYWwgcG9vbCBvciBjcmVhdGluZyBhIG5ldyBvbmUuCiAgICAgKi8KCgogICAgY3JlYXRlQ29udGFjdEVxdWF0aW9uKGJpLCBiaiwgc2ksIHNqLCBvdmVycmlkZVNoYXBlQSwgb3ZlcnJpZGVTaGFwZUIpIHsKICAgICAgbGV0IGM7CgogICAgICBpZiAodGhpcy5jb250YWN0UG9pbnRQb29sLmxlbmd0aCkgewogICAgICAgIGMgPSB0aGlzLmNvbnRhY3RQb2ludFBvb2wucG9wKCk7CiAgICAgICAgYy5iaSA9IGJpOwogICAgICAgIGMuYmogPSBiajsKICAgICAgfSBlbHNlIHsKICAgICAgICBjID0gbmV3IENvbnRhY3RFcXVhdGlvbihiaSwgYmopOwogICAgICB9CgogICAgICBjLmVuYWJsZWQgPSBiaS5jb2xsaXNpb25SZXNwb25zZSAmJiBiai5jb2xsaXNpb25SZXNwb25zZSAmJiBzaS5jb2xsaXNpb25SZXNwb25zZSAmJiBzai5jb2xsaXNpb25SZXNwb25zZTsKICAgICAgY29uc3QgY20gPSB0aGlzLmN1cnJlbnRDb250YWN0TWF0ZXJpYWw7CiAgICAgIGMucmVzdGl0dXRpb24gPSBjbS5yZXN0aXR1dGlvbjsKICAgICAgYy5zZXRTcG9va1BhcmFtcyhjbS5jb250YWN0RXF1YXRpb25TdGlmZm5lc3MsIGNtLmNvbnRhY3RFcXVhdGlvblJlbGF4YXRpb24sIHRoaXMud29ybGQuZHQpOwogICAgICBjb25zdCBtYXRBID0gc2kubWF0ZXJpYWwgfHwgYmkubWF0ZXJpYWw7CiAgICAgIGNvbnN0IG1hdEIgPSBzai5tYXRlcmlhbCB8fCBiai5tYXRlcmlhbDsKCiAgICAgIGlmIChtYXRBICYmIG1hdEIgJiYgbWF0QS5yZXN0aXR1dGlvbiA+PSAwICYmIG1hdEIucmVzdGl0dXRpb24gPj0gMCkgewogICAgICAgIGMucmVzdGl0dXRpb24gPSBtYXRBLnJlc3RpdHV0aW9uICogbWF0Qi5yZXN0aXR1dGlvbjsKICAgICAgfQoKICAgICAgYy5zaSA9IG92ZXJyaWRlU2hhcGVBIHx8IHNpOwogICAgICBjLnNqID0gb3ZlcnJpZGVTaGFwZUIgfHwgc2o7CiAgICAgIHJldHVybiBjOwogICAgfQoKICAgIGNyZWF0ZUZyaWN0aW9uRXF1YXRpb25zRnJvbUNvbnRhY3QoY29udGFjdEVxdWF0aW9uLCBvdXRBcnJheSkgewogICAgICBjb25zdCBib2R5QSA9IGNvbnRhY3RFcXVhdGlvbi5iaTsKICAgICAgY29uc3QgYm9keUIgPSBjb250YWN0RXF1YXRpb24uYmo7CiAgICAgIGNvbnN0IHNoYXBlQSA9IGNvbnRhY3RFcXVhdGlvbi5zaTsKICAgICAgY29uc3Qgc2hhcGVCID0gY29udGFjdEVxdWF0aW9uLnNqOwogICAgICBjb25zdCB3b3JsZCA9IHRoaXMud29ybGQ7CiAgICAgIGNvbnN0IGNtID0gdGhpcy5jdXJyZW50Q29udGFjdE1hdGVyaWFsOyAvLyBJZiBmcmljdGlvbiBvciByZXN0aXR1dGlvbiB3ZXJlIHNwZWNpZmllZCBpbiB0aGUgbWF0ZXJpYWwsIHVzZSB0aGVtCgogICAgICBsZXQgZnJpY3Rpb24gPSBjbS5mcmljdGlvbjsKICAgICAgY29uc3QgbWF0QSA9IHNoYXBlQS5tYXRlcmlhbCB8fCBib2R5QS5tYXRlcmlhbDsKICAgICAgY29uc3QgbWF0QiA9IHNoYXBlQi5tYXRlcmlhbCB8fCBib2R5Qi5tYXRlcmlhbDsKCiAgICAgIGlmIChtYXRBICYmIG1hdEIgJiYgbWF0QS5mcmljdGlvbiA+PSAwICYmIG1hdEIuZnJpY3Rpb24gPj0gMCkgewogICAgICAgIGZyaWN0aW9uID0gbWF0QS5mcmljdGlvbiAqIG1hdEIuZnJpY3Rpb247CiAgICAgIH0KCiAgICAgIGlmIChmcmljdGlvbiA+IDApIHsKICAgICAgICAvLyBDcmVhdGUgMiB0YW5nZW50IGVxdWF0aW9ucwogICAgICAgIC8vIFVzZXJzIG1heSBwcm92aWRlIGEgZm9yY2UgZGlmZmVyZW50IGZyb20gZ2xvYmFsIGdyYXZpdHkgdG8gdXNlIHdoZW4gY29tcHV0aW5nIGNvbnRhY3QgZnJpY3Rpb24uCiAgICAgICAgY29uc3QgbXVnID0gZnJpY3Rpb24gKiAod29ybGQuZnJpY3Rpb25HcmF2aXR5IHx8IHdvcmxkLmdyYXZpdHkpLmxlbmd0aCgpOwogICAgICAgIGxldCByZWR1Y2VkTWFzcyA9IGJvZHlBLmludk1hc3MgKyBib2R5Qi5pbnZNYXNzOwoKICAgICAgICBpZiAocmVkdWNlZE1hc3MgPiAwKSB7CiAgICAgICAgICByZWR1Y2VkTWFzcyA9IDEgLyByZWR1Y2VkTWFzczsKICAgICAgICB9CgogICAgICAgIGNvbnN0IHBvb2wgPSB0aGlzLmZyaWN0aW9uRXF1YXRpb25Qb29sOwogICAgICAgIGNvbnN0IGMxID0gcG9vbC5sZW5ndGggPyBwb29sLnBvcCgpIDogbmV3IEZyaWN0aW9uRXF1YXRpb24oYm9keUEsIGJvZHlCLCBtdWcgKiByZWR1Y2VkTWFzcyk7CiAgICAgICAgY29uc3QgYzIgPSBwb29sLmxlbmd0aCA/IHBvb2wucG9wKCkgOiBuZXcgRnJpY3Rpb25FcXVhdGlvbihib2R5QSwgYm9keUIsIG11ZyAqIHJlZHVjZWRNYXNzKTsKICAgICAgICBjMS5iaSA9IGMyLmJpID0gYm9keUE7CiAgICAgICAgYzEuYmogPSBjMi5iaiA9IGJvZHlCOwogICAgICAgIGMxLm1pbkZvcmNlID0gYzIubWluRm9yY2UgPSAtbXVnICogcmVkdWNlZE1hc3M7CiAgICAgICAgYzEubWF4Rm9yY2UgPSBjMi5tYXhGb3JjZSA9IG11ZyAqIHJlZHVjZWRNYXNzOyAvLyBDb3B5IG92ZXIgdGhlIHJlbGF0aXZlIHZlY3RvcnMKCiAgICAgICAgYzEucmkuY29weShjb250YWN0RXF1YXRpb24ucmkpOwogICAgICAgIGMxLnJqLmNvcHkoY29udGFjdEVxdWF0aW9uLnJqKTsKICAgICAgICBjMi5yaS5jb3B5KGNvbnRhY3RFcXVhdGlvbi5yaSk7CiAgICAgICAgYzIucmouY29weShjb250YWN0RXF1YXRpb24ucmopOyAvLyBDb25zdHJ1Y3QgdGFuZ2VudHMKCiAgICAgICAgY29udGFjdEVxdWF0aW9uLm5pLnRhbmdlbnRzKGMxLnQsIGMyLnQpOyAvLyBTZXQgc3Bvb2sgcGFyYW1zCgogICAgICAgIGMxLnNldFNwb29rUGFyYW1zKGNtLmZyaWN0aW9uRXF1YXRpb25TdGlmZm5lc3MsIGNtLmZyaWN0aW9uRXF1YXRpb25SZWxheGF0aW9uLCB3b3JsZC5kdCk7CiAgICAgICAgYzIuc2V0U3Bvb2tQYXJhbXMoY20uZnJpY3Rpb25FcXVhdGlvblN0aWZmbmVzcywgY20uZnJpY3Rpb25FcXVhdGlvblJlbGF4YXRpb24sIHdvcmxkLmR0KTsKICAgICAgICBjMS5lbmFibGVkID0gYzIuZW5hYmxlZCA9IGNvbnRhY3RFcXVhdGlvbi5lbmFibGVkOwogICAgICAgIG91dEFycmF5LnB1c2goYzEsIGMyKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQoKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogICAgLyoqCiAgICAgKiBUYWtlIHRoZSBhdmVyYWdlIE4gbGF0ZXN0IGNvbnRhY3QgcG9pbnQgb24gdGhlIHBsYW5lLgogICAgICovCgoKICAgIGNyZWF0ZUZyaWN0aW9uRnJvbUF2ZXJhZ2UobnVtQ29udGFjdHMpIHsKICAgICAgLy8gVGhlIGxhc3QgY29udGFjdEVxdWF0aW9uCiAgICAgIGxldCBjID0gdGhpcy5yZXN1bHRbdGhpcy5yZXN1bHQubGVuZ3RoIC0gMV07IC8vIENyZWF0ZSB0aGUgcmVzdWx0OiB0d28gImF2ZXJhZ2UiIGZyaWN0aW9uIGVxdWF0aW9ucwoKICAgICAgaWYgKCF0aGlzLmNyZWF0ZUZyaWN0aW9uRXF1YXRpb25zRnJvbUNvbnRhY3QoYywgdGhpcy5mcmljdGlvblJlc3VsdCkgfHwgbnVtQ29udGFjdHMgPT09IDEpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGNvbnN0IGYxID0gdGhpcy5mcmljdGlvblJlc3VsdFt0aGlzLmZyaWN0aW9uUmVzdWx0Lmxlbmd0aCAtIDJdOwogICAgICBjb25zdCBmMiA9IHRoaXMuZnJpY3Rpb25SZXN1bHRbdGhpcy5mcmljdGlvblJlc3VsdC5sZW5ndGggLSAxXTsKICAgICAgYXZlcmFnZU5vcm1hbC5zZXRaZXJvKCk7CiAgICAgIGF2ZXJhZ2VDb250YWN0UG9pbnRBLnNldFplcm8oKTsKICAgICAgYXZlcmFnZUNvbnRhY3RQb2ludEIuc2V0WmVybygpOwogICAgICBjb25zdCBib2R5QSA9IGMuYmk7CiAgICAgIGMuYmo7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gbnVtQ29udGFjdHM7IGkrKykgewogICAgICAgIGMgPSB0aGlzLnJlc3VsdFt0aGlzLnJlc3VsdC5sZW5ndGggLSAxIC0gaV07CgogICAgICAgIGlmIChjLmJpICE9PSBib2R5QSkgewogICAgICAgICAgYXZlcmFnZU5vcm1hbC52YWRkKGMubmksIGF2ZXJhZ2VOb3JtYWwpOwogICAgICAgICAgYXZlcmFnZUNvbnRhY3RQb2ludEEudmFkZChjLnJpLCBhdmVyYWdlQ29udGFjdFBvaW50QSk7CiAgICAgICAgICBhdmVyYWdlQ29udGFjdFBvaW50Qi52YWRkKGMucmosIGF2ZXJhZ2VDb250YWN0UG9pbnRCKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgYXZlcmFnZU5vcm1hbC52c3ViKGMubmksIGF2ZXJhZ2VOb3JtYWwpOwogICAgICAgICAgYXZlcmFnZUNvbnRhY3RQb2ludEEudmFkZChjLnJqLCBhdmVyYWdlQ29udGFjdFBvaW50QSk7CiAgICAgICAgICBhdmVyYWdlQ29udGFjdFBvaW50Qi52YWRkKGMucmksIGF2ZXJhZ2VDb250YWN0UG9pbnRCKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGNvbnN0IGludk51bUNvbnRhY3RzID0gMSAvIG51bUNvbnRhY3RzOwogICAgICBhdmVyYWdlQ29udGFjdFBvaW50QS5zY2FsZShpbnZOdW1Db250YWN0cywgZjEucmkpOwogICAgICBhdmVyYWdlQ29udGFjdFBvaW50Qi5zY2FsZShpbnZOdW1Db250YWN0cywgZjEucmopOwogICAgICBmMi5yaS5jb3B5KGYxLnJpKTsgLy8gU2hvdWxkIGJlIHRoZSBzYW1lCgogICAgICBmMi5yai5jb3B5KGYxLnJqKTsKICAgICAgYXZlcmFnZU5vcm1hbC5ub3JtYWxpemUoKTsKICAgICAgYXZlcmFnZU5vcm1hbC50YW5nZW50cyhmMS50LCBmMi50KTsgLy8gcmV0dXJuIGVxOwogICAgfQogICAgLyoqCiAgICAgKiBHZW5lcmF0ZSBhbGwgY29udGFjdHMgYmV0d2VlbiBhIGxpc3Qgb2YgYm9keSBwYWlycwogICAgICogQHBhcmFtIHAxIEFycmF5IG9mIGJvZHkgaW5kaWNlcwogICAgICogQHBhcmFtIHAyIEFycmF5IG9mIGJvZHkgaW5kaWNlcwogICAgICogQHBhcmFtIHJlc3VsdCBBcnJheSB0byBzdG9yZSBnZW5lcmF0ZWQgY29udGFjdHMKICAgICAqIEBwYXJhbSBvbGRjb250YWN0cyBPcHRpb25hbC4gQXJyYXkgb2YgcmV1c2FibGUgY29udGFjdCBvYmplY3RzCiAgICAgKi8KCgogICAgZ2V0Q29udGFjdHMocDEsIHAyLCB3b3JsZCwgcmVzdWx0LCBvbGRjb250YWN0cywgZnJpY3Rpb25SZXN1bHQsIGZyaWN0aW9uUG9vbCkgewogICAgICAvLyBTYXZlIG9sZCBjb250YWN0IG9iamVjdHMKICAgICAgdGhpcy5jb250YWN0UG9pbnRQb29sID0gb2xkY29udGFjdHM7CiAgICAgIHRoaXMuZnJpY3Rpb25FcXVhdGlvblBvb2wgPSBmcmljdGlvblBvb2w7CiAgICAgIHRoaXMucmVzdWx0ID0gcmVzdWx0OwogICAgICB0aGlzLmZyaWN0aW9uUmVzdWx0ID0gZnJpY3Rpb25SZXN1bHQ7CiAgICAgIGNvbnN0IHFpID0gdG1wUXVhdDE7CiAgICAgIGNvbnN0IHFqID0gdG1wUXVhdDI7CiAgICAgIGNvbnN0IHhpID0gdG1wVmVjMTsKICAgICAgY29uc3QgeGogPSB0bXBWZWMyOwoKICAgICAgZm9yIChsZXQgayA9IDAsIE4gPSBwMS5sZW5ndGg7IGsgIT09IE47IGsrKykgewogICAgICAgIC8vIEdldCBjdXJyZW50IGNvbGxpc2lvbiBib2RpZXMKICAgICAgICBjb25zdCBiaSA9IHAxW2tdOwogICAgICAgIGNvbnN0IGJqID0gcDJba107IC8vIEdldCBjb250YWN0IG1hdGVyaWFsCgogICAgICAgIGxldCBib2R5Q29udGFjdE1hdGVyaWFsID0gbnVsbDsKCiAgICAgICAgaWYgKGJpLm1hdGVyaWFsICYmIGJqLm1hdGVyaWFsKSB7CiAgICAgICAgICBib2R5Q29udGFjdE1hdGVyaWFsID0gd29ybGQuZ2V0Q29udGFjdE1hdGVyaWFsKGJpLm1hdGVyaWFsLCBiai5tYXRlcmlhbCkgfHwgbnVsbDsKICAgICAgICB9CgogICAgICAgIGNvbnN0IGp1c3RUZXN0ID0gYmkudHlwZSAmIEJvZHkuS0lORU1BVElDICYmIGJqLnR5cGUgJiBCb2R5LlNUQVRJQyB8fCBiaS50eXBlICYgQm9keS5TVEFUSUMgJiYgYmoudHlwZSAmIEJvZHkuS0lORU1BVElDIHx8IGJpLnR5cGUgJiBCb2R5LktJTkVNQVRJQyAmJiBiai50eXBlICYgQm9keS5LSU5FTUFUSUM7CgogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYmkuc2hhcGVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICBiaS5xdWF0ZXJuaW9uLm11bHQoYmkuc2hhcGVPcmllbnRhdGlvbnNbaV0sIHFpKTsKICAgICAgICAgIGJpLnF1YXRlcm5pb24udm11bHQoYmkuc2hhcGVPZmZzZXRzW2ldLCB4aSk7CiAgICAgICAgICB4aS52YWRkKGJpLnBvc2l0aW9uLCB4aSk7CiAgICAgICAgICBjb25zdCBzaSA9IGJpLnNoYXBlc1tpXTsKCiAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGJqLnNoYXBlcy5sZW5ndGg7IGorKykgewogICAgICAgICAgICAvLyBDb21wdXRlIHdvcmxkIHRyYW5zZm9ybSBvZiBzaGFwZXMKICAgICAgICAgICAgYmoucXVhdGVybmlvbi5tdWx0KGJqLnNoYXBlT3JpZW50YXRpb25zW2pdLCBxaik7CiAgICAgICAgICAgIGJqLnF1YXRlcm5pb24udm11bHQoYmouc2hhcGVPZmZzZXRzW2pdLCB4aik7CiAgICAgICAgICAgIHhqLnZhZGQoYmoucG9zaXRpb24sIHhqKTsKICAgICAgICAgICAgY29uc3Qgc2ogPSBiai5zaGFwZXNbal07CgogICAgICAgICAgICBpZiAoIShzaS5jb2xsaXNpb25GaWx0ZXJNYXNrICYgc2ouY29sbGlzaW9uRmlsdGVyR3JvdXAgJiYgc2ouY29sbGlzaW9uRmlsdGVyTWFzayAmIHNpLmNvbGxpc2lvbkZpbHRlckdyb3VwKSkgewogICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoeGkuZGlzdGFuY2VUbyh4aikgPiBzaS5ib3VuZGluZ1NwaGVyZVJhZGl1cyArIHNqLmJvdW5kaW5nU3BoZXJlUmFkaXVzKSB7CiAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0gLy8gR2V0IGNvbGxpc2lvbiBtYXRlcmlhbAoKCiAgICAgICAgICAgIGxldCBzaGFwZUNvbnRhY3RNYXRlcmlhbCA9IG51bGw7CgogICAgICAgICAgICBpZiAoc2kubWF0ZXJpYWwgJiYgc2oubWF0ZXJpYWwpIHsKICAgICAgICAgICAgICBzaGFwZUNvbnRhY3RNYXRlcmlhbCA9IHdvcmxkLmdldENvbnRhY3RNYXRlcmlhbChzaS5tYXRlcmlhbCwgc2oubWF0ZXJpYWwpIHx8IG51bGw7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHRoaXMuY3VycmVudENvbnRhY3RNYXRlcmlhbCA9IHNoYXBlQ29udGFjdE1hdGVyaWFsIHx8IGJvZHlDb250YWN0TWF0ZXJpYWwgfHwgd29ybGQuZGVmYXVsdENvbnRhY3RNYXRlcmlhbDsgLy8gR2V0IGNvbnRhY3RzCgogICAgICAgICAgICBjb25zdCByZXNvbHZlckluZGV4ID0gc2kudHlwZSB8IHNqLnR5cGU7CiAgICAgICAgICAgIGNvbnN0IHJlc29sdmVyID0gdGhpc1tyZXNvbHZlckluZGV4XTsKCiAgICAgICAgICAgIGlmIChyZXNvbHZlcikgewogICAgICAgICAgICAgIGxldCByZXR2YWwgPSBmYWxzZTsgLy8gVE8gRE86IGludmVzdGlnYXRlIHdoeSBzcGhlcmVQYXJ0aWNsZSBhbmQgY29udmV4UGFydGljbGUKICAgICAgICAgICAgICAvLyByZXNvbHZlcnMgZXhwZWN0IHNpIGFuZCBzaiBzaGFwZXMgdG8gYmUgaW4gcmV2ZXJzZSBvcmRlcgogICAgICAgICAgICAgIC8vIChpLmUuIGxhcmdlciBpbnRlZ2VyIHZhbHVlIHR5cGUgZmlyc3QgaW5zdGVhZCBvZiBzbWFsbGVyIGZpcnN0KQoKICAgICAgICAgICAgICBpZiAoc2kudHlwZSA8IHNqLnR5cGUpIHsKICAgICAgICAgICAgICAgIHJldHZhbCA9IHJlc29sdmVyLmNhbGwodGhpcywgc2ksIHNqLCB4aSwgeGosIHFpLCBxaiwgYmksIGJqLCBzaSwgc2osIGp1c3RUZXN0KTsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgcmV0dmFsID0gcmVzb2x2ZXIuY2FsbCh0aGlzLCBzaiwgc2ksIHhqLCB4aSwgcWosIHFpLCBiaiwgYmksIHNpLCBzaiwganVzdFRlc3QpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgaWYgKHJldHZhbCAmJiBqdXN0VGVzdCkgewogICAgICAgICAgICAgICAgLy8gUmVnaXN0ZXIgb3ZlcmxhcAogICAgICAgICAgICAgICAgd29ybGQuc2hhcGVPdmVybGFwS2VlcGVyLnNldChzaS5pZCwgc2ouaWQpOwogICAgICAgICAgICAgICAgd29ybGQuYm9keU92ZXJsYXBLZWVwZXIuc2V0KGJpLmlkLCBiai5pZCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgc3BoZXJlU3BoZXJlKHNpLCBzaiwgeGksIHhqLCBxaSwgcWosIGJpLCBiaiwgcnNpLCByc2osIGp1c3RUZXN0KSB7CiAgICAgIGlmIChqdXN0VGVzdCkgewogICAgICAgIHJldHVybiB4aS5kaXN0YW5jZVNxdWFyZWQoeGopIDwgKHNpLnJhZGl1cyArIHNqLnJhZGl1cykgKiogMjsKICAgICAgfSAvLyBXZSB3aWxsIGhhdmUgb25seSBvbmUgY29udGFjdCBpbiB0aGlzIGNhc2UKCgogICAgICBjb25zdCBjb250YWN0RXEgPSB0aGlzLmNyZWF0ZUNvbnRhY3RFcXVhdGlvbihiaSwgYmosIHNpLCBzaiwgcnNpLCByc2opOyAvLyBDb250YWN0IG5vcm1hbAoKICAgICAgeGoudnN1Yih4aSwgY29udGFjdEVxLm5pKTsKICAgICAgY29udGFjdEVxLm5pLm5vcm1hbGl6ZSgpOyAvLyBDb250YWN0IHBvaW50IGxvY2F0aW9ucwoKICAgICAgY29udGFjdEVxLnJpLmNvcHkoY29udGFjdEVxLm5pKTsKICAgICAgY29udGFjdEVxLnJqLmNvcHkoY29udGFjdEVxLm5pKTsKICAgICAgY29udGFjdEVxLnJpLnNjYWxlKHNpLnJhZGl1cywgY29udGFjdEVxLnJpKTsKICAgICAgY29udGFjdEVxLnJqLnNjYWxlKC1zai5yYWRpdXMsIGNvbnRhY3RFcS5yaik7CiAgICAgIGNvbnRhY3RFcS5yaS52YWRkKHhpLCBjb250YWN0RXEucmkpOwogICAgICBjb250YWN0RXEucmkudnN1YihiaS5wb3NpdGlvbiwgY29udGFjdEVxLnJpKTsKICAgICAgY29udGFjdEVxLnJqLnZhZGQoeGosIGNvbnRhY3RFcS5yaik7CiAgICAgIGNvbnRhY3RFcS5yai52c3ViKGJqLnBvc2l0aW9uLCBjb250YWN0RXEucmopOwogICAgICB0aGlzLnJlc3VsdC5wdXNoKGNvbnRhY3RFcSk7CiAgICAgIHRoaXMuY3JlYXRlRnJpY3Rpb25FcXVhdGlvbnNGcm9tQ29udGFjdChjb250YWN0RXEsIHRoaXMuZnJpY3Rpb25SZXN1bHQpOwogICAgfQoKICAgIHNwaGVyZVBsYW5lKHNpLCBzaiwgeGksIHhqLCBxaSwgcWosIGJpLCBiaiwgcnNpLCByc2osIGp1c3RUZXN0KSB7CiAgICAgIC8vIFdlIHdpbGwgaGF2ZSBvbmUgY29udGFjdCBpbiB0aGlzIGNhc2UKICAgICAgY29uc3QgciA9IHRoaXMuY3JlYXRlQ29udGFjdEVxdWF0aW9uKGJpLCBiaiwgc2ksIHNqLCByc2ksIHJzaik7IC8vIENvbnRhY3Qgbm9ybWFsCgogICAgICByLm5pLnNldCgwLCAwLCAxKTsKICAgICAgcWoudm11bHQoci5uaSwgci5uaSk7CiAgICAgIHIubmkubmVnYXRlKHIubmkpOyAvLyBib2R5IGkgaXMgdGhlIHNwaGVyZSwgZmxpcCBub3JtYWwKCiAgICAgIHIubmkubm9ybWFsaXplKCk7IC8vIE5lZWRlZD8KICAgICAgLy8gVmVjdG9yIGZyb20gc3BoZXJlIGNlbnRlciB0byBjb250YWN0IHBvaW50CgogICAgICByLm5pLnNjYWxlKHNpLnJhZGl1cywgci5yaSk7IC8vIFByb2plY3QgZG93biBzcGhlcmUgb24gcGxhbmUKCiAgICAgIHhpLnZzdWIoeGosIHBvaW50X29uX3BsYW5lX3RvX3NwaGVyZSk7CiAgICAgIHIubmkuc2NhbGUoci5uaS5kb3QocG9pbnRfb25fcGxhbmVfdG9fc3BoZXJlKSwgcGxhbmVfdG9fc3BoZXJlX29ydGhvKTsKICAgICAgcG9pbnRfb25fcGxhbmVfdG9fc3BoZXJlLnZzdWIocGxhbmVfdG9fc3BoZXJlX29ydGhvLCByLnJqKTsgLy8gVGhlIHNwaGVyZSBwb3NpdGlvbiBwcm9qZWN0ZWQgdG8gcGxhbmUKCiAgICAgIGlmICgtcG9pbnRfb25fcGxhbmVfdG9fc3BoZXJlLmRvdChyLm5pKSA8PSBzaS5yYWRpdXMpIHsKICAgICAgICBpZiAoanVzdFRlc3QpIHsKICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0gLy8gTWFrZSBpdCByZWxhdGl2ZSB0byB0aGUgYm9keQoKCiAgICAgICAgY29uc3QgcmkgPSByLnJpOwogICAgICAgIGNvbnN0IHJqID0gci5yajsKICAgICAgICByaS52YWRkKHhpLCByaSk7CiAgICAgICAgcmkudnN1YihiaS5wb3NpdGlvbiwgcmkpOwogICAgICAgIHJqLnZhZGQoeGosIHJqKTsKICAgICAgICByai52c3ViKGJqLnBvc2l0aW9uLCByaik7CiAgICAgICAgdGhpcy5yZXN1bHQucHVzaChyKTsKICAgICAgICB0aGlzLmNyZWF0ZUZyaWN0aW9uRXF1YXRpb25zRnJvbUNvbnRhY3QociwgdGhpcy5mcmljdGlvblJlc3VsdCk7CiAgICAgIH0KICAgIH0KCiAgICBib3hCb3goc2ksIHNqLCB4aSwgeGosIHFpLCBxaiwgYmksIGJqLCByc2ksIHJzaiwganVzdFRlc3QpIHsKICAgICAgc2kuY29udmV4UG9seWhlZHJvblJlcHJlc2VudGF0aW9uLm1hdGVyaWFsID0gc2kubWF0ZXJpYWw7CiAgICAgIHNqLmNvbnZleFBvbHloZWRyb25SZXByZXNlbnRhdGlvbi5tYXRlcmlhbCA9IHNqLm1hdGVyaWFsOwogICAgICBzaS5jb252ZXhQb2x5aGVkcm9uUmVwcmVzZW50YXRpb24uY29sbGlzaW9uUmVzcG9uc2UgPSBzaS5jb2xsaXNpb25SZXNwb25zZTsKICAgICAgc2ouY29udmV4UG9seWhlZHJvblJlcHJlc2VudGF0aW9uLmNvbGxpc2lvblJlc3BvbnNlID0gc2ouY29sbGlzaW9uUmVzcG9uc2U7CiAgICAgIHJldHVybiB0aGlzLmNvbnZleENvbnZleChzaS5jb252ZXhQb2x5aGVkcm9uUmVwcmVzZW50YXRpb24sIHNqLmNvbnZleFBvbHloZWRyb25SZXByZXNlbnRhdGlvbiwgeGksIHhqLCBxaSwgcWosIGJpLCBiaiwgc2ksIHNqLCBqdXN0VGVzdCk7CiAgICB9CgogICAgc3BoZXJlQm94KHNpLCBzaiwgeGksIHhqLCBxaSwgcWosIGJpLCBiaiwgcnNpLCByc2osIGp1c3RUZXN0KSB7CiAgICAgIGNvbnN0IHYzcG9vbCA9IHRoaXMudjNwb29sOyAvLyB3ZSByZWZlciB0byB0aGUgYm94IGFzIGJvZHkgagoKICAgICAgY29uc3Qgc2lkZXMgPSBzcGhlcmVCb3hfc2lkZXM7CiAgICAgIHhpLnZzdWIoeGosIGJveF90b19zcGhlcmUpOwogICAgICBzai5nZXRTaWRlTm9ybWFscyhzaWRlcywgcWopOwogICAgICBjb25zdCBSID0gc2kucmFkaXVzOwoKICAgICAgbGV0IGZvdW5kID0gZmFsc2U7IC8vIFN0b3JlIHRoZSByZXN1bHRpbmcgc2lkZSBwZW5ldHJhdGlvbiBpbmZvCgogICAgICBjb25zdCBzaWRlX25zID0gc3BoZXJlQm94X3NpZGVfbnM7CiAgICAgIGNvbnN0IHNpZGVfbnMxID0gc3BoZXJlQm94X3NpZGVfbnMxOwogICAgICBjb25zdCBzaWRlX25zMiA9IHNwaGVyZUJveF9zaWRlX25zMjsKICAgICAgbGV0IHNpZGVfaCA9IG51bGw7CiAgICAgIGxldCBzaWRlX3BlbmV0cmF0aW9ucyA9IDA7CiAgICAgIGxldCBzaWRlX2RvdDEgPSAwOwogICAgICBsZXQgc2lkZV9kb3QyID0gMDsKICAgICAgbGV0IHNpZGVfZGlzdGFuY2UgPSBudWxsOwoKICAgICAgZm9yIChsZXQgaWR4ID0gMCwgbnNpZGVzID0gc2lkZXMubGVuZ3RoOyBpZHggIT09IG5zaWRlcyAmJiBmb3VuZCA9PT0gZmFsc2U7IGlkeCsrKSB7CiAgICAgICAgLy8gR2V0IHRoZSBwbGFuZSBzaWRlIG5vcm1hbCAobnMpCiAgICAgICAgY29uc3QgbnMgPSBzcGhlcmVCb3hfbnM7CiAgICAgICAgbnMuY29weShzaWRlc1tpZHhdKTsKICAgICAgICBjb25zdCBoID0gbnMubGVuZ3RoKCk7CiAgICAgICAgbnMubm9ybWFsaXplKCk7IC8vIFRoZSBub3JtYWwvZGlzdGFuY2UgZG90IHByb2R1Y3QgdGVsbHMgd2hpY2ggc2lkZSBvZiB0aGUgcGxhbmUgd2UgYXJlCgogICAgICAgIGNvbnN0IGRvdCA9IGJveF90b19zcGhlcmUuZG90KG5zKTsKCiAgICAgICAgaWYgKGRvdCA8IGggKyBSICYmIGRvdCA+IDApIHsKICAgICAgICAgIC8vIEludGVyc2VjdHMgcGxhbmUuIE5vdyBjaGVjayB0aGUgb3RoZXIgdHdvIGRpbWVuc2lvbnMKICAgICAgICAgIGNvbnN0IG5zMSA9IHNwaGVyZUJveF9uczE7CiAgICAgICAgICBjb25zdCBuczIgPSBzcGhlcmVCb3hfbnMyOwogICAgICAgICAgbnMxLmNvcHkoc2lkZXNbKGlkeCArIDEpICUgM10pOwogICAgICAgICAgbnMyLmNvcHkoc2lkZXNbKGlkeCArIDIpICUgM10pOwogICAgICAgICAgY29uc3QgaDEgPSBuczEubGVuZ3RoKCk7CiAgICAgICAgICBjb25zdCBoMiA9IG5zMi5sZW5ndGgoKTsKICAgICAgICAgIG5zMS5ub3JtYWxpemUoKTsKICAgICAgICAgIG5zMi5ub3JtYWxpemUoKTsKICAgICAgICAgIGNvbnN0IGRvdDEgPSBib3hfdG9fc3BoZXJlLmRvdChuczEpOwogICAgICAgICAgY29uc3QgZG90MiA9IGJveF90b19zcGhlcmUuZG90KG5zMik7CgogICAgICAgICAgaWYgKGRvdDEgPCBoMSAmJiBkb3QxID4gLWgxICYmIGRvdDIgPCBoMiAmJiBkb3QyID4gLWgyKSB7CiAgICAgICAgICAgIGNvbnN0IGRpc3QgPSBNYXRoLmFicyhkb3QgLSBoIC0gUik7CgogICAgICAgICAgICBpZiAoc2lkZV9kaXN0YW5jZSA9PT0gbnVsbCB8fCBkaXN0IDwgc2lkZV9kaXN0YW5jZSkgewogICAgICAgICAgICAgIHNpZGVfZGlzdGFuY2UgPSBkaXN0OwogICAgICAgICAgICAgIHNpZGVfZG90MSA9IGRvdDE7CiAgICAgICAgICAgICAgc2lkZV9kb3QyID0gZG90MjsKICAgICAgICAgICAgICBzaWRlX2ggPSBoOwogICAgICAgICAgICAgIHNpZGVfbnMuY29weShucyk7CiAgICAgICAgICAgICAgc2lkZV9uczEuY29weShuczEpOwogICAgICAgICAgICAgIHNpZGVfbnMyLmNvcHkobnMyKTsKICAgICAgICAgICAgICBzaWRlX3BlbmV0cmF0aW9ucysrOwoKICAgICAgICAgICAgICBpZiAoanVzdFRlc3QpIHsKICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKHNpZGVfcGVuZXRyYXRpb25zKSB7CiAgICAgICAgZm91bmQgPSB0cnVlOwogICAgICAgIGNvbnN0IHIgPSB0aGlzLmNyZWF0ZUNvbnRhY3RFcXVhdGlvbihiaSwgYmosIHNpLCBzaiwgcnNpLCByc2opOwogICAgICAgIHNpZGVfbnMuc2NhbGUoLVIsIHIucmkpOyAvLyBTcGhlcmUgcgoKICAgICAgICByLm5pLmNvcHkoc2lkZV9ucyk7CiAgICAgICAgci5uaS5uZWdhdGUoci5uaSk7IC8vIE5vcm1hbCBzaG91bGQgYmUgb3V0IG9mIHNwaGVyZQoKICAgICAgICBzaWRlX25zLnNjYWxlKHNpZGVfaCwgc2lkZV9ucyk7CiAgICAgICAgc2lkZV9uczEuc2NhbGUoc2lkZV9kb3QxLCBzaWRlX25zMSk7CiAgICAgICAgc2lkZV9ucy52YWRkKHNpZGVfbnMxLCBzaWRlX25zKTsKICAgICAgICBzaWRlX25zMi5zY2FsZShzaWRlX2RvdDIsIHNpZGVfbnMyKTsKICAgICAgICBzaWRlX25zLnZhZGQoc2lkZV9uczIsIHIucmopOyAvLyBNYWtlIHJlbGF0aXZlIHRvIGJvZGllcwoKICAgICAgICByLnJpLnZhZGQoeGksIHIucmkpOwogICAgICAgIHIucmkudnN1YihiaS5wb3NpdGlvbiwgci5yaSk7CiAgICAgICAgci5yai52YWRkKHhqLCByLnJqKTsKICAgICAgICByLnJqLnZzdWIoYmoucG9zaXRpb24sIHIucmopOwogICAgICAgIHRoaXMucmVzdWx0LnB1c2gocik7CiAgICAgICAgdGhpcy5jcmVhdGVGcmljdGlvbkVxdWF0aW9uc0Zyb21Db250YWN0KHIsIHRoaXMuZnJpY3Rpb25SZXN1bHQpOwogICAgICB9IC8vIENoZWNrIGNvcm5lcnMKCgogICAgICBsZXQgcmogPSB2M3Bvb2wuZ2V0KCk7CiAgICAgIGNvbnN0IHNwaGVyZV90b19jb3JuZXIgPSBzcGhlcmVCb3hfc3BoZXJlX3RvX2Nvcm5lcjsKCiAgICAgIGZvciAobGV0IGogPSAwOyBqICE9PSAyICYmICFmb3VuZDsgaisrKSB7CiAgICAgICAgZm9yIChsZXQgayA9IDA7IGsgIT09IDIgJiYgIWZvdW5kOyBrKyspIHsKICAgICAgICAgIGZvciAobGV0IGwgPSAwOyBsICE9PSAyICYmICFmb3VuZDsgbCsrKSB7CiAgICAgICAgICAgIHJqLnNldCgwLCAwLCAwKTsKCiAgICAgICAgICAgIGlmIChqKSB7CiAgICAgICAgICAgICAgcmoudmFkZChzaWRlc1swXSwgcmopOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHJqLnZzdWIoc2lkZXNbMF0sIHJqKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKGspIHsKICAgICAgICAgICAgICByai52YWRkKHNpZGVzWzFdLCByaik7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgcmoudnN1YihzaWRlc1sxXSwgcmopOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAobCkgewogICAgICAgICAgICAgIHJqLnZhZGQoc2lkZXNbMl0sIHJqKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICByai52c3ViKHNpZGVzWzJdLCByaik7CiAgICAgICAgICAgIH0gLy8gV29ybGQgcG9zaXRpb24gb2YgY29ybmVyCgoKICAgICAgICAgICAgeGoudmFkZChyaiwgc3BoZXJlX3RvX2Nvcm5lcik7CiAgICAgICAgICAgIHNwaGVyZV90b19jb3JuZXIudnN1Yih4aSwgc3BoZXJlX3RvX2Nvcm5lcik7CgogICAgICAgICAgICBpZiAoc3BoZXJlX3RvX2Nvcm5lci5sZW5ndGhTcXVhcmVkKCkgPCBSICogUikgewogICAgICAgICAgICAgIGlmIChqdXN0VGVzdCkgewogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBmb3VuZCA9IHRydWU7CiAgICAgICAgICAgICAgY29uc3QgciA9IHRoaXMuY3JlYXRlQ29udGFjdEVxdWF0aW9uKGJpLCBiaiwgc2ksIHNqLCByc2ksIHJzaik7CiAgICAgICAgICAgICAgci5yaS5jb3B5KHNwaGVyZV90b19jb3JuZXIpOwogICAgICAgICAgICAgIHIucmkubm9ybWFsaXplKCk7CiAgICAgICAgICAgICAgci5uaS5jb3B5KHIucmkpOwogICAgICAgICAgICAgIHIucmkuc2NhbGUoUiwgci5yaSk7CiAgICAgICAgICAgICAgci5yai5jb3B5KHJqKTsgLy8gTWFrZSByZWxhdGl2ZSB0byBib2RpZXMKCiAgICAgICAgICAgICAgci5yaS52YWRkKHhpLCByLnJpKTsKICAgICAgICAgICAgICByLnJpLnZzdWIoYmkucG9zaXRpb24sIHIucmkpOwogICAgICAgICAgICAgIHIucmoudmFkZCh4aiwgci5yaik7CiAgICAgICAgICAgICAgci5yai52c3ViKGJqLnBvc2l0aW9uLCByLnJqKTsKICAgICAgICAgICAgICB0aGlzLnJlc3VsdC5wdXNoKHIpOwogICAgICAgICAgICAgIHRoaXMuY3JlYXRlRnJpY3Rpb25FcXVhdGlvbnNGcm9tQ29udGFjdChyLCB0aGlzLmZyaWN0aW9uUmVzdWx0KTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgdjNwb29sLnJlbGVhc2UocmopOwogICAgICByaiA9IG51bGw7IC8vIENoZWNrIGVkZ2VzCgogICAgICBjb25zdCBlZGdlVGFuZ2VudCA9IHYzcG9vbC5nZXQoKTsKICAgICAgY29uc3QgZWRnZUNlbnRlciA9IHYzcG9vbC5nZXQoKTsKICAgICAgY29uc3QgciA9IHYzcG9vbC5nZXQoKTsgLy8gciA9IGVkZ2UgY2VudGVyIHRvIHNwaGVyZSBjZW50ZXIKCiAgICAgIGNvbnN0IG9ydGhvZ29uYWwgPSB2M3Bvb2wuZ2V0KCk7CiAgICAgIGNvbnN0IGRpc3QgPSB2M3Bvb2wuZ2V0KCk7CiAgICAgIGNvbnN0IE5zaWRlcyA9IHNpZGVzLmxlbmd0aDsKCiAgICAgIGZvciAobGV0IGogPSAwOyBqICE9PSBOc2lkZXMgJiYgIWZvdW5kOyBqKyspIHsKICAgICAgICBmb3IgKGxldCBrID0gMDsgayAhPT0gTnNpZGVzICYmICFmb3VuZDsgaysrKSB7CiAgICAgICAgICBpZiAoaiAlIDMgIT09IGsgJSAzKSB7CiAgICAgICAgICAgIC8vIEdldCBlZGdlIHRhbmdlbnQKICAgICAgICAgICAgc2lkZXNba10uY3Jvc3Moc2lkZXNbal0sIGVkZ2VUYW5nZW50KTsKICAgICAgICAgICAgZWRnZVRhbmdlbnQubm9ybWFsaXplKCk7CiAgICAgICAgICAgIHNpZGVzW2pdLnZhZGQoc2lkZXNba10sIGVkZ2VDZW50ZXIpOwogICAgICAgICAgICByLmNvcHkoeGkpOwogICAgICAgICAgICByLnZzdWIoZWRnZUNlbnRlciwgcik7CiAgICAgICAgICAgIHIudnN1Yih4aiwgcik7CiAgICAgICAgICAgIGNvbnN0IG9ydGhvbm9ybSA9IHIuZG90KGVkZ2VUYW5nZW50KTsgLy8gZGlzdGFuY2UgZnJvbSBlZGdlIGNlbnRlciB0byBzcGhlcmUgY2VudGVyIGluIHRoZSB0YW5nZW50IGRpcmVjdGlvbgoKICAgICAgICAgICAgZWRnZVRhbmdlbnQuc2NhbGUob3J0aG9ub3JtLCBvcnRob2dvbmFsKTsgLy8gVmVjdG9yIGZyb20gZWRnZSBjZW50ZXIgdG8gc3BoZXJlIGNlbnRlciBpbiB0aGUgdGFuZ2VudCBkaXJlY3Rpb24KICAgICAgICAgICAgLy8gRmluZCB0aGUgdGhpcmQgc2lkZSBvcnRob2dvbmFsIHRvIHRoaXMgb25lCgogICAgICAgICAgICBsZXQgbCA9IDA7CgogICAgICAgICAgICB3aGlsZSAobCA9PT0gaiAlIDMgfHwgbCA9PT0gayAlIDMpIHsKICAgICAgICAgICAgICBsKys7CiAgICAgICAgICAgIH0gLy8gdmVjIGZyb20gZWRnZSBjZW50ZXIgdG8gc3BoZXJlIHByb2plY3RlZCB0byB0aGUgcGxhbmUgb3J0aG9nb25hbCB0byB0aGUgZWRnZSB0YW5nZW50CgoKICAgICAgICAgICAgZGlzdC5jb3B5KHhpKTsKICAgICAgICAgICAgZGlzdC52c3ViKG9ydGhvZ29uYWwsIGRpc3QpOwogICAgICAgICAgICBkaXN0LnZzdWIoZWRnZUNlbnRlciwgZGlzdCk7CiAgICAgICAgICAgIGRpc3QudnN1Yih4aiwgZGlzdCk7IC8vIERpc3RhbmNlcyBpbiB0YW5nZW50IGRpcmVjdGlvbiBhbmQgZGlzdGFuY2UgaW4gdGhlIHBsYW5lIG9ydGhvZ29uYWwgdG8gaXQKCiAgICAgICAgICAgIGNvbnN0IHRkaXN0ID0gTWF0aC5hYnMob3J0aG9ub3JtKTsKICAgICAgICAgICAgY29uc3QgbmRpc3QgPSBkaXN0Lmxlbmd0aCgpOwoKICAgICAgICAgICAgaWYgKHRkaXN0IDwgc2lkZXNbbF0ubGVuZ3RoKCkgJiYgbmRpc3QgPCBSKSB7CiAgICAgICAgICAgICAgaWYgKGp1c3RUZXN0KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGZvdW5kID0gdHJ1ZTsKICAgICAgICAgICAgICBjb25zdCByZXMgPSB0aGlzLmNyZWF0ZUNvbnRhY3RFcXVhdGlvbihiaSwgYmosIHNpLCBzaiwgcnNpLCByc2opOwogICAgICAgICAgICAgIGVkZ2VDZW50ZXIudmFkZChvcnRob2dvbmFsLCByZXMucmopOyAvLyBib3ggcmoKCiAgICAgICAgICAgICAgcmVzLnJqLmNvcHkocmVzLnJqKTsKICAgICAgICAgICAgICBkaXN0Lm5lZ2F0ZShyZXMubmkpOwogICAgICAgICAgICAgIHJlcy5uaS5ub3JtYWxpemUoKTsKICAgICAgICAgICAgICByZXMucmkuY29weShyZXMucmopOwogICAgICAgICAgICAgIHJlcy5yaS52YWRkKHhqLCByZXMucmkpOwogICAgICAgICAgICAgIHJlcy5yaS52c3ViKHhpLCByZXMucmkpOwogICAgICAgICAgICAgIHJlcy5yaS5ub3JtYWxpemUoKTsKICAgICAgICAgICAgICByZXMucmkuc2NhbGUoUiwgcmVzLnJpKTsgLy8gTWFrZSByZWxhdGl2ZSB0byBib2RpZXMKCiAgICAgICAgICAgICAgcmVzLnJpLnZhZGQoeGksIHJlcy5yaSk7CiAgICAgICAgICAgICAgcmVzLnJpLnZzdWIoYmkucG9zaXRpb24sIHJlcy5yaSk7CiAgICAgICAgICAgICAgcmVzLnJqLnZhZGQoeGosIHJlcy5yaik7CiAgICAgICAgICAgICAgcmVzLnJqLnZzdWIoYmoucG9zaXRpb24sIHJlcy5yaik7CiAgICAgICAgICAgICAgdGhpcy5yZXN1bHQucHVzaChyZXMpOwogICAgICAgICAgICAgIHRoaXMuY3JlYXRlRnJpY3Rpb25FcXVhdGlvbnNGcm9tQ29udGFjdChyZXMsIHRoaXMuZnJpY3Rpb25SZXN1bHQpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICB2M3Bvb2wucmVsZWFzZShlZGdlVGFuZ2VudCwgZWRnZUNlbnRlciwgciwgb3J0aG9nb25hbCwgZGlzdCk7CiAgICB9CgogICAgcGxhbmVCb3goc2ksIHNqLCB4aSwgeGosIHFpLCBxaiwgYmksIGJqLCByc2ksIHJzaiwganVzdFRlc3QpIHsKICAgICAgc2ouY29udmV4UG9seWhlZHJvblJlcHJlc2VudGF0aW9uLm1hdGVyaWFsID0gc2oubWF0ZXJpYWw7CiAgICAgIHNqLmNvbnZleFBvbHloZWRyb25SZXByZXNlbnRhdGlvbi5jb2xsaXNpb25SZXNwb25zZSA9IHNqLmNvbGxpc2lvblJlc3BvbnNlOwogICAgICBzai5jb252ZXhQb2x5aGVkcm9uUmVwcmVzZW50YXRpb24uaWQgPSBzai5pZDsKICAgICAgcmV0dXJuIHRoaXMucGxhbmVDb252ZXgoc2ksIHNqLmNvbnZleFBvbHloZWRyb25SZXByZXNlbnRhdGlvbiwgeGksIHhqLCBxaSwgcWosIGJpLCBiaiwgc2ksIHNqLCBqdXN0VGVzdCk7CiAgICB9CgogICAgY29udmV4Q29udmV4KHNpLCBzaiwgeGksIHhqLCBxaSwgcWosIGJpLCBiaiwgcnNpLCByc2osIGp1c3RUZXN0LCBmYWNlTGlzdEEsIGZhY2VMaXN0QikgewogICAgICBjb25zdCBzZXBBeGlzID0gY29udmV4Q29udmV4X3NlcEF4aXM7CgogICAgICBpZiAoeGkuZGlzdGFuY2VUbyh4aikgPiBzaS5ib3VuZGluZ1NwaGVyZVJhZGl1cyArIHNqLmJvdW5kaW5nU3BoZXJlUmFkaXVzKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAoc2kuZmluZFNlcGFyYXRpbmdBeGlzKHNqLCB4aSwgcWksIHhqLCBxaiwgc2VwQXhpcywgZmFjZUxpc3RBLCBmYWNlTGlzdEIpKSB7CiAgICAgICAgY29uc3QgcmVzID0gW107CiAgICAgICAgY29uc3QgcSA9IGNvbnZleENvbnZleF9xOwogICAgICAgIHNpLmNsaXBBZ2FpbnN0SHVsbCh4aSwgcWksIHNqLCB4aiwgcWosIHNlcEF4aXMsIC0xMDAsIDEwMCwgcmVzKTsKICAgICAgICBsZXQgbnVtQ29udGFjdHMgPSAwOwoKICAgICAgICBmb3IgKGxldCBqID0gMDsgaiAhPT0gcmVzLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICBpZiAoanVzdFRlc3QpIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICB9CgogICAgICAgICAgY29uc3QgciA9IHRoaXMuY3JlYXRlQ29udGFjdEVxdWF0aW9uKGJpLCBiaiwgc2ksIHNqLCByc2ksIHJzaik7CiAgICAgICAgICBjb25zdCByaSA9IHIucmk7CiAgICAgICAgICBjb25zdCByaiA9IHIucmo7CiAgICAgICAgICBzZXBBeGlzLm5lZ2F0ZShyLm5pKTsKICAgICAgICAgIHJlc1tqXS5ub3JtYWwubmVnYXRlKHEpOwogICAgICAgICAgcS5zY2FsZShyZXNbal0uZGVwdGgsIHEpOwogICAgICAgICAgcmVzW2pdLnBvaW50LnZhZGQocSwgcmkpOwogICAgICAgICAgcmouY29weShyZXNbal0ucG9pbnQpOyAvLyBDb250YWN0IHBvaW50cyBhcmUgaW4gd29ybGQgY29vcmRpbmF0ZXMuIFRyYW5zZm9ybSBiYWNrIHRvIHJlbGF0aXZlCgogICAgICAgICAgcmkudnN1Yih4aSwgcmkpOwogICAgICAgICAgcmoudnN1Yih4aiwgcmopOyAvLyBNYWtlIHJlbGF0aXZlIHRvIGJvZGllcwoKICAgICAgICAgIHJpLnZhZGQoeGksIHJpKTsKICAgICAgICAgIHJpLnZzdWIoYmkucG9zaXRpb24sIHJpKTsKICAgICAgICAgIHJqLnZhZGQoeGosIHJqKTsKICAgICAgICAgIHJqLnZzdWIoYmoucG9zaXRpb24sIHJqKTsKICAgICAgICAgIHRoaXMucmVzdWx0LnB1c2gocik7CiAgICAgICAgICBudW1Db250YWN0cysrOwoKICAgICAgICAgIGlmICghdGhpcy5lbmFibGVGcmljdGlvblJlZHVjdGlvbikgewogICAgICAgICAgICB0aGlzLmNyZWF0ZUZyaWN0aW9uRXF1YXRpb25zRnJvbUNvbnRhY3QociwgdGhpcy5mcmljdGlvblJlc3VsdCk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAodGhpcy5lbmFibGVGcmljdGlvblJlZHVjdGlvbiAmJiBudW1Db250YWN0cykgewogICAgICAgICAgdGhpcy5jcmVhdGVGcmljdGlvbkZyb21BdmVyYWdlKG51bUNvbnRhY3RzKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBzcGhlcmVDb252ZXgoc2ksIHNqLCB4aSwgeGosIHFpLCBxaiwgYmksIGJqLCByc2ksIHJzaiwganVzdFRlc3QpIHsKICAgICAgY29uc3QgdjNwb29sID0gdGhpcy52M3Bvb2w7CiAgICAgIHhpLnZzdWIoeGosIGNvbnZleF90b19zcGhlcmUpOwogICAgICBjb25zdCBub3JtYWxzID0gc2ouZmFjZU5vcm1hbHM7CiAgICAgIGNvbnN0IGZhY2VzID0gc2ouZmFjZXM7CiAgICAgIGNvbnN0IHZlcnRzID0gc2oudmVydGljZXM7CiAgICAgIGNvbnN0IFIgPSBzaS5yYWRpdXM7CiAgICAgIC8vICAgICByZXR1cm47CiAgICAgIC8vIH0KCiAgICAgIGxldCBmb3VuZCA9IGZhbHNlOyAvLyBDaGVjayBjb3JuZXJzCgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gdmVydHMubGVuZ3RoOyBpKyspIHsKICAgICAgICBjb25zdCB2ID0gdmVydHNbaV07IC8vIFdvcmxkIHBvc2l0aW9uIG9mIGNvcm5lcgoKICAgICAgICBjb25zdCB3b3JsZENvcm5lciA9IHNwaGVyZUNvbnZleF93b3JsZENvcm5lcjsKICAgICAgICBxai52bXVsdCh2LCB3b3JsZENvcm5lcik7CiAgICAgICAgeGoudmFkZCh3b3JsZENvcm5lciwgd29ybGRDb3JuZXIpOwogICAgICAgIGNvbnN0IHNwaGVyZV90b19jb3JuZXIgPSBzcGhlcmVDb252ZXhfc3BoZXJlVG9Db3JuZXI7CiAgICAgICAgd29ybGRDb3JuZXIudnN1Yih4aSwgc3BoZXJlX3RvX2Nvcm5lcik7CgogICAgICAgIGlmIChzcGhlcmVfdG9fY29ybmVyLmxlbmd0aFNxdWFyZWQoKSA8IFIgKiBSKSB7CiAgICAgICAgICBpZiAoanVzdFRlc3QpIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICB9CgogICAgICAgICAgZm91bmQgPSB0cnVlOwogICAgICAgICAgY29uc3QgciA9IHRoaXMuY3JlYXRlQ29udGFjdEVxdWF0aW9uKGJpLCBiaiwgc2ksIHNqLCByc2ksIHJzaik7CiAgICAgICAgICByLnJpLmNvcHkoc3BoZXJlX3RvX2Nvcm5lcik7CiAgICAgICAgICByLnJpLm5vcm1hbGl6ZSgpOwogICAgICAgICAgci5uaS5jb3B5KHIucmkpOwogICAgICAgICAgci5yaS5zY2FsZShSLCByLnJpKTsKICAgICAgICAgIHdvcmxkQ29ybmVyLnZzdWIoeGosIHIucmopOyAvLyBTaG91bGQgYmUgcmVsYXRpdmUgdG8gdGhlIGJvZHkuCgogICAgICAgICAgci5yaS52YWRkKHhpLCByLnJpKTsKICAgICAgICAgIHIucmkudnN1YihiaS5wb3NpdGlvbiwgci5yaSk7IC8vIFNob3VsZCBiZSByZWxhdGl2ZSB0byB0aGUgYm9keS4KCiAgICAgICAgICByLnJqLnZhZGQoeGosIHIucmopOwogICAgICAgICAgci5yai52c3ViKGJqLnBvc2l0aW9uLCByLnJqKTsKICAgICAgICAgIHRoaXMucmVzdWx0LnB1c2gocik7CiAgICAgICAgICB0aGlzLmNyZWF0ZUZyaWN0aW9uRXF1YXRpb25zRnJvbUNvbnRhY3QociwgdGhpcy5mcmljdGlvblJlc3VsdCk7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICB9IC8vIENoZWNrIHNpZGUgKHBsYW5lKSBpbnRlcnNlY3Rpb25zCgoKICAgICAgZm9yIChsZXQgaSA9IDAsIG5mYWNlcyA9IGZhY2VzLmxlbmd0aDsgaSAhPT0gbmZhY2VzICYmIGZvdW5kID09PSBmYWxzZTsgaSsrKSB7CiAgICAgICAgY29uc3Qgbm9ybWFsID0gbm9ybWFsc1tpXTsKICAgICAgICBjb25zdCBmYWNlID0gZmFjZXNbaV07IC8vIEdldCB3b3JsZC10cmFuc2Zvcm1lZCBub3JtYWwgb2YgdGhlIGZhY2UKCiAgICAgICAgY29uc3Qgd29ybGROb3JtYWwgPSBzcGhlcmVDb252ZXhfd29ybGROb3JtYWw7CiAgICAgICAgcWoudm11bHQobm9ybWFsLCB3b3JsZE5vcm1hbCk7IC8vIEdldCBhIHdvcmxkIHZlcnRleCBmcm9tIHRoZSBmYWNlCgogICAgICAgIGNvbnN0IHdvcmxkUG9pbnQgPSBzcGhlcmVDb252ZXhfd29ybGRQb2ludDsKICAgICAgICBxai52bXVsdCh2ZXJ0c1tmYWNlWzBdXSwgd29ybGRQb2ludCk7CiAgICAgICAgd29ybGRQb2ludC52YWRkKHhqLCB3b3JsZFBvaW50KTsgLy8gR2V0IGEgcG9pbnQgb24gdGhlIHNwaGVyZSwgY2xvc2VzdCB0byB0aGUgZmFjZSBub3JtYWwKCiAgICAgICAgY29uc3Qgd29ybGRTcGhlcmVQb2ludENsb3Nlc3RUb1BsYW5lID0gc3BoZXJlQ29udmV4X3dvcmxkU3BoZXJlUG9pbnRDbG9zZXN0VG9QbGFuZTsKICAgICAgICB3b3JsZE5vcm1hbC5zY2FsZSgtUiwgd29ybGRTcGhlcmVQb2ludENsb3Nlc3RUb1BsYW5lKTsKICAgICAgICB4aS52YWRkKHdvcmxkU3BoZXJlUG9pbnRDbG9zZXN0VG9QbGFuZSwgd29ybGRTcGhlcmVQb2ludENsb3Nlc3RUb1BsYW5lKTsgLy8gVmVjdG9yIGZyb20gYSBmYWNlIHBvaW50IHRvIHRoZSBjbG9zZXN0IHBvaW50IG9uIHRoZSBzcGhlcmUKCiAgICAgICAgY29uc3QgcGVuZXRyYXRpb25WZWMgPSBzcGhlcmVDb252ZXhfcGVuZXRyYXRpb25WZWM7CiAgICAgICAgd29ybGRTcGhlcmVQb2ludENsb3Nlc3RUb1BsYW5lLnZzdWIod29ybGRQb2ludCwgcGVuZXRyYXRpb25WZWMpOyAvLyBUaGUgcGVuZXRyYXRpb24uIE5lZ2F0aXZlIHZhbHVlIG1lYW5zIG92ZXJsYXAuCgogICAgICAgIGNvbnN0IHBlbmV0cmF0aW9uID0gcGVuZXRyYXRpb25WZWMuZG90KHdvcmxkTm9ybWFsKTsKICAgICAgICBjb25zdCB3b3JsZFBvaW50VG9TcGhlcmUgPSBzcGhlcmVDb252ZXhfc3BoZXJlVG9Xb3JsZFBvaW50OwogICAgICAgIHhpLnZzdWIod29ybGRQb2ludCwgd29ybGRQb2ludFRvU3BoZXJlKTsKCiAgICAgICAgaWYgKHBlbmV0cmF0aW9uIDwgMCAmJiB3b3JsZFBvaW50VG9TcGhlcmUuZG90KHdvcmxkTm9ybWFsKSA+IDApIHsKICAgICAgICAgIC8vIEludGVyc2VjdHMgcGxhbmUuIE5vdyBjaGVjayBpZiB0aGUgc3BoZXJlIGlzIGluc2lkZSB0aGUgZmFjZSBwb2x5Z29uCiAgICAgICAgICBjb25zdCBmYWNlVmVydHMgPSBbXTsgLy8gRmFjZSB2ZXJ0aWNlcywgaW4gd29ybGQgY29vcmRzCgogICAgICAgICAgZm9yIChsZXQgaiA9IDAsIE52ZXJ0cyA9IGZhY2UubGVuZ3RoOyBqICE9PSBOdmVydHM7IGorKykgewogICAgICAgICAgICBjb25zdCB3b3JsZFZlcnRleCA9IHYzcG9vbC5nZXQoKTsKICAgICAgICAgICAgcWoudm11bHQodmVydHNbZmFjZVtqXV0sIHdvcmxkVmVydGV4KTsKICAgICAgICAgICAgeGoudmFkZCh3b3JsZFZlcnRleCwgd29ybGRWZXJ0ZXgpOwogICAgICAgICAgICBmYWNlVmVydHMucHVzaCh3b3JsZFZlcnRleCk7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKHBvaW50SW5Qb2x5Z29uKGZhY2VWZXJ0cywgd29ybGROb3JtYWwsIHhpKSkgewogICAgICAgICAgICAvLyBJcyB0aGUgc3BoZXJlIGNlbnRlciBpbiB0aGUgZmFjZSBwb2x5Z29uPwogICAgICAgICAgICBpZiAoanVzdFRlc3QpIHsKICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZm91bmQgPSB0cnVlOwogICAgICAgICAgICBjb25zdCByID0gdGhpcy5jcmVhdGVDb250YWN0RXF1YXRpb24oYmksIGJqLCBzaSwgc2osIHJzaSwgcnNqKTsKICAgICAgICAgICAgd29ybGROb3JtYWwuc2NhbGUoLVIsIHIucmkpOyAvLyBDb250YWN0IG9mZnNldCwgZnJvbSBzcGhlcmUgY2VudGVyIHRvIGNvbnRhY3QKCiAgICAgICAgICAgIHdvcmxkTm9ybWFsLm5lZ2F0ZShyLm5pKTsgLy8gTm9ybWFsIHBvaW50aW5nIG91dCBvZiBzcGhlcmUKCiAgICAgICAgICAgIGNvbnN0IHBlbmV0cmF0aW9uVmVjMiA9IHYzcG9vbC5nZXQoKTsKICAgICAgICAgICAgd29ybGROb3JtYWwuc2NhbGUoLXBlbmV0cmF0aW9uLCBwZW5ldHJhdGlvblZlYzIpOwogICAgICAgICAgICBjb25zdCBwZW5ldHJhdGlvblNwaGVyZVBvaW50ID0gdjNwb29sLmdldCgpOwogICAgICAgICAgICB3b3JsZE5vcm1hbC5zY2FsZSgtUiwgcGVuZXRyYXRpb25TcGhlcmVQb2ludCk7IC8veGkudnN1Yih4aikudmFkZChwZW5ldHJhdGlvblNwaGVyZVBvaW50KS52YWRkKHBlbmV0cmF0aW9uVmVjMiAsIHIucmopOwoKICAgICAgICAgICAgeGkudnN1Yih4aiwgci5yaik7CiAgICAgICAgICAgIHIucmoudmFkZChwZW5ldHJhdGlvblNwaGVyZVBvaW50LCByLnJqKTsKICAgICAgICAgICAgci5yai52YWRkKHBlbmV0cmF0aW9uVmVjMiwgci5yaik7IC8vIFNob3VsZCBiZSByZWxhdGl2ZSB0byB0aGUgYm9keS4KCiAgICAgICAgICAgIHIucmoudmFkZCh4aiwgci5yaik7CiAgICAgICAgICAgIHIucmoudnN1Yihiai5wb3NpdGlvbiwgci5yaik7IC8vIFNob3VsZCBiZSByZWxhdGl2ZSB0byB0aGUgYm9keS4KCiAgICAgICAgICAgIHIucmkudmFkZCh4aSwgci5yaSk7CiAgICAgICAgICAgIHIucmkudnN1YihiaS5wb3NpdGlvbiwgci5yaSk7CiAgICAgICAgICAgIHYzcG9vbC5yZWxlYXNlKHBlbmV0cmF0aW9uVmVjMik7CiAgICAgICAgICAgIHYzcG9vbC5yZWxlYXNlKHBlbmV0cmF0aW9uU3BoZXJlUG9pbnQpOwogICAgICAgICAgICB0aGlzLnJlc3VsdC5wdXNoKHIpOwogICAgICAgICAgICB0aGlzLmNyZWF0ZUZyaWN0aW9uRXF1YXRpb25zRnJvbUNvbnRhY3QociwgdGhpcy5mcmljdGlvblJlc3VsdCk7IC8vIFJlbGVhc2Ugd29ybGQgdmVydGljZXMKCiAgICAgICAgICAgIGZvciAobGV0IGogPSAwLCBOZmFjZXZlcnRzID0gZmFjZVZlcnRzLmxlbmd0aDsgaiAhPT0gTmZhY2V2ZXJ0czsgaisrKSB7CiAgICAgICAgICAgICAgdjNwb29sLnJlbGVhc2UoZmFjZVZlcnRzW2pdKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuOyAvLyBXZSBvbmx5IGV4cGVjdCAqb25lKiBmYWNlIGNvbnRhY3QKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIEVkZ2U/CiAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqICE9PSBmYWNlLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgICAgLy8gR2V0IHR3byB3b3JsZCB0cmFuc2Zvcm1lZCB2ZXJ0aWNlcwogICAgICAgICAgICAgIGNvbnN0IHYxID0gdjNwb29sLmdldCgpOwogICAgICAgICAgICAgIGNvbnN0IHYyID0gdjNwb29sLmdldCgpOwogICAgICAgICAgICAgIHFqLnZtdWx0KHZlcnRzW2ZhY2VbKGogKyAxKSAlIGZhY2UubGVuZ3RoXV0sIHYxKTsKICAgICAgICAgICAgICBxai52bXVsdCh2ZXJ0c1tmYWNlWyhqICsgMikgJSBmYWNlLmxlbmd0aF1dLCB2Mik7CiAgICAgICAgICAgICAgeGoudmFkZCh2MSwgdjEpOwogICAgICAgICAgICAgIHhqLnZhZGQodjIsIHYyKTsgLy8gQ29uc3RydWN0IGVkZ2UgdmVjdG9yCgogICAgICAgICAgICAgIGNvbnN0IGVkZ2UgPSBzcGhlcmVDb252ZXhfZWRnZTsKICAgICAgICAgICAgICB2Mi52c3ViKHYxLCBlZGdlKTsgLy8gQ29uc3RydWN0IHRoZSBzYW1lIHZlY3RvciwgYnV0IG5vcm1hbGl6ZWQKCiAgICAgICAgICAgICAgY29uc3QgZWRnZVVuaXQgPSBzcGhlcmVDb252ZXhfZWRnZVVuaXQ7CiAgICAgICAgICAgICAgZWRnZS51bml0KGVkZ2VVbml0KTsgLy8gcCBpcyB4aSBwcm9qZWN0ZWQgb250byB0aGUgZWRnZQoKICAgICAgICAgICAgICBjb25zdCBwID0gdjNwb29sLmdldCgpOwogICAgICAgICAgICAgIGNvbnN0IHYxX3RvX3hpID0gdjNwb29sLmdldCgpOwogICAgICAgICAgICAgIHhpLnZzdWIodjEsIHYxX3RvX3hpKTsKICAgICAgICAgICAgICBjb25zdCBkb3QgPSB2MV90b194aS5kb3QoZWRnZVVuaXQpOwogICAgICAgICAgICAgIGVkZ2VVbml0LnNjYWxlKGRvdCwgcCk7CiAgICAgICAgICAgICAgcC52YWRkKHYxLCBwKTsgLy8gQ29tcHV0ZSBhIHZlY3RvciBmcm9tIHAgdG8gdGhlIGNlbnRlciBvZiB0aGUgc3BoZXJlCgogICAgICAgICAgICAgIGNvbnN0IHhpX3RvX3AgPSB2M3Bvb2wuZ2V0KCk7CiAgICAgICAgICAgICAgcC52c3ViKHhpLCB4aV90b19wKTsgLy8gQ29sbGlzaW9uIGlmIHRoZSBlZGdlLXNwaGVyZSBkaXN0YW5jZSBpcyBsZXNzIHRoYW4gdGhlIHJhZGl1cwogICAgICAgICAgICAgIC8vIEFORCBpZiBwIGlzIGluIGJldHdlZW4gdjEgYW5kIHYyCgogICAgICAgICAgICAgIGlmIChkb3QgPiAwICYmIGRvdCAqIGRvdCA8IGVkZ2UubGVuZ3RoU3F1YXJlZCgpICYmIHhpX3RvX3AubGVuZ3RoU3F1YXJlZCgpIDwgUiAqIFIpIHsKICAgICAgICAgICAgICAgIC8vIENvbGxpc2lvbiBpZiB0aGUgZWRnZS1zcGhlcmUgZGlzdGFuY2UgaXMgbGVzcyB0aGFuIHRoZSByYWRpdXMKICAgICAgICAgICAgICAgIC8vIEVkZ2UgY29udGFjdCEKICAgICAgICAgICAgICAgIGlmIChqdXN0VGVzdCkgewogICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBjb25zdCByID0gdGhpcy5jcmVhdGVDb250YWN0RXF1YXRpb24oYmksIGJqLCBzaSwgc2osIHJzaSwgcnNqKTsKICAgICAgICAgICAgICAgIHAudnN1Yih4aiwgci5yaik7CiAgICAgICAgICAgICAgICBwLnZzdWIoeGksIHIubmkpOwogICAgICAgICAgICAgICAgci5uaS5ub3JtYWxpemUoKTsKICAgICAgICAgICAgICAgIHIubmkuc2NhbGUoUiwgci5yaSk7IC8vIFNob3VsZCBiZSByZWxhdGl2ZSB0byB0aGUgYm9keS4KCiAgICAgICAgICAgICAgICByLnJqLnZhZGQoeGosIHIucmopOwogICAgICAgICAgICAgICAgci5yai52c3ViKGJqLnBvc2l0aW9uLCByLnJqKTsgLy8gU2hvdWxkIGJlIHJlbGF0aXZlIHRvIHRoZSBib2R5LgoKICAgICAgICAgICAgICAgIHIucmkudmFkZCh4aSwgci5yaSk7CiAgICAgICAgICAgICAgICByLnJpLnZzdWIoYmkucG9zaXRpb24sIHIucmkpOwogICAgICAgICAgICAgICAgdGhpcy5yZXN1bHQucHVzaChyKTsKICAgICAgICAgICAgICAgIHRoaXMuY3JlYXRlRnJpY3Rpb25FcXVhdGlvbnNGcm9tQ29udGFjdChyLCB0aGlzLmZyaWN0aW9uUmVzdWx0KTsgLy8gUmVsZWFzZSB3b3JsZCB2ZXJ0aWNlcwoKICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAwLCBOZmFjZXZlcnRzID0gZmFjZVZlcnRzLmxlbmd0aDsgaiAhPT0gTmZhY2V2ZXJ0czsgaisrKSB7CiAgICAgICAgICAgICAgICAgIHYzcG9vbC5yZWxlYXNlKGZhY2VWZXJ0c1tqXSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgdjNwb29sLnJlbGVhc2UodjEpOwogICAgICAgICAgICAgICAgdjNwb29sLnJlbGVhc2UodjIpOwogICAgICAgICAgICAgICAgdjNwb29sLnJlbGVhc2UocCk7CiAgICAgICAgICAgICAgICB2M3Bvb2wucmVsZWFzZSh4aV90b19wKTsKICAgICAgICAgICAgICAgIHYzcG9vbC5yZWxlYXNlKHYxX3RvX3hpKTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHYzcG9vbC5yZWxlYXNlKHYxKTsKICAgICAgICAgICAgICB2M3Bvb2wucmVsZWFzZSh2Mik7CiAgICAgICAgICAgICAgdjNwb29sLnJlbGVhc2UocCk7CiAgICAgICAgICAgICAgdjNwb29sLnJlbGVhc2UoeGlfdG9fcCk7CiAgICAgICAgICAgICAgdjNwb29sLnJlbGVhc2UodjFfdG9feGkpOwogICAgICAgICAgICB9CiAgICAgICAgICB9IC8vIFJlbGVhc2Ugd29ybGQgdmVydGljZXMKCgogICAgICAgICAgZm9yIChsZXQgaiA9IDAsIE5mYWNldmVydHMgPSBmYWNlVmVydHMubGVuZ3RoOyBqICE9PSBOZmFjZXZlcnRzOyBqKyspIHsKICAgICAgICAgICAgdjNwb29sLnJlbGVhc2UoZmFjZVZlcnRzW2pdKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBwbGFuZUNvbnZleChwbGFuZVNoYXBlLCBjb252ZXhTaGFwZSwgcGxhbmVQb3NpdGlvbiwgY29udmV4UG9zaXRpb24sIHBsYW5lUXVhdCwgY29udmV4UXVhdCwgcGxhbmVCb2R5LCBjb252ZXhCb2R5LCBzaSwgc2osIGp1c3RUZXN0KSB7CiAgICAgIC8vIFNpbXBseSByZXR1cm4gdGhlIHBvaW50cyBiZWhpbmQgdGhlIHBsYW5lLgogICAgICBjb25zdCB3b3JsZFZlcnRleCA9IHBsYW5lQ29udmV4X3Y7CiAgICAgIGNvbnN0IHdvcmxkTm9ybWFsID0gcGxhbmVDb252ZXhfbm9ybWFsOwogICAgICB3b3JsZE5vcm1hbC5zZXQoMCwgMCwgMSk7CiAgICAgIHBsYW5lUXVhdC52bXVsdCh3b3JsZE5vcm1hbCwgd29ybGROb3JtYWwpOyAvLyBUdXJuIG5vcm1hbCBhY2NvcmRpbmcgdG8gcGxhbmUgb3JpZW50YXRpb24KCiAgICAgIGxldCBudW1Db250YWN0cyA9IDA7CiAgICAgIGNvbnN0IHJlbHBvcyA9IHBsYW5lQ29udmV4X3JlbHBvczsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSBjb252ZXhTaGFwZS52ZXJ0aWNlcy5sZW5ndGg7IGkrKykgewogICAgICAgIC8vIEdldCB3b3JsZCBjb252ZXggdmVydGV4CiAgICAgICAgd29ybGRWZXJ0ZXguY29weShjb252ZXhTaGFwZS52ZXJ0aWNlc1tpXSk7CiAgICAgICAgY29udmV4UXVhdC52bXVsdCh3b3JsZFZlcnRleCwgd29ybGRWZXJ0ZXgpOwogICAgICAgIGNvbnZleFBvc2l0aW9uLnZhZGQod29ybGRWZXJ0ZXgsIHdvcmxkVmVydGV4KTsKICAgICAgICB3b3JsZFZlcnRleC52c3ViKHBsYW5lUG9zaXRpb24sIHJlbHBvcyk7CiAgICAgICAgY29uc3QgZG90ID0gd29ybGROb3JtYWwuZG90KHJlbHBvcyk7CgogICAgICAgIGlmIChkb3QgPD0gMC4wKSB7CiAgICAgICAgICBpZiAoanVzdFRlc3QpIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICB9CgogICAgICAgICAgY29uc3QgciA9IHRoaXMuY3JlYXRlQ29udGFjdEVxdWF0aW9uKHBsYW5lQm9keSwgY29udmV4Qm9keSwgcGxhbmVTaGFwZSwgY29udmV4U2hhcGUsIHNpLCBzaik7IC8vIEdldCB2ZXJ0ZXggcG9zaXRpb24gcHJvamVjdGVkIG9uIHBsYW5lCgogICAgICAgICAgY29uc3QgcHJvamVjdGVkID0gcGxhbmVDb252ZXhfcHJvamVjdGVkOwogICAgICAgICAgd29ybGROb3JtYWwuc2NhbGUod29ybGROb3JtYWwuZG90KHJlbHBvcyksIHByb2plY3RlZCk7CiAgICAgICAgICB3b3JsZFZlcnRleC52c3ViKHByb2plY3RlZCwgcHJvamVjdGVkKTsKICAgICAgICAgIHByb2plY3RlZC52c3ViKHBsYW5lUG9zaXRpb24sIHIucmkpOyAvLyBGcm9tIHBsYW5lIHRvIHZlcnRleCBwcm9qZWN0ZWQgb24gcGxhbmUKCiAgICAgICAgICByLm5pLmNvcHkod29ybGROb3JtYWwpOyAvLyBDb250YWN0IG5vcm1hbCBpcyB0aGUgcGxhbmUgbm9ybWFsIG91dCBmcm9tIHBsYW5lCiAgICAgICAgICAvLyByaiBpcyBub3cganVzdCB0aGUgdmVjdG9yIGZyb20gdGhlIGNvbnZleCBjZW50ZXIgdG8gdGhlIHZlcnRleAoKICAgICAgICAgIHdvcmxkVmVydGV4LnZzdWIoY29udmV4UG9zaXRpb24sIHIucmopOyAvLyBNYWtlIGl0IHJlbGF0aXZlIHRvIHRoZSBib2R5CgogICAgICAgICAgci5yaS52YWRkKHBsYW5lUG9zaXRpb24sIHIucmkpOwogICAgICAgICAgci5yaS52c3ViKHBsYW5lQm9keS5wb3NpdGlvbiwgci5yaSk7CiAgICAgICAgICByLnJqLnZhZGQoY29udmV4UG9zaXRpb24sIHIucmopOwogICAgICAgICAgci5yai52c3ViKGNvbnZleEJvZHkucG9zaXRpb24sIHIucmopOwogICAgICAgICAgdGhpcy5yZXN1bHQucHVzaChyKTsKICAgICAgICAgIG51bUNvbnRhY3RzKys7CgogICAgICAgICAgaWYgKCF0aGlzLmVuYWJsZUZyaWN0aW9uUmVkdWN0aW9uKSB7CiAgICAgICAgICAgIHRoaXMuY3JlYXRlRnJpY3Rpb25FcXVhdGlvbnNGcm9tQ29udGFjdChyLCB0aGlzLmZyaWN0aW9uUmVzdWx0KTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLmVuYWJsZUZyaWN0aW9uUmVkdWN0aW9uICYmIG51bUNvbnRhY3RzKSB7CiAgICAgICAgdGhpcy5jcmVhdGVGcmljdGlvbkZyb21BdmVyYWdlKG51bUNvbnRhY3RzKTsKICAgICAgfQogICAgfQoKICAgIGJveENvbnZleChzaSwgc2osIHhpLCB4aiwgcWksIHFqLCBiaSwgYmosIHJzaSwgcnNqLCBqdXN0VGVzdCkgewogICAgICBzaS5jb252ZXhQb2x5aGVkcm9uUmVwcmVzZW50YXRpb24ubWF0ZXJpYWwgPSBzaS5tYXRlcmlhbDsKICAgICAgc2kuY29udmV4UG9seWhlZHJvblJlcHJlc2VudGF0aW9uLmNvbGxpc2lvblJlc3BvbnNlID0gc2kuY29sbGlzaW9uUmVzcG9uc2U7CiAgICAgIHJldHVybiB0aGlzLmNvbnZleENvbnZleChzaS5jb252ZXhQb2x5aGVkcm9uUmVwcmVzZW50YXRpb24sIHNqLCB4aSwgeGosIHFpLCBxaiwgYmksIGJqLCBzaSwgc2osIGp1c3RUZXN0KTsKICAgIH0KCiAgICBzcGhlcmVIZWlnaHRmaWVsZChzcGhlcmVTaGFwZSwgaGZTaGFwZSwgc3BoZXJlUG9zLCBoZlBvcywgc3BoZXJlUXVhdCwgaGZRdWF0LCBzcGhlcmVCb2R5LCBoZkJvZHksIHJzaSwgcnNqLCBqdXN0VGVzdCkgewogICAgICBjb25zdCBkYXRhID0gaGZTaGFwZS5kYXRhOwogICAgICBjb25zdCByYWRpdXMgPSBzcGhlcmVTaGFwZS5yYWRpdXM7CiAgICAgIGNvbnN0IHcgPSBoZlNoYXBlLmVsZW1lbnRTaXplOwogICAgICBjb25zdCB3b3JsZFBpbGxhck9mZnNldCA9IHNwaGVyZUhlaWdodGZpZWxkX3RtcDI7IC8vIEdldCBzcGhlcmUgcG9zaXRpb24gdG8gaGVpZ2h0ZmllbGQgbG9jYWwhCgogICAgICBjb25zdCBsb2NhbFNwaGVyZVBvcyA9IHNwaGVyZUhlaWdodGZpZWxkX3RtcDE7CiAgICAgIFRyYW5zZm9ybS5wb2ludFRvTG9jYWxGcmFtZShoZlBvcywgaGZRdWF0LCBzcGhlcmVQb3MsIGxvY2FsU3BoZXJlUG9zKTsgLy8gR2V0IHRoZSBpbmRleCBvZiB0aGUgZGF0YSBwb2ludHMgdG8gdGVzdCBhZ2FpbnN0CgogICAgICBsZXQgaU1pblggPSBNYXRoLmZsb29yKChsb2NhbFNwaGVyZVBvcy54IC0gcmFkaXVzKSAvIHcpIC0gMTsKICAgICAgbGV0IGlNYXhYID0gTWF0aC5jZWlsKChsb2NhbFNwaGVyZVBvcy54ICsgcmFkaXVzKSAvIHcpICsgMTsKICAgICAgbGV0IGlNaW5ZID0gTWF0aC5mbG9vcigobG9jYWxTcGhlcmVQb3MueSAtIHJhZGl1cykgLyB3KSAtIDE7CiAgICAgIGxldCBpTWF4WSA9IE1hdGguY2VpbCgobG9jYWxTcGhlcmVQb3MueSArIHJhZGl1cykgLyB3KSArIDE7IC8vIEJhaWwgb3V0IGlmIHdlIGFyZSBvdXQgb2YgdGhlIHRlcnJhaW4KCiAgICAgIGlmIChpTWF4WCA8IDAgfHwgaU1heFkgPCAwIHx8IGlNaW5YID4gZGF0YS5sZW5ndGggfHwgaU1pblkgPiBkYXRhWzBdLmxlbmd0aCkgewogICAgICAgIHJldHVybjsKICAgICAgfSAvLyBDbGFtcCBpbmRleCB0byBlZGdlcwoKCiAgICAgIGlmIChpTWluWCA8IDApIHsKICAgICAgICBpTWluWCA9IDA7CiAgICAgIH0KCiAgICAgIGlmIChpTWF4WCA8IDApIHsKICAgICAgICBpTWF4WCA9IDA7CiAgICAgIH0KCiAgICAgIGlmIChpTWluWSA8IDApIHsKICAgICAgICBpTWluWSA9IDA7CiAgICAgIH0KCiAgICAgIGlmIChpTWF4WSA8IDApIHsKICAgICAgICBpTWF4WSA9IDA7CiAgICAgIH0KCiAgICAgIGlmIChpTWluWCA+PSBkYXRhLmxlbmd0aCkgewogICAgICAgIGlNaW5YID0gZGF0YS5sZW5ndGggLSAxOwogICAgICB9CgogICAgICBpZiAoaU1heFggPj0gZGF0YS5sZW5ndGgpIHsKICAgICAgICBpTWF4WCA9IGRhdGEubGVuZ3RoIC0gMTsKICAgICAgfQoKICAgICAgaWYgKGlNYXhZID49IGRhdGFbMF0ubGVuZ3RoKSB7CiAgICAgICAgaU1heFkgPSBkYXRhWzBdLmxlbmd0aCAtIDE7CiAgICAgIH0KCiAgICAgIGlmIChpTWluWSA+PSBkYXRhWzBdLmxlbmd0aCkgewogICAgICAgIGlNaW5ZID0gZGF0YVswXS5sZW5ndGggLSAxOwogICAgICB9CgogICAgICBjb25zdCBtaW5NYXggPSBbXTsKICAgICAgaGZTaGFwZS5nZXRSZWN0TWluTWF4KGlNaW5YLCBpTWluWSwgaU1heFgsIGlNYXhZLCBtaW5NYXgpOwogICAgICBjb25zdCBtaW4gPSBtaW5NYXhbMF07CiAgICAgIGNvbnN0IG1heCA9IG1pbk1heFsxXTsgLy8gQmFpbCBvdXQgaWYgd2UgY2FuJ3QgdG91Y2ggdGhlIGJvdW5kaW5nIGhlaWdodCBib3gKCiAgICAgIGlmIChsb2NhbFNwaGVyZVBvcy56IC0gcmFkaXVzID4gbWF4IHx8IGxvY2FsU3BoZXJlUG9zLnogKyByYWRpdXMgPCBtaW4pIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGNvbnN0IHJlc3VsdCA9IHRoaXMucmVzdWx0OwoKICAgICAgZm9yIChsZXQgaSA9IGlNaW5YOyBpIDwgaU1heFg7IGkrKykgewogICAgICAgIGZvciAobGV0IGogPSBpTWluWTsgaiA8IGlNYXhZOyBqKyspIHsKICAgICAgICAgIGNvbnN0IG51bUNvbnRhY3RzQmVmb3JlID0gcmVzdWx0Lmxlbmd0aDsKICAgICAgICAgIGxldCBpbnRlcnNlY3RpbmcgPSBmYWxzZTsgLy8gTG93ZXIgdHJpYW5nbGUKCiAgICAgICAgICBoZlNoYXBlLmdldENvbnZleFRyaWFuZ2xlUGlsbGFyKGksIGosIGZhbHNlKTsKICAgICAgICAgIFRyYW5zZm9ybS5wb2ludFRvV29ybGRGcmFtZShoZlBvcywgaGZRdWF0LCBoZlNoYXBlLnBpbGxhck9mZnNldCwgd29ybGRQaWxsYXJPZmZzZXQpOwoKICAgICAgICAgIGlmIChzcGhlcmVQb3MuZGlzdGFuY2VUbyh3b3JsZFBpbGxhck9mZnNldCkgPCBoZlNoYXBlLnBpbGxhckNvbnZleC5ib3VuZGluZ1NwaGVyZVJhZGl1cyArIHNwaGVyZVNoYXBlLmJvdW5kaW5nU3BoZXJlUmFkaXVzKSB7CiAgICAgICAgICAgIGludGVyc2VjdGluZyA9IHRoaXMuc3BoZXJlQ29udmV4KHNwaGVyZVNoYXBlLCBoZlNoYXBlLnBpbGxhckNvbnZleCwgc3BoZXJlUG9zLCB3b3JsZFBpbGxhck9mZnNldCwgc3BoZXJlUXVhdCwgaGZRdWF0LCBzcGhlcmVCb2R5LCBoZkJvZHksIHNwaGVyZVNoYXBlLCBoZlNoYXBlLCBqdXN0VGVzdCk7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGp1c3RUZXN0ICYmIGludGVyc2VjdGluZykgewogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgIH0gLy8gVXBwZXIgdHJpYW5nbGUKCgogICAgICAgICAgaGZTaGFwZS5nZXRDb252ZXhUcmlhbmdsZVBpbGxhcihpLCBqLCB0cnVlKTsKICAgICAgICAgIFRyYW5zZm9ybS5wb2ludFRvV29ybGRGcmFtZShoZlBvcywgaGZRdWF0LCBoZlNoYXBlLnBpbGxhck9mZnNldCwgd29ybGRQaWxsYXJPZmZzZXQpOwoKICAgICAgICAgIGlmIChzcGhlcmVQb3MuZGlzdGFuY2VUbyh3b3JsZFBpbGxhck9mZnNldCkgPCBoZlNoYXBlLnBpbGxhckNvbnZleC5ib3VuZGluZ1NwaGVyZVJhZGl1cyArIHNwaGVyZVNoYXBlLmJvdW5kaW5nU3BoZXJlUmFkaXVzKSB7CiAgICAgICAgICAgIGludGVyc2VjdGluZyA9IHRoaXMuc3BoZXJlQ29udmV4KHNwaGVyZVNoYXBlLCBoZlNoYXBlLnBpbGxhckNvbnZleCwgc3BoZXJlUG9zLCB3b3JsZFBpbGxhck9mZnNldCwgc3BoZXJlUXVhdCwgaGZRdWF0LCBzcGhlcmVCb2R5LCBoZkJvZHksIHNwaGVyZVNoYXBlLCBoZlNoYXBlLCBqdXN0VGVzdCk7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGp1c3RUZXN0ICYmIGludGVyc2VjdGluZykgewogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgIH0KCiAgICAgICAgICBjb25zdCBudW1Db250YWN0cyA9IHJlc3VsdC5sZW5ndGggLSBudW1Db250YWN0c0JlZm9yZTsKCiAgICAgICAgICBpZiAobnVtQ29udGFjdHMgPiAyKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KICAgICAgICAgIC8qCiAgICAgICAgICAgIC8vIFNraXAgYWxsIGJ1dCAxCiAgICAgICAgICAgIGZvciAobGV0IGsgPSAwOyBrIDwgbnVtQ29udGFjdHMgLSAxOyBrKyspIHsKICAgICAgICAgICAgICAgIHJlc3VsdC5wb3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgKi8KCiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgYm94SGVpZ2h0ZmllbGQoc2ksIHNqLCB4aSwgeGosIHFpLCBxaiwgYmksIGJqLCByc2ksIHJzaiwganVzdFRlc3QpIHsKICAgICAgc2kuY29udmV4UG9seWhlZHJvblJlcHJlc2VudGF0aW9uLm1hdGVyaWFsID0gc2kubWF0ZXJpYWw7CiAgICAgIHNpLmNvbnZleFBvbHloZWRyb25SZXByZXNlbnRhdGlvbi5jb2xsaXNpb25SZXNwb25zZSA9IHNpLmNvbGxpc2lvblJlc3BvbnNlOwogICAgICByZXR1cm4gdGhpcy5jb252ZXhIZWlnaHRmaWVsZChzaS5jb252ZXhQb2x5aGVkcm9uUmVwcmVzZW50YXRpb24sIHNqLCB4aSwgeGosIHFpLCBxaiwgYmksIGJqLCBzaSwgc2osIGp1c3RUZXN0KTsKICAgIH0KCiAgICBjb252ZXhIZWlnaHRmaWVsZChjb252ZXhTaGFwZSwgaGZTaGFwZSwgY29udmV4UG9zLCBoZlBvcywgY29udmV4UXVhdCwgaGZRdWF0LCBjb252ZXhCb2R5LCBoZkJvZHksIHJzaSwgcnNqLCBqdXN0VGVzdCkgewogICAgICBjb25zdCBkYXRhID0gaGZTaGFwZS5kYXRhOwogICAgICBjb25zdCB3ID0gaGZTaGFwZS5lbGVtZW50U2l6ZTsKICAgICAgY29uc3QgcmFkaXVzID0gY29udmV4U2hhcGUuYm91bmRpbmdTcGhlcmVSYWRpdXM7CiAgICAgIGNvbnN0IHdvcmxkUGlsbGFyT2Zmc2V0ID0gY29udmV4SGVpZ2h0ZmllbGRfdG1wMjsKICAgICAgY29uc3QgZmFjZUxpc3QgPSBjb252ZXhIZWlnaHRmaWVsZF9mYWNlTGlzdDsgLy8gR2V0IHNwaGVyZSBwb3NpdGlvbiB0byBoZWlnaHRmaWVsZCBsb2NhbCEKCiAgICAgIGNvbnN0IGxvY2FsQ29udmV4UG9zID0gY29udmV4SGVpZ2h0ZmllbGRfdG1wMTsKICAgICAgVHJhbnNmb3JtLnBvaW50VG9Mb2NhbEZyYW1lKGhmUG9zLCBoZlF1YXQsIGNvbnZleFBvcywgbG9jYWxDb252ZXhQb3MpOyAvLyBHZXQgdGhlIGluZGV4IG9mIHRoZSBkYXRhIHBvaW50cyB0byB0ZXN0IGFnYWluc3QKCiAgICAgIGxldCBpTWluWCA9IE1hdGguZmxvb3IoKGxvY2FsQ29udmV4UG9zLnggLSByYWRpdXMpIC8gdykgLSAxOwogICAgICBsZXQgaU1heFggPSBNYXRoLmNlaWwoKGxvY2FsQ29udmV4UG9zLnggKyByYWRpdXMpIC8gdykgKyAxOwogICAgICBsZXQgaU1pblkgPSBNYXRoLmZsb29yKChsb2NhbENvbnZleFBvcy55IC0gcmFkaXVzKSAvIHcpIC0gMTsKICAgICAgbGV0IGlNYXhZID0gTWF0aC5jZWlsKChsb2NhbENvbnZleFBvcy55ICsgcmFkaXVzKSAvIHcpICsgMTsgLy8gQmFpbCBvdXQgaWYgd2UgYXJlIG91dCBvZiB0aGUgdGVycmFpbgoKICAgICAgaWYgKGlNYXhYIDwgMCB8fCBpTWF4WSA8IDAgfHwgaU1pblggPiBkYXRhLmxlbmd0aCB8fCBpTWluWSA+IGRhdGFbMF0ubGVuZ3RoKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9IC8vIENsYW1wIGluZGV4IHRvIGVkZ2VzCgoKICAgICAgaWYgKGlNaW5YIDwgMCkgewogICAgICAgIGlNaW5YID0gMDsKICAgICAgfQoKICAgICAgaWYgKGlNYXhYIDwgMCkgewogICAgICAgIGlNYXhYID0gMDsKICAgICAgfQoKICAgICAgaWYgKGlNaW5ZIDwgMCkgewogICAgICAgIGlNaW5ZID0gMDsKICAgICAgfQoKICAgICAgaWYgKGlNYXhZIDwgMCkgewogICAgICAgIGlNYXhZID0gMDsKICAgICAgfQoKICAgICAgaWYgKGlNaW5YID49IGRhdGEubGVuZ3RoKSB7CiAgICAgICAgaU1pblggPSBkYXRhLmxlbmd0aCAtIDE7CiAgICAgIH0KCiAgICAgIGlmIChpTWF4WCA+PSBkYXRhLmxlbmd0aCkgewogICAgICAgIGlNYXhYID0gZGF0YS5sZW5ndGggLSAxOwogICAgICB9CgogICAgICBpZiAoaU1heFkgPj0gZGF0YVswXS5sZW5ndGgpIHsKICAgICAgICBpTWF4WSA9IGRhdGFbMF0ubGVuZ3RoIC0gMTsKICAgICAgfQoKICAgICAgaWYgKGlNaW5ZID49IGRhdGFbMF0ubGVuZ3RoKSB7CiAgICAgICAgaU1pblkgPSBkYXRhWzBdLmxlbmd0aCAtIDE7CiAgICAgIH0KCiAgICAgIGNvbnN0IG1pbk1heCA9IFtdOwogICAgICBoZlNoYXBlLmdldFJlY3RNaW5NYXgoaU1pblgsIGlNaW5ZLCBpTWF4WCwgaU1heFksIG1pbk1heCk7CiAgICAgIGNvbnN0IG1pbiA9IG1pbk1heFswXTsKICAgICAgY29uc3QgbWF4ID0gbWluTWF4WzFdOyAvLyBCYWlsIG91dCBpZiB3ZSdyZSBjYW50IHRvdWNoIHRoZSBib3VuZGluZyBoZWlnaHQgYm94CgogICAgICBpZiAobG9jYWxDb252ZXhQb3MueiAtIHJhZGl1cyA+IG1heCB8fCBsb2NhbENvbnZleFBvcy56ICsgcmFkaXVzIDwgbWluKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBmb3IgKGxldCBpID0gaU1pblg7IGkgPCBpTWF4WDsgaSsrKSB7CiAgICAgICAgZm9yIChsZXQgaiA9IGlNaW5ZOyBqIDwgaU1heFk7IGorKykgewogICAgICAgICAgbGV0IGludGVyc2VjdGluZyA9IGZhbHNlOyAvLyBMb3dlciB0cmlhbmdsZQoKICAgICAgICAgIGhmU2hhcGUuZ2V0Q29udmV4VHJpYW5nbGVQaWxsYXIoaSwgaiwgZmFsc2UpOwogICAgICAgICAgVHJhbnNmb3JtLnBvaW50VG9Xb3JsZEZyYW1lKGhmUG9zLCBoZlF1YXQsIGhmU2hhcGUucGlsbGFyT2Zmc2V0LCB3b3JsZFBpbGxhck9mZnNldCk7CgogICAgICAgICAgaWYgKGNvbnZleFBvcy5kaXN0YW5jZVRvKHdvcmxkUGlsbGFyT2Zmc2V0KSA8IGhmU2hhcGUucGlsbGFyQ29udmV4LmJvdW5kaW5nU3BoZXJlUmFkaXVzICsgY29udmV4U2hhcGUuYm91bmRpbmdTcGhlcmVSYWRpdXMpIHsKICAgICAgICAgICAgaW50ZXJzZWN0aW5nID0gdGhpcy5jb252ZXhDb252ZXgoY29udmV4U2hhcGUsIGhmU2hhcGUucGlsbGFyQ29udmV4LCBjb252ZXhQb3MsIHdvcmxkUGlsbGFyT2Zmc2V0LCBjb252ZXhRdWF0LCBoZlF1YXQsIGNvbnZleEJvZHksIGhmQm9keSwgbnVsbCwgbnVsbCwganVzdFRlc3QsIGZhY2VMaXN0LCBudWxsKTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoanVzdFRlc3QgJiYgaW50ZXJzZWN0aW5nKSB7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgfSAvLyBVcHBlciB0cmlhbmdsZQoKCiAgICAgICAgICBoZlNoYXBlLmdldENvbnZleFRyaWFuZ2xlUGlsbGFyKGksIGosIHRydWUpOwogICAgICAgICAgVHJhbnNmb3JtLnBvaW50VG9Xb3JsZEZyYW1lKGhmUG9zLCBoZlF1YXQsIGhmU2hhcGUucGlsbGFyT2Zmc2V0LCB3b3JsZFBpbGxhck9mZnNldCk7CgogICAgICAgICAgaWYgKGNvbnZleFBvcy5kaXN0YW5jZVRvKHdvcmxkUGlsbGFyT2Zmc2V0KSA8IGhmU2hhcGUucGlsbGFyQ29udmV4LmJvdW5kaW5nU3BoZXJlUmFkaXVzICsgY29udmV4U2hhcGUuYm91bmRpbmdTcGhlcmVSYWRpdXMpIHsKICAgICAgICAgICAgaW50ZXJzZWN0aW5nID0gdGhpcy5jb252ZXhDb252ZXgoY29udmV4U2hhcGUsIGhmU2hhcGUucGlsbGFyQ29udmV4LCBjb252ZXhQb3MsIHdvcmxkUGlsbGFyT2Zmc2V0LCBjb252ZXhRdWF0LCBoZlF1YXQsIGNvbnZleEJvZHksIGhmQm9keSwgbnVsbCwgbnVsbCwganVzdFRlc3QsIGZhY2VMaXN0LCBudWxsKTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoanVzdFRlc3QgJiYgaW50ZXJzZWN0aW5nKSB7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIHNwaGVyZVBhcnRpY2xlKHNqLCBzaSwgeGosIHhpLCBxaiwgcWksIGJqLCBiaSwgcnNpLCByc2osIGp1c3RUZXN0KSB7CiAgICAgIC8vIFRoZSBub3JtYWwgaXMgdGhlIHVuaXQgdmVjdG9yIGZyb20gc3BoZXJlIGNlbnRlciB0byBwYXJ0aWNsZSBjZW50ZXIKICAgICAgY29uc3Qgbm9ybWFsID0gcGFydGljbGVTcGhlcmVfbm9ybWFsOwogICAgICBub3JtYWwuc2V0KDAsIDAsIDEpOwogICAgICB4aS52c3ViKHhqLCBub3JtYWwpOwogICAgICBjb25zdCBsZW5ndGhTcXVhcmVkID0gbm9ybWFsLmxlbmd0aFNxdWFyZWQoKTsKCiAgICAgIGlmIChsZW5ndGhTcXVhcmVkIDw9IHNqLnJhZGl1cyAqIHNqLnJhZGl1cykgewogICAgICAgIGlmIChqdXN0VGVzdCkgewogICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQoKICAgICAgICBjb25zdCByID0gdGhpcy5jcmVhdGVDb250YWN0RXF1YXRpb24oYmksIGJqLCBzaSwgc2osIHJzaSwgcnNqKTsKICAgICAgICBub3JtYWwubm9ybWFsaXplKCk7CiAgICAgICAgci5yai5jb3B5KG5vcm1hbCk7CiAgICAgICAgci5yai5zY2FsZShzai5yYWRpdXMsIHIucmopOwogICAgICAgIHIubmkuY29weShub3JtYWwpOyAvLyBDb250YWN0IG5vcm1hbAoKICAgICAgICByLm5pLm5lZ2F0ZShyLm5pKTsKICAgICAgICByLnJpLnNldCgwLCAwLCAwKTsgLy8gQ2VudGVyIG9mIHBhcnRpY2xlCgogICAgICAgIHRoaXMucmVzdWx0LnB1c2gocik7CiAgICAgICAgdGhpcy5jcmVhdGVGcmljdGlvbkVxdWF0aW9uc0Zyb21Db250YWN0KHIsIHRoaXMuZnJpY3Rpb25SZXN1bHQpOwogICAgICB9CiAgICB9CgogICAgcGxhbmVQYXJ0aWNsZShzaiwgc2ksIHhqLCB4aSwgcWosIHFpLCBiaiwgYmksIHJzaSwgcnNqLCBqdXN0VGVzdCkgewogICAgICBjb25zdCBub3JtYWwgPSBwYXJ0aWNsZVBsYW5lX25vcm1hbDsKICAgICAgbm9ybWFsLnNldCgwLCAwLCAxKTsKICAgICAgYmoucXVhdGVybmlvbi52bXVsdChub3JtYWwsIG5vcm1hbCk7IC8vIFR1cm4gbm9ybWFsIGFjY29yZGluZyB0byBwbGFuZSBvcmllbnRhdGlvbgoKICAgICAgY29uc3QgcmVscG9zID0gcGFydGljbGVQbGFuZV9yZWxwb3M7CiAgICAgIHhpLnZzdWIoYmoucG9zaXRpb24sIHJlbHBvcyk7CiAgICAgIGNvbnN0IGRvdCA9IG5vcm1hbC5kb3QocmVscG9zKTsKCiAgICAgIGlmIChkb3QgPD0gMC4wKSB7CiAgICAgICAgaWYgKGp1c3RUZXN0KSB7CiAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CgogICAgICAgIGNvbnN0IHIgPSB0aGlzLmNyZWF0ZUNvbnRhY3RFcXVhdGlvbihiaSwgYmosIHNpLCBzaiwgcnNpLCByc2opOwogICAgICAgIHIubmkuY29weShub3JtYWwpOyAvLyBDb250YWN0IG5vcm1hbCBpcyB0aGUgcGxhbmUgbm9ybWFsCgogICAgICAgIHIubmkubmVnYXRlKHIubmkpOwogICAgICAgIHIucmkuc2V0KDAsIDAsIDApOyAvLyBDZW50ZXIgb2YgcGFydGljbGUKICAgICAgICAvLyBHZXQgcGFydGljbGUgcG9zaXRpb24gcHJvamVjdGVkIG9uIHBsYW5lCgogICAgICAgIGNvbnN0IHByb2plY3RlZCA9IHBhcnRpY2xlUGxhbmVfcHJvamVjdGVkOwogICAgICAgIG5vcm1hbC5zY2FsZShub3JtYWwuZG90KHhpKSwgcHJvamVjdGVkKTsKICAgICAgICB4aS52c3ViKHByb2plY3RlZCwgcHJvamVjdGVkKTsgLy9wcm9qZWN0ZWQudmFkZChiai5wb3NpdGlvbixwcm9qZWN0ZWQpOwogICAgICAgIC8vIHJqIGlzIG5vdyB0aGUgcHJvamVjdGVkIHdvcmxkIHBvc2l0aW9uIG1pbnVzIHBsYW5lIHBvc2l0aW9uCgogICAgICAgIHIucmouY29weShwcm9qZWN0ZWQpOwogICAgICAgIHRoaXMucmVzdWx0LnB1c2gocik7CiAgICAgICAgdGhpcy5jcmVhdGVGcmljdGlvbkVxdWF0aW9uc0Zyb21Db250YWN0KHIsIHRoaXMuZnJpY3Rpb25SZXN1bHQpOwogICAgICB9CiAgICB9CgogICAgYm94UGFydGljbGUoc2ksIHNqLCB4aSwgeGosIHFpLCBxaiwgYmksIGJqLCByc2ksIHJzaiwganVzdFRlc3QpIHsKICAgICAgc2kuY29udmV4UG9seWhlZHJvblJlcHJlc2VudGF0aW9uLm1hdGVyaWFsID0gc2kubWF0ZXJpYWw7CiAgICAgIHNpLmNvbnZleFBvbHloZWRyb25SZXByZXNlbnRhdGlvbi5jb2xsaXNpb25SZXNwb25zZSA9IHNpLmNvbGxpc2lvblJlc3BvbnNlOwogICAgICByZXR1cm4gdGhpcy5jb252ZXhQYXJ0aWNsZShzaS5jb252ZXhQb2x5aGVkcm9uUmVwcmVzZW50YXRpb24sIHNqLCB4aSwgeGosIHFpLCBxaiwgYmksIGJqLCBzaSwgc2osIGp1c3RUZXN0KTsKICAgIH0KCiAgICBjb252ZXhQYXJ0aWNsZShzaiwgc2ksIHhqLCB4aSwgcWosIHFpLCBiaiwgYmksIHJzaSwgcnNqLCBqdXN0VGVzdCkgewogICAgICBsZXQgcGVuZXRyYXRlZEZhY2VJbmRleCA9IC0xOwogICAgICBjb25zdCBwZW5ldHJhdGVkRmFjZU5vcm1hbCA9IGNvbnZleFBhcnRpY2xlX3BlbmV0cmF0ZWRGYWNlTm9ybWFsOwogICAgICBjb25zdCB3b3JsZFBlbmV0cmF0aW9uVmVjID0gY29udmV4UGFydGljbGVfd29ybGRQZW5ldHJhdGlvblZlYzsKICAgICAgbGV0IG1pblBlbmV0cmF0aW9uID0gbnVsbDsKCiAgICAgIGNvbnN0IGxvY2FsID0gY29udmV4UGFydGljbGVfbG9jYWw7CiAgICAgIGxvY2FsLmNvcHkoeGkpOwogICAgICBsb2NhbC52c3ViKHhqLCBsb2NhbCk7IC8vIENvbnZlcnQgcG9zaXRpb24gdG8gcmVsYXRpdmUgdGhlIGNvbnZleCBvcmlnaW4KCiAgICAgIHFqLmNvbmp1Z2F0ZShjcWopOwogICAgICBjcWoudm11bHQobG9jYWwsIGxvY2FsKTsKCiAgICAgIGlmIChzai5wb2ludElzSW5zaWRlKGxvY2FsKSkgewogICAgICAgIGlmIChzai53b3JsZFZlcnRpY2VzTmVlZHNVcGRhdGUpIHsKICAgICAgICAgIHNqLmNvbXB1dGVXb3JsZFZlcnRpY2VzKHhqLCBxaik7CiAgICAgICAgfQoKICAgICAgICBpZiAoc2oud29ybGRGYWNlTm9ybWFsc05lZWRzVXBkYXRlKSB7CiAgICAgICAgICBzai5jb21wdXRlV29ybGRGYWNlTm9ybWFscyhxaik7CiAgICAgICAgfSAvLyBGb3IgZWFjaCB3b3JsZCBwb2x5Z29uIGluIHRoZSBwb2x5aGVkcmEKCgogICAgICAgIGZvciAobGV0IGkgPSAwLCBuZmFjZXMgPSBzai5mYWNlcy5sZW5ndGg7IGkgIT09IG5mYWNlczsgaSsrKSB7CiAgICAgICAgICAvLyBDb25zdHJ1Y3Qgd29ybGQgZmFjZSB2ZXJ0aWNlcwogICAgICAgICAgY29uc3QgdmVydHMgPSBbc2oud29ybGRWZXJ0aWNlc1tzai5mYWNlc1tpXVswXV1dOwogICAgICAgICAgY29uc3Qgbm9ybWFsID0gc2oud29ybGRGYWNlTm9ybWFsc1tpXTsgLy8gQ2hlY2sgaG93IG11Y2ggdGhlIHBhcnRpY2xlIHBlbmV0cmF0ZXMgdGhlIHBvbHlnb24gcGxhbmUuCgogICAgICAgICAgeGkudnN1Yih2ZXJ0c1swXSwgY29udmV4UGFydGljbGVfdmVydGV4VG9QYXJ0aWNsZSk7CiAgICAgICAgICBjb25zdCBwZW5ldHJhdGlvbiA9IC1ub3JtYWwuZG90KGNvbnZleFBhcnRpY2xlX3ZlcnRleFRvUGFydGljbGUpOwoKICAgICAgICAgIGlmIChtaW5QZW5ldHJhdGlvbiA9PT0gbnVsbCB8fCBNYXRoLmFicyhwZW5ldHJhdGlvbikgPCBNYXRoLmFicyhtaW5QZW5ldHJhdGlvbikpIHsKICAgICAgICAgICAgaWYgKGp1c3RUZXN0KSB7CiAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIG1pblBlbmV0cmF0aW9uID0gcGVuZXRyYXRpb247CiAgICAgICAgICAgIHBlbmV0cmF0ZWRGYWNlSW5kZXggPSBpOwogICAgICAgICAgICBwZW5ldHJhdGVkRmFjZU5vcm1hbC5jb3B5KG5vcm1hbCk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAocGVuZXRyYXRlZEZhY2VJbmRleCAhPT0gLTEpIHsKICAgICAgICAgIC8vIFNldHVwIGNvbnRhY3QKICAgICAgICAgIGNvbnN0IHIgPSB0aGlzLmNyZWF0ZUNvbnRhY3RFcXVhdGlvbihiaSwgYmosIHNpLCBzaiwgcnNpLCByc2opOwogICAgICAgICAgcGVuZXRyYXRlZEZhY2VOb3JtYWwuc2NhbGUobWluUGVuZXRyYXRpb24sIHdvcmxkUGVuZXRyYXRpb25WZWMpOyAvLyByaiBpcyB0aGUgcGFydGljbGUgcG9zaXRpb24gcHJvamVjdGVkIHRvIHRoZSBmYWNlCgogICAgICAgICAgd29ybGRQZW5ldHJhdGlvblZlYy52YWRkKHhpLCB3b3JsZFBlbmV0cmF0aW9uVmVjKTsKICAgICAgICAgIHdvcmxkUGVuZXRyYXRpb25WZWMudnN1Yih4aiwgd29ybGRQZW5ldHJhdGlvblZlYyk7CiAgICAgICAgICByLnJqLmNvcHkod29ybGRQZW5ldHJhdGlvblZlYyk7IC8vY29uc3QgcHJvamVjdGVkVG9GYWNlID0geGkudnN1Yih4aikudmFkZCh3b3JsZFBlbmV0cmF0aW9uVmVjKTsKICAgICAgICAgIC8vcHJvamVjdGVkVG9GYWNlLmNvcHkoci5yaik7CiAgICAgICAgICAvL3FqLnZtdWx0KHIucmosci5yaik7CgogICAgICAgICAgcGVuZXRyYXRlZEZhY2VOb3JtYWwubmVnYXRlKHIubmkpOyAvLyBDb250YWN0IG5vcm1hbAoKICAgICAgICAgIHIucmkuc2V0KDAsIDAsIDApOyAvLyBDZW50ZXIgb2YgcGFydGljbGUKCiAgICAgICAgICBjb25zdCByaSA9IHIucmk7CiAgICAgICAgICBjb25zdCByaiA9IHIucmo7IC8vIE1ha2UgcmVsYXRpdmUgdG8gYm9kaWVzCgogICAgICAgICAgcmkudmFkZCh4aSwgcmkpOwogICAgICAgICAgcmkudnN1YihiaS5wb3NpdGlvbiwgcmkpOwogICAgICAgICAgcmoudmFkZCh4aiwgcmopOwogICAgICAgICAgcmoudnN1Yihiai5wb3NpdGlvbiwgcmopOwogICAgICAgICAgdGhpcy5yZXN1bHQucHVzaChyKTsKICAgICAgICAgIHRoaXMuY3JlYXRlRnJpY3Rpb25FcXVhdGlvbnNGcm9tQ29udGFjdChyLCB0aGlzLmZyaWN0aW9uUmVzdWx0KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29uc29sZS53YXJuKCdQb2ludCBmb3VuZCBpbnNpZGUgY29udmV4LCBidXQgZGlkIG5vdCBmaW5kIHBlbmV0cmF0aW5nIGZhY2UhJyk7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgaGVpZ2h0ZmllbGRDeWxpbmRlcihoZlNoYXBlLCBjb252ZXhTaGFwZSwgaGZQb3MsIGNvbnZleFBvcywgaGZRdWF0LCBjb252ZXhRdWF0LCBoZkJvZHksIGNvbnZleEJvZHksIHJzaSwgcnNqLCBqdXN0VGVzdCkgewogICAgICByZXR1cm4gdGhpcy5jb252ZXhIZWlnaHRmaWVsZChjb252ZXhTaGFwZSwgaGZTaGFwZSwgY29udmV4UG9zLCBoZlBvcywgY29udmV4UXVhdCwgaGZRdWF0LCBjb252ZXhCb2R5LCBoZkJvZHksIHJzaSwgcnNqLCBqdXN0VGVzdCk7CiAgICB9CgogICAgcGFydGljbGVDeWxpbmRlcihzaSwgc2osIHhpLCB4aiwgcWksIHFqLCBiaSwgYmosIHJzaSwgcnNqLCBqdXN0VGVzdCkgewogICAgICByZXR1cm4gdGhpcy5jb252ZXhQYXJ0aWNsZShzaiwgc2ksIHhqLCB4aSwgcWosIHFpLCBiaiwgYmksIHJzaSwgcnNqLCBqdXN0VGVzdCk7CiAgICB9CgogICAgc3BoZXJlVHJpbWVzaChzcGhlcmVTaGFwZSwgdHJpbWVzaFNoYXBlLCBzcGhlcmVQb3MsIHRyaW1lc2hQb3MsIHNwaGVyZVF1YXQsIHRyaW1lc2hRdWF0LCBzcGhlcmVCb2R5LCB0cmltZXNoQm9keSwgcnNpLCByc2osIGp1c3RUZXN0KSB7CiAgICAgIGNvbnN0IGVkZ2VWZXJ0ZXhBID0gc3BoZXJlVHJpbWVzaF9lZGdlVmVydGV4QTsKICAgICAgY29uc3QgZWRnZVZlcnRleEIgPSBzcGhlcmVUcmltZXNoX2VkZ2VWZXJ0ZXhCOwogICAgICBjb25zdCBlZGdlVmVjdG9yID0gc3BoZXJlVHJpbWVzaF9lZGdlVmVjdG9yOwogICAgICBjb25zdCBlZGdlVmVjdG9yVW5pdCA9IHNwaGVyZVRyaW1lc2hfZWRnZVZlY3RvclVuaXQ7CiAgICAgIGNvbnN0IGxvY2FsU3BoZXJlUG9zID0gc3BoZXJlVHJpbWVzaF9sb2NhbFNwaGVyZVBvczsKICAgICAgY29uc3QgdG1wID0gc3BoZXJlVHJpbWVzaF90bXA7CiAgICAgIGNvbnN0IGxvY2FsU3BoZXJlQUFCQiA9IHNwaGVyZVRyaW1lc2hfbG9jYWxTcGhlcmVBQUJCOwogICAgICBjb25zdCB2MiA9IHNwaGVyZVRyaW1lc2hfdjI7CiAgICAgIGNvbnN0IHJlbHBvcyA9IHNwaGVyZVRyaW1lc2hfcmVscG9zOwogICAgICBjb25zdCB0cmlhbmdsZXMgPSBzcGhlcmVUcmltZXNoX3RyaWFuZ2xlczsgLy8gQ29udmVydCBzcGhlcmUgcG9zaXRpb24gdG8gbG9jYWwgaW4gdGhlIHRyaW1lc2gKCiAgICAgIFRyYW5zZm9ybS5wb2ludFRvTG9jYWxGcmFtZSh0cmltZXNoUG9zLCB0cmltZXNoUXVhdCwgc3BoZXJlUG9zLCBsb2NhbFNwaGVyZVBvcyk7IC8vIEdldCB0aGUgYWFiYiBvZiB0aGUgc3BoZXJlIGxvY2FsbHkgaW4gdGhlIHRyaW1lc2gKCiAgICAgIGNvbnN0IHNwaGVyZVJhZGl1cyA9IHNwaGVyZVNoYXBlLnJhZGl1czsKICAgICAgbG9jYWxTcGhlcmVBQUJCLmxvd2VyQm91bmQuc2V0KGxvY2FsU3BoZXJlUG9zLnggLSBzcGhlcmVSYWRpdXMsIGxvY2FsU3BoZXJlUG9zLnkgLSBzcGhlcmVSYWRpdXMsIGxvY2FsU3BoZXJlUG9zLnogLSBzcGhlcmVSYWRpdXMpOwogICAgICBsb2NhbFNwaGVyZUFBQkIudXBwZXJCb3VuZC5zZXQobG9jYWxTcGhlcmVQb3MueCArIHNwaGVyZVJhZGl1cywgbG9jYWxTcGhlcmVQb3MueSArIHNwaGVyZVJhZGl1cywgbG9jYWxTcGhlcmVQb3MueiArIHNwaGVyZVJhZGl1cyk7CiAgICAgIHRyaW1lc2hTaGFwZS5nZXRUcmlhbmdsZXNJbkFBQkIobG9jYWxTcGhlcmVBQUJCLCB0cmlhbmdsZXMpOyAvL2ZvciAobGV0IGkgPSAwOyBpIDwgdHJpbWVzaFNoYXBlLmluZGljZXMubGVuZ3RoIC8gMzsgaSsrKSB0cmlhbmdsZXMucHVzaChpKTsgLy8gQWxsCiAgICAgIC8vIFZlcnRpY2VzCgogICAgICBjb25zdCB2ID0gc3BoZXJlVHJpbWVzaF92OwogICAgICBjb25zdCByYWRpdXNTcXVhcmVkID0gc3BoZXJlU2hhcGUucmFkaXVzICogc3BoZXJlU2hhcGUucmFkaXVzOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0cmlhbmdsZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IDM7IGorKykgewogICAgICAgICAgdHJpbWVzaFNoYXBlLmdldFZlcnRleCh0cmltZXNoU2hhcGUuaW5kaWNlc1t0cmlhbmdsZXNbaV0gKiAzICsgal0sIHYpOyAvLyBDaGVjayB2ZXJ0ZXggb3ZlcmxhcCBpbiBzcGhlcmUKCiAgICAgICAgICB2LnZzdWIobG9jYWxTcGhlcmVQb3MsIHJlbHBvcyk7CgogICAgICAgICAgaWYgKHJlbHBvcy5sZW5ndGhTcXVhcmVkKCkgPD0gcmFkaXVzU3F1YXJlZCkgewogICAgICAgICAgICAvLyBTYWZlIHVwCiAgICAgICAgICAgIHYyLmNvcHkodik7CiAgICAgICAgICAgIFRyYW5zZm9ybS5wb2ludFRvV29ybGRGcmFtZSh0cmltZXNoUG9zLCB0cmltZXNoUXVhdCwgdjIsIHYpOwogICAgICAgICAgICB2LnZzdWIoc3BoZXJlUG9zLCByZWxwb3MpOwoKICAgICAgICAgICAgaWYgKGp1c3RUZXN0KSB7CiAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGxldCByID0gdGhpcy5jcmVhdGVDb250YWN0RXF1YXRpb24oc3BoZXJlQm9keSwgdHJpbWVzaEJvZHksIHNwaGVyZVNoYXBlLCB0cmltZXNoU2hhcGUsIHJzaSwgcnNqKTsKICAgICAgICAgICAgci5uaS5jb3B5KHJlbHBvcyk7CiAgICAgICAgICAgIHIubmkubm9ybWFsaXplKCk7IC8vIHJpIGlzIHRoZSB2ZWN0b3IgZnJvbSBzcGhlcmUgY2VudGVyIHRvIHRoZSBzcGhlcmUgc3VyZmFjZQoKICAgICAgICAgICAgci5yaS5jb3B5KHIubmkpOwogICAgICAgICAgICByLnJpLnNjYWxlKHNwaGVyZVNoYXBlLnJhZGl1cywgci5yaSk7CiAgICAgICAgICAgIHIucmkudmFkZChzcGhlcmVQb3MsIHIucmkpOwogICAgICAgICAgICByLnJpLnZzdWIoc3BoZXJlQm9keS5wb3NpdGlvbiwgci5yaSk7CiAgICAgICAgICAgIHIucmouY29weSh2KTsKICAgICAgICAgICAgci5yai52c3ViKHRyaW1lc2hCb2R5LnBvc2l0aW9uLCByLnJqKTsgLy8gU3RvcmUgcmVzdWx0CgogICAgICAgICAgICB0aGlzLnJlc3VsdC5wdXNoKHIpOwogICAgICAgICAgICB0aGlzLmNyZWF0ZUZyaWN0aW9uRXF1YXRpb25zRnJvbUNvbnRhY3QociwgdGhpcy5mcmljdGlvblJlc3VsdCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IC8vIENoZWNrIGFsbCBlZGdlcwoKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdHJpYW5nbGVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCAzOyBqKyspIHsKICAgICAgICAgIHRyaW1lc2hTaGFwZS5nZXRWZXJ0ZXgodHJpbWVzaFNoYXBlLmluZGljZXNbdHJpYW5nbGVzW2ldICogMyArIGpdLCBlZGdlVmVydGV4QSk7CiAgICAgICAgICB0cmltZXNoU2hhcGUuZ2V0VmVydGV4KHRyaW1lc2hTaGFwZS5pbmRpY2VzW3RyaWFuZ2xlc1tpXSAqIDMgKyAoaiArIDEpICUgM10sIGVkZ2VWZXJ0ZXhCKTsKICAgICAgICAgIGVkZ2VWZXJ0ZXhCLnZzdWIoZWRnZVZlcnRleEEsIGVkZ2VWZWN0b3IpOyAvLyBQcm9qZWN0IHNwaGVyZSBwb3NpdGlvbiB0byB0aGUgZWRnZQoKICAgICAgICAgIGxvY2FsU3BoZXJlUG9zLnZzdWIoZWRnZVZlcnRleEIsIHRtcCk7CiAgICAgICAgICBjb25zdCBwb3NpdGlvbkFsb25nRWRnZUIgPSB0bXAuZG90KGVkZ2VWZWN0b3IpOwogICAgICAgICAgbG9jYWxTcGhlcmVQb3MudnN1YihlZGdlVmVydGV4QSwgdG1wKTsKICAgICAgICAgIGxldCBwb3NpdGlvbkFsb25nRWRnZUEgPSB0bXAuZG90KGVkZ2VWZWN0b3IpOwoKICAgICAgICAgIGlmIChwb3NpdGlvbkFsb25nRWRnZUEgPiAwICYmIHBvc2l0aW9uQWxvbmdFZGdlQiA8IDApIHsKICAgICAgICAgICAgLy8gTm93IGNoZWNrIHRoZSBvcnRob2dvbmFsIGRpc3RhbmNlIGZyb20gZWRnZSB0byBzcGhlcmUgY2VudGVyCiAgICAgICAgICAgIGxvY2FsU3BoZXJlUG9zLnZzdWIoZWRnZVZlcnRleEEsIHRtcCk7CiAgICAgICAgICAgIGVkZ2VWZWN0b3JVbml0LmNvcHkoZWRnZVZlY3Rvcik7CiAgICAgICAgICAgIGVkZ2VWZWN0b3JVbml0Lm5vcm1hbGl6ZSgpOwogICAgICAgICAgICBwb3NpdGlvbkFsb25nRWRnZUEgPSB0bXAuZG90KGVkZ2VWZWN0b3JVbml0KTsKICAgICAgICAgICAgZWRnZVZlY3RvclVuaXQuc2NhbGUocG9zaXRpb25BbG9uZ0VkZ2VBLCB0bXApOwogICAgICAgICAgICB0bXAudmFkZChlZGdlVmVydGV4QSwgdG1wKTsgLy8gdG1wIGlzIG5vdyB0aGUgc3BoZXJlIGNlbnRlciBwb3NpdGlvbiBwcm9qZWN0ZWQgdG8gdGhlIGVkZ2UsIGRlZmluZWQgbG9jYWxseSBpbiB0aGUgdHJpbWVzaCBmcmFtZQoKICAgICAgICAgICAgY29uc3QgZGlzdCA9IHRtcC5kaXN0YW5jZVRvKGxvY2FsU3BoZXJlUG9zKTsKCiAgICAgICAgICAgIGlmIChkaXN0IDwgc3BoZXJlU2hhcGUucmFkaXVzKSB7CiAgICAgICAgICAgICAgaWYgKGp1c3RUZXN0KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGNvbnN0IHIgPSB0aGlzLmNyZWF0ZUNvbnRhY3RFcXVhdGlvbihzcGhlcmVCb2R5LCB0cmltZXNoQm9keSwgc3BoZXJlU2hhcGUsIHRyaW1lc2hTaGFwZSwgcnNpLCByc2opOwogICAgICAgICAgICAgIHRtcC52c3ViKGxvY2FsU3BoZXJlUG9zLCByLm5pKTsKICAgICAgICAgICAgICByLm5pLm5vcm1hbGl6ZSgpOwogICAgICAgICAgICAgIHIubmkuc2NhbGUoc3BoZXJlU2hhcGUucmFkaXVzLCByLnJpKTsKICAgICAgICAgICAgICByLnJpLnZhZGQoc3BoZXJlUG9zLCByLnJpKTsKICAgICAgICAgICAgICByLnJpLnZzdWIoc3BoZXJlQm9keS5wb3NpdGlvbiwgci5yaSk7CiAgICAgICAgICAgICAgVHJhbnNmb3JtLnBvaW50VG9Xb3JsZEZyYW1lKHRyaW1lc2hQb3MsIHRyaW1lc2hRdWF0LCB0bXAsIHRtcCk7CiAgICAgICAgICAgICAgdG1wLnZzdWIodHJpbWVzaEJvZHkucG9zaXRpb24sIHIucmopOwogICAgICAgICAgICAgIFRyYW5zZm9ybS52ZWN0b3JUb1dvcmxkRnJhbWUodHJpbWVzaFF1YXQsIHIubmksIHIubmkpOwogICAgICAgICAgICAgIFRyYW5zZm9ybS52ZWN0b3JUb1dvcmxkRnJhbWUodHJpbWVzaFF1YXQsIHIucmksIHIucmkpOwogICAgICAgICAgICAgIHRoaXMucmVzdWx0LnB1c2gocik7CiAgICAgICAgICAgICAgdGhpcy5jcmVhdGVGcmljdGlvbkVxdWF0aW9uc0Zyb21Db250YWN0KHIsIHRoaXMuZnJpY3Rpb25SZXN1bHQpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IC8vIFRyaWFuZ2xlIGZhY2VzCgoKICAgICAgY29uc3QgdmEgPSBzcGhlcmVUcmltZXNoX3ZhOwogICAgICBjb25zdCB2YiA9IHNwaGVyZVRyaW1lc2hfdmI7CiAgICAgIGNvbnN0IHZjID0gc3BoZXJlVHJpbWVzaF92YzsKICAgICAgY29uc3Qgbm9ybWFsID0gc3BoZXJlVHJpbWVzaF9ub3JtYWw7CgogICAgICBmb3IgKGxldCBpID0gMCwgTiA9IHRyaWFuZ2xlcy5sZW5ndGg7IGkgIT09IE47IGkrKykgewogICAgICAgIHRyaW1lc2hTaGFwZS5nZXRUcmlhbmdsZVZlcnRpY2VzKHRyaWFuZ2xlc1tpXSwgdmEsIHZiLCB2Yyk7CiAgICAgICAgdHJpbWVzaFNoYXBlLmdldE5vcm1hbCh0cmlhbmdsZXNbaV0sIG5vcm1hbCk7CiAgICAgICAgbG9jYWxTcGhlcmVQb3MudnN1Yih2YSwgdG1wKTsKICAgICAgICBsZXQgZGlzdCA9IHRtcC5kb3Qobm9ybWFsKTsKICAgICAgICBub3JtYWwuc2NhbGUoZGlzdCwgdG1wKTsKICAgICAgICBsb2NhbFNwaGVyZVBvcy52c3ViKHRtcCwgdG1wKTsgLy8gdG1wIGlzIG5vdyB0aGUgc3BoZXJlIHBvc2l0aW9uIHByb2plY3RlZCB0byB0aGUgdHJpYW5nbGUgcGxhbmUKCiAgICAgICAgZGlzdCA9IHRtcC5kaXN0YW5jZVRvKGxvY2FsU3BoZXJlUG9zKTsKCiAgICAgICAgaWYgKFJheS5wb2ludEluVHJpYW5nbGUodG1wLCB2YSwgdmIsIHZjKSAmJiBkaXN0IDwgc3BoZXJlU2hhcGUucmFkaXVzKSB7CiAgICAgICAgICBpZiAoanVzdFRlc3QpIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICB9CgogICAgICAgICAgbGV0IHIgPSB0aGlzLmNyZWF0ZUNvbnRhY3RFcXVhdGlvbihzcGhlcmVCb2R5LCB0cmltZXNoQm9keSwgc3BoZXJlU2hhcGUsIHRyaW1lc2hTaGFwZSwgcnNpLCByc2opOwogICAgICAgICAgdG1wLnZzdWIobG9jYWxTcGhlcmVQb3MsIHIubmkpOwogICAgICAgICAgci5uaS5ub3JtYWxpemUoKTsKICAgICAgICAgIHIubmkuc2NhbGUoc3BoZXJlU2hhcGUucmFkaXVzLCByLnJpKTsKICAgICAgICAgIHIucmkudmFkZChzcGhlcmVQb3MsIHIucmkpOwogICAgICAgICAgci5yaS52c3ViKHNwaGVyZUJvZHkucG9zaXRpb24sIHIucmkpOwogICAgICAgICAgVHJhbnNmb3JtLnBvaW50VG9Xb3JsZEZyYW1lKHRyaW1lc2hQb3MsIHRyaW1lc2hRdWF0LCB0bXAsIHRtcCk7CiAgICAgICAgICB0bXAudnN1Yih0cmltZXNoQm9keS5wb3NpdGlvbiwgci5yaik7CiAgICAgICAgICBUcmFuc2Zvcm0udmVjdG9yVG9Xb3JsZEZyYW1lKHRyaW1lc2hRdWF0LCByLm5pLCByLm5pKTsKICAgICAgICAgIFRyYW5zZm9ybS52ZWN0b3JUb1dvcmxkRnJhbWUodHJpbWVzaFF1YXQsIHIucmksIHIucmkpOwogICAgICAgICAgdGhpcy5yZXN1bHQucHVzaChyKTsKICAgICAgICAgIHRoaXMuY3JlYXRlRnJpY3Rpb25FcXVhdGlvbnNGcm9tQ29udGFjdChyLCB0aGlzLmZyaWN0aW9uUmVzdWx0KTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHRyaWFuZ2xlcy5sZW5ndGggPSAwOwogICAgfQoKICAgIHBsYW5lVHJpbWVzaChwbGFuZVNoYXBlLCB0cmltZXNoU2hhcGUsIHBsYW5lUG9zLCB0cmltZXNoUG9zLCBwbGFuZVF1YXQsIHRyaW1lc2hRdWF0LCBwbGFuZUJvZHksIHRyaW1lc2hCb2R5LCByc2ksIHJzaiwganVzdFRlc3QpIHsKICAgICAgLy8gTWFrZSBjb250YWN0cyEKICAgICAgY29uc3QgdiA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IG5vcm1hbCA9IHBsYW5lVHJpbWVzaF9ub3JtYWw7CiAgICAgIG5vcm1hbC5zZXQoMCwgMCwgMSk7CiAgICAgIHBsYW5lUXVhdC52bXVsdChub3JtYWwsIG5vcm1hbCk7IC8vIFR1cm4gbm9ybWFsIGFjY29yZGluZyB0byBwbGFuZQoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0cmltZXNoU2hhcGUudmVydGljZXMubGVuZ3RoIC8gMzsgaSsrKSB7CiAgICAgICAgLy8gR2V0IHdvcmxkIHZlcnRleCBmcm9tIHRyaW1lc2gKICAgICAgICB0cmltZXNoU2hhcGUuZ2V0VmVydGV4KGksIHYpOyAvLyBTYWZlIHVwCgogICAgICAgIGNvbnN0IHYyID0gbmV3IFZlYzMoKTsKICAgICAgICB2Mi5jb3B5KHYpOwogICAgICAgIFRyYW5zZm9ybS5wb2ludFRvV29ybGRGcmFtZSh0cmltZXNoUG9zLCB0cmltZXNoUXVhdCwgdjIsIHYpOyAvLyBDaGVjayBwbGFuZSBzaWRlCgogICAgICAgIGNvbnN0IHJlbHBvcyA9IHBsYW5lVHJpbWVzaF9yZWxwb3M7CiAgICAgICAgdi52c3ViKHBsYW5lUG9zLCByZWxwb3MpOwogICAgICAgIGNvbnN0IGRvdCA9IG5vcm1hbC5kb3QocmVscG9zKTsKCiAgICAgICAgaWYgKGRvdCA8PSAwLjApIHsKICAgICAgICAgIGlmIChqdXN0VGVzdCkgewogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgIH0KCiAgICAgICAgICBjb25zdCByID0gdGhpcy5jcmVhdGVDb250YWN0RXF1YXRpb24ocGxhbmVCb2R5LCB0cmltZXNoQm9keSwgcGxhbmVTaGFwZSwgdHJpbWVzaFNoYXBlLCByc2ksIHJzaik7CiAgICAgICAgICByLm5pLmNvcHkobm9ybWFsKTsgLy8gQ29udGFjdCBub3JtYWwgaXMgdGhlIHBsYW5lIG5vcm1hbAogICAgICAgICAgLy8gR2V0IHZlcnRleCBwb3NpdGlvbiBwcm9qZWN0ZWQgb24gcGxhbmUKCiAgICAgICAgICBjb25zdCBwcm9qZWN0ZWQgPSBwbGFuZVRyaW1lc2hfcHJvamVjdGVkOwogICAgICAgICAgbm9ybWFsLnNjYWxlKHJlbHBvcy5kb3Qobm9ybWFsKSwgcHJvamVjdGVkKTsKICAgICAgICAgIHYudnN1Yihwcm9qZWN0ZWQsIHByb2plY3RlZCk7IC8vIHJpIGlzIHRoZSBwcm9qZWN0ZWQgd29ybGQgcG9zaXRpb24gbWludXMgcGxhbmUgcG9zaXRpb24KCiAgICAgICAgICByLnJpLmNvcHkocHJvamVjdGVkKTsKICAgICAgICAgIHIucmkudnN1YihwbGFuZUJvZHkucG9zaXRpb24sIHIucmkpOwogICAgICAgICAgci5yai5jb3B5KHYpOwogICAgICAgICAgci5yai52c3ViKHRyaW1lc2hCb2R5LnBvc2l0aW9uLCByLnJqKTsgLy8gU3RvcmUgcmVzdWx0CgogICAgICAgICAgdGhpcy5yZXN1bHQucHVzaChyKTsKICAgICAgICAgIHRoaXMuY3JlYXRlRnJpY3Rpb25FcXVhdGlvbnNGcm9tQ29udGFjdChyLCB0aGlzLmZyaWN0aW9uUmVzdWx0KTsKICAgICAgICB9CiAgICAgIH0KICAgIH0gLy8gY29udmV4VHJpbWVzaCgKICAgIC8vICAgc2k6IENvbnZleFBvbHloZWRyb24sIHNqOiBUcmltZXNoLCB4aTogVmVjMywgeGo6IFZlYzMsIHFpOiBRdWF0ZXJuaW9uLCBxajogUXVhdGVybmlvbiwKICAgIC8vICAgYmk6IEJvZHksIGJqOiBCb2R5LCByc2k/OiBTaGFwZSB8IG51bGwsIHJzaj86IFNoYXBlIHwgbnVsbCwKICAgIC8vICAgZmFjZUxpc3RBPzogbnVtYmVyW10gfCBudWxsLCBmYWNlTGlzdEI/OiBudW1iZXJbXSB8IG51bGwsCiAgICAvLyApIHsKICAgIC8vICAgY29uc3Qgc2VwQXhpcyA9IGNvbnZleENvbnZleF9zZXBBeGlzOwogICAgLy8gICBpZih4aS5kaXN0YW5jZVRvKHhqKSA+IHNpLmJvdW5kaW5nU3BoZXJlUmFkaXVzICsgc2ouYm91bmRpbmdTcGhlcmVSYWRpdXMpewogICAgLy8gICAgICAgcmV0dXJuOwogICAgLy8gICB9CiAgICAvLyAgIC8vIENvbnN0cnVjdCBhIHRlbXAgaHVsbCBmb3IgZWFjaCB0cmlhbmdsZQogICAgLy8gICBjb25zdCBodWxsQiA9IG5ldyBDb252ZXhQb2x5aGVkcm9uKCk7CiAgICAvLyAgIGh1bGxCLmZhY2VzID0gW1swLDEsMl1dOwogICAgLy8gICBjb25zdCB2YSA9IG5ldyBWZWMzKCk7CiAgICAvLyAgIGNvbnN0IHZiID0gbmV3IFZlYzMoKTsKICAgIC8vICAgY29uc3QgdmMgPSBuZXcgVmVjMygpOwogICAgLy8gICBodWxsQi52ZXJ0aWNlcyA9IFsKICAgIC8vICAgICAgIHZhLAogICAgLy8gICAgICAgdmIsCiAgICAvLyAgICAgICB2YwogICAgLy8gICBdOwogICAgLy8gICBmb3IgKGxldCBpID0gMDsgaSA8IHNqLmluZGljZXMubGVuZ3RoIC8gMzsgaSsrKSB7CiAgICAvLyAgICAgICBjb25zdCB0cmlhbmdsZU5vcm1hbCA9IG5ldyBWZWMzKCk7CiAgICAvLyAgICAgICBzai5nZXROb3JtYWwoaSwgdHJpYW5nbGVOb3JtYWwpOwogICAgLy8gICAgICAgaHVsbEIuZmFjZU5vcm1hbHMgPSBbdHJpYW5nbGVOb3JtYWxdOwogICAgLy8gICAgICAgc2ouZ2V0VHJpYW5nbGVWZXJ0aWNlcyhpLCB2YSwgdmIsIHZjKTsKICAgIC8vICAgICAgIGxldCBkID0gc2kudGVzdFNlcEF4aXModHJpYW5nbGVOb3JtYWwsIGh1bGxCLCB4aSwgcWksIHhqLCBxaik7CiAgICAvLyAgICAgICBpZighZCl7CiAgICAvLyAgICAgICAgICAgdHJpYW5nbGVOb3JtYWwuc2NhbGUoLTEsIHRyaWFuZ2xlTm9ybWFsKTsKICAgIC8vICAgICAgICAgICBkID0gc2kudGVzdFNlcEF4aXModHJpYW5nbGVOb3JtYWwsIGh1bGxCLCB4aSwgcWksIHhqLCBxaik7CiAgICAvLyAgICAgICAgICAgaWYoIWQpewogICAgLy8gICAgICAgICAgICAgICBjb250aW51ZTsKICAgIC8vICAgICAgICAgICB9CiAgICAvLyAgICAgICB9CiAgICAvLyAgICAgICBjb25zdCByZXM6IENvbnZleFBvbHloZWRyb25Db250YWN0UG9pbnRbXSA9IFtdOwogICAgLy8gICAgICAgY29uc3QgcSA9IGNvbnZleENvbnZleF9xOwogICAgLy8gICAgICAgc2kuY2xpcEFnYWluc3RIdWxsKHhpLHFpLGh1bGxCLHhqLHFqLHRyaWFuZ2xlTm9ybWFsLC0xMDAsMTAwLHJlcyk7CiAgICAvLyAgICAgICBmb3IobGV0IGogPSAwOyBqICE9PSByZXMubGVuZ3RoOyBqKyspewogICAgLy8gICAgICAgICAgIGNvbnN0IHIgPSB0aGlzLmNyZWF0ZUNvbnRhY3RFcXVhdGlvbihiaSxiaixzaSxzaixyc2kscnNqKSwKICAgIC8vICAgICAgICAgICAgICAgcmkgPSByLnJpLAogICAgLy8gICAgICAgICAgICAgICByaiA9IHIucmo7CiAgICAvLyAgICAgICAgICAgci5uaS5jb3B5KHRyaWFuZ2xlTm9ybWFsKTsKICAgIC8vICAgICAgICAgICByLm5pLm5lZ2F0ZShyLm5pKTsKICAgIC8vICAgICAgICAgICByZXNbal0ubm9ybWFsLm5lZ2F0ZShxKTsKICAgIC8vICAgICAgICAgICBxLm11bHQocmVzW2pdLmRlcHRoLCBxKTsKICAgIC8vICAgICAgICAgICByZXNbal0ucG9pbnQudmFkZChxLCByaSk7CiAgICAvLyAgICAgICAgICAgcmouY29weShyZXNbal0ucG9pbnQpOwogICAgLy8gICAgICAgICAgIC8vIENvbnRhY3QgcG9pbnRzIGFyZSBpbiB3b3JsZCBjb29yZGluYXRlcy4gVHJhbnNmb3JtIGJhY2sgdG8gcmVsYXRpdmUKICAgIC8vICAgICAgICAgICByaS52c3ViKHhpLHJpKTsKICAgIC8vICAgICAgICAgICByai52c3ViKHhqLHJqKTsKICAgIC8vICAgICAgICAgICAvLyBNYWtlIHJlbGF0aXZlIHRvIGJvZGllcwogICAgLy8gICAgICAgICAgIHJpLnZhZGQoeGksIHJpKTsKICAgIC8vICAgICAgICAgICByaS52c3ViKGJpLnBvc2l0aW9uLCByaSk7CiAgICAvLyAgICAgICAgICAgcmoudmFkZCh4aiwgcmopOwogICAgLy8gICAgICAgICAgIHJqLnZzdWIoYmoucG9zaXRpb24sIHJqKTsKICAgIC8vICAgICAgICAgICByZXN1bHQucHVzaChyKTsKICAgIC8vICAgICAgIH0KICAgIC8vICAgfQogICAgLy8gfQoKCiAgfQogIGNvbnN0IGF2ZXJhZ2VOb3JtYWwgPSBuZXcgVmVjMygpOwogIGNvbnN0IGF2ZXJhZ2VDb250YWN0UG9pbnRBID0gbmV3IFZlYzMoKTsKICBjb25zdCBhdmVyYWdlQ29udGFjdFBvaW50QiA9IG5ldyBWZWMzKCk7CiAgY29uc3QgdG1wVmVjMSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgdG1wVmVjMiA9IG5ldyBWZWMzKCk7CiAgY29uc3QgdG1wUXVhdDEgPSBuZXcgUXVhdGVybmlvbigpOwogIGNvbnN0IHRtcFF1YXQyID0gbmV3IFF1YXRlcm5pb24oKTsKCiAgY29uc3QgcGxhbmVUcmltZXNoX25vcm1hbCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgcGxhbmVUcmltZXNoX3JlbHBvcyA9IG5ldyBWZWMzKCk7CiAgY29uc3QgcGxhbmVUcmltZXNoX3Byb2plY3RlZCA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlVHJpbWVzaF9ub3JtYWwgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZVRyaW1lc2hfcmVscG9zID0gbmV3IFZlYzMoKTsKICBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZVRyaW1lc2hfdiA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlVHJpbWVzaF92MiA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlVHJpbWVzaF9lZGdlVmVydGV4QSA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlVHJpbWVzaF9lZGdlVmVydGV4QiA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlVHJpbWVzaF9lZGdlVmVjdG9yID0gbmV3IFZlYzMoKTsKICBjb25zdCBzcGhlcmVUcmltZXNoX2VkZ2VWZWN0b3JVbml0ID0gbmV3IFZlYzMoKTsKICBjb25zdCBzcGhlcmVUcmltZXNoX2xvY2FsU3BoZXJlUG9zID0gbmV3IFZlYzMoKTsKICBjb25zdCBzcGhlcmVUcmltZXNoX3RtcCA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlVHJpbWVzaF92YSA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlVHJpbWVzaF92YiA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlVHJpbWVzaF92YyA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlVHJpbWVzaF9sb2NhbFNwaGVyZUFBQkIgPSBuZXcgQUFCQigpOwogIGNvbnN0IHNwaGVyZVRyaW1lc2hfdHJpYW5nbGVzID0gW107CiAgY29uc3QgcG9pbnRfb25fcGxhbmVfdG9fc3BoZXJlID0gbmV3IFZlYzMoKTsKICBjb25zdCBwbGFuZV90b19zcGhlcmVfb3J0aG8gPSBuZXcgVmVjMygpOyAvLyBTZWUgaHR0cDovL2J1bGxldHBoeXNpY3MuY29tL0J1bGxldC9CdWxsZXRGdWxsL1NwaGVyZVRyaWFuZ2xlRGV0ZWN0b3JfOGNwcF9zb3VyY2UuaHRtbAoKICBjb25zdCBwb2ludEluUG9seWdvbl9lZGdlID0gbmV3IFZlYzMoKTsKICBjb25zdCBwb2ludEluUG9seWdvbl9lZGdlX3hfbm9ybWFsID0gbmV3IFZlYzMoKTsKICBjb25zdCBwb2ludEluUG9seWdvbl92dHAgPSBuZXcgVmVjMygpOwoKICBmdW5jdGlvbiBwb2ludEluUG9seWdvbih2ZXJ0cywgbm9ybWFsLCBwKSB7CiAgICBsZXQgcG9zaXRpdmVSZXN1bHQgPSBudWxsOwogICAgY29uc3QgTiA9IHZlcnRzLmxlbmd0aDsKCiAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gTjsgaSsrKSB7CiAgICAgIGNvbnN0IHYgPSB2ZXJ0c1tpXTsgLy8gR2V0IGVkZ2UgdG8gdGhlIG5leHQgdmVydGV4CgogICAgICBjb25zdCBlZGdlID0gcG9pbnRJblBvbHlnb25fZWRnZTsKICAgICAgdmVydHNbKGkgKyAxKSAlIE5dLnZzdWIodiwgZWRnZSk7IC8vIEdldCBjcm9zcyBwcm9kdWN0IGJldHdlZW4gcG9seWdvbiBub3JtYWwgYW5kIHRoZSBlZGdlCgogICAgICBjb25zdCBlZGdlX3hfbm9ybWFsID0gcG9pbnRJblBvbHlnb25fZWRnZV94X25vcm1hbDsgLy9jb25zdCBlZGdlX3hfbm9ybWFsID0gbmV3IFZlYzMoKTsKCiAgICAgIGVkZ2UuY3Jvc3Mobm9ybWFsLCBlZGdlX3hfbm9ybWFsKTsgLy8gR2V0IHZlY3RvciBiZXR3ZWVuIHBvaW50IGFuZCBjdXJyZW50IHZlcnRleAoKICAgICAgY29uc3QgdmVydGV4X3RvX3AgPSBwb2ludEluUG9seWdvbl92dHA7CiAgICAgIHAudnN1Yih2LCB2ZXJ0ZXhfdG9fcCk7IC8vIFRoaXMgZG90IHByb2R1Y3QgZGV0ZXJtaW5lcyB3aGljaCBzaWRlIG9mIHRoZSBlZGdlIHRoZSBwb2ludCBpcwoKICAgICAgY29uc3QgciA9IGVkZ2VfeF9ub3JtYWwuZG90KHZlcnRleF90b19wKTsgLy8gSWYgYWxsIHN1Y2ggZG90IHByb2R1Y3RzIGhhdmUgc2FtZSBzaWduLCB3ZSBhcmUgaW5zaWRlIHRoZSBwb2x5Z29uLgoKICAgICAgaWYgKHBvc2l0aXZlUmVzdWx0ID09PSBudWxsIHx8IHIgPiAwICYmIHBvc2l0aXZlUmVzdWx0ID09PSB0cnVlIHx8IHIgPD0gMCAmJiBwb3NpdGl2ZVJlc3VsdCA9PT0gZmFsc2UpIHsKICAgICAgICBpZiAocG9zaXRpdmVSZXN1bHQgPT09IG51bGwpIHsKICAgICAgICAgIHBvc2l0aXZlUmVzdWx0ID0gciA+IDA7CiAgICAgICAgfQoKICAgICAgICBjb250aW51ZTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gZmFsc2U7IC8vIEVuY291bnRlcmVkIHNvbWUgb3RoZXIgc2lnbi4gRXhpdC4KICAgICAgfQogICAgfSAvLyBJZiB3ZSBnb3QgaGVyZSwgYWxsIGRvdCBwcm9kdWN0cyB3ZXJlIG9mIHRoZSBzYW1lIHNpZ24uCgoKICAgIHJldHVybiB0cnVlOwogIH0KCiAgY29uc3QgYm94X3RvX3NwaGVyZSA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlQm94X25zID0gbmV3IFZlYzMoKTsKICBjb25zdCBzcGhlcmVCb3hfbnMxID0gbmV3IFZlYzMoKTsKICBjb25zdCBzcGhlcmVCb3hfbnMyID0gbmV3IFZlYzMoKTsKICBjb25zdCBzcGhlcmVCb3hfc2lkZXMgPSBbbmV3IFZlYzMoKSwgbmV3IFZlYzMoKSwgbmV3IFZlYzMoKSwgbmV3IFZlYzMoKSwgbmV3IFZlYzMoKSwgbmV3IFZlYzMoKV07CiAgY29uc3Qgc3BoZXJlQm94X3NwaGVyZV90b19jb3JuZXIgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZUJveF9zaWRlX25zID0gbmV3IFZlYzMoKTsKICBjb25zdCBzcGhlcmVCb3hfc2lkZV9uczEgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZUJveF9zaWRlX25zMiA9IG5ldyBWZWMzKCk7CiAgY29uc3QgY29udmV4X3RvX3NwaGVyZSA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlQ29udmV4X2VkZ2UgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZUNvbnZleF9lZGdlVW5pdCA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlQ29udmV4X3NwaGVyZVRvQ29ybmVyID0gbmV3IFZlYzMoKTsKICBjb25zdCBzcGhlcmVDb252ZXhfd29ybGRDb3JuZXIgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZUNvbnZleF93b3JsZE5vcm1hbCA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlQ29udmV4X3dvcmxkUG9pbnQgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZUNvbnZleF93b3JsZFNwaGVyZVBvaW50Q2xvc2VzdFRvUGxhbmUgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZUNvbnZleF9wZW5ldHJhdGlvblZlYyA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlQ29udmV4X3NwaGVyZVRvV29ybGRQb2ludCA9IG5ldyBWZWMzKCk7CiAgbmV3IFZlYzMoKTsKICBuZXcgVmVjMygpOwogIGNvbnN0IHBsYW5lQ29udmV4X3YgPSBuZXcgVmVjMygpOwogIGNvbnN0IHBsYW5lQ29udmV4X25vcm1hbCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgcGxhbmVDb252ZXhfcmVscG9zID0gbmV3IFZlYzMoKTsKICBjb25zdCBwbGFuZUNvbnZleF9wcm9qZWN0ZWQgPSBuZXcgVmVjMygpOwogIGNvbnN0IGNvbnZleENvbnZleF9zZXBBeGlzID0gbmV3IFZlYzMoKTsKICBjb25zdCBjb252ZXhDb252ZXhfcSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgcGFydGljbGVQbGFuZV9ub3JtYWwgPSBuZXcgVmVjMygpOwogIGNvbnN0IHBhcnRpY2xlUGxhbmVfcmVscG9zID0gbmV3IFZlYzMoKTsKICBjb25zdCBwYXJ0aWNsZVBsYW5lX3Byb2plY3RlZCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgcGFydGljbGVTcGhlcmVfbm9ybWFsID0gbmV3IFZlYzMoKTsgLy8gV0lQCgogIGNvbnN0IGNxaiA9IG5ldyBRdWF0ZXJuaW9uKCk7CiAgY29uc3QgY29udmV4UGFydGljbGVfbG9jYWwgPSBuZXcgVmVjMygpOwogIG5ldyBWZWMzKCk7CiAgY29uc3QgY29udmV4UGFydGljbGVfcGVuZXRyYXRlZEZhY2VOb3JtYWwgPSBuZXcgVmVjMygpOwogIGNvbnN0IGNvbnZleFBhcnRpY2xlX3ZlcnRleFRvUGFydGljbGUgPSBuZXcgVmVjMygpOwogIGNvbnN0IGNvbnZleFBhcnRpY2xlX3dvcmxkUGVuZXRyYXRpb25WZWMgPSBuZXcgVmVjMygpOwogIGNvbnN0IGNvbnZleEhlaWdodGZpZWxkX3RtcDEgPSBuZXcgVmVjMygpOwogIGNvbnN0IGNvbnZleEhlaWdodGZpZWxkX3RtcDIgPSBuZXcgVmVjMygpOwogIGNvbnN0IGNvbnZleEhlaWdodGZpZWxkX2ZhY2VMaXN0ID0gWzBdOwogIGNvbnN0IHNwaGVyZUhlaWdodGZpZWxkX3RtcDEgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZUhlaWdodGZpZWxkX3RtcDIgPSBuZXcgVmVjMygpOwoKICBjbGFzcyBPdmVybGFwS2VlcGVyIHsKICAgIC8qKgogICAgICogQHRvZG8gUmVtb3ZlIHVzZWxlc3MgY29uc3RydWN0b3IKICAgICAqLwogICAgY29uc3RydWN0b3IoKSB7CiAgICAgIHRoaXMuY3VycmVudCA9IFtdOwogICAgICB0aGlzLnByZXZpb3VzID0gW107CiAgICB9CiAgICAvKioKICAgICAqIGdldEtleQogICAgICovCgoKICAgIGdldEtleShpLCBqKSB7CiAgICAgIGlmIChqIDwgaSkgewogICAgICAgIGNvbnN0IHRlbXAgPSBqOwogICAgICAgIGogPSBpOwogICAgICAgIGkgPSB0ZW1wOwogICAgICB9CgogICAgICByZXR1cm4gaSA8PCAxNiB8IGo7CiAgICB9CiAgICAvKioKICAgICAqIHNldAogICAgICovCgoKICAgIHNldChpLCBqKSB7CiAgICAgIC8vIEluc2VydGlvbiBzb3J0LiBUaGlzIHdheSB0aGUgZGlmZiB3aWxsIGhhdmUgbGluZWFyIGNvbXBsZXhpdHkuCiAgICAgIGNvbnN0IGtleSA9IHRoaXMuZ2V0S2V5KGksIGopOwogICAgICBjb25zdCBjdXJyZW50ID0gdGhpcy5jdXJyZW50OwogICAgICBsZXQgaW5kZXggPSAwOwoKICAgICAgd2hpbGUgKGtleSA+IGN1cnJlbnRbaW5kZXhdKSB7CiAgICAgICAgaW5kZXgrKzsKICAgICAgfQoKICAgICAgaWYgKGtleSA9PT0gY3VycmVudFtpbmRleF0pIHsKICAgICAgICByZXR1cm47IC8vIFBhaXIgd2FzIGFscmVhZHkgYWRkZWQKICAgICAgfQoKICAgICAgZm9yIChsZXQgaiA9IGN1cnJlbnQubGVuZ3RoIC0gMTsgaiA+PSBpbmRleDsgai0tKSB7CiAgICAgICAgY3VycmVudFtqICsgMV0gPSBjdXJyZW50W2pdOwogICAgICB9CgogICAgICBjdXJyZW50W2luZGV4XSA9IGtleTsKICAgIH0KICAgIC8qKgogICAgICogdGljawogICAgICovCgoKICAgIHRpY2soKSB7CiAgICAgIGNvbnN0IHRtcCA9IHRoaXMuY3VycmVudDsKICAgICAgdGhpcy5jdXJyZW50ID0gdGhpcy5wcmV2aW91czsKICAgICAgdGhpcy5wcmV2aW91cyA9IHRtcDsKICAgICAgdGhpcy5jdXJyZW50Lmxlbmd0aCA9IDA7CiAgICB9CiAgICAvKioKICAgICAqIGdldERpZmYKICAgICAqLwoKCiAgICBnZXREaWZmKGFkZGl0aW9ucywgcmVtb3ZhbHMpIHsKICAgICAgY29uc3QgYSA9IHRoaXMuY3VycmVudDsKICAgICAgY29uc3QgYiA9IHRoaXMucHJldmlvdXM7CiAgICAgIGNvbnN0IGFsID0gYS5sZW5ndGg7CiAgICAgIGNvbnN0IGJsID0gYi5sZW5ndGg7CiAgICAgIGxldCBqID0gMDsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYWw7IGkrKykgewogICAgICAgIGxldCBmb3VuZCA9IGZhbHNlOwogICAgICAgIGNvbnN0IGtleUEgPSBhW2ldOwoKICAgICAgICB3aGlsZSAoa2V5QSA+IGJbal0pIHsKICAgICAgICAgIGorKzsKICAgICAgICB9CgogICAgICAgIGZvdW5kID0ga2V5QSA9PT0gYltqXTsKCiAgICAgICAgaWYgKCFmb3VuZCkgewogICAgICAgICAgdW5wYWNrQW5kUHVzaChhZGRpdGlvbnMsIGtleUEpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaiA9IDA7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGJsOyBpKyspIHsKICAgICAgICBsZXQgZm91bmQgPSBmYWxzZTsKICAgICAgICBjb25zdCBrZXlCID0gYltpXTsKCiAgICAgICAgd2hpbGUgKGtleUIgPiBhW2pdKSB7CiAgICAgICAgICBqKys7CiAgICAgICAgfQoKICAgICAgICBmb3VuZCA9IGFbal0gPT09IGtleUI7CgogICAgICAgIGlmICghZm91bmQpIHsKICAgICAgICAgIHVucGFja0FuZFB1c2gocmVtb3ZhbHMsIGtleUIpOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICB9CgogIGZ1bmN0aW9uIHVucGFja0FuZFB1c2goYXJyYXksIGtleSkgewogICAgYXJyYXkucHVzaCgoa2V5ICYgMHhmZmZmMDAwMCkgPj4gMTYsIGtleSAmIDB4MDAwMGZmZmYpOwogIH0KCiAgY29uc3QgZ2V0S2V5ID0gKGksIGopID0+IGkgPCBqID8gYCR7aX0tJHtqfWAgOiBgJHtqfS0ke2l9YDsKICAvKioKICAgKiBUdXBsZURpY3Rpb25hcnkKICAgKi8KCgogIGNsYXNzIFR1cGxlRGljdGlvbmFyeSB7CiAgICBjb25zdHJ1Y3RvcigpIHsKICAgICAgdGhpcy5kYXRhID0gewogICAgICAgIGtleXM6IFtdCiAgICAgIH07CiAgICB9CgogICAgLyoqIGdldCAqLwogICAgZ2V0KGksIGopIHsKICAgICAgY29uc3Qga2V5ID0gZ2V0S2V5KGksIGopOwogICAgICByZXR1cm4gdGhpcy5kYXRhW2tleV07CiAgICB9CiAgICAvKiogc2V0ICovCgoKICAgIHNldChpLCBqLCB2YWx1ZSkgewogICAgICBjb25zdCBrZXkgPSBnZXRLZXkoaSwgaik7IC8vIENoZWNrIGlmIGtleSBhbHJlYWR5IGV4aXN0cwoKICAgICAgaWYgKCF0aGlzLmdldChpLCBqKSkgewogICAgICAgIHRoaXMuZGF0YS5rZXlzLnB1c2goa2V5KTsKICAgICAgfQoKICAgICAgdGhpcy5kYXRhW2tleV0gPSB2YWx1ZTsKICAgIH0KICAgIC8qKiBkZWxldGUgKi8KCgogICAgZGVsZXRlKGksIGopIHsKICAgICAgY29uc3Qga2V5ID0gZ2V0S2V5KGksIGopOwogICAgICBjb25zdCBpbmRleCA9IHRoaXMuZGF0YS5rZXlzLmluZGV4T2Yoa2V5KTsKCiAgICAgIGlmIChpbmRleCAhPT0gLTEpIHsKICAgICAgICB0aGlzLmRhdGEua2V5cy5zcGxpY2UoaW5kZXgsIDEpOwogICAgICB9CgogICAgICBkZWxldGUgdGhpcy5kYXRhW2tleV07CiAgICB9CiAgICAvKiogcmVzZXQgKi8KCgogICAgcmVzZXQoKSB7CiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGE7CiAgICAgIGNvbnN0IGtleXMgPSBkYXRhLmtleXM7CgogICAgICB3aGlsZSAoa2V5cy5sZW5ndGggPiAwKSB7CiAgICAgICAgY29uc3Qga2V5ID0ga2V5cy5wb3AoKTsKICAgICAgICBkZWxldGUgZGF0YVtrZXldOwogICAgICB9CiAgICB9CgogIH0KCiAgLyoqCiAgICogVGhlIHBoeXNpY3Mgd29ybGQKICAgKi8KICBjbGFzcyBXb3JsZCBleHRlbmRzIEV2ZW50VGFyZ2V0IHsKICAgIC8qKgogICAgICogQ3VycmVudGx5IC8gbGFzdCB1c2VkIHRpbWVzdGVwLiBJcyBzZXQgdG8gLTEgaWYgbm90IGF2YWlsYWJsZS4gVGhpcyB2YWx1ZSBpcyB1cGRhdGVkIGJlZm9yZSBlYWNoIGludGVybmFsIHN0ZXAsIHdoaWNoIG1lYW5zIHRoYXQgaXQgaXMgImZyZXNoIiBpbnNpZGUgZXZlbnQgY2FsbGJhY2tzLgogICAgICovCgogICAgLyoqCiAgICAgKiBNYWtlcyBib2RpZXMgZ28gdG8gc2xlZXAgd2hlbiB0aGV5J3ZlIGJlZW4gaW5hY3RpdmUuCiAgICAgKiBAZGVmYXVsdCBmYWxzZQogICAgICovCgogICAgLyoqCiAgICAgKiBBbGwgdGhlIGN1cnJlbnQgY29udGFjdHMgKGluc3RhbmNlcyBvZiBDb250YWN0RXF1YXRpb24pIGluIHRoZSB3b3JsZC4KICAgICAqLwoKICAgIC8qKgogICAgICogSG93IG9mdGVuIHRvIG5vcm1hbGl6ZSBxdWF0ZXJuaW9ucy4gU2V0IHRvIDAgZm9yIGV2ZXJ5IHN0ZXAsIDEgZm9yIGV2ZXJ5IHNlY29uZCBldGMuLiBBIGxhcmdlciB2YWx1ZSBpbmNyZWFzZXMgcGVyZm9ybWFuY2UuIElmIGJvZGllcyB0ZW5kIHRvIGV4cGxvZGUsIHNldCB0byBhIHNtYWxsZXIgdmFsdWUgKHplcm8gdG8gYmUgc3VyZSBub3RoaW5nIGNhbiBnbyB3cm9uZykuCiAgICAgKiBAZGVmYXVsdCAwCiAgICAgKi8KCiAgICAvKioKICAgICAqIFNldCB0byB0cnVlIHRvIHVzZSBmYXN0IHF1YXRlcm5pb24gbm9ybWFsaXphdGlvbi4gSXQgaXMgb2Z0ZW4gZW5vdWdoIGFjY3VyYXRlIHRvIHVzZS4KICAgICAqIElmIGJvZGllcyB0ZW5kIHRvIGV4cGxvZGUsIHNldCB0byBmYWxzZS4KICAgICAqIEBkZWZhdWx0IGZhbHNlCiAgICAgKi8KCiAgICAvKioKICAgICAqIFRoZSB3YWxsLWNsb2NrIHRpbWUgc2luY2Ugc2ltdWxhdGlvbiBzdGFydC4KICAgICAqLwoKICAgIC8qKgogICAgICogTnVtYmVyIG9mIHRpbWVzdGVwcyB0YWtlbiBzaW5jZSBzdGFydC4KICAgICAqLwoKICAgIC8qKgogICAgICogRGVmYXVsdCBhbmQgbGFzdCB0aW1lc3RlcCBzaXplcy4KICAgICAqLwoKICAgIC8qKgogICAgICogVGhlIGdyYXZpdHkgb2YgdGhlIHdvcmxkLgogICAgICovCgogICAgLyoqCiAgICAgKiBHcmF2aXR5IHRvIHVzZSB3aGVuIGFwcHJveGltYXRpbmcgdGhlIGZyaWN0aW9uIG1heCBmb3JjZSAobXUqbWFzcypncmF2aXR5KS4KICAgICAqIElmIHVuZGVmaW5lZCwgZ2xvYmFsIGdyYXZpdHkgd2lsbCBiZSB1c2VkLgogICAgICogVXNlIHRvIGVuYWJsZSBmcmljdGlvbiBpbiBhIFdvcmxkIHdpdGggYSBudWxsIGdyYXZpdHkgdmVjdG9yIChubyBncmF2aXR5KS4KICAgICAqLwoKICAgIC8qKgogICAgICogVGhlIGJyb2FkcGhhc2UgYWxnb3JpdGhtIHRvIHVzZS4KICAgICAqIEBkZWZhdWx0IE5haXZlQnJvYWRwaGFzZQogICAgICovCgogICAgLyoqCiAgICAgKiBBbGwgYm9kaWVzIGluIHRoaXMgd29ybGQKICAgICAqLwoKICAgIC8qKgogICAgICogVHJ1ZSBpZiBhbnkgYm9kaWVzIGFyZSBub3Qgc2xlZXBpbmcsIGZhbHNlIGlmIGV2ZXJ5IGJvZHkgaXMgc2xlZXBpbmcuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFRoZSBzb2x2ZXIgYWxnb3JpdGhtIHRvIHVzZS4KICAgICAqIEBkZWZhdWx0IEdTU29sdmVyCiAgICAgKi8KCiAgICAvKioKICAgICAqIGNvbGxpc2lvbk1hdHJpeAogICAgICovCgogICAgLyoqCiAgICAgKiBDb2xsaXNpb25NYXRyaXggZnJvbSB0aGUgcHJldmlvdXMgc3RlcC4KICAgICAqLwoKICAgIC8qKgogICAgICogQWxsIGFkZGVkIGNvbnRhY3RtYXRlcmlhbHMuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFVzZWQgdG8gbG9vayB1cCBhIENvbnRhY3RNYXRlcmlhbCBnaXZlbiB0d28gaW5zdGFuY2VzIG9mIE1hdGVyaWFsLgogICAgICovCgogICAgLyoqCiAgICAgKiBUaGUgZGVmYXVsdCBtYXRlcmlhbCBvZiB0aGUgYm9kaWVzLgogICAgICovCgogICAgLyoqCiAgICAgKiBUaGlzIGNvbnRhY3QgbWF0ZXJpYWwgaXMgdXNlZCBpZiBubyBzdWl0YWJsZSBjb250YWN0bWF0ZXJpYWwgaXMgZm91bmQgZm9yIGEgY29udGFjdC4KICAgICAqLwoKICAgIC8qKgogICAgICogVGltZSBhY2N1bXVsYXRvciBmb3IgaW50ZXJwb2xhdGlvbi4KICAgICAqIEBzZWUgaHR0cHM6Ly9nYWZmZXJvbmdhbWVzLmNvbS9nYW1lLXBoeXNpY3MvZml4LXlvdXItdGltZXN0ZXAvCiAgICAgKi8KCiAgICAvKioKICAgICAqIERpc3BhdGNoZWQgYWZ0ZXIgYSBib2R5IGhhcyBiZWVuIGFkZGVkIHRvIHRoZSB3b3JsZC4KICAgICAqLwoKICAgIC8qKgogICAgICogRGlzcGF0Y2hlZCBhZnRlciBhIGJvZHkgaGFzIGJlZW4gcmVtb3ZlZCBmcm9tIHRoZSB3b3JsZC4KICAgICAqLwogICAgY29uc3RydWN0b3Iob3B0aW9ucykgewogICAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7CiAgICAgICAgb3B0aW9ucyA9IHt9OwogICAgICB9CgogICAgICBzdXBlcigpOwogICAgICB0aGlzLmR0ID0gLTE7CiAgICAgIHRoaXMuYWxsb3dTbGVlcCA9ICEhb3B0aW9ucy5hbGxvd1NsZWVwOwogICAgICB0aGlzLmNvbnRhY3RzID0gW107CiAgICAgIHRoaXMuZnJpY3Rpb25FcXVhdGlvbnMgPSBbXTsKICAgICAgdGhpcy5xdWF0Tm9ybWFsaXplU2tpcCA9IG9wdGlvbnMucXVhdE5vcm1hbGl6ZVNraXAgIT09IHVuZGVmaW5lZCA/IG9wdGlvbnMucXVhdE5vcm1hbGl6ZVNraXAgOiAwOwogICAgICB0aGlzLnF1YXROb3JtYWxpemVGYXN0ID0gb3B0aW9ucy5xdWF0Tm9ybWFsaXplRmFzdCAhPT0gdW5kZWZpbmVkID8gb3B0aW9ucy5xdWF0Tm9ybWFsaXplRmFzdCA6IGZhbHNlOwogICAgICB0aGlzLnRpbWUgPSAwLjA7CiAgICAgIHRoaXMuc3RlcG51bWJlciA9IDA7CiAgICAgIHRoaXMuZGVmYXVsdF9kdCA9IDEgLyA2MDsKICAgICAgdGhpcy5uZXh0SWQgPSAwOwogICAgICB0aGlzLmdyYXZpdHkgPSBuZXcgVmVjMygpOwoKICAgICAgaWYgKG9wdGlvbnMuZ3Jhdml0eSkgewogICAgICAgIHRoaXMuZ3Jhdml0eS5jb3B5KG9wdGlvbnMuZ3Jhdml0eSk7CiAgICAgIH0KCiAgICAgIGlmIChvcHRpb25zLmZyaWN0aW9uR3Jhdml0eSkgewogICAgICAgIHRoaXMuZnJpY3Rpb25HcmF2aXR5ID0gbmV3IFZlYzMoKTsKICAgICAgICB0aGlzLmZyaWN0aW9uR3Jhdml0eS5jb3B5KG9wdGlvbnMuZnJpY3Rpb25HcmF2aXR5KTsKICAgICAgfQoKICAgICAgdGhpcy5icm9hZHBoYXNlID0gb3B0aW9ucy5icm9hZHBoYXNlICE9PSB1bmRlZmluZWQgPyBvcHRpb25zLmJyb2FkcGhhc2UgOiBuZXcgTmFpdmVCcm9hZHBoYXNlKCk7CiAgICAgIHRoaXMuYm9kaWVzID0gW107CiAgICAgIHRoaXMuaGFzQWN0aXZlQm9kaWVzID0gZmFsc2U7CiAgICAgIHRoaXMuc29sdmVyID0gb3B0aW9ucy5zb2x2ZXIgIT09IHVuZGVmaW5lZCA/IG9wdGlvbnMuc29sdmVyIDogbmV3IEdTU29sdmVyKCk7CiAgICAgIHRoaXMuY29uc3RyYWludHMgPSBbXTsKICAgICAgdGhpcy5uYXJyb3dwaGFzZSA9IG5ldyBOYXJyb3dwaGFzZSh0aGlzKTsKICAgICAgdGhpcy5jb2xsaXNpb25NYXRyaXggPSBuZXcgQXJyYXlDb2xsaXNpb25NYXRyaXgoKTsKICAgICAgdGhpcy5jb2xsaXNpb25NYXRyaXhQcmV2aW91cyA9IG5ldyBBcnJheUNvbGxpc2lvbk1hdHJpeCgpOwogICAgICB0aGlzLmJvZHlPdmVybGFwS2VlcGVyID0gbmV3IE92ZXJsYXBLZWVwZXIoKTsKICAgICAgdGhpcy5zaGFwZU92ZXJsYXBLZWVwZXIgPSBuZXcgT3ZlcmxhcEtlZXBlcigpOwogICAgICB0aGlzLmNvbnRhY3RtYXRlcmlhbHMgPSBbXTsKICAgICAgdGhpcy5jb250YWN0TWF0ZXJpYWxUYWJsZSA9IG5ldyBUdXBsZURpY3Rpb25hcnkoKTsKICAgICAgdGhpcy5kZWZhdWx0TWF0ZXJpYWwgPSBuZXcgTWF0ZXJpYWwoJ2RlZmF1bHQnKTsKICAgICAgdGhpcy5kZWZhdWx0Q29udGFjdE1hdGVyaWFsID0gbmV3IENvbnRhY3RNYXRlcmlhbCh0aGlzLmRlZmF1bHRNYXRlcmlhbCwgdGhpcy5kZWZhdWx0TWF0ZXJpYWwsIHsKICAgICAgICBmcmljdGlvbjogMC4zLAogICAgICAgIHJlc3RpdHV0aW9uOiAwLjAKICAgICAgfSk7CiAgICAgIHRoaXMuZG9Qcm9maWxpbmcgPSBmYWxzZTsKICAgICAgdGhpcy5wcm9maWxlID0gewogICAgICAgIHNvbHZlOiAwLAogICAgICAgIG1ha2VDb250YWN0Q29uc3RyYWludHM6IDAsCiAgICAgICAgYnJvYWRwaGFzZTogMCwKICAgICAgICBpbnRlZ3JhdGU6IDAsCiAgICAgICAgbmFycm93cGhhc2U6IDAKICAgICAgfTsKICAgICAgdGhpcy5hY2N1bXVsYXRvciA9IDA7CiAgICAgIHRoaXMuc3Vic3lzdGVtcyA9IFtdOwogICAgICB0aGlzLmFkZEJvZHlFdmVudCA9IHsKICAgICAgICB0eXBlOiAnYWRkQm9keScsCiAgICAgICAgYm9keTogbnVsbAogICAgICB9OwogICAgICB0aGlzLnJlbW92ZUJvZHlFdmVudCA9IHsKICAgICAgICB0eXBlOiAncmVtb3ZlQm9keScsCiAgICAgICAgYm9keTogbnVsbAogICAgICB9OwogICAgICB0aGlzLmlkVG9Cb2R5TWFwID0ge307CiAgICAgIHRoaXMuYnJvYWRwaGFzZS5zZXRXb3JsZCh0aGlzKTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IHRoZSBjb250YWN0IG1hdGVyaWFsIGJldHdlZW4gbWF0ZXJpYWxzIG0xIGFuZCBtMgogICAgICogQHJldHVybiBUaGUgY29udGFjdCBtYXRlcmlhbCBpZiBpdCB3YXMgZm91bmQuCiAgICAgKi8KCgogICAgZ2V0Q29udGFjdE1hdGVyaWFsKG0xLCBtMikgewogICAgICByZXR1cm4gdGhpcy5jb250YWN0TWF0ZXJpYWxUYWJsZS5nZXQobTEuaWQsIG0yLmlkKTsKICAgIH0KICAgIC8qKgogICAgICogU3RvcmUgb2xkIGNvbGxpc2lvbiBzdGF0ZSBpbmZvCiAgICAgKi8KCgogICAgY29sbGlzaW9uTWF0cml4VGljaygpIHsKICAgICAgY29uc3QgdGVtcCA9IHRoaXMuY29sbGlzaW9uTWF0cml4UHJldmlvdXM7CiAgICAgIHRoaXMuY29sbGlzaW9uTWF0cml4UHJldmlvdXMgPSB0aGlzLmNvbGxpc2lvbk1hdHJpeDsKICAgICAgdGhpcy5jb2xsaXNpb25NYXRyaXggPSB0ZW1wOwogICAgICB0aGlzLmNvbGxpc2lvbk1hdHJpeC5yZXNldCgpOwogICAgICB0aGlzLmJvZHlPdmVybGFwS2VlcGVyLnRpY2soKTsKICAgICAgdGhpcy5zaGFwZU92ZXJsYXBLZWVwZXIudGljaygpOwogICAgfQogICAgLyoqCiAgICAgKiBBZGQgYSBjb25zdHJhaW50IHRvIHRoZSBzaW11bGF0aW9uLgogICAgICovCgoKICAgIGFkZENvbnN0cmFpbnQoYykgewogICAgICB0aGlzLmNvbnN0cmFpbnRzLnB1c2goYyk7CiAgICB9CiAgICAvKioKICAgICAqIFJlbW92ZXMgYSBjb25zdHJhaW50CiAgICAgKi8KCgogICAgcmVtb3ZlQ29uc3RyYWludChjKSB7CiAgICAgIGNvbnN0IGlkeCA9IHRoaXMuY29uc3RyYWludHMuaW5kZXhPZihjKTsKCiAgICAgIGlmIChpZHggIT09IC0xKSB7CiAgICAgICAgdGhpcy5jb25zdHJhaW50cy5zcGxpY2UoaWR4LCAxKTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBSYXljYXN0IHRlc3QKICAgICAqIEBkZXByZWNhdGVkIFVzZSAucmF5Y2FzdEFsbCwgLnJheWNhc3RDbG9zZXN0IG9yIC5yYXljYXN0QW55IGluc3RlYWQuCiAgICAgKi8KCgogICAgcmF5VGVzdChmcm9tLCB0bywgcmVzdWx0KSB7CiAgICAgIGlmIChyZXN1bHQgaW5zdGFuY2VvZiBSYXljYXN0UmVzdWx0KSB7CiAgICAgICAgLy8gRG8gcmF5Y2FzdENsb3Nlc3QKICAgICAgICB0aGlzLnJheWNhc3RDbG9zZXN0KGZyb20sIHRvLCB7CiAgICAgICAgICBza2lwQmFja2ZhY2VzOiB0cnVlCiAgICAgICAgfSwgcmVzdWx0KTsKICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBEbyByYXljYXN0QWxsCiAgICAgICAgdGhpcy5yYXljYXN0QWxsKGZyb20sIHRvLCB7CiAgICAgICAgICBza2lwQmFja2ZhY2VzOiB0cnVlCiAgICAgICAgfSwgcmVzdWx0KTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBSYXkgY2FzdCBhZ2FpbnN0IGFsbCBib2RpZXMuIFRoZSBwcm92aWRlZCBjYWxsYmFjayB3aWxsIGJlIGV4ZWN1dGVkIGZvciBlYWNoIGhpdCB3aXRoIGEgUmF5Y2FzdFJlc3VsdCBhcyBzaW5nbGUgYXJndW1lbnQuCiAgICAgKiBAcmV0dXJuIFRydWUgaWYgYW55IGJvZHkgd2FzIGhpdC4KICAgICAqLwoKCiAgICByYXljYXN0QWxsKGZyb20sIHRvLCBvcHRpb25zLCBjYWxsYmFjaykgewogICAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7CiAgICAgICAgb3B0aW9ucyA9IHt9OwogICAgICB9CgogICAgICBvcHRpb25zLm1vZGUgPSBSYXkuQUxMOwogICAgICBvcHRpb25zLmZyb20gPSBmcm9tOwogICAgICBvcHRpb25zLnRvID0gdG87CiAgICAgIG9wdGlvbnMuY2FsbGJhY2sgPSBjYWxsYmFjazsKICAgICAgcmV0dXJuIHRtcFJheS5pbnRlcnNlY3RXb3JsZCh0aGlzLCBvcHRpb25zKTsKICAgIH0KICAgIC8qKgogICAgICogUmF5IGNhc3QsIGFuZCBzdG9wIGF0IHRoZSBmaXJzdCByZXN1bHQuIE5vdGUgdGhhdCB0aGUgb3JkZXIgaXMgcmFuZG9tIC0gYnV0IHRoZSBtZXRob2QgaXMgZmFzdC4KICAgICAqIEByZXR1cm4gVHJ1ZSBpZiBhbnkgYm9keSB3YXMgaGl0LgogICAgICovCgoKICAgIHJheWNhc3RBbnkoZnJvbSwgdG8sIG9wdGlvbnMsIHJlc3VsdCkgewogICAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7CiAgICAgICAgb3B0aW9ucyA9IHt9OwogICAgICB9CgogICAgICBvcHRpb25zLm1vZGUgPSBSYXkuQU5ZOwogICAgICBvcHRpb25zLmZyb20gPSBmcm9tOwogICAgICBvcHRpb25zLnRvID0gdG87CiAgICAgIG9wdGlvbnMucmVzdWx0ID0gcmVzdWx0OwogICAgICByZXR1cm4gdG1wUmF5LmludGVyc2VjdFdvcmxkKHRoaXMsIG9wdGlvbnMpOwogICAgfQogICAgLyoqCiAgICAgKiBSYXkgY2FzdCwgYW5kIHJldHVybiBpbmZvcm1hdGlvbiBvZiB0aGUgY2xvc2VzdCBoaXQuCiAgICAgKiBAcmV0dXJuIFRydWUgaWYgYW55IGJvZHkgd2FzIGhpdC4KICAgICAqLwoKCiAgICByYXljYXN0Q2xvc2VzdChmcm9tLCB0bywgb3B0aW9ucywgcmVzdWx0KSB7CiAgICAgIGlmIChvcHRpb25zID09PSB2b2lkIDApIHsKICAgICAgICBvcHRpb25zID0ge307CiAgICAgIH0KCiAgICAgIG9wdGlvbnMubW9kZSA9IFJheS5DTE9TRVNUOwogICAgICBvcHRpb25zLmZyb20gPSBmcm9tOwogICAgICBvcHRpb25zLnRvID0gdG87CiAgICAgIG9wdGlvbnMucmVzdWx0ID0gcmVzdWx0OwogICAgICByZXR1cm4gdG1wUmF5LmludGVyc2VjdFdvcmxkKHRoaXMsIG9wdGlvbnMpOwogICAgfQogICAgLyoqCiAgICAgKiBBZGQgYSByaWdpZCBib2R5IHRvIHRoZSBzaW11bGF0aW9uLgogICAgICogQHRvZG8gSWYgdGhlIHNpbXVsYXRpb24gaGFzIG5vdCB5ZXQgc3RhcnRlZCwgd2h5IHJlY3JldGUgYW5kIGNvcHkgYXJyYXlzIGZvciBlYWNoIGJvZHk/IEFjY3VtdWxhdGUgaW4gZHluYW1pYyBhcnJheXMgaW4gdGhpcyBjYXNlLgogICAgICogQHRvZG8gQWRkaW5nIGFuIGFycmF5IG9mIGJvZGllcyBzaG91bGQgYmUgcG9zc2libGUuIFRoaXMgd291bGQgc2F2ZSBzb21lIGxvb3BzIHRvbwogICAgICovCgoKICAgIGFkZEJvZHkoYm9keSkgewogICAgICBpZiAodGhpcy5ib2RpZXMuaW5jbHVkZXMoYm9keSkpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGJvZHkuaW5kZXggPSB0aGlzLmJvZGllcy5sZW5ndGg7CiAgICAgIHRoaXMuYm9kaWVzLnB1c2goYm9keSk7CiAgICAgIGJvZHkud29ybGQgPSB0aGlzOwogICAgICBib2R5LmluaXRQb3NpdGlvbi5jb3B5KGJvZHkucG9zaXRpb24pOwogICAgICBib2R5LmluaXRWZWxvY2l0eS5jb3B5KGJvZHkudmVsb2NpdHkpOwogICAgICBib2R5LnRpbWVMYXN0U2xlZXB5ID0gdGhpcy50aW1lOwoKICAgICAgaWYgKGJvZHkgaW5zdGFuY2VvZiBCb2R5KSB7CiAgICAgICAgYm9keS5pbml0QW5ndWxhclZlbG9jaXR5LmNvcHkoYm9keS5hbmd1bGFyVmVsb2NpdHkpOwogICAgICAgIGJvZHkuaW5pdFF1YXRlcm5pb24uY29weShib2R5LnF1YXRlcm5pb24pOwogICAgICB9CgogICAgICB0aGlzLmNvbGxpc2lvbk1hdHJpeC5zZXROdW1PYmplY3RzKHRoaXMuYm9kaWVzLmxlbmd0aCk7CiAgICAgIHRoaXMuYWRkQm9keUV2ZW50LmJvZHkgPSBib2R5OwogICAgICB0aGlzLmlkVG9Cb2R5TWFwW2JvZHkuaWRdID0gYm9keTsKICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KHRoaXMuYWRkQm9keUV2ZW50KTsKICAgIH0KICAgIC8qKgogICAgICogUmVtb3ZlIGEgcmlnaWQgYm9keSBmcm9tIHRoZSBzaW11bGF0aW9uLgogICAgICovCgoKICAgIHJlbW92ZUJvZHkoYm9keSkgewogICAgICBib2R5LndvcmxkID0gbnVsbDsKICAgICAgY29uc3QgbiA9IHRoaXMuYm9kaWVzLmxlbmd0aCAtIDE7CiAgICAgIGNvbnN0IGJvZGllcyA9IHRoaXMuYm9kaWVzOwogICAgICBjb25zdCBpZHggPSBib2RpZXMuaW5kZXhPZihib2R5KTsKCiAgICAgIGlmIChpZHggIT09IC0xKSB7CiAgICAgICAgYm9kaWVzLnNwbGljZShpZHgsIDEpOyAvLyBUb2RvOiBzaG91bGQgdXNlIGEgZ2FyYmFnZSBmcmVlIG1ldGhvZAogICAgICAgIC8vIFJlY29tcHV0ZSBpbmRleAoKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gYm9kaWVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICBib2RpZXNbaV0uaW5kZXggPSBpOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5jb2xsaXNpb25NYXRyaXguc2V0TnVtT2JqZWN0cyhuKTsKICAgICAgICB0aGlzLnJlbW92ZUJvZHlFdmVudC5ib2R5ID0gYm9keTsKICAgICAgICBkZWxldGUgdGhpcy5pZFRvQm9keU1hcFtib2R5LmlkXTsKICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQodGhpcy5yZW1vdmVCb2R5RXZlbnQpOwogICAgICB9CiAgICB9CgogICAgZ2V0Qm9keUJ5SWQoaWQpIHsKICAgICAgcmV0dXJuIHRoaXMuaWRUb0JvZHlNYXBbaWRdOwogICAgfQogICAgLyoqCiAgICAgKiBAdG9kbyBNYWtlIGEgZmFzdGVyIG1hcAogICAgICovCgoKICAgIGdldFNoYXBlQnlJZChpZCkgewogICAgICBjb25zdCBib2RpZXMgPSB0aGlzLmJvZGllczsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYm9kaWVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgY29uc3Qgc2hhcGVzID0gYm9kaWVzW2ldLnNoYXBlczsKCiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBzaGFwZXMubGVuZ3RoOyBqKyspIHsKICAgICAgICAgIGNvbnN0IHNoYXBlID0gc2hhcGVzW2pdOwoKICAgICAgICAgIGlmIChzaGFwZS5pZCA9PT0gaWQpIHsKICAgICAgICAgICAgcmV0dXJuIHNoYXBlOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CiAgICAvKioKICAgICAqIEFkZHMgYSBjb250YWN0IG1hdGVyaWFsIHRvIHRoZSBXb3JsZAogICAgICovCgoKICAgIGFkZENvbnRhY3RNYXRlcmlhbChjbWF0KSB7CiAgICAgIC8vIEFkZCBjb250YWN0IG1hdGVyaWFsCiAgICAgIHRoaXMuY29udGFjdG1hdGVyaWFscy5wdXNoKGNtYXQpOyAvLyBBZGQgY3VycmVudCBjb250YWN0IG1hdGVyaWFsIHRvIHRoZSBtYXRlcmlhbCB0YWJsZQoKICAgICAgdGhpcy5jb250YWN0TWF0ZXJpYWxUYWJsZS5zZXQoY21hdC5tYXRlcmlhbHNbMF0uaWQsIGNtYXQubWF0ZXJpYWxzWzFdLmlkLCBjbWF0KTsKICAgIH0KICAgIC8qKgogICAgICogUmVtb3ZlcyBhIGNvbnRhY3QgbWF0ZXJpYWwgZnJvbSB0aGUgV29ybGQuCiAgICAgKi8KCgogICAgcmVtb3ZlQ29udGFjdE1hdGVyaWFsKGNtYXQpIHsKICAgICAgY29uc3QgaWR4ID0gdGhpcy5jb250YWN0bWF0ZXJpYWxzLmluZGV4T2YoY21hdCk7CgogICAgICBpZiAoaWR4ID09PSAtMSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdGhpcy5jb250YWN0bWF0ZXJpYWxzLnNwbGljZShpZHgsIDEpOwogICAgICB0aGlzLmNvbnRhY3RNYXRlcmlhbFRhYmxlLmRlbGV0ZShjbWF0Lm1hdGVyaWFsc1swXS5pZCwgY21hdC5tYXRlcmlhbHNbMV0uaWQpOwogICAgfQogICAgLyoqCiAgICAgKiBTdGVwIHRoZSBzaW11bGF0aW9uIGZvcndhcmQga2VlcGluZyB0cmFjayBvZiBsYXN0IGNhbGxlZCB0aW1lCiAgICAgKiB0byBiZSBhYmxlIHRvIHN0ZXAgdGhlIHdvcmxkIGF0IGEgZml4ZWQgcmF0ZSwgaW5kZXBlbmRlbnRseSBvZiBmcmFtZXJhdGUuCiAgICAgKgogICAgICogQHBhcmFtIGR0IFRoZSBmaXhlZCB0aW1lIHN0ZXAgc2l6ZSB0byB1c2UgKGRlZmF1bHQ6IDEgLyA2MCkuCiAgICAgKiBAcGFyYW0gbWF4U3ViU3RlcHMgTWF4aW11bSBudW1iZXIgb2YgZml4ZWQgc3RlcHMgdG8gdGFrZSBwZXIgZnVuY3Rpb24gY2FsbCAoZGVmYXVsdDogMTApLgogICAgICogQHNlZSBodHRwczovL2dhZmZlcm9uZ2FtZXMuY29tL3Bvc3QvZml4X3lvdXJfdGltZXN0ZXAvCiAgICAgKiBAZXhhbXBsZQogICAgICogICAgIC8vIFJ1biB0aGUgc2ltdWxhdGlvbiBpbmRlcGVuZGVudGx5IG9mIGZyYW1lcmF0ZSBldmVyeSAxIC8gNjAgbXMKICAgICAqICAgICB3b3JsZC5maXhlZFN0ZXAoKQogICAgICovCgoKICAgIGZpeGVkU3RlcChkdCwgbWF4U3ViU3RlcHMpIHsKICAgICAgaWYgKGR0ID09PSB2b2lkIDApIHsKICAgICAgICBkdCA9IDEgLyA2MDsKICAgICAgfQoKICAgICAgaWYgKG1heFN1YlN0ZXBzID09PSB2b2lkIDApIHsKICAgICAgICBtYXhTdWJTdGVwcyA9IDEwOwogICAgICB9CgogICAgICBjb25zdCB0aW1lID0gcGVyZm9ybWFuY2Uubm93KCkgLyAxMDAwOyAvLyBzZWNvbmRzCgogICAgICBpZiAoIXRoaXMubGFzdENhbGxUaW1lKSB7CiAgICAgICAgdGhpcy5zdGVwKGR0LCB1bmRlZmluZWQsIG1heFN1YlN0ZXBzKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb25zdCB0aW1lU2luY2VMYXN0Q2FsbGVkID0gdGltZSAtIHRoaXMubGFzdENhbGxUaW1lOwogICAgICAgIHRoaXMuc3RlcChkdCwgdGltZVNpbmNlTGFzdENhbGxlZCwgbWF4U3ViU3RlcHMpOwogICAgICB9CgogICAgICB0aGlzLmxhc3RDYWxsVGltZSA9IHRpbWU7CiAgICB9CiAgICAvKioKICAgICAqIFN0ZXAgdGhlIHBoeXNpY3Mgd29ybGQgZm9yd2FyZCBpbiB0aW1lLgogICAgICoKICAgICAqIFRoZXJlIGFyZSB0d28gbW9kZXMuIFRoZSBzaW1wbGUgbW9kZSBpcyBmaXhlZCB0aW1lc3RlcHBpbmcgd2l0aG91dCBpbnRlcnBvbGF0aW9uLiBJbiB0aGlzIGNhc2UgeW91IG9ubHkgdXNlIHRoZSBmaXJzdCBhcmd1bWVudC4gVGhlIHNlY29uZCBjYXNlIHVzZXMgaW50ZXJwb2xhdGlvbi4gSW4gdGhhdCB5b3UgYWxzbyBwcm92aWRlIHRoZSB0aW1lIHNpbmNlIHRoZSBmdW5jdGlvbiB3YXMgbGFzdCB1c2VkLCBhcyB3ZWxsIGFzIHRoZSBtYXhpbXVtIGZpeGVkIHRpbWVzdGVwcyB0byB0YWtlLgogICAgICoKICAgICAqIEBwYXJhbSBkdCBUaGUgZml4ZWQgdGltZSBzdGVwIHNpemUgdG8gdXNlLgogICAgICogQHBhcmFtIHRpbWVTaW5jZUxhc3RDYWxsZWQgVGhlIHRpbWUgZWxhcHNlZCBzaW5jZSB0aGUgZnVuY3Rpb24gd2FzIGxhc3QgY2FsbGVkLgogICAgICogQHBhcmFtIG1heFN1YlN0ZXBzIE1heGltdW0gbnVtYmVyIG9mIGZpeGVkIHN0ZXBzIHRvIHRha2UgcGVyIGZ1bmN0aW9uIGNhbGwgKGRlZmF1bHQ6IDEwKS4KICAgICAqIEBzZWUgaHR0cHM6Ly93ZWIuYXJjaGl2ZS5vcmcvd2ViLzIwMTgwNDI2MTU0NTMxL2h0dHA6Ly9idWxsZXRwaHlzaWNzLm9yZy9tZWRpYXdpa2ktMS41LjgvaW5kZXgucGhwL1N0ZXBwaW5nX1RoZV9Xb3JsZCNXaGF0X2RvX3RoZV9wYXJhbWV0ZXJzX3RvX2J0RHluYW1pY3NXb3JsZDo6c3RlcFNpbXVsYXRpb25fbWVhbi4zRgogICAgICogQGV4YW1wbGUKICAgICAqICAgICAvLyBmaXhlZCB0aW1lc3RlcHBpbmcgd2l0aG91dCBpbnRlcnBvbGF0aW9uCiAgICAgKiAgICAgd29ybGQuc3RlcCgxIC8gNjApCiAgICAgKi8KCgogICAgc3RlcChkdCwgdGltZVNpbmNlTGFzdENhbGxlZCwgbWF4U3ViU3RlcHMpIHsKICAgICAgaWYgKG1heFN1YlN0ZXBzID09PSB2b2lkIDApIHsKICAgICAgICBtYXhTdWJTdGVwcyA9IDEwOwogICAgICB9CgogICAgICBpZiAodGltZVNpbmNlTGFzdENhbGxlZCA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgLy8gRml4ZWQsIHNpbXBsZSBzdGVwcGluZwogICAgICAgIHRoaXMuaW50ZXJuYWxTdGVwKGR0KTsgLy8gSW5jcmVtZW50IHRpbWUKCiAgICAgICAgdGhpcy50aW1lICs9IGR0OwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuYWNjdW11bGF0b3IgKz0gdGltZVNpbmNlTGFzdENhbGxlZDsKICAgICAgICBjb25zdCB0MCA9IHBlcmZvcm1hbmNlLm5vdygpOwogICAgICAgIGxldCBzdWJzdGVwcyA9IDA7CgogICAgICAgIHdoaWxlICh0aGlzLmFjY3VtdWxhdG9yID49IGR0ICYmIHN1YnN0ZXBzIDwgbWF4U3ViU3RlcHMpIHsKICAgICAgICAgIC8vIERvIGZpeGVkIHN0ZXBzIHRvIGNhdGNoIHVwCiAgICAgICAgICB0aGlzLmludGVybmFsU3RlcChkdCk7CiAgICAgICAgICB0aGlzLmFjY3VtdWxhdG9yIC09IGR0OwogICAgICAgICAgc3Vic3RlcHMrKzsKCiAgICAgICAgICBpZiAocGVyZm9ybWFuY2Uubm93KCkgLSB0MCA+IGR0ICogMTAwMCkgewogICAgICAgICAgICAvLyBUaGUgZnJhbWVyYXRlIGlzIG5vdCBpbnRlcmFjdGl2ZSBhbnltb3JlLgogICAgICAgICAgICAvLyBXZSBhcmUgYmVsb3cgdGhlIHRhcmdldCBmcmFtZXJhdGUuCiAgICAgICAgICAgIC8vIEJldHRlciBiYWlsIG91dC4KICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CiAgICAgICAgfSAvLyBSZW1vdmUgdGhlIGV4Y2VzcyBhY2N1bXVsYXRvciwgc2luY2Ugd2UgbWF5IG5vdAogICAgICAgIC8vIGhhdmUgaGFkIGVub3VnaCBzdWJzdGVwcyBhdmFpbGFibGUgdG8gY2F0Y2ggdXAKCgogICAgICAgIHRoaXMuYWNjdW11bGF0b3IgPSB0aGlzLmFjY3VtdWxhdG9yICUgZHQ7CiAgICAgICAgY29uc3QgdCA9IHRoaXMuYWNjdW11bGF0b3IgLyBkdDsKCiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogIT09IHRoaXMuYm9kaWVzLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICBjb25zdCBiID0gdGhpcy5ib2RpZXNbal07CiAgICAgICAgICBiLnByZXZpb3VzUG9zaXRpb24ubGVycChiLnBvc2l0aW9uLCB0LCBiLmludGVycG9sYXRlZFBvc2l0aW9uKTsKICAgICAgICAgIGIucHJldmlvdXNRdWF0ZXJuaW9uLnNsZXJwKGIucXVhdGVybmlvbiwgdCwgYi5pbnRlcnBvbGF0ZWRRdWF0ZXJuaW9uKTsKICAgICAgICAgIGIucHJldmlvdXNRdWF0ZXJuaW9uLm5vcm1hbGl6ZSgpOwogICAgICAgIH0KCiAgICAgICAgdGhpcy50aW1lICs9IHRpbWVTaW5jZUxhc3RDYWxsZWQ7CiAgICAgIH0KICAgIH0KCiAgICBpbnRlcm5hbFN0ZXAoZHQpIHsKICAgICAgdGhpcy5kdCA9IGR0OwogICAgICBjb25zdCBjb250YWN0cyA9IHRoaXMuY29udGFjdHM7CiAgICAgIGNvbnN0IHAxID0gV29ybGRfc3RlcF9wMTsKICAgICAgY29uc3QgcDIgPSBXb3JsZF9zdGVwX3AyOwogICAgICBjb25zdCBOID0gdGhpcy5ib2RpZXMubGVuZ3RoOwogICAgICBjb25zdCBib2RpZXMgPSB0aGlzLmJvZGllczsKICAgICAgY29uc3Qgc29sdmVyID0gdGhpcy5zb2x2ZXI7CiAgICAgIGNvbnN0IGdyYXZpdHkgPSB0aGlzLmdyYXZpdHk7CiAgICAgIGNvbnN0IGRvUHJvZmlsaW5nID0gdGhpcy5kb1Byb2ZpbGluZzsKICAgICAgY29uc3QgcHJvZmlsZSA9IHRoaXMucHJvZmlsZTsKICAgICAgY29uc3QgRFlOQU1JQyA9IEJvZHkuRFlOQU1JQzsKICAgICAgbGV0IHByb2ZpbGluZ1N0YXJ0ID0gLUluZmluaXR5OwogICAgICBjb25zdCBjb25zdHJhaW50cyA9IHRoaXMuY29uc3RyYWludHM7CiAgICAgIGNvbnN0IGZyaWN0aW9uRXF1YXRpb25Qb29sID0gV29ybGRfc3RlcF9mcmljdGlvbkVxdWF0aW9uUG9vbDsKICAgICAgZ3Jhdml0eS5sZW5ndGgoKTsKICAgICAgY29uc3QgZ3ggPSBncmF2aXR5Lng7CiAgICAgIGNvbnN0IGd5ID0gZ3Jhdml0eS55OwogICAgICBjb25zdCBneiA9IGdyYXZpdHkuejsKICAgICAgbGV0IGkgPSAwOwoKICAgICAgaWYgKGRvUHJvZmlsaW5nKSB7CiAgICAgICAgcHJvZmlsaW5nU3RhcnQgPSBwZXJmb3JtYW5jZS5ub3coKTsKICAgICAgfSAvLyBBZGQgZ3Jhdml0eSB0byBhbGwgb2JqZWN0cwoKCiAgICAgIGZvciAoaSA9IDA7IGkgIT09IE47IGkrKykgewogICAgICAgIGNvbnN0IGJpID0gYm9kaWVzW2ldOwoKICAgICAgICBpZiAoYmkudHlwZSA9PT0gRFlOQU1JQykgewogICAgICAgICAgLy8gT25seSBmb3IgZHluYW1pYyBib2RpZXMKICAgICAgICAgIGNvbnN0IGYgPSBiaS5mb3JjZTsKICAgICAgICAgIGNvbnN0IG0gPSBiaS5tYXNzOwogICAgICAgICAgZi54ICs9IG0gKiBneDsKICAgICAgICAgIGYueSArPSBtICogZ3k7CiAgICAgICAgICBmLnogKz0gbSAqIGd6OwogICAgICAgIH0KICAgICAgfSAvLyBVcGRhdGUgc3Vic3lzdGVtcwoKCiAgICAgIGZvciAobGV0IGkgPSAwLCBOc3Vic3lzdGVtcyA9IHRoaXMuc3Vic3lzdGVtcy5sZW5ndGg7IGkgIT09IE5zdWJzeXN0ZW1zOyBpKyspIHsKICAgICAgICB0aGlzLnN1YnN5c3RlbXNbaV0udXBkYXRlKCk7CiAgICAgIH0gLy8gQ29sbGlzaW9uIGRldGVjdGlvbgoKCiAgICAgIGlmIChkb1Byb2ZpbGluZykgewogICAgICAgIHByb2ZpbGluZ1N0YXJ0ID0gcGVyZm9ybWFuY2Uubm93KCk7CiAgICAgIH0KCiAgICAgIHAxLmxlbmd0aCA9IDA7IC8vIENsZWFuIHVwIHBhaXIgYXJyYXlzIGZyb20gbGFzdCBzdGVwCgogICAgICBwMi5sZW5ndGggPSAwOwogICAgICB0aGlzLmJyb2FkcGhhc2UuY29sbGlzaW9uUGFpcnModGhpcywgcDEsIHAyKTsKCiAgICAgIGlmIChkb1Byb2ZpbGluZykgewogICAgICAgIHByb2ZpbGUuYnJvYWRwaGFzZSA9IHBlcmZvcm1hbmNlLm5vdygpIC0gcHJvZmlsaW5nU3RhcnQ7CiAgICAgIH0gLy8gUmVtb3ZlIGNvbnN0cmFpbmVkIHBhaXJzIHdpdGggY29sbGlkZUNvbm5lY3RlZCA9PSBmYWxzZQoKCiAgICAgIGxldCBOY29uc3RyYWludHMgPSBjb25zdHJhaW50cy5sZW5ndGg7CgogICAgICBmb3IgKGkgPSAwOyBpICE9PSBOY29uc3RyYWludHM7IGkrKykgewogICAgICAgIGNvbnN0IGMgPSBjb25zdHJhaW50c1tpXTsKCiAgICAgICAgaWYgKCFjLmNvbGxpZGVDb25uZWN0ZWQpIHsKICAgICAgICAgIGZvciAobGV0IGogPSBwMS5sZW5ndGggLSAxOyBqID49IDA7IGogLT0gMSkgewogICAgICAgICAgICBpZiAoYy5ib2R5QSA9PT0gcDFbal0gJiYgYy5ib2R5QiA9PT0gcDJbal0gfHwgYy5ib2R5QiA9PT0gcDFbal0gJiYgYy5ib2R5QSA9PT0gcDJbal0pIHsKICAgICAgICAgICAgICBwMS5zcGxpY2UoaiwgMSk7CiAgICAgICAgICAgICAgcDIuc3BsaWNlKGosIDEpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICB0aGlzLmNvbGxpc2lvbk1hdHJpeFRpY2soKTsgLy8gR2VuZXJhdGUgY29udGFjdHMKCiAgICAgIGlmIChkb1Byb2ZpbGluZykgewogICAgICAgIHByb2ZpbGluZ1N0YXJ0ID0gcGVyZm9ybWFuY2Uubm93KCk7CiAgICAgIH0KCiAgICAgIGNvbnN0IG9sZGNvbnRhY3RzID0gV29ybGRfc3RlcF9vbGRDb250YWN0czsKICAgICAgY29uc3QgTm9sZENvbnRhY3RzID0gY29udGFjdHMubGVuZ3RoOwoKICAgICAgZm9yIChpID0gMDsgaSAhPT0gTm9sZENvbnRhY3RzOyBpKyspIHsKICAgICAgICBvbGRjb250YWN0cy5wdXNoKGNvbnRhY3RzW2ldKTsKICAgICAgfQoKICAgICAgY29udGFjdHMubGVuZ3RoID0gMDsgLy8gVHJhbnNmZXIgRnJpY3Rpb25FcXVhdGlvbiBmcm9tIGN1cnJlbnQgbGlzdCB0byB0aGUgcG9vbCBmb3IgcmV1c2UKCiAgICAgIGNvbnN0IE5vbGRGcmljdGlvbkVxdWF0aW9ucyA9IHRoaXMuZnJpY3Rpb25FcXVhdGlvbnMubGVuZ3RoOwoKICAgICAgZm9yIChpID0gMDsgaSAhPT0gTm9sZEZyaWN0aW9uRXF1YXRpb25zOyBpKyspIHsKICAgICAgICBmcmljdGlvbkVxdWF0aW9uUG9vbC5wdXNoKHRoaXMuZnJpY3Rpb25FcXVhdGlvbnNbaV0pOwogICAgICB9CgogICAgICB0aGlzLmZyaWN0aW9uRXF1YXRpb25zLmxlbmd0aCA9IDA7CiAgICAgIHRoaXMubmFycm93cGhhc2UuZ2V0Q29udGFjdHMocDEsIHAyLCB0aGlzLCBjb250YWN0cywgb2xkY29udGFjdHMsIC8vIFRvIGJlIHJldXNlZAogICAgICB0aGlzLmZyaWN0aW9uRXF1YXRpb25zLCBmcmljdGlvbkVxdWF0aW9uUG9vbCk7CgogICAgICBpZiAoZG9Qcm9maWxpbmcpIHsKICAgICAgICBwcm9maWxlLm5hcnJvd3BoYXNlID0gcGVyZm9ybWFuY2Uubm93KCkgLSBwcm9maWxpbmdTdGFydDsKICAgICAgfSAvLyBMb29wIG92ZXIgYWxsIGNvbGxpc2lvbnMKCgogICAgICBpZiAoZG9Qcm9maWxpbmcpIHsKICAgICAgICBwcm9maWxpbmdTdGFydCA9IHBlcmZvcm1hbmNlLm5vdygpOwogICAgICB9IC8vIEFkZCBhbGwgZnJpY3Rpb24gZXFzCgoKICAgICAgZm9yIChpID0gMDsgaSA8IHRoaXMuZnJpY3Rpb25FcXVhdGlvbnMubGVuZ3RoOyBpKyspIHsKICAgICAgICBzb2x2ZXIuYWRkRXF1YXRpb24odGhpcy5mcmljdGlvbkVxdWF0aW9uc1tpXSk7CiAgICAgIH0KCiAgICAgIGNvbnN0IG5jb250YWN0cyA9IGNvbnRhY3RzLmxlbmd0aDsKCiAgICAgIGZvciAobGV0IGsgPSAwOyBrICE9PSBuY29udGFjdHM7IGsrKykgewogICAgICAgIC8vIEN1cnJlbnQgY29udGFjdAogICAgICAgIGNvbnN0IGMgPSBjb250YWN0c1trXTsgLy8gR2V0IGN1cnJlbnQgY29sbGlzaW9uIGluZGVjZXMKCiAgICAgICAgY29uc3QgYmkgPSBjLmJpOwogICAgICAgIGNvbnN0IGJqID0gYy5iajsKICAgICAgICBjb25zdCBzaSA9IGMuc2k7CiAgICAgICAgY29uc3Qgc2ogPSBjLnNqOyAvLyBHZXQgY29sbGlzaW9uIHByb3BlcnRpZXMKCiAgICAgICAgbGV0IGNtOwoKICAgICAgICBpZiAoYmkubWF0ZXJpYWwgJiYgYmoubWF0ZXJpYWwpIHsKICAgICAgICAgIGNtID0gdGhpcy5nZXRDb250YWN0TWF0ZXJpYWwoYmkubWF0ZXJpYWwsIGJqLm1hdGVyaWFsKSB8fCB0aGlzLmRlZmF1bHRDb250YWN0TWF0ZXJpYWw7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNtID0gdGhpcy5kZWZhdWx0Q29udGFjdE1hdGVyaWFsOwogICAgICAgIH0gLy8gYy5lbmFibGVkID0gYmkuY29sbGlzaW9uUmVzcG9uc2UgJiYgYmouY29sbGlzaW9uUmVzcG9uc2UgJiYgc2kuY29sbGlzaW9uUmVzcG9uc2UgJiYgc2ouY29sbGlzaW9uUmVzcG9uc2U7CgoKICAgICAgICBjbS5mcmljdGlvbjsgLy8gYy5yZXN0aXR1dGlvbiA9IGNtLnJlc3RpdHV0aW9uOwogICAgICAgIC8vIElmIGZyaWN0aW9uIG9yIHJlc3RpdHV0aW9uIHdlcmUgc3BlY2lmaWVkIGluIHRoZSBtYXRlcmlhbCwgdXNlIHRoZW0KCiAgICAgICAgaWYgKGJpLm1hdGVyaWFsICYmIGJqLm1hdGVyaWFsKSB7CiAgICAgICAgICBpZiAoYmkubWF0ZXJpYWwuZnJpY3Rpb24gPj0gMCAmJiBiai5tYXRlcmlhbC5mcmljdGlvbiA+PSAwKSB7CiAgICAgICAgICAgIGJpLm1hdGVyaWFsLmZyaWN0aW9uICogYmoubWF0ZXJpYWwuZnJpY3Rpb247CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGJpLm1hdGVyaWFsLnJlc3RpdHV0aW9uID49IDAgJiYgYmoubWF0ZXJpYWwucmVzdGl0dXRpb24gPj0gMCkgewogICAgICAgICAgICBjLnJlc3RpdHV0aW9uID0gYmkubWF0ZXJpYWwucmVzdGl0dXRpb24gKiBiai5tYXRlcmlhbC5yZXN0aXR1dGlvbjsKICAgICAgICAgIH0KICAgICAgICB9IC8vIGMuc2V0U3Bvb2tQYXJhbXMoCiAgICAgICAgLy8gICAgICAgICAgIGNtLmNvbnRhY3RFcXVhdGlvblN0aWZmbmVzcywKICAgICAgICAvLyAgICAgICAgICAgY20uY29udGFjdEVxdWF0aW9uUmVsYXhhdGlvbiwKICAgICAgICAvLyAgICAgICAgICAgZHQKICAgICAgICAvLyAgICAgICApOwoKCiAgICAgICAgc29sdmVyLmFkZEVxdWF0aW9uKGMpOyAvLyAvLyBBZGQgZnJpY3Rpb24gY29uc3RyYWludCBlcXVhdGlvbgogICAgICAgIC8vIGlmKG11ID4gMCl7CiAgICAgICAgLy8gCS8vIENyZWF0ZSAyIHRhbmdlbnQgZXF1YXRpb25zCiAgICAgICAgLy8gCWNvbnN0IG11ZyA9IG11ICogZ25vcm07CiAgICAgICAgLy8gCWNvbnN0IHJlZHVjZWRNYXNzID0gKGJpLmludk1hc3MgKyBiai5pbnZNYXNzKTsKICAgICAgICAvLyAJaWYocmVkdWNlZE1hc3MgPiAwKXsKICAgICAgICAvLyAJCXJlZHVjZWRNYXNzID0gMS9yZWR1Y2VkTWFzczsKICAgICAgICAvLyAJfQogICAgICAgIC8vIAljb25zdCBwb29sID0gZnJpY3Rpb25FcXVhdGlvblBvb2w7CiAgICAgICAgLy8gCWNvbnN0IGMxID0gcG9vbC5sZW5ndGggPyBwb29sLnBvcCgpIDogbmV3IEZyaWN0aW9uRXF1YXRpb24oYmksYmosbXVnKnJlZHVjZWRNYXNzKTsKICAgICAgICAvLyAJY29uc3QgYzIgPSBwb29sLmxlbmd0aCA/IHBvb2wucG9wKCkgOiBuZXcgRnJpY3Rpb25FcXVhdGlvbihiaSxiaixtdWcqcmVkdWNlZE1hc3MpOwogICAgICAgIC8vIAl0aGlzLmZyaWN0aW9uRXF1YXRpb25zLnB1c2goYzEsIGMyKTsKICAgICAgICAvLyAJYzEuYmkgPSBjMi5iaSA9IGJpOwogICAgICAgIC8vIAljMS5iaiA9IGMyLmJqID0gYmo7CiAgICAgICAgLy8gCWMxLm1pbkZvcmNlID0gYzIubWluRm9yY2UgPSAtbXVnKnJlZHVjZWRNYXNzOwogICAgICAgIC8vIAljMS5tYXhGb3JjZSA9IGMyLm1heEZvcmNlID0gbXVnKnJlZHVjZWRNYXNzOwogICAgICAgIC8vIAkvLyBDb3B5IG92ZXIgdGhlIHJlbGF0aXZlIHZlY3RvcnMKICAgICAgICAvLyAJYzEucmkuY29weShjLnJpKTsKICAgICAgICAvLyAJYzEucmouY29weShjLnJqKTsKICAgICAgICAvLyAJYzIucmkuY29weShjLnJpKTsKICAgICAgICAvLyAJYzIucmouY29weShjLnJqKTsKICAgICAgICAvLyAJLy8gQ29uc3RydWN0IHRhbmdlbnRzCiAgICAgICAgLy8gCWMubmkudGFuZ2VudHMoYzEudCwgYzIudCk7CiAgICAgICAgLy8gICAgICAgICAgIC8vIFNldCBzcG9vayBwYXJhbXMKICAgICAgICAvLyAgICAgICAgICAgYzEuc2V0U3Bvb2tQYXJhbXMoY20uZnJpY3Rpb25FcXVhdGlvblN0aWZmbmVzcywgY20uZnJpY3Rpb25FcXVhdGlvblJlbGF4YXRpb24sIGR0KTsKICAgICAgICAvLyAgICAgICAgICAgYzIuc2V0U3Bvb2tQYXJhbXMoY20uZnJpY3Rpb25FcXVhdGlvblN0aWZmbmVzcywgY20uZnJpY3Rpb25FcXVhdGlvblJlbGF4YXRpb24sIGR0KTsKICAgICAgICAvLyAgICAgICAgICAgYzEuZW5hYmxlZCA9IGMyLmVuYWJsZWQgPSBjLmVuYWJsZWQ7CiAgICAgICAgLy8gCS8vIEFkZCBlcXVhdGlvbnMgdG8gc29sdmVyCiAgICAgICAgLy8gCXNvbHZlci5hZGRFcXVhdGlvbihjMSk7CiAgICAgICAgLy8gCXNvbHZlci5hZGRFcXVhdGlvbihjMik7CiAgICAgICAgLy8gfQoKICAgICAgICBpZiAoYmkuYWxsb3dTbGVlcCAmJiBiaS50eXBlID09PSBCb2R5LkRZTkFNSUMgJiYgYmkuc2xlZXBTdGF0ZSA9PT0gQm9keS5TTEVFUElORyAmJiBiai5zbGVlcFN0YXRlID09PSBCb2R5LkFXQUtFICYmIGJqLnR5cGUgIT09IEJvZHkuU1RBVElDKSB7CiAgICAgICAgICBjb25zdCBzcGVlZFNxdWFyZWRCID0gYmoudmVsb2NpdHkubGVuZ3RoU3F1YXJlZCgpICsgYmouYW5ndWxhclZlbG9jaXR5Lmxlbmd0aFNxdWFyZWQoKTsKICAgICAgICAgIGNvbnN0IHNwZWVkTGltaXRTcXVhcmVkQiA9IGJqLnNsZWVwU3BlZWRMaW1pdCAqKiAyOwoKICAgICAgICAgIGlmIChzcGVlZFNxdWFyZWRCID49IHNwZWVkTGltaXRTcXVhcmVkQiAqIDIpIHsKICAgICAgICAgICAgYmkud2FrZVVwQWZ0ZXJOYXJyb3dwaGFzZSA9IHRydWU7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAoYmouYWxsb3dTbGVlcCAmJiBiai50eXBlID09PSBCb2R5LkRZTkFNSUMgJiYgYmouc2xlZXBTdGF0ZSA9PT0gQm9keS5TTEVFUElORyAmJiBiaS5zbGVlcFN0YXRlID09PSBCb2R5LkFXQUtFICYmIGJpLnR5cGUgIT09IEJvZHkuU1RBVElDKSB7CiAgICAgICAgICBjb25zdCBzcGVlZFNxdWFyZWRBID0gYmkudmVsb2NpdHkubGVuZ3RoU3F1YXJlZCgpICsgYmkuYW5ndWxhclZlbG9jaXR5Lmxlbmd0aFNxdWFyZWQoKTsKICAgICAgICAgIGNvbnN0IHNwZWVkTGltaXRTcXVhcmVkQSA9IGJpLnNsZWVwU3BlZWRMaW1pdCAqKiAyOwoKICAgICAgICAgIGlmIChzcGVlZFNxdWFyZWRBID49IHNwZWVkTGltaXRTcXVhcmVkQSAqIDIpIHsKICAgICAgICAgICAgYmoud2FrZVVwQWZ0ZXJOYXJyb3dwaGFzZSA9IHRydWU7CiAgICAgICAgICB9CiAgICAgICAgfSAvLyBOb3cgd2Uga25vdyB0aGF0IGkgYW5kIGogYXJlIGluIGNvbnRhY3QuIFNldCBjb2xsaXNpb24gbWF0cml4IHN0YXRlCgoKICAgICAgICB0aGlzLmNvbGxpc2lvbk1hdHJpeC5zZXQoYmksIGJqLCB0cnVlKTsKCiAgICAgICAgaWYgKCF0aGlzLmNvbGxpc2lvbk1hdHJpeFByZXZpb3VzLmdldChiaSwgYmopKSB7CiAgICAgICAgICAvLyBGaXJzdCBjb250YWN0IQogICAgICAgICAgLy8gV2UgcmV1c2UgdGhlIGNvbGxpZGVFdmVudCBvYmplY3QsIG90aGVyd2lzZSB3ZSB3aWxsIGVuZCB1cCBjcmVhdGluZyBuZXcgb2JqZWN0cyBmb3IgZWFjaCBuZXcgY29udGFjdCwgZXZlbiBpZiB0aGVyZSdzIG5vIGV2ZW50IGxpc3RlbmVyIGF0dGFjaGVkLgogICAgICAgICAgV29ybGRfc3RlcF9jb2xsaWRlRXZlbnQuYm9keSA9IGJqOwogICAgICAgICAgV29ybGRfc3RlcF9jb2xsaWRlRXZlbnQuY29udGFjdCA9IGM7CiAgICAgICAgICBiaS5kaXNwYXRjaEV2ZW50KFdvcmxkX3N0ZXBfY29sbGlkZUV2ZW50KTsKICAgICAgICAgIFdvcmxkX3N0ZXBfY29sbGlkZUV2ZW50LmJvZHkgPSBiaTsKICAgICAgICAgIGJqLmRpc3BhdGNoRXZlbnQoV29ybGRfc3RlcF9jb2xsaWRlRXZlbnQpOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5ib2R5T3ZlcmxhcEtlZXBlci5zZXQoYmkuaWQsIGJqLmlkKTsKICAgICAgICB0aGlzLnNoYXBlT3ZlcmxhcEtlZXBlci5zZXQoc2kuaWQsIHNqLmlkKTsKICAgICAgfQoKICAgICAgdGhpcy5lbWl0Q29udGFjdEV2ZW50cygpOwoKICAgICAgaWYgKGRvUHJvZmlsaW5nKSB7CiAgICAgICAgcHJvZmlsZS5tYWtlQ29udGFjdENvbnN0cmFpbnRzID0gcGVyZm9ybWFuY2Uubm93KCkgLSBwcm9maWxpbmdTdGFydDsKICAgICAgICBwcm9maWxpbmdTdGFydCA9IHBlcmZvcm1hbmNlLm5vdygpOwogICAgICB9IC8vIFdha2UgdXAgYm9kaWVzCgoKICAgICAgZm9yIChpID0gMDsgaSAhPT0gTjsgaSsrKSB7CiAgICAgICAgY29uc3QgYmkgPSBib2RpZXNbaV07CgogICAgICAgIGlmIChiaS53YWtlVXBBZnRlck5hcnJvd3BoYXNlKSB7CiAgICAgICAgICBiaS53YWtlVXAoKTsKICAgICAgICAgIGJpLndha2VVcEFmdGVyTmFycm93cGhhc2UgPSBmYWxzZTsKICAgICAgICB9CiAgICAgIH0gLy8gQWRkIHVzZXItYWRkZWQgY29uc3RyYWludHMKCgogICAgICBOY29uc3RyYWludHMgPSBjb25zdHJhaW50cy5sZW5ndGg7CgogICAgICBmb3IgKGkgPSAwOyBpICE9PSBOY29uc3RyYWludHM7IGkrKykgewogICAgICAgIGNvbnN0IGMgPSBjb25zdHJhaW50c1tpXTsKICAgICAgICBjLnVwZGF0ZSgpOwoKICAgICAgICBmb3IgKGxldCBqID0gMCwgTmVxID0gYy5lcXVhdGlvbnMubGVuZ3RoOyBqICE9PSBOZXE7IGorKykgewogICAgICAgICAgY29uc3QgZXEgPSBjLmVxdWF0aW9uc1tqXTsKICAgICAgICAgIHNvbHZlci5hZGRFcXVhdGlvbihlcSk7CiAgICAgICAgfQogICAgICB9IC8vIFNvbHZlIHRoZSBjb25zdHJhaW5lZCBzeXN0ZW0KCgogICAgICBzb2x2ZXIuc29sdmUoZHQsIHRoaXMpOwoKICAgICAgaWYgKGRvUHJvZmlsaW5nKSB7CiAgICAgICAgcHJvZmlsZS5zb2x2ZSA9IHBlcmZvcm1hbmNlLm5vdygpIC0gcHJvZmlsaW5nU3RhcnQ7CiAgICAgIH0gLy8gUmVtb3ZlIGFsbCBjb250YWN0cyBmcm9tIHNvbHZlcgoKCiAgICAgIHNvbHZlci5yZW1vdmVBbGxFcXVhdGlvbnMoKTsgLy8gQXBwbHkgZGFtcGluZywgc2VlIGh0dHA6Ly9jb2RlLmdvb2dsZS5jb20vcC9idWxsZXQvaXNzdWVzL2RldGFpbD9pZD03NCBmb3IgZGV0YWlscwoKICAgICAgY29uc3QgcG93ID0gTWF0aC5wb3c7CgogICAgICBmb3IgKGkgPSAwOyBpICE9PSBOOyBpKyspIHsKICAgICAgICBjb25zdCBiaSA9IGJvZGllc1tpXTsKCiAgICAgICAgaWYgKGJpLnR5cGUgJiBEWU5BTUlDKSB7CiAgICAgICAgICAvLyBPbmx5IGZvciBkeW5hbWljIGJvZGllcwogICAgICAgICAgY29uc3QgbGQgPSBwb3coMS4wIC0gYmkubGluZWFyRGFtcGluZywgZHQpOwogICAgICAgICAgY29uc3QgdiA9IGJpLnZlbG9jaXR5OwogICAgICAgICAgdi5zY2FsZShsZCwgdik7CiAgICAgICAgICBjb25zdCBhdiA9IGJpLmFuZ3VsYXJWZWxvY2l0eTsKCiAgICAgICAgICBpZiAoYXYpIHsKICAgICAgICAgICAgY29uc3QgYWQgPSBwb3coMS4wIC0gYmkuYW5ndWxhckRhbXBpbmcsIGR0KTsKICAgICAgICAgICAgYXYuc2NhbGUoYWQsIGF2KTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChXb3JsZF9zdGVwX3ByZVN0ZXBFdmVudCk7IC8vIExlYXAgZnJvZwogICAgICAvLyB2bmV3ID0gdiArIGgqZi9tCiAgICAgIC8vIHhuZXcgPSB4ICsgaCp2bmV3CgogICAgICBpZiAoZG9Qcm9maWxpbmcpIHsKICAgICAgICBwcm9maWxpbmdTdGFydCA9IHBlcmZvcm1hbmNlLm5vdygpOwogICAgICB9CgogICAgICBjb25zdCBzdGVwbnVtYmVyID0gdGhpcy5zdGVwbnVtYmVyOwogICAgICBjb25zdCBxdWF0Tm9ybWFsaXplID0gc3RlcG51bWJlciAlICh0aGlzLnF1YXROb3JtYWxpemVTa2lwICsgMSkgPT09IDA7CiAgICAgIGNvbnN0IHF1YXROb3JtYWxpemVGYXN0ID0gdGhpcy5xdWF0Tm9ybWFsaXplRmFzdDsKCiAgICAgIGZvciAoaSA9IDA7IGkgIT09IE47IGkrKykgewogICAgICAgIGJvZGllc1tpXS5pbnRlZ3JhdGUoZHQsIHF1YXROb3JtYWxpemUsIHF1YXROb3JtYWxpemVGYXN0KTsKICAgICAgfQoKICAgICAgdGhpcy5jbGVhckZvcmNlcygpOwogICAgICB0aGlzLmJyb2FkcGhhc2UuZGlydHkgPSB0cnVlOwoKICAgICAgaWYgKGRvUHJvZmlsaW5nKSB7CiAgICAgICAgcHJvZmlsZS5pbnRlZ3JhdGUgPSBwZXJmb3JtYW5jZS5ub3coKSAtIHByb2ZpbGluZ1N0YXJ0OwogICAgICB9IC8vIFVwZGF0ZSBzdGVwIG51bWJlcgoKCiAgICAgIHRoaXMuc3RlcG51bWJlciArPSAxOwogICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoV29ybGRfc3RlcF9wb3N0U3RlcEV2ZW50KTsgLy8gU2xlZXBpbmcgdXBkYXRlCgogICAgICBsZXQgaGFzQWN0aXZlQm9kaWVzID0gdHJ1ZTsKCiAgICAgIGlmICh0aGlzLmFsbG93U2xlZXApIHsKICAgICAgICBoYXNBY3RpdmVCb2RpZXMgPSBmYWxzZTsKCiAgICAgICAgZm9yIChpID0gMDsgaSAhPT0gTjsgaSsrKSB7CiAgICAgICAgICBjb25zdCBiaSA9IGJvZGllc1tpXTsKICAgICAgICAgIGJpLnNsZWVwVGljayh0aGlzLnRpbWUpOwoKICAgICAgICAgIGlmIChiaS5zbGVlcFN0YXRlICE9PSBCb2R5LlNMRUVQSU5HKSB7CiAgICAgICAgICAgIGhhc0FjdGl2ZUJvZGllcyA9IHRydWU7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICB0aGlzLmhhc0FjdGl2ZUJvZGllcyA9IGhhc0FjdGl2ZUJvZGllczsKICAgIH0KCiAgICBlbWl0Q29udGFjdEV2ZW50cygpIHsKICAgICAgY29uc3QgaGFzQmVnaW5Db250YWN0ID0gdGhpcy5oYXNBbnlFdmVudExpc3RlbmVyKCdiZWdpbkNvbnRhY3QnKTsKICAgICAgY29uc3QgaGFzRW5kQ29udGFjdCA9IHRoaXMuaGFzQW55RXZlbnRMaXN0ZW5lcignZW5kQ29udGFjdCcpOwoKICAgICAgaWYgKGhhc0JlZ2luQ29udGFjdCB8fCBoYXNFbmRDb250YWN0KSB7CiAgICAgICAgdGhpcy5ib2R5T3ZlcmxhcEtlZXBlci5nZXREaWZmKGFkZGl0aW9ucywgcmVtb3ZhbHMpOwogICAgICB9CgogICAgICBpZiAoaGFzQmVnaW5Db250YWN0KSB7CiAgICAgICAgZm9yIChsZXQgaSA9IDAsIGwgPSBhZGRpdGlvbnMubGVuZ3RoOyBpIDwgbDsgaSArPSAyKSB7CiAgICAgICAgICBiZWdpbkNvbnRhY3RFdmVudC5ib2R5QSA9IHRoaXMuZ2V0Qm9keUJ5SWQoYWRkaXRpb25zW2ldKTsKICAgICAgICAgIGJlZ2luQ29udGFjdEV2ZW50LmJvZHlCID0gdGhpcy5nZXRCb2R5QnlJZChhZGRpdGlvbnNbaSArIDFdKTsKICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChiZWdpbkNvbnRhY3RFdmVudCk7CiAgICAgICAgfQoKICAgICAgICBiZWdpbkNvbnRhY3RFdmVudC5ib2R5QSA9IGJlZ2luQ29udGFjdEV2ZW50LmJvZHlCID0gbnVsbDsKICAgICAgfQoKICAgICAgaWYgKGhhc0VuZENvbnRhY3QpIHsKICAgICAgICBmb3IgKGxldCBpID0gMCwgbCA9IHJlbW92YWxzLmxlbmd0aDsgaSA8IGw7IGkgKz0gMikgewogICAgICAgICAgZW5kQ29udGFjdEV2ZW50LmJvZHlBID0gdGhpcy5nZXRCb2R5QnlJZChyZW1vdmFsc1tpXSk7CiAgICAgICAgICBlbmRDb250YWN0RXZlbnQuYm9keUIgPSB0aGlzLmdldEJvZHlCeUlkKHJlbW92YWxzW2kgKyAxXSk7CiAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoZW5kQ29udGFjdEV2ZW50KTsKICAgICAgICB9CgogICAgICAgIGVuZENvbnRhY3RFdmVudC5ib2R5QSA9IGVuZENvbnRhY3RFdmVudC5ib2R5QiA9IG51bGw7CiAgICAgIH0KCiAgICAgIGFkZGl0aW9ucy5sZW5ndGggPSByZW1vdmFscy5sZW5ndGggPSAwOwogICAgICBjb25zdCBoYXNCZWdpblNoYXBlQ29udGFjdCA9IHRoaXMuaGFzQW55RXZlbnRMaXN0ZW5lcignYmVnaW5TaGFwZUNvbnRhY3QnKTsKICAgICAgY29uc3QgaGFzRW5kU2hhcGVDb250YWN0ID0gdGhpcy5oYXNBbnlFdmVudExpc3RlbmVyKCdlbmRTaGFwZUNvbnRhY3QnKTsKCiAgICAgIGlmIChoYXNCZWdpblNoYXBlQ29udGFjdCB8fCBoYXNFbmRTaGFwZUNvbnRhY3QpIHsKICAgICAgICB0aGlzLnNoYXBlT3ZlcmxhcEtlZXBlci5nZXREaWZmKGFkZGl0aW9ucywgcmVtb3ZhbHMpOwogICAgICB9CgogICAgICBpZiAoaGFzQmVnaW5TaGFwZUNvbnRhY3QpIHsKICAgICAgICBmb3IgKGxldCBpID0gMCwgbCA9IGFkZGl0aW9ucy5sZW5ndGg7IGkgPCBsOyBpICs9IDIpIHsKICAgICAgICAgIGNvbnN0IHNoYXBlQSA9IHRoaXMuZ2V0U2hhcGVCeUlkKGFkZGl0aW9uc1tpXSk7CiAgICAgICAgICBjb25zdCBzaGFwZUIgPSB0aGlzLmdldFNoYXBlQnlJZChhZGRpdGlvbnNbaSArIDFdKTsKICAgICAgICAgIGJlZ2luU2hhcGVDb250YWN0RXZlbnQuc2hhcGVBID0gc2hhcGVBOwogICAgICAgICAgYmVnaW5TaGFwZUNvbnRhY3RFdmVudC5zaGFwZUIgPSBzaGFwZUI7CiAgICAgICAgICBpZiAoc2hhcGVBKSBiZWdpblNoYXBlQ29udGFjdEV2ZW50LmJvZHlBID0gc2hhcGVBLmJvZHk7CiAgICAgICAgICBpZiAoc2hhcGVCKSBiZWdpblNoYXBlQ29udGFjdEV2ZW50LmJvZHlCID0gc2hhcGVCLmJvZHk7CiAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoYmVnaW5TaGFwZUNvbnRhY3RFdmVudCk7CiAgICAgICAgfQoKICAgICAgICBiZWdpblNoYXBlQ29udGFjdEV2ZW50LmJvZHlBID0gYmVnaW5TaGFwZUNvbnRhY3RFdmVudC5ib2R5QiA9IGJlZ2luU2hhcGVDb250YWN0RXZlbnQuc2hhcGVBID0gYmVnaW5TaGFwZUNvbnRhY3RFdmVudC5zaGFwZUIgPSBudWxsOwogICAgICB9CgogICAgICBpZiAoaGFzRW5kU2hhcGVDb250YWN0KSB7CiAgICAgICAgZm9yIChsZXQgaSA9IDAsIGwgPSByZW1vdmFscy5sZW5ndGg7IGkgPCBsOyBpICs9IDIpIHsKICAgICAgICAgIGNvbnN0IHNoYXBlQSA9IHRoaXMuZ2V0U2hhcGVCeUlkKHJlbW92YWxzW2ldKTsKICAgICAgICAgIGNvbnN0IHNoYXBlQiA9IHRoaXMuZ2V0U2hhcGVCeUlkKHJlbW92YWxzW2kgKyAxXSk7CiAgICAgICAgICBlbmRTaGFwZUNvbnRhY3RFdmVudC5zaGFwZUEgPSBzaGFwZUE7CiAgICAgICAgICBlbmRTaGFwZUNvbnRhY3RFdmVudC5zaGFwZUIgPSBzaGFwZUI7CiAgICAgICAgICBpZiAoc2hhcGVBKSBlbmRTaGFwZUNvbnRhY3RFdmVudC5ib2R5QSA9IHNoYXBlQS5ib2R5OwogICAgICAgICAgaWYgKHNoYXBlQikgZW5kU2hhcGVDb250YWN0RXZlbnQuYm9keUIgPSBzaGFwZUIuYm9keTsKICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChlbmRTaGFwZUNvbnRhY3RFdmVudCk7CiAgICAgICAgfQoKICAgICAgICBlbmRTaGFwZUNvbnRhY3RFdmVudC5ib2R5QSA9IGVuZFNoYXBlQ29udGFjdEV2ZW50LmJvZHlCID0gZW5kU2hhcGVDb250YWN0RXZlbnQuc2hhcGVBID0gZW5kU2hhcGVDb250YWN0RXZlbnQuc2hhcGVCID0gbnVsbDsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBTZXRzIGFsbCBib2R5IGZvcmNlcyBpbiB0aGUgd29ybGQgdG8gemVyby4KICAgICAqLwoKCiAgICBjbGVhckZvcmNlcygpIHsKICAgICAgY29uc3QgYm9kaWVzID0gdGhpcy5ib2RpZXM7CiAgICAgIGNvbnN0IE4gPSBib2RpZXMubGVuZ3RoOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IE47IGkrKykgewogICAgICAgIGNvbnN0IGIgPSBib2RpZXNbaV07CiAgICAgICAgYi5mb3JjZTsKICAgICAgICBiLnRvcnF1ZTsKICAgICAgICBiLmZvcmNlLnNldCgwLCAwLCAwKTsKICAgICAgICBiLnRvcnF1ZS5zZXQoMCwgMCwgMCk7CiAgICAgIH0KICAgIH0KCiAgfSAvLyBUZW1wIHN0dWZmCgogIG5ldyBBQUJCKCk7CiAgY29uc3QgdG1wUmF5ID0gbmV3IFJheSgpOyAvLyBwZXJmb3JtYW5jZS5ub3coKSBmYWxsYmFjayBvbiBEYXRlLm5vdygpCgogIGNvbnN0IHBlcmZvcm1hbmNlID0gZ2xvYmFsVGhpcy5wZXJmb3JtYW5jZSB8fCB7fTsKCiAgaWYgKCFwZXJmb3JtYW5jZS5ub3cpIHsKICAgIGxldCBub3dPZmZzZXQgPSBEYXRlLm5vdygpOwoKICAgIGlmIChwZXJmb3JtYW5jZS50aW1pbmcgJiYgcGVyZm9ybWFuY2UudGltaW5nLm5hdmlnYXRpb25TdGFydCkgewogICAgICBub3dPZmZzZXQgPSBwZXJmb3JtYW5jZS50aW1pbmcubmF2aWdhdGlvblN0YXJ0OwogICAgfQoKICAgIHBlcmZvcm1hbmNlLm5vdyA9ICgpID0+IERhdGUubm93KCkgLSBub3dPZmZzZXQ7CiAgfQoKICBuZXcgVmVjMygpOyAvLyBEaXNwYXRjaGVkIGFmdGVyIHRoZSB3b3JsZCBoYXMgc3RlcHBlZCBmb3J3YXJkIGluIHRpbWUuCiAgLy8gUmV1c2FibGUgZXZlbnQgb2JqZWN0cyB0byBzYXZlIG1lbW9yeS4KCiAgY29uc3QgV29ybGRfc3RlcF9wb3N0U3RlcEV2ZW50ID0gewogICAgdHlwZTogJ3Bvc3RTdGVwJwogIH07IC8vIERpc3BhdGNoZWQgYmVmb3JlIHRoZSB3b3JsZCBzdGVwcyBmb3J3YXJkIGluIHRpbWUuCgogIGNvbnN0IFdvcmxkX3N0ZXBfcHJlU3RlcEV2ZW50ID0gewogICAgdHlwZTogJ3ByZVN0ZXAnCiAgfTsKICBjb25zdCBXb3JsZF9zdGVwX2NvbGxpZGVFdmVudCA9IHsKICAgIHR5cGU6IEJvZHkuQ09MTElERV9FVkVOVF9OQU1FLAogICAgYm9keTogbnVsbCwKICAgIGNvbnRhY3Q6IG51bGwKICB9OyAvLyBQb29scyBmb3IgdW51c2VkIG9iamVjdHMKCiAgY29uc3QgV29ybGRfc3RlcF9vbGRDb250YWN0cyA9IFtdOwogIGNvbnN0IFdvcmxkX3N0ZXBfZnJpY3Rpb25FcXVhdGlvblBvb2wgPSBbXTsgLy8gUmV1c2FibGUgYXJyYXlzIGZvciBjb2xsaXNpb24gcGFpcnMKCiAgY29uc3QgV29ybGRfc3RlcF9wMSA9IFtdOwogIGNvbnN0IFdvcmxkX3N0ZXBfcDIgPSBbXTsgLy8gU3R1ZmYgZm9yIGVtaXRDb250YWN0RXZlbnRzCgogIGNvbnN0IGFkZGl0aW9ucyA9IFtdOwogIGNvbnN0IHJlbW92YWxzID0gW107CiAgY29uc3QgYmVnaW5Db250YWN0RXZlbnQgPSB7CiAgICB0eXBlOiAnYmVnaW5Db250YWN0JywKICAgIGJvZHlBOiBudWxsLAogICAgYm9keUI6IG51bGwKICB9OwogIGNvbnN0IGVuZENvbnRhY3RFdmVudCA9IHsKICAgIHR5cGU6ICdlbmRDb250YWN0JywKICAgIGJvZHlBOiBudWxsLAogICAgYm9keUI6IG51bGwKICB9OwogIGNvbnN0IGJlZ2luU2hhcGVDb250YWN0RXZlbnQgPSB7CiAgICB0eXBlOiAnYmVnaW5TaGFwZUNvbnRhY3QnLAogICAgYm9keUE6IG51bGwsCiAgICBib2R5QjogbnVsbCwKICAgIHNoYXBlQTogbnVsbCwKICAgIHNoYXBlQjogbnVsbAogIH07CiAgY29uc3QgZW5kU2hhcGVDb250YWN0RXZlbnQgPSB7CiAgICB0eXBlOiAnZW5kU2hhcGVDb250YWN0JywKICAgIGJvZHlBOiBudWxsLAogICAgYm9keUI6IG51bGwsCiAgICBzaGFwZUE6IG51bGwsCiAgICBzaGFwZUI6IG51bGwKICB9OwoKICBjb25zdCBhZGRDb250YWN0TWF0ZXJpYWwgPSAod29ybGQsIGNyZWF0ZU1hdGVyaWFsLCBfcmVmLCB1dWlkKSA9PiB7CiAgICBsZXQgW21hdGVyaWFsQSwgbWF0ZXJpYWxCLCBvcHRpb25zXSA9IF9yZWY7CiAgICBjb25zdCBtYXRBID0gY3JlYXRlTWF0ZXJpYWwobWF0ZXJpYWxBKTsKICAgIGNvbnN0IG1hdEIgPSBjcmVhdGVNYXRlcmlhbChtYXRlcmlhbEIpOwogICAgY29uc3QgY29udGFjdE1hdGVyaWFsID0gbmV3IENvbnRhY3RNYXRlcmlhbChtYXRBLCBtYXRCLCBvcHRpb25zKTsKICAgIGNvbnRhY3RNYXRlcmlhbC51dWlkID0gdXVpZDsKICAgIHdvcmxkLmFkZENvbnRhY3RNYXRlcmlhbChjb250YWN0TWF0ZXJpYWwpOwogIH07CiAgY29uc3QgcmVtb3ZlQ29udGFjdE1hdGVyaWFsID0gKHdvcmxkLCBjbVVVSUQpID0+IHsKICAgIGNvbnN0IGluZGV4ID0gd29ybGQuY29udGFjdG1hdGVyaWFscy5maW5kSW5kZXgoX3JlZjIgPT4gewogICAgICBsZXQgewogICAgICAgIHV1aWQKICAgICAgfSA9IF9yZWYyOwogICAgICByZXR1cm4gdXVpZCA9PT0gY21VVUlEOwogICAgfSk7CiAgICBjb25zdCBbewogICAgICBpZDogaQogICAgfSwgewogICAgICBpZDogagogICAgfV0gPSB3b3JsZC5jb250YWN0bWF0ZXJpYWxzW2luZGV4XS5tYXRlcmlhbHM7CiAgICB3b3JsZC5jb250YWN0bWF0ZXJpYWxzLnNwbGljZShpbmRleCwgMSk7CiAgICBkZWxldGUgd29ybGQuY29udGFjdE1hdGVyaWFsVGFibGUuZGF0YVtpIDwgaiA/IGAke2l9LSR7an1gIDogYCR7an0tJHtpfWBdOwogIH07CgogIGxldCBtYXRlcmlhbElkID0gMDsKICBjb25zdCBjcmVhdGVNYXRlcmlhbEZhY3RvcnkgPSBtYXRlcmlhbHMgPT4gZnVuY3Rpb24gKG5hbWVPck9wdGlvbnMpIHsKICAgIGlmIChuYW1lT3JPcHRpb25zID09PSB2b2lkIDApIHsKICAgICAgbmFtZU9yT3B0aW9ucyA9IHt9OwogICAgfQogICAgY29uc3QgbWF0ZXJpYWxPcHRpb25zID0gdHlwZW9mIG5hbWVPck9wdGlvbnMgPT09ICdzdHJpbmcnID8gewogICAgICBuYW1lOiBuYW1lT3JPcHRpb25zCiAgICB9IDogewogICAgICBuYW1lOiBTeW1ib2wuZm9yKGBNYXRlcmlhbCR7bWF0ZXJpYWxJZCsrfWApLAogICAgICAuLi5uYW1lT3JPcHRpb25zCiAgICB9OwogICAgY29uc3QgewogICAgICBuYW1lCiAgICB9ID0gbWF0ZXJpYWxPcHRpb25zOwogICAgbWF0ZXJpYWxzW25hbWVdID0gbWF0ZXJpYWxzW25hbWVdIHx8IG5ldyBNYXRlcmlhbChtYXRlcmlhbE9wdGlvbnMpOwogICAgcmV0dXJuIG1hdGVyaWFsc1tuYW1lXTsKICB9OwoKICAvKioKICAgKiBAdHlwZWRlZiB7IGltcG9ydCgnY2Fubm9uLWVzJykuTWF0ZXJpYWxPcHRpb25zIH0gTWF0ZXJpYWxPcHRpb25zCiAgICovCgogIGNvbnN0IG1ha2VWZWMzID0gX3JlZiA9PiB7CiAgICBsZXQgW3gsIHksIHpdID0gX3JlZjsKICAgIHJldHVybiBuZXcgVmVjMyh4LCB5LCB6KTsKICB9OwogIGNvbnN0IHByZXBhcmVTcGhlcmUgPSBhcmdzID0+IEFycmF5LmlzQXJyYXkoYXJncykgPyBhcmdzIDogW2FyZ3NdOwogIGNvbnN0IHByZXBhcmVDb252ZXhQb2x5aGVkcm9uID0gX3JlZjIgPT4gewogICAgbGV0IFt2LCBmYWNlcywgbiwgYSwgYm91bmRpbmdTcGhlcmVSYWRpdXNdID0gX3JlZjI7CiAgICByZXR1cm4gW3sKICAgICAgYXhlczogYSA/IGEubWFwKG1ha2VWZWMzKSA6IHVuZGVmaW5lZCwKICAgICAgYm91bmRpbmdTcGhlcmVSYWRpdXMsCiAgICAgIGZhY2VzLAogICAgICBub3JtYWxzOiBuID8gbi5tYXAobWFrZVZlYzMpIDogdW5kZWZpbmVkLAogICAgICB2ZXJ0aWNlczogdiA/IHYubWFwKG1ha2VWZWMzKSA6IHVuZGVmaW5lZAogICAgfV07CiAgfTsKICBmdW5jdGlvbiBjcmVhdGVTaGFwZSh0eXBlLCBhcmdzKSB7CiAgICBzd2l0Y2ggKHR5cGUpIHsKICAgICAgY2FzZSAnQm94JzoKICAgICAgICByZXR1cm4gbmV3IEJveChuZXcgVmVjMyguLi5hcmdzLm1hcCh2ID0+IHYgLyAyKSkpOwogICAgICAvLyBleHRlbnRzID0+IGhhbGZFeHRlbnRzCiAgICAgIGNhc2UgJ0NvbnZleFBvbHloZWRyb24nOgogICAgICAgIHJldHVybiBuZXcgQ29udmV4UG9seWhlZHJvbiguLi5wcmVwYXJlQ29udmV4UG9seWhlZHJvbihhcmdzKSk7CiAgICAgIGNhc2UgJ0N5bGluZGVyJzoKICAgICAgICByZXR1cm4gbmV3IEN5bGluZGVyKC4uLmFyZ3MpOwogICAgICAvLyBbIHJhZGl1c1RvcCwgcmFkaXVzQm90dG9tLCBoZWlnaHQsIG51bVNlZ21lbnRzIF0gPSBhcmdzCiAgICAgIGNhc2UgJ0hlaWdodGZpZWxkJzoKICAgICAgICByZXR1cm4gbmV3IEhlaWdodGZpZWxkKC4uLmFyZ3MpOwogICAgICAvLyBbIEFycmF5IGRhdGEsIG9wdGlvbnM6IHttaW5WYWx1ZSwgbWF4VmFsdWUsIGVsZW1lbnRTaXplfSAgXSA9IGFyZ3MKICAgICAgY2FzZSAnUGFydGljbGUnOgogICAgICAgIHJldHVybiBuZXcgUGFydGljbGUoKTsKICAgICAgLy8gbm8gYXJncwogICAgICBjYXNlICdQbGFuZSc6CiAgICAgICAgcmV0dXJuIG5ldyBQbGFuZSgpOwogICAgICAvLyBubyBhcmdzLCBpbmZpbml0ZSB4IGFuZCB5CiAgICAgIGNhc2UgJ1NwaGVyZSc6CiAgICAgICAgcmV0dXJuIG5ldyBTcGhlcmUoLi4ucHJlcGFyZVNwaGVyZShhcmdzKSk7CiAgICAgIC8vIHJhZGl1cyA9IGFyZ3MKICAgICAgY2FzZSAnVHJpbWVzaCc6CiAgICAgICAgcmV0dXJuIG5ldyBUcmltZXNoKC4uLmFyZ3MpOwogICAgICAvLyBbdmVydGljZXMsIGluZGljZXNdID0gYXJncwogICAgfQogIH0KCiAgLyoqCiAgICogQHBhcmFtIHtUSFJFRS5RdWF0ZXJuaW9ufSB0YXJnZXQKICAgKiBAcGFyYW0ge3sgcm90YXRpb24/OiBUSFJFRS5WZWN0b3IzVHVwbGUgcXVhdGVybmlvbj86IFRIUkVFLlZlY3RvcjRUdXBsZSB9fSBwcm9wcwogICAqIEByZXR1cm5zIHtUSFJFRS5RdWF0ZXJuaW9ufQogICAqLwogIGNvbnN0IHNldFF1YXRlcm5pb24gPSAodGFyZ2V0LCBfcmVmMykgPT4gewogICAgbGV0IHsKICAgICAgcXVhdGVybmlvbiwKICAgICAgcm90YXRpb24KICAgIH0gPSBfcmVmMzsKICAgIGlmIChxdWF0ZXJuaW9uKSB7CiAgICAgIHRhcmdldC5zZXQoLi4ucXVhdGVybmlvbik7CiAgICB9IGVsc2UgaWYgKHJvdGF0aW9uKSB7CiAgICAgIHRhcmdldC5zZXRGcm9tRXVsZXIoLi4ucm90YXRpb24pOwogICAgfQogICAgcmV0dXJuIHRhcmdldDsKICB9OwoKICAvKioKICAgKiBAZnVuY3Rpb24KICAgKiBAcGFyYW0ge09iamVjdH0gb3B0aW9ucwogICAqIEBwYXJhbSB7c3RyaW5nfSBvcHRpb25zLnV1aWQKICAgKiBAcGFyYW0ge0JvZHlQcm9wc30gb3B0aW9ucy5wcm9wcwogICAqIEBwYXJhbSB7Qm9keVNoYXBlVHlwZX0gb3B0aW9ucy50eXBlCiAgICogQHBhcmFtIHsobWF0ZXJpYWxPcHRpb25zOiBNYXRlcmlhbE9wdGlvbnMpID0+IE1hdGVyaWFsID19IG9wdGlvbnMuY3JlYXRlTWF0ZXJpYWwKICAgKiBAcmV0dXJucyB7Qm9keX0KICAgKi8KICBjb25zdCBwcm9wc1RvQm9keSA9IG9wdGlvbnMgPT4gewogICAgY29uc3QgewogICAgICB1dWlkLAogICAgICBwcm9wcywKICAgICAgdHlwZSwKICAgICAgY3JlYXRlTWF0ZXJpYWwgPSBtYXRlcmlhbE9wdGlvbnMgPT4gbmV3IE1hdGVyaWFsKG1hdGVyaWFsT3B0aW9ucykKICAgIH0gPSBvcHRpb25zOwogICAgY29uc3QgewogICAgICBhbmd1bGFyRmFjdG9yID0gWzEsIDEsIDFdLAogICAgICBhbmd1bGFyVmVsb2NpdHkgPSBbMCwgMCwgMF0sCiAgICAgIGFyZ3MgPSBbXSwKICAgICAgY29sbGlzaW9uUmVzcG9uc2UsCiAgICAgIGxpbmVhckZhY3RvciA9IFsxLCAxLCAxXSwKICAgICAgbWFzcywKICAgICAgbWF0ZXJpYWwsCiAgICAgIG9uQ29sbGlkZSwKICAgICAgcG9zaXRpb24gPSBbMCwgMCwgMF0sCiAgICAgIHJvdGF0aW9uLAogICAgICBxdWF0ZXJuaW9uLAogICAgICBzaGFwZXMsCiAgICAgIHR5cGU6IGJvZHlUeXBlLAogICAgICB2ZWxvY2l0eSA9IFswLCAwLCAwXSwKICAgICAgLi4uZXh0cmEKICAgIH0gPSBwcm9wczsKICAgIGNvbnN0IGJvZHkgPSBuZXcgQm9keSh7CiAgICAgIC4uLmV4dHJhLAogICAgICBtYXNzOiBib2R5VHlwZSA9PT0gJ1N0YXRpYycgPyAwIDogbWFzcywKICAgICAgbWF0ZXJpYWw6IG1hdGVyaWFsID8gY3JlYXRlTWF0ZXJpYWwobWF0ZXJpYWwpIDogdW5kZWZpbmVkLAogICAgICB0eXBlOiBib2R5VHlwZSA/IEJvZHlbYm9keVR5cGUudG9VcHBlckNhc2UoKV0gOiB1bmRlZmluZWQKICAgIH0pOwogICAgYm9keS51dWlkID0gdXVpZDsKICAgIGlmIChjb2xsaXNpb25SZXNwb25zZSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgIGJvZHkuY29sbGlzaW9uUmVzcG9uc2UgPSBjb2xsaXNpb25SZXNwb25zZTsKICAgIH0KICAgIGlmICh0eXBlID09PSAnQ29tcG91bmQnKSB7CiAgICAgIHNoYXBlcy5mb3JFYWNoKF9yZWY0ID0+IHsKICAgICAgICBsZXQgewogICAgICAgICAgdHlwZSwKICAgICAgICAgIGFyZ3MsCiAgICAgICAgICBwb3NpdGlvbiwKICAgICAgICAgIHJvdGF0aW9uLAogICAgICAgICAgcXVhdGVybmlvbiwKICAgICAgICAgIG1hdGVyaWFsLAogICAgICAgICAgLi4uZXh0cmEKICAgICAgICB9ID0gX3JlZjQ7CiAgICAgICAgY29uc3Qgc2hhcGVCb2R5ID0gYm9keS5hZGRTaGFwZShjcmVhdGVTaGFwZSh0eXBlLCBhcmdzKSwgcG9zaXRpb24gPyBuZXcgVmVjMyguLi5wb3NpdGlvbikgOiB1bmRlZmluZWQsIHNldFF1YXRlcm5pb24obmV3IFF1YXRlcm5pb24oMCwgMCwgMCwgMSksIHsKICAgICAgICAgIHF1YXRlcm5pb24sCiAgICAgICAgICByb3RhdGlvbgogICAgICAgIH0pKTsKICAgICAgICBpZiAobWF0ZXJpYWwpIHNoYXBlQm9keS5tYXRlcmlhbCA9IGNyZWF0ZU1hdGVyaWFsKG1hdGVyaWFsKTsKICAgICAgICBPYmplY3QuYXNzaWduKHNoYXBlQm9keSwgZXh0cmEpOwogICAgICB9KTsKICAgIH0gZWxzZSB7CiAgICAgIGJvZHkuYWRkU2hhcGUoY3JlYXRlU2hhcGUodHlwZSwgYXJncykpOwogICAgfQogICAgYm9keS5wb3NpdGlvbi5zZXQocG9zaXRpb25bMF0sIHBvc2l0aW9uWzFdLCBwb3NpdGlvblsyXSk7CiAgICBib2R5LnZlbG9jaXR5LnNldCh2ZWxvY2l0eVswXSwgdmVsb2NpdHlbMV0sIHZlbG9jaXR5WzJdKTsKICAgIGJvZHkuYW5ndWxhclZlbG9jaXR5LnNldChhbmd1bGFyVmVsb2NpdHlbMF0sIGFuZ3VsYXJWZWxvY2l0eVsxXSwgYW5ndWxhclZlbG9jaXR5WzJdKTsKICAgIGJvZHkubGluZWFyRmFjdG9yLnNldChsaW5lYXJGYWN0b3JbMF0sIGxpbmVhckZhY3RvclsxXSwgbGluZWFyRmFjdG9yWzJdKTsKICAgIGJvZHkuYW5ndWxhckZhY3Rvci5zZXQoYW5ndWxhckZhY3RvclswXSwgYW5ndWxhckZhY3RvclsxXSwgYW5ndWxhckZhY3RvclsyXSk7CiAgICBzZXRRdWF0ZXJuaW9uKGJvZHkucXVhdGVybmlvbiwgewogICAgICBxdWF0ZXJuaW9uLAogICAgICByb3RhdGlvbgogICAgfSk7CiAgICByZXR1cm4gYm9keTsKICB9OwoKICBjb25zdCBhZGRCb2RpZXMgPSAoc3RhdGUsIGNyZWF0ZU1hdGVyaWFsLCBfcmVmKSA9PiB7CiAgICBsZXQgewogICAgICBwcm9wcywKICAgICAgdHlwZSwKICAgICAgdXVpZAogICAgfSA9IF9yZWY7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHV1aWQubGVuZ3RoOyBpKyspIHsKICAgICAgY29uc3QgYm9keSA9IHByb3BzVG9Cb2R5KHsKICAgICAgICBjcmVhdGVNYXRlcmlhbCwKICAgICAgICBwcm9wczogcHJvcHNbaV0sCiAgICAgICAgdHlwZSwKICAgICAgICB1dWlkOiB1dWlkW2ldCiAgICAgIH0pOwogICAgICBzdGF0ZS53b3JsZC5hZGRCb2R5KGJvZHkpOwogICAgICBpZiAocHJvcHNbaV0ub25Db2xsaWRlKSBib2R5LmFkZEV2ZW50TGlzdGVuZXIoJ2NvbGxpZGUnLCBfcmVmMiA9PiB7CiAgICAgICAgbGV0IHsKICAgICAgICAgIHR5cGUsCiAgICAgICAgICBib2R5LAogICAgICAgICAgdGFyZ2V0LAogICAgICAgICAgY29udGFjdAogICAgICAgIH0gPSBfcmVmMjsKICAgICAgICBpZiAoIWJvZHkudXVpZCB8fCAhdGFyZ2V0LnV1aWQpIHJldHVybjsKICAgICAgICBjb25zdCB7CiAgICAgICAgICBuaSwKICAgICAgICAgIHJpLAogICAgICAgICAgcmosCiAgICAgICAgICBiaSwKICAgICAgICAgIGJqLAogICAgICAgICAgaWQKICAgICAgICB9ID0gY29udGFjdDsKICAgICAgICBjb25zdCBjb250YWN0UG9pbnQgPSBiaS5wb3NpdGlvbi52YWRkKHJpKTsKICAgICAgICBjb25zdCBjb250YWN0Tm9ybWFsID0gYmkgPT09IGJvZHkgPyBuaSA6IG5pLnNjYWxlKC0xKTsKICAgICAgICBzZWxmLnBvc3RNZXNzYWdlKHsKICAgICAgICAgIGJvZHk6IGJvZHkudXVpZCwKICAgICAgICAgIGNvbGxpc2lvbkZpbHRlcnM6IHsKICAgICAgICAgICAgYm9keUZpbHRlckdyb3VwOiBib2R5LmNvbGxpc2lvbkZpbHRlckdyb3VwLAogICAgICAgICAgICBib2R5RmlsdGVyTWFzazogYm9keS5jb2xsaXNpb25GaWx0ZXJNYXNrLAogICAgICAgICAgICB0YXJnZXRGaWx0ZXJHcm91cDogdGFyZ2V0LmNvbGxpc2lvbkZpbHRlckdyb3VwLAogICAgICAgICAgICB0YXJnZXRGaWx0ZXJNYXNrOiB0YXJnZXQuY29sbGlzaW9uRmlsdGVyTWFzawogICAgICAgICAgfSwKICAgICAgICAgIGNvbnRhY3Q6IHsKICAgICAgICAgICAgLy8gQHRzLWV4cGVjdC1lcnJvciBUT0RPOiB1c2UgaWQgaW5zdGVhZCBvZiB1dWlkCiAgICAgICAgICAgIGJpOiBiaS51dWlkLAogICAgICAgICAgICAvLyBAdHMtZXhwZWN0LWVycm9yIFRPRE86IHVzZSBpZCBpbnN0ZWFkIG9mIHV1aWQKICAgICAgICAgICAgYmo6IGJqLnV1aWQsCiAgICAgICAgICAgIC8vIE5vcm1hbCBvZiB0aGUgY29udGFjdCwgcmVsYXRpdmUgdG8gdGhlIGNvbGxpZGluZyBib2R5CiAgICAgICAgICAgIGNvbnRhY3ROb3JtYWw6IGNvbnRhY3ROb3JtYWwudG9BcnJheSgpLAogICAgICAgICAgICAvLyBXb3JsZCBwb3NpdGlvbiBvZiB0aGUgY29udGFjdAogICAgICAgICAgICBjb250YWN0UG9pbnQ6IGNvbnRhY3RQb2ludC50b0FycmF5KCksCiAgICAgICAgICAgIGlkLAogICAgICAgICAgICBpbXBhY3RWZWxvY2l0eTogY29udGFjdC5nZXRJbXBhY3RWZWxvY2l0eUFsb25nTm9ybWFsKCksCiAgICAgICAgICAgIG5pOiBuaS50b0FycmF5KCksCiAgICAgICAgICAgIHJpOiByaS50b0FycmF5KCksCiAgICAgICAgICAgIHJqOiByai50b0FycmF5KCkKICAgICAgICAgIH0sCiAgICAgICAgICBvcDogJ2V2ZW50JywKICAgICAgICAgIHRhcmdldDogdGFyZ2V0LnV1aWQsCiAgICAgICAgICB0eXBlCiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQogIH07CgogIGNvbnN0IHRyaXBsZXRUb1ZlYzMgPSB0ID0+IHQgPyBuZXcgVmVjMyguLi50KSA6IHVuZGVmaW5lZDsKCiAgY29uc3QgYWRkQ29uc3RyYWludCA9IChzdGF0ZSwgX3JlZikgPT4gewogICAgbGV0IHsKICAgICAgcHJvcHM6IFtib2R5QSwgYm9keUIsIHsKICAgICAgICBhbmdsZSwKICAgICAgICBheGlzQSwKICAgICAgICBheGlzQiwKICAgICAgICBjb2xsaWRlQ29ubmVjdGVkLAogICAgICAgIGRpc3RhbmNlLAogICAgICAgIG1heEZvcmNlLAogICAgICAgIG1heE11bHRpcGxpZXIsCiAgICAgICAgcGl2b3RBLAogICAgICAgIHBpdm90QiwKICAgICAgICB0d2lzdEFuZ2xlLAogICAgICAgIHdha2VVcEJvZGllcwogICAgICB9XSwKICAgICAgdHlwZSwKICAgICAgdXVpZAogICAgfSA9IF9yZWY7CiAgICBsZXQgY29uc3RyYWludDsKICAgIHN3aXRjaCAodHlwZSkgewogICAgICBjYXNlICdQb2ludFRvUG9pbnQnOgogICAgICAgIGNvbnN0cmFpbnQgPSBuZXcgUG9pbnRUb1BvaW50Q29uc3RyYWludChzdGF0ZS5ib2RpZXNbYm9keUFdLCB0cmlwbGV0VG9WZWMzKHBpdm90QSksIHN0YXRlLmJvZGllc1tib2R5Ql0sIHRyaXBsZXRUb1ZlYzMocGl2b3RCKSwgbWF4Rm9yY2UpOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdDb25lVHdpc3QnOgogICAgICAgIGNvbnN0cmFpbnQgPSBuZXcgQ29uZVR3aXN0Q29uc3RyYWludChzdGF0ZS5ib2RpZXNbYm9keUFdLCBzdGF0ZS5ib2RpZXNbYm9keUJdLCB7CiAgICAgICAgICBhbmdsZSwKICAgICAgICAgIGF4aXNBOiB0cmlwbGV0VG9WZWMzKGF4aXNBKSwKICAgICAgICAgIGF4aXNCOiB0cmlwbGV0VG9WZWMzKGF4aXNCKSwKICAgICAgICAgIGNvbGxpZGVDb25uZWN0ZWQsCiAgICAgICAgICBtYXhGb3JjZSwKICAgICAgICAgIHBpdm90QTogdHJpcGxldFRvVmVjMyhwaXZvdEEpLAogICAgICAgICAgcGl2b3RCOiB0cmlwbGV0VG9WZWMzKHBpdm90QiksCiAgICAgICAgICB0d2lzdEFuZ2xlCiAgICAgICAgfSk7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ0hpbmdlJzoKICAgICAgICBjb25zdHJhaW50ID0gbmV3IEhpbmdlQ29uc3RyYWludChzdGF0ZS5ib2RpZXNbYm9keUFdLCBzdGF0ZS5ib2RpZXNbYm9keUJdLCB7CiAgICAgICAgICBheGlzQTogdHJpcGxldFRvVmVjMyhheGlzQSksCiAgICAgICAgICBheGlzQjogdHJpcGxldFRvVmVjMyhheGlzQiksCiAgICAgICAgICBjb2xsaWRlQ29ubmVjdGVkLAogICAgICAgICAgbWF4Rm9yY2UsCiAgICAgICAgICBwaXZvdEE6IHRyaXBsZXRUb1ZlYzMocGl2b3RBKSwKICAgICAgICAgIHBpdm90QjogdHJpcGxldFRvVmVjMyhwaXZvdEIpCiAgICAgICAgfSk7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ0Rpc3RhbmNlJzoKICAgICAgICBjb25zdHJhaW50ID0gbmV3IERpc3RhbmNlQ29uc3RyYWludChzdGF0ZS5ib2RpZXNbYm9keUFdLCBzdGF0ZS5ib2RpZXNbYm9keUJdLCBkaXN0YW5jZSwgbWF4Rm9yY2UpOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdMb2NrJzoKICAgICAgICBjb25zdHJhaW50ID0gbmV3IExvY2tDb25zdHJhaW50KHN0YXRlLmJvZGllc1tib2R5QV0sIHN0YXRlLmJvZGllc1tib2R5Ql0sIHsKICAgICAgICAgIG1heEZvcmNlCiAgICAgICAgfSk7CiAgICAgICAgYnJlYWs7CiAgICAgIGRlZmF1bHQ6CiAgICAgICAgY29uc3RyYWludCA9IG5ldyBDb25zdHJhaW50KHN0YXRlLmJvZGllc1tib2R5QV0sIHN0YXRlLmJvZGllc1tib2R5Ql0sIHsKICAgICAgICAgIGNvbGxpZGVDb25uZWN0ZWQsCiAgICAgICAgICB3YWtlVXBCb2RpZXMKICAgICAgICB9KTsKICAgICAgICBicmVhazsKICAgIH0KICAgIGNvbnN0cmFpbnQudXVpZCA9IHV1aWQ7CiAgICBzdGF0ZS53b3JsZC5hZGRDb25zdHJhaW50KGNvbnN0cmFpbnQpOwogICAgaWYgKG1heE11bHRpcGxpZXIgIT09IHVuZGVmaW5lZCkgewogICAgICBjb25zdCBwb3N0U3RlcENvbnN0cmFpbnQgPSAoKSA9PiB7CiAgICAgICAgLy8gVGhlIG11bHRpcGxpZXIgaXMgcHJvcG9ydGlvbmFsIHRvIGhvdyBtdWNoIGZvcmNlIGlzIGFkZGVkIHRvIHRoZSBib2RpZXMgYnkgdGhlIGNvbnN0cmFpbnQuCiAgICAgICAgLy8gSWYgdGhpcyBleGNlZWRzIGEgbGltaXQgdGhlIGNvbnN0cmFpbnQgaXMgZGlzYWJsZWQuCiAgICAgICAgY29uc3QgbXVsdGlwbGllciA9IE1hdGguYWJzKGNvbnN0cmFpbnQuZXF1YXRpb25zWzBdLm11bHRpcGxpZXIpOwogICAgICAgIGlmIChtdWx0aXBsaWVyID4gbWF4TXVsdGlwbGllcikgewogICAgICAgICAgY29uc3RyYWludC5kaXNhYmxlKCk7CiAgICAgICAgfQogICAgICB9OwogICAgICBzdGF0ZS5jb25zdHJhaW50c1t1dWlkXSA9IHBvc3RTdGVwQ29uc3RyYWludDsKICAgICAgc3RhdGUud29ybGQuYWRkRXZlbnRMaXN0ZW5lcigncG9zdFN0ZXAnLCBzdGF0ZS5jb25zdHJhaW50c1t1dWlkXSk7CiAgICB9CiAgfTsKCiAgZnVuY3Rpb24gdG9VcHBlcmNhc2Uoc3RyKSB7CiAgICByZXR1cm4gc3RyLnRvVXBwZXJDYXNlKCk7CiAgfQogIGNvbnN0IGFkZFJheSA9IChzdGF0ZSwgX3JlZikgPT4gewogICAgbGV0IHsKICAgICAgcHJvcHM6IHsKICAgICAgICBmcm9tLAogICAgICAgIG1vZGUsCiAgICAgICAgdG8sCiAgICAgICAgLi4ucmF5T3B0aW9ucwogICAgICB9LAogICAgICB1dWlkCiAgICB9ID0gX3JlZjsKICAgIGNvbnN0IHJheSA9IG5ldyBSYXkodHJpcGxldFRvVmVjMyhmcm9tKSwgdHJpcGxldFRvVmVjMyh0bykpOwogICAgY29uc3Qgb3B0aW9ucyA9IHsKICAgICAgbW9kZTogUkFZX01PREVTW3RvVXBwZXJjYXNlKG1vZGUpXSwKICAgICAgcmVzdWx0OiBuZXcgUmF5Y2FzdFJlc3VsdCgpLAogICAgICAuLi5yYXlPcHRpb25zCiAgICB9OwogICAgc3RhdGUucmF5c1t1dWlkXSA9ICgpID0+IHsKICAgICAgcmF5LmludGVyc2VjdFdvcmxkKHN0YXRlLndvcmxkLCBvcHRpb25zKTsKICAgICAgaWYgKCFvcHRpb25zLnJlc3VsdCB8fCAhb3B0aW9ucy5yZXN1bHQuYm9keSkgcmV0dXJuOwogICAgICBjb25zdCB7CiAgICAgICAgYm9keSwKICAgICAgICBzaGFwZSwKICAgICAgICByYXlGcm9tV29ybGQsCiAgICAgICAgcmF5VG9Xb3JsZCwKICAgICAgICBoaXROb3JtYWxXb3JsZCwKICAgICAgICBoaXRQb2ludFdvcmxkLAogICAgICAgIC4uLnJlc3QKICAgICAgfSA9IG9wdGlvbnMucmVzdWx0OwogICAgICBjb25zdCBib2R5VVVJRCA9IGJvZHkudXVpZDsKICAgICAgaWYgKCFib2R5VVVJRCkgcmV0dXJuOwogICAgICBzZWxmLnBvc3RNZXNzYWdlKHsKICAgICAgICBib2R5OiBib2R5VVVJRCwKICAgICAgICBoaXROb3JtYWxXb3JsZDogaGl0Tm9ybWFsV29ybGQudG9BcnJheSgpLAogICAgICAgIGhpdFBvaW50V29ybGQ6IGhpdFBvaW50V29ybGQudG9BcnJheSgpLAogICAgICAgIG9wOiAnZXZlbnQnLAogICAgICAgIHJheTogewogICAgICAgICAgY29sbGlzaW9uRmlsdGVyR3JvdXA6IHJheS5jb2xsaXNpb25GaWx0ZXJHcm91cCwKICAgICAgICAgIGNvbGxpc2lvbkZpbHRlck1hc2s6IHJheS5jb2xsaXNpb25GaWx0ZXJNYXNrLAogICAgICAgICAgZGlyZWN0aW9uOiByYXkuZGlyZWN0aW9uLnRvQXJyYXkoKSwKICAgICAgICAgIGZyb20sCiAgICAgICAgICB0bywKICAgICAgICAgIHV1aWQKICAgICAgICB9LAogICAgICAgIHJheUZyb21Xb3JsZDogcmF5RnJvbVdvcmxkLnRvQXJyYXkoKSwKICAgICAgICByYXlUb1dvcmxkOiByYXlUb1dvcmxkLnRvQXJyYXkoKSwKICAgICAgICBzaGFwZTogc2hhcGUgPyB7CiAgICAgICAgICAuLi5zaGFwZSwKICAgICAgICAgIGJvZHk6IGJvZHlVVUlECiAgICAgICAgfSA6IG51bGwsCiAgICAgICAgdHlwZTogJ3JheWhpdCcsCiAgICAgICAgLi4ucmVzdAogICAgICB9KTsKICAgIH07CiAgICBzdGF0ZS53b3JsZC5hZGRFdmVudExpc3RlbmVyKCdwcmVTdGVwJywgc3RhdGUucmF5c1t1dWlkXSk7CiAgfTsKCiAgY29uc3QgYWRkUmF5Y2FzdFZlaGljbGUgPSAoc3RhdGUsIGRhdGEpID0+IHsKICAgIGNvbnN0IFtjaGFzc2lzQm9keSwgd2hlZWxzLCB3aGVlbEluZm9zLCBpbmRleEZvcndhcmRBeGlzLCBpbmRleFJpZ2h0QXhpcywgaW5kZXhVcEF4aXNdID0gZGF0YS5wcm9wczsKICAgIGNvbnN0IHZlaGljbGUgPSBuZXcgUmF5Y2FzdFZlaGljbGUoewogICAgICBjaGFzc2lzQm9keTogc3RhdGUuYm9kaWVzW2NoYXNzaXNCb2R5XSwKICAgICAgaW5kZXhGb3J3YXJkQXhpcywKICAgICAgaW5kZXhSaWdodEF4aXMsCiAgICAgIGluZGV4VXBBeGlzCiAgICB9KTsKICAgIHZlaGljbGUud29ybGQgPSBzdGF0ZS53b3JsZDsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgd2hlZWxJbmZvcy5sZW5ndGg7IGkrKykgewogICAgICBjb25zdCB7CiAgICAgICAgYXhsZUxvY2FsLAogICAgICAgIGNoYXNzaXNDb25uZWN0aW9uUG9pbnRMb2NhbCwKICAgICAgICBkaXJlY3Rpb25Mb2NhbCwKICAgICAgICAuLi5yZXN0CiAgICAgIH0gPSB3aGVlbEluZm9zW2ldOwogICAgICB2ZWhpY2xlLmFkZFdoZWVsKHsKICAgICAgICBheGxlTG9jYWw6IHRyaXBsZXRUb1ZlYzMoYXhsZUxvY2FsKSwKICAgICAgICBjaGFzc2lzQ29ubmVjdGlvblBvaW50TG9jYWw6IHRyaXBsZXRUb1ZlYzMoY2hhc3Npc0Nvbm5lY3Rpb25Qb2ludExvY2FsKSwKICAgICAgICBkaXJlY3Rpb25Mb2NhbDogdHJpcGxldFRvVmVjMyhkaXJlY3Rpb25Mb2NhbCksCiAgICAgICAgLi4ucmVzdAogICAgICB9KTsKICAgIH0KICAgIGNvbnN0IHByZVN0ZXAgPSAoKSA9PiB7CiAgICAgIHZlaGljbGUudXBkYXRlVmVoaWNsZShzdGF0ZS53b3JsZC5kdCk7CiAgICB9OwogICAgY29uc3QgcG9zdFN0ZXAgPSAoKSA9PiB7CiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdmVoaWNsZS53aGVlbEluZm9zLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgdmVoaWNsZS51cGRhdGVXaGVlbFRyYW5zZm9ybShpKTsKICAgICAgICBjb25zdCB0ID0gdmVoaWNsZS53aGVlbEluZm9zW2ldLndvcmxkVHJhbnNmb3JtOwogICAgICAgIGNvbnN0IHdoZWVsQm9keSA9IHN0YXRlLmJvZGllc1t3aGVlbHNbaV1dOwogICAgICAgIHdoZWVsQm9keS5wb3NpdGlvbi5jb3B5KHQucG9zaXRpb24pOwogICAgICAgIHdoZWVsQm9keS5xdWF0ZXJuaW9uLmNvcHkodC5xdWF0ZXJuaW9uKTsKICAgICAgfQogICAgfTsKICAgIHN0YXRlLnZlaGljbGVzW2RhdGEudXVpZF0gPSB7CiAgICAgIHBvc3RTdGVwLAogICAgICBwcmVTdGVwLAogICAgICB2ZWhpY2xlCiAgICB9OwogICAgc3RhdGUud29ybGQuYWRkRXZlbnRMaXN0ZW5lcigncHJlU3RlcCcsIHByZVN0ZXApOwogICAgc3RhdGUud29ybGQuYWRkRXZlbnRMaXN0ZW5lcigncG9zdFN0ZXAnLCBwb3N0U3RlcCk7CiAgfTsKCiAgY29uc3QgYWRkU3ByaW5nID0gKHN0YXRlLCBfcmVmKSA9PiB7CiAgICBsZXQgewogICAgICBwcm9wczogW2JvZHlBLCBib2R5QiwgewogICAgICAgIGRhbXBpbmcsCiAgICAgICAgbG9jYWxBbmNob3JBLAogICAgICAgIGxvY2FsQW5jaG9yQiwKICAgICAgICByZXN0TGVuZ3RoLAogICAgICAgIHN0aWZmbmVzcywKICAgICAgICB3b3JsZEFuY2hvckEsCiAgICAgICAgd29ybGRBbmNob3JCCiAgICAgIH1dLAogICAgICB1dWlkCiAgICB9ID0gX3JlZjsKICAgIGNvbnN0IHNwcmluZyA9IG5ldyBTcHJpbmcoc3RhdGUuYm9kaWVzW2JvZHlBXSwgc3RhdGUuYm9kaWVzW2JvZHlCXSwgewogICAgICBkYW1waW5nLAogICAgICBsb2NhbEFuY2hvckE6IHRyaXBsZXRUb1ZlYzMobG9jYWxBbmNob3JBKSwKICAgICAgbG9jYWxBbmNob3JCOiB0cmlwbGV0VG9WZWMzKGxvY2FsQW5jaG9yQiksCiAgICAgIHJlc3RMZW5ndGgsCiAgICAgIHN0aWZmbmVzcywKICAgICAgd29ybGRBbmNob3JBOiB0cmlwbGV0VG9WZWMzKHdvcmxkQW5jaG9yQSksCiAgICAgIHdvcmxkQW5jaG9yQjogdHJpcGxldFRvVmVjMyh3b3JsZEFuY2hvckIpCiAgICB9KTsKICAgIHNwcmluZy51dWlkID0gdXVpZDsKICAgIGNvbnN0IHBvc3RTdGVwU3ByaW5nID0gKCkgPT4gc3ByaW5nLmFwcGx5Rm9yY2UoKTsKICAgIHN0YXRlLnNwcmluZ3NbdXVpZF0gPSBwb3N0U3RlcFNwcmluZzsKICAgIHN0YXRlLnNwcmluZ0luc3RhbmNlc1t1dWlkXSA9IHNwcmluZzsKCiAgICAvLyBDb21wdXRlIHRoZSBmb3JjZSBhZnRlciBlYWNoIHN0ZXAKICAgIHN0YXRlLndvcmxkLmFkZEV2ZW50TGlzdGVuZXIoJ3Bvc3RTdGVwJywgc3RhdGUuc3ByaW5nc1t1dWlkXSk7CiAgfTsKCiAgZnVuY3Rpb24gZW1pdEJlZ2luQ29udGFjdChfcmVmKSB7CiAgICBsZXQgewogICAgICBib2R5QSwKICAgICAgYm9keUIKICAgIH0gPSBfcmVmOwogICAgaWYgKCEoYm9keUEgIT0gbnVsbCAmJiBib2R5QS51dWlkKSB8fCAhKGJvZHlCICE9IG51bGwgJiYgYm9keUIudXVpZCkpIHJldHVybjsKICAgIHNlbGYucG9zdE1lc3NhZ2UoewogICAgICBib2R5QTogYm9keUEudXVpZCwKICAgICAgYm9keUI6IGJvZHlCLnV1aWQsCiAgICAgIG9wOiAnZXZlbnQnLAogICAgICB0eXBlOiAnY29sbGlkZUJlZ2luJwogICAgfSk7CiAgfQogIGZ1bmN0aW9uIGVtaXRFbmRDb250YWN0KF9yZWYyKSB7CiAgICBsZXQgewogICAgICBib2R5QSwKICAgICAgYm9keUIKICAgIH0gPSBfcmVmMjsKICAgIGlmICghKGJvZHlBICE9IG51bGwgJiYgYm9keUEudXVpZCkgfHwgIShib2R5QiAhPSBudWxsICYmIGJvZHlCLnV1aWQpKSByZXR1cm47CiAgICBzZWxmLnBvc3RNZXNzYWdlKHsKICAgICAgYm9keUE6IGJvZHlBLnV1aWQsCiAgICAgIGJvZHlCOiBib2R5Qi51dWlkLAogICAgICBvcDogJ2V2ZW50JywKICAgICAgdHlwZTogJ2NvbGxpZGVFbmQnCiAgICB9KTsKICB9CiAgY29uc3QgaW5pdCA9ICh3b3JsZCwgX3JlZjMpID0+IHsKICAgIGxldCB7CiAgICAgIGFsbG93U2xlZXAsCiAgICAgIGF4aXNJbmRleCA9IDAsCiAgICAgIGJyb2FkcGhhc2UsCiAgICAgIGRlZmF1bHRDb250YWN0TWF0ZXJpYWwsCiAgICAgIGZyaWN0aW9uR3Jhdml0eSwKICAgICAgZ3Jhdml0eSwKICAgICAgaXRlcmF0aW9ucywKICAgICAgcXVhdE5vcm1hbGl6ZUZhc3QsCiAgICAgIHF1YXROb3JtYWxpemVTa2lwLAogICAgICBzb2x2ZXIsCiAgICAgIHRvbGVyYW5jZQogICAgfSA9IF9yZWYzOwogICAgd29ybGQuYWxsb3dTbGVlcCA9IGFsbG93U2xlZXA7CiAgICB3b3JsZC5ncmF2aXR5LnNldCguLi5ncmF2aXR5KTsKICAgIHdvcmxkLmZyaWN0aW9uR3Jhdml0eSA9IGZyaWN0aW9uR3Jhdml0eSA/IG5ldyBWZWMzKC4uLmZyaWN0aW9uR3Jhdml0eSkgOiB1bmRlZmluZWQ7CiAgICB3b3JsZC5xdWF0Tm9ybWFsaXplRmFzdCA9IHF1YXROb3JtYWxpemVGYXN0OwogICAgd29ybGQucXVhdE5vcm1hbGl6ZVNraXAgPSBxdWF0Tm9ybWFsaXplU2tpcDsKICAgIGlmIChzb2x2ZXIgPT09ICdTcGxpdCcpIHsKICAgICAgd29ybGQuc29sdmVyID0gbmV3IFNwbGl0U29sdmVyKG5ldyBHU1NvbHZlcigpKTsKICAgIH0KICAgIGlmICh3b3JsZC5zb2x2ZXIgaW5zdGFuY2VvZiBHU1NvbHZlcikgewogICAgICB3b3JsZC5zb2x2ZXIudG9sZXJhbmNlID0gdG9sZXJhbmNlOwogICAgICB3b3JsZC5zb2x2ZXIuaXRlcmF0aW9ucyA9IGl0ZXJhdGlvbnM7CiAgICB9CiAgICB3b3JsZC5icm9hZHBoYXNlID0gYnJvYWRwaGFzZSA9PT0gJ1NBUCcgPyBuZXcgU0FQQnJvYWRwaGFzZSh3b3JsZCkgOiBuZXcgTmFpdmVCcm9hZHBoYXNlKCk7CiAgICBpZiAod29ybGQuYnJvYWRwaGFzZSBpbnN0YW5jZW9mIFNBUEJyb2FkcGhhc2UpIHsKICAgICAgd29ybGQuYnJvYWRwaGFzZS5heGlzSW5kZXggPSBheGlzSW5kZXg7CiAgICB9CiAgICB3b3JsZC5hZGRFdmVudExpc3RlbmVyKCdiZWdpbkNvbnRhY3QnLCBlbWl0QmVnaW5Db250YWN0KTsKICAgIHdvcmxkLmFkZEV2ZW50TGlzdGVuZXIoJ2VuZENvbnRhY3QnLCBlbWl0RW5kQ29udGFjdCk7CiAgICBPYmplY3QuYXNzaWduKHdvcmxkLmRlZmF1bHRDb250YWN0TWF0ZXJpYWwsIGRlZmF1bHRDb250YWN0TWF0ZXJpYWwpOwogIH07CgogIGNvbnN0IGlzUW9yViA9IHYgPT4gdiBpbnN0YW5jZW9mIFF1YXRlcm5pb24gfHwgdiBpbnN0YW5jZW9mIFZlYzM7CiAgY29uc3Qgc3RlcCA9IChzdGF0ZSwgX3JlZikgPT4gewogICAgbGV0IHsKICAgICAgcG9zaXRpb25zLAogICAgICBwcm9wczogewogICAgICAgIG1heFN1YlN0ZXBzLAogICAgICAgIHN0ZXBTaXplLAogICAgICAgIHRpbWVTaW5jZUxhc3RDYWxsZWQKICAgICAgfSwKICAgICAgcXVhdGVybmlvbnMKICAgIH0gPSBfcmVmOwogICAgc3RhdGUud29ybGQuc3RlcChzdGVwU2l6ZSwgdGltZVNpbmNlTGFzdENhbGxlZCwgbWF4U3ViU3RlcHMpOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzdGF0ZS53b3JsZC5ib2RpZXMubGVuZ3RoOyBpICs9IDEpIHsKICAgICAgY29uc3QgcCA9IHN0YXRlLndvcmxkLmJvZGllc1tpXS5wb3NpdGlvbjsKICAgICAgY29uc3QgcSA9IHN0YXRlLndvcmxkLmJvZGllc1tpXS5xdWF0ZXJuaW9uOwogICAgICBwb3NpdGlvbnNbMyAqIGkgKyAwXSA9IHAueDsKICAgICAgcG9zaXRpb25zWzMgKiBpICsgMV0gPSBwLnk7CiAgICAgIHBvc2l0aW9uc1szICogaSArIDJdID0gcC56OwogICAgICBxdWF0ZXJuaW9uc1s0ICogaSArIDBdID0gcS54OwogICAgICBxdWF0ZXJuaW9uc1s0ICogaSArIDFdID0gcS55OwogICAgICBxdWF0ZXJuaW9uc1s0ICogaSArIDJdID0gcS56OwogICAgICBxdWF0ZXJuaW9uc1s0ICogaSArIDNdID0gcS53OwogICAgfQogICAgY29uc3Qgb2JzZXJ2YXRpb25zID0gW107CiAgICBmb3IgKGNvbnN0IGlkIG9mIE9iamVjdC5rZXlzKHN0YXRlLnN1YnNjcmlwdGlvbnMpKSB7CiAgICAgIGNvbnN0IFt1dWlkLCB0eXBlLCB0YXJnZXQgPSAnYm9kaWVzJ10gPSBzdGF0ZS5zdWJzY3JpcHRpb25zW2lkXTsKICAgICAgY29uc3QgewogICAgICAgIGJvZGllcywKICAgICAgICB2ZWhpY2xlcwogICAgICB9ID0gc3RhdGU7CiAgICAgIGNvbnN0IHZhbHVlID0gdGFyZ2V0ID09PSAndmVoaWNsZXMnID8KICAgICAgLy8gQHRzLWV4cGVjdC1lcnJvciBUT0RPOiBEaWZmZXJlbnRpYXRlIHRoZXNlICJ0eXBlcyIKICAgICAgdmVoaWNsZXNbdXVpZF0udmVoaWNsZVt0eXBlXSA6CiAgICAgIC8vIEB0cy1leHBlY3QtZXJyb3IgVE9ETzogRGlmZmVyZW50aWF0ZSB0aGVzZSAidHlwZXMiCiAgICAgIGJvZGllc1t1dWlkXVt0eXBlXTsKICAgICAgY29uc3Qgc2VyaWFsaXphYmxlVmFsdWUgPSBpc1FvclYodmFsdWUpID8gdmFsdWUudG9BcnJheSgpIDogdmFsdWU7CiAgICAgIG9ic2VydmF0aW9ucy5wdXNoKFtOdW1iZXIoaWQpLCBzZXJpYWxpemFibGVWYWx1ZSwKICAgICAgLy8gQHRzLWV4cGVjdC1lcnJvciBUT0RPOiBEaWZmZXJlbnRpYXRlIHRoZXNlICJ0eXBlcyIKICAgICAgdHlwZV0pOwogICAgfQogICAgY29uc3QgbWVzc2FnZSA9IHsKICAgICAgYWN0aXZlOiBzdGF0ZS53b3JsZC5oYXNBY3RpdmVCb2RpZXMsCiAgICAgIG9ic2VydmF0aW9ucywKICAgICAgb3A6ICdmcmFtZScsCiAgICAgIHBvc2l0aW9ucywKICAgICAgcXVhdGVybmlvbnMKICAgIH07CiAgICBpZiAoc3RhdGUuYm9kaWVzTmVlZFN5bmNpbmcpIHsKICAgICAgbWVzc2FnZS5ib2RpZXMgPSBzdGF0ZS53b3JsZC5ib2RpZXMucmVkdWNlKChib2RpZXMsIGJvZHkpID0+IHsKICAgICAgICBpZiAoYm9keS51dWlkKSBib2RpZXMucHVzaChib2R5LnV1aWQpOwogICAgICAgIHJldHVybiBib2RpZXM7CiAgICAgIH0sIFtdKTsKICAgICAgc3RhdGUuYm9kaWVzTmVlZFN5bmNpbmcgPSBmYWxzZTsKICAgIH0KICAgIHNlbGYucG9zdE1lc3NhZ2UobWVzc2FnZSwgW3Bvc2l0aW9ucy5idWZmZXIsIHF1YXRlcm5pb25zLmJ1ZmZlcl0pOwogIH07CgogIGNvbnN0IHN0YXRlID0gewogICAgYm9kaWVzOiB7fSwKICAgIGJvZGllc05lZWRTeW5jaW5nOiBmYWxzZSwKICAgIGNvbnN0cmFpbnRzOiB7fSwKICAgIG1hdGVyaWFsczoge30sCiAgICByYXlzOiB7fSwKICAgIHNwcmluZ0luc3RhbmNlczoge30sCiAgICBzcHJpbmdzOiB7fSwKICAgIHN1YnNjcmlwdGlvbnM6IHt9LAogICAgdmVoaWNsZXM6IHt9LAogICAgd29ybGQ6IG5ldyBXb3JsZCgpCiAgfTsKCiAgLy8vIDxyZWZlcmVuY2Ugbm8tZGVmYXVsdC1saWI9InRydWUiLz4KICBjb25zdCBpc0hpbmdlQ29uc3RyYWludCA9IGMgPT4gYyBpbnN0YW5jZW9mIEhpbmdlQ29uc3RyYWludDsKICBmdW5jdGlvbiBzeW5jQm9kaWVzKCkgewogICAgc3RhdGUuYm9kaWVzTmVlZFN5bmNpbmcgPSB0cnVlOwogICAgc3RhdGUuYm9kaWVzID0gc3RhdGUud29ybGQuYm9kaWVzLnJlZHVjZSgoYm9kaWVzLCBib2R5KSA9PiBib2R5LnV1aWQgPyB7CiAgICAgIC4uLmJvZGllcywKICAgICAgW2JvZHkudXVpZF06IGJvZHkKICAgIH0gOiBib2RpZXMsIHt9KTsKICB9CiAgY29uc3QgYnJvYWRwaGFzZXMgPSB7CiAgICBOYWl2ZUJyb2FkcGhhc2UsCiAgICBTQVBCcm9hZHBoYXNlCiAgfTsKICBjb25zdCBjcmVhdGVNYXRlcmlhbCA9IGNyZWF0ZU1hdGVyaWFsRmFjdG9yeShzdGF0ZS5tYXRlcmlhbHMpOwogIHNlbGYub25tZXNzYWdlID0gX3JlZiA9PiB7CiAgICBsZXQgewogICAgICBkYXRhCiAgICB9ID0gX3JlZjsKICAgIHN3aXRjaCAoZGF0YS5vcCkgewogICAgICBjYXNlICdpbml0JzoKICAgICAgICB7CiAgICAgICAgICBpbml0KHN0YXRlLndvcmxkLCBkYXRhLnByb3BzKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgY2FzZSAnc3RlcCc6CiAgICAgICAgewogICAgICAgICAgc3RlcChzdGF0ZSwgZGF0YSk7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIGNhc2UgJ2FkZEJvZGllcyc6CiAgICAgICAgewogICAgICAgICAgYWRkQm9kaWVzKHN0YXRlLCBjcmVhdGVNYXRlcmlhbCwgZGF0YSk7CiAgICAgICAgICBzeW5jQm9kaWVzKCk7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIGNhc2UgJ3JlbW92ZUJvZGllcyc6CiAgICAgICAgewogICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBkYXRhLnV1aWQubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgc3RhdGUud29ybGQucmVtb3ZlQm9keShzdGF0ZS5ib2RpZXNbZGF0YS51dWlkW2ldXSk7CiAgICAgICAgICAgIGNvbnN0IGtleSA9IE9iamVjdC5rZXlzKHN0YXRlLnN1YnNjcmlwdGlvbnMpLmZpbmQoayA9PiBzdGF0ZS5zdWJzY3JpcHRpb25zW2tdWzBdID09PSBkYXRhLnV1aWRbaV0pOwogICAgICAgICAgICBpZiAoa2V5KSB7CiAgICAgICAgICAgICAgZGVsZXRlIHN0YXRlLnN1YnNjcmlwdGlvbnNba2V5XTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgc3luY0JvZGllcygpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICBjYXNlICdzdWJzY3JpYmUnOgogICAgICAgIHsKICAgICAgICAgIGNvbnN0IHsKICAgICAgICAgICAgaWQsCiAgICAgICAgICAgIHRhcmdldCwKICAgICAgICAgICAgdHlwZQogICAgICAgICAgfSA9IGRhdGEucHJvcHM7CiAgICAgICAgICBzdGF0ZS5zdWJzY3JpcHRpb25zW2lkXSA9IFtkYXRhLnV1aWQsIHR5cGUsIHRhcmdldF07CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIGNhc2UgJ3Vuc3Vic2NyaWJlJzoKICAgICAgICB7CiAgICAgICAgICBkZWxldGUgc3RhdGUuc3Vic2NyaXB0aW9uc1tkYXRhLnByb3BzXTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgY2FzZSAnc2V0UG9zaXRpb24nOgogICAgICAgIHN0YXRlLmJvZGllc1tkYXRhLnV1aWRdLnBvc2l0aW9uLnNldChkYXRhLnByb3BzWzBdLCBkYXRhLnByb3BzWzFdLCBkYXRhLnByb3BzWzJdKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnc2V0UXVhdGVybmlvbic6CiAgICAgICAgc3RhdGUuYm9kaWVzW2RhdGEudXVpZF0ucXVhdGVybmlvbi5zZXQoZGF0YS5wcm9wc1swXSwgZGF0YS5wcm9wc1sxXSwgZGF0YS5wcm9wc1syXSwgZGF0YS5wcm9wc1szXSk7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ3NldFJvdGF0aW9uJzoKICAgICAgICBzdGF0ZS5ib2RpZXNbZGF0YS51dWlkXS5xdWF0ZXJuaW9uLnNldEZyb21FdWxlcihkYXRhLnByb3BzWzBdLCBkYXRhLnByb3BzWzFdLCBkYXRhLnByb3BzWzJdKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnc2V0VmVsb2NpdHknOgogICAgICAgIHN0YXRlLmJvZGllc1tkYXRhLnV1aWRdLnZlbG9jaXR5LnNldChkYXRhLnByb3BzWzBdLCBkYXRhLnByb3BzWzFdLCBkYXRhLnByb3BzWzJdKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnc2V0QW5ndWxhclZlbG9jaXR5JzoKICAgICAgICBzdGF0ZS5ib2RpZXNbZGF0YS51dWlkXS5hbmd1bGFyVmVsb2NpdHkuc2V0KGRhdGEucHJvcHNbMF0sIGRhdGEucHJvcHNbMV0sIGRhdGEucHJvcHNbMl0pOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdzZXRMaW5lYXJGYWN0b3InOgogICAgICAgIHN0YXRlLmJvZGllc1tkYXRhLnV1aWRdLmxpbmVhckZhY3Rvci5zZXQoZGF0YS5wcm9wc1swXSwgZGF0YS5wcm9wc1sxXSwgZGF0YS5wcm9wc1syXSk7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ3NldEFuZ3VsYXJGYWN0b3InOgogICAgICAgIHN0YXRlLmJvZGllc1tkYXRhLnV1aWRdLmFuZ3VsYXJGYWN0b3Iuc2V0KGRhdGEucHJvcHNbMF0sIGRhdGEucHJvcHNbMV0sIGRhdGEucHJvcHNbMl0pOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdzZXRNYXNzJzoKICAgICAgICBzdGF0ZS5ib2RpZXNbZGF0YS51dWlkXS5tYXNzID0gZGF0YS5wcm9wczsKICAgICAgICBzdGF0ZS5ib2RpZXNbZGF0YS51dWlkXS51cGRhdGVNYXNzUHJvcGVydGllcygpOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdzZXRNYXRlcmlhbCc6CiAgICAgICAgc3RhdGUuYm9kaWVzW2RhdGEudXVpZF0ubWF0ZXJpYWwgPSBkYXRhLnByb3BzID8gY3JlYXRlTWF0ZXJpYWwoZGF0YS5wcm9wcykgOiBudWxsOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdzZXRMaW5lYXJEYW1waW5nJzoKICAgICAgICBzdGF0ZS5ib2RpZXNbZGF0YS51dWlkXS5saW5lYXJEYW1waW5nID0gZGF0YS5wcm9wczsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnc2V0QW5ndWxhckRhbXBpbmcnOgogICAgICAgIHN0YXRlLmJvZGllc1tkYXRhLnV1aWRdLmFuZ3VsYXJEYW1waW5nID0gZGF0YS5wcm9wczsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnc2V0QWxsb3dTbGVlcCc6CiAgICAgICAgc3RhdGUuYm9kaWVzW2RhdGEudXVpZF0uYWxsb3dTbGVlcCA9IGRhdGEucHJvcHM7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ3NldFNsZWVwU3BlZWRMaW1pdCc6CiAgICAgICAgc3RhdGUuYm9kaWVzW2RhdGEudXVpZF0uc2xlZXBTcGVlZExpbWl0ID0gZGF0YS5wcm9wczsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnc2V0U2xlZXBUaW1lTGltaXQnOgogICAgICAgIHN0YXRlLmJvZGllc1tkYXRhLnV1aWRdLnNsZWVwVGltZUxpbWl0ID0gZGF0YS5wcm9wczsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnc2V0Q29sbGlzaW9uRmlsdGVyR3JvdXAnOgogICAgICAgIHN0YXRlLmJvZGllc1tkYXRhLnV1aWRdLmNvbGxpc2lvbkZpbHRlckdyb3VwID0gZGF0YS5wcm9wczsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnc2V0Q29sbGlzaW9uRmlsdGVyTWFzayc6CiAgICAgICAgc3RhdGUuYm9kaWVzW2RhdGEudXVpZF0uY29sbGlzaW9uRmlsdGVyTWFzayA9IGRhdGEucHJvcHM7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ3NldENvbGxpc2lvblJlc3BvbnNlJzoKICAgICAgICBzdGF0ZS5ib2RpZXNbZGF0YS51dWlkXS5jb2xsaXNpb25SZXNwb25zZSA9IGRhdGEucHJvcHM7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ3NldEZpeGVkUm90YXRpb24nOgogICAgICAgIHN0YXRlLmJvZGllc1tkYXRhLnV1aWRdLmZpeGVkUm90YXRpb24gPSBkYXRhLnByb3BzOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdzZXRGcmljdGlvbkdyYXZpdHknOgogICAgICAgIHN0YXRlLndvcmxkLmZyaWN0aW9uR3Jhdml0eSA9IGRhdGEucHJvcHMgPyBuZXcgVmVjMyguLi5kYXRhLnByb3BzKSA6IHVuZGVmaW5lZDsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnc2V0SXNUcmlnZ2VyJzoKICAgICAgICBzdGF0ZS5ib2RpZXNbZGF0YS51dWlkXS5pc1RyaWdnZXIgPSBkYXRhLnByb3BzOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdzZXRHcmF2aXR5JzoKICAgICAgICBzdGF0ZS53b3JsZC5ncmF2aXR5LnNldChkYXRhLnByb3BzWzBdLCBkYXRhLnByb3BzWzFdLCBkYXRhLnByb3BzWzJdKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnc2V0VG9sZXJhbmNlJzoKICAgICAgICBpZiAoc3RhdGUud29ybGQuc29sdmVyIGluc3RhbmNlb2YgR1NTb2x2ZXIpIHsKICAgICAgICAgIHN0YXRlLndvcmxkLnNvbHZlci50b2xlcmFuY2UgPSBkYXRhLnByb3BzOwogICAgICAgIH0KICAgICAgICBicmVhazsKICAgICAgY2FzZSAnc2V0SXRlcmF0aW9ucyc6CiAgICAgICAgaWYgKHN0YXRlLndvcmxkLnNvbHZlciBpbnN0YW5jZW9mIEdTU29sdmVyKSB7CiAgICAgICAgICBzdGF0ZS53b3JsZC5zb2x2ZXIuaXRlcmF0aW9ucyA9IGRhdGEucHJvcHM7CiAgICAgICAgfQogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdzZXRCcm9hZHBoYXNlJzoKICAgICAgICBzdGF0ZS53b3JsZC5icm9hZHBoYXNlID0gbmV3IChicm9hZHBoYXNlc1tgJHtkYXRhLnByb3BzfUJyb2FkcGhhc2VgXSB8fCBOYWl2ZUJyb2FkcGhhc2UpKHN0YXRlLndvcmxkKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnc2V0QXhpc0luZGV4JzoKICAgICAgICBpZiAoc3RhdGUud29ybGQuYnJvYWRwaGFzZSBpbnN0YW5jZW9mIFNBUEJyb2FkcGhhc2UpIHsKICAgICAgICAgIHN0YXRlLndvcmxkLmJyb2FkcGhhc2UuYXhpc0luZGV4ID0gZGF0YS5wcm9wcyA9PT0gdW5kZWZpbmVkIHx8IGRhdGEucHJvcHMgPT09IG51bGwgPyAwIDogZGF0YS5wcm9wczsKICAgICAgICB9CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ2FwcGx5Rm9yY2UnOgogICAgICAgIHN0YXRlLmJvZGllc1tkYXRhLnV1aWRdLmFwcGx5Rm9yY2UobmV3IFZlYzMoLi4uZGF0YS5wcm9wc1swXSksIG5ldyBWZWMzKC4uLmRhdGEucHJvcHNbMV0pKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnYXBwbHlJbXB1bHNlJzoKICAgICAgICBzdGF0ZS5ib2RpZXNbZGF0YS51dWlkXS5hcHBseUltcHVsc2UobmV3IFZlYzMoLi4uZGF0YS5wcm9wc1swXSksIG5ldyBWZWMzKC4uLmRhdGEucHJvcHNbMV0pKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnYXBwbHlMb2NhbEZvcmNlJzoKICAgICAgICBzdGF0ZS5ib2RpZXNbZGF0YS51dWlkXS5hcHBseUxvY2FsRm9yY2UobmV3IFZlYzMoLi4uZGF0YS5wcm9wc1swXSksIG5ldyBWZWMzKC4uLmRhdGEucHJvcHNbMV0pKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnYXBwbHlMb2NhbEltcHVsc2UnOgogICAgICAgIHN0YXRlLmJvZGllc1tkYXRhLnV1aWRdLmFwcGx5TG9jYWxJbXB1bHNlKG5ldyBWZWMzKC4uLmRhdGEucHJvcHNbMF0pLCBuZXcgVmVjMyguLi5kYXRhLnByb3BzWzFdKSk7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ2FwcGx5VG9ycXVlJzoKICAgICAgICBzdGF0ZS5ib2RpZXNbZGF0YS51dWlkXS5hcHBseVRvcnF1ZShuZXcgVmVjMyguLi5kYXRhLnByb3BzWzBdKSk7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ2FkZENvbnN0cmFpbnQnOgogICAgICAgIHsKICAgICAgICAgIGFkZENvbnN0cmFpbnQoc3RhdGUsIGRhdGEpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICBjYXNlICdyZW1vdmVDb25zdHJhaW50JzoKICAgICAgICBzdGF0ZS53b3JsZC5jb25zdHJhaW50cy5maWx0ZXIoX3JlZjIgPT4gewogICAgICAgICAgbGV0IHsKICAgICAgICAgICAgdXVpZAogICAgICAgICAgfSA9IF9yZWYyOwogICAgICAgICAgcmV0dXJuIHV1aWQgPT09IGRhdGEudXVpZDsKICAgICAgICB9KS5tYXAoYyA9PiBzdGF0ZS53b3JsZC5yZW1vdmVDb25zdHJhaW50KGMpKTsKICAgICAgICBpZiAoc3RhdGUuY29uc3RyYWludHNbZGF0YS51dWlkXSkgewogICAgICAgICAgc3RhdGUud29ybGQucmVtb3ZlRXZlbnRMaXN0ZW5lcigncG9zdFN0ZXAnLCBzdGF0ZS5jb25zdHJhaW50c1tkYXRhLnV1aWRdKTsKICAgICAgICAgIGRlbGV0ZSBzdGF0ZS5jb25zdHJhaW50c1tkYXRhLnV1aWRdOwogICAgICAgIH0KICAgICAgICBicmVhazsKICAgICAgY2FzZSAnZW5hYmxlQ29uc3RyYWludCc6CiAgICAgICAgc3RhdGUud29ybGQuY29uc3RyYWludHMuZmlsdGVyKGMgPT4gYy51dWlkID09PSBkYXRhLnV1aWQpLm1hcChjID0+IGMuZW5hYmxlKCkpOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdkaXNhYmxlQ29uc3RyYWludCc6CiAgICAgICAgc3RhdGUud29ybGQuY29uc3RyYWludHMuZmlsdGVyKGMgPT4gYy51dWlkID09PSBkYXRhLnV1aWQpLm1hcChjID0+IGMuZGlzYWJsZSgpKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnZW5hYmxlQ29uc3RyYWludE1vdG9yJzoKICAgICAgICBzdGF0ZS53b3JsZC5jb25zdHJhaW50cy5maWx0ZXIoYyA9PiBjLnV1aWQgPT09IGRhdGEudXVpZCkuZmlsdGVyKGlzSGluZ2VDb25zdHJhaW50KS5tYXAoYyA9PiBjLmVuYWJsZU1vdG9yKCkpOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdkaXNhYmxlQ29uc3RyYWludE1vdG9yJzoKICAgICAgICBzdGF0ZS53b3JsZC5jb25zdHJhaW50cy5maWx0ZXIoYyA9PiBjLnV1aWQgPT09IGRhdGEudXVpZCkuZmlsdGVyKGlzSGluZ2VDb25zdHJhaW50KS5tYXAoYyA9PiBjLmRpc2FibGVNb3RvcigpKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnc2V0Q29uc3RyYWludE1vdG9yU3BlZWQnOgogICAgICAgIHN0YXRlLndvcmxkLmNvbnN0cmFpbnRzLmZpbHRlcihjID0+IGMudXVpZCA9PT0gZGF0YS51dWlkKS5maWx0ZXIoaXNIaW5nZUNvbnN0cmFpbnQpLm1hcChjID0+IGMuc2V0TW90b3JTcGVlZChkYXRhLnByb3BzKSk7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ3NldENvbnN0cmFpbnRNb3Rvck1heEZvcmNlJzoKICAgICAgICBzdGF0ZS53b3JsZC5jb25zdHJhaW50cy5maWx0ZXIoYyA9PiBjLnV1aWQgPT09IGRhdGEudXVpZCkuZmlsdGVyKGlzSGluZ2VDb25zdHJhaW50KS5tYXAoYyA9PiBjLnNldE1vdG9yTWF4Rm9yY2UoZGF0YS5wcm9wcykpOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdhZGRTcHJpbmcnOgogICAgICAgIHsKICAgICAgICAgIGFkZFNwcmluZyhzdGF0ZSwgZGF0YSk7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIGNhc2UgJ3NldFNwcmluZ1N0aWZmbmVzcyc6CiAgICAgICAgewogICAgICAgICAgc3RhdGUuc3ByaW5nSW5zdGFuY2VzW2RhdGEudXVpZF0uc3RpZmZuZXNzID0gZGF0YS5wcm9wczsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgY2FzZSAnc2V0U3ByaW5nUmVzdExlbmd0aCc6CiAgICAgICAgewogICAgICAgICAgc3RhdGUuc3ByaW5nSW5zdGFuY2VzW2RhdGEudXVpZF0ucmVzdExlbmd0aCA9IGRhdGEucHJvcHM7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIGNhc2UgJ3NldFNwcmluZ0RhbXBpbmcnOgogICAgICAgIHsKICAgICAgICAgIHN0YXRlLnNwcmluZ0luc3RhbmNlc1tkYXRhLnV1aWRdLmRhbXBpbmcgPSBkYXRhLnByb3BzOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICBjYXNlICdyZW1vdmVTcHJpbmcnOgogICAgICAgIHsKICAgICAgICAgIHN0YXRlLndvcmxkLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Bvc3RTdGVwJywgc3RhdGUuc3ByaW5nc1tkYXRhLnV1aWRdKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgY2FzZSAnYWRkUmF5JzoKICAgICAgICB7CiAgICAgICAgICBhZGRSYXkoc3RhdGUsIGRhdGEpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICBjYXNlICdyZW1vdmVSYXknOgogICAgICAgIHsKICAgICAgICAgIHN0YXRlLndvcmxkLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3ByZVN0ZXAnLCBzdGF0ZS5yYXlzW2RhdGEudXVpZF0pOwogICAgICAgICAgZGVsZXRlIHN0YXRlLnJheXNbZGF0YS51dWlkXTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgY2FzZSAnYWRkUmF5Y2FzdFZlaGljbGUnOgogICAgICAgIHsKICAgICAgICAgIGFkZFJheWNhc3RWZWhpY2xlKHN0YXRlLCBkYXRhKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgY2FzZSAncmVtb3ZlUmF5Y2FzdFZlaGljbGUnOgogICAgICAgIHsKICAgICAgICAgIHN0YXRlLndvcmxkLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3ByZVN0ZXAnLCBzdGF0ZS52ZWhpY2xlc1tkYXRhLnV1aWRdLnByZVN0ZXApOwogICAgICAgICAgc3RhdGUud29ybGQucmVtb3ZlRXZlbnRMaXN0ZW5lcigncG9zdFN0ZXAnLCBzdGF0ZS52ZWhpY2xlc1tkYXRhLnV1aWRdLnBvc3RTdGVwKTsKICAgICAgICAgIHN0YXRlLnZlaGljbGVzW2RhdGEudXVpZF0udmVoaWNsZS53b3JsZCA9IG51bGw7CiAgICAgICAgICBkZWxldGUgc3RhdGUudmVoaWNsZXNbZGF0YS51dWlkXTsKICAgICAgICAgIGNvbnN0IGtleSA9IE9iamVjdC5rZXlzKHN0YXRlLnN1YnNjcmlwdGlvbnMpLmZpbmQoayA9PiBzdGF0ZS5zdWJzY3JpcHRpb25zW2tdWzBdID09PSBkYXRhLnV1aWQpOwogICAgICAgICAgaWYgKGtleSkgewogICAgICAgICAgICBkZWxldGUgc3RhdGUuc3Vic2NyaXB0aW9uc1trZXldOwogICAgICAgICAgfQogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICBjYXNlICdzZXRSYXljYXN0VmVoaWNsZVN0ZWVyaW5nVmFsdWUnOgogICAgICAgIHsKICAgICAgICAgIGNvbnN0IFt2YWx1ZSwgd2hlZWxJbmRleF0gPSBkYXRhLnByb3BzOwogICAgICAgICAgc3RhdGUudmVoaWNsZXNbZGF0YS51dWlkXS52ZWhpY2xlLnNldFN0ZWVyaW5nVmFsdWUodmFsdWUsIHdoZWVsSW5kZXgpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICBjYXNlICdhcHBseVJheWNhc3RWZWhpY2xlRW5naW5lRm9yY2UnOgogICAgICAgIHsKICAgICAgICAgIGNvbnN0IFt2YWx1ZSwgd2hlZWxJbmRleF0gPSBkYXRhLnByb3BzOwogICAgICAgICAgc3RhdGUudmVoaWNsZXNbZGF0YS51dWlkXS52ZWhpY2xlLmFwcGx5RW5naW5lRm9yY2UodmFsdWUsIHdoZWVsSW5kZXgpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICBjYXNlICdzZXRSYXljYXN0VmVoaWNsZUJyYWtlJzoKICAgICAgICB7CiAgICAgICAgICBjb25zdCBbYnJha2UsIHdoZWVsSW5kZXhdID0gZGF0YS5wcm9wczsKICAgICAgICAgIHN0YXRlLnZlaGljbGVzW2RhdGEudXVpZF0udmVoaWNsZS5zZXRCcmFrZShicmFrZSwgd2hlZWxJbmRleCk7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIGNhc2UgJ2FkZENvbnRhY3RNYXRlcmlhbCc6CiAgICAgICAgewogICAgICAgICAgYWRkQ29udGFjdE1hdGVyaWFsKHN0YXRlLndvcmxkLCBjcmVhdGVNYXRlcmlhbCwgZGF0YS5wcm9wcywgZGF0YS51dWlkKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgY2FzZSAncmVtb3ZlQ29udGFjdE1hdGVyaWFsJzoKICAgICAgICB7CiAgICAgICAgICByZW1vdmVDb250YWN0TWF0ZXJpYWwoc3RhdGUud29ybGQsIGRhdGEudXVpZCk7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIGNhc2UgJ3dha2VVcCc6CiAgICAgICAgewogICAgICAgICAgc3RhdGUuYm9kaWVzW2RhdGEudXVpZF0ud2FrZVVwKCk7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIGNhc2UgJ3NsZWVwJzoKICAgICAgICB7CiAgICAgICAgICBzdGF0ZS5ib2RpZXNbZGF0YS51dWlkXS5zbGVlcCgpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgfQogIH07Cgp9KSgpOwoK",null,!1);class PAe extends _Ae{constructor(t){let{allowSleep:i=!1,axisIndex:a=0,broadphase:o="Naive",defaultContactMaterial:r={contactEquationStiffness:1e6},frictionGravity:s=null,gravity:l=[0,-9.81,0],iterations:c=5,quatNormalizeFast:u=!1,quatNormalizeSkip:C=0,size:h=1e3,solver:m="GS",tolerance:p=.001}=t;super();Tr(this,"messageQueue",[]);Tr(this,"worker",null);this.config={allowSleep:i,axisIndex:a,broadphase:o,defaultContactMaterial:r,frictionGravity:s,gravity:l,iterations:c,quatNormalizeFast:u,quatNormalizeSkip:C,size:h,solver:m,tolerance:p},this.buffers={positions:new Float32Array(h*3),quaternions:new Float32Array(h*4)}}get axisIndex(){return this.config.axisIndex}set axisIndex(t){this.config.axisIndex=t,this.postMessage({op:"setAxisIndex",props:t})}get broadphase(){return this.config.broadphase}set broadphase(t){this.config.broadphase=t,this.postMessage({op:"setBroadphase",props:t})}get frictionGravity(){return this.config.frictionGravity}set frictionGravity(t){this.config.frictionGravity=t,this.postMessage({op:"setFrictionGravity",props:t})}get gravity(){return this.config.gravity}set gravity(t){this.config.gravity=t,this.postMessage({op:"setGravity",props:t})}get iterations(){return this.config.iterations}set iterations(t){this.config.iterations=t,this.postMessage({op:"setIterations",props:t})}get tolerance(){return this.config.tolerance}set tolerance(t){this.config.tolerance=t,this.postMessage({op:"setTolerance",props:t})}addBodies(t){let{props:i,type:a,uuid:o}=t;this.postMessage({op:"addBodies",props:i,type:a,uuid:o})}addConstraint(t){let{props:[i,a,o],type:r,uuid:s}=t;this.postMessage({op:"addConstraint",props:[i,a,o],type:r,uuid:s})}addContactMaterial(t){let{props:i,uuid:a}=t;this.postMessage({op:"addContactMaterial",props:i,uuid:a})}addRay(t){let{props:i,uuid:a}=t;this.postMessage({op:"addRay",props:i,uuid:a})}addRaycastVehicle(t){let{props:[i,a,o,r,s,l],uuid:c}=t;this.postMessage({op:"addRaycastVehicle",props:[i,a,o,r,s,l],uuid:c})}addSpring(t){let{props:[i,a,o],uuid:r}=t;this.postMessage({op:"addSpring",props:[i,a,o],uuid:r})}applyForce(t){let{props:i,uuid:a}=t;this.postMessage({op:"applyForce",props:i,uuid:a})}applyImpulse(t){let{props:i,uuid:a}=t;this.postMessage({op:"applyImpulse",props:i,uuid:a})}applyLocalForce(t){let{props:i,uuid:a}=t;this.postMessage({op:"applyLocalForce",props:i,uuid:a})}applyLocalImpulse(t){let{props:i,uuid:a}=t;this.postMessage({op:"applyLocalImpulse",props:i,uuid:a})}applyRaycastVehicleEngineForce(t){let{props:i,uuid:a}=t;this.postMessage({op:"applyRaycastVehicleEngineForce",props:i,uuid:a})}applyTorque(t){let{props:i,uuid:a}=t;this.postMessage({op:"applyTorque",props:i,uuid:a})}connect(){this.worker=new kAe,this.worker.onmessage=t=>{if(t.data.op==="frame"){this.buffers.positions=t.data.positions,this.buffers.quaternions=t.data.quaternions,this.emit(t.data.op,t.data);return}this.emit(t.data.type,t.data)};for(const t of this.messageQueue)this.worker.postMessage(t);this.messageQueue.length=0}disableConstraint(t){let{uuid:i}=t;this.postMessage({op:"disableConstraint",uuid:i})}disableConstraintMotor(t){let{uuid:i}=t;this.postMessage({op:"disableConstraintMotor",uuid:i})}disconnect(){this.worker&&(this.worker.onmessage=null)}enableConstraint(t){let{uuid:i}=t;this.postMessage({op:"enableConstraint",uuid:i})}enableConstraintMotor(t){let{uuid:i}=t;this.postMessage({op:"enableConstraintMotor",uuid:i})}init(){const{allowSleep:t,axisIndex:i,broadphase:a,defaultContactMaterial:o,frictionGravity:r,gravity:s,iterations:l,quatNormalizeFast:c,quatNormalizeSkip:u,solver:C,tolerance:h}=this.config;this.postMessage({op:"init",props:{allowSleep:t,axisIndex:i,broadphase:a,defaultContactMaterial:o,frictionGravity:r,gravity:s,iterations:l,quatNormalizeFast:c,quatNormalizeSkip:u,solver:C,tolerance:h}})}removeBodies(t){let{uuid:i}=t;this.postMessage({op:"removeBodies",uuid:i})}removeConstraint(t){let{uuid:i}=t;this.postMessage({op:"removeConstraint",uuid:i})}removeContactMaterial(t){let{uuid:i}=t;this.postMessage({op:"removeContactMaterial",uuid:i})}removeRay(t){let{uuid:i}=t;this.postMessage({op:"removeRay",uuid:i})}removeRaycastVehicle(t){let{uuid:i}=t;this.postMessage({op:"removeRaycastVehicle",uuid:i})}removeSpring(t){let{uuid:i}=t;this.postMessage({op:"removeSpring",uuid:i})}setAllowSleep(t){let{props:i,uuid:a}=t;this.postMessage({op:"setAllowSleep",props:i,uuid:a})}setAngularDamping(t){let{props:i,uuid:a}=t;this.postMessage({op:"setAngularDamping",props:i,uuid:a})}setAngularFactor(t){let{props:i,uuid:a}=t;this.postMessage({op:"setAngularFactor",props:i,uuid:a})}setAngularVelocity(t){let{props:i,uuid:a}=t;this.postMessage({op:"setAngularVelocity",props:i,uuid:a})}setCollisionFilterGroup(t){let{props:i,uuid:a}=t;this.postMessage({op:"setCollisionFilterGroup",props:i,uuid:a})}setCollisionFilterMask(t){let{props:i,uuid:a}=t;this.postMessage({op:"setCollisionFilterMask",props:i,uuid:a})}setCollisionResponse(t){let{props:i,uuid:a}=t;this.postMessage({op:"setCollisionResponse",props:i,uuid:a})}setConstraintMotorMaxForce(t){let{props:i,uuid:a}=t;this.postMessage({op:"setConstraintMotorMaxForce",props:i,uuid:a})}setConstraintMotorSpeed(t){let{props:i,uuid:a}=t;this.postMessage({op:"setConstraintMotorSpeed",props:i,uuid:a})}setFixedRotation(t){let{props:i,uuid:a}=t;this.postMessage({op:"setFixedRotation",props:i,uuid:a})}setIsTrigger(t){let{props:i,uuid:a}=t;this.postMessage({op:"setIsTrigger",props:i,uuid:a})}setLinearDamping(t){let{props:i,uuid:a}=t;this.postMessage({op:"setLinearDamping",props:i,uuid:a})}setLinearFactor(t){let{props:i,uuid:a}=t;this.postMessage({op:"setLinearFactor",props:i,uuid:a})}setMass(t){let{props:i,uuid:a}=t;this.postMessage({op:"setMass",props:i,uuid:a})}setMaterial(t){let{props:i,uuid:a}=t;this.postMessage({op:"setMaterial",props:i,uuid:a})}setPosition(t){let{props:i,uuid:a}=t;this.postMessage({op:"setPosition",props:i,uuid:a})}setQuaternion(t){let{props:[i,a,o,r],uuid:s}=t;this.postMessage({op:"setQuaternion",props:[i,a,o,r],uuid:s})}setRaycastVehicleBrake(t){let{props:i,uuid:a}=t;this.postMessage({op:"setRaycastVehicleBrake",props:i,uuid:a})}setRaycastVehicleSteeringValue(t){let{props:i,uuid:a}=t;this.postMessage({op:"setRaycastVehicleSteeringValue",props:i,uuid:a})}setRotation(t){let{props:i,uuid:a}=t;this.postMessage({op:"setRotation",props:i,uuid:a})}setSleepSpeedLimit(t){let{props:i,uuid:a}=t;this.postMessage({op:"setSleepSpeedLimit",props:i,uuid:a})}setSleepTimeLimit(t){let{props:i,uuid:a}=t;this.postMessage({op:"setSleepTimeLimit",props:i,uuid:a})}setSpringDamping(t){let{props:i,uuid:a}=t;this.postMessage({op:"setSpringDamping",props:i,uuid:a})}setSpringRestLength(t){let{props:i,uuid:a}=t;this.postMessage({op:"setSpringRestLength",props:i,uuid:a})}setSpringStiffness(t){let{props:i,uuid:a}=t;this.postMessage({op:"setSpringStiffness",props:i,uuid:a})}setUserData(t){let{props:i,uuid:a}=t;this.postMessage({op:"setUserData",props:i,uuid:a})}setVelocity(t){let{props:i,uuid:a}=t;this.postMessage({op:"setVelocity",props:i,uuid:a})}sleep(t){let{uuid:i}=t;this.postMessage({op:"sleep",uuid:i})}step(t){var i;const{buffers:{positions:a,quaternions:o}}=this;!a.byteLength&&!o.byteLength||(i=this.worker)==null||i.postMessage({op:"step",positions:a,props:t,quaternions:o},[a.buffer,o.buffer])}subscribe(t){let{props:{id:i,target:a,type:o},uuid:r}=t;this.postMessage({op:"subscribe",props:{id:i,target:a,type:o},uuid:r})}terminate(){var t;(t=this.worker)==null||t.terminate(),this.worker=null}unsubscribe(t){let{props:i}=t;this.postMessage({op:"unsubscribe",props:i})}wakeUp(t){let{uuid:i}=t;this.postMessage({op:"wakeUp",uuid:i})}postMessage(t){if(this.worker)return this.worker.postMessage(t);this.messageQueue.push(t)}}class iu{constructor(e){e===void 0&&(e=[0,0,0,0,0,0,0,0,0]),this.elements=e}identity(){const e=this.elements;e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1}setZero(){const e=this.elements;e[0]=0,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=0,e[6]=0,e[7]=0,e[8]=0}setTrace(e){const t=this.elements;t[0]=e.x,t[4]=e.y,t[8]=e.z}getTrace(e){e===void 0&&(e=new Me);const t=this.elements;return e.x=t[0],e.y=t[4],e.z=t[8],e}vmult(e,t){t===void 0&&(t=new Me);const i=this.elements,a=e.x,o=e.y,r=e.z;return t.x=i[0]*a+i[1]*o+i[2]*r,t.y=i[3]*a+i[4]*o+i[5]*r,t.z=i[6]*a+i[7]*o+i[8]*r,t}smult(e){for(let t=0;t<this.elements.length;t++)this.elements[t]*=e}mmult(e,t){t===void 0&&(t=new iu);const i=this.elements,a=e.elements,o=t.elements,r=i[0],s=i[1],l=i[2],c=i[3],u=i[4],C=i[5],h=i[6],m=i[7],p=i[8],B=a[0],b=a[1],y=a[2],S=a[3],R=a[4],Z=a[5],x=a[6],M=a[7],E=a[8];return o[0]=r*B+s*S+l*x,o[1]=r*b+s*R+l*M,o[2]=r*y+s*Z+l*E,o[3]=c*B+u*S+C*x,o[4]=c*b+u*R+C*M,o[5]=c*y+u*Z+C*E,o[6]=h*B+m*S+p*x,o[7]=h*b+m*R+p*M,o[8]=h*y+m*Z+p*E,t}scale(e,t){t===void 0&&(t=new iu);const i=this.elements,a=t.elements;for(let o=0;o!==3;o++)a[3*o+0]=e.x*i[3*o+0],a[3*o+1]=e.y*i[3*o+1],a[3*o+2]=e.z*i[3*o+2];return t}solve(e,t){t===void 0&&(t=new Me);const i=3,a=4,o=[];let r,s;for(r=0;r<i*a;r++)o.push(0);for(r=0;r<3;r++)for(s=0;s<3;s++)o[r+a*s]=this.elements[r+3*s];o[3+4*0]=e.x,o[3+4*1]=e.y,o[3+4*2]=e.z;let l=3;const c=l;let u;const C=4;let h;do{if(r=c-l,o[r+a*r]===0){for(s=r+1;s<c;s++)if(o[r+a*s]!==0){u=C;do h=C-u,o[h+a*r]+=o[h+a*s];while(--u);break}}if(o[r+a*r]!==0)for(s=r+1;s<c;s++){const m=o[r+a*s]/o[r+a*r];u=C;do h=C-u,o[h+a*s]=h<=r?0:o[h+a*s]-o[h+a*r]*m;while(--u)}}while(--l);if(t.z=o[2*a+3]/o[2*a+2],t.y=(o[1*a+3]-o[1*a+2]*t.z)/o[1*a+1],t.x=(o[0*a+3]-o[0*a+2]*t.z-o[0*a+1]*t.y)/o[0*a+0],isNaN(t.x)||isNaN(t.y)||isNaN(t.z)||t.x===1/0||t.y===1/0||t.z===1/0)throw`Could not solve equation! Got x=[${t.toString()}], b=[${e.toString()}], A=[${this.toString()}]`;return t}e(e,t,i){if(i===void 0)return this.elements[t+3*e];this.elements[t+3*e]=i}copy(e){for(let t=0;t<e.elements.length;t++)this.elements[t]=e.elements[t];return this}toString(){let e="";const t=",";for(let i=0;i<9;i++)e+=this.elements[i]+t;return e}reverse(e){e===void 0&&(e=new iu);const t=3,i=6,a=JAe;let o,r;for(o=0;o<3;o++)for(r=0;r<3;r++)a[o+i*r]=this.elements[o+3*r];a[3+6*0]=1,a[3+6*1]=0,a[3+6*2]=0,a[4+6*0]=0,a[4+6*1]=1,a[4+6*2]=0,a[5+6*0]=0,a[5+6*1]=0,a[5+6*2]=1;let s=3;const l=s;let c;const u=i;let C;do{if(o=l-s,a[o+i*o]===0){for(r=o+1;r<l;r++)if(a[o+i*r]!==0){c=u;do C=u-c,a[C+i*o]+=a[C+i*r];while(--c);break}}if(a[o+i*o]!==0)for(r=o+1;r<l;r++){const h=a[o+i*r]/a[o+i*o];c=u;do C=u-c,a[C+i*r]=C<=o?0:a[C+i*r]-a[C+i*o]*h;while(--c)}}while(--s);o=2;do{r=o-1;do{const h=a[o+i*r]/a[o+i*o];c=i;do C=i-c,a[C+i*r]=a[C+i*r]-a[C+i*o]*h;while(--c)}while(r--)}while(--o);o=2;do{const h=1/a[o+i*o];c=i;do C=i-c,a[C+i*o]=a[C+i*o]*h;while(--c)}while(o--);o=2;do{r=2;do{if(C=a[t+r+i*o],isNaN(C)||C===1/0)throw`Could not reverse! A=[${this.toString()}]`;e.e(o,r,C)}while(r--)}while(o--);return e}setRotationFromQuaternion(e){const t=e.x,i=e.y,a=e.z,o=e.w,r=t+t,s=i+i,l=a+a,c=t*r,u=t*s,C=t*l,h=i*s,m=i*l,p=a*l,B=o*r,b=o*s,y=o*l,S=this.elements;return S[3*0+0]=1-(h+p),S[3*0+1]=u-y,S[3*0+2]=C+b,S[3*1+0]=u+y,S[3*1+1]=1-(c+p),S[3*1+2]=m-B,S[3*2+0]=C-b,S[3*2+1]=m+B,S[3*2+2]=1-(c+h),this}transpose(e){e===void 0&&(e=new iu);const t=this.elements,i=e.elements;let a;return i[0]=t[0],i[4]=t[4],i[8]=t[8],a=t[1],i[1]=t[3],i[3]=a,a=t[2],i[2]=t[6],i[6]=a,a=t[5],i[5]=t[7],i[7]=a,e}}const JAe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];class Me{constructor(e,t,i){e===void 0&&(e=0),t===void 0&&(t=0),i===void 0&&(i=0),this.x=e,this.y=t,this.z=i}cross(e,t){t===void 0&&(t=new Me);const i=e.x,a=e.y,o=e.z,r=this.x,s=this.y,l=this.z;return t.x=s*o-l*a,t.y=l*i-r*o,t.z=r*a-s*i,t}set(e,t,i){return this.x=e,this.y=t,this.z=i,this}setZero(){this.x=this.y=this.z=0}vadd(e,t){if(t)t.x=e.x+this.x,t.y=e.y+this.y,t.z=e.z+this.z;else return new Me(this.x+e.x,this.y+e.y,this.z+e.z)}vsub(e,t){if(t)t.x=this.x-e.x,t.y=this.y-e.y,t.z=this.z-e.z;else return new Me(this.x-e.x,this.y-e.y,this.z-e.z)}crossmat(){return new iu([0,-this.z,this.y,this.z,0,-this.x,-this.y,this.x,0])}normalize(){const e=this.x,t=this.y,i=this.z,a=Math.sqrt(e*e+t*t+i*i);if(a>0){const o=1/a;this.x*=o,this.y*=o,this.z*=o}else this.x=0,this.y=0,this.z=0;return a}unit(e){e===void 0&&(e=new Me);const t=this.x,i=this.y,a=this.z;let o=Math.sqrt(t*t+i*i+a*a);return o>0?(o=1/o,e.x=t*o,e.y=i*o,e.z=a*o):(e.x=1,e.y=0,e.z=0),e}length(){const e=this.x,t=this.y,i=this.z;return Math.sqrt(e*e+t*t+i*i)}lengthSquared(){return this.dot(this)}distanceTo(e){const t=this.x,i=this.y,a=this.z,o=e.x,r=e.y,s=e.z;return Math.sqrt((o-t)*(o-t)+(r-i)*(r-i)+(s-a)*(s-a))}distanceSquared(e){const t=this.x,i=this.y,a=this.z,o=e.x,r=e.y,s=e.z;return(o-t)*(o-t)+(r-i)*(r-i)+(s-a)*(s-a)}scale(e,t){t===void 0&&(t=new Me);const i=this.x,a=this.y,o=this.z;return t.x=e*i,t.y=e*a,t.z=e*o,t}vmul(e,t){return t===void 0&&(t=new Me),t.x=e.x*this.x,t.y=e.y*this.y,t.z=e.z*this.z,t}addScaledVector(e,t,i){return i===void 0&&(i=new Me),i.x=this.x+e*t.x,i.y=this.y+e*t.y,i.z=this.z+e*t.z,i}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}isZero(){return this.x===0&&this.y===0&&this.z===0}negate(e){return e===void 0&&(e=new Me),e.x=-this.x,e.y=-this.y,e.z=-this.z,e}tangents(e,t){const i=this.length();if(i>0){const a=jAe,o=1/i;a.set(this.x*o,this.y*o,this.z*o);const r=QAe;Math.abs(a.x)<.9?(r.set(1,0,0),a.cross(r,e)):(r.set(0,1,0),a.cross(r,e)),a.cross(e,t)}else e.set(1,0,0),t.set(0,1,0)}toString(){return`${this.x},${this.y},${this.z}`}toArray(){return[this.x,this.y,this.z]}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}lerp(e,t,i){const a=this.x,o=this.y,r=this.z;i.x=a+(e.x-a)*t,i.y=o+(e.y-o)*t,i.z=r+(e.z-r)*t}almostEquals(e,t){return t===void 0&&(t=1e-6),!(Math.abs(this.x-e.x)>t||Math.abs(this.y-e.y)>t||Math.abs(this.z-e.z)>t)}almostZero(e){return e===void 0&&(e=1e-6),!(Math.abs(this.x)>e||Math.abs(this.y)>e||Math.abs(this.z)>e)}isAntiparallelTo(e,t){return this.negate(SF),SF.almostEquals(e,t)}clone(){return new Me(this.x,this.y,this.z)}}Me.ZERO=new Me(0,0,0);Me.UNIT_X=new Me(1,0,0);Me.UNIT_Y=new Me(0,1,0);Me.UNIT_Z=new Me(0,0,1);const jAe=new Me,QAe=new Me,SF=new Me;class wl{constructor(e){e===void 0&&(e={}),this.lowerBound=new Me,this.upperBound=new Me,e.lowerBound&&this.lowerBound.copy(e.lowerBound),e.upperBound&&this.upperBound.copy(e.upperBound)}setFromPoints(e,t,i,a){const o=this.lowerBound,r=this.upperBound,s=i;o.copy(e[0]),s&&s.vmult(o,o),r.copy(o);for(let l=1;l<e.length;l++){let c=e[l];s&&(s.vmult(c,wF),c=wF),c.x>r.x&&(r.x=c.x),c.x<o.x&&(o.x=c.x),c.y>r.y&&(r.y=c.y),c.y<o.y&&(o.y=c.y),c.z>r.z&&(r.z=c.z),c.z<o.z&&(o.z=c.z)}return t&&(t.vadd(o,o),t.vadd(r,r)),a&&(o.x-=a,o.y-=a,o.z-=a,r.x+=a,r.y+=a,r.z+=a),this}copy(e){return this.lowerBound.copy(e.lowerBound),this.upperBound.copy(e.upperBound),this}clone(){return new wl().copy(this)}extend(e){this.lowerBound.x=Math.min(this.lowerBound.x,e.lowerBound.x),this.upperBound.x=Math.max(this.upperBound.x,e.upperBound.x),this.lowerBound.y=Math.min(this.lowerBound.y,e.lowerBound.y),this.upperBound.y=Math.max(this.upperBound.y,e.upperBound.y),this.lowerBound.z=Math.min(this.lowerBound.z,e.lowerBound.z),this.upperBound.z=Math.max(this.upperBound.z,e.upperBound.z)}overlaps(e){const t=this.lowerBound,i=this.upperBound,a=e.lowerBound,o=e.upperBound,r=a.x<=i.x&&i.x<=o.x||t.x<=o.x&&o.x<=i.x,s=a.y<=i.y&&i.y<=o.y||t.y<=o.y&&o.y<=i.y,l=a.z<=i.z&&i.z<=o.z||t.z<=o.z&&o.z<=i.z;return r&&s&&l}volume(){const e=this.lowerBound,t=this.upperBound;return(t.x-e.x)*(t.y-e.y)*(t.z-e.z)}contains(e){const t=this.lowerBound,i=this.upperBound,a=e.lowerBound,o=e.upperBound;return t.x<=a.x&&i.x>=o.x&&t.y<=a.y&&i.y>=o.y&&t.z<=a.z&&i.z>=o.z}getCorners(e,t,i,a,o,r,s,l){const c=this.lowerBound,u=this.upperBound;e.copy(c),t.set(u.x,c.y,c.z),i.set(u.x,u.y,c.z),a.set(c.x,u.y,u.z),o.set(u.x,c.y,u.z),r.set(c.x,u.y,c.z),s.set(c.x,c.y,u.z),l.copy(u)}toLocalFrame(e,t){const i=RF,a=i[0],o=i[1],r=i[2],s=i[3],l=i[4],c=i[5],u=i[6],C=i[7];this.getCorners(a,o,r,s,l,c,u,C);for(let h=0;h!==8;h++){const m=i[h];e.pointToLocal(m,m)}return t.setFromPoints(i)}toWorldFrame(e,t){const i=RF,a=i[0],o=i[1],r=i[2],s=i[3],l=i[4],c=i[5],u=i[6],C=i[7];this.getCorners(a,o,r,s,l,c,u,C);for(let h=0;h!==8;h++){const m=i[h];e.pointToWorld(m,m)}return t.setFromPoints(i)}overlapsRay(e){const{direction:t,from:i}=e,a=1/t.x,o=1/t.y,r=1/t.z,s=(this.lowerBound.x-i.x)*a,l=(this.upperBound.x-i.x)*a,c=(this.lowerBound.y-i.y)*o,u=(this.upperBound.y-i.y)*o,C=(this.lowerBound.z-i.z)*r,h=(this.upperBound.z-i.z)*r,m=Math.max(Math.max(Math.min(s,l),Math.min(c,u)),Math.min(C,h)),p=Math.min(Math.min(Math.max(s,l),Math.max(c,u)),Math.max(C,h));return!(p<0||m>p)}}const wF=new Me,RF=[new Me,new Me,new Me,new Me,new Me,new Me,new Me,new Me];class Lr{constructor(e,t,i,a){e===void 0&&(e=0),t===void 0&&(t=0),i===void 0&&(i=0),a===void 0&&(a=1),this.x=e,this.y=t,this.z=i,this.w=a}set(e,t,i,a){return this.x=e,this.y=t,this.z=i,this.w=a,this}toString(){return`${this.x},${this.y},${this.z},${this.w}`}toArray(){return[this.x,this.y,this.z,this.w]}setFromAxisAngle(e,t){const i=Math.sin(t*.5);return this.x=e.x*i,this.y=e.y*i,this.z=e.z*i,this.w=Math.cos(t*.5),this}toAxisAngle(e){e===void 0&&(e=new Me),this.normalize();const t=2*Math.acos(this.w),i=Math.sqrt(1-this.w*this.w);return i<.001?(e.x=this.x,e.y=this.y,e.z=this.z):(e.x=this.x/i,e.y=this.y/i,e.z=this.z/i),[e,t]}setFromVectors(e,t){if(e.isAntiparallelTo(t)){const i=qAe,a=$Ae;e.tangents(i,a),this.setFromAxisAngle(i,Math.PI)}else{const i=e.cross(t);this.x=i.x,this.y=i.y,this.z=i.z,this.w=Math.sqrt(e.length()**2*t.length()**2)+e.dot(t),this.normalize()}return this}mult(e,t){t===void 0&&(t=new Lr);const i=this.x,a=this.y,o=this.z,r=this.w,s=e.x,l=e.y,c=e.z,u=e.w;return t.x=i*u+r*s+a*c-o*l,t.y=a*u+r*l+o*s-i*c,t.z=o*u+r*c+i*l-a*s,t.w=r*u-i*s-a*l-o*c,t}inverse(e){e===void 0&&(e=new Lr);const t=this.x,i=this.y,a=this.z,o=this.w;this.conjugate(e);const r=1/(t*t+i*i+a*a+o*o);return e.x*=r,e.y*=r,e.z*=r,e.w*=r,e}conjugate(e){return e===void 0&&(e=new Lr),e.x=-this.x,e.y=-this.y,e.z=-this.z,e.w=this.w,e}normalize(){let e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return e===0?(this.x=0,this.y=0,this.z=0,this.w=0):(e=1/e,this.x*=e,this.y*=e,this.z*=e,this.w*=e),this}normalizeFast(){const e=(3-(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w))/2;return e===0?(this.x=0,this.y=0,this.z=0,this.w=0):(this.x*=e,this.y*=e,this.z*=e,this.w*=e),this}vmult(e,t){t===void 0&&(t=new Me);const i=e.x,a=e.y,o=e.z,r=this.x,s=this.y,l=this.z,c=this.w,u=c*i+s*o-l*a,C=c*a+l*i-r*o,h=c*o+r*a-s*i,m=-r*i-s*a-l*o;return t.x=u*c+m*-r+C*-l-h*-s,t.y=C*c+m*-s+h*-r-u*-l,t.z=h*c+m*-l+u*-s-C*-r,t}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this}toEuler(e,t){t===void 0&&(t="YZX");let i,a,o;const r=this.x,s=this.y,l=this.z,c=this.w;switch(t){case"YZX":const u=r*s+l*c;if(u>.499&&(i=2*Math.atan2(r,c),a=Math.PI/2,o=0),u<-.499&&(i=-2*Math.atan2(r,c),a=-Math.PI/2,o=0),i===void 0){const C=r*r,h=s*s,m=l*l;i=Math.atan2(2*s*c-2*r*l,1-2*h-2*m),a=Math.asin(2*u),o=Math.atan2(2*r*c-2*s*l,1-2*C-2*m)}break;default:throw new Error(`Euler order ${t} not supported yet.`)}e.y=i,e.z=a,e.x=o}setFromEuler(e,t,i,a){a===void 0&&(a="XYZ");const o=Math.cos(e/2),r=Math.cos(t/2),s=Math.cos(i/2),l=Math.sin(e/2),c=Math.sin(t/2),u=Math.sin(i/2);return a==="XYZ"?(this.x=l*r*s+o*c*u,this.y=o*c*s-l*r*u,this.z=o*r*u+l*c*s,this.w=o*r*s-l*c*u):a==="YXZ"?(this.x=l*r*s+o*c*u,this.y=o*c*s-l*r*u,this.z=o*r*u-l*c*s,this.w=o*r*s+l*c*u):a==="ZXY"?(this.x=l*r*s-o*c*u,this.y=o*c*s+l*r*u,this.z=o*r*u+l*c*s,this.w=o*r*s-l*c*u):a==="ZYX"?(this.x=l*r*s-o*c*u,this.y=o*c*s+l*r*u,this.z=o*r*u-l*c*s,this.w=o*r*s+l*c*u):a==="YZX"?(this.x=l*r*s+o*c*u,this.y=o*c*s+l*r*u,this.z=o*r*u-l*c*s,this.w=o*r*s-l*c*u):a==="XZY"&&(this.x=l*r*s-o*c*u,this.y=o*c*s-l*r*u,this.z=o*r*u+l*c*s,this.w=o*r*s+l*c*u),this}clone(){return new Lr(this.x,this.y,this.z,this.w)}slerp(e,t,i){i===void 0&&(i=new Lr);const a=this.x,o=this.y,r=this.z,s=this.w;let l=e.x,c=e.y,u=e.z,C=e.w,h,m,p,B,b;return m=a*l+o*c+r*u+s*C,m<0&&(m=-m,l=-l,c=-c,u=-u,C=-C),1-m>1e-6?(h=Math.acos(m),p=Math.sin(h),B=Math.sin((1-t)*h)/p,b=Math.sin(t*h)/p):(B=1-t,b=t),i.x=B*a+b*l,i.y=B*o+b*c,i.z=B*r+b*u,i.w=B*s+b*C,i}integrate(e,t,i,a){a===void 0&&(a=new Lr);const o=e.x*i.x,r=e.y*i.y,s=e.z*i.z,l=this.x,c=this.y,u=this.z,C=this.w,h=t*.5;return a.x+=h*(o*C+r*u-s*c),a.y+=h*(r*C+s*l-o*u),a.z+=h*(s*C+o*c-r*l),a.w+=h*(-o*l-r*c-s*u),a}}const qAe=new Me,$Ae=new Me,eme={SPHERE:1,PLANE:2,BOX:4,COMPOUND:8,CONVEXPOLYHEDRON:16,HEIGHTFIELD:32,PARTICLE:64,CYLINDER:128,TRIMESH:256};class Zn{constructor(e){e===void 0&&(e={}),this.id=Zn.idCounter++,this.type=e.type||0,this.boundingSphereRadius=0,this.collisionResponse=e.collisionResponse?e.collisionResponse:!0,this.collisionFilterGroup=e.collisionFilterGroup!==void 0?e.collisionFilterGroup:1,this.collisionFilterMask=e.collisionFilterMask!==void 0?e.collisionFilterMask:-1,this.material=e.material?e.material:null,this.body=null}updateBoundingSphereRadius(){throw`computeBoundingSphereRadius() not implemented for shape type ${this.type}`}volume(){throw`volume() not implemented for shape type ${this.type}`}calculateLocalInertia(e,t){throw`calculateLocalInertia() not implemented for shape type ${this.type}`}calculateWorldAABB(e,t,i,a){throw`calculateWorldAABB() not implemented for shape type ${this.type}`}}Zn.idCounter=0;Zn.types=eme;class fs{constructor(e){e===void 0&&(e={}),this.position=new Me,this.quaternion=new Lr,e.position&&this.position.copy(e.position),e.quaternion&&this.quaternion.copy(e.quaternion)}pointToLocal(e,t){return fs.pointToLocalFrame(this.position,this.quaternion,e,t)}pointToWorld(e,t){return fs.pointToWorldFrame(this.position,this.quaternion,e,t)}vectorToWorldFrame(e,t){return t===void 0&&(t=new Me),this.quaternion.vmult(e,t),t}static pointToLocalFrame(e,t,i,a){return a===void 0&&(a=new Me),i.vsub(e,a),t.conjugate(ZF),ZF.vmult(a,a),a}static pointToWorldFrame(e,t,i,a){return a===void 0&&(a=new Me),t.vmult(i,a),a.vadd(e,a),a}static vectorToWorldFrame(e,t,i){return i===void 0&&(i=new Me),e.vmult(t,i),i}static vectorToLocalFrame(e,t,i,a){return a===void 0&&(a=new Me),t.w*=-1,t.vmult(i,a),t.w*=-1,a}}const ZF=new Lr;new Me;new Me;new Me;new Me;new Me,new Me,new Me,new Me,new Me,new Me,new Me,new Me;new Me;new Lr;new wl;new iu;new iu;new iu;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Lr;new Me;new Me;new Me;new Me;class FZ{constructor(){this.rayFromWorld=new Me,this.rayToWorld=new Me,this.hitNormalWorld=new Me,this.hitPointWorld=new Me,this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}reset(){this.rayFromWorld.setZero(),this.rayToWorld.setZero(),this.hitNormalWorld.setZero(),this.hitPointWorld.setZero(),this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}abort(){this.shouldStop=!0}set(e,t,i,a,o,r,s){this.rayFromWorld.copy(e),this.rayToWorld.copy(t),this.hitNormalWorld.copy(i),this.hitPointWorld.copy(a),this.shape=o,this.body=r,this.distance=s}}let cL,gL,uL,dL,CL,IL,hL;const JM={CLOSEST:1,ANY:2,ALL:4};cL=Zn.types.SPHERE;gL=Zn.types.PLANE;uL=Zn.types.BOX;dL=Zn.types.CYLINDER;CL=Zn.types.CONVEXPOLYHEDRON;IL=Zn.types.HEIGHTFIELD;hL=Zn.types.TRIMESH;class dr{get[cL](){return this._intersectSphere}get[gL](){return this._intersectPlane}get[uL](){return this._intersectBox}get[dL](){return this._intersectConvex}get[CL](){return this._intersectConvex}get[IL](){return this._intersectHeightfield}get[hL](){return this._intersectTrimesh}constructor(e,t){e===void 0&&(e=new Me),t===void 0&&(t=new Me),this.from=e.clone(),this.to=t.clone(),this.direction=new Me,this.precision=1e-4,this.checkCollisionResponse=!0,this.skipBackfaces=!1,this.collisionFilterMask=-1,this.collisionFilterGroup=-1,this.mode=dr.ANY,this.result=new FZ,this.hasHit=!1,this.callback=i=>{}}intersectWorld(e,t){return this.mode=t.mode||dr.ANY,this.result=t.result||new FZ,this.skipBackfaces=!!t.skipBackfaces,this.collisionFilterMask=typeof t.collisionFilterMask<"u"?t.collisionFilterMask:-1,this.collisionFilterGroup=typeof t.collisionFilterGroup<"u"?t.collisionFilterGroup:-1,this.checkCollisionResponse=typeof t.checkCollisionResponse<"u"?t.checkCollisionResponse:!0,t.from&&this.from.copy(t.from),t.to&&this.to.copy(t.to),this.callback=t.callback||(()=>{}),this.hasHit=!1,this.result.reset(),this.updateDirection(),this.getAABB(xF),G1.length=0,e.broadphase.aabbQuery(e,xF,G1),this.intersectBodies(G1),this.hasHit}intersectBody(e,t){t&&(this.result=t,this.updateDirection());const i=this.checkCollisionResponse;if(i&&!e.collisionResponse||(this.collisionFilterGroup&e.collisionFilterMask)===0||(e.collisionFilterGroup&this.collisionFilterMask)===0)return;const a=tme,o=nme;for(let r=0,s=e.shapes.length;r<s;r++){const l=e.shapes[r];if(!(i&&!l.collisionResponse)&&(e.quaternion.mult(e.shapeOrientations[r],o),e.quaternion.vmult(e.shapeOffsets[r],a),a.vadd(e.position,a),this.intersectShape(l,o,a,e),this.result.shouldStop))break}}intersectBodies(e,t){t&&(this.result=t,this.updateDirection());for(let i=0,a=e.length;!this.result.shouldStop&&i<a;i++)this.intersectBody(e[i])}updateDirection(){this.to.vsub(this.from,this.direction),this.direction.normalize()}intersectShape(e,t,i,a){const o=this.from;if(fme(o,this.direction,i)>e.boundingSphereRadius)return;const s=this[e.type];s&&s.call(this,e,t,i,a,e)}_intersectBox(e,t,i,a,o){return this._intersectConvex(e.convexPolyhedronRepresentation,t,i,a,o)}_intersectPlane(e,t,i,a,o){const r=this.from,s=this.to,l=this.direction,c=new Me(0,0,1);t.vmult(c,c);const u=new Me;r.vsub(i,u);const C=u.dot(c);s.vsub(i,u);const h=u.dot(c);if(C*h>0||r.distanceTo(s)<C)return;const m=c.dot(l);if(Math.abs(m)<this.precision)return;const p=new Me,B=new Me,b=new Me;r.vsub(i,p);const y=-c.dot(p)/m;l.scale(y,B),r.vadd(B,b),this.reportIntersection(c,b,o,a,-1)}getAABB(e){const{lowerBound:t,upperBound:i}=e,a=this.to,o=this.from;t.x=Math.min(a.x,o.x),t.y=Math.min(a.y,o.y),t.z=Math.min(a.z,o.z),i.x=Math.max(a.x,o.x),i.y=Math.max(a.y,o.y),i.z=Math.max(a.z,o.z)}_intersectHeightfield(e,t,i,a,o){e.data,e.elementSize;const r=ime;r.from.copy(this.from),r.to.copy(this.to),fs.pointToLocalFrame(i,t,r.from,r.from),fs.pointToLocalFrame(i,t,r.to,r.to),r.updateDirection();const s=ame;let l,c,u,C;l=c=0,u=C=e.data.length-1;const h=new wl;r.getAABB(h),e.getIndexOfPosition(h.lowerBound.x,h.lowerBound.y,s,!0),l=Math.max(l,s[0]),c=Math.max(c,s[1]),e.getIndexOfPosition(h.upperBound.x,h.upperBound.y,s,!0),u=Math.min(u,s[0]+1),C=Math.min(C,s[1]+1);for(let m=l;m<u;m++)for(let p=c;p<C;p++){if(this.result.shouldStop)return;if(e.getAabbAtIndex(m,p,h),!!h.overlapsRay(r)){if(e.getConvexTrianglePillar(m,p,!1),fs.pointToWorldFrame(i,t,e.pillarOffset,uy),this._intersectConvex(e.pillarConvex,t,uy,a,o,MF),this.result.shouldStop)return;e.getConvexTrianglePillar(m,p,!0),fs.pointToWorldFrame(i,t,e.pillarOffset,uy),this._intersectConvex(e.pillarConvex,t,uy,a,o,MF)}}}_intersectSphere(e,t,i,a,o){const r=this.from,s=this.to,l=e.radius,c=(s.x-r.x)**2+(s.y-r.y)**2+(s.z-r.z)**2,u=2*((s.x-r.x)*(r.x-i.x)+(s.y-r.y)*(r.y-i.y)+(s.z-r.z)*(r.z-i.z)),C=(r.x-i.x)**2+(r.y-i.y)**2+(r.z-i.z)**2-l**2,h=u**2-4*c*C,m=ome,p=rme;if(!(h<0))if(h===0)r.lerp(s,h,m),m.vsub(i,p),p.normalize(),this.reportIntersection(p,m,o,a,-1);else{const B=(-u-Math.sqrt(h))/(2*c),b=(-u+Math.sqrt(h))/(2*c);if(B>=0&&B<=1&&(r.lerp(s,B,m),m.vsub(i,p),p.normalize(),this.reportIntersection(p,m,o,a,-1)),this.result.shouldStop)return;b>=0&&b<=1&&(r.lerp(s,b,m),m.vsub(i,p),p.normalize(),this.reportIntersection(p,m,o,a,-1))}}_intersectConvex(e,t,i,a,o,r){const s=sme,l=WF,c=r&&r.faceList||null,u=e.faces,C=e.vertices,h=e.faceNormals,m=this.direction,p=this.from,B=this.to,b=p.distanceTo(B),y=c?c.length:u.length,S=this.result;for(let R=0;!S.shouldStop&&R<y;R++){const Z=c?c[R]:R,x=u[Z],M=h[Z],E=t,F=i;l.copy(C[x[0]]),E.vmult(l,l),l.vadd(F,l),l.vsub(p,l),E.vmult(M,s);const N=m.dot(s);if(Math.abs(N)<this.precision)continue;const H=s.dot(l)/N;if(!(H<0)){m.scale(H,Cs),Cs.vadd(p,Cs),ic.copy(C[x[0]]),E.vmult(ic,ic),F.vadd(ic,ic);for(let z=1;!S.shouldStop&&z<x.length-1;z++){eg.copy(C[x[z]]),tg.copy(C[x[z+1]]),E.vmult(eg,eg),E.vmult(tg,tg),F.vadd(eg,eg),F.vadd(tg,tg);const _=Cs.distanceTo(p);!(dr.pointInTriangle(Cs,ic,eg,tg)||dr.pointInTriangle(Cs,eg,ic,tg))||_>b||this.reportIntersection(s,Cs,o,a,Z)}}}}_intersectTrimesh(e,t,i,a,o,r){const s=lme,l=Ime,c=hme,u=WF,C=cme,h=gme,m=ume,p=Cme,B=dme,b=e.indices;e.vertices;const y=this.from,S=this.to,R=this.direction;c.position.copy(i),c.quaternion.copy(t),fs.vectorToLocalFrame(i,t,R,C),fs.pointToLocalFrame(i,t,y,h),fs.pointToLocalFrame(i,t,S,m),m.x*=e.scale.x,m.y*=e.scale.y,m.z*=e.scale.z,h.x*=e.scale.x,h.y*=e.scale.y,h.z*=e.scale.z,m.vsub(h,C),C.normalize();const Z=h.distanceSquared(m);e.tree.rayQuery(this,c,l);for(let x=0,M=l.length;!this.result.shouldStop&&x!==M;x++){const E=l[x];e.getNormal(E,s),e.getVertex(b[E*3],ic),ic.vsub(h,u);const F=C.dot(s),N=s.dot(u)/F;if(N<0)continue;C.scale(N,Cs),Cs.vadd(h,Cs),e.getVertex(b[E*3+1],eg),e.getVertex(b[E*3+2],tg);const H=Cs.distanceSquared(h);!(dr.pointInTriangle(Cs,eg,ic,tg)||dr.pointInTriangle(Cs,ic,eg,tg))||H>Z||(fs.vectorToWorldFrame(t,s,B),fs.pointToWorldFrame(i,t,Cs,p),this.reportIntersection(B,p,o,a,E))}l.length=0}reportIntersection(e,t,i,a,o){const r=this.from,s=this.to,l=r.distanceTo(t),c=this.result;if(!(this.skipBackfaces&&e.dot(this.direction)>0))switch(c.hitFaceIndex=typeof o<"u"?o:-1,this.mode){case dr.ALL:this.hasHit=!0,c.set(r,s,e,t,i,a,l),c.hasHit=!0,this.callback(c);break;case dr.CLOSEST:(l<c.distance||!c.hasHit)&&(this.hasHit=!0,c.hasHit=!0,c.set(r,s,e,t,i,a,l));break;case dr.ANY:this.hasHit=!0,c.hasHit=!0,c.set(r,s,e,t,i,a,l),c.shouldStop=!0;break}}static pointInTriangle(e,t,i,a){a.vsub(t,LC),i.vsub(t,Dm),e.vsub(t,S1);const o=LC.dot(LC),r=LC.dot(Dm),s=LC.dot(S1),l=Dm.dot(Dm),c=Dm.dot(S1);let u,C;return(u=l*s-r*c)>=0&&(C=o*c-r*s)>=0&&u+C<o*l-r*r}}dr.CLOSEST=JM.CLOSEST;dr.ANY=JM.ANY;dr.ALL=JM.ALL;const xF=new wl,G1=[],Dm=new Me,S1=new Me,tme=new Me,nme=new Lr,Cs=new Me,ic=new Me,eg=new Me,tg=new Me;new Me;new FZ;const MF={faceList:[0]},uy=new Me,ime=new dr,ame=[],ome=new Me,rme=new Me,sme=new Me;new Me;new Me;const WF=new Me,lme=new Me,cme=new Me,gme=new Me,ume=new Me,dme=new Me,Cme=new Me;new wl;const Ime=[],hme=new fs,LC=new Me,dy=new Me;function fme(n,e,t){t.vsub(n,LC);const i=LC.dot(e);return e.scale(i,dy),dy.vadd(n,dy),t.distanceTo(dy)}new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new dr;new Me;new Me;new Me;new Me(1,0,0),new Me(0,1,0),new Me(0,0,1);new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new wl;new Me;new wl;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new wl;new Me;new fs;new wl;Zn.types.SPHERE,Zn.types.SPHERE|Zn.types.PLANE,Zn.types.BOX|Zn.types.BOX,Zn.types.SPHERE|Zn.types.BOX,Zn.types.PLANE|Zn.types.BOX,Zn.types.CONVEXPOLYHEDRON,Zn.types.SPHERE|Zn.types.CONVEXPOLYHEDRON,Zn.types.PLANE|Zn.types.CONVEXPOLYHEDRON,Zn.types.BOX|Zn.types.CONVEXPOLYHEDRON,Zn.types.SPHERE|Zn.types.HEIGHTFIELD,Zn.types.BOX|Zn.types.HEIGHTFIELD,Zn.types.CONVEXPOLYHEDRON|Zn.types.HEIGHTFIELD,Zn.types.PARTICLE|Zn.types.SPHERE,Zn.types.PLANE|Zn.types.PARTICLE,Zn.types.BOX|Zn.types.PARTICLE,Zn.types.PARTICLE|Zn.types.CONVEXPOLYHEDRON,Zn.types.CYLINDER,Zn.types.SPHERE|Zn.types.CYLINDER,Zn.types.PLANE|Zn.types.CYLINDER,Zn.types.BOX|Zn.types.CYLINDER,Zn.types.CONVEXPOLYHEDRON|Zn.types.CYLINDER,Zn.types.HEIGHTFIELD|Zn.types.CYLINDER,Zn.types.PARTICLE|Zn.types.CYLINDER,Zn.types.SPHERE|Zn.types.TRIMESH,Zn.types.PLANE|Zn.types.TRIMESH;new Me;new Me;new Me;new Me;new Me;new Lr;new Lr;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new wl;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me,new Me,new Me,new Me,new Me,new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Lr;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new Me;new wl;new dr;const Om=globalThis.performance||{};if(!Om.now){let n=Date.now();Om.timing&&Om.timing.navigationStart&&(n=Om.timing.navigationStart),Om.now=()=>Date.now()-n}new Me;class au{constructor(e){e===void 0&&(e=[0,0,0,0,0,0,0,0,0]),this.elements=e}identity(){const e=this.elements;e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1}setZero(){const e=this.elements;e[0]=0,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=0,e[6]=0,e[7]=0,e[8]=0}setTrace(e){const t=this.elements;t[0]=e.x,t[4]=e.y,t[8]=e.z}getTrace(e){e===void 0&&(e=new We);const t=this.elements;return e.x=t[0],e.y=t[4],e.z=t[8],e}vmult(e,t){t===void 0&&(t=new We);const i=this.elements,a=e.x,o=e.y,r=e.z;return t.x=i[0]*a+i[1]*o+i[2]*r,t.y=i[3]*a+i[4]*o+i[5]*r,t.z=i[6]*a+i[7]*o+i[8]*r,t}smult(e){for(let t=0;t<this.elements.length;t++)this.elements[t]*=e}mmult(e,t){t===void 0&&(t=new au);const i=this.elements,a=e.elements,o=t.elements,r=i[0],s=i[1],l=i[2],c=i[3],u=i[4],C=i[5],h=i[6],m=i[7],p=i[8],B=a[0],b=a[1],y=a[2],S=a[3],R=a[4],Z=a[5],x=a[6],M=a[7],E=a[8];return o[0]=r*B+s*S+l*x,o[1]=r*b+s*R+l*M,o[2]=r*y+s*Z+l*E,o[3]=c*B+u*S+C*x,o[4]=c*b+u*R+C*M,o[5]=c*y+u*Z+C*E,o[6]=h*B+m*S+p*x,o[7]=h*b+m*R+p*M,o[8]=h*y+m*Z+p*E,t}scale(e,t){t===void 0&&(t=new au);const i=this.elements,a=t.elements;for(let o=0;o!==3;o++)a[3*o+0]=e.x*i[3*o+0],a[3*o+1]=e.y*i[3*o+1],a[3*o+2]=e.z*i[3*o+2];return t}solve(e,t){t===void 0&&(t=new We);const i=3,a=4,o=[];let r,s;for(r=0;r<i*a;r++)o.push(0);for(r=0;r<3;r++)for(s=0;s<3;s++)o[r+a*s]=this.elements[r+3*s];o[3+4*0]=e.x,o[3+4*1]=e.y,o[3+4*2]=e.z;let l=3;const c=l;let u;const C=4;let h;do{if(r=c-l,o[r+a*r]===0){for(s=r+1;s<c;s++)if(o[r+a*s]!==0){u=C;do h=C-u,o[h+a*r]+=o[h+a*s];while(--u);break}}if(o[r+a*r]!==0)for(s=r+1;s<c;s++){const m=o[r+a*s]/o[r+a*r];u=C;do h=C-u,o[h+a*s]=h<=r?0:o[h+a*s]-o[h+a*r]*m;while(--u)}}while(--l);if(t.z=o[2*a+3]/o[2*a+2],t.y=(o[1*a+3]-o[1*a+2]*t.z)/o[1*a+1],t.x=(o[0*a+3]-o[0*a+2]*t.z-o[0*a+1]*t.y)/o[0*a+0],isNaN(t.x)||isNaN(t.y)||isNaN(t.z)||t.x===1/0||t.y===1/0||t.z===1/0)throw`Could not solve equation! Got x=[${t.toString()}], b=[${e.toString()}], A=[${this.toString()}]`;return t}e(e,t,i){if(i===void 0)return this.elements[t+3*e];this.elements[t+3*e]=i}copy(e){for(let t=0;t<e.elements.length;t++)this.elements[t]=e.elements[t];return this}toString(){let e="";const t=",";for(let i=0;i<9;i++)e+=this.elements[i]+t;return e}reverse(e){e===void 0&&(e=new au);const t=3,i=6,a=Ame;let o,r;for(o=0;o<3;o++)for(r=0;r<3;r++)a[o+i*r]=this.elements[o+3*r];a[3+6*0]=1,a[3+6*1]=0,a[3+6*2]=0,a[4+6*0]=0,a[4+6*1]=1,a[4+6*2]=0,a[5+6*0]=0,a[5+6*1]=0,a[5+6*2]=1;let s=3;const l=s;let c;const u=i;let C;do{if(o=l-s,a[o+i*o]===0){for(r=o+1;r<l;r++)if(a[o+i*r]!==0){c=u;do C=u-c,a[C+i*o]+=a[C+i*r];while(--c);break}}if(a[o+i*o]!==0)for(r=o+1;r<l;r++){const h=a[o+i*r]/a[o+i*o];c=u;do C=u-c,a[C+i*r]=C<=o?0:a[C+i*r]-a[C+i*o]*h;while(--c)}}while(--s);o=2;do{r=o-1;do{const h=a[o+i*r]/a[o+i*o];c=i;do C=i-c,a[C+i*r]=a[C+i*r]-a[C+i*o]*h;while(--c)}while(r--)}while(--o);o=2;do{const h=1/a[o+i*o];c=i;do C=i-c,a[C+i*o]=a[C+i*o]*h;while(--c)}while(o--);o=2;do{r=2;do{if(C=a[t+r+i*o],isNaN(C)||C===1/0)throw`Could not reverse! A=[${this.toString()}]`;e.e(o,r,C)}while(r--)}while(o--);return e}setRotationFromQuaternion(e){const t=e.x,i=e.y,a=e.z,o=e.w,r=t+t,s=i+i,l=a+a,c=t*r,u=t*s,C=t*l,h=i*s,m=i*l,p=a*l,B=o*r,b=o*s,y=o*l,S=this.elements;return S[3*0+0]=1-(h+p),S[3*0+1]=u-y,S[3*0+2]=C+b,S[3*1+0]=u+y,S[3*1+1]=1-(c+p),S[3*1+2]=m-B,S[3*2+0]=C-b,S[3*2+1]=m+B,S[3*2+2]=1-(c+h),this}transpose(e){e===void 0&&(e=new au);const t=this.elements,i=e.elements;let a;return i[0]=t[0],i[4]=t[4],i[8]=t[8],a=t[1],i[1]=t[3],i[3]=a,a=t[2],i[2]=t[6],i[6]=a,a=t[5],i[5]=t[7],i[7]=a,e}}const Ame=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];class We{constructor(e,t,i){e===void 0&&(e=0),t===void 0&&(t=0),i===void 0&&(i=0),this.x=e,this.y=t,this.z=i}cross(e,t){t===void 0&&(t=new We);const i=e.x,a=e.y,o=e.z,r=this.x,s=this.y,l=this.z;return t.x=s*o-l*a,t.y=l*i-r*o,t.z=r*a-s*i,t}set(e,t,i){return this.x=e,this.y=t,this.z=i,this}setZero(){this.x=this.y=this.z=0}vadd(e,t){if(t)t.x=e.x+this.x,t.y=e.y+this.y,t.z=e.z+this.z;else return new We(this.x+e.x,this.y+e.y,this.z+e.z)}vsub(e,t){if(t)t.x=this.x-e.x,t.y=this.y-e.y,t.z=this.z-e.z;else return new We(this.x-e.x,this.y-e.y,this.z-e.z)}crossmat(){return new au([0,-this.z,this.y,this.z,0,-this.x,-this.y,this.x,0])}normalize(){const e=this.x,t=this.y,i=this.z,a=Math.sqrt(e*e+t*t+i*i);if(a>0){const o=1/a;this.x*=o,this.y*=o,this.z*=o}else this.x=0,this.y=0,this.z=0;return a}unit(e){e===void 0&&(e=new We);const t=this.x,i=this.y,a=this.z;let o=Math.sqrt(t*t+i*i+a*a);return o>0?(o=1/o,e.x=t*o,e.y=i*o,e.z=a*o):(e.x=1,e.y=0,e.z=0),e}length(){const e=this.x,t=this.y,i=this.z;return Math.sqrt(e*e+t*t+i*i)}lengthSquared(){return this.dot(this)}distanceTo(e){const t=this.x,i=this.y,a=this.z,o=e.x,r=e.y,s=e.z;return Math.sqrt((o-t)*(o-t)+(r-i)*(r-i)+(s-a)*(s-a))}distanceSquared(e){const t=this.x,i=this.y,a=this.z,o=e.x,r=e.y,s=e.z;return(o-t)*(o-t)+(r-i)*(r-i)+(s-a)*(s-a)}scale(e,t){t===void 0&&(t=new We);const i=this.x,a=this.y,o=this.z;return t.x=e*i,t.y=e*a,t.z=e*o,t}vmul(e,t){return t===void 0&&(t=new We),t.x=e.x*this.x,t.y=e.y*this.y,t.z=e.z*this.z,t}addScaledVector(e,t,i){return i===void 0&&(i=new We),i.x=this.x+e*t.x,i.y=this.y+e*t.y,i.z=this.z+e*t.z,i}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}isZero(){return this.x===0&&this.y===0&&this.z===0}negate(e){return e===void 0&&(e=new We),e.x=-this.x,e.y=-this.y,e.z=-this.z,e}tangents(e,t){const i=this.length();if(i>0){const a=mme,o=1/i;a.set(this.x*o,this.y*o,this.z*o);const r=pme;Math.abs(a.x)<.9?(r.set(1,0,0),a.cross(r,e)):(r.set(0,1,0),a.cross(r,e)),a.cross(e,t)}else e.set(1,0,0),t.set(0,1,0)}toString(){return`${this.x},${this.y},${this.z}`}toArray(){return[this.x,this.y,this.z]}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}lerp(e,t,i){const a=this.x,o=this.y,r=this.z;i.x=a+(e.x-a)*t,i.y=o+(e.y-o)*t,i.z=r+(e.z-r)*t}almostEquals(e,t){return t===void 0&&(t=1e-6),!(Math.abs(this.x-e.x)>t||Math.abs(this.y-e.y)>t||Math.abs(this.z-e.z)>t)}almostZero(e){return e===void 0&&(e=1e-6),!(Math.abs(this.x)>e||Math.abs(this.y)>e||Math.abs(this.z)>e)}isAntiparallelTo(e,t){return this.negate(VF),VF.almostEquals(e,t)}clone(){return new We(this.x,this.y,this.z)}}We.ZERO=new We(0,0,0);We.UNIT_X=new We(1,0,0);We.UNIT_Y=new We(0,1,0);We.UNIT_Z=new We(0,0,1);const mme=new We,pme=new We,VF=new We;class Rl{constructor(e){e===void 0&&(e={}),this.lowerBound=new We,this.upperBound=new We,e.lowerBound&&this.lowerBound.copy(e.lowerBound),e.upperBound&&this.upperBound.copy(e.upperBound)}setFromPoints(e,t,i,a){const o=this.lowerBound,r=this.upperBound,s=i;o.copy(e[0]),s&&s.vmult(o,o),r.copy(o);for(let l=1;l<e.length;l++){let c=e[l];s&&(s.vmult(c,NF),c=NF),c.x>r.x&&(r.x=c.x),c.x<o.x&&(o.x=c.x),c.y>r.y&&(r.y=c.y),c.y<o.y&&(o.y=c.y),c.z>r.z&&(r.z=c.z),c.z<o.z&&(o.z=c.z)}return t&&(t.vadd(o,o),t.vadd(r,r)),a&&(o.x-=a,o.y-=a,o.z-=a,r.x+=a,r.y+=a,r.z+=a),this}copy(e){return this.lowerBound.copy(e.lowerBound),this.upperBound.copy(e.upperBound),this}clone(){return new Rl().copy(this)}extend(e){this.lowerBound.x=Math.min(this.lowerBound.x,e.lowerBound.x),this.upperBound.x=Math.max(this.upperBound.x,e.upperBound.x),this.lowerBound.y=Math.min(this.lowerBound.y,e.lowerBound.y),this.upperBound.y=Math.max(this.upperBound.y,e.upperBound.y),this.lowerBound.z=Math.min(this.lowerBound.z,e.lowerBound.z),this.upperBound.z=Math.max(this.upperBound.z,e.upperBound.z)}overlaps(e){const t=this.lowerBound,i=this.upperBound,a=e.lowerBound,o=e.upperBound,r=a.x<=i.x&&i.x<=o.x||t.x<=o.x&&o.x<=i.x,s=a.y<=i.y&&i.y<=o.y||t.y<=o.y&&o.y<=i.y,l=a.z<=i.z&&i.z<=o.z||t.z<=o.z&&o.z<=i.z;return r&&s&&l}volume(){const e=this.lowerBound,t=this.upperBound;return(t.x-e.x)*(t.y-e.y)*(t.z-e.z)}contains(e){const t=this.lowerBound,i=this.upperBound,a=e.lowerBound,o=e.upperBound;return t.x<=a.x&&i.x>=o.x&&t.y<=a.y&&i.y>=o.y&&t.z<=a.z&&i.z>=o.z}getCorners(e,t,i,a,o,r,s,l){const c=this.lowerBound,u=this.upperBound;e.copy(c),t.set(u.x,c.y,c.z),i.set(u.x,u.y,c.z),a.set(c.x,u.y,u.z),o.set(u.x,c.y,u.z),r.set(c.x,u.y,c.z),s.set(c.x,c.y,u.z),l.copy(u)}toLocalFrame(e,t){const i=EF,a=i[0],o=i[1],r=i[2],s=i[3],l=i[4],c=i[5],u=i[6],C=i[7];this.getCorners(a,o,r,s,l,c,u,C);for(let h=0;h!==8;h++){const m=i[h];e.pointToLocal(m,m)}return t.setFromPoints(i)}toWorldFrame(e,t){const i=EF,a=i[0],o=i[1],r=i[2],s=i[3],l=i[4],c=i[5],u=i[6],C=i[7];this.getCorners(a,o,r,s,l,c,u,C);for(let h=0;h!==8;h++){const m=i[h];e.pointToWorld(m,m)}return t.setFromPoints(i)}overlapsRay(e){const{direction:t,from:i}=e,a=1/t.x,o=1/t.y,r=1/t.z,s=(this.lowerBound.x-i.x)*a,l=(this.upperBound.x-i.x)*a,c=(this.lowerBound.y-i.y)*o,u=(this.upperBound.y-i.y)*o,C=(this.lowerBound.z-i.z)*r,h=(this.upperBound.z-i.z)*r,m=Math.max(Math.max(Math.min(s,l),Math.min(c,u)),Math.min(C,h)),p=Math.min(Math.min(Math.max(s,l),Math.max(c,u)),Math.max(C,h));return!(p<0||m>p)}}const NF=new We,EF=[new We,new We,new We,new We,new We,new We,new We,new We];class _r{constructor(e,t,i,a){e===void 0&&(e=0),t===void 0&&(t=0),i===void 0&&(i=0),a===void 0&&(a=1),this.x=e,this.y=t,this.z=i,this.w=a}set(e,t,i,a){return this.x=e,this.y=t,this.z=i,this.w=a,this}toString(){return`${this.x},${this.y},${this.z},${this.w}`}toArray(){return[this.x,this.y,this.z,this.w]}setFromAxisAngle(e,t){const i=Math.sin(t*.5);return this.x=e.x*i,this.y=e.y*i,this.z=e.z*i,this.w=Math.cos(t*.5),this}toAxisAngle(e){e===void 0&&(e=new We),this.normalize();const t=2*Math.acos(this.w),i=Math.sqrt(1-this.w*this.w);return i<.001?(e.x=this.x,e.y=this.y,e.z=this.z):(e.x=this.x/i,e.y=this.y/i,e.z=this.z/i),[e,t]}setFromVectors(e,t){if(e.isAntiparallelTo(t)){const i=bme,a=vme;e.tangents(i,a),this.setFromAxisAngle(i,Math.PI)}else{const i=e.cross(t);this.x=i.x,this.y=i.y,this.z=i.z,this.w=Math.sqrt(e.length()**2*t.length()**2)+e.dot(t),this.normalize()}return this}mult(e,t){t===void 0&&(t=new _r);const i=this.x,a=this.y,o=this.z,r=this.w,s=e.x,l=e.y,c=e.z,u=e.w;return t.x=i*u+r*s+a*c-o*l,t.y=a*u+r*l+o*s-i*c,t.z=o*u+r*c+i*l-a*s,t.w=r*u-i*s-a*l-o*c,t}inverse(e){e===void 0&&(e=new _r);const t=this.x,i=this.y,a=this.z,o=this.w;this.conjugate(e);const r=1/(t*t+i*i+a*a+o*o);return e.x*=r,e.y*=r,e.z*=r,e.w*=r,e}conjugate(e){return e===void 0&&(e=new _r),e.x=-this.x,e.y=-this.y,e.z=-this.z,e.w=this.w,e}normalize(){let e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return e===0?(this.x=0,this.y=0,this.z=0,this.w=0):(e=1/e,this.x*=e,this.y*=e,this.z*=e,this.w*=e),this}normalizeFast(){const e=(3-(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w))/2;return e===0?(this.x=0,this.y=0,this.z=0,this.w=0):(this.x*=e,this.y*=e,this.z*=e,this.w*=e),this}vmult(e,t){t===void 0&&(t=new We);const i=e.x,a=e.y,o=e.z,r=this.x,s=this.y,l=this.z,c=this.w,u=c*i+s*o-l*a,C=c*a+l*i-r*o,h=c*o+r*a-s*i,m=-r*i-s*a-l*o;return t.x=u*c+m*-r+C*-l-h*-s,t.y=C*c+m*-s+h*-r-u*-l,t.z=h*c+m*-l+u*-s-C*-r,t}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this}toEuler(e,t){t===void 0&&(t="YZX");let i,a,o;const r=this.x,s=this.y,l=this.z,c=this.w;switch(t){case"YZX":const u=r*s+l*c;if(u>.499&&(i=2*Math.atan2(r,c),a=Math.PI/2,o=0),u<-.499&&(i=-2*Math.atan2(r,c),a=-Math.PI/2,o=0),i===void 0){const C=r*r,h=s*s,m=l*l;i=Math.atan2(2*s*c-2*r*l,1-2*h-2*m),a=Math.asin(2*u),o=Math.atan2(2*r*c-2*s*l,1-2*C-2*m)}break;default:throw new Error(`Euler order ${t} not supported yet.`)}e.y=i,e.z=a,e.x=o}setFromEuler(e,t,i,a){a===void 0&&(a="XYZ");const o=Math.cos(e/2),r=Math.cos(t/2),s=Math.cos(i/2),l=Math.sin(e/2),c=Math.sin(t/2),u=Math.sin(i/2);return a==="XYZ"?(this.x=l*r*s+o*c*u,this.y=o*c*s-l*r*u,this.z=o*r*u+l*c*s,this.w=o*r*s-l*c*u):a==="YXZ"?(this.x=l*r*s+o*c*u,this.y=o*c*s-l*r*u,this.z=o*r*u-l*c*s,this.w=o*r*s+l*c*u):a==="ZXY"?(this.x=l*r*s-o*c*u,this.y=o*c*s+l*r*u,this.z=o*r*u+l*c*s,this.w=o*r*s-l*c*u):a==="ZYX"?(this.x=l*r*s-o*c*u,this.y=o*c*s+l*r*u,this.z=o*r*u-l*c*s,this.w=o*r*s+l*c*u):a==="YZX"?(this.x=l*r*s+o*c*u,this.y=o*c*s+l*r*u,this.z=o*r*u-l*c*s,this.w=o*r*s-l*c*u):a==="XZY"&&(this.x=l*r*s-o*c*u,this.y=o*c*s-l*r*u,this.z=o*r*u+l*c*s,this.w=o*r*s+l*c*u),this}clone(){return new _r(this.x,this.y,this.z,this.w)}slerp(e,t,i){i===void 0&&(i=new _r);const a=this.x,o=this.y,r=this.z,s=this.w;let l=e.x,c=e.y,u=e.z,C=e.w,h,m,p,B,b;return m=a*l+o*c+r*u+s*C,m<0&&(m=-m,l=-l,c=-c,u=-u,C=-C),1-m>1e-6?(h=Math.acos(m),p=Math.sin(h),B=Math.sin((1-t)*h)/p,b=Math.sin(t*h)/p):(B=1-t,b=t),i.x=B*a+b*l,i.y=B*o+b*c,i.z=B*r+b*u,i.w=B*s+b*C,i}integrate(e,t,i,a){a===void 0&&(a=new _r);const o=e.x*i.x,r=e.y*i.y,s=e.z*i.z,l=this.x,c=this.y,u=this.z,C=this.w,h=t*.5;return a.x+=h*(o*C+r*u-s*c),a.y+=h*(r*C+s*l-o*u),a.z+=h*(s*C+o*c-r*l),a.w+=h*(-o*l-r*c-s*u),a}}const bme=new We,vme=new We,yme={SPHERE:1,PLANE:2,BOX:4,COMPOUND:8,CONVEXPOLYHEDRON:16,HEIGHTFIELD:32,PARTICLE:64,CYLINDER:128,TRIMESH:256};class xn{constructor(e){e===void 0&&(e={}),this.id=xn.idCounter++,this.type=e.type||0,this.boundingSphereRadius=0,this.collisionResponse=e.collisionResponse?e.collisionResponse:!0,this.collisionFilterGroup=e.collisionFilterGroup!==void 0?e.collisionFilterGroup:1,this.collisionFilterMask=e.collisionFilterMask!==void 0?e.collisionFilterMask:-1,this.material=e.material?e.material:null,this.body=null}updateBoundingSphereRadius(){throw`computeBoundingSphereRadius() not implemented for shape type ${this.type}`}volume(){throw`volume() not implemented for shape type ${this.type}`}calculateLocalInertia(e,t){throw`calculateLocalInertia() not implemented for shape type ${this.type}`}calculateWorldAABB(e,t,i,a){throw`calculateWorldAABB() not implemented for shape type ${this.type}`}}xn.idCounter=0;xn.types=yme;class As{constructor(e){e===void 0&&(e={}),this.position=new We,this.quaternion=new _r,e.position&&this.position.copy(e.position),e.quaternion&&this.quaternion.copy(e.quaternion)}pointToLocal(e,t){return As.pointToLocalFrame(this.position,this.quaternion,e,t)}pointToWorld(e,t){return As.pointToWorldFrame(this.position,this.quaternion,e,t)}vectorToWorldFrame(e,t){return t===void 0&&(t=new We),this.quaternion.vmult(e,t),t}static pointToLocalFrame(e,t,i,a){return a===void 0&&(a=new We),i.vsub(e,a),t.conjugate(HF),HF.vmult(a,a),a}static pointToWorldFrame(e,t,i,a){return a===void 0&&(a=new We),t.vmult(i,a),a.vadd(e,a),a}static vectorToWorldFrame(e,t,i){return i===void 0&&(i=new We),e.vmult(t,i),i}static vectorToLocalFrame(e,t,i,a){return a===void 0&&(a=new We),t.w*=-1,t.vmult(i,a),t.w*=-1,a}}const HF=new _r;new We;new We;new We;new We;new We,new We,new We,new We,new We,new We,new We,new We;new We;new _r;new Rl;new au;new au;new au;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new _r;new We;new We;new We;new We;class XZ{constructor(){this.rayFromWorld=new We,this.rayToWorld=new We,this.hitNormalWorld=new We,this.hitPointWorld=new We,this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}reset(){this.rayFromWorld.setZero(),this.rayToWorld.setZero(),this.hitNormalWorld.setZero(),this.hitPointWorld.setZero(),this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}abort(){this.shouldStop=!0}set(e,t,i,a,o,r,s){this.rayFromWorld.copy(e),this.rayToWorld.copy(t),this.hitNormalWorld.copy(i),this.hitPointWorld.copy(a),this.shape=o,this.body=r,this.distance=s}}let fL,AL,mL,pL,bL,vL,yL;const jM={CLOSEST:1,ANY:2,ALL:4};fL=xn.types.SPHERE;AL=xn.types.PLANE;mL=xn.types.BOX;pL=xn.types.CYLINDER;bL=xn.types.CONVEXPOLYHEDRON;vL=xn.types.HEIGHTFIELD;yL=xn.types.TRIMESH;class Cr{get[fL](){return this._intersectSphere}get[AL](){return this._intersectPlane}get[mL](){return this._intersectBox}get[pL](){return this._intersectConvex}get[bL](){return this._intersectConvex}get[vL](){return this._intersectHeightfield}get[yL](){return this._intersectTrimesh}constructor(e,t){e===void 0&&(e=new We),t===void 0&&(t=new We),this.from=e.clone(),this.to=t.clone(),this.direction=new We,this.precision=1e-4,this.checkCollisionResponse=!0,this.skipBackfaces=!1,this.collisionFilterMask=-1,this.collisionFilterGroup=-1,this.mode=Cr.ANY,this.result=new XZ,this.hasHit=!1,this.callback=i=>{}}intersectWorld(e,t){return this.mode=t.mode||Cr.ANY,this.result=t.result||new XZ,this.skipBackfaces=!!t.skipBackfaces,this.collisionFilterMask=typeof t.collisionFilterMask<"u"?t.collisionFilterMask:-1,this.collisionFilterGroup=typeof t.collisionFilterGroup<"u"?t.collisionFilterGroup:-1,this.checkCollisionResponse=typeof t.checkCollisionResponse<"u"?t.checkCollisionResponse:!0,t.from&&this.from.copy(t.from),t.to&&this.to.copy(t.to),this.callback=t.callback||(()=>{}),this.hasHit=!1,this.result.reset(),this.updateDirection(),this.getAABB(FF),w1.length=0,e.broadphase.aabbQuery(e,FF,w1),this.intersectBodies(w1),this.hasHit}intersectBody(e,t){t&&(this.result=t,this.updateDirection());const i=this.checkCollisionResponse;if(i&&!e.collisionResponse||(this.collisionFilterGroup&e.collisionFilterMask)===0||(e.collisionFilterGroup&this.collisionFilterMask)===0)return;const a=Bme,o=Gme;for(let r=0,s=e.shapes.length;r<s;r++){const l=e.shapes[r];if(!(i&&!l.collisionResponse)&&(e.quaternion.mult(e.shapeOrientations[r],o),e.quaternion.vmult(e.shapeOffsets[r],a),a.vadd(e.position,a),this.intersectShape(l,o,a,e),this.result.shouldStop))break}}intersectBodies(e,t){t&&(this.result=t,this.updateDirection());for(let i=0,a=e.length;!this.result.shouldStop&&i<a;i++)this.intersectBody(e[i])}updateDirection(){this.to.vsub(this.from,this.direction),this.direction.normalize()}intersectShape(e,t,i,a){const o=this.from;if(Tme(o,this.direction,i)>e.boundingSphereRadius)return;const s=this[e.type];s&&s.call(this,e,t,i,a,e)}_intersectBox(e,t,i,a,o){return this._intersectConvex(e.convexPolyhedronRepresentation,t,i,a,o)}_intersectPlane(e,t,i,a,o){const r=this.from,s=this.to,l=this.direction,c=new We(0,0,1);t.vmult(c,c);const u=new We;r.vsub(i,u);const C=u.dot(c);s.vsub(i,u);const h=u.dot(c);if(C*h>0||r.distanceTo(s)<C)return;const m=c.dot(l);if(Math.abs(m)<this.precision)return;const p=new We,B=new We,b=new We;r.vsub(i,p);const y=-c.dot(p)/m;l.scale(y,B),r.vadd(B,b),this.reportIntersection(c,b,o,a,-1)}getAABB(e){const{lowerBound:t,upperBound:i}=e,a=this.to,o=this.from;t.x=Math.min(a.x,o.x),t.y=Math.min(a.y,o.y),t.z=Math.min(a.z,o.z),i.x=Math.max(a.x,o.x),i.y=Math.max(a.y,o.y),i.z=Math.max(a.z,o.z)}_intersectHeightfield(e,t,i,a,o){e.data,e.elementSize;const r=Sme;r.from.copy(this.from),r.to.copy(this.to),As.pointToLocalFrame(i,t,r.from,r.from),As.pointToLocalFrame(i,t,r.to,r.to),r.updateDirection();const s=wme;let l,c,u,C;l=c=0,u=C=e.data.length-1;const h=new Rl;r.getAABB(h),e.getIndexOfPosition(h.lowerBound.x,h.lowerBound.y,s,!0),l=Math.max(l,s[0]),c=Math.max(c,s[1]),e.getIndexOfPosition(h.upperBound.x,h.upperBound.y,s,!0),u=Math.min(u,s[0]+1),C=Math.min(C,s[1]+1);for(let m=l;m<u;m++)for(let p=c;p<C;p++){if(this.result.shouldStop)return;if(e.getAabbAtIndex(m,p,h),!!h.overlapsRay(r)){if(e.getConvexTrianglePillar(m,p,!1),As.pointToWorldFrame(i,t,e.pillarOffset,Cy),this._intersectConvex(e.pillarConvex,t,Cy,a,o,XF),this.result.shouldStop)return;e.getConvexTrianglePillar(m,p,!0),As.pointToWorldFrame(i,t,e.pillarOffset,Cy),this._intersectConvex(e.pillarConvex,t,Cy,a,o,XF)}}}_intersectSphere(e,t,i,a,o){const r=this.from,s=this.to,l=e.radius,c=(s.x-r.x)**2+(s.y-r.y)**2+(s.z-r.z)**2,u=2*((s.x-r.x)*(r.x-i.x)+(s.y-r.y)*(r.y-i.y)+(s.z-r.z)*(r.z-i.z)),C=(r.x-i.x)**2+(r.y-i.y)**2+(r.z-i.z)**2-l**2,h=u**2-4*c*C,m=Rme,p=Zme;if(!(h<0))if(h===0)r.lerp(s,h,m),m.vsub(i,p),p.normalize(),this.reportIntersection(p,m,o,a,-1);else{const B=(-u-Math.sqrt(h))/(2*c),b=(-u+Math.sqrt(h))/(2*c);if(B>=0&&B<=1&&(r.lerp(s,B,m),m.vsub(i,p),p.normalize(),this.reportIntersection(p,m,o,a,-1)),this.result.shouldStop)return;b>=0&&b<=1&&(r.lerp(s,b,m),m.vsub(i,p),p.normalize(),this.reportIntersection(p,m,o,a,-1))}}_intersectConvex(e,t,i,a,o,r){const s=xme,l=TF,c=r&&r.faceList||null,u=e.faces,C=e.vertices,h=e.faceNormals,m=this.direction,p=this.from,B=this.to,b=p.distanceTo(B),y=c?c.length:u.length,S=this.result;for(let R=0;!S.shouldStop&&R<y;R++){const Z=c?c[R]:R,x=u[Z],M=h[Z],E=t,F=i;l.copy(C[x[0]]),E.vmult(l,l),l.vadd(F,l),l.vsub(p,l),E.vmult(M,s);const N=m.dot(s);if(Math.abs(N)<this.precision)continue;const H=s.dot(l)/N;if(!(H<0)){m.scale(H,Is),Is.vadd(p,Is),ac.copy(C[x[0]]),E.vmult(ac,ac),F.vadd(ac,ac);for(let z=1;!S.shouldStop&&z<x.length-1;z++){ng.copy(C[x[z]]),ig.copy(C[x[z+1]]),E.vmult(ng,ng),E.vmult(ig,ig),F.vadd(ng,ng),F.vadd(ig,ig);const _=Is.distanceTo(p);!(Cr.pointInTriangle(Is,ac,ng,ig)||Cr.pointInTriangle(Is,ng,ac,ig))||_>b||this.reportIntersection(s,Is,o,a,Z)}}}}_intersectTrimesh(e,t,i,a,o,r){const s=Mme,l=Fme,c=Xme,u=TF,C=Wme,h=Vme,m=Nme,p=Hme,B=Eme,b=e.indices;e.vertices;const y=this.from,S=this.to,R=this.direction;c.position.copy(i),c.quaternion.copy(t),As.vectorToLocalFrame(i,t,R,C),As.pointToLocalFrame(i,t,y,h),As.pointToLocalFrame(i,t,S,m),m.x*=e.scale.x,m.y*=e.scale.y,m.z*=e.scale.z,h.x*=e.scale.x,h.y*=e.scale.y,h.z*=e.scale.z,m.vsub(h,C),C.normalize();const Z=h.distanceSquared(m);e.tree.rayQuery(this,c,l);for(let x=0,M=l.length;!this.result.shouldStop&&x!==M;x++){const E=l[x];e.getNormal(E,s),e.getVertex(b[E*3],ac),ac.vsub(h,u);const F=C.dot(s),N=s.dot(u)/F;if(N<0)continue;C.scale(N,Is),Is.vadd(h,Is),e.getVertex(b[E*3+1],ng),e.getVertex(b[E*3+2],ig);const H=Is.distanceSquared(h);!(Cr.pointInTriangle(Is,ng,ac,ig)||Cr.pointInTriangle(Is,ac,ng,ig))||H>Z||(As.vectorToWorldFrame(t,s,B),As.pointToWorldFrame(i,t,Is,p),this.reportIntersection(B,p,o,a,E))}l.length=0}reportIntersection(e,t,i,a,o){const r=this.from,s=this.to,l=r.distanceTo(t),c=this.result;if(!(this.skipBackfaces&&e.dot(this.direction)>0))switch(c.hitFaceIndex=typeof o<"u"?o:-1,this.mode){case Cr.ALL:this.hasHit=!0,c.set(r,s,e,t,i,a,l),c.hasHit=!0,this.callback(c);break;case Cr.CLOSEST:(l<c.distance||!c.hasHit)&&(this.hasHit=!0,c.hasHit=!0,c.set(r,s,e,t,i,a,l));break;case Cr.ANY:this.hasHit=!0,c.hasHit=!0,c.set(r,s,e,t,i,a,l),c.shouldStop=!0;break}}static pointInTriangle(e,t,i,a){a.vsub(t,_C),i.vsub(t,Um),e.vsub(t,R1);const o=_C.dot(_C),r=_C.dot(Um),s=_C.dot(R1),l=Um.dot(Um),c=Um.dot(R1);let u,C;return(u=l*s-r*c)>=0&&(C=o*c-r*s)>=0&&u+C<o*l-r*r}}Cr.CLOSEST=jM.CLOSEST;Cr.ANY=jM.ANY;Cr.ALL=jM.ALL;const FF=new Rl,w1=[],Um=new We,R1=new We,Bme=new We,Gme=new _r,Is=new We,ac=new We,ng=new We,ig=new We;new We;new XZ;const XF={faceList:[0]},Cy=new We,Sme=new Cr,wme=[],Rme=new We,Zme=new We,xme=new We;new We;new We;const TF=new We,Mme=new We,Wme=new We,Vme=new We,Nme=new We,Eme=new We,Hme=new We;new Rl;const Fme=[],Xme=new As,_C=new We,Iy=new We;function Tme(n,e,t){t.vsub(n,_C);const i=_C.dot(e);return e.scale(i,Iy),Iy.vadd(n,Iy),t.distanceTo(Iy)}new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new Cr;new We;new We;new We;new We(1,0,0),new We(0,1,0),new We(0,0,1);new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new Rl;new We;new Rl;new We;new We;new We;new We;new We;new We;new We;new Rl;new We;new As;new Rl;xn.types.SPHERE,xn.types.SPHERE|xn.types.PLANE,xn.types.BOX|xn.types.BOX,xn.types.SPHERE|xn.types.BOX,xn.types.PLANE|xn.types.BOX,xn.types.CONVEXPOLYHEDRON,xn.types.SPHERE|xn.types.CONVEXPOLYHEDRON,xn.types.PLANE|xn.types.CONVEXPOLYHEDRON,xn.types.BOX|xn.types.CONVEXPOLYHEDRON,xn.types.SPHERE|xn.types.HEIGHTFIELD,xn.types.BOX|xn.types.HEIGHTFIELD,xn.types.CONVEXPOLYHEDRON|xn.types.HEIGHTFIELD,xn.types.PARTICLE|xn.types.SPHERE,xn.types.PLANE|xn.types.PARTICLE,xn.types.BOX|xn.types.PARTICLE,xn.types.PARTICLE|xn.types.CONVEXPOLYHEDRON,xn.types.CYLINDER,xn.types.SPHERE|xn.types.CYLINDER,xn.types.PLANE|xn.types.CYLINDER,xn.types.BOX|xn.types.CYLINDER,xn.types.CONVEXPOLYHEDRON|xn.types.CYLINDER,xn.types.HEIGHTFIELD|xn.types.CYLINDER,xn.types.PARTICLE|xn.types.CYLINDER,xn.types.SPHERE|xn.types.TRIMESH,xn.types.PLANE|xn.types.TRIMESH;new We;new We;new We;new We;new We;new _r;new _r;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new Rl;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We,new We,new We,new We,new We,new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new We;new _r;new We;new We;new We;new We;new We;new We;new We;new We;new We;new Rl;new Cr;const km=globalThis.performance||{};if(!km.now){let n=Date.now();km.timing&&km.timing.navigationStart&&(n=km.timing.navigationStart),km.now=()=>Date.now()-n}new We;const Yme=v.createContext(null),zme=()=>v.useContext(Yme),BL=v.createContext(null),Kme=()=>{const n=v.useContext(BL);if(!n)throw new Error("Physics context not found. @react-three/cannon & components can only be used within a Physics provider");return n};new Be(1,1,1);new Be;new Vn;const YF=new Ii;function Lme(n){const e=v.useRef(null);return n&&typeof n!="function"?n:e}function zF(n){return n.charAt(0).toUpperCase()+n.slice(1)}function Oo(n,e){const t=e===void 0?"":`/${e}`;return typeof n=="function"?null:n&&n.current&&`${n.current.uuid}${t}`}const _me=new ys,Dme=new eo,Ome=n=>e=>n(_me.setFromQuaternion(Dme.fromArray(e)).toArray());let GL=0;function Z1(n,e,t,i,a,o){return o===void 0&&(o="bodies"),r=>{const s=GL++;t[s]={[i]:r};const l=Oo(n,a);return l&&e.subscribe({props:{id:s,target:o,type:i},uuid:l}),()=>{delete t[s],e.unsubscribe({props:s})}}}function KF(n,e){let{position:t=[0,0,0],rotation:i=[0,0,0],userData:a={}}=e;n.userData=a,n.position.set(...t),n.rotation.set(...i),n.updateMatrix()}function LF(n,e,t){let{onCollide:i,onCollideBegin:a,onCollideEnd:o}=e;n[t]={collide:i,collideBegin:a,collideEnd:o}}function SL(n,e,t,i,a){i===void 0&&(i=null),a===void 0&&(a=[]);const o=Lme(i),{events:r,refs:s,scaleOverrides:l,subscriptions:c,worker:u}=Kme(),C=zme();v.useLayoutEffect(()=>{o.current||(o.current=new Ii);const m=o.current,p=u,B=m instanceof nI?(m.instanceMatrix.setUsage(x9),m.count):1,b=m instanceof nI?new Array(B).fill(0).map((S,R)=>`${m.uuid}/${R}`):[m.uuid],y=m instanceof nI?b.map((S,R)=>{const Z=e(R);return KF(YF,Z),m.setMatrixAt(R,YF.matrix),m.instanceMatrix.needsUpdate=!0,s[S]=m,C==null||C.add(S,Z,n),LF(r,Z,S),{...Z,args:t(Z.args)}}):b.map((S,R)=>{const Z=e(R);return KF(m,Z),s[S]=m,C==null||C.add(S,Z,n),LF(r,Z,S),{...Z,args:t(Z.args)}});return p.addBodies({props:y.map(S=>{let{onCollide:R,onCollideBegin:Z,onCollideEnd:x,...M}=S;return{onCollide:!!R,...M}}),type:n,uuid:b}),()=>{b.forEach(S=>{delete s[S],C==null||C.remove(S),delete r[S]}),p.removeBodies({uuid:b})}},a);const h=v.useMemo(()=>{const m=(R,Z)=>{const x=`set${zF(R)}`;return{set:M=>{const E=Oo(o,Z);E&&u[x]({props:M,uuid:E})},subscribe:Z1(o,u,c,R,Z)}},p=R=>({copy:x=>{let{w:M,x:E,y:F,z:N}=x;const H=Oo(o,R);H&&u.setQuaternion({props:[E,F,N,M],uuid:H})},set:(x,M,E,F)=>{const N=Oo(o,R);N&&u.setQuaternion({props:[x,M,E,F],uuid:N})},subscribe:Z1(o,u,c,"quaternion",R)}),B=R=>({copy:Z=>{let{x,y:M,z:E}=Z;const F=Oo(o,R);F&&u.setRotation({props:[x,M,E],uuid:F})},set:(Z,x,M)=>{const E=Oo(o,R);E&&u.setRotation({props:[Z,x,M],uuid:E})},subscribe:Z=>{const x=GL++,M="bodies",E="quaternion",F=Oo(o,R);return c[x]={[E]:Ome(Z)},F&&u.subscribe({props:{id:x,target:M,type:E},uuid:F}),()=>{delete c[x],u.unsubscribe({props:x})}}}),b=(R,Z)=>{const x=`set${zF(R)}`;return{copy:M=>{let{x:E,y:F,z:N}=M;const H=Oo(o,Z);H&&u[x]({props:[E,F,N],uuid:H})},set:(M,E,F)=>{const N=Oo(o,Z);N&&u[x]({props:[M,E,F],uuid:N})},subscribe:Z1(o,u,c,R,Z)}};function y(R){return{allowSleep:m("allowSleep",R),angularDamping:m("angularDamping",R),angularFactor:b("angularFactor",R),angularVelocity:b("angularVelocity",R),applyForce(Z,x){const M=Oo(o,R);M&&u.applyForce({props:[Z,x],uuid:M})},applyImpulse(Z,x){const M=Oo(o,R);M&&u.applyImpulse({props:[Z,x],uuid:M})},applyLocalForce(Z,x){const M=Oo(o,R);M&&u.applyLocalForce({props:[Z,x],uuid:M})},applyLocalImpulse(Z,x){const M=Oo(o,R);M&&u.applyLocalImpulse({props:[Z,x],uuid:M})},applyTorque(Z){const x=Oo(o,R);x&&u.applyTorque({props:[Z],uuid:x})},collisionFilterGroup:m("collisionFilterGroup",R),collisionFilterMask:m("collisionFilterMask",R),collisionResponse:m("collisionResponse",R),fixedRotation:m("fixedRotation",R),isTrigger:m("isTrigger",R),linearDamping:m("linearDamping",R),linearFactor:b("linearFactor",R),mass:m("mass",R),material:m("material",R),position:b("position",R),quaternion:p(R),rotation:B(R),scaleOverride(Z){const x=Oo(o,R);x&&(l[x]=new Be(...Z))},sleep(){const Z=Oo(o,R);Z&&u.sleep({uuid:Z})},sleepSpeedLimit:m("sleepSpeedLimit",R),sleepTimeLimit:m("sleepTimeLimit",R),userData:m("userData",R),velocity:b("velocity",R),wakeUp(){const Z=Oo(o,R);Z&&u.wakeUp({uuid:Z})}}}const S={};return{...y(void 0),at:R=>S[R]||(S[R]=y(R))}},[]);return[o,h]}function Ume(n,e,t){return SL("Plane",n,()=>[],e,t)}function kme(n,e,t){const i=[1,1,1];return SL("Box",n,function(a){return a===void 0&&(a=i),a},e,t)}const Pme=new Be,Jme=new Be(1,1,1),jme=new eo,hy=new Vn;function _F(n,e,t,i,a){return i===void 0&&(i=Jme),n!==void 0?(hy.compose(Pme.fromArray(e,n*3),jme.fromArray(t,n*4),i),a&&(a.matrixAutoUpdate=!1,a.matrix.copy(hy)),hy):hy.identity()}const Qme=()=>{const n=[];return e=>n.includes(e)?!1:!!n.push(e)};function qme(n){let{allowSleep:e=!1,axisIndex:t=0,broadphase:i="Naive",children:a,defaultContactMaterial:o={contactEquationStiffness:1e6},frictionGravity:r=null,gravity:s=[0,-9.81,0],isPaused:l=!1,iterations:c=5,maxSubSteps:u=10,quatNormalizeFast:C=!1,quatNormalizeSkip:h=0,shouldInvalidate:m=!0,size:p=1e3,solver:B="GS",stepSize:b=1/60,tolerance:y=.001}=n;const{invalidate:S}=Ra(),[{bodies:R,events:Z,refs:x,scaleOverrides:M,subscriptions:E,worker:F}]=v.useState(()=>({bodies:{},events:{},refs:{},scaleOverrides:{},subscriptions:{},worker:new PAe({allowSleep:e,axisIndex:t,broadphase:i,defaultContactMaterial:o,frictionGravity:r,gravity:s,iterations:c,quatNormalizeFast:C,quatNormalizeSkip:h,size:p,solver:B,tolerance:y})}));let N=0;const H=v.useCallback((L,U)=>{l||(N+=U,F.step({maxSubSteps:u,stepSize:b,timeSinceLastCalled:N}),N=0)},[l,u,b]),z=L=>{var U;let{body:q,contact:{bi:K,bj:O,...j},target:ne,...k}=L;const ie=(U=Z[ne])==null?void 0:U.collide;ie&&ie({body:x[q],contact:{bi:x[K],bj:x[O],...j},target:x[ne],...k})},_=L=>{var U,q;let{bodyA:K,bodyB:O}=L;const j=(U=Z[K])==null?void 0:U.collideBegin;j&&j({body:x[O],op:"event",target:x[K],type:"collideBegin"});const ne=(q=Z[O])==null?void 0:q.collideBegin;ne&&ne({body:x[K],op:"event",target:x[O],type:"collideBegin"})},D=L=>{var U,q;let{bodyA:K,bodyB:O}=L;const j=(U=Z[K])==null?void 0:U.collideEnd;j&&j({body:x[O],op:"event",target:x[K],type:"collideEnd"});const ne=(q=Z[O])==null?void 0:q.collideEnd;ne&&ne({body:x[K],op:"event",target:x[O],type:"collideEnd"})},P=L=>{let{active:U,bodies:q=[],observations:K,positions:O,quaternions:j}=L;for(let ne=0;ne<q.length;ne++)R[q[ne]]=ne;if(K.forEach(ne=>{let[k,ie,re]=ne;const de=(E[k]||{})[re];de&&de(ie)}),!!U){for(const ne of Object.values(x).filter(Qme()))if(ne instanceof nI)for(let k=0;k<ne.count;k++){const ie=`${ne.uuid}/${k}`,re=R[ie];re!==void 0&&(ne.setMatrixAt(k,_F(re,O,j,M[ie])),ne.instanceMatrix.needsUpdate=!0)}else{const k=M[ne.uuid]||ne.scale;_F(R[ne.uuid],O,j,k,ne)}m&&S()}},$=L=>{var U;let{body:q,ray:{uuid:K,...O},...j}=L;const ne=(U=Z[K])==null?void 0:U.rayhit;ne&&ne({body:q?x[q]:null,ray:{uuid:K,...O},...j})};bg(H),v.useEffect(()=>(F.connect(),F.init(),F.on("collide",z),F.on("collideBegin",_),F.on("collideEnd",D),F.on("frame",P),F.on("rayhit",$),()=>{F.terminate(),F.removeAllListeners()}),[]),v.useEffect(()=>{F.axisIndex=t},[t]),v.useEffect(()=>{F.broadphase=i},[i]),v.useEffect(()=>{F.gravity=s},[s]),v.useEffect(()=>{F.iterations=c},[c]),v.useEffect(()=>{F.tolerance=y},[y]);const X=v.useMemo(()=>({bodies:R,events:Z,refs:x,scaleOverrides:M,subscriptions:E,worker:F}),[R,Z,x,E,F]);return Le.jsx(BL.Provider,{value:X,children:a})}function $me(n){const[e]=Ume(()=>({rotation:[-Math.PI/2,0,0],...n})),t=v.useMemo(()=>{const i=document.createElement("canvas");i.width=512,i.height=512;const a=i.getContext("2d");a.fillStyle="#444444",a.fillRect(0,0,i.width,i.height),a.strokeStyle="#555555",a.lineWidth=2;const o=50;for(let s=0;s<=i.width;s+=o)a.beginPath(),a.moveTo(s,0),a.lineTo(s,i.height),a.stroke();for(let s=0;s<=i.height;s+=o)a.beginPath(),a.moveTo(0,s),a.lineTo(i.width,s),a.stroke();const r=new _9(i);return r.wrapS=r.wrapT=gu,r.repeat.set(10,10),r},[]);return Le.jsxs("mesh",{ref:e,receiveShadow:!0,children:[Le.jsx("planeGeometry",{args:[20,20]}),Le.jsx("meshStandardMaterial",{map:t})]})}function x1({position:n,color:e="white",size:t=[1,1,1]}){const[i,a]=kme(()=>({mass:1,position:n})),[o,r]=v.useState(!1),s=()=>{a.velocity.set(0,5,0)};return Le.jsxs("mesh",{ref:i,castShadow:!0,onClick:s,onPointerOver:()=>r(!0),onPointerOut:()=>r(!1),children:[Le.jsx("boxGeometry",{args:t}),Le.jsx("meshLambertMaterial",{color:o?"#f50057":e})]})}function epe({position:n,text:e,size:t=1}){const i=v.useRef(),{camera:a}=Ra();return bg(()=>{i.current.quaternion.copy(a.quaternion)}),Le.jsx(hee,{ref:i,position:n,fontSize:t,color:"#ffffff",anchorX:"center",anchorY:"middle",children:e})}function tpe(){return Le.jsx(lq,{center:!0,children:Le.jsxs("div",{style:{color:"white",background:"rgba(0,0,0,0.7)",padding:"20px",borderRadius:"8px"},children:[Le.jsx("h3",{children:" ..."}),Le.jsx("div",{style:{width:"50px",height:"50px",border:"5px solid #333",borderTop:"5px solid #fff",borderRadius:"50%",animation:"spin 1s linear infinite"}}),Le.jsx("style",{children:`
          @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
          }
        `})]})})}function SS({modelPath:n,enablePhysics:e=!1,skyPreset:t="sunset",showStats:i=!1,backgroundColor:a="#101020",cameraPosition:o=[0,5,10]}){const[r,s]=v.useState([]);return v.useEffect(()=>{s(n?[{path:n,position:[0,0,0],scale:1}]:[])},[n]),Le.jsxs("div",{style:{width:"100%",height:"500px",position:"relative"},children:[Le.jsxs(Ox,{shadows:!0,camera:{position:o,fov:75},style:{background:a},children:[i&&Le.jsx(Gee,{}),Le.jsx(Jx,{makeDefault:!0,position:o}),Le.jsx("ambientLight",{intensity:.5}),Le.jsx("directionalLight",{position:[10,10,5],intensity:1,castShadow:!0,"shadow-mapSize-width":2048,"shadow-mapSize-height":2048}),Le.jsx(_ee,{sunPosition:[500,150,-1e3],turbidity:10,rayleigh:.5,preset:t}),e?Le.jsxs(qme,{gravity:[0,-9.8,0],children:[Le.jsx($me,{}),Le.jsx(x1,{position:[0,5,0],color:"#2196f3"}),Le.jsx(x1,{position:[1,7,-1],color:"#4caf50"}),Le.jsx(x1,{position:[-1,9,1],color:"#ff9800"})]}):Le.jsxs("mesh",{receiveShadow:!0,rotation:[-Math.PI/2,0,0],position:[0,-.5,0],children:[Le.jsx("planeGeometry",{args:[20,20]}),Le.jsx("meshStandardMaterial",{color:"#333333"})]}),Le.jsxs(v.Suspense,{fallback:Le.jsx(tpe,{}),children:[r.length>0?r.map((l,c)=>Le.jsx(npe,{path:l.path,position:l.position,scale:l.scale},c)):Le.jsxs(Le.Fragment,{children:[Le.jsxs("mesh",{position:[-2,1,0],castShadow:!0,children:[Le.jsx("sphereGeometry",{args:[1,32,32]}),Le.jsx("meshStandardMaterial",{color:"#f50057",roughness:.4,metalness:.7})]}),Le.jsxs("mesh",{position:[2,1,0],castShadow:!0,children:[Le.jsx("torusKnotGeometry",{args:[.7,.3,128,32]}),Le.jsx("meshStandardMaterial",{color:"#2196f3",roughness:.3,metalness:.5})]}),Le.jsx(epe,{position:[0,3,0],text:"React Three Fiber",size:1})]}),Le.jsx(HT,{preset:t,background:!1})]}),Le.jsx(jx,{target:[0,1,0],maxPolarAngle:Math.PI/2})]}),Le.jsx("div",{style:{position:"absolute",bottom:"10px",left:"10px",padding:"5px 10px",background:"rgba(0,0,0,0.5)",color:"white",borderRadius:"4px",fontSize:"12px"},children:"3D    ,  /"})]})}function npe({path:n,position:e=[0,0,0],scale:t=1,rotation:i=[0,0,0]}){const{scene:a}=jG(n),o=v.useRef();return bg(r=>{const s=r.clock.getElapsedTime();o.current.rotation.y=i[1]+Math.sin(s/4)*.2}),Le.jsx("primitive",{ref:o,object:a,position:e,scale:t,rotation:i,castShadow:!0})}const ipe=Object.freeze(Object.defineProperty({__proto__:null,default:SS},Symbol.toStringTag,{value:"Module"})),ape=()=>Le.jsxs("div",{style:{marginBottom:"20px"},children:[Le.jsx("h2",{children:" 3D "}),Le.jsx(SS,{})]}),ope=Object.freeze(Object.defineProperty({__proto__:null,default:ape},Symbol.toStringTag,{value:"Module"})),rpe=()=>Le.jsxs("div",{style:{marginBottom:"20px"},children:[Le.jsx("h2",{children:"   3D "}),Le.jsx(SS,{enablePhysics:!0,skyPreset:"night",showStats:!0,backgroundColor:"#050505"})]}),spe=Object.freeze(Object.defineProperty({__proto__:null,default:rpe},Symbol.toStringTag,{value:"Module"})),lpe=()=>Le.jsxs("div",{children:[Le.jsx("h2",{children:"3D  "}),Le.jsx(SS,{modelPath:"/models/AnimatedPlatformerCharacter.glb",skyPreset:"dawn",cameraPosition:[5,2,5]})]}),cpe=Object.freeze(Object.defineProperty({__proto__:null,default:lpe},Symbol.toStringTag,{value:"Module"})),gpe=({color:n="royalblue"})=>{const e=v.useRef();return bg((t,i)=>{e.current&&(e.current.rotation.y+=i*.2)}),Le.jsxs("mesh",{ref:e,children:[Le.jsx("boxGeometry",{args:[1,1,1]}),Le.jsx("meshStandardMaterial",{color:n})]})},upe=()=>{const n=v.useRef();return mee(n,null,1),Le.jsxs(Le.Fragment,{children:[Le.jsx("ambientLight",{intensity:.3}),Le.jsx("directionalLight",{ref:n,position:[5,5,5],intensity:1,castShadow:!0,"shadow-mapSize-width":1024,"shadow-mapSize-height":1024})]})},dpe=()=>{const n=v.useRef(),[e,t]=v.useState([3,3,3]),[i,a]=v.useState(1),o=()=>{if(i<2){const l=i+.1;a(l),n.current&&(n.current.dollyIn(1.1),n.current.update())}},r=()=>{if(i>.5){const l=i-.1;a(l),n.current&&(n.current.dollyOut(1.1),n.current.update())}},s=()=>{t([3,3,3]),a(1),n.current&&n.current.reset()};return Le.jsxs("div",{style:{width:"100%",height:"100%",position:"relative"},children:[Le.jsxs(Ox,{shadows:!0,children:[Le.jsx(Jx,{makeDefault:!0,position:e,fov:75}),Le.jsx(jx,{ref:n,enableZoom:!0,enablePan:!0,enableRotate:!0,zoomSpeed:1,panSpeed:1,rotateSpeed:1}),Le.jsx(HT,{preset:"city"}),Le.jsx(upe,{}),Le.jsx(gpe,{}),Le.jsx("axesHelper",{args:[5]}),Le.jsx("gridHelper",{args:[10,10]})]}),Le.jsxs("div",{style:{position:"absolute",bottom:500,left:20,background:"rgba(255, 255, 255, 0.7)",padding:10,borderRadius:5,display:"flex",flexDirection:"column",gap:10},children:[Le.jsx(xo,{icon:Le.jsx(xAe,{}),onClick:o}),Le.jsx(hIe,{value:i,min:.5,max:2,step:.1,onChange:l=>{if(a(l),n.current){const c=l/i;c>1?n.current.dollyIn(c):n.current.dollyOut(1/c),n.current.update()}},vertical:!0,style:{height:100}}),Le.jsx(xo,{icon:Le.jsx(WAe,{}),onClick:r}),Le.jsx(xo,{icon:Le.jsx(vAe,{}),onClick:s})]})]})},Cpe=Object.freeze(Object.defineProperty({__proto__:null,default:dpe},Symbol.toStringTag,{value:"Module"})),DF=Object.assign({"/src/components/Layout/FloatingPanel.jsx":FU,"/src/components/Layout/Footer.jsx":jD,"/src/components/Layout/Header.jsx":JD,"/src/components/Layout/Layout.jsx":A_,"/src/components/Layout/LeftPanel.jsx":NU,"/src/components/Layout/MainContent.jsx":f_,"/src/components/Layout/RightPanel.jsx":XU,"/src/components/PanelContainer.jsx":h_,"/src/components/Panels/3D/RotatingCube.jsx":Dee,"/src/components/Panels/3D/Scene3D.jsx":Pee,"/src/components/Panels/ChartPanel.jsx":jee,"/src/components/Panels/ListPanel.jsx":qee,"/src/components/Panels/ListPanel2.jsx":ete,"/src/components/Panels/Panel1.jsx":FAe,"/src/components/View/Default3D.jsx":ope,"/src/components/View/Physic3D.jsx":spe,"/src/components/View/Root3D.jsx":cpe,"/src/components/View/ZoomableScene3D.jsx":Cpe,"/src/components/View/index.jsx":ipe}),tp=({path:n})=>{var t;console.log(n);const e=(t=DF[n])==null?void 0:t.default;return console.log(""),e?typeof e!="function"?(console.error("Invalid component:",e),null):(console.log("Component",e),Le.jsx(e,{})):(console.error("Component not found:",n),console.log("Available components:",Object.keys(DF)),null)},TZ=({panelInfo:n})=>{var o,r,s,l,c,u,C,h,m,p,B,b;const[e,t]=v.useState({});v.useEffect(()=>{t(n),console.log(n)},[]),v.useEffect(()=>{t(n)},[n]);const i=y=>{t(S=>({...S,[y]:{...S[y],isCollapsed:!S[y].isCollapsed}}))},a=y=>{t(S=>({...S,[y]:{...S[y],isVisible:!S[y].isVisible}}))};return Le.jsxs("div",{children:[Le.jsxs("div",{className:"left-floating-panels",children:[Le.jsx(T1,{position:"top",title:"",isVisible:((o=e==null?void 0:e.leftNav)==null?void 0:o.isVisible)??!0,isCollapsed:((r=e==null?void 0:e.leftNav)==null?void 0:r.isCollapsed)??!0,onToggle:()=>i("leftNav"),onClose:()=>a("leftNav"),children:e.leftNav&&Le.jsx(tp,{path:((s=e==null?void 0:e.leftNav)==null?void 0:s.path)??""})}),Le.jsx(T1,{position:"bottom",title:"",isVisible:((l=e==null?void 0:e.leftWork)==null?void 0:l.isVisible)??!0,isCollapsed:((c=e==null?void 0:e.leftWork)==null?void 0:c.isCollapsed)??!0,onToggle:()=>i("leftWork"),onClose:()=>a("leftWork"),children:(e==null?void 0:e.leftWork)&&Le.jsx(tp,{path:((u=e==null?void 0:e.leftWork)==null?void 0:u.path)??""})})]}),Le.jsxs("div",{className:"right-floating-panels",children:[Le.jsx(Y1,{position:"top",title:"",isVisible:((C=e==null?void 0:e.rightTop)==null?void 0:C.isVisible)??!0,isCollapsed:((h=e==null?void 0:e.rightTop)==null?void 0:h.isCollapsed)??!0,onToggle:()=>i("rightTop"),onClose:()=>a("rightTop"),children:e.rightTop&&Le.jsx(tp,{path:((m=e==null?void 0:e.rightTop)==null?void 0:m.path)??""})}),Le.jsx(Y1,{position:"bottom",title:"",isVisible:((p=e==null?void 0:e.rightBottom)==null?void 0:p.isVisible)??!0,isCollapsed:((B=e==null?void 0:e.rightBottom)==null?void 0:B.isCollapsed)??!0,onToggle:()=>i("rightBottom"),onClose:()=>a("rightBottom"),children:e.rightBottom&&Le.jsx(tp,{path:((b=e==null?void 0:e.rightBottom)==null?void 0:b.path)??""})})]})]})};function wL({tabIndex:n,setTabIndex:e,tabs:t,setTabs:i}){const[a,o]=v.useState([]),r=Gd(),s=u=>{i(t.map((C,h)=>h===n?{...C,viewer:Le.jsx("div",{style:{position:"fixed",top:"300px",left:0,width:"100vw",height:"100vh",overflow:"hidden"},children:Le.jsx(tp,{path:u})})}:C))},l=u=>{const C=a.filter(h=>h.url===(u==="home"?"":u))[0];i(t.map((h,m)=>m===n?{...h,content:Le.jsx("div",{className:"floating-panels-container",children:Le.jsx(TZ,{panelInfo:C})})}:h))},c=()=>{const u=r.pathname.split("/"),C=u[u.length-1],h=a.filter(m=>m.url===C)[0];i([...t,{label:(C===""?"":C)+t.length,content:Le.jsx("div",{className:"floating-panels-container",children:Le.jsx(TZ,{panelInfo:h,style:{zIndex:1e3}})})}])};return v.useEffect(()=>{Da("/react_panel_dynamic/api/panel.json").then(u=>{o(u.data)})},[]),v.useEffect(()=>{console.log("tabs  :",t)},[t]),Le.jsx("div",{children:Le.jsxs("div",{className:"main-content",style:{width:"100%",justifyContent:"center"},children:[Le.jsxs("div",{className:"tab-container",children:[Le.jsxs(pp,{style:{display:"flex",justifyContent:"center",margin:"16px 0",background:"#f0f2f5",padding:"12px",borderRadius:"8px"},children:[t.map(({label:u},C)=>Le.jsx(xo,{className:`tab ${n===C?"active":""}`,onClick:()=>e(C),type:n===C?"primary":"default",children:u},C)),Le.jsx(AI,{title:"  ",children:Le.jsx(xo,{type:"primary",icon:Le.jsx(yF,{}),onClick:c,children:" "})}),Le.jsx(AI,{title:" ",children:Le.jsx(xo,{type:"primary",icon:Le.jsx(yF,{}),onClick:s,children:" "})})]}),Le.jsxs(pp,{style:{display:"flex",justifyContent:"center",margin:"16px 0",background:"#f0f2f5",padding:"12px",borderRadius:"8px"},children:[Le.jsx(xo,{type:"default",icon:Le.jsx(fAe,{}),onClick:()=>l("home"),children:"  "}),Le.jsx(xo,{type:"default",icon:Le.jsx(RAe,{}),onClick:()=>l("service"),children:" "}),Le.jsx(xo,{type:"default",icon:Le.jsx(mAe,{}),onClick:()=>l("about"),children:" "}),Le.jsx(xo,{type:"default",icon:Le.jsx(IAe,{}),onClick:()=>l("etc"),children:" "})]}),Le.jsxs(pp,{style:{display:"flex",justifyContent:"center",margin:"16px 0",background:"#f0f2f5",padding:"12px",borderRadius:"8px"},children:[Le.jsx(xo,{type:"default",onClick:()=>s("/src/components/View/Default3D.jsx"),children:"default "}),Le.jsx(xo,{type:"default",onClick:()=>s("/src/components/View/Physic3D.jsx"),children:"Physic3D "}),Le.jsx(xo,{type:"default",onClick:()=>s("/src/components/View/Root3D.jsx"),children:""}),Le.jsx(xo,{type:"default",onClick:()=>s("/src/components/View/ZoomableScene3D.jsx"),children:""})]})]}),Le.jsx("div",{className:"content-wrapper",children:t.map((u,C)=>Le.jsxs("div",{style:{display:C===n?"block":"none"},children:[u.content,u.viewer]},C))})]})})}function RL(){const[n,e]=v.useState(0),[t,i]=v.useState([]);return Le.jsxs("div",{className:"layout-container",children:[Le.jsx(c5,{}),Le.jsx("div",{className:"content-area",children:Le.jsx(wL,{tabIndex:n,setTabIndex:e,tabs:t,setTabs:i})}),Le.jsx(g5,{})]})}function Ipe(){return Le.jsx(TD,{children:Le.jsx(RL,{})})}kF.createRoot(document.getElementById("root")).render(Le.jsx(v.StrictMode,{children:Le.jsx(Ipe,{})}));
